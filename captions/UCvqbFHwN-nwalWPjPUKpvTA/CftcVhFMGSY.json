[
  {
    "text": "well good afternoon everybody welcome to our stateful extra extravaganza here my",
    "start": "60",
    "end": "9090"
  },
  {
    "text": "name is Josh this is Alexi we both work on the Patroni project among other",
    "start": "9090",
    "end": "15990"
  },
  {
    "text": "things which is post cruise automation be talking about a little bit more about that so since I first tried out",
    "start": "15990",
    "end": "26820"
  },
  {
    "text": "kubernetes a couple of years ago and actually docker about a year before that",
    "start": "26820",
    "end": "35190"
  },
  {
    "text": "I've been on a quest to actually get to managing stateful applications under on",
    "start": "35190",
    "end": "43320"
  },
  {
    "text": "a containerized stack this has been a long quest doesn't really start out",
    "start": "43320",
    "end": "48860"
  },
  {
    "text": "supporting stateful applications in containers we started out with the stateless ones because those were easier",
    "start": "48860",
    "end": "54449"
  },
  {
    "text": "and this is our sort of next stop in in stateful stuff now obviously everybody",
    "start": "54449",
    "end": "61859"
  },
  {
    "text": "right now is running on kubernetes and docker and rocket and other things they're running all your stateless",
    "start": "61859",
    "end": "67830"
  },
  {
    "text": "applications on there you know your web servers and routers and other things but",
    "start": "67830",
    "end": "73619"
  },
  {
    "text": "a lot of people like actually the one question asked earlier is how many people are running your application code",
    "start": "73619",
    "end": "80640"
  },
  {
    "text": "andrew burnett 'yes but running your database on a more traditional system",
    "start": "80640",
    "end": "85909"
  },
  {
    "text": "yeah so there's a lot of that and i understand why there's a lot of that we need to actually work on that now there",
    "start": "85909",
    "end": "92040"
  },
  {
    "text": "has been a lot of work in 1.5 we added stateful set in beta and stateful set",
    "start": "92040",
    "end": "100350"
  },
  {
    "text": "takes care of some of the things that we need for stateful applications like databases like having the storage",
    "start": "100350",
    "end": "107009"
  },
  {
    "text": "associated with the pod having identity and having that identity having the individual pods be routable so that you",
    "start": "107009",
    "end": "114060"
  },
  {
    "text": "can target specific database instances or shards for things in our database things can communicate with each other",
    "start": "114060",
    "end": "120560"
  },
  {
    "text": "but stateful set doesn't do everything that we need in order to run replicated",
    "start": "120560",
    "end": "128819"
  },
  {
    "text": "or cluster databases under kubernetes now some things it simply can't do",
    "start": "128819",
    "end": "134819"
  },
  {
    "text": "because they require too much application knowledge and that those need to be implemented in our",
    "start": "134819",
    "end": "141110"
  },
  {
    "text": "application frameworks specific to the application so these are things like having an individual database node join",
    "start": "141110",
    "end": "148290"
  },
  {
    "text": "a cluster I you know automating failover handling special nodes for things like",
    "start": "148290",
    "end": "155340"
  },
  {
    "text": "backup and administration etc rebalancing data for sharted stuff so",
    "start": "155340",
    "end": "162739"
  },
  {
    "text": "there's still more there's implementation that needs to happen outside of guberniya stateful sets now",
    "start": "162739",
    "end": "168840"
  },
  {
    "text": "one of the things we look at sort of immediately for this is hey let's have custom scheduling right because",
    "start": "168840",
    "end": "175409"
  },
  {
    "text": "guberniya supports custom schedule is a pretty good idea there are some problems for that as a reason why it's a route",
    "start": "175409",
    "end": "181170"
  },
  {
    "text": "you know I didn't take and it's not a route that I've seen anyone else take number one the problem of the custom",
    "start": "181170",
    "end": "187170"
  },
  {
    "text": "scheduling is you now have this thing that is intimately wedded to how your",
    "start": "187170",
    "end": "192239"
  },
  {
    "text": "database platform works that is nevertheless deployed completely",
    "start": "192239",
    "end": "197310"
  },
  {
    "text": "separately from it because this is being deployed in the kubernetes master nodes the other things we need deployed",
    "start": "197310",
    "end": "202739"
  },
  {
    "text": "through a container the second thing is frankly the overlap of people who are",
    "start": "202739",
    "end": "208949"
  },
  {
    "text": "database geeks and kubernetes experts is pretty low you know for that and the",
    "start": "208949",
    "end": "216329"
  },
  {
    "text": "biggest problem the reason why I didn't feel like it was worth pursuing is the whole message lag sort of telephone",
    "start": "216329",
    "end": "221849"
  },
  {
    "text": "problem which is anytime you have a central controller that controls things like failover you have the possibility",
    "start": "221849",
    "end": "227669"
  },
  {
    "text": "of not knowing what the state of the node you just told the failover is so",
    "start": "227669",
    "end": "234419"
  },
  {
    "text": "it's much better to have the node control itself and for that reason what I'm pretending is something that I call",
    "start": "234419",
    "end": "239699"
  },
  {
    "text": "the bot pattern I think some other people also cause this the auto pilot pattern and the idea is that you need a",
    "start": "239699",
    "end": "247620"
  },
  {
    "text": "control daemon in the node that node runs as PIB one in the container and it",
    "start": "247620",
    "end": "253319"
  },
  {
    "text": "communicates with other nodes by consensus or by the cube API or both in",
    "start": "253319",
    "end": "259370"
  },
  {
    "text": "order to control the individual database nodes and so all of the sort of post",
    "start": "259370",
    "end": "265389"
  },
  {
    "text": "Bernays implementations that I've worked on that Alexis will be talking about are based on the sort of bot pattern where",
    "start": "265389",
    "end": "272530"
  },
  {
    "text": "it will do things like initialization and cluster joining and failing and providing information to the system",
    "start": "272530",
    "end": "278560"
  },
  {
    "text": "about the state of health of the individual nodes there's been a few examples of this is the original",
    "start": "278560",
    "end": "284439"
  },
  {
    "text": "governor project which is being reincarnated there's pitoni which we both work on there's a lot of simple",
    "start": "284439",
    "end": "290860"
  },
  {
    "text": "sort of entry point scripts I was just talking to the chef habitat folks and habitat is very much around the same",
    "start": "290860",
    "end": "296860"
  },
  {
    "text": "sort of model and we will be showing you a couple of these now the other thing",
    "start": "296860",
    "end": "302530"
  },
  {
    "text": "that we're actually adding in for this cube con is to talk a little bit about helm so there are now helm charts for a",
    "start": "302530",
    "end": "312909"
  },
  {
    "text": "couple of different versions of deploying post squares helm adds a few",
    "start": "312909",
    "end": "318370"
  },
  {
    "text": "things that actually make it easier parameterization the idea of having an actual deployment of postgrads with all",
    "start": "318370",
    "end": "325990"
  },
  {
    "text": "of its parts have a name so you can do several of them which is something where",
    "start": "325990",
    "end": "331029"
  },
  {
    "text": "otherwise doing through editing the ml code um having a sort of registry of those things so that you can I upload",
    "start": "331029",
    "end": "338529"
  },
  {
    "text": "and download that and once we actually add them into the charts which they're not support for sidecar containers like",
    "start": "338529",
    "end": "344830"
  },
  {
    "text": "backup so we'll give you a couple of examples of this alex is going to start",
    "start": "344830",
    "end": "351279"
  },
  {
    "text": "with Patroni this one thank you so Patroni is a way",
    "start": "351279",
    "end": "359650"
  },
  {
    "text": "to run your highly available phosphorus in the container environment and we",
    "start": "359650",
    "end": "365860"
  },
  {
    "text": "actually started developing in two years ago when we moved B as Orlando the",
    "start": "365860",
    "end": "371469"
  },
  {
    "text": "technology company that happens to sell shoes and clothing when we move to the cloud and we what the transpose R is in",
    "start": "371469",
    "end": "377650"
  },
  {
    "text": "the cloud as well so there were no easy way to actually do the automatic failover which is a requirement if you",
    "start": "377650",
    "end": "384310"
  },
  {
    "text": "want to run hundreds of possible nodes in the cloud and therefore we started to develop patrolling this is basically the",
    "start": "384310",
    "end": "390509"
  },
  {
    "text": "Python program that manages Posterous and that's that talks with a consistent",
    "start": "390509",
    "end": "396490"
  },
  {
    "text": "K value store that represents the state of the cluster that consistent key value store is",
    "start": "396490",
    "end": "402560"
  },
  {
    "text": "basically a fabric that connects all your containers running individual",
    "start": "402560",
    "end": "407630"
  },
  {
    "text": "processes into the cluster that knows which nose it has and that knows which",
    "start": "407630",
    "end": "413360"
  },
  {
    "text": "what is the leader and which configuration the cluster has so because I want to show how to deploy Patroni",
    "start": "413360",
    "end": "420169"
  },
  {
    "text": "using home because he'll makes it super easy and because it takes some time I will cheat a little bit and start with a",
    "start": "420169",
    "end": "426110"
  },
  {
    "text": "live demo and while the class is being deployed I will show I will describe",
    "start": "426110",
    "end": "431690"
  },
  {
    "text": "what Patroni is and which features do we have there and yeah so I will cheat a",
    "start": "431690",
    "end": "439370"
  },
  {
    "text": "little bit more I have a script that actually does the right demo does this",
    "start": "439370",
    "end": "447470"
  },
  {
    "text": "microphone works yeah",
    "start": "447470",
    "end": "450370"
  },
  {
    "text": "it takes some time we'll clean up all the resources that we have we are running actually on the database cluster",
    "start": "459210",
    "end": "466270"
  },
  {
    "text": "that is running inside cylinder so production one so let's get the latest",
    "start": "466270",
    "end": "472830"
  },
  {
    "text": "running help chart actually I'm running it currently locally we have a chart",
    "start": "472830",
    "end": "478599"
  },
  {
    "text": "that we have the official one needs to be updated and today I've had a work that will be",
    "start": "478599",
    "end": "486999"
  },
  {
    "text": "changes for the state offsets reversed but a few changes that the suit has to",
    "start": "486999",
    "end": "492099"
  },
  {
    "text": "be merged with the public place so once it is updated you will be able to get from help now you can get it from my",
    "start": "492099",
    "end": "497860"
  },
  {
    "text": "repository and I'm running the help locally and helm just solves to do",
    "start": "497860",
    "end": "502900"
  },
  {
    "text": "because of your vocal as well so now let's make sure the chart is here you can see header row we'll have fun here",
    "start": "502900",
    "end": "508569"
  },
  {
    "text": "of Roni let's take a look at the configuration this is basically what you need to configure preferring this is the",
    "start": "508569",
    "end": "514570"
  },
  {
    "text": "doctor image totally there the number of replicas the resources the service account we that we use if your cluster",
    "start": "514570",
    "end": "522010"
  },
  {
    "text": "is configured so that no one not everyone can actually write your name",
    "start": "522010",
    "end": "527680"
  },
  {
    "text": "spaces the credentials for the superuserraven user and the replication and this is very important how do you",
    "start": "527680",
    "end": "533769"
  },
  {
    "text": "find the HDD because they stay the storage where you give way to keep the configuration some a degree a specific",
    "start": "533769",
    "end": "541000"
  },
  {
    "text": "configuration like you can use the s3 bucket and all that will put back up and roll files there and basically we accept",
    "start": "541000",
    "end": "550269"
  },
  {
    "text": "this configuration so let's deploy the new cluster with helm this is super easy help install",
    "start": "550269",
    "end": "556829"
  },
  {
    "text": "cube con so now the cluster is being deployed and you can see the way to",
    "start": "556829",
    "end": "562420"
  },
  {
    "text": "connect to this cluster with different users and yeah let's take a look at the",
    "start": "562420",
    "end": "569170"
  },
  {
    "text": "state whole set was generated we use stateful sets we have three replicas and",
    "start": "569170",
    "end": "575170"
  },
  {
    "text": "basically we supply configuration via environment variables and we use the",
    "start": "575170",
    "end": "582610"
  },
  {
    "text": "persistent programmers in order to store pinchy data the data directory for Possible's",
    "start": "582610",
    "end": "588069"
  },
  {
    "text": "you know we usually standard class and we define",
    "start": "588069",
    "end": "593330"
  },
  {
    "text": "the storage as five gigabytes level so let's check the status of the pots okay",
    "start": "593330",
    "end": "599840"
  },
  {
    "text": "they have been created they actually on the one container we wait for only one container so shortly talk about a",
    "start": "599840",
    "end": "607460"
  },
  {
    "text": "showing itself so this is what we have on the kubernetes this is what help",
    "start": "607460",
    "end": "614780"
  },
  {
    "text": "creates it creates the stateful set is a stateful set contains the pots each pot",
    "start": "614780",
    "end": "620420"
  },
  {
    "text": "runs one docker container inside this container we have phosphorus obviously that stores your data and we have",
    "start": "620420",
    "end": "626600"
  },
  {
    "text": "petroleum that acts that communicates between phosphorus and HCD that stores",
    "start": "626600",
    "end": "631820"
  },
  {
    "text": "the state of the cluster so xev is used in order to make sure that we run only",
    "start": "631820",
    "end": "637070"
  },
  {
    "text": "one little time so when the leader election happens we acquire the lock and",
    "start": "637070",
    "end": "642080"
  },
  {
    "text": "HCD and that work points to the node that is currently accepting right and we",
    "start": "642080",
    "end": "649190"
  },
  {
    "text": "also use EDD in order to store configuration of the cluster one thing is which nodes are part of the cluster",
    "start": "649190",
    "end": "655940"
  },
  {
    "text": "another is actually configuration of the positivist field because some parameters have to be synchronized between",
    "start": "655940",
    "end": "662120"
  },
  {
    "text": "different nodes in the cluster for instance you cannot set max connections are in arbitrary way on the master in",
    "start": "662120",
    "end": "668900"
  },
  {
    "text": "the replicas and but when we make sure those parameters are the same by keeping these in the consistent store like at CD",
    "start": "668900",
    "end": "675320"
  },
  {
    "text": "and then we create a service in order to connect to your cluster and we also have",
    "start": "675320",
    "end": "680600"
  },
  {
    "text": "the endpoint which communicates to your clients or your client knows how to go to the master and we don't use two",
    "start": "680600",
    "end": "686840"
  },
  {
    "text": "labels we could use labels in order to get the connection information to the",
    "start": "686840",
    "end": "692240"
  },
  {
    "text": "client but instead we use endpoint because it is only there can be only one address in the endpoint and we want to",
    "start": "692240",
    "end": "698600"
  },
  {
    "text": "avoid the case where the labels were signed incorrectly and you have two",
    "start": "698600",
    "end": "703960"
  },
  {
    "text": "addresses for the master so endpoint make sure we have only one address so",
    "start": "703960",
    "end": "709040"
  },
  {
    "text": "let's return to the cluster appointment now we can see that all the nodes are",
    "start": "709040",
    "end": "715190"
  },
  {
    "text": "running so we can actually take a look at the locks",
    "start": "715190",
    "end": "721100"
  },
  {
    "text": "so it will take some time here we get the rocks for the master replica so one",
    "start": "721100",
    "end": "729210"
  },
  {
    "text": "of the notes says I am literally the work this is the one this is the master",
    "start": "729210",
    "end": "735000"
  },
  {
    "text": "the others are actually say I'm a secondary I am folding the leader that",
    "start": "735000",
    "end": "740280"
  },
  {
    "text": "means that they serve as a secondary and here is the contents of the HCD these",
    "start": "740280",
    "end": "746070"
  },
  {
    "text": "are the keys we have the leader key we have the keys for each member and you",
    "start": "746070",
    "end": "752340"
  },
  {
    "text": "know we actually also store configuration of post-race in the cluster so this is basically if you are",
    "start": "752340",
    "end": "758820"
  },
  {
    "text": "familiar with the possible configuration this is what we propagate through all the nodes and and let's open also",
    "start": "758820",
    "end": "772380"
  },
  {
    "text": "connection to the database so now what I'm going to show you because Patroni",
    "start": "772380",
    "end": "777470"
  },
  {
    "text": "manages automatic failover for you they are going to kill one of the nodes and make sure that just the application can",
    "start": "777470",
    "end": "784920"
  },
  {
    "text": "still keep connection to so make sure that one of the other poles we were seeing the master all and the connect",
    "start": "784920",
    "end": "790950"
  },
  {
    "text": "application connections will be kept so let's take a look what we have this is",
    "start": "790950",
    "end": "796530"
  },
  {
    "text": "the tool that is called patron ezekiel and it is showing us that one of the one",
    "start": "796530",
    "end": "803520"
  },
  {
    "text": "of the node is later it's running so the others also running very replicas and we",
    "start": "803520",
    "end": "810480"
  },
  {
    "text": "get the same information from cube CTO we also use via science people they we",
    "start": "810480",
    "end": "816720"
  },
  {
    "text": "assign the labels so there is a master and two replicas and here we get the",
    "start": "816720",
    "end": "822200"
  },
  {
    "text": "connections we connect to the master we can see because peaches in recovery says",
    "start": "822200",
    "end": "828000"
  },
  {
    "text": "false so this node is not in recovery it is serving right and there is the actual transaction ID which is incremented to",
    "start": "828000",
    "end": "834600"
  },
  {
    "text": "each time we call this command so we see that the transaction IDs are",
    "start": "834600",
    "end": "840540"
  },
  {
    "text": "incrementing that means that how the crossroad is working so what we are going to do is delete the master thought",
    "start": "840540",
    "end": "847160"
  },
  {
    "text": "stay home yep so we say keep contact Rani delete and here is what happening",
    "start": "847160",
    "end": "852870"
  },
  {
    "text": "the master not stirred and now the leader immediately moved to",
    "start": "852870",
    "end": "858149"
  },
  {
    "text": "another pot so cube comp attorney 2 is currently the leader and we can see that",
    "start": "858149",
    "end": "865560"
  },
  {
    "text": "all the notes all the containers are running and we can see that the",
    "start": "865560",
    "end": "872550"
  },
  {
    "text": "application connections are running and the transaction IDs are incrementing as well being that the application managed",
    "start": "872550",
    "end": "878310"
  },
  {
    "text": "to reconnect to the new leader so now the lot of things let's use patron",
    "start": "878310",
    "end": "886860"
  },
  {
    "text": "Ezequiel to make a control failover because per 20 supports also maintenance",
    "start": "886860",
    "end": "891930"
  },
  {
    "text": "tasks if you want to be controlled failover or scheduled restarts you can also do this so I run patron evening CTO",
    "start": "891930",
    "end": "900750"
  },
  {
    "text": "failover it prompts me to choose the master now I can say enter it clicks the",
    "start": "900750",
    "end": "907350"
  },
  {
    "text": "default and to choose the candidate so let's see we want for instance to",
    "start": "907350",
    "end": "912899"
  },
  {
    "text": "failover to cube Kanpur 21 and there are other things when the devil will take",
    "start": "912899",
    "end": "919019"
  },
  {
    "text": "place you can schedule it for instance to happen here with the night and so I say let's demote it so let's see what",
    "start": "919019",
    "end": "927180"
  },
  {
    "text": "happens yep I think we switch the leader to",
    "start": "927180",
    "end": "933839"
  },
  {
    "text": "Patroni 1 and we can see that yes the",
    "start": "933839",
    "end": "941130"
  },
  {
    "text": "master switched the replicas are being initialized and what about connections",
    "start": "941130",
    "end": "947279"
  },
  {
    "text": "so connections are still running that means that favor one went successfully",
    "start": "947279",
    "end": "953060"
  },
  {
    "text": "and we have some features inside the training so it's not just favorable it",
    "start": "953060",
    "end": "959370"
  },
  {
    "text": "supports different replication modes you can do synchronous replication if you want to make sure that your you don't",
    "start": "959370",
    "end": "965100"
  },
  {
    "text": "lose your data it supports cascading dynamic configure cascading replication it supports dynamically configuring your Postgres",
    "start": "965100",
    "end": "971370"
  },
  {
    "text": "cluster basically setting the Postgres parameters on the fly and if these parameter requires advise you to restart",
    "start": "971370",
    "end": "977880"
  },
  {
    "text": "your Possible's instance then Petronio set a special flag and then you can say please restart only if we start is",
    "start": "977880",
    "end": "984569"
  },
  {
    "text": "required at 3 a.m. to the night when no active equations and but we will do this for you and supports",
    "start": "984569",
    "end": "992220"
  },
  {
    "text": "cluster maintenance if you need to do something like make something like major upgrades you can turn off automatic",
    "start": "992220",
    "end": "998189"
  },
  {
    "text": "failover completely for a certain amount of time to be upgrade and then get back yeah and supports managing itself using",
    "start": "998189",
    "end": "1006709"
  },
  {
    "text": "patron Ezekiel and it supports race KPIs so some parameters will be covered and the demo is already done so we managed",
    "start": "1006709",
    "end": "1014269"
  },
  {
    "text": "to get the failover two times and still have the master so with that I will get to decided okay so one of the other",
    "start": "1014269",
    "end": "1024829"
  },
  {
    "text": "things one of the reasons why I got really interested in running PostgreSQL on kubernetes is that there's a lot of",
    "start": "1024829",
    "end": "1031220"
  },
  {
    "text": "new various versions experimental often experimental versions of clustered postcards being released these days and",
    "start": "1031220",
    "end": "1040329"
  },
  {
    "text": "kubernetes provides an excellent test environment for these sorts of clusters",
    "start": "1040329",
    "end": "1046579"
  },
  {
    "text": "because otherwise in order to run a test you end up spending an hour hour and a half on actually doing a conventional",
    "start": "1046579",
    "end": "1053000"
  },
  {
    "text": "deployment as opposed to just being able deploy bunsen containers including testing on the same machine now the one",
    "start": "1053000",
    "end": "1060770"
  },
  {
    "text": "that I actually show you is one of the projects I'm involved with which is situs TB so situs TB is started parallel",
    "start": "1060770",
    "end": "1067789"
  },
  {
    "text": "Postgres it's Postgres plus an extension that you install and you use that",
    "start": "1067789",
    "end": "1076610"
  },
  {
    "text": "extension in order to partition data over the nodes near cluster and you can",
    "start": "1076610",
    "end": "1082159"
  },
  {
    "text": "have the shards duplicate for redundancy the query node it's organized into a",
    "start": "1082159",
    "end": "1089120"
  },
  {
    "text": "query node or more than one query node and then a set of shard nodes and the",
    "start": "1089120",
    "end": "1095899"
  },
  {
    "text": "query node automatically routes passed distributes queries out to the shard",
    "start": "1095899",
    "end": "1101929"
  },
  {
    "text": "notes by in order to distribute the query work over the shard nodes this is",
    "start": "1101929",
    "end": "1107809"
  },
  {
    "text": "mainly aimed at Big Data data mining news cases where you're looking to",
    "start": "1107809",
    "end": "1114010"
  },
  {
    "text": "paralyze queries not just in one database system but over a whole bunch of databases",
    "start": "1114010",
    "end": "1119979"
  },
  {
    "text": "so the way that I actually have the stateful set for this and the home cart organized is you have one query node",
    "start": "1119979",
    "end": "1127450"
  },
  {
    "text": "which is no zero you have however you know - - however many shards and then",
    "start": "1127450",
    "end": "1134950"
  },
  {
    "text": "your service is going to direct connections to the query node only because that's what you should run",
    "start": "1134950",
    "end": "1140349"
  },
  {
    "text": "queries so now this is actually a good example to look at a sort of bot pattern",
    "start": "1140349",
    "end": "1147869"
  },
  {
    "text": "because you'll find the one for pitoni is quite sophisticated because petronia is now Petronius philo in our production",
    "start": "1147869",
    "end": "1153639"
  },
  {
    "text": "system and so that has to accommodate a whole bunch of different logic because",
    "start": "1153639",
    "end": "1159159"
  },
  {
    "text": "I've been doing the situs one more for testing our sort of bot is a lot simpler",
    "start": "1159159",
    "end": "1165570"
  },
  {
    "text": "looks actually you clean them yep",
    "start": "1165570",
    "end": "1172179"
  },
  {
    "text": "oh wait wait there we go ok you want to flip it to mine however",
    "start": "1172179",
    "end": "1178929"
  },
  {
    "text": "however that worked I don't go okay this is I've actually been streaming all of",
    "start": "1178929",
    "end": "1184869"
  },
  {
    "text": "the Wikipedia edits for the past couple of days into a cluster that I set up so we'd actually have some data so see what",
    "start": "1184869",
    "end": "1196779"
  },
  {
    "text": "we got here so we actually look at the chart for this the Oh actually the turn",
    "start": "1196779",
    "end": "1205299"
  },
  {
    "text": "is not going to show us",
    "start": "1205299",
    "end": "1208648"
  },
  {
    "text": "oh okay",
    "start": "1211330",
    "end": "1217919"
  },
  {
    "text": "so we actually look at this we've got a much simpler sort of bot arrangement where it says hey we've got a bunch of",
    "start": "1224780",
    "end": "1232820"
  },
  {
    "text": "set up here for adding labels and that sort of thing and then we have a much",
    "start": "1232820",
    "end": "1240050"
  },
  {
    "text": "simpler chart arrangement where if we've spun up it's good to the actual logic",
    "start": "1240050",
    "end": "1247580"
  },
  {
    "text": "err you know first we see whether or not the data is initialized and we say hey if the data is not initialized then I'm",
    "start": "1247580",
    "end": "1254180"
  },
  {
    "text": "going to go ahead and initialize the post with data directory set up some initial users based on the credentials that have been passed to us as part of",
    "start": "1254180",
    "end": "1261620"
  },
  {
    "text": "the config map and then we go through there and we say hey if this is the",
    "start": "1261620",
    "end": "1268190"
  },
  {
    "text": "query node which we determine by having it be the first node then we're going to go ahead and register all the nodes that",
    "start": "1268190",
    "end": "1274670"
  },
  {
    "text": "we expect to have but we also have logic that says hey if this is a shard node I'm going to check and make sure I'm",
    "start": "1274670",
    "end": "1281330"
  },
  {
    "text": "registered with the master and if I'm not I'm going to register myself and that's in case you want to add more",
    "start": "1281330",
    "end": "1286910"
  },
  {
    "text": "shards later right so it needs to actually work by autopilot there and then update the labels",
    "start": "1286910",
    "end": "1295600"
  },
  {
    "text": "sorry not me that's up so that's a it's a much simpler example of the sort of bot pattern if you actually want to look",
    "start": "1300840",
    "end": "1307059"
  },
  {
    "text": "at doing that for your own deployments and then what he'll mainly gives us is",
    "start": "1307059",
    "end": "1312220"
  },
  {
    "text": "it gives a little parameterization where you know we can actually supply a name",
    "start": "1312220",
    "end": "1317470"
  },
  {
    "text": "for the application in the sequester cluster size storage allocation for the",
    "start": "1317470",
    "end": "1323020"
  },
  {
    "text": "individual shards and then of course credentials so so if we actually look at",
    "start": "1323020",
    "end": "1335160"
  },
  {
    "text": "so we've got some simple I you know for inches we have in here how many replicas we're going to have deploy all that what",
    "start": "1339600",
    "end": "1346420"
  },
  {
    "text": "are potentials",
    "start": "1346420",
    "end": "1349140"
  },
  {
    "text": "and there's several bits to this chart but here's the main part which is the",
    "start": "1358800",
    "end": "1364500"
  },
  {
    "text": "stateful set sorry everything still named pet set because I started developing this one it was actually still named cadets at the and you know",
    "start": "1364500",
    "end": "1372540"
  },
  {
    "text": "and then we're actually pulling down all of that information from from the chart but you can see we're just going through",
    "start": "1372540",
    "end": "1377730"
  },
  {
    "text": "and using that to set a bunch of parameters which are going to get passed through to the to the startup the",
    "start": "1377730",
    "end": "1383760"
  },
  {
    "text": "bootstrap the bot script as it were so",
    "start": "1383760",
    "end": "1391160"
  },
  {
    "text": "so I set up because actually wanted to load it with data I went ahead and",
    "start": "1398920",
    "end": "1404080"
  },
  {
    "text": "deployed a situs cluster the day before yesterday using the home chart so here",
    "start": "1404080",
    "end": "1409930"
  },
  {
    "text": "we have a seven node situs cluster one query node and six charge and and now",
    "start": "1409930",
    "end": "1423460"
  },
  {
    "text": "here we are logged into the database",
    "start": "1423460",
    "end": "1426779"
  },
  {
    "text": "what is it when I know them not floral that's the",
    "start": "1432150",
    "end": "1442499"
  },
  {
    "text": "problem so and here is from inside the",
    "start": "1442499",
    "end": "1448889"
  },
  {
    "text": "Postma's database with sizes all showing it's a list of nodes and then each node",
    "start": "1448889",
    "end": "1454409"
  },
  {
    "text": "is then going to have a set of cards on",
    "start": "1454409",
    "end": "1461369"
  },
  {
    "text": "it and the far because it's all half",
    "start": "1461369",
    "end": "1466619"
  },
  {
    "text": "distributed over the primary key values for the tables or some other identified",
    "start": "1466619",
    "end": "1471809"
  },
  {
    "text": "key depending on how you've identified it you can see here are the master copies of the table here and the whole",
    "start": "1471809",
    "end": "1478320"
  },
  {
    "text": "point of this is to be able to run things faster",
    "start": "1478320",
    "end": "1484309"
  },
  {
    "text": "so for example let's see we've had 1.4 million edits to Wikipedia in the last two days",
    "start": "1491250",
    "end": "1497240"
  },
  {
    "text": "which is where you actually can see that we bought the the Wikipedia spam bot",
    "start": "1497240",
    "end": "1504150"
  },
  {
    "text": "problem is a real problem don't worry",
    "start": "1504150",
    "end": "1512480"
  },
  {
    "text": "there we go so for example this is actually an example query no that is not",
    "start": "1513140",
    "end": "1522659"
  },
  {
    "text": "what I wanted well sorry what I'm showing you that this is actually a query that I've got",
    "start": "1522659",
    "end": "1529500"
  },
  {
    "text": "is an example where it looks at somebody's logging information from the edits whether or not it's an IP address",
    "start": "1529500",
    "end": "1536909"
  },
  {
    "text": "and a couple of other things to make it see whether it's probable that it's a bot versus a real person and then counts",
    "start": "1536909",
    "end": "1543480"
  },
  {
    "text": "up the edits here and actually things have gotten better using that heuristic because the first",
    "start": "1543480",
    "end": "1550110"
  },
  {
    "text": "time I ran this last year it was more half and half as opposed to 1/3 and 2/3",
    "start": "1550110",
    "end": "1557090"
  },
  {
    "text": "so but the main you know point is this is that actually now I have to get this set up when we do a new release of",
    "start": "1557090",
    "end": "1563909"
  },
  {
    "text": "siteís it's easier for me to test it by deploying it on kubernetes cluster than anything else and by extending some of",
    "start": "1563909",
    "end": "1571260"
  },
  {
    "text": "the charts and stuff that I have you could actually very quickly go to having",
    "start": "1571260",
    "end": "1576450"
  },
  {
    "text": "a production deployment so we have a",
    "start": "1576450",
    "end": "1581700"
  },
  {
    "text": "number of resources and other things up on a website there's the Patroni main",
    "start": "1581700",
    "end": "1588169"
  },
  {
    "text": "main chart the my various database efforts in atomic DB lb keep adding more",
    "start": "1588169",
    "end": "1593490"
  },
  {
    "text": "postcode cluster examples to this BDR and multi master synchronous and some of",
    "start": "1593490",
    "end": "1598530"
  },
  {
    "text": "the other new clustering types that we have proposed for us you know plus whoops I thought I fixed that okay that",
    "start": "1598530",
    "end": "1606330"
  },
  {
    "text": "is the wrong link for the presentation the go-to J brokers that could have died",
    "start": "1606330",
    "end": "1612260"
  },
  {
    "text": "out and just link to that and as well as some of the other things we can look at for resources so we have a seven eight",
    "start": "1612260",
    "end": "1624890"
  },
  {
    "text": "minutes questions okay go ahead right",
    "start": "1624890",
    "end": "1633980"
  },
  {
    "text": "there yeah yeah yeah and we looked at",
    "start": "1633980",
    "end": "1668540"
  },
  {
    "text": "actually implementing an operator for Patroni but we would do that by having it communicate with a Patroni api the I",
    "start": "1668540",
    "end": "1677930"
  },
  {
    "text": "already said earlier why I'm opposed to centralized controllers as a design because the problem with centralized",
    "start": "1677930",
    "end": "1684710"
  },
  {
    "text": "controllers is you can't tell the difference between ceasing operation and losing communication and so we're always",
    "start": "1684710",
    "end": "1692240"
  },
  {
    "text": "going to say hey the thing that's going to determine whether or not post post is up or not is going to be in the pod more",
    "start": "1692240",
    "end": "1701210"
  },
  {
    "text": "questions",
    "start": "1701210",
    "end": "1703570"
  },
  {
    "text": "yeah okay so question was how you make backups with situs Phoebe",
    "start": "1709960",
    "end": "1715490"
  },
  {
    "text": "the there might be something for the enterprise version because they've",
    "start": "1715490",
    "end": "1720860"
  },
  {
    "text": "they're a start-up so they have a commercial version that has a bunch of extra services there might be a backup tool for the enterprise version",
    "start": "1720860",
    "end": "1728830"
  },
  {
    "text": "otherwise you pretty much have to take continuous backups and try to",
    "start": "1728830",
    "end": "1736850"
  },
  {
    "text": "synchronize them yourself the that being said situs doesn't",
    "start": "1736850",
    "end": "1743690"
  },
  {
    "text": "actually care if your shards are a few seconds out of sync now that might cause some inconsistency",
    "start": "1743690",
    "end": "1749809"
  },
  {
    "text": "in your data but situs will still work so the way I would do it if I wasn't",
    "start": "1749809",
    "end": "1755840"
  },
  {
    "text": "using the the Enterprise version would be to take continuous backups and then try to restore them to the same commit",
    "start": "1755840",
    "end": "1761630"
  },
  {
    "text": "point more questions go back get the two",
    "start": "1761630",
    "end": "1770049"
  },
  {
    "text": "question was how big of a data set for the noticeable speed-up in charting the difference comes when you can fit the",
    "start": "1774340",
    "end": "1780649"
  },
  {
    "text": "data in memory on multiple nodes but you can't fit it in memory on one node that's pretty much it is or alternately",
    "start": "1780649",
    "end": "1789289"
  },
  {
    "text": "I at a much larger size when you can fit the working set in memory on multiple",
    "start": "1789289",
    "end": "1794510"
  },
  {
    "text": "nodes but not in one node you know if you can get enough memory to cache your whole database on one you know machine",
    "start": "1794510",
    "end": "1801169"
  },
  {
    "text": "or Amazon instance or whatever do that it's always going to be easier you know charting is for one that's no longer",
    "start": "1801169",
    "end": "1806750"
  },
  {
    "text": "possible",
    "start": "1806750",
    "end": "1808929"
  },
  {
    "text": "[Music]",
    "start": "1815720",
    "end": "1818900"
  },
  {
    "text": "yeah so basically we use the major minor version but now we are switching to the",
    "start": "1825090",
    "end": "1830500"
  },
  {
    "text": "major minor and the patch said basically semantic versioning because we at some",
    "start": "1830500",
    "end": "1835750"
  },
  {
    "text": "point released version I think 1.1 and found out an issue immediately and that we decided not to release 1.2 I decided",
    "start": "1835750",
    "end": "1843850"
  },
  {
    "text": "to raise 1.1.1 so yeah but we are doing",
    "start": "1843850",
    "end": "1849190"
  },
  {
    "text": "these pretty consistently so expect the next version to be like 1.3 the major",
    "start": "1849190",
    "end": "1854530"
  },
  {
    "text": "one and minor one probably like we increment my number yeah but I believe",
    "start": "1854530",
    "end": "1864460"
  },
  {
    "text": "it was committed so we are waiting for some other small changes mainly to get",
    "start": "1864460",
    "end": "1869800"
  },
  {
    "text": "together the contributors in order to release the next version so there are some patches there's a sample which",
    "start": "1869800",
    "end": "1876220"
  },
  {
    "text": "person has to be nourished close",
    "start": "1876220",
    "end": "1879390"
  },
  {
    "text": "[Music]",
    "start": "1885970",
    "end": "1889069"
  },
  {
    "text": "yeah so the question is is it possible to communicate with a city cluster securely yeah we sort Patroni supports",
    "start": "1898070",
    "end": "1906210"
  },
  {
    "text": "using passwords and usernames in order to communicate there and yeah you can use tables as well",
    "start": "1906210",
    "end": "1912020"
  },
  {
    "text": "we we actually don't use it inside the lambda because because we don't have",
    "start": "1912020",
    "end": "1917640"
  },
  {
    "text": "these we don't communicate the ICD via Internet to the HCD but if you have any",
    "start": "1917640",
    "end": "1923280"
  },
  {
    "text": "issues you can just create the issue only partially get happen a little take a look",
    "start": "1923280",
    "end": "1929720"
  },
  {
    "text": "yeah",
    "start": "1938300",
    "end": "1941300"
  },
  {
    "text": "yeah basically if petronia has any way to actually learn in that here so the question is if you dig the pot with",
    "start": "1956510",
    "end": "1963570"
  },
  {
    "text": "cubes if your brain will be graceful fail will happen and I never I haven't",
    "start": "1963570",
    "end": "1969120"
  },
  {
    "text": "actually tested this use case in case you just kill the pot the petroleum it",
    "start": "1969120",
    "end": "1974730"
  },
  {
    "text": "would take some time for training to learn that the muscle is not there basically the key in EDD has to expire",
    "start": "1974730",
    "end": "1982500"
  },
  {
    "text": "and then the other nodes will see there is no key and initiate elections but if",
    "start": "1982500",
    "end": "1988410"
  },
  {
    "text": "you do using if you suspect Ronnie CTL then you explicitly inform the master",
    "start": "1988410",
    "end": "1994470"
  },
  {
    "text": "that it has to step down and then if you remove the key and at the same time",
    "start": "1994470",
    "end": "1999900"
  },
  {
    "text": "inform all other nodes that the key is not there and they will stop the election immediately that's the",
    "start": "1999900",
    "end": "2005630"
  },
  {
    "text": "difference and in case of cube city of brain I actually don't know so it might be that actually you know about this it",
    "start": "2005630",
    "end": "2013730"
  },
  {
    "text": "receives a signal the master will be able to receive a signal from from the pot if it won't be able to receive the",
    "start": "2013730",
    "end": "2020630"
  },
  {
    "text": "signal then it will be a graceful failover and you'll have to wait we will play time out until the key expires",
    "start": "2020630",
    "end": "2028330"
  },
  {
    "text": "[Music]",
    "start": "2030490",
    "end": "2033599"
  },
  {
    "text": "if we actually receive the signal then yes petronia left come please and step down any more questions okay well thank",
    "start": "2035720",
    "end": "2045470"
  },
  {
    "text": "you very much thank you",
    "start": "2045470",
    "end": "2048490"
  }
]