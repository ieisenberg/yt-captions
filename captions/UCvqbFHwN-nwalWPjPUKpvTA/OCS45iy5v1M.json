[
  {
    "text": "so today we're gonna be doing a presentation and to talk about migrating from MySQL to MySQL with the tests I had",
    "start": "539",
    "end": "9900"
  },
  {
    "text": "intended to do a little demo at the end I made some assumptions about the networking that turned out to be not",
    "start": "9900",
    "end": "16139"
  },
  {
    "text": "true so I'm not sure of that'll work but I'll try the best I'll talk through the examples and sort of like talking about",
    "start": "16139",
    "end": "22439"
  },
  {
    "text": "using a canary to make sure that our risk is low really I want to take the focus here if you know you've got an",
    "start": "22439",
    "end": "29550"
  },
  {
    "text": "application this is the application that's you know your core business how do we really reduce that risk to be able",
    "start": "29550",
    "end": "34800"
  },
  {
    "text": "to get to the test I'll sort of preface that by giving a",
    "start": "34800",
    "end": "39960"
  },
  {
    "text": "very brief introduction about the test for those who are not familiar and I will ask for a show of hands who's not",
    "start": "39960",
    "end": "45239"
  },
  {
    "text": "familiar with the tests all right so I was as justified in adding this slide",
    "start": "45239",
    "end": "51660"
  },
  {
    "text": "that's about 50% so the tests in in summary is a cloud native database so",
    "start": "51660",
    "end": "58649"
  },
  {
    "text": "the test allows you to operate essentially MySQL and we'll get to that in a second in a very kubernetes like",
    "start": "58649",
    "end": "65670"
  },
  {
    "text": "way so traditionally with with monolithic databases you treat them like",
    "start": "65670",
    "end": "70790"
  },
  {
    "text": "monoliths and you kind of tend to them individually like they're pets rather than like they're cattle and so",
    "start": "70790",
    "end": "77700"
  },
  {
    "text": "the tests allows you to not have to have those databases to the side as you move to to kubernetes so you can bring them",
    "start": "77700",
    "end": "84119"
  },
  {
    "text": "with you and you can manage your MySQL in a very similar way the tests it",
    "start": "84119",
    "end": "90770"
  },
  {
    "text": "project origin came out of YouTube actually and being part of Google also",
    "start": "90770",
    "end": "96450"
  },
  {
    "text": "where kubernetes came from that's sort of where some of that synergy comes from but one of the goals of the tests was to",
    "start": "96450",
    "end": "102540"
  },
  {
    "text": "allow you to us or horizontally scale MySQL so that you can achieve massive scalability as you need to add capacity",
    "start": "102540",
    "end": "109079"
  },
  {
    "text": "to a MySQL service you know in a traditional monolithic way you would have scaled up now you can scale out as",
    "start": "109079",
    "end": "115380"
  },
  {
    "text": "well by horizontally adding nodes it also provides a level of orchestration",
    "start": "115380",
    "end": "120869"
  },
  {
    "text": "around MySQL so that you can have high availability so it uses what what we",
    "start": "120869",
    "end": "126180"
  },
  {
    "text": "recommend semi synchronous replication see how if you as you make a modification through your application",
    "start": "126180",
    "end": "132480"
  },
  {
    "text": "make sure that at least couple of the nodes have copies of the data so that you can have recovery and",
    "start": "132480",
    "end": "137739"
  },
  {
    "text": "finally the last point is that it's fairly easy to migrate into the tests because to your applications it looks",
    "start": "137739",
    "end": "144260"
  },
  {
    "text": "like it's MySQL and it is based on MySQL and we'll describe that in just a couple of slides forward when we go into",
    "start": "144260",
    "end": "150230"
  },
  {
    "text": "architecture of a test recently graduated as a CNC F project it's the",
    "start": "150230",
    "end": "156110"
  },
  {
    "text": "8th project to be able to do that so that's something that we're very excited on this there's a couple of maintain is",
    "start": "156110",
    "end": "161300"
  },
  {
    "text": "in the room the tests has a lot of adoption in terms of where these",
    "start": "161300",
    "end": "166760"
  },
  {
    "text": "contributors come from and how many individual people are helping drive the test forward the project as I said",
    "start": "166760",
    "end": "174019"
  },
  {
    "text": "started in YouTube in 2010 became a CN CF project in 2018 and I graduated just",
    "start": "174019",
    "end": "179660"
  },
  {
    "text": "in the last month so some of the key adopters if you saw this morning's",
    "start": "179660",
    "end": "184819"
  },
  {
    "text": "keynote one of the really interesting ones is how slack is using the test they",
    "start": "184819",
    "end": "190340"
  },
  {
    "text": "actually have a talk on right now so thank you for for joining me also JD is the largest known cluster",
    "start": "190340",
    "end": "197510"
  },
  {
    "text": "that we know of of the tests where they're running 35 million queries per second peak this is the architecture of",
    "start": "197510",
    "end": "205370"
  },
  {
    "text": "a tests and I think this slide will be really interesting as we go through the examples today on the on the very far",
    "start": "205370",
    "end": "211970"
  },
  {
    "text": "side you can see this is your application and your application could be anything anything that has a MySQL",
    "start": "211970",
    "end": "218540"
  },
  {
    "text": "connector or MySQL driver and wants to be able to speak to MySQL it can speak",
    "start": "218540",
    "end": "223820"
  },
  {
    "text": "to the tests because the test speaks the MySQL protocol or rather the component of the tests that that presents this",
    "start": "223820",
    "end": "231410"
  },
  {
    "text": "MySQL view of the world to your application is something called VT gate so VT gate is a stateless proxy that can",
    "start": "231410",
    "end": "240440"
  },
  {
    "text": "do routing to make sure that you're connected to the correct MySQL server to be able to retrieve that data that you",
    "start": "240440",
    "end": "246920"
  },
  {
    "text": "needed to acces I can also do other features such as if it had to access more than one MySQL server underneath it",
    "start": "246920",
    "end": "253519"
  },
  {
    "text": "can scatter gather and it can join those results together so many but not all of",
    "start": "253519",
    "end": "259190"
  },
  {
    "text": "the my SQL queries that you could execute on regular MySQL you can execute in the test as well so things like joins",
    "start": "259190",
    "end": "266510"
  },
  {
    "text": "and transactions are supported so beneath bt gate we have",
    "start": "266510",
    "end": "272420"
  },
  {
    "text": "our tablets tablets is the Vitesse terminology to say this is a combination",
    "start": "272420",
    "end": "277700"
  },
  {
    "text": "of a V T tablet process and a MySQL server the test actually does use my skill onto the hood to be able to store",
    "start": "277700",
    "end": "284300"
  },
  {
    "text": "data which is a good thing MySQL you know it's it's a very stable product with a lot of history and",
    "start": "284300",
    "end": "290270"
  },
  {
    "text": "actually its performance on a single node basis is very good it's just that it doesn't allow you to scale",
    "start": "290270",
    "end": "296060"
  },
  {
    "text": "horizontally and this is where the test comes in and helps you be able to do that so you can have many tablet servers",
    "start": "296060",
    "end": "303490"
  },
  {
    "text": "many VT Gate servers and your application just sees a single view of",
    "start": "303490",
    "end": "308510"
  },
  {
    "text": "the world where it sees a single database that it's used to connecting to it doesn't have to know this detail it's",
    "start": "308510",
    "end": "314600"
  },
  {
    "text": "sort of under the under the covers which is why we have this line that delineates between your application and with the",
    "start": "314600",
    "end": "322070"
  },
  {
    "text": "tests okay some details not showing here but but also worth knowing the test",
    "start": "322070",
    "end": "328250"
  },
  {
    "text": "natively supports the concept of a cell or a data center so you can have some of",
    "start": "328250",
    "end": "334700"
  },
  {
    "text": "your tablet's located in DCP and some other ones located in AWS in the YouTube",
    "start": "334700",
    "end": "342440"
  },
  {
    "text": "case they had many data centers around the world and they used the tests to be able to manage this at a simple level I",
    "start": "342440",
    "end": "349760"
  },
  {
    "text": "don't want you to think of the test as as VT gate you know routing and being a proxy is part of it but the test is",
    "start": "349760",
    "end": "355910"
  },
  {
    "text": "really an orchestration system it helps manage these MySQL service and as I said allows you to not treat them like pets",
    "start": "355910",
    "end": "362479"
  },
  {
    "text": "so if you do have a failure you can use the tests to be able to help you recover and have another node replaced that in a",
    "start": "362479",
    "end": "370910"
  },
  {
    "text": "very cloud like kubernetes like way ok",
    "start": "370910",
    "end": "376720"
  },
  {
    "text": "any questions so far about the architecture",
    "start": "376720",
    "end": "382000"
  },
  {
    "text": "yeah yeah that's a great question so",
    "start": "383560",
    "end": "393290"
  },
  {
    "text": "I'll repeat the question do we have any plans to support other databases you know in the case of YouTube they use",
    "start": "393290",
    "end": "399470"
  },
  {
    "text": "MySQL so that's how they test started but the test is fairly agnostic so we do",
    "start": "399470",
    "end": "405200"
  },
  {
    "text": "have we do have ideas and we do have plans but but we're not currently",
    "start": "405200",
    "end": "410300"
  },
  {
    "text": "implementing it it'll it'll come in the future we'd love to support Postgres we think it's a great idea does the VT",
    "start": "410300",
    "end": "422630"
  },
  {
    "text": "tablet make sure those shards are in sync with the master I will throw in a level of detail that I didn't show but",
    "start": "422630",
    "end": "428720"
  },
  {
    "text": "is on my slide the metadata is stored in something we call a topology server and both the tablets and the VT gates can",
    "start": "428720",
    "end": "436340"
  },
  {
    "text": "connect to the the topology server which is your choice of @cd which is the most",
    "start": "436340",
    "end": "442250"
  },
  {
    "text": "common these days or zookeeper or console to be able to store that state information it's not actually connected",
    "start": "442250",
    "end": "448910"
  },
  {
    "text": "to as part of the active query serving path but this is where the metadata resides to kind of keep that that",
    "start": "448910",
    "end": "456050"
  },
  {
    "text": "routing information",
    "start": "456050",
    "end": "458949"
  },
  {
    "text": "does VT gate ever connect directly to my school dunno it accesses via the tablet and actually a detail we've not shown",
    "start": "464230",
    "end": "471040"
  },
  {
    "text": "here is that bt gates VT tablet is a g RPC protocol and then it converts it back to MySQL D here your application",
    "start": "471040",
    "end": "478570"
  },
  {
    "text": "you know in most common usage these eight people do connect by the MySQL protocol but there's also a G RPC",
    "start": "478570",
    "end": "483940"
  },
  {
    "text": "protocol directly to VC gate as well the",
    "start": "483940",
    "end": "490000"
  },
  {
    "text": "underlying storage is mysqld yeah so you can choose your choice of in Oh DB which is the most common or we have some users",
    "start": "490000",
    "end": "497620"
  },
  {
    "text": "that have used hoc PDB it's really up to you I think in the future we'll see some",
    "start": "497620",
    "end": "503470"
  },
  {
    "text": "rocks TV adoption as well it's fairly agnostic and how it operates there I",
    "start": "503470",
    "end": "510180"
  },
  {
    "text": "don't know if I caught your question but I'll try and tell me if I'm wrong could you connect directly to to the VT",
    "start": "519960",
    "end": "528160"
  },
  {
    "text": "tablet or connect directly to the VT gate with G RPC yeah you can connect directly with G RPC to the VT gate",
    "start": "528160",
    "end": "534960"
  },
  {
    "text": "that's officially supported yeah that was the original way that will actually operate inside YouTube and there are",
    "start": "534960",
    "end": "541630"
  },
  {
    "text": "drivers for Java PHP and Python that a gr pc-based",
    "start": "541630",
    "end": "547090"
  },
  {
    "text": "to the VT gate",
    "start": "547090",
    "end": "550200"
  },
  {
    "text": "I would prefer my sequel to be honest there are just a couple of differences",
    "start": "553170",
    "end": "558209"
  },
  {
    "text": "in features but there's so many connectors that are available for MySQL that it's just easier for your application to be able to to figure that",
    "start": "558209",
    "end": "565319"
  },
  {
    "text": "out in debug the last question yep yeah",
    "start": "565319",
    "end": "573839"
  },
  {
    "text": "so how would this interact with something like Google Cloud seek oh that is a great question I in my next slide",
    "start": "573839",
    "end": "580889"
  },
  {
    "text": "as we get into the migration it is possible to be able to do a Google Cloud sequel migration using the same",
    "start": "580889",
    "end": "587009"
  },
  {
    "text": "methodology that I'm describing today um the VT tablet of detail I'm not showing that I'll show in that so the",
    "start": "587009",
    "end": "593279"
  },
  {
    "text": "next slide forward is it can actually connect to an external MySQL so you could actually use the tests with your",
    "start": "593279",
    "end": "600329"
  },
  {
    "text": "instance is managed by cloud sequel but typically people opt for the fully",
    "start": "600329",
    "end": "605579"
  },
  {
    "text": "Vitesse managed style as that you know does this failure of is for you and it's",
    "start": "605579",
    "end": "611160"
  },
  {
    "text": "just a little bit nicer I did say last question okay one more all right yeah we",
    "start": "611160",
    "end": "618779"
  },
  {
    "text": "actually released a benchmark at the company I work for a planet scale that showed that if you put the tests on top",
    "start": "618779",
    "end": "624209"
  },
  {
    "text": "of Aurora you can horizontally scale or and that's the real value add as it doesn't horizontally scale itself and we",
    "start": "624209",
    "end": "630899"
  },
  {
    "text": "had just massive numbers I think 16 million TV CC Trent transactions per second per minute per minute thank you",
    "start": "630899",
    "end": "638369"
  },
  {
    "text": "as a result of that yeah I would recommend that you use both pots but you could just use one pot you could just",
    "start": "638369",
    "end": "643379"
  },
  {
    "text": "use the layer above with the VGA and not the management okay so let's talk about what we're going to be getting up to",
    "start": "643379",
    "end": "648839"
  },
  {
    "text": "today we're going to be migrating from a legacy legacy is a bad word but from a",
    "start": "648839",
    "end": "656449"
  },
  {
    "text": "monolith MySQL server to the tests",
    "start": "656449",
    "end": "662119"
  },
  {
    "text": "monolith is a bad word ulcer okay from a MySQL server to the test and we want to make sure that we reduce our",
    "start": "662119",
    "end": "668699"
  },
  {
    "text": "risk as much as possible right we want to make sure that you know we know our queries are compatible with the tests a",
    "start": "668699",
    "end": "675209"
  },
  {
    "text": "latency don't go up and we want to be able to use a really responsible ops process which is to be able to use a",
    "start": "675209",
    "end": "681959"
  },
  {
    "text": "canary to be able to get there and you can do this with the test you can't do this with all database migrations",
    "start": "681959",
    "end": "687120"
  },
  {
    "text": "it's very hard to be able to do that but you can't do this with the test so let's talk about these three three problems",
    "start": "687120",
    "end": "692670"
  },
  {
    "text": "first how we test our queries to know that they're compatible with the tests I",
    "start": "692670",
    "end": "699480"
  },
  {
    "text": "think it's obviously best to start this with dev and QA maybe have a test suite maybe you can validate this but I've",
    "start": "699480",
    "end": "706020"
  },
  {
    "text": "always still cautious when we get to production that we have to validate this in production sometimes you have",
    "start": "706020",
    "end": "711810"
  },
  {
    "text": "applications where users can click on buttons in a certain sequence and that's not covered by your test suite or that",
    "start": "711810",
    "end": "717420"
  },
  {
    "text": "generates a query that's really special and so I want to be able to validate that in production and I want to know",
    "start": "717420",
    "end": "724440"
  },
  {
    "text": "that it's able to execute in the test as it did in MySQL there's one thing to note about the the architecture that we",
    "start": "724440",
    "end": "730830"
  },
  {
    "text": "have for the test that it's got that VT gate layer it adds an extra network hop",
    "start": "730830",
    "end": "736650"
  },
  {
    "text": "and actually frequently you'll even put a load balance in front of those VT gates so you can balance between them",
    "start": "736650",
    "end": "741720"
  },
  {
    "text": "and that would be two extra network hops so you have to make sure that this doesn't impact our application in a",
    "start": "741720",
    "end": "747810"
  },
  {
    "text": "negative way right so an easy back of napkin math way of doing this is project",
    "start": "747810",
    "end": "753089"
  },
  {
    "text": "about a milli second or two per per query that is going to be added by the tests and so your application you know",
    "start": "753089",
    "end": "760050"
  },
  {
    "text": "in the specific case that it uses like row at a time processing with n plus one I think it could see that it gets a",
    "start": "760050",
    "end": "767100"
  },
  {
    "text": "regression it's not that easy to say yes or no some applications actually see an",
    "start": "767100",
    "end": "772950"
  },
  {
    "text": "improvement because in the MySQL case they were just so overloaded that queries were taking longer when they",
    "start": "772950",
    "end": "778980"
  },
  {
    "text": "moved to the tests VT gate has some other nice features like connection pooling that could actually lead to an",
    "start": "778980",
    "end": "784709"
  },
  {
    "text": "improvement but anyway if you want to be responsible we want to be able to test this and make sure that this doesn't",
    "start": "784709",
    "end": "790500"
  },
  {
    "text": "impact our app and you want to fix these in your app anyway if they are n plus 1 issues if they're not fixable then maybe",
    "start": "790500",
    "end": "797190"
  },
  {
    "text": "you might have to design the app a little bit different to use threads to be able to access in parallel and then",
    "start": "797190",
    "end": "804180"
  },
  {
    "text": "as we validate these things we want to make sure that we're able to back out and I said the test is is exceptionally",
    "start": "804180",
    "end": "810600"
  },
  {
    "text": "good at this that we're able to operate with the ability to say no you know this looked like it was doing well in QA",
    "start": "810600",
    "end": "816780"
  },
  {
    "text": "looked like it was doing well in dev but we're seeing some sort of elevated real agencies or some sort of careers",
    "start": "816780",
    "end": "822870"
  },
  {
    "text": "want to be able to take a step back and move back to our previous infrastructure",
    "start": "822870",
    "end": "827910"
  },
  {
    "text": "and so let's talk about it let's talk about it through the architecture so I revisit this slide for a second and say",
    "start": "827910",
    "end": "834720"
  },
  {
    "text": "this is a fully deployed Vitesse where we've got our bt8 and we've got our tablets that are managed by private",
    "start": "834720",
    "end": "840660"
  },
  {
    "text": "tests and then off to the side we've got our topology server and out VT CTL which is the D which is the management I",
    "start": "840660",
    "end": "847470"
  },
  {
    "text": "didn't mention that this is our canary deployment model this is how we get started with the tests under this model",
    "start": "847470",
    "end": "853520"
  },
  {
    "text": "so we have our application which mostly connects to the existing MySQL server",
    "start": "853520",
    "end": "859320"
  },
  {
    "text": "and then we have the test with VT gate to the side we have to modify our",
    "start": "859320",
    "end": "865709"
  },
  {
    "text": "application you know maybe we're able to do this where we can tag a self as a",
    "start": "865709",
    "end": "870899"
  },
  {
    "text": "particular user to say rather than going to the regular MySQL server you go to VT gate or maybe we just modify one",
    "start": "870899",
    "end": "879330"
  },
  {
    "text": "application server to be able to do this and then we start ramping up the traffic right so we solved with 95% or 99% going",
    "start": "879330",
    "end": "888510"
  },
  {
    "text": "to the existing MySQL server then we have a small percentage of traffic that we're out to the VT Gate server which",
    "start": "888510",
    "end": "895589"
  },
  {
    "text": "then connects to a VT tablet and the VT tablet is in a special mode that we call externally managed MySQL this works",
    "start": "895589",
    "end": "904560"
  },
  {
    "text": "great and it works great because VT gate itself is stateless it's not storing any",
    "start": "904560",
    "end": "909870"
  },
  {
    "text": "of the data you can insert an update and select data from each one of these access paths and you'll be able to see",
    "start": "909870",
    "end": "916260"
  },
  {
    "text": "it in the other location this is the first step and this this confirms for us in you know you know things that we want",
    "start": "916260",
    "end": "923070"
  },
  {
    "text": "to validate that the query latency is going to be okay for our application and the queries that we're hoping to support",
    "start": "923070",
    "end": "929070"
  },
  {
    "text": "are supported as well so as we boost off our confidence we're going to increase",
    "start": "929070",
    "end": "934860"
  },
  {
    "text": "this percentage from five percent to 100 percent that's that's the end goal and",
    "start": "934860",
    "end": "939959"
  },
  {
    "text": "we have to get to 100 percent before we can start the next level which is to add additional VT tablets that are managed",
    "start": "939959",
    "end": "946770"
  },
  {
    "text": "by the tests okay so this is where we want to get to",
    "start": "946770",
    "end": "956120"
  },
  {
    "text": "this is our phase two of our migration where we want to say that there's no direct access to my school everything",
    "start": "956120",
    "end": "962000"
  },
  {
    "text": "goes through a VT gate and the VT gate is the router so as we move into two",
    "start": "962000",
    "end": "967490"
  },
  {
    "text": "shotted workloads or as we have multiple key spaces to use Vitesse terminology we",
    "start": "967490",
    "end": "972920"
  },
  {
    "text": "have to make sure that everyone is accessing a VT gate so that it gets routed the query gets routed to the right location so if they were",
    "start": "972920",
    "end": "979220"
  },
  {
    "text": "connecting the regular my school and I stopped moving a table well MySQL is not going to understand that's now on",
    "start": "979220",
    "end": "984529"
  },
  {
    "text": "another server so this is the prerequisite to get to when we get to",
    "start": "984529",
    "end": "989990"
  },
  {
    "text": "this point then we can add a new tablet and we could add a test tablet with mysqld and so far this tablet is not",
    "start": "989990",
    "end": "1001959"
  },
  {
    "text": "storing any information but we could",
    "start": "1001959",
    "end": "1006970"
  },
  {
    "text": "either start creating new tables in that location or we could copy the data from",
    "start": "1006970",
    "end": "1014079"
  },
  {
    "text": "the existing MySQL server to out of a test tablet and this is really cool because this it's a feature we call",
    "start": "1014079",
    "end": "1021579"
  },
  {
    "text": "table migration it can actually happen online so it starts copying from the existing",
    "start": "1021579",
    "end": "1027850"
  },
  {
    "text": "MySQL server without blocking reads without blocking writes it just happens in the background and then when it's",
    "start": "1027850",
    "end": "1034780"
  },
  {
    "text": "finished copying you know it could be a several gigabyte table then you can",
    "start": "1034780",
    "end": "1039819"
  },
  {
    "text": "failover and you can say VT Gate start looking to my Vitesse tablet don't look",
    "start": "1039819",
    "end": "1045188"
  },
  {
    "text": "at my existing MySQL server",
    "start": "1045189",
    "end": "1048750"
  },
  {
    "text": "let's talk a little bit about table migration what it means it's also currently called vertical split clone",
    "start": "1051350",
    "end": "1057389"
  },
  {
    "text": "inside some of the documentation for the tests we do plan to entirely rename this",
    "start": "1057389",
    "end": "1062659"
  },
  {
    "text": "to call it our table migration it allows you to move you know as I said online",
    "start": "1062659",
    "end": "1070440"
  },
  {
    "text": "online means that it doesn't block reads or a dozen book writes it's just going to block for a couple of seconds at the",
    "start": "1070440",
    "end": "1075929"
  },
  {
    "text": "very last stage when you want to do that final transition it does have some requirements to be",
    "start": "1075929",
    "end": "1082169"
  },
  {
    "text": "able to do this on the MySQL server most of these requirements are on the MySQL",
    "start": "1082169",
    "end": "1087299"
  },
  {
    "text": "side not on the Vitesse side these are not the defaults but actually in the case of Google Cloud SQL I think they",
    "start": "1087299",
    "end": "1094649"
  },
  {
    "text": "are the defaults so it should be able to do for that question it had earlier a migration from cloud SQL to Vitesse",
    "start": "1094649",
    "end": "1101999"
  },
  {
    "text": "using this methodology in most cases I think you'd be pretty safe to change these defaults on a MySQL server they",
    "start": "1101999",
    "end": "1110429"
  },
  {
    "text": "are I think in many cases the defaults with MySQL 800 and above that the test",
    "start": "1110429",
    "end": "1117029"
  },
  {
    "text": "requires so MySQL is moving in that direction anyway you just need to turn on some of these things a little bit",
    "start": "1117029",
    "end": "1122399"
  },
  {
    "text": "earlier okay so let's let's talk about completion so as we get to the end of",
    "start": "1122399",
    "end": "1128789"
  },
  {
    "text": "the copy what happens now we have everything pointing to to the VT gate which means that it will effectively",
    "start": "1128789",
    "end": "1135149"
  },
  {
    "text": "route to know that it should go to the to the existing MySQL server if we have a legacy table or we can go to the new",
    "start": "1135149",
    "end": "1142399"
  },
  {
    "text": "question the test officially recommends",
    "start": "1142399",
    "end": "1148679"
  },
  {
    "text": "utf-8 let me just double check on what",
    "start": "1148679",
    "end": "1154230"
  },
  {
    "text": "our wording is for other character sets I'd say it's discouraged but sigil might have another wording yeah so the only",
    "start": "1154230",
    "end": "1162029"
  },
  {
    "text": "character set that we unofficially allow is Latin anything else",
    "start": "1162029",
    "end": "1167909"
  },
  {
    "text": "is questionable the main reason is because of how the query has to escape",
    "start": "1167909",
    "end": "1173999"
  },
  {
    "text": "your strings so if you try something other than you other than a utf-8 based",
    "start": "1173999",
    "end": "1179609"
  },
  {
    "text": "character set or a Latin it may not work",
    "start": "1179609",
    "end": "1184399"
  },
  {
    "text": "okay so we add we get to the completion and then we end up I'm just going to sort of shuffle this is to the side so",
    "start": "1190050",
    "end": "1197710"
  },
  {
    "text": "you can kind of see what it it looks like closer to that original architecture diagram that we showed we",
    "start": "1197710",
    "end": "1203230"
  },
  {
    "text": "had you mysql or your applications your VT gate and then your tablets now we're",
    "start": "1203230",
    "end": "1209050"
  },
  {
    "text": "kind of moving into that area where we have VT gate pointing to the to the new",
    "start": "1209050",
    "end": "1215440"
  },
  {
    "text": "tablets or pointing to the old tablet that points to the existing MySQL server",
    "start": "1215440",
    "end": "1221340"
  },
  {
    "text": "so we end up in this position where we can have just the old tables in MySQL",
    "start": "1222720",
    "end": "1231670"
  },
  {
    "text": "and any new table if we want to we can create it in this this new location so I'll set up that's that's to run some",
    "start": "1231670",
    "end": "1239380"
  },
  {
    "text": "details to be able to you know make it referenceable legacy MySQL is using one",
    "start": "1239380",
    "end": "1246100"
  },
  {
    "text": "key space and we use the terminology that's externally managed key space by the tests this is the same technology",
    "start": "1246100",
    "end": "1252280"
  },
  {
    "text": "that allows you to use the Aurora case where it's managed by Aurora but we put",
    "start": "1252280",
    "end": "1257380"
  },
  {
    "text": "the test on the top of it to horizontally scale it and then we have a single unsoldered key space that is our",
    "start": "1257380",
    "end": "1265060"
  },
  {
    "text": "new infrastructure the test supports suppose sharded an uncharted key spaces just to throw in a detail now if you do",
    "start": "1265060",
    "end": "1272350"
  },
  {
    "text": "move in a Charlotte that's just a few less queries that is supported as sometimes it's difficult to be able to",
    "start": "1272350",
    "end": "1279370"
  },
  {
    "text": "figure out where to access the data from so for the simple case we went with the uncharted key space and then from from",
    "start": "1279370",
    "end": "1288640"
  },
  {
    "text": "there we're able to sort of deploy additional key spaces additional tables it's",
    "start": "1288640",
    "end": "1294190"
  },
  {
    "text": "recommended to keep when you kind of shod systems it's recommended to keep",
    "start": "1294190",
    "end": "1299980"
  },
  {
    "text": "your updates to be within an individual key space in an individual shot rather",
    "start": "1299980",
    "end": "1306730"
  },
  {
    "text": "than having to update things that are in many places the test does support the ability to do this it can do a two-phase",
    "start": "1306730",
    "end": "1312520"
  },
  {
    "text": "commit but it tends to be slower to be able to do that so this point I was going to attempt a",
    "start": "1312520",
    "end": "1319210"
  },
  {
    "text": "demo but as I said I do know that there are problems and so I'll just double check my caucus while I'm at 25 minutes",
    "start": "1319210",
    "end": "1324790"
  },
  {
    "text": "I think it might be better to take questions instead because it might break I don't get to go up on stage to take",
    "start": "1324790",
    "end": "1331000"
  },
  {
    "text": "the questions as well",
    "start": "1331000",
    "end": "1333900"
  },
  {
    "text": "DT Gates to save those torques is yes",
    "start": "1337410",
    "end": "1341490"
  },
  {
    "text": "yeah yeah so that's a great question so",
    "start": "1343290",
    "end": "1351880"
  },
  {
    "text": "does your application have three typically not showing my my diagram people put a load balancer in front of",
    "start": "1351880",
    "end": "1358929"
  },
  {
    "text": "the the three as an easy way to do it yeah and that way you only have to have one point to be able to do that yeah",
    "start": "1358929",
    "end": "1365350"
  },
  {
    "text": "they weren't sort of reroute traffic to the other nodes as they get busy I mean they just speak the MySQL protocol so it",
    "start": "1365350",
    "end": "1371500"
  },
  {
    "text": "doesn't support that native natively some drive is there for example JDBC does have the ability to like list a set",
    "start": "1371500",
    "end": "1378160"
  },
  {
    "text": "of servers and so in that case you could potentially list all of them but I would",
    "start": "1378160",
    "end": "1383200"
  },
  {
    "text": "say most people do put a load balancer as well",
    "start": "1383200",
    "end": "1387480"
  },
  {
    "text": "right other do you answer that one yeah so the question is what kind of",
    "start": "1393490",
    "end": "1400580"
  },
  {
    "text": "support do we have for change data capture that's the feature that I've been working on for the last one year",
    "start": "1400580",
    "end": "1406159"
  },
  {
    "text": "it's called V replication and it's about a couple of weeks away from completion",
    "start": "1406159",
    "end": "1411850"
  },
  {
    "text": "it helps you it does a whole bunch of things including what we call",
    "start": "1411850",
    "end": "1417110"
  },
  {
    "text": "materialization you can basically point at a table and say I want to materialize this table using the Select query and",
    "start": "1417110",
    "end": "1424190"
  },
  {
    "text": "then it will just materialize the entire thing into another key space basically project it anywhere you like that same",
    "start": "1424190",
    "end": "1431299"
  },
  {
    "text": "underlying feature is also used where you can basically from the outside tell",
    "start": "1431299",
    "end": "1436850"
  },
  {
    "text": "with this okay I want to subscribe to all changes and it'll just push them to you through either G RPC and we are also",
    "start": "1436850",
    "end": "1443809"
  },
  {
    "text": "going to do the my sequel protocol yeah this 1x",
    "start": "1443809",
    "end": "1449830"
  },
  {
    "text": "the question is do you have any requirements on table structure in terms of okay so the one very specific thing",
    "start": "1454790",
    "end": "1465830"
  },
  {
    "text": "that we have about Vitas is there is no requirement about that is there is there",
    "start": "1465830",
    "end": "1472980"
  },
  {
    "text": "is no restriction about which sharding key you use for your table versus what primary key the table has as a matter of",
    "start": "1472980",
    "end": "1479910"
  },
  {
    "text": "fact most workloads are work better that way because enforcing that the sharding",
    "start": "1479910",
    "end": "1488640"
  },
  {
    "text": "key is part of the primary key you know is a huge restriction in terms of your",
    "start": "1488640",
    "end": "1494130"
  },
  {
    "text": "ability to group related data that has to be together so that's I don't know if",
    "start": "1494130",
    "end": "1499260"
  },
  {
    "text": "that's that was your underlying question in that case yes that thing we explicitly allow yeah obviously couple",
    "start": "1499260",
    "end": "1505980"
  },
  {
    "text": "notes the test supports all data types and MySQL does does not recommend that you use a decimal data type it's part of",
    "start": "1505980",
    "end": "1512160"
  },
  {
    "text": "the shining key or primary key but otherwise should be fine",
    "start": "1512160",
    "end": "1517280"
  },
  {
    "text": "so the question is does V replication help with my sequel replication overall",
    "start": "1529700",
    "end": "1536359"
  },
  {
    "text": "I don't know if yes yes is it",
    "start": "1536359",
    "end": "1544940"
  },
  {
    "text": "theoretically possible to do that yes but if you ask me my sequel replication",
    "start": "1544940",
    "end": "1551629"
  },
  {
    "text": "as a master replicas situation is pretty good and pretty efficient so there's no",
    "start": "1551629",
    "end": "1556729"
  },
  {
    "text": "need to get in between there but what it does not do is if you want to apply",
    "start": "1556729",
    "end": "1561859"
  },
  {
    "text": "transformations and if you actually wanted the target to be slightly different like for example you want to",
    "start": "1561859",
    "end": "1568909"
  },
  {
    "text": "filter only some rows or you want to do aggregation on-the-fly so those kinds of things my sequel replication will not do",
    "start": "1568909",
    "end": "1575269"
  },
  {
    "text": "in that case we use with tests for it but theoretically yes we test can use",
    "start": "1575269",
    "end": "1580999"
  },
  {
    "text": "capable because it's such that's exactly how it works it subscribes to the bin locks and then copies the data just a",
    "start": "1580999",
    "end": "1588859"
  },
  {
    "text": "little bit of detail so when you put a shard in system every system has its own binary logs so if you already get a",
    "start": "1588859",
    "end": "1595129"
  },
  {
    "text": "combined view of that you can get that with Vitesse you can you can do all these stream yeah yeah yeah that's",
    "start": "1595129",
    "end": "1601219"
  },
  {
    "text": "that's the main purpose of a be replication the API that we expose for that is G RPC it's not back to MySQL",
    "start": "1601219",
    "end": "1607159"
  },
  {
    "text": "protocol but I actually think that's more useful yeah we will support my sequel also yeah yeah yes",
    "start": "1607159",
    "end": "1615549"
  },
  {
    "text": "yeah the question is we recommend splitting data out into into smaller",
    "start": "1627040",
    "end": "1634420"
  },
  {
    "text": "parts how is that going to affect my ability to run various queries I don't",
    "start": "1634420",
    "end": "1639700"
  },
  {
    "text": "know is that a good way to restate your question where pitfalls what is the best practice so yeah also best practices we",
    "start": "1639700",
    "end": "1648100"
  },
  {
    "text": "really recommend that you aim for 250 gig shots but we don't enforce it and",
    "start": "1648100",
    "end": "1653820"
  },
  {
    "text": "it's really just because we want failover and recovery to be fast that's",
    "start": "1653820",
    "end": "1660130"
  },
  {
    "text": "kind of the assumption that we're making in the design of the system typically if",
    "start": "1660130",
    "end": "1665440"
  },
  {
    "text": "you are shouting because you're a multi-tenant SAS you could shot by the",
    "start": "1665440",
    "end": "1670960"
  },
  {
    "text": "tenant ID but sometimes if you have a real lopsided distribution between your tenants if your tenant has a tenant ID",
    "start": "1670960",
    "end": "1678490"
  },
  {
    "text": "that can be the better candidate to be able to do it yeah so and also in the",
    "start": "1678490",
    "end": "1684070"
  },
  {
    "text": "long run as in that's actually our focus for with tests until we reach this goal",
    "start": "1684070",
    "end": "1690940"
  },
  {
    "text": "is to make it fully compatible with my sequel I mean our lofty goal is to make",
    "start": "1690940",
    "end": "1696760"
  },
  {
    "text": "it a drop-in replacement yeah so queries that don't work today will most likely",
    "start": "1696760",
    "end": "1702310"
  },
  {
    "text": "start working in a few months from now and just one more thing that yeah there is a my SQL compatibility page on the",
    "start": "1702310",
    "end": "1708640"
  },
  {
    "text": "the Vitesse documentation which is a good starting point to see what's not supported yeah",
    "start": "1708640",
    "end": "1714720"
  },
  {
    "text": "Twitty his partner fight and education",
    "start": "1716880",
    "end": "1723080"
  },
  {
    "text": "yes I let me answer it because I actually dealt with that problem so the",
    "start": "1745370",
    "end": "1751740"
  },
  {
    "text": "question is how do you do Paige in a pagination using with TAS in",
    "start": "1751740",
    "end": "1757799"
  },
  {
    "text": "a sharded environment so it depends a lot on how your data is organized so the",
    "start": "1757799",
    "end": "1764100"
  },
  {
    "text": "a bunch of people actually came with the impression that pagination works one shot at a time right so if your data is",
    "start": "1764100",
    "end": "1771240"
  },
  {
    "text": "ordered in such a way that you scan within a shard and then go to the next chart and then go to the next chart so",
    "start": "1771240",
    "end": "1777809"
  },
  {
    "text": "that is actually not the recommended way because organizing your data is a",
    "start": "1777809",
    "end": "1783090"
  },
  {
    "text": "guaranteed way to end up with hot shots because popular items tend to be within",
    "start": "1783090",
    "end": "1789539"
  },
  {
    "text": "one so the way that we recommend you do it with Vitas is actually spread it out say my pseudo randomly into all shards",
    "start": "1789539",
    "end": "1797340"
  },
  {
    "text": "and then when you paginate what we test will do is let's say select limit",
    "start": "1797340",
    "end": "1802860"
  },
  {
    "text": "hundred right so you will actually fetch 100 from each shard and then cut off as needed so it feels a little inefficient",
    "start": "1802860",
    "end": "1810110"
  },
  {
    "text": "but it is still acceptable because the work is distributed but pagination has a",
    "start": "1810110",
    "end": "1816809"
  },
  {
    "text": "problem especially if you use a limit query with offset and count is it",
    "start": "1816809",
    "end": "1823650"
  },
  {
    "text": "degrades over time like if your if your paginating 10,000 pages you are going to",
    "start": "1823650",
    "end": "1828780"
  },
  {
    "text": "be in trouble and that's a my sequel limitation so what people have done in that case is actually the token idea",
    "start": "1828780",
    "end": "1835679"
  },
  {
    "text": "that you talked about which is actually remember the last value that you fetched and use a greater than that value and",
    "start": "1835679",
    "end": "1841590"
  },
  {
    "text": "just use a limit class so that is what people have used so far I gotta take",
    "start": "1841590",
    "end": "1846720"
  },
  {
    "text": "question here yeah and then the one off behind straight after it sir",
    "start": "1846720",
    "end": "1851480"
  },
  {
    "text": "yeah I'll take that one so probably proxy sequel I it does some of the same",
    "start": "1859220",
    "end": "1866009"
  },
  {
    "text": "functionality but sort of lessen the shouting use case and with Orchestrator",
    "start": "1866009",
    "end": "1871739"
  },
  {
    "text": "we have integration with Orchestrator and there's there's many people that actually use Orchestrator and the test",
    "start": "1871739",
    "end": "1876869"
  },
  {
    "text": "together and they use ghost also for schema deployment yeah no one behind",
    "start": "1876869",
    "end": "1884929"
  },
  {
    "text": "yeah so if you are how does it work with asset transactions so if your update is",
    "start": "1889009",
    "end": "1894809"
  },
  {
    "text": "within a Schad then it's basically just routing to mysql that it is a",
    "start": "1894809",
    "end": "1899940"
  },
  {
    "text": "transaction if it is a cross shot boundaries then you can enable two-phase commit to be able to end the tests will",
    "start": "1899940",
    "end": "1907109"
  },
  {
    "text": "kind of maintain that log of the operations to be able to survive with recovery we typically recommend that you",
    "start": "1907109",
    "end": "1913649"
  },
  {
    "text": "try and model things so that you're in the first camp not the second campus it's a performance degradation to do",
    "start": "1913649",
    "end": "1919559"
  },
  {
    "text": "that and to PC transactions are not 100% acid the isolation level is not",
    "start": "1919559",
    "end": "1925229"
  },
  {
    "text": "repeatable read it will degrade down to read commit so that's not a thing to",
    "start": "1925229",
    "end": "1930299"
  },
  {
    "text": "keep in mind okay I'm gonna take more of the back sorry yeah yeah I know you yeah",
    "start": "1930299",
    "end": "1939349"
  },
  {
    "text": "that's how you migrate yeah let's have you a migrate yeah yeah the topology",
    "start": "1946380",
    "end": "1957400"
  },
  {
    "text": "server does it have state that you need to worry about yeah it keeps the topology information but you can recover",
    "start": "1957400",
    "end": "1962679"
  },
  {
    "text": "it if you were to lose it it's sort of like the routing dictionary yeah you can also manually rebuild it in the worst",
    "start": "1962679",
    "end": "1970059"
  },
  {
    "text": "case scenario just by issuing they are just key space and shard information which you can manually recreate yes sir",
    "start": "1970059",
    "end": "1977049"
  },
  {
    "text": "just by philosophy the test supports console at CD and zookeeper but you",
    "start": "1977049",
    "end": "1982210"
  },
  {
    "text": "could potentially add others and you know many deployments these days people have chosen one of these technologies it",
    "start": "1982210",
    "end": "1987700"
  },
  {
    "text": "integrates nicely that you don't have to pick a new one I'll get this one and",
    "start": "1987700",
    "end": "1993340"
  },
  {
    "text": "then you okay",
    "start": "1993340",
    "end": "1996059"
  },
  {
    "text": "it's so how do we do backups is a question and it's very similar to how you did backups with regular MySQL only",
    "start": "2006620",
    "end": "2013850"
  },
  {
    "text": "the test kind of manages that for you with a plug-in system so some of our",
    "start": "2013850",
    "end": "2019100"
  },
  {
    "text": "users use extra backup is the plug-in and some of them use the shutdown replicas and then backup as a method and",
    "start": "2019100",
    "end": "2025159"
  },
  {
    "text": "in most work fairly well and it's it's kind of like on a on a per tablet basis",
    "start": "2025159",
    "end": "2031220"
  },
  {
    "text": "that it will back those up for you I",
    "start": "2031220",
    "end": "2035440"
  },
  {
    "text": "don't believe we currently do know but it's it's technically possible that we might in the future just just from a I",
    "start": "2037120",
    "end": "2045820"
  },
  {
    "text": "done this far too much is from a philosophical perspective when I was operating at YouTube often I'd use local",
    "start": "2045820",
    "end": "2052940"
  },
  {
    "text": "storage and I just had many replicas and so that works well when you've got a lot",
    "start": "2052940",
    "end": "2059118"
  },
  {
    "text": "of read traffic we know a lot of users do use the the cloud provided network",
    "start": "2059119",
    "end": "2065868"
  },
  {
    "text": "storage but I if you do have many copies it is better to use locally I don't know",
    "start": "2065869",
    "end": "2071720"
  },
  {
    "text": "this headwaiter I'm going to talk about your trade-offs in my talk later but a",
    "start": "2071720",
    "end": "2077148"
  },
  {
    "text": "couple of points about the backup is if you are using a hosted cloud storage",
    "start": "2077149",
    "end": "2082608"
  },
  {
    "text": "there is no need for we test to do anything for you because they are doing the backup and restore for you so in",
    "start": "2082609",
    "end": "2088550"
  },
  {
    "text": "that is the case where you run with us in externally managed mode where you use it mainly for query routing and if you",
    "start": "2088550",
    "end": "2097490"
  },
  {
    "text": "want to switch over to the test to do the backup and restore it means that you you don't want to rely on the clouds",
    "start": "2097490",
    "end": "2104089"
  },
  {
    "text": "method of backup and restore",
    "start": "2104089",
    "end": "2108130"
  },
  {
    "text": "does the backup friend does the backup render no I don't think so I it just it",
    "start": "2112500",
    "end": "2123750"
  },
  {
    "text": "just stores it to whatever there's an interface you can either say mounted volume or s3 or I don't know there's one",
    "start": "2123750",
    "end": "2132750"
  },
  {
    "text": "more one other adapter that we have for it saves it there and then it knows how",
    "start": "2132750",
    "end": "2138119"
  },
  {
    "text": "to go back to it it's not kubernetes dependent I think the the answer why",
    "start": "2138119",
    "end": "2143310"
  },
  {
    "text": "it's not cooking it it's dependent is because there are people who run with us outside of kubernetes so the Vita's code",
    "start": "2143310",
    "end": "2150000"
  },
  {
    "text": "itself has nothing that that depends on kubernetes by itself the guy at the back",
    "start": "2150000",
    "end": "2158190"
  },
  {
    "text": "you ready said for one all right okay okay",
    "start": "2158190",
    "end": "2163910"
  },
  {
    "text": "how does the scale out how does a scale out happen it happens gradually over",
    "start": "2169520",
    "end": "2175290"
  },
  {
    "text": "time and when you know the scale what happens by yury sharding you start with",
    "start": "2175290",
    "end": "2181440"
  },
  {
    "text": "one instance and then you say like the first step that he talked about I talked about is migrate tables out into another",
    "start": "2181440",
    "end": "2186510"
  },
  {
    "text": "VT tablet so as you do that scale out your traffic is growing so you deploy more VD gates and then afterwards what",
    "start": "2186510",
    "end": "2194040"
  },
  {
    "text": "you will do is you'll start recharging your data and as you reach hard you will",
    "start": "2194040",
    "end": "2199680"
  },
  {
    "text": "scale out even more vita gates and then you start adding cells essentially like",
    "start": "2199680",
    "end": "2204839"
  },
  {
    "text": "youtube we start we had one database that we call the main DB and by the time",
    "start": "2204839",
    "end": "2210839"
  },
  {
    "text": "I left we had tens of thousands of nodes so it was all slowly grown over time",
    "start": "2210839",
    "end": "2215990"
  },
  {
    "text": "adding more data centers more VD gates and yeah I don't know if we're gonna get",
    "start": "2215990",
    "end": "2223349"
  },
  {
    "text": "way out of time oh you can catch us what's good thank you",
    "start": "2223349",
    "end": "2234170"
  }
]