[
  {
    "start": "0",
    "end": "50000"
  },
  {
    "text": "hi everybody can you hear me okay awesome I'm really out of breath because",
    "start": "299",
    "end": "7109"
  },
  {
    "text": "this building is really big and I ran all the way here before I start and while I catch my breath a little bit I",
    "start": "7109",
    "end": "12450"
  },
  {
    "text": "wanted to take a second to say thank you to the room emcee and the organizers and the program chairs and everybody who's",
    "start": "12450",
    "end": "18480"
  },
  {
    "text": "doing such amazing work to bring us this amazing conference so thank you to them can we all give them a round of applause",
    "start": "18480",
    "end": "26119"
  },
  {
    "text": "and yeah and thank all of you for being here and taking time out of your day before lunch I really appreciate it",
    "start": "29000",
    "end": "35120"
  },
  {
    "text": "so my name is Anne Coldwater and this talk is called crafty requests a deep dive into kubernetes CVE 1 2002 18 one",
    "start": "35120",
    "end": "43580"
  },
  {
    "text": "zero zero two one zero five if you are not here for that talk you are in the wrong room and that's okay we could hang",
    "start": "43580",
    "end": "49460"
  },
  {
    "text": "out anyway so hi my name is Ian I'm a lead platform security engineer at",
    "start": "49460",
    "end": "55850"
  },
  {
    "start": "50000",
    "end": "119000"
  },
  {
    "text": "Heroku I started in April it's great and we're hiring if anybody is looking and",
    "start": "55850",
    "end": "62769"
  },
  {
    "text": "before I worked at Heroku I was an independent kubernetes container pen",
    "start": "62769",
    "end": "68450"
  },
  {
    "text": "tester who did consulting work for various companies and side providers testing their infrastructure and was",
    "start": "68450",
    "end": "76070"
  },
  {
    "text": "doing that for a while last December it was q4 which if anyone here has ever",
    "start": "76070",
    "end": "82280"
  },
  {
    "text": "been pen testing consultant or maybe any kind of consultant q4 is like hella busy",
    "start": "82280",
    "end": "87470"
  },
  {
    "text": "crunch time because everybody's trying to get all their boxes checked by the time of the year's up so it's very busy",
    "start": "87470",
    "end": "93470"
  },
  {
    "text": "and my phone blew up like a lot and I was like what is happening and eventually I figured it out what",
    "start": "93470",
    "end": "99710"
  },
  {
    "text": "happened was what was advertised as the first kubernetes container or security",
    "start": "99710",
    "end": "105530"
  },
  {
    "text": "vulnerability that's not true had just blown up and everybody wanted their stuff been tested or everybody wanted to",
    "start": "105530",
    "end": "111440"
  },
  {
    "text": "talk about it so because that got a lot of attention and because I think it's really interesting that's what I'm here",
    "start": "111440",
    "end": "116780"
  },
  {
    "text": "to walk you through and tell you all about so big news Germany's first major",
    "start": "116780",
    "end": "122030"
  },
  {
    "start": "119000",
    "end": "194000"
  },
  {
    "text": "security hole discovered as I said that's a lie but it is actually the first one that got that level of",
    "start": "122030",
    "end": "127310"
  },
  {
    "text": "attention it got a lot of press a lot of people who hadn't previously perhaps pay attention do kubernetes at all or -",
    "start": "127310",
    "end": "133489"
  },
  {
    "text": "kubernetes security really it really grabbed their attention in a way that previous vulnerabilities hadn't and",
    "start": "133489",
    "end": "140019"
  },
  {
    "text": "that's cool because it's important that people pay attention to kubernetes security but it is also it wasn't very",
    "start": "140019",
    "end": "148250"
  },
  {
    "text": "well understood the CVE how it worked what it did everybody knew it was bad but nobody quite got it and I mean a lot",
    "start": "148250",
    "end": "154909"
  },
  {
    "text": "of people got it but a lot of people didn't and I think that's unfortunate because I think that there's a lot to be learned from this particular",
    "start": "154909",
    "end": "160730"
  },
  {
    "text": "vulnerability for container people kubernetes people you can learn about how exploits work how these kinds of flaws can come",
    "start": "160730",
    "end": "167349"
  },
  {
    "text": "together to create a vulnerable context and how you know people who maybe don't",
    "start": "167349",
    "end": "173530"
  },
  {
    "text": "have ideal use cases in mind can go ahead and exploit the way those come",
    "start": "173530",
    "end": "179500"
  },
  {
    "text": "together to create these kinds of things and for security people they can understand kubernetes better and how",
    "start": "179500",
    "end": "185230"
  },
  {
    "text": "this kind of thing works so we're going to look at it holistically and we're going to deep dive through it together I'm gonna try to slow down a little mix",
    "start": "185230",
    "end": "192159"
  },
  {
    "text": "I'm still slightly on breath so this was a big deal as I said a lot of press a",
    "start": "192159",
    "end": "197409"
  },
  {
    "start": "194000",
    "end": "238000"
  },
  {
    "text": "lot of attention the CBS s spores which are scores that one could argue about how accurate they",
    "start": "197409",
    "end": "204489"
  },
  {
    "text": "are but they attempt to gauge the severity of different kinds of vulnerabilities those were quite high",
    "start": "204489",
    "end": "210459"
  },
  {
    "text": "they go on a scale of 10 this one got a 9.8 so point to shy of perfect but still",
    "start": "210459",
    "end": "216760"
  },
  {
    "text": "pretty severe and it affected until the time of it fix all kubernetes versions",
    "start": "216760",
    "end": "222010"
  },
  {
    "text": "full stop all of them so it affected a lot of clusters and a lot of people so",
    "start": "222010",
    "end": "227979"
  },
  {
    "text": "let's hear more about this and figure out how it worked when you take a sip of water and I'm gonna catch my breath a",
    "start": "227979",
    "end": "233560"
  },
  {
    "text": "little bit so what was this thing",
    "start": "233560",
    "end": "238610"
  },
  {
    "start": "238000",
    "end": "291000"
  },
  {
    "text": "CVE one zero zero two or 2018 one zero zero two one zero five which is very human readable and even more human",
    "start": "238610",
    "end": "245060"
  },
  {
    "text": "saleable was originally discovered by Darren Shepherd and file directly as an",
    "start": "245060",
    "end": "250670"
  },
  {
    "text": "issue with Ranger not through any kind of security channel because they didn't realize that it was a security vulnerability originally it was filed as",
    "start": "250670",
    "end": "257060"
  },
  {
    "text": "a bug I was like an edge case in a proxy component said in there issues for awhile like a couple months eventually",
    "start": "257060",
    "end": "263870"
  },
  {
    "text": "Rancher figured out that it was not a proxy vulnerability it were a proxy issue it was in fact an up scream",
    "start": "263870",
    "end": "269360"
  },
  {
    "text": "kubernetes vulnerability and it was in fact a security issue and so they privately disclosed it through the kubernetes security reporting process to",
    "start": "269360",
    "end": "276200"
  },
  {
    "text": "security at and then the security working group did the triage for it and dealt with it they ended up just closing",
    "start": "276200",
    "end": "283730"
  },
  {
    "text": "it on December 30 2018 which is my mom's birthday and I didn't call her until really late at night so this was the",
    "start": "283730",
    "end": "293270"
  },
  {
    "start": "291000",
    "end": "341000"
  },
  {
    "text": "github issue that reported this CVE and it talked somewhat about what it did",
    "start": "293270",
    "end": "300560"
  },
  {
    "text": "what it was proxy request handling in Kuby API server can leave vulnerable TVs TCP",
    "start": "300560",
    "end": "307340"
  },
  {
    "text": "connections that's a little bit opaque in terms of like what exactly that means and they went into some detail about",
    "start": "307340",
    "end": "313720"
  },
  {
    "text": "like what exactly this meant and they talked about the affected versions which were everything up to that point and",
    "start": "313720",
    "end": "321890"
  },
  {
    "text": "I'll give you a bigger list in a sec and they talked about the component that was mostly affected by that which was the",
    "start": "321890",
    "end": "327980"
  },
  {
    "text": "kubernetes api server so in order to be able to understand how this thing works which is actually pretty simple let's go",
    "start": "327980",
    "end": "334370"
  },
  {
    "text": "through the moving parts in the kubernetes backend and figure out how they came together and how this happened",
    "start": "334370",
    "end": "341050"
  },
  {
    "start": "341000",
    "end": "370000"
  },
  {
    "text": "so affected versions again absolutely everything before 1.10 versions in 1.10",
    "start": "341050",
    "end": "348620"
  },
  {
    "text": "up until fix versions in 111 and up until fix versions and 112 until fix everything until through everything",
    "start": "348620",
    "end": "354860"
  },
  {
    "text": "after that just fixed I think one point thirteen alpha came out that day so it",
    "start": "354860",
    "end": "361460"
  },
  {
    "text": "affected a lot affected a lot of clusters maybe it affected some of yours maybe it's still affecting some of yours today and I hope not because if you",
    "start": "361460",
    "end": "367729"
  },
  {
    "text": "leave with one thing if you haven't updated we knew that so there's one bit of good news here because as I said it was",
    "start": "367729",
    "end": "374310"
  },
  {
    "start": "370000",
    "end": "401000"
  },
  {
    "text": "pretty severe affected a lot of people you can't actually have a privilege escalation vulnerability if you run",
    "start": "374310",
    "end": "379830"
  },
  {
    "text": "everything is privileged so if everybody is already an admin it's fine",
    "start": "379830",
    "end": "385830"
  },
  {
    "text": "nobody can make themselves I've been this is a terrible idea please don't run your clusters like this and but you know",
    "start": "385830",
    "end": "394200"
  },
  {
    "text": "that's that's the one bit of silver lining I've got for you here besides the fact that it's actually a fairly easy to fix and fairly a mitigate so but the",
    "start": "394200",
    "end": "403560"
  },
  {
    "start": "401000",
    "end": "472000"
  },
  {
    "text": "thing is security people had when the witness came out there was a lot of interest but they had a lot of confusion",
    "start": "403560",
    "end": "409890"
  },
  {
    "text": "about what exactly this meant because security people haven't understanding often of vulnerabilities as being like",
    "start": "409890",
    "end": "415650"
  },
  {
    "text": "it can be a local privilege escalation vulnerability or where you know you start out as a regular user and then you",
    "start": "415650",
    "end": "421590"
  },
  {
    "text": "can escalate your privileges to being root or admin or system or whatever and there are remote code execution vulnerabilities where you can go in and",
    "start": "421590",
    "end": "428910"
  },
  {
    "text": "execute arbitrary code often completely unauthentic ated this one was both there are multiple attack paths and one of",
    "start": "428910",
    "end": "436320"
  },
  {
    "text": "them was a local guerrilla escalation vulnerability and one of them was a",
    "start": "436320",
    "end": "442610"
  },
  {
    "text": "remote code execution vulnerability and people were really confused by this how could it be both",
    "start": "442610",
    "end": "448110"
  },
  {
    "text": "and this Twitter exchange which I got permission to use is where they're trying to figure out what's going on",
    "start": "448110",
    "end": "453350"
  },
  {
    "text": "eventually they figured it out which is that if you know how kubernetes works this actually does make sense because of",
    "start": "453350",
    "end": "460590"
  },
  {
    "text": "the way that the API server interacts with our back and allows for different",
    "start": "460590",
    "end": "466410"
  },
  {
    "text": "kinds of authorization schemes depending on the permissions that are assigned the",
    "start": "466410",
    "end": "473070"
  },
  {
    "start": "472000",
    "end": "519000"
  },
  {
    "text": "way this flaw ultimately worked was that when an attacker sent a specially crafted request that said connection",
    "start": "473070",
    "end": "479160"
  },
  {
    "text": "upgrade which attempted to escalate a regular HTTP connection to a WebSocket",
    "start": "479160",
    "end": "485040"
  },
  {
    "text": "which stayed open those it did those",
    "start": "485040",
    "end": "491610"
  },
  {
    "text": "connections did not validate whether or not that returned error or success and so it was just like all right these are",
    "start": "491610",
    "end": "498450"
  },
  {
    "text": "the droids you're looking for opened up stayed open and allow people who sent them request to communicate directly with",
    "start": "498450",
    "end": "504130"
  },
  {
    "text": "back-end servers whether that be the couplet whether that be extension API servers it allowed them to bypass the",
    "start": "504130",
    "end": "512050"
  },
  {
    "text": "authorization that the API server performs and just communicate directly with it and do whatever they wanted so",
    "start": "512050",
    "end": "521050"
  },
  {
    "text": "let's in order to figure out how this happened let's take a look at the moving parts involved it's this cube con I'm",
    "start": "521050",
    "end": "528610"
  },
  {
    "text": "guessing a lot of people have probably seen a picture like this before but for the people in the room who haven't seen a picture like this before this is a",
    "start": "528610",
    "end": "536230"
  },
  {
    "text": "sort of general diagram of kubernetes architecture and you can see the API server in the middle touching pretty",
    "start": "536230",
    "end": "541779"
  },
  {
    "text": "much everything the API server was the",
    "start": "541779",
    "end": "546820"
  },
  {
    "text": "affected component in this CV as a penetration tester the API server is the best thing to attack because it touches",
    "start": "546820",
    "end": "552520"
  },
  {
    "text": "everything it touches that city it touches the couplet it touches the different parts of the worker nodes and",
    "start": "552520",
    "end": "558010"
  },
  {
    "text": "the master nodes and so you are able to get access to more if you can get a hold",
    "start": "558010",
    "end": "563800"
  },
  {
    "text": "of that then you can if you can get a hold of other parts a lot of the time so in this case it actually didn't allow you to get a hold of it so much as it",
    "start": "563800",
    "end": "569709"
  },
  {
    "text": "allowed you to bypass entirely and therefore be able to ignore all of the authorization and mutual TLS connections",
    "start": "569709",
    "end": "576430"
  },
  {
    "text": "that the API server performed and ok so",
    "start": "576430",
    "end": "581740"
  },
  {
    "start": "579000",
    "end": "686000"
  },
  {
    "text": "what is the API said what does it do it is the REST API endpoint through which pretty much all kubernetes operations",
    "start": "581740",
    "end": "587650"
  },
  {
    "text": "are performed so if you want to talk to the couplet if you want to talk to extension API servers if you want to",
    "start": "587650",
    "end": "595170"
  },
  {
    "text": "pretty much do anything the API server is going to be because kubernetes is API",
    "start": "595170",
    "end": "600520"
  },
  {
    "text": "based it's going to be the way that that that communication happens and so it's",
    "start": "600520",
    "end": "605550"
  },
  {
    "text": "it's at responsible for more than your average reverse proxy because not only does it route things as a gateway but",
    "start": "605550",
    "end": "612880"
  },
  {
    "text": "it's also responsible for authentication and authorization and routing so it's a",
    "start": "612880",
    "end": "620770"
  },
  {
    "text": "gateway between the user sending those requests to the API server and the backend servers where it takes the",
    "start": "620770",
    "end": "626830"
  },
  {
    "text": "request from the user makes sure they're authorized to give 2 semanas requests and then if they are considered",
    "start": "626830",
    "end": "631959"
  },
  {
    "text": "authorized it goes and communicates with the back-end server does its back-end thing and then when",
    "start": "631959",
    "end": "639760"
  },
  {
    "text": "the backend server responds back it makes sure that that TLS connection is valid and it communicates back to the",
    "start": "639760",
    "end": "645460"
  },
  {
    "text": "user so everything goes through it it's a gateway in the middle kind of an old-school firewall model which we'll talk about later a thing to know about",
    "start": "645460",
    "end": "652540"
  },
  {
    "text": "the API server is that it's accessible to all pods by default and this is important because if for example you",
    "start": "652540",
    "end": "660850"
  },
  {
    "text": "have access to one pod but don't have access to another pod perhaps it's on",
    "start": "660850",
    "end": "666610"
  },
  {
    "text": "another node another namespace something that you're not supposed to be able to communicate with if you can convince the",
    "start": "666610",
    "end": "674680"
  },
  {
    "text": "API server that you're authorized you might be able to communicate with it if you can bypass the API server entirely",
    "start": "674680",
    "end": "679990"
  },
  {
    "text": "so that you don't have to be authorized you can just communicate directly and execute on to those pods onto those notes in theory the way that the",
    "start": "679990",
    "end": "688000"
  },
  {
    "text": "connection flow works is this the user sends the request to the API server the API server authenticates and authorizes",
    "start": "688000",
    "end": "694480"
  },
  {
    "text": "make sure that's okay the API server creates the mutual TLS credentials with",
    "start": "694480",
    "end": "699670"
  },
  {
    "text": "the backend servers whether that be the cubelet or whatever it is that it's communicating with make sure that that's okay gets you know performs the request",
    "start": "699670",
    "end": "707530"
  },
  {
    "text": "goes back routes it back to the user it's a reverse proxy so the way that",
    "start": "707530",
    "end": "713830"
  },
  {
    "text": "reverse proxies often work is it's not actually efficient to constantly open",
    "start": "713830",
    "end": "719410"
  },
  {
    "text": "and close HTTP connections it's just not it's not a good use of bandwidth so a",
    "start": "719410",
    "end": "724750"
  },
  {
    "text": "lot of the time what they'll do if they know that communication is going to be ongoing is they'll upgrade that connection to a WebSocket which is kind",
    "start": "724750",
    "end": "730839"
  },
  {
    "text": "of a dumb pipe it opens up it stays open and and that way just the communication",
    "start": "730839",
    "end": "736750"
  },
  {
    "text": "is allowed to continue back and forth without having to open and close anything until for the length of that connection until it's done if in theory",
    "start": "736750",
    "end": "746740"
  },
  {
    "text": "again the way that it's supposed to work is if a connection upgrade request is sent that is not valid it will be like",
    "start": "746740",
    "end": "752290"
  },
  {
    "text": "nah this this returns an error this isn't a valid request and it will not open and turn into a WebSocket if it",
    "start": "752290",
    "end": "760240"
  },
  {
    "text": "does open if it does return success if it's like this is an authorized request this is actually what we're trying to accomplish here then it will open and it",
    "start": "760240",
    "end": "766990"
  },
  {
    "text": "will stay up in theory that's how that works and in theory this does work it's not bad behavior it's common behavior for things",
    "start": "766990",
    "end": "773800"
  },
  {
    "text": "like load balancing because you want to be able to make those connections efficiently it only becomes a problem",
    "start": "773800",
    "end": "778900"
  },
  {
    "text": "when those dumb pipes that get opened meet kind of smart routers like the kubernetes api server that are",
    "start": "778900",
    "end": "785290"
  },
  {
    "text": "responsible for things like authentication and authorization as well as just moving things from place to place because dumb pipes are dumb and if",
    "start": "785290",
    "end": "794020"
  },
  {
    "text": "you are trying to perform kind of granular authorization or things like",
    "start": "794020",
    "end": "799270"
  },
  {
    "text": "that over one it may not always work right such as in the CVE and kubernetes",
    "start": "799270",
    "end": "808360"
  },
  {
    "text": "does exactly this so it allowed people to escalate their privileges there were",
    "start": "808360",
    "end": "813670"
  },
  {
    "text": "multiple attack vectors for it and it allowed people to bypass authorization of the API server to just communicate",
    "start": "813670",
    "end": "819610"
  },
  {
    "text": "directly with that and be able to do absolutely whatever they wanted again dumb pipes are dumb",
    "start": "819610",
    "end": "826980"
  },
  {
    "start": "823000",
    "end": "864000"
  },
  {
    "text": "it's the other thing about this is that because it was bypassing normal routing",
    "start": "826980",
    "end": "833830"
  },
  {
    "text": "traffic it couldn't be detected in logs very easily because what the logs were actually taking down was the traffic",
    "start": "833830",
    "end": "840400"
  },
  {
    "text": "that was happening that was being routed through the API server so if you are bypassing it then it it's not gonna see",
    "start": "840400",
    "end": "847990"
  },
  {
    "text": "that it happened because it didn't go through it and that also made this a particularly nasty CVE because if you're",
    "start": "847990",
    "end": "854560"
  },
  {
    "text": "trying to log you're trying to get your metrics you're trying to figure out what's going on if that hacker was in there and she was messing with your",
    "start": "854560",
    "end": "860440"
  },
  {
    "text": "stuff you're not necessarily going to know so there were two attack vectors in",
    "start": "860440",
    "end": "869050"
  },
  {
    "start": "864000",
    "end": "918000"
  },
  {
    "text": "here and it's why it had two separate cbss scores one of them was 8.8 which is pretty high and one of them was 9.8",
    "start": "869050",
    "end": "875530"
  },
  {
    "text": "which was pretty cool and the lower one was people who had access to be able to",
    "start": "875530",
    "end": "883240"
  },
  {
    "text": "pot exact pot attached Prague port forwarding and you had to be authorized",
    "start": "883240",
    "end": "890230"
  },
  {
    "text": "for that and the higher one you could do completely unauthentic ated so it could be totally off medicated RCE",
    "start": "890230",
    "end": "896020"
  },
  {
    "text": "and that one was the 9.8 and that one required access to an extension API",
    "start": "896020",
    "end": "901310"
  },
  {
    "text": "server which is not necessarily a super common cluster configuration but did affect a lot because there were various",
    "start": "901310",
    "end": "908660"
  },
  {
    "text": "kinds of scripts such as kuba that automatically set that up for you when you boost your after cluster so let's go",
    "start": "908660",
    "end": "915680"
  },
  {
    "text": "through these in depth pot exact pot",
    "start": "915680",
    "end": "921110"
  },
  {
    "text": "attached pod port forward just slow way down I'm talking way too fast on it is",
    "start": "921110",
    "end": "926660"
  },
  {
    "text": "again users who are authorized via our back or other means to be able to do that so if you had access to the pub",
    "start": "926660",
    "end": "933920"
  },
  {
    "text": "that you were on that you were able to do you could escalate to broader cluster",
    "start": "933920",
    "end": "940580"
  },
  {
    "text": "API access via the coolant and be able to pivot from there to be able to go to",
    "start": "940580",
    "end": "948170"
  },
  {
    "text": "execute things on different nodes or different plugs that you weren't necessarily supposed to have access to per the namespace authorization this one",
    "start": "948170",
    "end": "958130"
  },
  {
    "text": "affected absolutely aku Bernays deployments because it's just October Nadia's works before the fixed versions",
    "start": "958130",
    "end": "963970"
  },
  {
    "text": "the other one and the nasty r1 which was the one that was more rare but more",
    "start": "963970",
    "end": "971839"
  },
  {
    "text": "severe was through extension and aggregated API servers which um it",
    "start": "971839",
    "end": "978290"
  },
  {
    "text": "required being authorized for API discovery and by defaults back then and still to this day I'll talk about this",
    "start": "978290",
    "end": "985040"
  },
  {
    "text": "in a sec this was absolutely anybody authenticated or not and so you could",
    "start": "985040",
    "end": "990860"
  },
  {
    "text": "actually just go curl in or you know go into a thing that you had no authorization for whatsoever they were",
    "start": "990860",
    "end": "997160"
  },
  {
    "text": "completely unaffected and then be able to take over the cluster from there this",
    "start": "997160",
    "end": "1002410"
  },
  {
    "text": "could escalate to anything on downstream API servers this really allowed for total cluster compromised total cluster",
    "start": "1002410",
    "end": "1007600"
  },
  {
    "text": "takeover but it did only affect that minority of deployments but it was bad",
    "start": "1007600",
    "end": "1012850"
  },
  {
    "text": "nine point eight out of ten is a pretty severe vulnerability because it was on authenticate it was easy to exploit and",
    "start": "1012850",
    "end": "1019709"
  },
  {
    "text": "it you know you can do anything with it so let's talk about how",
    "start": "1019709",
    "end": "1028049"
  },
  {
    "start": "1024000",
    "end": "1074000"
  },
  {
    "text": "this default works so can everybody read that kind of yeah so this is a get",
    "start": "1028770",
    "end": "1036058"
  },
  {
    "text": "cluster role system discovery so you know what can you can discover certain",
    "start": "1036059",
    "end": "1042600"
  },
  {
    "text": "things about the system and this is designed for things like being able to get metrics being able to check on the health of the coolant and by default",
    "start": "1042600",
    "end": "1049500"
  },
  {
    "text": "again this is absolutely anybody who can just curl in and do this so it included for example actually have a laser",
    "start": "1049500",
    "end": "1055650"
  },
  {
    "text": "pointer here you were allowed to access slash API slash wild card which means literally",
    "start": "1055650",
    "end": "1062010"
  },
  {
    "text": "anything attached to an API and that was you could get it and it was just yep",
    "start": "1062010",
    "end": "1069990"
  },
  {
    "text": "system discovery that's a cluster roll so who has access to system discovery no",
    "start": "1069990",
    "end": "1076920"
  },
  {
    "start": "1074000",
    "end": "1144000"
  },
  {
    "text": "big deal right like that seems kind of specific well who has access to system just every system on authenticated which",
    "start": "1076920",
    "end": "1084660"
  },
  {
    "text": "means literally anybody who is sending you a crawl into your cluster has access to system discovery and systems every",
    "start": "1084660",
    "end": "1091380"
  },
  {
    "text": "has access to anything that has an API on it which because communities API based and that is how you control the",
    "start": "1091380",
    "end": "1097110"
  },
  {
    "text": "thing allows you to control the cluster in that way this is still the default this is how it works out of the box so",
    "start": "1097110",
    "end": "1103290"
  },
  {
    "text": "it's important to be able to you know put your PSPs on it do your back right",
    "start": "1103290",
    "end": "1108900"
  },
  {
    "text": "and make sure that you can prevent people from being able to execute",
    "start": "1108900",
    "end": "1115080"
  },
  {
    "text": "commands by just doing that the thing is that when you're doing that all of those",
    "start": "1115080",
    "end": "1120420"
  },
  {
    "text": "policies are getting routed through the API server which are which is the component that is making sure that that",
    "start": "1120420",
    "end": "1126420"
  },
  {
    "text": "authorization is correct and when you bypass it it's a good point so that's",
    "start": "1126420",
    "end": "1131550"
  },
  {
    "text": "how the CVE happened it's why it was pretty great as an attacker but why it's",
    "start": "1131550",
    "end": "1136950"
  },
  {
    "text": "pretty serious as a defender what could go wrong maybe you could leave this",
    "start": "1136950",
    "end": "1142559"
  },
  {
    "text": "unpatched maybe it'd be fine well things that could go wrong if you leave this",
    "start": "1142559",
    "end": "1148350"
  },
  {
    "start": "1144000",
    "end": "1203000"
  },
  {
    "text": "unpatched could potentially include people crypto mining putting compromised",
    "start": "1148350",
    "end": "1153990"
  },
  {
    "text": "containers into your cluster hijacking compute resources stealing secrets stealing",
    "start": "1153990",
    "end": "1159730"
  },
  {
    "text": "for sensitive data customer data cloud metadata it could people could inject",
    "start": "1159730",
    "end": "1165490"
  },
  {
    "text": "malicious code they could push things up to your registry and create supply chain attacks that could be stayed further",
    "start": "1165490",
    "end": "1171550"
  },
  {
    "text": "down the line and they could take over the cluster and do actually just absolutely whatever they wanted and as",
    "start": "1171550",
    "end": "1178030"
  },
  {
    "text": "an attacker was an evil imagination let me tell you we can come up with a lot so",
    "start": "1178030",
    "end": "1183630"
  },
  {
    "text": "anything in attacker can dream up they could do in here with us unpatched that's not ideal especially with the",
    "start": "1183630",
    "end": "1190930"
  },
  {
    "text": "unauthenticated version with the authenticated version they have to be authorized to communicate with the pod",
    "start": "1190930",
    "end": "1196030"
  },
  {
    "text": "but from there they could escalate their religious and all of this can happen in",
    "start": "1196030",
    "end": "1203440"
  },
  {
    "start": "1203000",
    "end": "1265000"
  },
  {
    "text": "order to demonstrate this I'm going to play you an exploit demo which is I will",
    "start": "1203440",
    "end": "1209650"
  },
  {
    "text": "narrate it for you I think that I actually have to break the fourth law for half a second and go into this",
    "start": "1209650",
    "end": "1215950"
  },
  {
    "text": "terminal in order to make that work so I'm gonna play this for you this is",
    "start": "1215950",
    "end": "1222910"
  },
  {
    "text": "somebody from twist slack demo because my demo is totally broken so thank you tryst luck what this person is doing is",
    "start": "1222910",
    "end": "1228730"
  },
  {
    "text": "they're creating a default nginx pod in a cluster and they're getting the",
    "start": "1228730",
    "end": "1234700"
  },
  {
    "text": "namespaces for all of the pods so oh no okay well let's see anybody who has AV",
    "start": "1234700",
    "end": "1245320"
  },
  {
    "text": "stuff know how to make it work anyway",
    "start": "1245320",
    "end": "1249929"
  },
  {
    "text": "wait I do what now okay well I have a double broken demo but let me tell you",
    "start": "1253470",
    "end": "1260440"
  },
  {
    "text": "what's going on here which is that I'm gonna hit play and so basically what",
    "start": "1260440",
    "end": "1266800"
  },
  {
    "start": "1265000",
    "end": "1330000"
  },
  {
    "text": "happens when this works is the person creates a default engine X pod and just",
    "start": "1266800",
    "end": "1272080"
  },
  {
    "text": "it's just totally generic Hamel it's like you know name engine X you know",
    "start": "1272080",
    "end": "1277120"
  },
  {
    "text": "just it creates it coupe CTF great and",
    "start": "1277120",
    "end": "1282450"
  },
  {
    "text": "from there it gets the list of namespaces in the pods that it has",
    "start": "1282450",
    "end": "1288280"
  },
  {
    "text": "available which is not everything it downloads this exploit it literally is just exploit POC RB at that point what",
    "start": "1288280",
    "end": "1296230"
  },
  {
    "text": "the thing does is it sends that up accrued request and the WebSocket is opened and then it gets a long list of",
    "start": "1296230",
    "end": "1304090"
  },
  {
    "text": "JSON metadata that is from all of the namespaces with all of the secrets and all of the other metadata in the",
    "start": "1304090",
    "end": "1309790"
  },
  {
    "text": "entirety of the cluster still don't know why that didn't work but that is what happened it is a short demo and",
    "start": "1309790",
    "end": "1315030"
  },
  {
    "text": "basically what that is is literally just okay you send a request to something like metrics connection upgrade",
    "start": "1315030",
    "end": "1321400"
  },
  {
    "text": "connection upgrades at that point it's yours you can just do whatever you want with it",
    "start": "1321400",
    "end": "1326740"
  },
  {
    "text": "communicate directly with the backend there are a lot of published exploits",
    "start": "1326740",
    "end": "1332710"
  },
  {
    "start": "1330000",
    "end": "1401000"
  },
  {
    "text": "for this I ran out of space on this slide and there are one two three four",
    "start": "1332710",
    "end": "1337990"
  },
  {
    "text": "five six seven and I had to leave off like six more there are many ways to pop",
    "start": "1337990",
    "end": "1343630"
  },
  {
    "text": "a box and I think it's really interesting because at first when the",
    "start": "1343630",
    "end": "1349360"
  },
  {
    "text": "exploit started coming out as I said security people tend to be a little bit",
    "start": "1349360",
    "end": "1354940"
  },
  {
    "text": "farther behind then then cloud native folks do so because everybody moves here at the",
    "start": "1354940",
    "end": "1361180"
  },
  {
    "text": "speed of light so at first they were written and go and they were written by people like chris nova who you know had",
    "start": "1361180",
    "end": "1368410"
  },
  {
    "text": "who knew go and had devops experience and as there started to be more",
    "start": "1368410",
    "end": "1374200"
  },
  {
    "text": "attention on this and as people were starting to understand how it works better they started to be written in python and ruby and different kinds of languages and they all deal with it",
    "start": "1374200",
    "end": "1381220"
  },
  {
    "text": "differently which is super interesting to me just as like a nerd and somebody who loves what's like one of them did DNS",
    "start": "1381220",
    "end": "1386559"
  },
  {
    "text": "tunneling one of them did it through SSH one of them did a kind of server side request forgery and it's really fun if",
    "start": "1386559",
    "end": "1392380"
  },
  {
    "text": "you if you nerd out about that stuff it's worth looking out through the different ways that people chose to solve that problem because that's pretty cool",
    "start": "1392380",
    "end": "1397390"
  },
  {
    "text": "and there are more out there so how did this get fixed it was actually a really",
    "start": "1397390",
    "end": "1403840"
  },
  {
    "start": "1401000",
    "end": "1434000"
  },
  {
    "text": "short was a 37 line commit change and all it did was just validate for whether",
    "start": "1403840",
    "end": "1410230"
  },
  {
    "text": "or not that code returned valid so if a connection request was sent that said",
    "start": "1410230",
    "end": "1415900"
  },
  {
    "text": "connection upgrade then it would check to see whether it was real and if it",
    "start": "1415900",
    "end": "1421540"
  },
  {
    "text": "wasn't authorized then it wouldn't open the connection and upgrade it it would just stop and if it was real which it",
    "start": "1421540",
    "end": "1427000"
  },
  {
    "text": "made sure it was then it would open it up and business and communication would continue as usual and here is the actual",
    "start": "1427000",
    "end": "1435910"
  },
  {
    "start": "1434000",
    "end": "1485000"
  },
  {
    "text": "code of commit change and as you can see it's upgrade aware go is where that fix",
    "start": "1435910",
    "end": "1442120"
  },
  {
    "text": "was and literally all it does is it just checks to see whether or not it has an error and what the snaps code is and if",
    "start": "1442120",
    "end": "1449830"
  },
  {
    "text": "it contains an error it doesn't open it and that's all it's actually a pretty easy fix because it's actually a pretty",
    "start": "1449830",
    "end": "1455590"
  },
  {
    "text": "simple vulnerability but one where the logic actually could create pretty",
    "start": "1455590",
    "end": "1461500"
  },
  {
    "text": "severe consequences so that got put out backup patched cloud providers patched",
    "start": "1461500",
    "end": "1466980"
  },
  {
    "text": "in some cases within hours in one case within I think it took a full day but it",
    "start": "1466980",
    "end": "1472840"
  },
  {
    "text": "took a day so if you are on a cloud provider if your clusters are managed this got patched in December if you're",
    "start": "1472840",
    "end": "1478510"
  },
  {
    "text": "rolling your own I hope that you've updated by now if you haven't please do that when you have the chance so what",
    "start": "1478510",
    "end": "1485710"
  },
  {
    "start": "1485000",
    "end": "1547000"
  },
  {
    "text": "are the mitigations for this updating really is the only practical mitigation because of the way that the you know one",
    "start": "1485710",
    "end": "1493780"
  },
  {
    "text": "kind of workaround people were saying maybe you could try to not allow an",
    "start": "1493780",
    "end": "1499240"
  },
  {
    "text": "authenticated access like on anonymous access but all that did was prevent people from being able to use that",
    "start": "1499240",
    "end": "1505059"
  },
  {
    "text": "attack vector and because of the way that the local people in escalation worked on the other attack vector people",
    "start": "1505059",
    "end": "1511570"
  },
  {
    "text": "could still do that because they were actually authorized it wasn't unauthorized use because of the way that our back treats that",
    "start": "1511570",
    "end": "1517210"
  },
  {
    "text": "so do that and the other workarounds that they had were really impractical and would just rake your cluster so I",
    "start": "1517210",
    "end": "1524650"
  },
  {
    "text": "they're not recommended I'm not even gonna go into them because they don't really make any sense it was like okay make it so that nothing can communicate",
    "start": "1524650",
    "end": "1530970"
  },
  {
    "text": "probably if you're running a cluster you probably want things to be able to communicate and so I don't necessarily suggest that really the way to do this",
    "start": "1530970",
    "end": "1537490"
  },
  {
    "text": "is to update if you're managed quad writer did it for you if you aren't managed you can do it yourself and I",
    "start": "1537490",
    "end": "1544300"
  },
  {
    "text": "hope you have by now so how do we now that we understand how this works which",
    "start": "1544300",
    "end": "1550210"
  },
  {
    "start": "1547000",
    "end": "1579000"
  },
  {
    "text": "again it's pretty simple if you understand the way that um these connections work and the way that flaw",
    "start": "1550210",
    "end": "1556300"
  },
  {
    "text": "happened and the way that it got fixed how can we mitigate fails like this plus like this in the future because the",
    "start": "1556300",
    "end": "1562120"
  },
  {
    "text": "thing is that we're going to connection reduce is not necessarily an uncommon problem this isn't unique to kubernetes",
    "start": "1562120",
    "end": "1567400"
  },
  {
    "text": "and you know we'll probably see things like this again how can we how can we",
    "start": "1567400",
    "end": "1573310"
  },
  {
    "text": "make our architecture better so that the next time we see something like this it isn't as catastrophic we need to",
    "start": "1573310",
    "end": "1580870"
  },
  {
    "start": "1579000",
    "end": "1631000"
  },
  {
    "text": "practice defense in depth so anybody here like played a tower defense game or plants versus zombies or anything like",
    "start": "1580870",
    "end": "1586840"
  },
  {
    "text": "that a couple of you nobody plays video games in this room so you know how if you're playing a tower defense game you",
    "start": "1586840",
    "end": "1592840"
  },
  {
    "text": "don't want one line of defense right you want your walls and then you want stuff behind the walls and then you want stuff behind it",
    "start": "1592840",
    "end": "1598270"
  },
  {
    "text": "defense and depth is like that where you want to make sure that it's not you're you're not depending on your firewall in",
    "start": "1598270",
    "end": "1605230"
  },
  {
    "text": "the middle you're not hoping that as long as nobody breaches the perimeter it's fine and everything in there is all",
    "start": "1605230",
    "end": "1611350"
  },
  {
    "text": "soft and juicy and unprotected you want to make sure that that you are hardening",
    "start": "1611350",
    "end": "1618730"
  },
  {
    "text": "the different parts of your attack surface such that you're making your attack surface more difficult to get",
    "start": "1618730",
    "end": "1625090"
  },
  {
    "text": "into and if somebody like me manages to get into it you're making your blast radius as small as possible so one way",
    "start": "1625090",
    "end": "1632320"
  },
  {
    "start": "1631000",
    "end": "1722000"
  },
  {
    "text": "you could do defense in depth is for example operate on a zero trust model which kubernetes doesn't currently do so",
    "start": "1632320",
    "end": "1639280"
  },
  {
    "text": "the API server is not that different in a lot of ways than a traditional firewall it sits in the middle it tells",
    "start": "1639280",
    "end": "1645910"
  },
  {
    "text": "you know tells the computer or whoever what what kind are allowed what connections are denied",
    "start": "1645910",
    "end": "1652340"
  },
  {
    "text": "and if that can be penetrated or bypassed it's gone and you can just be",
    "start": "1652340",
    "end": "1658400"
  },
  {
    "text": "able to take over that cluster if for example on the other end of it if the",
    "start": "1658400",
    "end": "1663440"
  },
  {
    "text": "user could communicate directly with the back-end server and the backend server was like I'm also authenticating you",
    "start": "1663440",
    "end": "1669290"
  },
  {
    "text": "this is not a valid request what are you doing and prevented the user from being able to successfully make those kinds of",
    "start": "1669290",
    "end": "1675770"
  },
  {
    "text": "requests then this CDA wouldn't have been severe and if we start thinking about operating on a you know don't",
    "start": "1675770",
    "end": "1683419"
  },
  {
    "text": "trust and verify kind of model where you know every time a request is made it's",
    "start": "1683419",
    "end": "1689330"
  },
  {
    "text": "getting authenticated in different ways in some ways it's less efficient but it can be more secure so obviously that can",
    "start": "1689330",
    "end": "1695419"
  },
  {
    "text": "be a balance in terms of the way that you are constructing your things and you",
    "start": "1695419",
    "end": "1700520"
  },
  {
    "text": "know trade-offs of speed and convenience versus being able to harden it as much as possible but if we start moving more",
    "start": "1700520",
    "end": "1707179"
  },
  {
    "text": "towards zero trust architecture this can allow us to be able to if we see flaws",
    "start": "1707179",
    "end": "1715040"
  },
  {
    "text": "like this in the future we're not it's not going to be as much of an issue and it can allow us to practice more",
    "start": "1715040",
    "end": "1720350"
  },
  {
    "text": "defense-in-depth and make our architecture harder and that's the thing that you can do as a cluster operator is",
    "start": "1720350",
    "end": "1728150"
  },
  {
    "start": "1722000",
    "end": "1783000"
  },
  {
    "text": "watch your dependencies because one of the things that you know how did people",
    "start": "1728150",
    "end": "1734750"
  },
  {
    "text": "get these extension API servers some of them probably set their clusters up that way on purpose some of them set their clusters up that",
    "start": "1734750",
    "end": "1741410"
  },
  {
    "text": "way not necessarily on purpose because it was the default that came out of the box when they put their plugins in or when they did their setup you want to",
    "start": "1741410",
    "end": "1748250"
  },
  {
    "text": "make sure that you know what is in your clusters and what it's doing and if you don't need it maybe consider whether or",
    "start": "1748250",
    "end": "1754160"
  },
  {
    "text": "not it needs to be there basically you're keeping things to need-to-know communication and whether or not it",
    "start": "1754160",
    "end": "1760669"
  },
  {
    "text": "needs to be in their supply chain attacks are real we've seen things like that recently with the docker hub breach",
    "start": "1760669",
    "end": "1767630"
  },
  {
    "text": "that could you know if that got bad if everybody is pulling down alpine from",
    "start": "1767630",
    "end": "1773510"
  },
  {
    "text": "like the stock images and alkyne is compromised that can have cascading failures down the line so it's really",
    "start": "1773510",
    "end": "1779179"
  },
  {
    "text": "important that we watch our supply chain and they were watching the dependencies that using and making sure they're good and",
    "start": "1779179",
    "end": "1784669"
  },
  {
    "start": "1783000",
    "end": "1817000"
  },
  {
    "text": "again keep uptodate kubernetes moves really fast we all do amazing work we're all moving at the speed of light here",
    "start": "1784669",
    "end": "1790340"
  },
  {
    "text": "and that's great but also it can be hard to keep up with it can we hard to keep up with it as an",
    "start": "1790340",
    "end": "1796489"
  },
  {
    "text": "operator as a defender sometimes as a speaker and you want to make sure that",
    "start": "1796489",
    "end": "1801649"
  },
  {
    "text": "you're moving with it because as kubernetes as a project has been improving security with time we want to",
    "start": "1801649",
    "end": "1807139"
  },
  {
    "text": "make sure that as defenders and operators that we're also keeping up with it and we are improving security at",
    "start": "1807139",
    "end": "1812299"
  },
  {
    "text": "the pace that they are or at least trying to keep up and what else can we",
    "start": "1812299",
    "end": "1819349"
  },
  {
    "start": "1817000",
    "end": "1842000"
  },
  {
    "text": "learn from this the kubernetes security working group did a post-mortem on this",
    "start": "1819349",
    "end": "1825229"
  },
  {
    "text": "about what went well what went wrong what could be learned from it there's a lot of really interesting information",
    "start": "1825229",
    "end": "1830899"
  },
  {
    "text": "there they talked about you know the CVE itself the vulnerability how it worked",
    "start": "1830899",
    "end": "1836330"
  },
  {
    "text": "and how it affected the project but they also talk about their Incident Response process and the things that went well",
    "start": "1836330",
    "end": "1842989"
  },
  {
    "start": "1842000",
    "end": "1867000"
  },
  {
    "text": "which you know they were like we really feel like we triage this well we dealt this with as well as a group but also",
    "start": "1842989",
    "end": "1849409"
  },
  {
    "text": "the things that went not as well like maybe the original outbound communication was kind of confusing to",
    "start": "1849409",
    "end": "1854840"
  },
  {
    "text": "people and that confusion led to you know things being patched slower or",
    "start": "1854840",
    "end": "1861200"
  },
  {
    "text": "people not understanding what to do and so that's a really interesting thing to",
    "start": "1861200",
    "end": "1866239"
  },
  {
    "text": "read and I think one thing that we can learn from this is that cloud native people and security people generally",
    "start": "1866239",
    "end": "1873139"
  },
  {
    "start": "1867000",
    "end": "1950000"
  },
  {
    "text": "need to communicate better and explain things better to one another because a lot of the time that doesn't happen cloud native people do move really",
    "start": "1873139",
    "end": "1879470"
  },
  {
    "text": "quickly and are you know moving so fast that they can't write documentation to keep up with it and I get it",
    "start": "1879470",
    "end": "1886029"
  },
  {
    "text": "but I think that the general public sometimes has a hard time keeping up",
    "start": "1886029",
    "end": "1892609"
  },
  {
    "text": "with that rate of change and I think people want to understand and security people want to do well like nobody's trying to slow your down and make your",
    "start": "1892609",
    "end": "1898519"
  },
  {
    "text": "day sad everybody is trying to like you know figure out what's going on and do well with it so I think if people",
    "start": "1898519",
    "end": "1904519"
  },
  {
    "text": "community on this side communicate well to security people about what it is that they're trying to accomplish what their",
    "start": "1904519",
    "end": "1909649"
  },
  {
    "text": "goals are and and maybe try to have a little bit of understanding of security people because as I said we're really",
    "start": "1909649",
    "end": "1914909"
  },
  {
    "text": "here to make your day hard we're really just trying to like work with you and make it good so understanding that we're",
    "start": "1914909",
    "end": "1921960"
  },
  {
    "text": "all moving towards the same goal explaining what it is that we're doing and how it works I think if we can",
    "start": "1921960",
    "end": "1927509"
  },
  {
    "text": "improve communication better on both sides of that on this side of the news cycle I think that can really help a lot because it can avoid confusion and panic",
    "start": "1927509",
    "end": "1935460"
  },
  {
    "text": "and things like that after the fact when things like this new come out and more things like this will come out again and so the more we can learn from the way",
    "start": "1935460",
    "end": "1941669"
  },
  {
    "text": "that this one got dealt with the better we can do in the future so yeah greater communication radiator",
    "start": "1941669",
    "end": "1948779"
  },
  {
    "text": "understanding and we can all do that there's a double rainbow",
    "start": "1948779",
    "end": "1954479"
  },
  {
    "start": "1950000",
    "end": "1962000"
  },
  {
    "text": "I believe in everyone in this room we can secure our architecture we can communicate better all of us can do it",
    "start": "1954479",
    "end": "1962210"
  },
  {
    "start": "1962000",
    "end": "2014000"
  },
  {
    "text": "this is a resource slide it's got a lot of stuff on it both how you know the CVE",
    "start": "1962210",
    "end": "1969720"
  },
  {
    "text": "itself the details around it also a couple of blog posts with exploits",
    "start": "1969720",
    "end": "1975179"
  },
  {
    "text": "attached and people you know kind of dissecting it figuring out how it works",
    "start": "1975179",
    "end": "1980369"
  },
  {
    "text": "and explaining it people also Darren Shepherd who discovered it tells his story and the one on the bottom which is",
    "start": "1980369",
    "end": "1985590"
  },
  {
    "text": "pretty cool because you can kind of hear about the history of that and how it worked and if you're nerdy about that like me that could be fun so that is my",
    "start": "1985590",
    "end": "1995159"
  },
  {
    "text": "talk and I probably went through it really fast cuz I was out of breath the whole time and I really appreciate all",
    "start": "1995159",
    "end": "2001279"
  },
  {
    "text": "of you being here and thank you all very much for taking the time and I would be happy to take questions if anybody wants",
    "start": "2001279",
    "end": "2006559"
  },
  {
    "text": "to ask any",
    "start": "2006559",
    "end": "2008859"
  },
  {
    "text": "[Applause]",
    "start": "2013190",
    "end": "2016339"
  }
]