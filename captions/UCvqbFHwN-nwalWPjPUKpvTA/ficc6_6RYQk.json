[
  {
    "start": "0",
    "end": "17000"
  },
  {
    "text": "all right uh hey everybody um",
    "start": "160",
    "end": "2800"
  },
  {
    "text": "welcome to our coupon talk um today we",
    "start": "2800",
    "end": "5680"
  },
  {
    "text": "want to talk about comprov profiling in",
    "start": "5680",
    "end": "7919"
  },
  {
    "text": "the cloud native era and actually we",
    "start": "7919",
    "end": "10559"
  },
  {
    "text": "don't want to talk about comprov but",
    "start": "10559",
    "end": "12320"
  },
  {
    "text": "more specifically about paca which is",
    "start": "12320",
    "end": "14719"
  },
  {
    "text": "the next version of comprov",
    "start": "14719",
    "end": "17920"
  },
  {
    "start": "17000",
    "end": "17000"
  },
  {
    "text": "i'm matthias laura i'm a senior software",
    "start": "17920",
    "end": "19760"
  },
  {
    "text": "engineer at polar signals",
    "start": "19760",
    "end": "21680"
  },
  {
    "text": "next to maintaining parker i also work",
    "start": "21680",
    "end": "24800"
  },
  {
    "text": "on thanos",
    "start": "24800",
    "end": "26160"
  },
  {
    "text": "the prometheus operator and recently",
    "start": "26160",
    "end": "28640"
  },
  {
    "text": "started hacking on pura which is an",
    "start": "28640",
    "end": "32078"
  },
  {
    "text": "slo management tool for prometheus",
    "start": "32079",
    "end": "35040"
  },
  {
    "text": "and with me today is kamai yeah hello",
    "start": "35040",
    "end": "37680"
  },
  {
    "text": "everyone my name is kamagapkuin i'm a",
    "start": "37680",
    "end": "40719"
  },
  {
    "text": "senior software engineer at older",
    "start": "40719",
    "end": "42320"
  },
  {
    "text": "signals as well i just recently joined",
    "start": "42320",
    "end": "44640"
  },
  {
    "text": "previously i was working for reddit",
    "start": "44640",
    "end": "47120"
  },
  {
    "text": "uh besides working on cool things in",
    "start": "47120",
    "end": "49680"
  },
  {
    "text": "polar signals i'm also a maintainer of",
    "start": "49680",
    "end": "52160"
  },
  {
    "text": "thomas project uh prometheus client go",
    "start": "52160",
    "end": "55360"
  },
  {
    "text": "and cue prometheus and now parker",
    "start": "55360",
    "end": "59120"
  },
  {
    "text": "so",
    "start": "59120",
    "end": "60320"
  },
  {
    "text": "today we are going to talk about",
    "start": "60320",
    "end": "62480"
  },
  {
    "text": "continuous profiling but before that we",
    "start": "62480",
    "end": "65600"
  },
  {
    "text": "need to just",
    "start": "65600",
    "end": "67200"
  },
  {
    "text": "do some grunt work and talk about",
    "start": "67200",
    "end": "69119"
  },
  {
    "text": "profiling profiling itself as old as",
    "start": "69119",
    "end": "72560"
  },
  {
    "text": "programming and the according to our",
    "start": "72560",
    "end": "75280"
  },
  {
    "text": "research we could we could",
    "start": "75280",
    "end": "77520"
  },
  {
    "text": "see some academic papers stated back in",
    "start": "77520",
    "end": "80000"
  },
  {
    "text": "the 1970s",
    "start": "80000",
    "end": "82560"
  },
  {
    "text": "so what is profiling so profiling is a",
    "start": "82560",
    "end": "85920"
  },
  {
    "start": "83000",
    "end": "83000"
  },
  {
    "text": "form of a dynamic problem program",
    "start": "85920",
    "end": "88240"
  },
  {
    "text": "analysis where you get the measurements",
    "start": "88240",
    "end": "90799"
  },
  {
    "text": "about space and time complexity and the",
    "start": "90799",
    "end": "94000"
  },
  {
    "text": "usage of in instructions and all their",
    "start": "94000",
    "end": "96640"
  },
  {
    "text": "frequency and duration uh",
    "start": "96640",
    "end": "99280"
  },
  {
    "text": "overall so why do we use this profiling",
    "start": "99280",
    "end": "102560"
  },
  {
    "text": "and what can we do with this profiles we",
    "start": "102560",
    "end": "105040"
  },
  {
    "text": "can actually",
    "start": "105040",
    "end": "106560"
  },
  {
    "text": "check out the cpus and",
    "start": "106560",
    "end": "108880"
  },
  {
    "text": "from the cpus we can determine where an",
    "start": "108880",
    "end": "112000"
  },
  {
    "text": "actual program is spending it's much of",
    "start": "112000",
    "end": "114159"
  },
  {
    "text": "its time or",
    "start": "114159",
    "end": "116000"
  },
  {
    "text": "how its uses memory like what is",
    "start": "116000",
    "end": "118079"
  },
  {
    "text": "allocating and",
    "start": "118079",
    "end": "119920"
  },
  {
    "text": "how many times it's allocated what not",
    "start": "119920",
    "end": "123920"
  },
  {
    "text": "so",
    "start": "123920",
    "end": "124719"
  },
  {
    "text": "today we actually",
    "start": "124719",
    "end": "127280"
  },
  {
    "text": "focus on the sampling profilers and",
    "start": "127280",
    "end": "130800"
  },
  {
    "text": "because",
    "start": "130800",
    "end": "132000"
  },
  {
    "text": "it's more feasible to build upon",
    "start": "132000",
    "end": "135290"
  },
  {
    "text": "[Music]",
    "start": "135290",
    "end": "136800"
  },
  {
    "text": "the processes that we have today so how",
    "start": "136800",
    "end": "139599"
  },
  {
    "text": "it works is it's actually let's say we",
    "start": "139599",
    "end": "142239"
  },
  {
    "text": "want to profile a process for 10 seconds",
    "start": "142239",
    "end": "144879"
  },
  {
    "text": "we collect and aggregate all of the data",
    "start": "144879",
    "end": "147599"
  },
  {
    "text": "and then periodically we just collect",
    "start": "147599",
    "end": "150080"
  },
  {
    "text": "this data from the processes",
    "start": "150080",
    "end": "152560"
  },
  {
    "text": "process and",
    "start": "152560",
    "end": "154000"
  },
  {
    "text": "this since uh the samples snapshots uh",
    "start": "154000",
    "end": "157920"
  },
  {
    "text": "like uh the net not that infrequent and",
    "start": "157920",
    "end": "161599"
  },
  {
    "text": "that frequent uh for the cpus this has",
    "start": "161599",
    "end": "164400"
  },
  {
    "text": "really low overhead to check this data",
    "start": "164400",
    "end": "167040"
  },
  {
    "text": "there is also a nice paper from google",
    "start": "167040",
    "end": "169360"
  },
  {
    "text": "you can check out in the video",
    "start": "169360",
    "end": "172080"
  },
  {
    "text": "so today we gonna specifically talk",
    "start": "172080",
    "end": "175360"
  },
  {
    "text": "about a little bit about p prof uh p",
    "start": "175360",
    "end": "177920"
  },
  {
    "text": "proof itself is a profiler it has like",
    "start": "177920",
    "end": "180959"
  },
  {
    "text": "cross language support and that's why we",
    "start": "180959",
    "end": "183280"
  },
  {
    "text": "kind of picked that so p prof uh a tool",
    "start": "183280",
    "end": "186879"
  },
  {
    "text": "from google and it actually specified an",
    "start": "186879",
    "end": "190319"
  },
  {
    "text": "open format in form of protograph",
    "start": "190319",
    "end": "193519"
  },
  {
    "text": "and it's like",
    "start": "193519",
    "end": "194959"
  },
  {
    "text": "reads a collection of profiles from the",
    "start": "194959",
    "end": "197360"
  },
  {
    "text": "processes it can either use an http",
    "start": "197360",
    "end": "199760"
  },
  {
    "text": "endpoint or it can it can use a local",
    "start": "199760",
    "end": "202319"
  },
  {
    "text": "file uh in formatted",
    "start": "202319",
    "end": "205360"
  },
  {
    "text": "protocol",
    "start": "205360",
    "end": "206560"
  },
  {
    "text": "product",
    "start": "206560",
    "end": "208239"
  },
  {
    "text": "and this tool is also using",
    "start": "208239",
    "end": "210959"
  },
  {
    "text": "dot visualizations using graphics uh you",
    "start": "210959",
    "end": "213920"
  },
  {
    "text": "it can",
    "start": "213920",
    "end": "214799"
  },
  {
    "text": "actually visualize i'm sure like you",
    "start": "214799",
    "end": "216959"
  },
  {
    "text": "have seen a couple of demos uh how you",
    "start": "216959",
    "end": "219760"
  },
  {
    "text": "can use the keyboard",
    "start": "219760",
    "end": "221440"
  },
  {
    "text": "people has a lot a lot of language",
    "start": "221440",
    "end": "223680"
  },
  {
    "start": "222000",
    "end": "222000"
  },
  {
    "text": "supports some of uh language uh supports",
    "start": "223680",
    "end": "226239"
  },
  {
    "text": "already and some of them is like really",
    "start": "226239",
    "end": "228879"
  },
  {
    "text": "good uh like gold because it's also from",
    "start": "228879",
    "end": "231280"
  },
  {
    "text": "google and some of them is just really",
    "start": "231280",
    "end": "234000"
  },
  {
    "text": "getting there but since",
    "start": "234000",
    "end": "236000"
  },
  {
    "text": "prof is an open format and you can",
    "start": "236000",
    "end": "238400"
  },
  {
    "text": "actually just like any language runtime",
    "start": "238400",
    "end": "240560"
  },
  {
    "text": "can actually support this",
    "start": "240560",
    "end": "243280"
  },
  {
    "start": "243000",
    "end": "243000"
  },
  {
    "text": "so let's dive into code and see",
    "start": "243280",
    "end": "246480"
  },
  {
    "text": "these things in action in the left you",
    "start": "246480",
    "end": "248799"
  },
  {
    "text": "see a code piece and it's just doing",
    "start": "248799",
    "end": "251120"
  },
  {
    "text": "some iterations and doing some function",
    "start": "251120",
    "end": "253760"
  },
  {
    "text": "calls and when this program is running",
    "start": "253760",
    "end": "256239"
  },
  {
    "text": "uh we are like doing a sampling",
    "start": "256239",
    "end": "259600"
  },
  {
    "text": "profiling and from the samples we kind",
    "start": "259600",
    "end": "262320"
  },
  {
    "text": "of end up uh something like in the right",
    "start": "262320",
    "end": "265199"
  },
  {
    "text": "way this format in the right is called",
    "start": "265199",
    "end": "267199"
  },
  {
    "text": "folded stack trace it's par",
    "start": "267199",
    "end": "269280"
  },
  {
    "text": "from brandon greg",
    "start": "269280",
    "end": "270960"
  },
  {
    "text": "it's super",
    "start": "270960",
    "end": "272320"
  },
  {
    "text": "easy to",
    "start": "272320",
    "end": "273520"
  },
  {
    "text": "understand because it's just simple it's",
    "start": "273520",
    "end": "276080"
  },
  {
    "text": "it's a it represents a",
    "start": "276080",
    "end": "278160"
  },
  {
    "text": "stack calls and then",
    "start": "278160",
    "end": "280880"
  },
  {
    "text": "whenever you see that stack you just uh",
    "start": "280880",
    "end": "283280"
  },
  {
    "text": "put an entry in there and just you can",
    "start": "283280",
    "end": "285199"
  },
  {
    "text": "just count them over",
    "start": "285199",
    "end": "286960"
  },
  {
    "text": "uh but it's like a lot of redundant",
    "start": "286960",
    "end": "289120"
  },
  {
    "text": "information uh that same folded stack",
    "start": "289120",
    "end": "291919"
  },
  {
    "text": "trace can be interpreted in the uh",
    "start": "291919",
    "end": "294160"
  },
  {
    "text": "keeper format as aggregation of the",
    "start": "294160",
    "end": "296800"
  },
  {
    "text": "locations and how many times we actually",
    "start": "296800",
    "end": "299120"
  },
  {
    "text": "seen that step choice",
    "start": "299120",
    "end": "300880"
  },
  {
    "text": "uh",
    "start": "300880",
    "end": "302639"
  },
  {
    "text": "in order to understand this p pro uh",
    "start": "302639",
    "end": "304880"
  },
  {
    "text": "format more in that you can actually",
    "start": "304880",
    "end": "307199"
  },
  {
    "text": "check out",
    "start": "307199",
    "end": "308400"
  },
  {
    "text": "a blog post from matthias which is",
    "start": "308400",
    "end": "311120"
  },
  {
    "text": "already in the uh polar signals blog you",
    "start": "311120",
    "end": "314160"
  },
  {
    "text": "can have the link",
    "start": "314160",
    "end": "316160"
  },
  {
    "text": "inside the slides",
    "start": "316160",
    "end": "317759"
  },
  {
    "start": "317000",
    "end": "317000"
  },
  {
    "text": "so we already talked about people can",
    "start": "317759",
    "end": "320400"
  },
  {
    "text": "actually",
    "start": "320400",
    "end": "322479"
  },
  {
    "text": "fetch the profiles using an http",
    "start": "322479",
    "end": "324880"
  },
  {
    "text": "endpoint you can in this slide you can",
    "start": "324880",
    "end": "327280"
  },
  {
    "text": "see",
    "start": "327280",
    "end": "328160"
  },
  {
    "text": "how you can actually instrument your",
    "start": "328160",
    "end": "330000"
  },
  {
    "text": "application to actually expose that",
    "start": "330000",
    "end": "332400"
  },
  {
    "text": "profiling endpoints it is super simple",
    "start": "332400",
    "end": "334880"
  },
  {
    "text": "for go itself it's already built in the",
    "start": "334880",
    "end": "337759"
  },
  {
    "text": "runtime standard library you can just",
    "start": "337759",
    "end": "340320"
  },
  {
    "text": "like get the net http prof library and",
    "start": "340320",
    "end": "343919"
  },
  {
    "text": "you can just register those handlers and",
    "start": "343919",
    "end": "346160"
  },
  {
    "text": "you already have those endpoints exposed",
    "start": "346160",
    "end": "348560"
  },
  {
    "text": "from your process",
    "start": "348560",
    "end": "350000"
  },
  {
    "text": "uh same goes for for example another",
    "start": "350000",
    "end": "353759"
  },
  {
    "text": "popular language javascript it's also",
    "start": "353759",
    "end": "356080"
  },
  {
    "text": "like super econ we need to add with the",
    "start": "356080",
    "end": "358479"
  },
  {
    "text": "libraries you just like register an",
    "start": "358479",
    "end": "360160"
  },
  {
    "text": "endpoint and uh like t prof can collect",
    "start": "360160",
    "end": "363039"
  },
  {
    "text": "that profiles and then",
    "start": "363039",
    "end": "364960"
  },
  {
    "text": "actually it can also serve that",
    "start": "364960",
    "end": "366720"
  },
  {
    "text": "performance",
    "start": "366720",
    "end": "368720"
  },
  {
    "text": "so profiling is can be a really really",
    "start": "368720",
    "end": "371919"
  },
  {
    "text": "incredible tool because we can just like",
    "start": "371919",
    "end": "374560"
  },
  {
    "text": "trace anything any resource usages that",
    "start": "374560",
    "end": "376800"
  },
  {
    "text": "we have but it has some problems one of",
    "start": "376800",
    "end": "380400"
  },
  {
    "text": "those problems uh is it's momentarily so",
    "start": "380400",
    "end": "385039"
  },
  {
    "start": "381000",
    "end": "381000"
  },
  {
    "text": "you can actually just",
    "start": "385039",
    "end": "387039"
  },
  {
    "text": "try to fetch a profile for that point in",
    "start": "387039",
    "end": "389759"
  },
  {
    "text": "time and whatever you have",
    "start": "389759",
    "end": "392160"
  },
  {
    "text": "for in the memory or in the call stack",
    "start": "392160",
    "end": "394400"
  },
  {
    "text": "you just get that",
    "start": "394400",
    "end": "395840"
  },
  {
    "text": "in order to do that you need to do this",
    "start": "395840",
    "end": "398400"
  },
  {
    "text": "like manually so it's a manual process",
    "start": "398400",
    "end": "400400"
  },
  {
    "text": "you need to have",
    "start": "400400",
    "end": "402319"
  },
  {
    "text": "something to actually fetch that",
    "start": "402319",
    "end": "404240"
  },
  {
    "text": "from the",
    "start": "404240",
    "end": "405520"
  },
  {
    "text": "exposed end points for because of those",
    "start": "405520",
    "end": "408240"
  },
  {
    "text": "reasons like there are a lot of hombre",
    "start": "408240",
    "end": "410240"
  },
  {
    "text": "uh workflows and it's not like actually",
    "start": "410240",
    "end": "413199"
  },
  {
    "text": "automated or there are some scripts",
    "start": "413199",
    "end": "414960"
  },
  {
    "text": "laying around",
    "start": "414960",
    "end": "416240"
  },
  {
    "text": "specific to your organization and you",
    "start": "416240",
    "end": "418080"
  },
  {
    "text": "just like use them",
    "start": "418080",
    "end": "419680"
  },
  {
    "text": "so",
    "start": "419680",
    "end": "420720"
  },
  {
    "text": "in order to fix those things",
    "start": "420720",
    "end": "423840"
  },
  {
    "text": "which is the actual topic of our uh talk",
    "start": "423840",
    "end": "427520"
  },
  {
    "text": "is continuous profile",
    "start": "427520",
    "end": "430800"
  },
  {
    "text": "yeah and continuous profiling is the",
    "start": "430800",
    "end": "433199"
  },
  {
    "text": "foundation for what we are doing",
    "start": "433199",
    "end": "434639"
  },
  {
    "text": "obviously um and why is it important um",
    "start": "434639",
    "end": "437919"
  },
  {
    "text": "just give you another example um we we",
    "start": "437919",
    "end": "441199"
  },
  {
    "text": "might see a process run and then",
    "start": "441199",
    "end": "444880"
  },
  {
    "text": "looking at its memory all of a sudden",
    "start": "444880",
    "end": "446800"
  },
  {
    "text": "there's this drop right and",
    "start": "446800",
    "end": "449360"
  },
  {
    "text": "if you've seen it you know",
    "start": "449360",
    "end": "451039"
  },
  {
    "text": "this is like an infamous umkel uh but",
    "start": "451039",
    "end": "454000"
  },
  {
    "text": "what happened there we don't know so um",
    "start": "454000",
    "end": "456400"
  },
  {
    "text": "what we would really love is we want to",
    "start": "456400",
    "end": "459199"
  },
  {
    "start": "457000",
    "end": "457000"
  },
  {
    "text": "use prof to create the",
    "start": "459199",
    "end": "461360"
  },
  {
    "text": "the profile samples we want to sample",
    "start": "461360",
    "end": "463440"
  },
  {
    "text": "every so often we want to do it with",
    "start": "463440",
    "end": "465440"
  },
  {
    "text": "little a little overhead due to the",
    "start": "465440",
    "end": "467759"
  },
  {
    "text": "sampling as kamal explained and then",
    "start": "467759",
    "end": "470400"
  },
  {
    "text": "additionally we hope to now get the",
    "start": "470400",
    "end": "472080"
  },
  {
    "text": "profiles right before these unkills",
    "start": "472080",
    "end": "473759"
  },
  {
    "text": "happen",
    "start": "473759",
    "end": "474639"
  },
  {
    "text": "um and all of that should be done",
    "start": "474639",
    "end": "476720"
  },
  {
    "text": "automatically rather than by hand we",
    "start": "476720",
    "end": "478720"
  },
  {
    "text": "don't want the menu of the toilet",
    "start": "478720",
    "end": "480960"
  },
  {
    "text": "um so yeah enter continuous profiling",
    "start": "480960",
    "end": "484639"
  },
  {
    "text": "again just visualizing we want to do",
    "start": "484639",
    "end": "486879"
  },
  {
    "text": "this like over time um we want to",
    "start": "486879",
    "end": "489199"
  },
  {
    "text": "collect like key profiles and allocation",
    "start": "489199",
    "end": "491520"
  },
  {
    "text": "of profiles but also",
    "start": "491520",
    "end": "493840"
  },
  {
    "text": "slightly more infrequent the cpu",
    "start": "493840",
    "end": "496240"
  },
  {
    "text": "profiles",
    "start": "496240",
    "end": "497599"
  },
  {
    "text": "so we could now pick any of these",
    "start": "497599",
    "end": "499680"
  },
  {
    "text": "profiles",
    "start": "499680",
    "end": "501360"
  },
  {
    "text": "at any given point in time and",
    "start": "501360",
    "end": "504960"
  },
  {
    "text": "yeah just like look at what was going on",
    "start": "504960",
    "end": "508160"
  },
  {
    "text": "so",
    "start": "508160",
    "end": "509680"
  },
  {
    "text": "something is cheap again",
    "start": "509680",
    "end": "511840"
  },
  {
    "text": "there's not much overhead um and then by",
    "start": "511840",
    "end": "514719"
  },
  {
    "text": "storing that we can add some more index",
    "start": "514719",
    "end": "517360"
  },
  {
    "text": "data and some more metadata for example",
    "start": "517360",
    "end": "520800"
  },
  {
    "text": "the container identity so we can um see",
    "start": "520800",
    "end": "524240"
  },
  {
    "text": "where in which data center the profile",
    "start": "524240",
    "end": "526000"
  },
  {
    "text": "came from or which container etc and",
    "start": "526000",
    "end": "528320"
  },
  {
    "text": "then we can use a query language similar",
    "start": "528320",
    "end": "530240"
  },
  {
    "text": "to prom ql like prometheus has to then",
    "start": "530240",
    "end": "532880"
  },
  {
    "text": "fetch the the the profiles that we are",
    "start": "532880",
    "end": "535120"
  },
  {
    "text": "really interested in",
    "start": "535120",
    "end": "537360"
  },
  {
    "text": "and that's why we built parka or even",
    "start": "537360",
    "end": "539519"
  },
  {
    "text": "before that",
    "start": "539519",
    "end": "540560"
  },
  {
    "text": "um controv but yeah again parker is the",
    "start": "540560",
    "end": "544000"
  },
  {
    "text": "next uh version of of control",
    "start": "544000",
    "end": "547040"
  },
  {
    "text": "um and yeah come on is going to talk you",
    "start": "547040",
    "end": "550080"
  },
  {
    "text": "through that",
    "start": "550080",
    "end": "551120"
  },
  {
    "text": "parka is the new open source project",
    "start": "551120",
    "end": "553200"
  },
  {
    "text": "it's a continuation of homepro as",
    "start": "553200",
    "end": "555279"
  },
  {
    "text": "matthias already mentioned it's a",
    "start": "555279",
    "end": "557360"
  },
  {
    "text": "neutral it has a mutual government's",
    "start": "557360",
    "end": "559279"
  },
  {
    "text": "organization model and like since we",
    "start": "559279",
    "end": "561920"
  },
  {
    "text": "just recently built that uh we still uh",
    "start": "561920",
    "end": "565040"
  },
  {
    "text": "waiting for the contributions so if you",
    "start": "565040",
    "end": "566959"
  },
  {
    "text": "are into this or check it out and",
    "start": "566959",
    "end": "569279"
  },
  {
    "text": "uh please contributions are welcome",
    "start": "569279",
    "end": "572080"
  },
  {
    "text": "parker itself heavily inspired by",
    "start": "572080",
    "end": "574839"
  },
  {
    "text": "prometheus like",
    "start": "574839",
    "end": "576720"
  },
  {
    "text": "all of us are kind of coming from the",
    "start": "576720",
    "end": "578640"
  },
  {
    "text": "prometheus community that's why we like",
    "start": "578640",
    "end": "581760"
  },
  {
    "text": "uh",
    "start": "581760",
    "end": "582640"
  },
  {
    "text": "carry over a couple of things that work",
    "start": "582640",
    "end": "584880"
  },
  {
    "text": "for prometheus such as like single",
    "start": "584880",
    "end": "587200"
  },
  {
    "text": "studies statically statically linked to",
    "start": "587200",
    "end": "590080"
  },
  {
    "text": "the binaries to",
    "start": "590080",
    "end": "592160"
  },
  {
    "text": "ease up the operational work we carry",
    "start": "592160",
    "end": "594720"
  },
  {
    "text": "over the multi-dimensional label model",
    "start": "594720",
    "end": "597040"
  },
  {
    "text": "which you can actually share these",
    "start": "597040",
    "end": "598720"
  },
  {
    "text": "labels with as prometheus and we can",
    "start": "598720",
    "end": "601360"
  },
  {
    "text": "just like script and populate all those",
    "start": "601360",
    "end": "603839"
  },
  {
    "text": "labels in the park itself as well it's",
    "start": "603839",
    "end": "606079"
  },
  {
    "text": "using the same service discovery and it",
    "start": "606079",
    "end": "608880"
  },
  {
    "text": "has like new cool built-in storage as",
    "start": "608880",
    "end": "611760"
  },
  {
    "text": "well",
    "start": "611760",
    "end": "612959"
  },
  {
    "text": "in addition to parker itself we also",
    "start": "612959",
    "end": "615920"
  },
  {
    "text": "created a new thing called parka agent",
    "start": "615920",
    "end": "619440"
  },
  {
    "text": "this is one of the major differences",
    "start": "619440",
    "end": "621600"
  },
  {
    "text": "between compro and parka",
    "start": "621600",
    "end": "623760"
  },
  {
    "text": "now the agent is and proposed another",
    "start": "623760",
    "end": "626720"
  },
  {
    "text": "way to discover the workloads in your",
    "start": "626720",
    "end": "629360"
  },
  {
    "text": "running system",
    "start": "629360",
    "end": "630720"
  },
  {
    "text": "it's using ebpf and it's kind of try to",
    "start": "630720",
    "end": "633839"
  },
  {
    "text": "find off the c groups that is running on",
    "start": "633839",
    "end": "635920"
  },
  {
    "text": "your system and from those c groups is",
    "start": "635920",
    "end": "638800"
  },
  {
    "text": "trying to understand where the cpu and",
    "start": "638800",
    "end": "640720"
  },
  {
    "text": "memory or the io reso resources are",
    "start": "640720",
    "end": "642959"
  },
  {
    "text": "being used",
    "start": "642959",
    "end": "644240"
  },
  {
    "text": "it captures the current stack and traces",
    "start": "644240",
    "end": "648079"
  },
  {
    "text": "x many times per second and created an",
    "start": "648079",
    "end": "650560"
  },
  {
    "text": "analysis of that",
    "start": "650560",
    "end": "652480"
  },
  {
    "text": "you don't need to change any code you",
    "start": "652480",
    "end": "654320"
  },
  {
    "text": "just need to drop the park agent in your",
    "start": "654320",
    "end": "656640"
  },
  {
    "text": "nodes and then it can start scraping the",
    "start": "656640",
    "end": "659360"
  },
  {
    "text": "profiling data and send it over to the",
    "start": "659360",
    "end": "661519"
  },
  {
    "text": "parka",
    "start": "661519",
    "end": "662800"
  },
  {
    "text": "backend itself",
    "start": "662800",
    "end": "664959"
  },
  {
    "text": "so",
    "start": "664959",
    "end": "666320"
  },
  {
    "start": "666000",
    "end": "666000"
  },
  {
    "text": "to check out this a high level overview",
    "start": "666320",
    "end": "668800"
  },
  {
    "text": "of this profiler it just like discovers",
    "start": "668800",
    "end": "672079"
  },
  {
    "text": "c groups from the target provider this",
    "start": "672079",
    "end": "674320"
  },
  {
    "text": "could be any",
    "start": "674320",
    "end": "676079"
  },
  {
    "text": "container runtime this would be",
    "start": "676079",
    "end": "678800"
  },
  {
    "text": "docker or",
    "start": "678800",
    "end": "680320"
  },
  {
    "text": "cryo and then from that it kind of loads",
    "start": "680320",
    "end": "684320"
  },
  {
    "text": "ebpf a little ebpf program per c group",
    "start": "684320",
    "end": "688480"
  },
  {
    "text": "and and start collecting data from that",
    "start": "688480",
    "end": "691600"
  },
  {
    "text": "it reads that data right into the bpf",
    "start": "691600",
    "end": "694160"
  },
  {
    "text": "map and",
    "start": "694160",
    "end": "695200"
  },
  {
    "text": "from that vpnf map it transforms data to",
    "start": "695200",
    "end": "697920"
  },
  {
    "text": "pro approve format and then extract the",
    "start": "697920",
    "end": "700720"
  },
  {
    "text": "symbol the symbolization information and",
    "start": "700720",
    "end": "703040"
  },
  {
    "text": "then send those data over to server and",
    "start": "703040",
    "end": "705440"
  },
  {
    "text": "then",
    "start": "705440",
    "end": "706320"
  },
  {
    "text": "flashes the buffer and starts doing the",
    "start": "706320",
    "end": "708720"
  },
  {
    "text": "same thing again this is a low frequency",
    "start": "708720",
    "end": "711920"
  },
  {
    "text": "event and that's why like it doesn't",
    "start": "711920",
    "end": "714399"
  },
  {
    "text": "have a lot of overhead for",
    "start": "714399",
    "end": "717600"
  },
  {
    "text": "running systems",
    "start": "717600",
    "end": "720079"
  },
  {
    "text": "so if you want to learn more on parker",
    "start": "720079",
    "end": "722720"
  },
  {
    "text": "agents there is another talk uh from",
    "start": "722720",
    "end": "725279"
  },
  {
    "text": "frederick it's today at 5 25 pm and it",
    "start": "725279",
    "end": "729839"
  },
  {
    "text": "he really goes deep into how we actually",
    "start": "729839",
    "end": "732160"
  },
  {
    "text": "achieve the collecting data using evpn",
    "start": "732160",
    "end": "737200"
  },
  {
    "text": "so uh",
    "start": "737200",
    "end": "738720"
  },
  {
    "text": "let's uh actually see arca in action so",
    "start": "738720",
    "end": "742320"
  },
  {
    "text": "parker is running",
    "start": "742320",
    "end": "743760"
  },
  {
    "text": "in my local machine and scraping itself",
    "start": "743760",
    "end": "746560"
  },
  {
    "text": "there is also parker agent running in",
    "start": "746560",
    "end": "748399"
  },
  {
    "text": "the same machine and it's just scraping",
    "start": "748399",
    "end": "750720"
  },
  {
    "text": "the system the the c groups and",
    "start": "750720",
    "end": "753200"
  },
  {
    "text": "discovering and sending the data to",
    "start": "753200",
    "end": "756240"
  },
  {
    "text": "local parker so let's have a look at the",
    "start": "756240",
    "end": "760160"
  },
  {
    "text": "allocated space",
    "start": "760160",
    "end": "762800"
  },
  {
    "text": "and in here we can see that over an hour",
    "start": "762800",
    "end": "765760"
  },
  {
    "text": "like how parker is allocating bytes so",
    "start": "765760",
    "end": "769279"
  },
  {
    "text": "we can pick a profile",
    "start": "769279",
    "end": "771839"
  },
  {
    "text": "in nearly an hour ago and we can see",
    "start": "771839",
    "end": "774800"
  },
  {
    "text": "that like which function is allocating",
    "start": "774800",
    "end": "777839"
  },
  {
    "text": "uh",
    "start": "777839",
    "end": "779040"
  },
  {
    "text": "more bytes or whatnot but all in all",
    "start": "779040",
    "end": "781920"
  },
  {
    "text": "this single profile doesn't give a lot",
    "start": "781920",
    "end": "784800"
  },
  {
    "text": "of information to us what",
    "start": "784800",
    "end": "787120"
  },
  {
    "text": "we can do is we can actually compare the",
    "start": "787120",
    "end": "789920"
  },
  {
    "text": "profiles so let's pick",
    "start": "789920",
    "end": "792480"
  },
  {
    "text": "a profile from an hour ago and more",
    "start": "792480",
    "end": "795360"
  },
  {
    "text": "recent one",
    "start": "795360",
    "end": "796560"
  },
  {
    "text": "and now we can actually compare these",
    "start": "796560",
    "end": "799279"
  },
  {
    "text": "profiles this is getting a diff of those",
    "start": "799279",
    "end": "801519"
  },
  {
    "text": "profiles and it's showing like uh how",
    "start": "801519",
    "end": "804240"
  },
  {
    "text": "much batch we are allocating in which",
    "start": "804240",
    "end": "806720"
  },
  {
    "text": "function and the it's all color coded",
    "start": "806720",
    "end": "809600"
  },
  {
    "text": "and the more red indicates it's more",
    "start": "809600",
    "end": "812240"
  },
  {
    "text": "bites actually the arcade",
    "start": "812240",
    "end": "815120"
  },
  {
    "text": "one thing we can also see",
    "start": "815120",
    "end": "817040"
  },
  {
    "text": "check out is the cpu samples from the",
    "start": "817040",
    "end": "821519"
  },
  {
    "text": "agent itself",
    "start": "821519",
    "end": "823040"
  },
  {
    "text": "as you can see the agent is scraping the",
    "start": "823040",
    "end": "825680"
  },
  {
    "text": "c groups that's running on my local",
    "start": "825680",
    "end": "827440"
  },
  {
    "text": "machine",
    "start": "827440",
    "end": "828399"
  },
  {
    "text": "and from that we can actually pick one",
    "start": "828399",
    "end": "831199"
  },
  {
    "text": "of them let's say",
    "start": "831199",
    "end": "832880"
  },
  {
    "text": "parker agent service",
    "start": "832880",
    "end": "834560"
  },
  {
    "text": "and we can see that the profiles that",
    "start": "834560",
    "end": "836880"
  },
  {
    "text": "we've",
    "start": "836880",
    "end": "838000"
  },
  {
    "text": "scraped from this agent",
    "start": "838000",
    "end": "840399"
  },
  {
    "text": "parker agent and we can actually merge",
    "start": "840399",
    "end": "842800"
  },
  {
    "text": "and see what's going on over an hour",
    "start": "842800",
    "end": "845839"
  },
  {
    "text": "and as you can see this is the actual",
    "start": "845839",
    "end": "848639"
  },
  {
    "text": "time spent over this past hour",
    "start": "848639",
    "end": "851839"
  },
  {
    "text": "by the park agent itself",
    "start": "851839",
    "end": "854720"
  },
  {
    "text": "okay that was a fantastic demo so let's",
    "start": "854720",
    "end": "856880"
  },
  {
    "text": "talk about the storage and what uh",
    "start": "856880",
    "end": "858639"
  },
  {
    "text": "really uh",
    "start": "858639",
    "end": "860240"
  },
  {
    "text": "makes parka parker and why we didn't",
    "start": "860240",
    "end": "862639"
  },
  {
    "text": "continue with controv as a project right",
    "start": "862639",
    "end": "865360"
  },
  {
    "start": "865000",
    "end": "865000"
  },
  {
    "text": "um so previously controv itself just got",
    "start": "865360",
    "end": "868399"
  },
  {
    "text": "the profiles and took the profiles as",
    "start": "868399",
    "end": "870560"
  },
  {
    "text": "they came in individually gzipped and",
    "start": "870560",
    "end": "873360"
  },
  {
    "text": "stored them in a slightly modified",
    "start": "873360",
    "end": "875920"
  },
  {
    "text": "prometheus time series database where we",
    "start": "875920",
    "end": "878000"
  },
  {
    "text": "could store uh bite slices and not float",
    "start": "878000",
    "end": "881519"
  },
  {
    "text": "64 anymore and that was fine to get like",
    "start": "881519",
    "end": "884160"
  },
  {
    "text": "a proof of concept out of the door um",
    "start": "884160",
    "end": "886560"
  },
  {
    "text": "but the compression was great so during",
    "start": "886560",
    "end": "889360"
  },
  {
    "start": "889000",
    "end": "889000"
  },
  {
    "text": "a talk uh at prom con earlier this year",
    "start": "889360",
    "end": "892560"
  },
  {
    "text": "i explained how we improved the",
    "start": "892560",
    "end": "894560"
  },
  {
    "text": "compression by basically storing the",
    "start": "894560",
    "end": "897600"
  },
  {
    "text": "uncompressed uh",
    "start": "897600",
    "end": "899519"
  },
  {
    "text": "profiles and then um",
    "start": "899519",
    "end": "902000"
  },
  {
    "text": "in groups compressing them together",
    "start": "902000",
    "end": "904160"
  },
  {
    "text": "which got us between like 20 and 50",
    "start": "904160",
    "end": "906800"
  },
  {
    "text": "percent of improvements but it wasn't",
    "start": "906800",
    "end": "909519"
  },
  {
    "text": "that much and it was only like this",
    "start": "909519",
    "end": "911839"
  },
  {
    "text": "usage to begin with and we wanted to",
    "start": "911839",
    "end": "914079"
  },
  {
    "text": "improve on",
    "start": "914079",
    "end": "915600"
  },
  {
    "text": "computation and throughput and",
    "start": "915600",
    "end": "917360"
  },
  {
    "text": "everything so we needed something better",
    "start": "917360",
    "end": "919519"
  },
  {
    "text": "still and",
    "start": "919519",
    "end": "921120"
  },
  {
    "text": "that's why we created parker's tcb and",
    "start": "921120",
    "end": "924079"
  },
  {
    "text": "that is written from scratch",
    "start": "924079",
    "end": "926560"
  },
  {
    "start": "926000",
    "end": "926000"
  },
  {
    "text": "so it is still inspired by prometheus um",
    "start": "926560",
    "end": "930079"
  },
  {
    "text": "as again the same",
    "start": "930079",
    "end": "932320"
  },
  {
    "text": "that was true for the service discovery",
    "start": "932320",
    "end": "934399"
  },
  {
    "text": "and the scraper is true for the storage",
    "start": "934399",
    "end": "936880"
  },
  {
    "text": "and",
    "start": "936880",
    "end": "937759"
  },
  {
    "text": "it uses a separate meta metadata to",
    "start": "937759",
    "end": "941440"
  },
  {
    "text": "store things it handles stack traces in",
    "start": "941440",
    "end": "943759"
  },
  {
    "text": "the storage",
    "start": "943759",
    "end": "944959"
  },
  {
    "text": "as a first class citizen and has",
    "start": "944959",
    "end": "946720"
  },
  {
    "text": "different chunk encodings for specific",
    "start": "946720",
    "end": "949040"
  },
  {
    "text": "various data",
    "start": "949040",
    "end": "951279"
  },
  {
    "text": "and to kind of like walk you through the",
    "start": "951279",
    "end": "953360"
  },
  {
    "text": "entire architecture we're going to look",
    "start": "953360",
    "end": "955199"
  },
  {
    "text": "at this step by step but first of all",
    "start": "955199",
    "end": "957680"
  },
  {
    "text": "what happens when a write request comes",
    "start": "957680",
    "end": "959600"
  },
  {
    "text": "in and that is what kamal is going to",
    "start": "959600",
    "end": "961680"
  },
  {
    "text": "talk you through",
    "start": "961680",
    "end": "964240"
  },
  {
    "text": "yes",
    "start": "964560",
    "end": "965360"
  },
  {
    "text": "so",
    "start": "965360",
    "end": "966480"
  },
  {
    "text": "right now parker can discover profiles",
    "start": "966480",
    "end": "968959"
  },
  {
    "text": "either by like scraping or it can",
    "start": "968959",
    "end": "971440"
  },
  {
    "text": "receive a write request from an agent",
    "start": "971440",
    "end": "973839"
  },
  {
    "text": "and it can just like ingest that data",
    "start": "973839",
    "end": "976959"
  },
  {
    "text": "so let's see how uh like how a life",
    "start": "976959",
    "end": "980639"
  },
  {
    "text": "cycle of the right request looks like",
    "start": "980639",
    "end": "982720"
  },
  {
    "text": "right the rights request is represented",
    "start": "982720",
    "end": "985839"
  },
  {
    "text": "as protobuf as you seen in the screen",
    "start": "985839",
    "end": "988639"
  },
  {
    "text": "and we have the role profile that",
    "start": "988639",
    "end": "990480"
  },
  {
    "text": "generated by pprov",
    "start": "990480",
    "end": "992480"
  },
  {
    "text": "and",
    "start": "992480",
    "end": "993360"
  },
  {
    "text": "we attach the",
    "start": "993360",
    "end": "995120"
  },
  {
    "text": "metadata metadata label set from the",
    "start": "995120",
    "end": "998480"
  },
  {
    "text": "service discovery we have already built",
    "start": "998480",
    "end": "1000399"
  },
  {
    "text": "in",
    "start": "1000399",
    "end": "1001199"
  },
  {
    "text": "parker itself",
    "start": "1001199",
    "end": "1004000"
  },
  {
    "text": "from that we get the row profile and we",
    "start": "1004000",
    "end": "1007680"
  },
  {
    "text": "just like using p proof itself parse and",
    "start": "1007680",
    "end": "1010880"
  },
  {
    "text": "validate that data",
    "start": "1010880",
    "end": "1013839"
  },
  {
    "text": "from that data we start building a",
    "start": "1013839",
    "end": "1016480"
  },
  {
    "text": "memory representation of that in parker",
    "start": "1016480",
    "end": "1018959"
  },
  {
    "text": "itself",
    "start": "1018959",
    "end": "1020480"
  },
  {
    "text": "so the profiles track or profiling the",
    "start": "1020480",
    "end": "1023519"
  },
  {
    "text": "memory looks like this",
    "start": "1023519",
    "end": "1025678"
  },
  {
    "text": "the in this format the samples mapping",
    "start": "1025679",
    "end": "1028319"
  },
  {
    "text": "and location and functions are the",
    "start": "1028319",
    "end": "1030079"
  },
  {
    "text": "relevant things that we are actually",
    "start": "1030079",
    "end": "1032240"
  },
  {
    "text": "looking for",
    "start": "1032240",
    "end": "1033760"
  },
  {
    "text": "so",
    "start": "1033760",
    "end": "1034880"
  },
  {
    "text": "using that data schema then we got an",
    "start": "1034880",
    "end": "1037438"
  },
  {
    "text": "actual data in it it looks like this we",
    "start": "1037439",
    "end": "1040079"
  },
  {
    "text": "have a sample value and attached",
    "start": "1040079",
    "end": "1042240"
  },
  {
    "text": "metadata information in it",
    "start": "1042240",
    "end": "1044480"
  },
  {
    "text": "from that data we built a",
    "start": "1044480",
    "end": "1048319"
  },
  {
    "start": "1046000",
    "end": "1046000"
  },
  {
    "text": "model in the memory",
    "start": "1048319",
    "end": "1050559"
  },
  {
    "text": "and we ingest the metadata in our",
    "start": "1050559",
    "end": "1053440"
  },
  {
    "text": "freshly built metastore",
    "start": "1053440",
    "end": "1055360"
  },
  {
    "text": "and by doing so we",
    "start": "1055360",
    "end": "1057840"
  },
  {
    "text": "eliminate the redundant information",
    "start": "1057840",
    "end": "1059919"
  },
  {
    "text": "redundant meta information that we have",
    "start": "1059919",
    "end": "1061840"
  },
  {
    "text": "in the profiles",
    "start": "1061840",
    "end": "1063200"
  },
  {
    "text": "right now",
    "start": "1063200",
    "end": "1064240"
  },
  {
    "text": "this metadata store is implemented uh in",
    "start": "1064240",
    "end": "1067520"
  },
  {
    "text": "sqlite and in memory sqlite that then is",
    "start": "1067520",
    "end": "1070799"
  },
  {
    "text": "used in the static binary but it's",
    "start": "1070799",
    "end": "1072960"
  },
  {
    "text": "compatible to be",
    "start": "1072960",
    "end": "1074559"
  },
  {
    "text": "work with any sql databases",
    "start": "1074559",
    "end": "1077520"
  },
  {
    "start": "1077000",
    "end": "1077000"
  },
  {
    "text": "so after we script that metadata",
    "start": "1077520",
    "end": "1080559"
  },
  {
    "text": "from this uh people of profile we ended",
    "start": "1080559",
    "end": "1083440"
  },
  {
    "text": "up with a bunch of location ids and",
    "start": "1083440",
    "end": "1087280"
  },
  {
    "text": "corresponding sample values to that",
    "start": "1087280",
    "end": "1089520"
  },
  {
    "text": "location ids but as you can see those",
    "start": "1089520",
    "end": "1092559"
  },
  {
    "text": "location ids actually",
    "start": "1092559",
    "end": "1095120"
  },
  {
    "text": "builds a tree that's actually what we do",
    "start": "1095120",
    "end": "1098080"
  },
  {
    "text": "and we build a tree out of those",
    "start": "1098080",
    "end": "1100160"
  },
  {
    "text": "location ids and we",
    "start": "1100160",
    "end": "1102400"
  },
  {
    "text": "store",
    "start": "1102400",
    "end": "1103360"
  },
  {
    "text": "those sampled values as nodes in the",
    "start": "1103360",
    "end": "1106080"
  },
  {
    "text": "tree and this is how we actually store",
    "start": "1106080",
    "end": "1108799"
  },
  {
    "text": "the data in this",
    "start": "1108799",
    "end": "1110320"
  },
  {
    "text": "in the packet storage",
    "start": "1110320",
    "end": "1113840"
  },
  {
    "text": "exactly okay so how do we actually",
    "start": "1114720",
    "end": "1117200"
  },
  {
    "text": "append those profile trees um into into",
    "start": "1117200",
    "end": "1121120"
  },
  {
    "text": "the parka tsdb and first of all we do",
    "start": "1121120",
    "end": "1124720"
  },
  {
    "text": "that by creating an appender based on",
    "start": "1124720",
    "end": "1126880"
  },
  {
    "text": "the label set and that labor set gives",
    "start": "1126880",
    "end": "1129520"
  },
  {
    "text": "us a specific series um or creates it if",
    "start": "1129520",
    "end": "1132960"
  },
  {
    "text": "it didn't exist yet and once we got that",
    "start": "1132960",
    "end": "1135919"
  },
  {
    "text": "appender we can then uh give",
    "start": "1135919",
    "end": "1138960"
  },
  {
    "text": "that appender the profile um to to do",
    "start": "1138960",
    "end": "1142000"
  },
  {
    "text": "its magic",
    "start": "1142000",
    "end": "1143440"
  },
  {
    "start": "1143000",
    "end": "1143000"
  },
  {
    "text": "um",
    "start": "1143440",
    "end": "1144400"
  },
  {
    "text": "before we actually append any of the",
    "start": "1144400",
    "end": "1146400"
  },
  {
    "text": "tree and any of the values themselves",
    "start": "1146400",
    "end": "1149120"
  },
  {
    "text": "every profile comes with the timestamp",
    "start": "1149120",
    "end": "1151440"
  },
  {
    "text": "and duration and period so some metadata",
    "start": "1151440",
    "end": "1154160"
  },
  {
    "text": "and we also want to store that",
    "start": "1154160",
    "end": "1156480"
  },
  {
    "text": "the timestamp is",
    "start": "1156480",
    "end": "1159039"
  },
  {
    "text": "really",
    "start": "1159039",
    "end": "1160559"
  },
  {
    "text": "what we store once and then everything",
    "start": "1160559",
    "end": "1162880"
  },
  {
    "text": "else kind of works off of the index of",
    "start": "1162880",
    "end": "1165440"
  },
  {
    "text": "that specific timestamp um",
    "start": "1165440",
    "end": "1168480"
  },
  {
    "text": "and that is true for the values as well",
    "start": "1168480",
    "end": "1170880"
  },
  {
    "text": "later on",
    "start": "1170880",
    "end": "1172160"
  },
  {
    "text": "um because timestamps are pretty pretty",
    "start": "1172160",
    "end": "1175360"
  },
  {
    "text": "well",
    "start": "1175360",
    "end": "1176240"
  },
  {
    "text": "monitored",
    "start": "1176240",
    "end": "1177840"
  },
  {
    "text": "increasing we can",
    "start": "1177840",
    "end": "1179360"
  },
  {
    "text": "use a double delta encoded chunk to",
    "start": "1179360",
    "end": "1181760"
  },
  {
    "text": "store them efficiently and the duration",
    "start": "1181760",
    "end": "1184080"
  },
  {
    "text": "and periods are often pretty repetitive",
    "start": "1184080",
    "end": "1186720"
  },
  {
    "text": "so we can use run length encoding for",
    "start": "1186720",
    "end": "1189600"
  },
  {
    "text": "those to to really uh store as",
    "start": "1189600",
    "end": "1192799"
  },
  {
    "text": "little data as we have to",
    "start": "1192799",
    "end": "1195440"
  },
  {
    "text": "okay cool now that we've taken care of",
    "start": "1195440",
    "end": "1198000"
  },
  {
    "text": "storing uh or creating and getting the",
    "start": "1198000",
    "end": "1200480"
  },
  {
    "text": "series and then storing the timestamp",
    "start": "1200480",
    "end": "1202640"
  },
  {
    "text": "duration and periods what are we",
    "start": "1202640",
    "end": "1204720"
  },
  {
    "text": "actually doing with the profile tree",
    "start": "1204720",
    "end": "1206880"
  },
  {
    "text": "with the individual stack tracers and",
    "start": "1206880",
    "end": "1208640"
  },
  {
    "text": "how do we store them over time right so",
    "start": "1208640",
    "end": "1211679"
  },
  {
    "text": "as kamai said earlier we do get this",
    "start": "1211679",
    "end": "1213840"
  },
  {
    "text": "profile tree with the stack trace and",
    "start": "1213840",
    "end": "1216320"
  },
  {
    "text": "and the corresponding values and we take",
    "start": "1216320",
    "end": "1218640"
  },
  {
    "text": "those um as a struct and those",
    "start": "1218640",
    "end": "1222720"
  },
  {
    "text": "those profile trees have a root and the",
    "start": "1222720",
    "end": "1225919"
  },
  {
    "text": "root itself has a location id flat",
    "start": "1225919",
    "end": "1228320"
  },
  {
    "text": "values and cumulative values and then",
    "start": "1228320",
    "end": "1231840"
  },
  {
    "text": "those flat values and cumulative values",
    "start": "1231840",
    "end": "1234640"
  },
  {
    "text": "are three value nodes",
    "start": "1234640",
    "end": "1236559"
  },
  {
    "text": "with a specific value and the key which",
    "start": "1236559",
    "end": "1240320"
  },
  {
    "text": "uniquely identifies",
    "start": "1240320",
    "end": "1242559"
  },
  {
    "text": "again with the location id but also the",
    "start": "1242559",
    "end": "1245919"
  },
  {
    "text": "labels which can differ um",
    "start": "1245919",
    "end": "1248400"
  },
  {
    "text": "what this value belongs to really",
    "start": "1248400",
    "end": "1252240"
  },
  {
    "text": "and we can use those um to then um walk",
    "start": "1252240",
    "end": "1255679"
  },
  {
    "text": "walk the tree and",
    "start": "1255679",
    "end": "1257520"
  },
  {
    "text": "ingest the values um",
    "start": "1257520",
    "end": "1260880"
  },
  {
    "text": "like so um we basically walk the tree",
    "start": "1260880",
    "end": "1263840"
  },
  {
    "text": "and then we see for every location key",
    "start": "1263840",
    "end": "1266799"
  },
  {
    "text": "that we see we store for example for the",
    "start": "1266799",
    "end": "1269600"
  },
  {
    "text": "zeroth key which is always the root we",
    "start": "1269600",
    "end": "1272080"
  },
  {
    "text": "start on the cumulative value for g6 and",
    "start": "1272080",
    "end": "1274720"
  },
  {
    "text": "then we walk the tree with the stack and",
    "start": "1274720",
    "end": "1276880"
  },
  {
    "text": "install the other values i'm only",
    "start": "1276880",
    "end": "1279360"
  },
  {
    "text": "looking at the cumulative values the",
    "start": "1279360",
    "end": "1280960"
  },
  {
    "text": "flat values are kind of ignored but it's",
    "start": "1280960",
    "end": "1283280"
  },
  {
    "text": "the same for them as well",
    "start": "1283280",
    "end": "1285600"
  },
  {
    "text": "next script another profile tree gets",
    "start": "1285600",
    "end": "1288320"
  },
  {
    "text": "created and we want to append that so",
    "start": "1288320",
    "end": "1290720"
  },
  {
    "text": "again",
    "start": "1290720",
    "end": "1291600"
  },
  {
    "text": "we get the same in this case the same",
    "start": "1291600",
    "end": "1293520"
  },
  {
    "text": "profile tree and we just",
    "start": "1293520",
    "end": "1296320"
  },
  {
    "text": "take a look at the individual keys and",
    "start": "1296320",
    "end": "1298720"
  },
  {
    "text": "append to those chunks",
    "start": "1298720",
    "end": "1301039"
  },
  {
    "text": "the values",
    "start": "1301039",
    "end": "1303520"
  },
  {
    "text": "now gets a bit",
    "start": "1303520",
    "end": "1304880"
  },
  {
    "text": "more interesting we actually get a",
    "start": "1304880",
    "end": "1306799"
  },
  {
    "text": "profile tree where one node is missing",
    "start": "1306799",
    "end": "1309200"
  },
  {
    "text": "so we append all the the values um to",
    "start": "1309200",
    "end": "1311840"
  },
  {
    "text": "the keys that we've seen and we",
    "start": "1311840",
    "end": "1314400"
  },
  {
    "text": "really just ignore appending",
    "start": "1314400",
    "end": "1317440"
  },
  {
    "text": "the the",
    "start": "1317440",
    "end": "1319280"
  },
  {
    "text": "anything to to the key that didn't exist",
    "start": "1319280",
    "end": "1323760"
  },
  {
    "text": "and again another edge case or another",
    "start": "1323760",
    "end": "1326640"
  },
  {
    "text": "use case is we see another stack trace",
    "start": "1326640",
    "end": "1329600"
  },
  {
    "text": "that didn't show up earlier",
    "start": "1329600",
    "end": "1331679"
  },
  {
    "text": "and because remember we only start the",
    "start": "1331679",
    "end": "1333840"
  },
  {
    "text": "timestamps once we need to work off of",
    "start": "1333840",
    "end": "1336240"
  },
  {
    "text": "the index for",
    "start": "1336240",
    "end": "1337760"
  },
  {
    "text": "duration periods but also all these",
    "start": "1337760",
    "end": "1339600"
  },
  {
    "text": "values we can't just like store",
    "start": "1339600",
    "end": "1342960"
  },
  {
    "text": "them",
    "start": "1342960",
    "end": "1343919"
  },
  {
    "text": "the timestamps and the values together",
    "start": "1343919",
    "end": "1345520"
  },
  {
    "text": "but we need to work off the index so we",
    "start": "1345520",
    "end": "1348000"
  },
  {
    "text": "need to ingest the 11 here for the third",
    "start": "1348000",
    "end": "1351200"
  },
  {
    "text": "index",
    "start": "1351200",
    "end": "1352559"
  },
  {
    "text": "um and we do that by just appending",
    "start": "1352559",
    "end": "1354880"
  },
  {
    "text": "three zeros and then appending it",
    "start": "1354880",
    "end": "1358000"
  },
  {
    "text": "right there",
    "start": "1358000",
    "end": "1359120"
  },
  {
    "text": "the index three",
    "start": "1359120",
    "end": "1361600"
  },
  {
    "start": "1361000",
    "end": "1361000"
  },
  {
    "text": "now you might think might be thinking",
    "start": "1361600",
    "end": "1363679"
  },
  {
    "text": "well if we're going to read back this um",
    "start": "1363679",
    "end": "1366480"
  },
  {
    "text": "what about the um",
    "start": "1366480",
    "end": "1368240"
  },
  {
    "text": "the missing values right there and that",
    "start": "1368240",
    "end": "1370240"
  },
  {
    "text": "is called sparseness we actually don't",
    "start": "1370240",
    "end": "1372480"
  },
  {
    "text": "store anything for those notes",
    "start": "1372480",
    "end": "1375200"
  },
  {
    "text": "um",
    "start": "1375200",
    "end": "1376080"
  },
  {
    "text": "but when reading back we pretend that",
    "start": "1376080",
    "end": "1378480"
  },
  {
    "text": "they were zero and these zeros are",
    "start": "1378480",
    "end": "1380480"
  },
  {
    "text": "basically ignored by by p prof they're",
    "start": "1380480",
    "end": "1384320"
  },
  {
    "text": "not doing anything so we we pretend that",
    "start": "1384320",
    "end": "1386960"
  },
  {
    "text": "they were zero and then people have",
    "start": "1386960",
    "end": "1388480"
  },
  {
    "text": "ignored them so that is how we can even",
    "start": "1388480",
    "end": "1391840"
  },
  {
    "text": "just by seeing stack traces every now",
    "start": "1391840",
    "end": "1393760"
  },
  {
    "text": "and then we can still be smart about",
    "start": "1393760",
    "end": "1395919"
  },
  {
    "text": "storing them",
    "start": "1395919",
    "end": "1398640"
  },
  {
    "text": "so to recap um",
    "start": "1398640",
    "end": "1400960"
  },
  {
    "text": "the profile store itself works on top of",
    "start": "1400960",
    "end": "1403039"
  },
  {
    "text": "the standard pprof and it creates like",
    "start": "1403039",
    "end": "1405520"
  },
  {
    "text": "this more um",
    "start": "1405520",
    "end": "1407520"
  },
  {
    "text": "efficient representation it stores all",
    "start": "1407520",
    "end": "1410159"
  },
  {
    "text": "the metadata uniquely in the sqlite",
    "start": "1410159",
    "end": "1412320"
  },
  {
    "text": "database right now and then we append",
    "start": "1412320",
    "end": "1414559"
  },
  {
    "text": "this to a tsdb",
    "start": "1414559",
    "end": "1416799"
  },
  {
    "text": "which is still a lot like prometheus but",
    "start": "1416799",
    "end": "1419280"
  },
  {
    "text": "it works on top of the profile tree and",
    "start": "1419280",
    "end": "1421360"
  },
  {
    "text": "then every chunk for the different types",
    "start": "1421360",
    "end": "1424400"
  },
  {
    "text": "of values",
    "start": "1424400",
    "end": "1426159"
  },
  {
    "text": "also works just like prometheus",
    "start": "1426159",
    "end": "1429120"
  },
  {
    "text": "okay cool now that we've seen how to",
    "start": "1429120",
    "end": "1430880"
  },
  {
    "text": "store profiles in parker's tsdb how do",
    "start": "1430880",
    "end": "1433760"
  },
  {
    "text": "we actually query things",
    "start": "1433760",
    "end": "1435600"
  },
  {
    "text": "uh again we do use grpc and we can send",
    "start": "1435600",
    "end": "1438799"
  },
  {
    "text": "a query request next to the mode which",
    "start": "1438799",
    "end": "1441440"
  },
  {
    "text": "specifies if we want a single",
    "start": "1441440",
    "end": "1443760"
  },
  {
    "text": "profile or a diff or a merge type um we",
    "start": "1443760",
    "end": "1446960"
  },
  {
    "text": "do need to give it a single profile in",
    "start": "1446960",
    "end": "1449360"
  },
  {
    "text": "our case which we are interested in and",
    "start": "1449360",
    "end": "1451600"
  },
  {
    "text": "the single profile",
    "start": "1451600",
    "end": "1453360"
  },
  {
    "text": "which you can see at the very bottom",
    "start": "1453360",
    "end": "1455600"
  },
  {
    "text": "takes a time",
    "start": "1455600",
    "end": "1457760"
  },
  {
    "text": "as a timestamp and a query so what does",
    "start": "1457760",
    "end": "1460240"
  },
  {
    "text": "it look like",
    "start": "1460240",
    "end": "1461679"
  },
  {
    "text": "the time is actually just a unix",
    "start": "1461679",
    "end": "1463360"
  },
  {
    "text": "timestamp and the query is just like you",
    "start": "1463360",
    "end": "1465840"
  },
  {
    "text": "know from prometheus almost like a",
    "start": "1465840",
    "end": "1467440"
  },
  {
    "text": "prompt ui query where you give some",
    "start": "1467440",
    "end": "1469360"
  },
  {
    "text": "label matches and that will match all",
    "start": "1469360",
    "end": "1471039"
  },
  {
    "text": "the series that that you're looking for",
    "start": "1471039",
    "end": "1475840"
  },
  {
    "text": "and then in memory the tsdb",
    "start": "1475840",
    "end": "1478400"
  },
  {
    "text": "um is",
    "start": "1478400",
    "end": "1480080"
  },
  {
    "text": "creating a wrapper the query that",
    "start": "1480080",
    "end": "1483600"
  },
  {
    "text": "will",
    "start": "1483600",
    "end": "1484880"
  },
  {
    "text": "look",
    "start": "1484880",
    "end": "1486400"
  },
  {
    "text": "five minutes earlier from the timestamp",
    "start": "1486400",
    "end": "1488240"
  },
  {
    "text": "you want five minutes later and then",
    "start": "1488240",
    "end": "1490480"
  },
  {
    "text": "we'll select all the series based on the",
    "start": "1490480",
    "end": "1492880"
  },
  {
    "text": "selector um that that you've given",
    "start": "1492880",
    "end": "1496320"
  },
  {
    "text": "and then we're in the first for loop it",
    "start": "1496320",
    "end": "1498720"
  },
  {
    "text": "will iterate over all the series that",
    "start": "1498720",
    "end": "1500880"
  },
  {
    "text": "were matched and then in the second for",
    "start": "1500880",
    "end": "1503440"
  },
  {
    "text": "loop we will iterate over every series",
    "start": "1503440",
    "end": "1506240"
  },
  {
    "text": "this time stamp until we find a time",
    "start": "1506240",
    "end": "1508799"
  },
  {
    "text": "stem that is equal or higher than the",
    "start": "1508799",
    "end": "1511520"
  },
  {
    "text": "requested timestamp and once we hit that",
    "start": "1511520",
    "end": "1514480"
  },
  {
    "text": "condition we can immediately return",
    "start": "1514480",
    "end": "1517360"
  },
  {
    "text": "the profile",
    "start": "1517360",
    "end": "1519600"
  },
  {
    "text": "now the parka tsdb",
    "start": "1519600",
    "end": "1522960"
  },
  {
    "text": "has been",
    "start": "1522960",
    "end": "1524240"
  },
  {
    "text": "so much more efficient because we don't",
    "start": "1524240",
    "end": "1526159"
  },
  {
    "text": "store the metadata anymore",
    "start": "1526159",
    "end": "1529039"
  },
  {
    "text": "next to all the the actual values and",
    "start": "1529039",
    "end": "1532400"
  },
  {
    "text": "because of that differing so that is",
    "start": "1532400",
    "end": "1534400"
  },
  {
    "text": "like taking two profiles and um",
    "start": "1534400",
    "end": "1536960"
  },
  {
    "text": "subtracting the values",
    "start": "1536960",
    "end": "1539520"
  },
  {
    "text": "has become basically just math and then",
    "start": "1539520",
    "end": "1542159"
  },
  {
    "text": "once we get the results of that",
    "start": "1542159",
    "end": "1545679"
  },
  {
    "text": "with the location ids we can symbolize",
    "start": "1545919",
    "end": "1548159"
  },
  {
    "text": "them and then build what you see in",
    "start": "1548159",
    "end": "1550480"
  },
  {
    "text": "parker",
    "start": "1550480",
    "end": "1551679"
  },
  {
    "text": "and the same is true for emerging which",
    "start": "1551679",
    "end": "1554000"
  },
  {
    "start": "1552000",
    "end": "1552000"
  },
  {
    "text": "is basically taking two or multiple",
    "start": "1554000",
    "end": "1556320"
  },
  {
    "text": "profiles and then",
    "start": "1556320",
    "end": "1558000"
  },
  {
    "text": "adding every uh adding all the values",
    "start": "1558000",
    "end": "1560960"
  },
  {
    "text": "and that has become also just take all",
    "start": "1560960",
    "end": "1563919"
  },
  {
    "text": "the chunks that are falling into that",
    "start": "1563919",
    "end": "1565919"
  },
  {
    "text": "time frame and then summing up",
    "start": "1565919",
    "end": "1567840"
  },
  {
    "text": "everything returning that symbolizing it",
    "start": "1567840",
    "end": "1570960"
  },
  {
    "text": "and there you have your profile and that",
    "start": "1570960",
    "end": "1572880"
  },
  {
    "text": "has really sped up everything um and",
    "start": "1572880",
    "end": "1576960"
  },
  {
    "text": "the entire reason why we built a packer",
    "start": "1576960",
    "end": "1579440"
  },
  {
    "text": "tsdb has proven to be exactly",
    "start": "1579440",
    "end": "1583360"
  },
  {
    "text": "valuable for that reason okay now that",
    "start": "1583360",
    "end": "1586080"
  },
  {
    "start": "1585000",
    "end": "1585000"
  },
  {
    "text": "we've talked all about the parka tsdb",
    "start": "1586080",
    "end": "1588799"
  },
  {
    "text": "what's on the roadmap for parker",
    "start": "1588799",
    "end": "1590960"
  },
  {
    "text": "we want to have persistence on disk we",
    "start": "1590960",
    "end": "1593200"
  },
  {
    "text": "want to be able to persist the data that",
    "start": "1593200",
    "end": "1595360"
  },
  {
    "text": "we have",
    "start": "1595360",
    "end": "1596720"
  },
  {
    "text": "we want to improve querying we want to",
    "start": "1596720",
    "end": "1598880"
  },
  {
    "text": "be able to for example only query sub",
    "start": "1598880",
    "end": "1601919"
  },
  {
    "text": "stack traces",
    "start": "1601919",
    "end": "1603600"
  },
  {
    "text": "where we ignore everything else",
    "start": "1603600",
    "end": "1605919"
  },
  {
    "text": "in the tree and then once we've done all",
    "start": "1605919",
    "end": "1608080"
  },
  {
    "text": "the math we can return that symbolize it",
    "start": "1608080",
    "end": "1611039"
  },
  {
    "text": "and show it that would be fantastic",
    "start": "1611039",
    "end": "1613279"
  },
  {
    "text": "additionally we can still improve the",
    "start": "1613279",
    "end": "1614960"
  },
  {
    "text": "symbolization there's lots of work to be",
    "start": "1614960",
    "end": "1616880"
  },
  {
    "text": "done in the meta store the sql um parts",
    "start": "1616880",
    "end": "1620320"
  },
  {
    "text": "are are also still",
    "start": "1620320",
    "end": "1622320"
  },
  {
    "text": "ready for improvements um but most",
    "start": "1622320",
    "end": "1624559"
  },
  {
    "text": "importantly we want really you to get",
    "start": "1624559",
    "end": "1626559"
  },
  {
    "text": "involved with uh parker and the",
    "start": "1626559",
    "end": "1629200"
  },
  {
    "text": "community",
    "start": "1629200",
    "end": "1630400"
  },
  {
    "text": "um for you to try um parker open issues",
    "start": "1630400",
    "end": "1634400"
  },
  {
    "text": "open for requests just contribute and we",
    "start": "1634400",
    "end": "1637360"
  },
  {
    "text": "would really love to create a community",
    "start": "1637360",
    "end": "1640000"
  },
  {
    "text": "about foreign performance like-minded",
    "start": "1640000",
    "end": "1642399"
  },
  {
    "text": "people",
    "start": "1642399",
    "end": "1643520"
  },
  {
    "text": "based on parka that would be fantastic",
    "start": "1643520",
    "end": "1646159"
  },
  {
    "text": "so thank you and if you have questions",
    "start": "1646159",
    "end": "1648080"
  },
  {
    "text": "feel free to ask them",
    "start": "1648080",
    "end": "1649760"
  },
  {
    "text": "and we are also hiring",
    "start": "1649760",
    "end": "1652080"
  },
  {
    "text": "thanks and take care",
    "start": "1652080",
    "end": "1655679"
  }
]