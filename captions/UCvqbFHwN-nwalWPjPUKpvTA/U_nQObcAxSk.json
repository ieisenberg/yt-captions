[
  {
    "start": "0",
    "end": "75000"
  },
  {
    "text": "hello everyone welcome to the basement I hope you manage to get all the way down here without too much inconvenience this",
    "start": "30",
    "end": "7529"
  },
  {
    "text": "talk today is called Monica my socks and it's a bit of a play on words hopefully",
    "start": "7529",
    "end": "13049"
  },
  {
    "text": "what I'm going to talk about is a lot of Prometheus talks talk about like a specific implementing from youth uses",
    "start": "13049",
    "end": "20279"
  },
  {
    "text": "specific way like a specific language or a specific tool or something like that I'm trying to order the scope a little",
    "start": "20279",
    "end": "25619"
  },
  {
    "text": "bit and I'm not just about like this I'm also going to talk about how you actually deploy it as well but the slot",
    "start": "25619",
    "end": "32279"
  },
  {
    "text": "is only 30 minutes so I'm going to race through it a patient of not my name is",
    "start": "32279",
    "end": "38070"
  },
  {
    "text": "going down a freelance engineer my company's called window research but I've been mainly working with content",
    "start": "38070",
    "end": "43710"
  },
  {
    "text": "solution and we works so how do how do",
    "start": "43710",
    "end": "49230"
  },
  {
    "text": "we start well container solutions was asked to help out we work to develop one",
    "start": "49230",
    "end": "54780"
  },
  {
    "text": "of their new products or a few of their new products and this product is called",
    "start": "54780",
    "end": "59910"
  },
  {
    "text": "weave cloud and it's a hosted service to help visualize and monitor and integrate",
    "start": "59910",
    "end": "70170"
  },
  {
    "text": "with your CI pipeline so we were asked to help out with this and specifically",
    "start": "70170",
    "end": "75330"
  },
  {
    "start": "75000",
    "end": "75000"
  },
  {
    "text": "for for this conference part of that service is a service called cortex and",
    "start": "75330",
    "end": "81470"
  },
  {
    "text": "effectively it's a a hosted managed multi-tenant version of Promethea and",
    "start": "81470",
    "end": "87110"
  },
  {
    "text": "it's really cool because well one of the biggest features is that is backed by comes an s3 so you could you've pretty",
    "start": "87110",
    "end": "93119"
  },
  {
    "text": "much got unlimited data retention speed out the drop dates or any time that's one of the big feature set but we're",
    "start": "93119",
    "end": "98610"
  },
  {
    "text": "also adding lots of added extras that hope to improve the user experience as",
    "start": "98610",
    "end": "103619"
  },
  {
    "text": "well well whilst we were doing all of these projects we we started to realize that we a needed something to test as",
    "start": "103619",
    "end": "111840"
  },
  {
    "start": "105000",
    "end": "105000"
  },
  {
    "text": "part of our development lifecycle and B we need something we can demo and so we",
    "start": "111840",
    "end": "117240"
  },
  {
    "text": "started asking around you know will of what can a demo what can I show and you know we started asking even more basic",
    "start": "117240",
    "end": "122670"
  },
  {
    "text": "questions more special questions but how to do Micra services and there's loads of great literature around there's loads",
    "start": "122670",
    "end": "128160"
  },
  {
    "text": "of great blog posts and books and stuff that have been published but there weren't really any realistic example",
    "start": "128160",
    "end": "133740"
  },
  {
    "text": "you could just get up to speed with straight away so with that given what we",
    "start": "133740",
    "end": "139860"
  },
  {
    "text": "decided to do was in then the sub shop and the stop shop is an open source reference microservices architecture and",
    "start": "139860",
    "end": "146630"
  },
  {
    "text": "what were what I'm hoping today is that I'm going to take you to take you through a brief tour of some of its that",
    "start": "146630",
    "end": "152310"
  },
  {
    "text": "some of its implementation but the beauty is that you can go away right now and deploy this yourself and look at the",
    "start": "152310",
    "end": "158970"
  },
  {
    "text": "code yourself it's a fully working application the idea is that it's supposed to replicate an e-commerce",
    "start": "158970",
    "end": "164400"
  },
  {
    "text": "website and the way that it's laid out is supposed to be more realistic than",
    "start": "164400",
    "end": "170160"
  },
  {
    "text": "some of the you know the examples that you see in blog post I think that the",
    "start": "170160",
    "end": "175620"
  },
  {
    "text": "the actual layout of the example looks a bit like this each of these circles circles is a service and these services",
    "start": "175620",
    "end": "183420"
  },
  {
    "text": "are backed by certain databases and we've got a few other technologies in there like using stars on the front end",
    "start": "183420",
    "end": "191640"
  },
  {
    "text": "is serving the dual purposes like it's hosting this static content in the web",
    "start": "191640",
    "end": "196680"
  },
  {
    "text": "site stuff and it's also acting like an API gateway to the rest of the services as well the rest of the services",
    "start": "196680",
    "end": "202350"
  },
  {
    "text": "represent different parts of the imaginary sock shop so we've got a car catalog or the processing line things",
    "start": "202350",
    "end": "209070"
  },
  {
    "text": "like that and we intentionally made it polyglot so one of the decisions really",
    "start": "209070",
    "end": "214710"
  },
  {
    "start": "210000",
    "end": "210000"
  },
  {
    "text": "early almost has uses many languages languages as we could and that was so that when new people came to the project",
    "start": "214710",
    "end": "220770"
  },
  {
    "text": "I wanted to try the project they'd be able to use their own background to to",
    "start": "220770",
    "end": "228900"
  },
  {
    "text": "get interested in the project with a specific service that they were interested so we've got services written",
    "start": "228900",
    "end": "236670"
  },
  {
    "text": "in go we've got reserves that's written in Java and we've got a service written in know chess as well so hopefully it's covering both for an end of backing guy",
    "start": "236670",
    "end": "242790"
  },
  {
    "text": "we're also using a range of different supporting technologies and databases as well",
    "start": "242790",
    "end": "249269"
  },
  {
    "text": "and so this is it and we'll skip to the live version hopefully so yeah like I'm",
    "start": "249269",
    "end": "256180"
  },
  {
    "text": "fine so I'm just going to take you on a very very brief tour of what it is so we've got a catalog here that will give",
    "start": "256180",
    "end": "261940"
  },
  {
    "text": "you you can add our items to the cart we've got like a user service where we",
    "start": "261940",
    "end": "267430"
  },
  {
    "text": "can log-in ok password was just password if you were wondering and then we can",
    "start": "267430",
    "end": "274840"
  },
  {
    "text": "proceed to checkout place in order and so that in a very short sequence of",
    "start": "274840",
    "end": "281560"
  },
  {
    "text": "steps kind of exercise all of the different services that are going on in the background and later on I'll show",
    "start": "281560",
    "end": "288039"
  },
  {
    "text": "you some of the monitoring that are included in those services so we can see this process in in action and you can",
    "start": "288039",
    "end": "294130"
  },
  {
    "text": "see how many times I practice this presentation by the number of orders I've got there and this is the link I'll",
    "start": "294130",
    "end": "300610"
  },
  {
    "text": "put this up at the end but hopefully you can go away today in try for yourself and later than we think and yeah have a",
    "start": "300610",
    "end": "307720"
  },
  {
    "text": "search around it's there's a short link get to iOS stop shop or if you just search for micro services demo you get",
    "start": "307720",
    "end": "313720"
  },
  {
    "text": "there and you'll find this website and one of the coolest things about the",
    "start": "313720",
    "end": "318849"
  },
  {
    "text": "project is that we intend we initially develop the project test various",
    "start": "318849",
    "end": "324010"
  },
  {
    "text": "components against different deployments so even though this is a Cuban SS conference you know if you're interested",
    "start": "324010",
    "end": "329169"
  },
  {
    "text": "in visa or nomads offs or any the docket you know product then you can actually deploy the soft shop 20 of those",
    "start": "329169",
    "end": "335440"
  },
  {
    "text": "different deployments there's like a light for light comparison using the same same service okay so onto the meat",
    "start": "335440",
    "end": "344500"
  },
  {
    "text": "course so I'm going to actually delve a little bit into the code can I just ask who was here for the previous talk who",
    "start": "344500",
    "end": "352180"
  },
  {
    "text": "to talk about data okay it's not opening I will okay so he went into detail how to do this in",
    "start": "352180",
    "end": "358659"
  },
  {
    "text": "Java we went over all that generate JVM metrics and stuff like that but I'll just I'll cover my bit again because I",
    "start": "358659",
    "end": "367510"
  },
  {
    "start": "366000",
    "end": "366000"
  },
  {
    "text": "think people will all benefit from it so the Prometheus libraries there are several officially supported Prometheus",
    "start": "367510",
    "end": "374020"
  },
  {
    "text": "libraries go Java Scala Python Ruby there's also lots of unofficial ones which from what I've seen a generally of",
    "start": "374020",
    "end": "379870"
  },
  {
    "text": "good quality as well we use in ojf one in our application and that's solid",
    "start": "379870",
    "end": "385809"
  },
  {
    "text": "so I wouldn't worry too much about using a third-party library some of the libraries have helper frameworks so if",
    "start": "385809",
    "end": "392259"
  },
  {
    "text": "you're specifically if you're using something like Java then you might I would double check the the Prometheus",
    "start": "392259",
    "end": "400149"
  },
  {
    "text": "project yourself and other people as well because generally people have already done what you're trying to do if you're trying to get like export",
    "start": "400149",
    "end": "406389"
  },
  {
    "text": "geometrics for example there's already exporters out there so don't try and rewrite like yourself this helped us for",
    "start": "406389",
    "end": "412509"
  },
  {
    "text": "first for spring and Jessie and the things like a grenade which will automatically export Ivano related",
    "start": "412509",
    "end": "418509"
  },
  {
    "text": "metrics and opportun stuff like that book first because this is a bit more of",
    "start": "418509",
    "end": "424719"
  },
  {
    "text": "a go friendly conference than Java then we're going to we're going to look at gopher the project has three Co services",
    "start": "424719",
    "end": "431199"
  },
  {
    "text": "the payment using catalog services are all written in go and the one I'm going to look at right now is the catalog is",
    "start": "431199",
    "end": "436659"
  },
  {
    "text": "what I'm simplest it's backed by a database of maestro database that stores the data I'm going to look a little bit",
    "start": "436659",
    "end": "443110"
  },
  {
    "start": "443000",
    "end": "443000"
  },
  {
    "text": "of a code now so this is the first time you might be seeing Amit so as there's a",
    "start": "443110",
    "end": "448689"
  },
  {
    "text": "good question how many people here have actually define the metric before do to understand what legends about half about",
    "start": "448689",
    "end": "456399"
  },
  {
    "text": "how ok so I'm going to go I'm going to take it a little bit slow over this first step but then I'll I'll be faster",
    "start": "456399",
    "end": "463059"
  },
  {
    "text": "on the next ones because they're all very someone so here we're defining the global variable called hey see we listened see and we're using the",
    "start": "463059",
    "end": "469990"
  },
  {
    "text": "standard Prometheus library to create a new histogram and before we're going to",
    "start": "469990",
    "end": "476439"
  },
  {
    "text": "further this is probably one of the most important this so previous support for type of symmetric a counter a gauge",
    "start": "476439",
    "end": "482999"
  },
  {
    "text": "summary and a histogram so a counter is a simple count of things the gauge is",
    "start": "482999",
    "end": "489099"
  },
  {
    "text": "like a real-time view of a measurement summary is like a summary statistic and",
    "start": "489099",
    "end": "495240"
  },
  {
    "text": "histogram is a histogram of values so it's like a you know is it like a",
    "start": "495240",
    "end": "500499"
  },
  {
    "text": "histogram chart that counts in his individual minutes we've chosen histogram because of a chat call Tom",
    "start": "500499",
    "end": "507819"
  },
  {
    "text": "will key down in this corner here he upset a few people by trying to define",
    "start": "507819",
    "end": "512919"
  },
  {
    "text": "zone a metric scheme and it came up with this nice acronym red metrics and the idea",
    "start": "512919",
    "end": "519820"
  },
  {
    "text": "there is that with red metrics you can generally monitor the things that are",
    "start": "519820",
    "end": "525490"
  },
  {
    "text": "most important to your application and they are the request rates the error rate and the duration of that call is",
    "start": "525490",
    "end": "531850"
  },
  {
    "text": "happening so the request rate is account the error rate is the count of the number of errors and the duration the",
    "start": "531850",
    "end": "538660"
  },
  {
    "text": "latency can be measured by a histogram Bukit you don't want to use a summary statistic like a rolling average there",
    "start": "538660",
    "end": "545170"
  },
  {
    "text": "because it doesn't represent outliers very well it doesn't represent the range very long and the beauty about the",
    "start": "545170",
    "end": "551529"
  },
  {
    "text": "histogram vector is is that the you can count you can obtain all of these",
    "start": "551529",
    "end": "557140"
  },
  {
    "text": "metrics just with the one single history parametric so with the histogram metrics you get a count for free and you can do",
    "start": "557140",
    "end": "564100"
  },
  {
    "text": "the error egrant labels and you also get the book it's obviously in as well so all of the services that are not to show",
    "start": "564100",
    "end": "569500"
  },
  {
    "text": "you all are implemented with a scrum ok now that we've got that out of the way",
    "start": "569500",
    "end": "575290"
  },
  {
    "text": "the next most important thing is the name there's some good documentation on",
    "start": "575290",
    "end": "582100"
  },
  {
    "text": "the Prometheus website and there's also some good blog posts that tell you how to pick good names to your label or your",
    "start": "582100",
    "end": "589209"
  },
  {
    "text": "names and the reason for doing that is because it's not you the developer that will be using these metrics it's going",
    "start": "589209",
    "end": "595810"
  },
  {
    "text": "to be other people as well than the other developers other ops guys could be marketing people stuff like that so you",
    "start": "595810",
    "end": "601330"
  },
  {
    "text": "need a good name that explains what the variable is and they so they can find it easily and so generally I'd kind of",
    "start": "601330",
    "end": "610209"
  },
  {
    "text": "summarize all of the recommendations into two things one is to use SI units",
    "start": "610209",
    "end": "616029"
  },
  {
    "text": "so second bytes meters grams stuff like",
    "start": "616029",
    "end": "622209"
  },
  {
    "text": "that and and secondly be consistent in your naming so if you've got if you are",
    "start": "622209",
    "end": "629200"
  },
  {
    "text": "measuring the same type of thing like we are going to be here we're measuring an HTTP call be consistent in what you call",
    "start": "629200",
    "end": "635950"
  },
  {
    "text": "it it doesn't matter so much what you call it well I mean it goes but I could have called it like HTTP request",
    "start": "635950",
    "end": "641800"
  },
  {
    "text": "generation or something well it's more important to be consistent with whatever you do choose because then it becomes",
    "start": "641800",
    "end": "647589"
  },
  {
    "text": "much yes to do some more advanced querying and filtering on the on the final",
    "start": "647589",
    "end": "652699"
  },
  {
    "text": "metrics when you get them a little bit help get that bit",
    "start": "652699",
    "end": "658369"
  },
  {
    "text": "look it is quite important depending on what you're doing so the histogram said",
    "start": "658369",
    "end": "663410"
  },
  {
    "text": "is it is account in particular bins and you actually have to define those bin ranges in advance so by default it gives",
    "start": "663410",
    "end": "671209"
  },
  {
    "text": "you can't remember thing it's like 10 10 bin ranging from 1 millisecond up to 10 seconds if you're trying to monitor",
    "start": "671209",
    "end": "677899"
  },
  {
    "text": "something that's outside of that range or you know it's significantly skewed to one side of that range then you'd want",
    "start": "677899",
    "end": "684379"
  },
  {
    "text": "to override that and provide your own bin inside it and the second most",
    "start": "684379",
    "end": "691069"
  },
  {
    "text": "important thing is the label because with the labels this allows us to do this so with this little bit of code I'm",
    "start": "691069",
    "end": "699319"
  },
  {
    "text": "defining four labels here the first one is the method so this is relating to http metric so the method is like get",
    "start": "699319",
    "end": "708589"
  },
  {
    "text": "post put delete we've got the route which is the path to the HTTP resource that were accessing and then we've got",
    "start": "708589",
    "end": "715730"
  },
  {
    "text": "status code so with a request rate we can just look at the method and route",
    "start": "715730",
    "end": "720740"
  },
  {
    "text": "for the error rate we can look at the method in the route but filter for particular status codes that's what",
    "start": "720740",
    "end": "726920"
  },
  {
    "text": "gives us our error definition and finally we can get this duration from",
    "start": "726920",
    "end": "731959"
  },
  {
    "text": "there there's two grammar start and that's it really so once you've defined your metrics you",
    "start": "731959",
    "end": "738049"
  },
  {
    "text": "need to register that metric and you might notice that I said use a global variable and we generally use global",
    "start": "738049",
    "end": "743600"
  },
  {
    "text": "variables because by definition Prometheus dictates that you're not",
    "start": "743600",
    "end": "749209"
  },
  {
    "text": "allowed to have duplicate metric names you can only have one metric for one name so by definition you might as well",
    "start": "749209",
    "end": "755059"
  },
  {
    "text": "make a global and it Sherlock because I found like during tests and things like that if you don't make them global",
    "start": "755059",
    "end": "761269"
  },
  {
    "text": "sometimes they can get instantiated twice and you'll get a nasty Star Trek",
    "start": "761269",
    "end": "766869"
  },
  {
    "text": "okay we've got a quick middleware definition here so we can intercept the HTTP call",
    "start": "766869",
    "end": "774030"
  },
  {
    "start": "768000",
    "end": "768000"
  },
  {
    "text": "and then we're creating something called an instrument here and in this",
    "start": "774030",
    "end": "779320"
  },
  {
    "start": "775000",
    "end": "775000"
  },
  {
    "text": "instrument we've got our metric that we're going to use to write our metric and then we've got another thing which",
    "start": "779320",
    "end": "784450"
  },
  {
    "text": "is quite important called a route matcher and generally the goal of this piece of code is to try and match routes who",
    "start": "784450",
    "end": "793780"
  },
  {
    "text": "they're defined that we put so if I give you an example on the catalogue usually",
    "start": "793780",
    "end": "800710"
  },
  {
    "text": "we're accessing the catalogue with something like a path of like slash catalog slash ID to get a particular",
    "start": "800710",
    "end": "805810"
  },
  {
    "text": "item in that catalog we don't want to create a new metric for every single ID",
    "start": "805810",
    "end": "811000"
  },
  {
    "text": "because we could end up with thousands or millions of metrics and that's a very quick way to degrade the performance of",
    "start": "811000",
    "end": "817330"
  },
  {
    "text": "your Prometheus so what we do is we match that route to a predefined name so it'll probably look like it'll either be",
    "start": "817330",
    "end": "824440"
  },
  {
    "text": "given a name if you're using like gorilla mocks or something but in other languages we maybe just replaced the ID",
    "start": "824440",
    "end": "829480"
  },
  {
    "text": "with a fixed string like : ID or something like that and then we've finally gotten the thing",
    "start": "829480",
    "end": "836050"
  },
  {
    "text": "that does the monitoring and it's a bit long but it's actually quite simple we've got a bit in the middle here this",
    "start": "836050",
    "end": "841690"
  },
  {
    "text": "served HTTP this is this is actually calling the method that actually",
    "start": "841690",
    "end": "846990"
  },
  {
    "text": "performs whatever the end point is doing actually does what the end point doing and then we've got like pre and post",
    "start": "846990",
    "end": "853120"
  },
  {
    "text": "code in a pre code we're starting a timer in the post code or calculating the G and then there's a few little bits",
    "start": "853120",
    "end": "859270"
  },
  {
    "text": "around it and then the last line here we're actually doing the writing of that metric that we've just measured we're",
    "start": "859270",
    "end": "866530"
  },
  {
    "text": "passing in the method the route the status call and a WebSocket thing is don't worry about but these two things",
    "start": "866530",
    "end": "874240"
  },
  {
    "text": "are carefully from the code above and then we're writing to the metric with the observe method and passing in the",
    "start": "874240",
    "end": "881500"
  },
  {
    "text": "number of seconds that it took that's kind of it really this is just a",
    "start": "881500",
    "end": "887960"
  },
  {
    "start": "886000",
    "end": "886000"
  },
  {
    "text": "bit of wiring click to to pull it all together this is kind of general standard go code go code we've got our",
    "start": "887960",
    "end": "894110"
  },
  {
    "text": "endpoints for our particular services or creating our route earth and all the HTTP calls we've got we're defining the",
    "start": "894110",
    "end": "901100"
  },
  {
    "start": "899000",
    "end": "899000"
  },
  {
    "text": "middleware in this instrument thing I told you about so this is where we're passing in our metric our global metric",
    "start": "901100",
    "end": "907190"
  },
  {
    "text": "and that's creating the middleware and you can have you know more middle words and log business just like that merging them all together and wrapping",
    "start": "907190",
    "end": "914060"
  },
  {
    "text": "them around the root term and that's it we'll go so let's have a look at",
    "start": "914060",
    "end": "921350"
  },
  {
    "text": "something else now look at some Java code and I will go through this despite the previous talk which is more like",
    "start": "921350",
    "end": "927649"
  },
  {
    "text": "more in-depth Java metrics and monitoring so if you're interested in Jeffster difficulty take a look at",
    "start": "927649",
    "end": "933080"
  },
  {
    "text": "Alexander's talks before me in the the Marcoses demo there are three Java",
    "start": "933080",
    "end": "940190"
  },
  {
    "text": "services again and we're going to look at the car I say generative just a digression slightly just to vent my anger sha for",
    "start": "940190",
    "end": "947570"
  },
  {
    "text": "Java because my I've got a young daughter two daughters and the eldest she was really into looking at these",
    "start": "947570",
    "end": "952850"
  },
  {
    "text": "flashcards and on the flashcard they had je the jellyfish and so I had a massive argument over my wife like why y jc--",
    "start": "952850",
    "end": "960320"
  },
  {
    "text": "jealous she's two years old she lives in England she's never ever going to see a jellyfish until she goes to the aquarium",
    "start": "960320",
    "end": "965630"
  },
  {
    "text": "when she's 10 so why not J for jellyfish J for jar something different so I took method",
    "start": "965630",
    "end": "971000"
  },
  {
    "text": "into my own hands and now Jays a java so if you have a daughter now J is for Java so if she becomes an engineer later on",
    "start": "971000",
    "end": "977959"
  },
  {
    "text": "and blaming this this is this is where it all started within the Java services we chose to use",
    "start": "977959",
    "end": "985279"
  },
  {
    "start": "981000",
    "end": "981000"
  },
  {
    "text": "spring Boop we did this because it made it very easy to get up and running and make a",
    "start": "985279",
    "end": "990589"
  },
  {
    "text": "microservices in a very short amount of time some of you use it great some of you love it some of you hate it various",
    "start": "990589",
    "end": "997130"
  },
  {
    "text": "reasons generally spring boot is all controlled by like aspect-oriented programming",
    "start": "997130",
    "end": "1003490"
  },
  {
    "text": "stuff so sort like annotations but if you're just using core Java or something",
    "start": "1003490",
    "end": "1009100"
  },
  {
    "text": "else like the Java EE or something most of these things can be done by extending classes rather than using annotations",
    "start": "1009100",
    "end": "1015850"
  },
  {
    "text": "but we start really simply because we using the spring boot helper that comes",
    "start": "1015850",
    "end": "1021740"
  },
  {
    "text": "with the prometheus library and it comes with enable prometheus endpoint and that single line will handle all the backend",
    "start": "1021740",
    "end": "1027800"
  },
  {
    "text": "stuff to expose the slash the metrics endpoint and set up all of the",
    "start": "1027800",
    "end": "1033199"
  },
  {
    "text": "Prometheus registers and stuff so very nice little little caveat though by",
    "start": "1033199",
    "end": "1039020"
  },
  {
    "text": "default spring boot comes with something called actuator actuator is a spring booty thing to expose loads of metrics",
    "start": "1039020",
    "end": "1045470"
  },
  {
    "text": "and I've got a little bit of code to disable that that it exposes on slash metrics by default and I'm changing the",
    "start": "1045470",
    "end": "1052130"
  },
  {
    "text": "prometheus endpoint to be slash metrics so I'm basically just replacing them so",
    "start": "1052130",
    "end": "1058340"
  },
  {
    "start": "1055000",
    "end": "1055000"
  },
  {
    "text": "the couple of options for doing the timing the easiest one is to use another annotation there's a Prometheus time",
    "start": "1058340",
    "end": "1064610"
  },
  {
    "text": "method and that's great however this by default uses a summary type a summary",
    "start": "1064610",
    "end": "1073070"
  },
  {
    "text": "type is something that I haven't gone into detail but basically it's a summary statistic it's a rolling average",
    "start": "1073070",
    "end": "1079120"
  },
  {
    "text": "measurement you can provide quantile to compute on those values but the problem",
    "start": "1079120",
    "end": "1087320"
  },
  {
    "text": "is that if you had multiple services and try to you if you had multiple services you can't aggregate a summary type",
    "start": "1087320",
    "end": "1093320"
  },
  {
    "text": "because those quantiles have already been calculated so that's bad and also if they're not very flexible if you",
    "start": "1093320",
    "end": "1099110"
  },
  {
    "text": "change your mind if you don't want to measure the 99th percentile and what changes in 98 or something so I wouldn't",
    "start": "1099110",
    "end": "1105890"
  },
  {
    "text": "use that method if I were you what I would probably do is write your own",
    "start": "1105890",
    "end": "1111620"
  },
  {
    "start": "1110000",
    "end": "1110000"
  },
  {
    "text": "annotation to do what you want probably with a histogram if you're doing this type of stuff and I'm surprised it's not",
    "start": "1111620",
    "end": "1118700"
  },
  {
    "text": "in the library and it probably will be soon familiar and you can see I've been very helpful and provided you with all",
    "start": "1118700",
    "end": "1124190"
  },
  {
    "text": "the code that you need to do that but what I did was I went with convention",
    "start": "1124190",
    "end": "1129800"
  },
  {
    "text": "with the other services and I wanted to monitor all of the endpoints so I did some spring jiggery-pokery to insert",
    "start": "1129800",
    "end": "1137720"
  },
  {
    "start": "1131000",
    "end": "1131000"
  },
  {
    "text": "some interceptors which are like like middleware basically and I added my",
    "start": "1137720",
    "end": "1143810"
  },
  {
    "text": "interceptor to a particular group which was just all routes just a glob there",
    "start": "1143810",
    "end": "1149490"
  },
  {
    "start": "1149000",
    "end": "1149000"
  },
  {
    "text": "now we've come to the actual definition of the histogram and you'll notice that it's very very very similar to go",
    "start": "1149490",
    "end": "1156700"
  },
  {
    "text": "implementation and you'll find all of the libraries follow the same pattern you know you create a new thing and",
    "start": "1156700",
    "end": "1162070"
  },
  {
    "text": "you're passing it names and label names and stuff like that all very very",
    "start": "1162070",
    "end": "1167350"
  },
  {
    "text": "similar the Interceptor that I'm creating has has got a pre handle like a",
    "start": "1167350",
    "end": "1173740"
  },
  {
    "text": "pre hook and it's got a post handle post up and if she's doing the same thing as the go code is doing where we're",
    "start": "1173740",
    "end": "1179260"
  },
  {
    "text": "starting they're starting a timer in the pre hook and then were calculating the",
    "start": "1179260",
    "end": "1184780"
  },
  {
    "text": "duration in the post up pretty nice so I would probably recommend that you just",
    "start": "1184780",
    "end": "1190570"
  },
  {
    "text": "write your own annotation though especially if you're using spring or spring loop creating an annotation that",
    "start": "1190570",
    "end": "1196390"
  },
  {
    "text": "would create histogram with your specific options and that's probably",
    "start": "1196390",
    "end": "1201730"
  },
  {
    "text": "easy to use in a lot one final one nodejs and express nuts front end",
    "start": "1201730",
    "end": "1208420"
  },
  {
    "start": "1204000",
    "end": "1204000"
  },
  {
    "text": "obviously rose through this one we're using Express the Express framework and",
    "start": "1208420",
    "end": "1213820"
  },
  {
    "start": "1209000",
    "end": "1209000"
  },
  {
    "text": "from client library which is one of the unofficial libraries but it's very very similar to the others but creating a",
    "start": "1213820",
    "end": "1219100"
  },
  {
    "text": "global global variable called the request duration seconds again same name it's got the same labels yes pretty much",
    "start": "1219100",
    "end": "1228070"
  },
  {
    "text": "similar Express has got a middleware concept and this is implementing that for that middleware in effect and same",
    "start": "1228070",
    "end": "1235210"
  },
  {
    "text": "thing again we're starting a timer calculate the duration there and then",
    "start": "1235210",
    "end": "1240790"
  },
  {
    "text": "writing it expose the metrics function at the end throw some way and that's all",
    "start": "1240790",
    "end": "1248110"
  },
  {
    "text": "well and good and knowing you've got the code but what I've seen previously is",
    "start": "1248110",
    "end": "1253780"
  },
  {
    "text": "that not many people talk about deploying that and since this is a bit this is a this is a kubernetes conference I thought I will try and show",
    "start": "1253780",
    "end": "1259660"
  },
  {
    "text": "you deploy that a little bit okay",
    "start": "1259660",
    "end": "1264980"
  },
  {
    "text": "normally when you finish your code you get some sort of meme and get like this during flack and this is my entire mean",
    "start": "1264980",
    "end": "1270650"
  },
  {
    "text": "quota in one slide by the way you took people so great you've done the codes now if it and it's actually not that",
    "start": "1270650",
    "end": "1277010"
  },
  {
    "text": "simple I would say that writing the manifest the kubernetes manifest and",
    "start": "1277010",
    "end": "1282320"
  },
  {
    "text": "getting them all set up and set up in the right way can actually be as difficult if not more difficult than writing the code yourself so I'm going",
    "start": "1282320",
    "end": "1289880"
  },
  {
    "start": "1289000",
    "end": "1289000"
  },
  {
    "text": "to take a look quick look at that remember that we can deploy to other orchestrators but I think someone would",
    "start": "1289880",
    "end": "1296600"
  },
  {
    "text": "probably get pissed off if I started talking about me just for something's to execute it and I assume you're all",
    "start": "1296600",
    "end": "1303860"
  },
  {
    "text": "fairly familiar with manifest if you not just go to the repo when in fact you can",
    "start": "1303860",
    "end": "1310370"
  },
  {
    "start": "1304000",
    "end": "1304000"
  },
  {
    "text": "go to the repo irrespective of your experience and and look at all of these in detail but basically we're creating",
    "start": "1310370",
    "end": "1315800"
  },
  {
    "text": "manifests that contain the Prometheus image passing all of the arguments to",
    "start": "1315800",
    "end": "1321800"
  },
  {
    "text": "the Prometheus binary and the configuration file is being passed in by",
    "start": "1321800",
    "end": "1327170"
  },
  {
    "text": "a volume man and the volume mount the Prometheus song channel is actually a",
    "start": "1327170",
    "end": "1333100"
  },
  {
    "text": "config map and inside the config map we",
    "start": "1333100",
    "end": "1338780"
  },
  {
    "text": "have all of the Prometheus scrape settings and this this is really where the the chunk of the work is to get",
    "start": "1338780",
    "end": "1346490"
  },
  {
    "text": "Prometheus set up how you want it to get set up the one in the repository this one is just the same as the example that",
    "start": "1346490",
    "end": "1353360"
  },
  {
    "text": "Prometheus give you to it to monitor communities works really well at the box if you wanted to do something more",
    "start": "1353360",
    "end": "1358970"
  },
  {
    "text": "advanced that's where you'd start and then finally we've got a service Prometheus service it's exporting at a",
    "start": "1358970",
    "end": "1365600"
  },
  {
    "text": "port for us you can try this out yourself with mini goose and it's as",
    "start": "1365600",
    "end": "1371270"
  },
  {
    "start": "1367000",
    "end": "1367000"
  },
  {
    "text": "simple as doing that and you'll have a full fully deployed set up basically start mini coop I'd recommend opening",
    "start": "1371270",
    "end": "1377690"
  },
  {
    "text": "the memory there's a lot of services there this sort of 810 services and plus",
    "start": "1377690",
    "end": "1383360"
  },
  {
    "text": "all the kubernetes stuff as well I'd put two to four gigs of RAM if you can and then clone that repository do cubes ETL",
    "start": "1383360",
    "end": "1390650"
  },
  {
    "text": "create on the complete demo file and then a cube CTL create on",
    "start": "1390650",
    "end": "1395670"
  },
  {
    "text": "Manifest monitoring folder in there wait because it takes a while to download all of that and then if the demo gods are",
    "start": "1395670",
    "end": "1405600"
  },
  {
    "text": "smiling down on me you will get",
    "start": "1405600",
    "end": "1412039"
  },
  {
    "text": "something that looks like that a so this is a version of the same thing that's",
    "start": "1413750",
    "end": "1418830"
  },
  {
    "text": "running in the cloud not on my laptop because it would grind to a halt but you can see we've got lots different names",
    "start": "1418830",
    "end": "1424230"
  },
  {
    "text": "races there we've got specific name safe places for the sub shop we've also got",
    "start": "1424230",
    "end": "1430080"
  },
  {
    "text": "the namespace the monitoring and that's where that Prometheus deployment has been deployed interestingly someone's",
    "start": "1430080",
    "end": "1436050"
  },
  {
    "text": "booked the number of front-ends I was that you okay thanks for that yeah and",
    "start": "1436050",
    "end": "1442550"
  },
  {
    "text": "if we I've got an SSH tunnel open and",
    "start": "1442550",
    "end": "1447690"
  },
  {
    "text": "it's forward in Prometheus for me and if we would type in generations seconds oh",
    "start": "1447690",
    "end": "1454350"
  },
  {
    "text": "where did that go",
    "start": "1454350",
    "end": "1457309"
  },
  {
    "text": "then we should see our variables there there you go so all of those services",
    "start": "1466660",
    "end": "1472370"
  },
  {
    "text": "are now being scraped automatically by the the Prometheus configuration and all",
    "start": "1472370",
    "end": "1477860"
  },
  {
    "text": "of the services are exporting metrics on slash metrics awesome so once you've got",
    "start": "1477860",
    "end": "1488540"
  },
  {
    "start": "1486000",
    "end": "1486000"
  },
  {
    "text": "Prometheus deployed what you do next the next thing to do is start thinking about",
    "start": "1488540",
    "end": "1494020"
  },
  {
    "text": "what you would like to do as a engineer or as a business but we've gone through",
    "start": "1494020",
    "end": "1501890"
  },
  {
    "text": "some examples with the stop shop here so the first one is for Sonic so kevanna is a dashboarding tool often",
    "start": "1501890",
    "end": "1509780"
  },
  {
    "text": "comes with Prometheus and it's very cool I'll go through all the details we can have a look in the repo basically we've",
    "start": "1509780",
    "end": "1515570"
  },
  {
    "text": "got the graph our net pendency and service like just like we do prefer Prometheus and the coolest bit is that",
    "start": "1515570",
    "end": "1521809"
  },
  {
    "text": "we've got one massive massive conflict map with the Jason graph and dashboards inside so all of the dashboard to start",
    "start": "1521809",
    "end": "1528169"
  },
  {
    "text": "and get in you know version control and they get pulled in and then written to",
    "start": "1528169",
    "end": "1535299"
  },
  {
    "text": "Gravano when it's done there's a little batch job to ingest and write the dashboard to the configuration file and",
    "start": "1535299",
    "end": "1541940"
  },
  {
    "text": "then there's a few extra bits to get some more information about cuban areas and disk usage to stuff that is what it",
    "start": "1541940",
    "end": "1548540"
  },
  {
    "text": "looks like let me see it's the live version is running ooh almost so that",
    "start": "1548540",
    "end": "1556010"
  },
  {
    "text": "doesn't look great but here we go so this is live dashboard",
    "start": "1556010",
    "end": "1561169"
  },
  {
    "text": "of of what's going on at the moment or it would be a life dashboard if we can see some metrics go on",
    "start": "1561169",
    "end": "1567789"
  },
  {
    "text": "ah damn you Wi-Fi I might have to go",
    "start": "1570320",
    "end": "1578149"
  },
  {
    "text": "back to the picture back up sir oh oh",
    "start": "1578149",
    "end": "1583210"
  },
  {
    "text": "it's getting there",
    "start": "1586240",
    "end": "1589658"
  },
  {
    "text": "too slow too slow too slow too slow okay but we've got dashboards for performance ironically we've got dashboard bombs and",
    "start": "1591820",
    "end": "1598720"
  },
  {
    "text": "we've got default dashboards for the error rate the request rate the latency of the",
    "start": "1598720",
    "end": "1604250"
  },
  {
    "text": "service and things like that and an error rates and stuff that's very cool",
    "start": "1604250",
    "end": "1610029"
  },
  {
    "text": "this is a dashboard specific to the sock shop resources is also kubernetes resources as well I just want to trim",
    "start": "1610029",
    "end": "1616700"
  },
  {
    "text": "CPU usage and RAM usage and things like that and then regardez very simple",
    "start": "1616700",
    "end": "1622159"
  },
  {
    "text": "analytics kind of dashboard let me see if we can get that help Ashley because that's a bit of a smaller dashboard to",
    "start": "1622159",
    "end": "1627830"
  },
  {
    "text": "load and then we can see how many socks we've sold 37,000 orders have been",
    "start": "1627830",
    "end": "1634010"
  },
  {
    "text": "placed since this start this this example side run and so clear I'll be a",
    "start": "1634010",
    "end": "1639020"
  },
  {
    "text": "rich man when this presentation ends once you've got the monitoring in place",
    "start": "1639020",
    "end": "1644840"
  },
  {
    "text": "the next step is alerting and alerting with resources to make a little side",
    "start": "1644840",
    "end": "1650029"
  },
  {
    "text": "project called alert manager happens is Prometheus sends its alerts which could",
    "start": "1650029",
    "end": "1655399"
  },
  {
    "text": "come from multiple sources into an alert manager and an aloud manager handles all of the deduplication and all of the",
    "start": "1655399",
    "end": "1661309"
  },
  {
    "text": "aggregation and then spurts an alert out to one of many services so again we've",
    "start": "1661309",
    "end": "1667429"
  },
  {
    "start": "1667000",
    "end": "1667000"
  },
  {
    "text": "got manifests in that repository that define the alert manager dependency and",
    "start": "1667429",
    "end": "1674659"
  },
  {
    "text": "again we're using a volume mount to pass in the settings file for the alert",
    "start": "1674659",
    "end": "1680600"
  },
  {
    "text": "manager and inside the settings file we've got lots of things like your a slack secret and all of the other",
    "start": "1680600",
    "end": "1685640"
  },
  {
    "text": "options and which define how you want alert manager to alert and in this case",
    "start": "1685640",
    "end": "1692240"
  },
  {
    "text": "we have a kubernetes secret setup called a flat hook URL and that's being written",
    "start": "1692240",
    "end": "1699110"
  },
  {
    "text": "by this little script into into the configuration file you also have another",
    "start": "1699110",
    "end": "1705200"
  },
  {
    "text": "config map which defines your levels and in this case it's an example alert rule",
    "start": "1705200",
    "end": "1710750"
  },
  {
    "text": "for a high error rate so if we've got if you look that's our metric that we",
    "start": "1710750",
    "end": "1716899"
  },
  {
    "text": "defined in our code if we've got a status code at 500 for any of our services of greater than 1 for 5 minutes",
    "start": "1716899",
    "end": "1724260"
  },
  {
    "text": "then we're going to get an alert and slacks and I'm not going to try and do that because the Wi-Fi will fail on me I suspect but what it looks like is that",
    "start": "1724260",
    "end": "1733430"
  },
  {
    "text": "so that's a very knotty example but you know in actual usage we've got alerts are all sorts of",
    "start": "1733430",
    "end": "1739590"
  },
  {
    "text": "different things or any anything from service health all the way down to",
    "start": "1739590",
    "end": "1744600"
  },
  {
    "text": "performance and you know user metrics and stuff like that so to summarize what",
    "start": "1744600",
    "end": "1753360"
  },
  {
    "text": "I would say is go and check out this project on those URL and try and deploy",
    "start": "1753360",
    "end": "1759360"
  },
  {
    "text": "it yourself have a play about with it break it fix it if you like it and want to contribute back then just again it's",
    "start": "1759360",
    "end": "1766020"
  },
  {
    "text": "on the repo check out weave cloud and specifically the cortex part we cloud it's a really cool and a you know well",
    "start": "1766020",
    "end": "1774720"
  },
  {
    "text": "developed sophisticated version of Prometheus which is more in telling multi-tenant and hosted there's improved",
    "start": "1774720",
    "end": "1781980"
  },
  {
    "text": "all the time as well happy pill all there thank you very much",
    "start": "1781980",
    "end": "1788029"
  },
  {
    "text": "any questions please i I couldn't",
    "start": "1793830",
    "end": "1816010"
  },
  {
    "text": "comment on that um thread I haven't got enough experience with link a t2 to common and there's probably about people",
    "start": "1816010",
    "end": "1822970"
  },
  {
    "text": "that can answer that question so I would forward you to some of my colleagues",
    "start": "1822970",
    "end": "1828130"
  },
  {
    "text": "that were better able to answer that question so yeah see me afterwards and",
    "start": "1828130",
    "end": "1834670"
  },
  {
    "text": "I'll point you in the right direction if you're interested in knowing the answer to that",
    "start": "1834670",
    "end": "1839850"
  },
  {
    "text": "yeah well check out the alert manager",
    "start": "1850590",
    "end": "1857320"
  },
  {
    "text": "project I mean that's where all the documentation is but as you can see it's actually remarkably simple it's just got",
    "start": "1857320",
    "end": "1862420"
  },
  {
    "start": "1862000",
    "end": "1862000"
  },
  {
    "text": "a simple syntax specifying alert you've got if a Prometheus query okay one like",
    "start": "1862420",
    "end": "1869470"
  },
  {
    "text": "having somebody else to talk about",
    "start": "1869470",
    "end": "1874110"
  },
  {
    "text": "[Music] yeah I think I can't personally not in",
    "start": "1880100",
    "end": "1886270"
  },
  {
    "text": "this toxis it's not to talk about alert manager I have seen other there are other talks about alert manager in",
    "start": "1886270",
    "end": "1891400"
  },
  {
    "text": "particular which you could probably get more detailed information there and you",
    "start": "1891400",
    "end": "1897280"
  },
  {
    "text": "know quite honestly it's going to be down to you eventually I'm sure there's patterns you can copy but it you know",
    "start": "1897280",
    "end": "1903429"
  },
  {
    "text": "everybody's alert is different preferably everybody's business you might be more important in you might be",
    "start": "1903429",
    "end": "1910330"
  },
  {
    "text": "more interested in certain things or other people for example again sorry",
    "start": "1910330",
    "end": "1917350"
  },
  {
    "text": "useless asked the Prometheus developers",
    "start": "1917350",
    "end": "1926080"
  },
  {
    "text": "next I mean personally personally I would choose it because it's super",
    "start": "1926080",
    "end": "1932679"
  },
  {
    "text": "simple and I love that you know all of the other especially proprietary systems are very complex and that's hard to",
    "start": "1932679",
    "end": "1937780"
  },
  {
    "text": "understand and therefore hard to use and how to deploy and how to manage various incomplete comparison in complete",
    "start": "1937780",
    "end": "1945970"
  },
  {
    "text": "opposite of that is super simple everything is well described and it's",
    "start": "1945970",
    "end": "1951669"
  },
  {
    "text": "basically very hard to get wrong and it does the job so that's all I can ask of",
    "start": "1951669",
    "end": "1957100"
  },
  {
    "text": "a monitoring tool okay so when you work around your manager like that end point",
    "start": "1957100",
    "end": "1962919"
  },
  {
    "text": "I think is coming in and what other things turn out like requested to do up you might want that",
    "start": "1962919",
    "end": "1968590"
  },
  {
    "text": "yeah yeah sure you can just yeah monitor all all activity and Martha know all of",
    "start": "1968590",
    "end": "1975790"
  },
  {
    "text": "the examples in the stop shop for all incoming the only the only real the more",
    "start": "1975790",
    "end": "1981820"
  },
  {
    "text": "complex example we've got in there is that we've got like an orders pipeline so you've got one service that calls another that cause another cause on the",
    "start": "1981820",
    "end": "1987730"
  },
  {
    "text": "left so all of those do report metrics and then the top-level want the orders one is kind of an aggregation of all of",
    "start": "1987730",
    "end": "1994480"
  },
  {
    "text": "our that's the most complicated situation we've got in there but yeah I can imagine that you would like to measure things going helpful um this is",
    "start": "1994480",
    "end": "2001230"
  },
  {
    "text": "a monitor on the incoming plane but also microfiber compare right is there a",
    "start": "2001230",
    "end": "2006570"
  },
  {
    "text": "problem between yeah yeah and you never know where the problem yes from a neighbor community yes",
    "start": "2006570",
    "end": "2013140"
  },
  {
    "text": "yep okay thank you very much",
    "start": "2013140",
    "end": "2019850"
  },
  {
    "text": "[Applause]",
    "start": "2020800",
    "end": "2023250"
  }
]