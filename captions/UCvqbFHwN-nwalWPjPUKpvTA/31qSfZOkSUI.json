[
  {
    "start": "0",
    "end": "87000"
  },
  {
    "text": "okay we're going to get started like to welcome everyone to today's cncf",
    "start": "9200",
    "end": "14400"
  },
  {
    "text": "webinar production get ops in practice i'm jerry fallon and i will",
    "start": "14400",
    "end": "21119"
  },
  {
    "text": "be moderating today's webinar we would like to welcome our presenter today rick spencer head of platform and inflex data just a",
    "start": "21119",
    "end": "28640"
  },
  {
    "text": "few housekeeping items before we get started during the webinar you are not able to talk as an attendee there is a q a box",
    "start": "28640",
    "end": "34800"
  },
  {
    "text": "at the bottom of your screen so please feel free to drop your questions in there and we'll get to as many as we can at the end",
    "start": "34800",
    "end": "39920"
  },
  {
    "text": "this is an official webinar of the cncf and as such is subject to the cncf code of conda please do not add anything to the",
    "start": "39920",
    "end": "46239"
  },
  {
    "text": "chatter questions that are in violation of the code of conduct please be respectful of your fellow participants and presenters",
    "start": "46239",
    "end": "52480"
  },
  {
    "text": "please also note that the recording in slides will be posted later today to the cncf webinar page at cncf dot io slash",
    "start": "52480",
    "end": "58879"
  },
  {
    "text": "webinars and with that i will hand it over to rick for today's presentation",
    "start": "58879",
    "end": "64158"
  },
  {
    "text": "thank you so much i hope everyone can hear me okay um i guess i'll get some feedback if",
    "start": "64159",
    "end": "70880"
  },
  {
    "text": "you can't i'm really happy to be here i really appreciate the opportunity to talk about the way we",
    "start": "70880",
    "end": "79360"
  },
  {
    "text": "use git ops in our kubernetes practice at influxdb so first",
    "start": "79360",
    "end": "88400"
  },
  {
    "start": "87000",
    "end": "237000"
  },
  {
    "text": "to just provide some context um i thought it would be useful to just",
    "start": "88400",
    "end": "93520"
  },
  {
    "text": "talk a little bit about influx data so what uh influx data is",
    "start": "93520",
    "end": "100400"
  },
  {
    "text": "at its heart is a time series database although influx db has grown to be a platform on",
    "start": "100400",
    "end": "106960"
  },
  {
    "text": "top of that where people can write custom monitoring applications custom iot applications",
    "start": "106960",
    "end": "114240"
  },
  {
    "text": "people write custom finance applications anything where the",
    "start": "114240",
    "end": "121439"
  },
  {
    "text": "time dimension is the most important dimension of your data influx db is a really good place to",
    "start": "121439",
    "end": "128800"
  },
  {
    "text": "develop that application so our special kind of database with a platform",
    "start": "128800",
    "end": "135520"
  },
  {
    "text": "on top of it to make it easy to write applications for it so um",
    "start": "135520",
    "end": "142000"
  },
  {
    "text": "i always put this slide here to stop to remind me to talk about open source this is open valuing open",
    "start": "142000",
    "end": "149040"
  },
  {
    "text": "source is one of our custom companies core values we do have an open source version of influx db",
    "start": "149040",
    "end": "156319"
  },
  {
    "text": "we maintain a lot of open source projects the purpose of this talk it's important",
    "start": "156319",
    "end": "161519"
  },
  {
    "text": "because while many people use influx db to monitor their kubernetes",
    "start": "161519",
    "end": "167920"
  },
  {
    "text": "installations or their applications running there we do not see ourselves as a kubernetes tooling company",
    "start": "167920",
    "end": "174000"
  },
  {
    "text": "so what we really don't want to end up with is maintaining a set of bespoke kubernetes deployment tools",
    "start": "174000",
    "end": "181599"
  },
  {
    "text": "so we opt to try to find out like what's the most",
    "start": "181599",
    "end": "187519"
  },
  {
    "text": "supported in the existing open source community uh pick what matches our",
    "start": "187519",
    "end": "194080"
  },
  {
    "text": "use case the best and then if we do need to write custom code we prefer to do that code upstream within the projects",
    "start": "194080",
    "end": "201280"
  },
  {
    "text": "that we're using so um i will touch on some of the open source projects that we use",
    "start": "201280",
    "end": "207760"
  },
  {
    "text": "as we go okay so um the main product that i focus on",
    "start": "207760",
    "end": "214640"
  },
  {
    "text": "in my role is called influx db cloud informally we call it cloud two because",
    "start": "214640",
    "end": "221040"
  },
  {
    "text": "there was a cloud one product um cloud influx db cloud is",
    "start": "221040",
    "end": "226640"
  },
  {
    "text": "um a kubernetes application obviously obviously since it's got a database at",
    "start": "226640",
    "end": "232879"
  },
  {
    "text": "its heart it's uh very stateful so let me talk to you a bit about what cloud 2",
    "start": "232879",
    "end": "241439"
  },
  {
    "start": "237000",
    "end": "593000"
  },
  {
    "text": "looks like in production okay what and why this will build to why",
    "start": "241439",
    "end": "248239"
  },
  {
    "text": "git ops was a useful methodology for us so",
    "start": "248239",
    "end": "254959"
  },
  {
    "text": "cloud 2 is a fully sas data platform so it's like you sign up for an account",
    "start": "254959",
    "end": "262160"
  },
  {
    "text": "you don't have you don't host any servers yourself we do like all the server maintenance hosting",
    "start": "262160",
    "end": "268240"
  },
  {
    "text": "and everything but the thing about a database is there's this notion for customers like that their data has",
    "start": "268240",
    "end": "275120"
  },
  {
    "text": "gravity and by this we don't mean that in like a marketing sense",
    "start": "275120",
    "end": "280560"
  },
  {
    "text": "it's almost more literal than figurative",
    "start": "280560",
    "end": "285759"
  },
  {
    "text": "there data has gravity in the sense that if you have like terabytes of data it's very costly and slow",
    "start": "285759",
    "end": "293840"
  },
  {
    "text": "to move it between regions within a cloud or between clouds etc",
    "start": "293840",
    "end": "299360"
  },
  {
    "text": "so they really want their data services to be as close as possible to where they're",
    "start": "299360",
    "end": "304800"
  },
  {
    "text": "storing the data themselves so they're generating data in europe they want to be able to um",
    "start": "304800",
    "end": "311600"
  },
  {
    "text": "uh you know operate on their data in europe store it there operate it there they don't want to copy it to the u.s they're generating their",
    "start": "311600",
    "end": "318960"
  },
  {
    "text": "data in the u.s they want to be able to store it and operate it close to where",
    "start": "318960",
    "end": "324320"
  },
  {
    "text": "they're they're uh creating it there so",
    "start": "324320",
    "end": "329680"
  },
  {
    "text": "additionally um people like they may be generating",
    "start": "329680",
    "end": "334720"
  },
  {
    "text": "services with a one cloud provider so if they're you know",
    "start": "334720",
    "end": "339840"
  },
  {
    "text": "generating in aws or gcp or azure they want to be able to store the data within those cloud",
    "start": "339840",
    "end": "346800"
  },
  {
    "text": "providers so for these reasons we are multi-cloud and we're multi-region",
    "start": "346800",
    "end": "352240"
  },
  {
    "text": "right so when we operate cloud 2 or influx db cloud we are operating it",
    "start": "352240",
    "end": "358479"
  },
  {
    "text": "in multiple regions on multiple clouds additionally soon we are going to start providing",
    "start": "358479",
    "end": "365120"
  },
  {
    "text": "customers with private instances um and so in addition to all the public",
    "start": "365120",
    "end": "370800"
  },
  {
    "text": "instances that we have we'll have a collection of private instances that um",
    "start": "370800",
    "end": "378080"
  },
  {
    "text": "you that that will be available you know to customers in the region of their choosing on the cloud provider they're choosing so for",
    "start": "378080",
    "end": "384639"
  },
  {
    "text": "this reason very early in the project very early kubernetes was chosen",
    "start": "384639",
    "end": "390160"
  },
  {
    "text": "as the deployment as the the operating platform because it does provide",
    "start": "390160",
    "end": "397039"
  },
  {
    "text": "a cloud abstraction layer that really allows us to be multi-cloud",
    "start": "397039",
    "end": "404160"
  },
  {
    "text": "be multi-region have like all these different instances and have a sane way to operate all those",
    "start": "404160",
    "end": "410160"
  },
  {
    "text": "in production in a mission critical way",
    "start": "410160",
    "end": "415440"
  },
  {
    "text": "so um okay so we decided to go for git ups in order",
    "start": "415440",
    "end": "422800"
  },
  {
    "text": "to maintain our continuous deployment through all these areas",
    "start": "422800",
    "end": "428240"
  },
  {
    "text": "um and what i want to try to communicate here",
    "start": "428240",
    "end": "435199"
  },
  {
    "text": "is what what we mean by get up so there's various definitions i know that",
    "start": "435199",
    "end": "441680"
  },
  {
    "text": "the the term was coined very specifically by weave works but",
    "start": "441680",
    "end": "447280"
  },
  {
    "text": "like um i don't think they would disagree with this what we say like we're doing git ops or we set out to say",
    "start": "447280",
    "end": "453280"
  },
  {
    "text": "we're going to do good ops we'd say like we know we will have achieved it when these signifiers are true",
    "start": "453280",
    "end": "459120"
  },
  {
    "text": "so first that developers get code into production by landing in",
    "start": "459120",
    "end": "464400"
  },
  {
    "text": "the main branch right so once your code makes it through the gauntlet of code reviews and ci and gets merged",
    "start": "464400",
    "end": "472319"
  },
  {
    "text": "into the main branch automation takes over",
    "start": "472319",
    "end": "478000"
  },
  {
    "text": "and takes it from that git repository all the way into production so whatever",
    "start": "478000",
    "end": "484479"
  },
  {
    "text": "it takes to get into the main branch that's all it takes for the developer",
    "start": "484479",
    "end": "490080"
  },
  {
    "text": "to get that code out into production and then for us also infrastructure as",
    "start": "490080",
    "end": "495840"
  },
  {
    "text": "code should be delivered in the similar manner right so it's one thing to say i've changed a service i've changed the",
    "start": "495840",
    "end": "502160"
  },
  {
    "text": "code in the service and i've gotten that code",
    "start": "502160",
    "end": "507199"
  },
  {
    "text": "through a pull request into the main branch um what about the infrastructure itself",
    "start": "507199",
    "end": "513200"
  },
  {
    "text": "right like the kubernetes infrastructure as well as the architecture of the application",
    "start": "513200",
    "end": "519360"
  },
  {
    "text": "all of that should be delivered in a similar manner so if i",
    "start": "519360",
    "end": "525600"
  },
  {
    "text": "for us a key signifier of doing git ops is that in order to change the infrastructure",
    "start": "525600",
    "end": "532480"
  },
  {
    "text": "of your um application or your kubernetes cluster itself that again is done via",
    "start": "532480",
    "end": "540080"
  },
  {
    "text": "a code check-in into a git repository and then finally is the notion of",
    "start": "540080",
    "end": "545920"
  },
  {
    "text": "testing and production right what that means is that you have a facility in place where developers can",
    "start": "545920",
    "end": "551760"
  },
  {
    "text": "get their code in the main branch even if it is not currently ready for users",
    "start": "551760",
    "end": "557279"
  },
  {
    "text": "it can still be in production just not available to users in production or only",
    "start": "557279",
    "end": "562560"
  },
  {
    "text": "selectively users selectively available to users in production",
    "start": "562560",
    "end": "567839"
  },
  {
    "text": "and this is important because uh you want to we want to keep up a pace where people",
    "start": "567839",
    "end": "574399"
  },
  {
    "text": "are just constantly getting their code into the main branch and we never have big events where we're trying to",
    "start": "574399",
    "end": "582080"
  },
  {
    "text": "like you know integrate a lot of code all at once so these are the three signifiers that we set out for ourselves",
    "start": "582080",
    "end": "587839"
  },
  {
    "text": "and i'll refer back to this um a bit later in the discussion",
    "start": "587839",
    "end": "594240"
  },
  {
    "text": "okay so um now uh i'm going to talk i'm going to",
    "start": "594240",
    "end": "600959"
  },
  {
    "text": "show some diagrams about the way that that we visualize get",
    "start": "600959",
    "end": "606399"
  },
  {
    "text": "up so before i do i want to say like part of our company culture",
    "start": "606399",
    "end": "612000"
  },
  {
    "text": "is really about like transparency and learning so when you like see these diagrams they",
    "start": "612000",
    "end": "617600"
  },
  {
    "text": "will look like you know rainbows and unicorns and butterflies but there's",
    "start": "617600",
    "end": "624880"
  },
  {
    "text": "actually a lot of blood sweat and tears that want to get into that state there's a lot of complexity that's",
    "start": "624880",
    "end": "630320"
  },
  {
    "text": "hidden by the simplicity of the diagrams um so uh",
    "start": "630320",
    "end": "637360"
  },
  {
    "text": "i'll try to touch on some of the things like a lot of times you'll go through a presentation like this and you'll like",
    "start": "637360",
    "end": "644079"
  },
  {
    "text": "leave thinking like wow like those engineers like they really like have it together that's amazing but",
    "start": "644079",
    "end": "651200"
  },
  {
    "text": "then like when you actually join the team you see like that it's actually a different story that it's like actually really hard to do what they're doing",
    "start": "651200",
    "end": "657440"
  },
  {
    "text": "so i'm going to try as much as possible to give like a more realistic viewpoint of what doing kidops is like",
    "start": "657440",
    "end": "665200"
  },
  {
    "text": "okay so this as i said is our idealized diagram and",
    "start": "665200",
    "end": "672880"
  },
  {
    "text": "this is an idealized view of our overall environment and so i'll just walk you through it real quick so imagine i changed to",
    "start": "672880",
    "end": "679600"
  },
  {
    "text": "service okay so here's some code that i wrote",
    "start": "679600",
    "end": "684640"
  },
  {
    "text": "and i do a pr to the main branch here and then our ci system this is actually",
    "start": "684640",
    "end": "690160"
  },
  {
    "text": "like way more complicated right because of course ci like you do a pr the ci system doesn't put it",
    "start": "690160",
    "end": "695920"
  },
  {
    "text": "actually allow it the pr to complete before the ci is completed so what ci does",
    "start": "695920",
    "end": "702240"
  },
  {
    "text": "is not just runs tests and integrates the code but it also builds containers tests the",
    "start": "702240",
    "end": "707920"
  },
  {
    "text": "containers and in the case that the containers pass everything and appear to be ready to go the ci",
    "start": "707920",
    "end": "715279"
  },
  {
    "text": "system will then update our configuration code which happens to be jsonnet and i'll talk",
    "start": "715279",
    "end": "720560"
  },
  {
    "text": "about more about later to say hey the kubernetes cluster",
    "start": "720560",
    "end": "726320"
  },
  {
    "text": "the application should now point to this new container for this service right and then",
    "start": "726320",
    "end": "734160"
  },
  {
    "text": "that configuration gets updated automatically by the ci system and then we have what we call waves of",
    "start": "734160",
    "end": "742800"
  },
  {
    "text": "deployment so the first thing is argo detects like hey the configuration code for",
    "start": "742800",
    "end": "750240"
  },
  {
    "text": "the uh staging environment has been updated oops sorry hold on the uh",
    "start": "750240",
    "end": "757600"
  },
  {
    "text": "the configuration for the staging environment has been updated let me tell kubernetes to apply",
    "start": "757600",
    "end": "765120"
  },
  {
    "text": "that those changes once those changes are applied we run some tests here right so these",
    "start": "765120",
    "end": "771519"
  },
  {
    "text": "are like automatically run by argo workflow if that works then the kubernetes",
    "start": "771519",
    "end": "777839"
  },
  {
    "text": "configuration for the next wave uh is updated and it rolls out to what we",
    "start": "777839",
    "end": "784639"
  },
  {
    "text": "call internal production informally internally we call it tools the reason we call it internal",
    "start": "784639",
    "end": "790000"
  },
  {
    "text": "production is because only we have access to it",
    "start": "790000",
    "end": "795279"
  },
  {
    "text": "but it's where we do all the monitoring for everything so when any whenever there's any hiccup",
    "start": "795360",
    "end": "801600"
  },
  {
    "text": "in tools we treat it as a full-blown production event right because if like our",
    "start": "801600",
    "end": "806880"
  },
  {
    "text": "our internal production environment is um is not operating optimally then",
    "start": "806880",
    "end": "813839"
  },
  {
    "text": "potentially our monitoring of the external productions is not optimal so we",
    "start": "813839",
    "end": "820959"
  },
  {
    "text": "you know that's why we use the term production in it because like we treat it fully as a production environment again",
    "start": "821120",
    "end": "829040"
  },
  {
    "text": "we run some smoke tests here if those pass then we update the environments",
    "start": "829040",
    "end": "834959"
  },
  {
    "text": "for all of the external production external production are all the kubernetes clusters and um",
    "start": "834959",
    "end": "842800"
  },
  {
    "text": "and uh um instances of the application that end users use that customers use",
    "start": "842800",
    "end": "850880"
  },
  {
    "text": "externally okay so there's some like caveats and some more details that",
    "start": "850880",
    "end": "856320"
  },
  {
    "text": "i want to cover in this part so first um when we update the code it's",
    "start": "856320",
    "end": "863680"
  },
  {
    "text": "very like easy it was easy to write you know tooling and a workflow that would do these waves",
    "start": "863680",
    "end": "870079"
  },
  {
    "text": "it's much harder with the configuration right because like the code when we update the code it says hey",
    "start": "870079",
    "end": "877040"
  },
  {
    "text": "configuration can you please update this uh you know new um uh",
    "start": "877040",
    "end": "884720"
  },
  {
    "text": "update to the new uh hash of the container but what if we're like",
    "start": "884720",
    "end": "891120"
  },
  {
    "text": "changing part of the architecture like we're changing like we're scaling something out or or whatever we do check that in as code",
    "start": "891120",
    "end": "898320"
  },
  {
    "text": "but we don't really these wave options we actually have to do manually if we do it often we don't we'll just like just like",
    "start": "898320",
    "end": "905040"
  },
  {
    "text": "change everything all at once usually usually that's fine but if we have to be careful",
    "start": "905040",
    "end": "910560"
  },
  {
    "text": "we still don't have automated a way to like go through these ways if it's a con if there's no code change but it's just",
    "start": "910560",
    "end": "917120"
  },
  {
    "text": "config okay i want to touch on the staging environment and i'll touch on this later",
    "start": "917120",
    "end": "923120"
  },
  {
    "text": "as well we still have a lot of conversations internally about staging um if you look at the literature like",
    "start": "923120",
    "end": "930160"
  },
  {
    "text": "what our thought process here is like okay we're going to land on these small instances that are much cheaper to run",
    "start": "930160",
    "end": "937759"
  },
  {
    "text": "they are not mission critical and we'll run tests on those and",
    "start": "937759",
    "end": "943759"
  },
  {
    "text": "therefore we will have like a way of getting confidence that the change that's being rolled out",
    "start": "943759",
    "end": "951680"
  },
  {
    "text": "is um free of flaws right and it makes makes a lot",
    "start": "951680",
    "end": "958160"
  },
  {
    "text": "of sense but if you look at the literature the devops literature a lot of people will tell you like",
    "start": "958160",
    "end": "964079"
  },
  {
    "text": "you're just you're dreaming if you think staging is going to help you in that way because staging will never be configured",
    "start": "964079",
    "end": "969759"
  },
  {
    "text": "the same and it'll never get the same load so we still have a lot of internal discussions about",
    "start": "969759",
    "end": "976800"
  },
  {
    "text": "whether we should even have the staging environment or not for the time being it's working",
    "start": "976800",
    "end": "982560"
  },
  {
    "text": "for us more than i think it's hurting us so we're not feeling a lot of uh",
    "start": "982560",
    "end": "987600"
  },
  {
    "text": "pressure to change but it's something to keep in mind and i'll touch on it",
    "start": "987600",
    "end": "992880"
  },
  {
    "text": "a little bit later also um so these this is we call this actually",
    "start": "992880",
    "end": "999440"
  },
  {
    "text": "the automated feedback loop um to set up a way that like we can deploy to a wave",
    "start": "999440",
    "end": "1004880"
  },
  {
    "text": "either here or here actually we do it down here too but since this is the end of the line",
    "start": "1004880",
    "end": "1010720"
  },
  {
    "text": "there's uh there's no way to like it's good to know that there was a problem but there's no way to block the next",
    "start": "1010720",
    "end": "1016560"
  },
  {
    "text": "wave since there is no next wave but uh right now this is a set of smoke tests",
    "start": "1016560",
    "end": "1021839"
  },
  {
    "text": "um we're not using any of the monitoring and alerting that i'm talking about yet to be part of that",
    "start": "1021839",
    "end": "1029280"
  },
  {
    "text": "automated feedback loop but i'll i have some slides later where we can go into a little bit",
    "start": "1029280",
    "end": "1035360"
  },
  {
    "text": "more detail on that on those concepts",
    "start": "1035360",
    "end": "1040480"
  },
  {
    "text": "okay just in terms of like uh my comment about rainbows and unicorns and butterflies",
    "start": "1040880",
    "end": "1047760"
  },
  {
    "text": "don't look at this it's super ugly it's totally out of date but this is really",
    "start": "1047760",
    "end": "1052799"
  },
  {
    "text": "if you start to really unpack everything that's going on in that internalized view you'll see a lot more",
    "start": "1052799",
    "end": "1058080"
  },
  {
    "text": "components come into play and a lot more complexity so",
    "start": "1058080",
    "end": "1063200"
  },
  {
    "text": "while i conceptually you can represent a git ops workflow in a pretty simple way if you really",
    "start": "1063200",
    "end": "1068799"
  },
  {
    "text": "start to like you know pull you know dive into it and pull off",
    "start": "1068799",
    "end": "1074720"
  },
  {
    "text": "the pieces you can see it gets rather rather complex",
    "start": "1074720",
    "end": "1080799"
  },
  {
    "start": "1079000",
    "end": "1365000"
  },
  {
    "text": "so um well after we went through like all the effort to get to that state",
    "start": "1080799",
    "end": "1086480"
  },
  {
    "text": "that i just um just explained",
    "start": "1086480",
    "end": "1092000"
  },
  {
    "text": "um we started to see some like really clear benefits first was",
    "start": "1092000",
    "end": "1098160"
  },
  {
    "text": "like like logical we were just shocked about how powerful it was it was just the amount",
    "start": "1098160",
    "end": "1104240"
  },
  {
    "text": "of time that developers got back because they were not working on release process",
    "start": "1104240",
    "end": "1110799"
  },
  {
    "text": "right like like every day when like code was at a logical stopping point",
    "start": "1110799",
    "end": "1116320"
  },
  {
    "text": "they made a pull request and that was it so there was no effort to like",
    "start": "1116320",
    "end": "1123280"
  },
  {
    "text": "batch up releases babysit releases define a release there's no idea of",
    "start": "1123280",
    "end": "1129600"
  },
  {
    "text": "pushing a release you know just like developers can just like let it go",
    "start": "1129600",
    "end": "1134720"
  },
  {
    "text": "and um that gave them a lot a lot more time to",
    "start": "1134720",
    "end": "1140480"
  },
  {
    "text": "develop um similarly uh",
    "start": "1140480",
    "end": "1145760"
  },
  {
    "text": "and maybe counter-intuitively for some people like our incidences our rate of",
    "start": "1145760",
    "end": "1152480"
  },
  {
    "text": "incidence in production went down like dramatically as soon as we started",
    "start": "1152480",
    "end": "1159120"
  },
  {
    "text": "to automate the deployments through get ops",
    "start": "1159120",
    "end": "1164480"
  },
  {
    "text": "we think that there's like two like we went we looked at like our incident um rcas and everything",
    "start": "1164480",
    "end": "1172320"
  },
  {
    "text": "the two main contributors to the decreasing incidents was first um there were just",
    "start": "1172320",
    "end": "1179600"
  },
  {
    "text": "many fewer complicated releases like the changes since we were you know rolling out",
    "start": "1179600",
    "end": "1185760"
  },
  {
    "text": "changes like today we do changes like deploy like probably like three to five times on a",
    "start": "1185760",
    "end": "1193360"
  },
  {
    "text": "typical day um maybe more on some days um",
    "start": "1193360",
    "end": "1199280"
  },
  {
    "text": "that meant like the the changes were like much smaller that were going out and so their ability those changes",
    "start": "1199280",
    "end": "1205760"
  },
  {
    "text": "ability to have a big impact was reduced those was like very obvious what caused the problems that",
    "start": "1205760",
    "end": "1211280"
  },
  {
    "text": "the problem went out so like smaller easier to diagnose problems but also um we did learn in one case",
    "start": "1211280",
    "end": "1218880"
  },
  {
    "text": "it's possible like since we have a computer program rolling out the",
    "start": "1218880",
    "end": "1224159"
  },
  {
    "text": "changes to make errors on a much bigger scale but um it's much easier to recover from",
    "start": "1224159",
    "end": "1230240"
  },
  {
    "text": "those errors and in fact there's just the reduction in errors caused by humans doing",
    "start": "1230240",
    "end": "1236720"
  },
  {
    "text": "deployments was just a really dramatic improvement for our robustness and",
    "start": "1236720",
    "end": "1242400"
  },
  {
    "text": "availability you know just like a computer program doesn't forget to do something uh",
    "start": "1242400",
    "end": "1249039"
  },
  {
    "text": "um a computer program does things in the order that it's was told so um",
    "start": "1249039",
    "end": "1254890"
  },
  {
    "text": "[Music] so that was like you know just really those two things just a decrease in",
    "start": "1254890",
    "end": "1260400"
  },
  {
    "text": "working on release process and the fewer incidents really immediately added",
    "start": "1260400",
    "end": "1267360"
  },
  {
    "text": "a lot to just the the quality of life for the developers on our team okay",
    "start": "1267360",
    "end": "1275360"
  },
  {
    "text": "also like you know one of our tasks is to add more regions um you know the customer wants to work",
    "start": "1275360",
    "end": "1282080"
  },
  {
    "text": "in region foo um since everything is automated",
    "start": "1282080",
    "end": "1287600"
  },
  {
    "text": "um everything is captured all the configuration is code like all we have to do is just set up",
    "start": "1287600",
    "end": "1294159"
  },
  {
    "text": "some files to define a region and then our existing tooling",
    "start": "1294159",
    "end": "1299200"
  },
  {
    "text": "automatically will roll out to that region and so you know it's like a single digit day",
    "start": "1299200",
    "end": "1307679"
  },
  {
    "text": "process from beginning to end honestly the thing that takes us the longest now in rolling out regions is just",
    "start": "1307679",
    "end": "1314880"
  },
  {
    "text": "getting the the machines from the cloud service providers you know um uh",
    "start": "1314880",
    "end": "1322080"
  },
  {
    "text": "another thing just in terms of everything is just because what's now what's in",
    "start": "1322080",
    "end": "1329120"
  },
  {
    "text": "master or what's in the main branch is either in production or on its way to production just",
    "start": "1329120",
    "end": "1336080"
  },
  {
    "text": "everything is easier just so much easier to reason about everything because if you want to know what's running",
    "start": "1336080",
    "end": "1342720"
  },
  {
    "text": "anywhere like it's it's just obvious right so there's no",
    "start": "1342720",
    "end": "1347760"
  },
  {
    "text": "there's no like dipping between the different environments different between a production environment and and the code",
    "start": "1347760",
    "end": "1354559"
  },
  {
    "text": "um uh so like that also has been like uh just an",
    "start": "1354559",
    "end": "1360880"
  },
  {
    "text": "improvement to our robustness there okay so now",
    "start": "1360880",
    "end": "1368559"
  },
  {
    "text": "this part is a little bit more for leaders or managers right so i'm imagining like you're like wow",
    "start": "1368559",
    "end": "1375039"
  },
  {
    "text": "i want those i want those unicorns and i want those rainbows so now this is just a little bit about",
    "start": "1375039",
    "end": "1380720"
  },
  {
    "text": "like how how to get there from um an engineering management point of view",
    "start": "1380720",
    "end": "1389440"
  },
  {
    "start": "1388000",
    "end": "1698000"
  },
  {
    "text": "okay so we broke it down to kind of like required elements like this is a bit retrospective like",
    "start": "1389440",
    "end": "1395120"
  },
  {
    "text": "what was required versus like what were some optional components so obviously you need a ci pipeline to",
    "start": "1395120",
    "end": "1402799"
  },
  {
    "text": "build artifacts and to run all the tests and everything if currently today your deployment",
    "start": "1402799",
    "end": "1409600"
  },
  {
    "text": "pipeline involves developers building containers themselves",
    "start": "1409600",
    "end": "1415440"
  },
  {
    "text": "like then you're like that's like a really first problem to fix like you just you",
    "start": "1415440",
    "end": "1422159"
  },
  {
    "text": "if like your developers are building containers and then pushing them into production then you're simply not going to be able",
    "start": "1422159",
    "end": "1427600"
  },
  {
    "text": "to rely on automation around your git repository",
    "start": "1427600",
    "end": "1433039"
  },
  {
    "text": "to make sure that happens again you need a way to represent your",
    "start": "1433039",
    "end": "1440240"
  },
  {
    "text": "infrastructure as code for the application itself we use",
    "start": "1440240",
    "end": "1445279"
  },
  {
    "text": "jsonnet for this um as an aside we use um terraform for",
    "start": "1445279",
    "end": "1450640"
  },
  {
    "text": "the kubernetes clusters themselves but um we use jsonnet and i'll show you",
    "start": "1450640",
    "end": "1457520"
  },
  {
    "text": "a little bit about why we use json it why it's beneficial for us but the combination of json and cube cfg makes it really easy",
    "start": "1457520",
    "end": "1465520"
  },
  {
    "text": "for us to represent the infrastructure's code in a multi-cloud",
    "start": "1465520",
    "end": "1471360"
  },
  {
    "text": "scenario um you need a way to deploy kubernetes configuration right so once",
    "start": "1471360",
    "end": "1476960"
  },
  {
    "text": "the configuration changes and git you need something that knows how to tell",
    "start": "1476960",
    "end": "1482880"
  },
  {
    "text": "um your kubernetes cluster like make the application look like what's in git we use argo for that um one thing",
    "start": "1482880",
    "end": "1492559"
  },
  {
    "text": "that you like really need to do is make sure that your deployment pipeline is fast and this is actually an",
    "start": "1492559",
    "end": "1499120"
  },
  {
    "text": "area where we right now i have mixed success um",
    "start": "1499120",
    "end": "1504480"
  },
  {
    "text": "if you're the one of the things about like deploying to kubernetes and i'll talk about this a little bit later also",
    "start": "1504480",
    "end": "1511120"
  },
  {
    "text": "is like during deployments right there's containers coming and going and making",
    "start": "1511120",
    "end": "1516320"
  },
  {
    "text": "those deployments smooth is a lot of work right so um if you can imagine your services are the",
    "start": "1516320",
    "end": "1524159"
  },
  {
    "text": "containers are being killed and you know the pods are being replaced by kubernetes during the deployment",
    "start": "1524159",
    "end": "1531279"
  },
  {
    "text": "um there can be availability issues during that time so the faster it is the fewer of those",
    "start": "1531279",
    "end": "1539520"
  },
  {
    "text": "problems that that you might run into additionally",
    "start": "1539520",
    "end": "1544720"
  },
  {
    "text": "um if you think about just recovering right like so hey",
    "start": "1544720",
    "end": "1550799"
  },
  {
    "text": "there's a problem like so for instance any problems in our ui tier we can roll back",
    "start": "1550799",
    "end": "1556960"
  },
  {
    "text": "and within a matter of minutes we're back to the old ui assuming that you know it was a",
    "start": "1556960",
    "end": "1562799"
  },
  {
    "text": "reasonably uncomplicated deployment because that deployment pipeline is fast we have a lot of confidence because it's",
    "start": "1562799",
    "end": "1568559"
  },
  {
    "text": "really easy to recover there's other areas of the product where the deployments are a bit more",
    "start": "1568559",
    "end": "1573679"
  },
  {
    "text": "complicated this may affect us more than it'll affect most people because we are a database or stateful",
    "start": "1573679",
    "end": "1580000"
  },
  {
    "text": "but managing those um like statements of the deployments we",
    "start": "1580000",
    "end": "1586320"
  },
  {
    "text": "we do have some work to do to make that faster um but our deployments are fast enough",
    "start": "1586320",
    "end": "1593520"
  },
  {
    "text": "if your deployments are very slow um you may find [Music]",
    "start": "1593520",
    "end": "1598559"
  },
  {
    "text": "that get ops is is um [Music] a bit problematic um because for us one",
    "start": "1598559",
    "end": "1606080"
  },
  {
    "text": "of the important signifiers is that you're keeping all your code in the main branch even if it's not ready for users you",
    "start": "1606080",
    "end": "1612880"
  },
  {
    "text": "need some some way of feature flagging now we actually started feature flagging",
    "start": "1612880",
    "end": "1618000"
  },
  {
    "text": "without any kind of service so when we started with it it was just totally manual",
    "start": "1618000",
    "end": "1624320"
  },
  {
    "text": "currently we use the configcat service um of it a service like configcat or there's",
    "start": "1624799",
    "end": "1629840"
  },
  {
    "text": "you know plenty of other ones like uh they offer a lot of value in terms of um using feature flags like",
    "start": "1629840",
    "end": "1637360"
  },
  {
    "text": "for product managers to be able to send you know specific users to try new features and things",
    "start": "1637360",
    "end": "1643919"
  },
  {
    "text": "and then of course most importantly you must must have production metrics and especially reliable",
    "start": "1643919",
    "end": "1649279"
  },
  {
    "text": "alerts right so if like your developers are going to make a pull request into",
    "start": "1649279",
    "end": "1655120"
  },
  {
    "text": "the main branch and then that's done it was accepted my job is done and turn their attention elsewhere they",
    "start": "1655120",
    "end": "1662000"
  },
  {
    "text": "cannot do this with confidence unless they know if there is a problem they will be alerted",
    "start": "1662000",
    "end": "1667679"
  },
  {
    "text": "otherwise they will make a pull request and then stare at a screen until they're confident that the um",
    "start": "1667679",
    "end": "1675279"
  },
  {
    "text": "that uh there was no problem and making a screen that gives you that confidence",
    "start": "1675279",
    "end": "1680480"
  },
  {
    "text": "is actually um harder than it sounds because a lot more can go wrong than what you predict",
    "start": "1680480",
    "end": "1686159"
  },
  {
    "text": "so reliable production metrics and alerts is really one of the core things that",
    "start": "1686159",
    "end": "1691360"
  },
  {
    "text": "you need to build to build in and i'll talk about how we did that bit",
    "start": "1691360",
    "end": "1696880"
  },
  {
    "text": "so there's some components that we believe are optional",
    "start": "1696880",
    "end": "1703760"
  },
  {
    "start": "1698000",
    "end": "1870000"
  },
  {
    "text": "and some of them may be surprising that we consider them optional so for instance the automated feedback",
    "start": "1703760",
    "end": "1709279"
  },
  {
    "text": "loop we actually switched to get ops and doing",
    "start": "1709279",
    "end": "1714559"
  },
  {
    "text": "continuous deployments without any automated feedback loop so there was no way for us to like stop a",
    "start": "1714559",
    "end": "1722840"
  },
  {
    "text": "deployment uh in between waves when we first started but we had so much wind just by having",
    "start": "1722840",
    "end": "1731120"
  },
  {
    "text": "it automated that like that um that it was worth it for us now we do",
    "start": "1731120",
    "end": "1738640"
  },
  {
    "text": "have automated feedback loops and we do have deployment waves and we are um",
    "start": "1738640",
    "end": "1744399"
  },
  {
    "text": "improving that process as we go um another optional thing is like we call",
    "start": "1744399",
    "end": "1750159"
  },
  {
    "text": "it the pipeline for high-level operations an example of a high-level opera",
    "start": "1750159",
    "end": "1755760"
  },
  {
    "text": "operation is like running a set of tests after you do a deployment we use argo workflow for that",
    "start": "1755760",
    "end": "1763120"
  },
  {
    "text": "canary deployments this is actually a next step for us of being able to do canary deployments",
    "start": "1763120",
    "end": "1769360"
  },
  {
    "text": "um a lot of people um i don't know there's",
    "start": "1769360",
    "end": "1775760"
  },
  {
    "text": "differing opinions in the literature about the value of canary deployments versus other kind of deployment",
    "start": "1775760",
    "end": "1781360"
  },
  {
    "text": "methodologies um [Music] but we found [Music]",
    "start": "1781360",
    "end": "1787200"
  },
  {
    "text": "that uh we got so much value from git ops without it that we actually deferred implementing it and now",
    "start": "1787200",
    "end": "1793120"
  },
  {
    "text": "we're starting to work on that another optional but really desirable",
    "start": "1793120",
    "end": "1798640"
  },
  {
    "text": "piece something that really added a lot of value to us um is this um concept that we call",
    "start": "1798640",
    "end": "1805039"
  },
  {
    "text": "external availability validation so we ended up like saying like what is",
    "start": "1805039",
    "end": "1811200"
  },
  {
    "text": "the user's view of availability right so we're developing we're getting all these metrics from inside the system and we can see",
    "start": "1811200",
    "end": "1818799"
  },
  {
    "text": "like how many users are getting 503s and or you know 400s and that kind of",
    "start": "1818799",
    "end": "1825760"
  },
  {
    "text": "thing and but what we found was really valuable is actually running some processes from outside",
    "start": "1825760",
    "end": "1833679"
  },
  {
    "text": "that just use the api and just measure like how many um how successful",
    "start": "1833679",
    "end": "1840960"
  },
  {
    "text": "they are i'll talk about that in a bit but that was a really useful sort of rallying point for the",
    "start": "1840960",
    "end": "1847919"
  },
  {
    "text": "team so we call it external availability validation and then finally i already touched on this concept of",
    "start": "1847919",
    "end": "1853360"
  },
  {
    "text": "testing or or acceptance environments we consider it optional like a lot of people in the literature",
    "start": "1853360",
    "end": "1859919"
  },
  {
    "text": "consider it an absolute anti-pattern so i won't take a stance on that",
    "start": "1859919",
    "end": "1865440"
  },
  {
    "text": "um but um i always find an interesting conversation",
    "start": "1865440",
    "end": "1871679"
  },
  {
    "start": "1870000",
    "end": "2024000"
  },
  {
    "text": "okay so i wanted to touch a little bit on like i mentioned json and like why we like json so what is",
    "start": "1871679",
    "end": "1877360"
  },
  {
    "text": "jsonic so jsonnet is a superset of json and",
    "start": "1877360",
    "end": "1883039"
  },
  {
    "text": "it's designed to allow you to overlay",
    "start": "1883039",
    "end": "1890240"
  },
  {
    "text": "configurations on top of other configurations this is very very useful for us because",
    "start": "1890240",
    "end": "1895679"
  },
  {
    "text": "we have a base configuration for our application and then we can overlay uh",
    "start": "1895679",
    "end": "1901760"
  },
  {
    "text": "specializations for the different cloud environments or even the different regions you know if one region is utilized much more we",
    "start": "1901760",
    "end": "1908399"
  },
  {
    "text": "may we may uh specialize the configuration it allows us to maintain all of that",
    "start": "1908399",
    "end": "1914320"
  },
  {
    "text": "configuration as code but in a very sane way and so just how that roughly works is if you",
    "start": "1914320",
    "end": "1920320"
  },
  {
    "text": "see here like here's a this is a contrived example of base configuration",
    "start": "1920320",
    "end": "1926080"
  },
  {
    "text": "and the main thing to look at here is it um describes replicas and it says one",
    "start": "1926080",
    "end": "1932840"
  },
  {
    "text": "replica etc then we say okay that's fine for the base configuration but we need to do",
    "start": "1932840",
    "end": "1938080"
  },
  {
    "text": "something different in aws in aws we need four replicas and furthermore",
    "start": "1938080",
    "end": "1945679"
  },
  {
    "text": "we need to add some uh some limit requests here you need some limits",
    "start": "1945679",
    "end": "1951039"
  },
  {
    "text": "so okay so this then this tool",
    "start": "1951039",
    "end": "1956240"
  },
  {
    "text": "called cube cfg then can take these two things and output yaml",
    "start": "1956240",
    "end": "1961760"
  },
  {
    "text": "and so you can see in this yaml this would be the yaml for the aws prod",
    "start": "1961760",
    "end": "1967120"
  },
  {
    "text": "which you can see has all of this content plus these overlaid different content",
    "start": "1967120",
    "end": "1974640"
  },
  {
    "text": "here and in this way we can have sanity for maintaining all these different",
    "start": "1974640",
    "end": "1980000"
  },
  {
    "text": "regions so what happens is that the cube config tool will cause more",
    "start": "1980000",
    "end": "1985519"
  },
  {
    "text": "yaml to be output will we will automatically check that output",
    "start": "1985519",
    "end": "1992240"
  },
  {
    "text": "of gml back into git and so that change in get is what tells argo hey there's been a",
    "start": "1992240",
    "end": "1999200"
  },
  {
    "text": "change to the uh configuration let me roll that configuration out to",
    "start": "1999200",
    "end": "2006159"
  },
  {
    "text": "production okay so there's other ways of doing this there are other projects this we've just",
    "start": "2006159",
    "end": "2013039"
  },
  {
    "text": "found this uh to be um",
    "start": "2013039",
    "end": "2018398"
  },
  {
    "text": "just work really well for us conceptually as well as in practice",
    "start": "2019120",
    "end": "2025760"
  },
  {
    "start": "2024000",
    "end": "2256000"
  },
  {
    "text": "okay so i want to touch on something this may not be related to everybody",
    "start": "2025760",
    "end": "2032159"
  },
  {
    "text": "but for us it turned out what we call super smooth deployments was was super important so for our users",
    "start": "2032159",
    "end": "2040399"
  },
  {
    "text": "it turned out they had a very very high expectations for availability of their api calls like",
    "start": "2040399",
    "end": "2047440"
  },
  {
    "text": "as soon as it falls below 5 9 it's like they feel like ah i got a error in my api call",
    "start": "2047440",
    "end": "2053760"
  },
  {
    "text": "this week i got one this week like you know that to them is too much right so um",
    "start": "2053760",
    "end": "2060960"
  },
  {
    "text": "but as i mentioned before like deployments themselves cause pods to restart and so",
    "start": "2060960",
    "end": "2068800"
  },
  {
    "text": "um or to get killed and be replaced right so frequent",
    "start": "2068800",
    "end": "2075040"
  },
  {
    "text": "deployments cause frequent pod restarts",
    "start": "2075040",
    "end": "2080480"
  },
  {
    "text": "that can cause um you know users to experience poor availability",
    "start": "2080480",
    "end": "2088000"
  },
  {
    "text": "or at least the perceived availability from their point of view because if you imagine you know",
    "start": "2088000",
    "end": "2093118"
  },
  {
    "text": "like if you make a request through the gateway front end it goes to the compute tier it goes to the storage tier",
    "start": "2093119",
    "end": "2099200"
  },
  {
    "text": "and then all the way back and back out to the user and like pods can be restarted anywhere",
    "start": "2099200",
    "end": "2104720"
  },
  {
    "text": "in that chain during that that time period um like any you know one call can you know",
    "start": "2104720",
    "end": "2113599"
  },
  {
    "text": "any one failure during a deployment there can cause the user to get back hey i was unavailable you know um",
    "start": "2113599",
    "end": "2121599"
  },
  {
    "text": "so we put in actually a lot of effort in our custom controllers i did i",
    "start": "2121599",
    "end": "2127280"
  },
  {
    "text": "asked like a lot of trusted advisors people who have been in the kubernetes",
    "start": "2127280",
    "end": "2134240"
  },
  {
    "text": "project from the beginning some did not answer me some some answered me with just like",
    "start": "2134240",
    "end": "2141359"
  },
  {
    "text": "yeah that's really hard but we did get some really good advice um besides using the custom controller",
    "start": "2141359",
    "end": "2148720"
  },
  {
    "text": "that our contrast our custom controller code ensures pop proper ordering of",
    "start": "2148720",
    "end": "2154960"
  },
  {
    "text": "everything um uh so we had to invest a lot in that",
    "start": "2154960",
    "end": "2160320"
  },
  {
    "text": "uh to really make sure that like during the deployment process you know the load balancer the gateway",
    "start": "2160320",
    "end": "2167040"
  },
  {
    "text": "the computer all of that was shut down and re you know um like the connections drained",
    "start": "2167040",
    "end": "2172960"
  },
  {
    "text": "and everything like in exactly the right order in the right amount of time before istio gave up and just shut",
    "start": "2172960",
    "end": "2179280"
  },
  {
    "text": "everything down by itself etc so um a lot of custom code there but one of",
    "start": "2179280",
    "end": "2184320"
  },
  {
    "text": "the main things was uh you know like what i call like b1 with the retries right so if a pod gets restarted",
    "start": "2184320",
    "end": "2192640"
  },
  {
    "text": "by a deployment it will return of something in the 500 area like a 503 which means like",
    "start": "2192640",
    "end": "2199280"
  },
  {
    "text": "the server was unavailable for that call can you please try again right so we had you have a lot of code",
    "start": "2199280",
    "end": "2205839"
  },
  {
    "text": "then to just like do a retry between the tiers if you got that we",
    "start": "2205839",
    "end": "2210880"
  },
  {
    "text": "have an extra challenge though because if you're working with a database",
    "start": "2210880",
    "end": "2216320"
  },
  {
    "text": "many of the requests can have side effects right so you can't just blindly retry",
    "start": "2216320",
    "end": "2222720"
  },
  {
    "text": "something that has side effects so there's many cases where we can't just",
    "start": "2222720",
    "end": "2228160"
  },
  {
    "text": "retry for the solution but you know that's where our custom controller code comes in now most people that i talk to who are",
    "start": "2228160",
    "end": "2234960"
  },
  {
    "text": "using kubernetes they simply do not have these high requirements",
    "start": "2234960",
    "end": "2240079"
  },
  {
    "text": "for availability so like they don't most most of my friends in the in the",
    "start": "2240079",
    "end": "2245359"
  },
  {
    "text": "who are using kubernetes like don't really relate to like to this level of um",
    "start": "2245359",
    "end": "2252400"
  },
  {
    "text": "of pressure to keep the deployment smooth okay moving on okay so now um",
    "start": "2252400",
    "end": "2260800"
  },
  {
    "start": "2256000",
    "end": "2398000"
  },
  {
    "text": "uh i want to talk a bit about how we do get metrics",
    "start": "2260800",
    "end": "2266000"
  },
  {
    "text": "so we gather all of the metrics from kubernetes um",
    "start": "2266000",
    "end": "2271119"
  },
  {
    "text": "uh cluster with telegraph uh telegraph it's a it's an agent",
    "start": "2271119",
    "end": "2277520"
  },
  {
    "text": "for collecting metrics it's got many many input plugins and a few output plug-ins",
    "start": "2277520",
    "end": "2284960"
  },
  {
    "text": "of course the main output plug-in being influx db that's because this is an open source",
    "start": "2284960",
    "end": "2290000"
  },
  {
    "text": "project telegraph is designed to be run as an agent to be run as a server",
    "start": "2290000",
    "end": "2296400"
  },
  {
    "text": "it's designed to be run on command it's designed to be uh run with um long lasting connections",
    "start": "2296400",
    "end": "2304880"
  },
  {
    "text": "it's a very useful piece of software just for transparency",
    "start": "2304880",
    "end": "2310480"
  },
  {
    "text": "influx data the company we are the primary um maintainers of it and it's within our",
    "start": "2310480",
    "end": "2317280"
  },
  {
    "text": "um it's in within our repositories but there's quite a big community around telegraph and there are output plug-ins",
    "start": "2317280",
    "end": "2324240"
  },
  {
    "text": "for many other um uh targets you know like",
    "start": "2324240",
    "end": "2331599"
  },
  {
    "text": "i know like azure aws a bunch of other um companies that made uh plugins for it",
    "start": "2331599",
    "end": "2337359"
  },
  {
    "text": "so we use it we like it because it's written entirely in go so we just get a single binary",
    "start": "2337359",
    "end": "2342880"
  },
  {
    "text": "which makes it easy for us to drop in as a sidecar into our pods so we have like telegraph there running",
    "start": "2342880",
    "end": "2348320"
  },
  {
    "text": "as a as a side car streaming metrics back we get a lot of metrics back like very a lot of",
    "start": "2348320",
    "end": "2355760"
  },
  {
    "text": "metrics so one thing we get is application specific metrics you know like the different applications",
    "start": "2355760",
    "end": "2361839"
  },
  {
    "text": "that we use off the shelf they have their own metrics that they um that they provide",
    "start": "2361839",
    "end": "2368640"
  },
  {
    "text": "but then we also write a lot of custom metrics like our services um uh write metrics out telegraph",
    "start": "2368640",
    "end": "2376320"
  },
  {
    "text": "um we we send those to telegraph and telegraph sends that back to our",
    "start": "2376320",
    "end": "2382160"
  },
  {
    "text": "monitoring instance and then um there's istio",
    "start": "2382160",
    "end": "2388240"
  },
  {
    "text": "and other services that are running those are also all providing metrics so telegraph we have it in just different places in",
    "start": "2388240",
    "end": "2393760"
  },
  {
    "text": "the cluster just streaming metrics back so how do you use metrics so",
    "start": "2393760",
    "end": "2398880"
  },
  {
    "start": "2398000",
    "end": "2527000"
  },
  {
    "text": "um there's a few areas where you like are important to use metrics in a",
    "start": "2398880",
    "end": "2405200"
  },
  {
    "text": "get ops scenario and the first is that you just need to get alerted on urgent issues",
    "start": "2405200",
    "end": "2412240"
  },
  {
    "text": "as i said you want your developers to make a pull request have the pull",
    "start": "2412240",
    "end": "2417839"
  },
  {
    "text": "request succeed and then be able to turn their attention somewhere but get alerted in the unlikely case",
    "start": "2417839",
    "end": "2423280"
  },
  {
    "text": "that something's gone wrong right so alerts on urgent issues that's the sort of the number one focus we found",
    "start": "2423280",
    "end": "2430160"
  },
  {
    "text": "that that was the most important work that we did um but second most important i would say",
    "start": "2430160",
    "end": "2437040"
  },
  {
    "text": "we're learning on leading indicators you know we found like hey if you know this these certain cues grow in length",
    "start": "2437040",
    "end": "2444640"
  },
  {
    "text": "or if the um latency between these you know services starts",
    "start": "2444640",
    "end": "2451359"
  },
  {
    "text": "to grow that's an indicator of an upcoming problem right and so like we have alerts",
    "start": "2451359",
    "end": "2456480"
  },
  {
    "text": "that tell us you know it looks like something's going to go wrong of course both of these it's very",
    "start": "2456480",
    "end": "2463040"
  },
  {
    "text": "dynamic because like when you like get these alerts of course you go in and you solve",
    "start": "2463040",
    "end": "2468880"
  },
  {
    "text": "the core problems but then you need alerts for like you know the new potential sources of uh problems that",
    "start": "2468880",
    "end": "2476160"
  },
  {
    "text": "that can come up um uh",
    "start": "2476160",
    "end": "2481520"
  },
  {
    "text": "we have also dashboards for overall system health we have dashboards for troubleshooting like",
    "start": "2481520",
    "end": "2486640"
  },
  {
    "text": "if there is a problem to look at and then we'll also make dashboards very for very specific situations like if",
    "start": "2486640",
    "end": "2493040"
  },
  {
    "text": "we're sending out a feature flag we may want to say like put a scope on that",
    "start": "2493040",
    "end": "2498319"
  },
  {
    "text": "and you know make sure if we're sending traffic to it there's not not an increase in errors or",
    "start": "2498319",
    "end": "2503599"
  },
  {
    "text": "you know that it's performing as well as the old system or uh that kind of thing um",
    "start": "2503599",
    "end": "2510079"
  },
  {
    "text": "really we have found it's very important to focus on alerts rather than dashboards",
    "start": "2510079",
    "end": "2515440"
  },
  {
    "text": "dashboards lead to an anti-pattern that i mentioned before humans staring at screens it's like not",
    "start": "2515440",
    "end": "2520800"
  },
  {
    "text": "what you want you really want to be able to trust that the system will let you know if there's something to pay attention to",
    "start": "2520800",
    "end": "2527680"
  },
  {
    "start": "2527000",
    "end": "2609000"
  },
  {
    "text": "nonetheless i have some quickly to run through some alerts and",
    "start": "2527680",
    "end": "2535680"
  },
  {
    "text": "uh dashboards to show so some of the main alerts that we care about are kubernetes health",
    "start": "2535680",
    "end": "2540880"
  },
  {
    "text": "like it's nice to know when the cloud service provider has starts upgrading um you know",
    "start": "2540880",
    "end": "2548079"
  },
  {
    "text": "the a worker node for us um we get alerted on all kinds of application health metrics",
    "start": "2548079",
    "end": "2553839"
  },
  {
    "text": "you know um uh we get alerted on like dead man",
    "start": "2553839",
    "end": "2559280"
  },
  {
    "text": "alerts are really important so we get alerted if we stop getting a signal right then it",
    "start": "2559280",
    "end": "2564640"
  },
  {
    "text": "lets us know like hey you have not gotten in 400 error from this gateway in you know",
    "start": "2564640",
    "end": "2572640"
  },
  {
    "text": "some period of time that seems very suspicious right so like you know",
    "start": "2572640",
    "end": "2579520"
  },
  {
    "text": "that that that implies that there's something mysterious going on if we're not if we don't hear anything",
    "start": "2579520",
    "end": "2586720"
  },
  {
    "text": "from a different service and then i also mentioned the external running availability tests like so if we start",
    "start": "2586720",
    "end": "2592160"
  },
  {
    "text": "to get like um if three times in a row an api call fails we get paged",
    "start": "2592160",
    "end": "2598400"
  },
  {
    "text": "right so we know like within three minutes like if we get three times in a row in any uh",
    "start": "2598400",
    "end": "2604000"
  },
  {
    "text": "one instance we got paged um uh okay so these are some graphs i just",
    "start": "2604000",
    "end": "2611200"
  },
  {
    "start": "2609000",
    "end": "2793000"
  },
  {
    "text": "want to touch on them real quick these are are some of the dashboards that we use um i just mentioned external",
    "start": "2611200",
    "end": "2616800"
  },
  {
    "text": "availability this shows like hey we've had a moderate number of deploys this week during those deploys we had no",
    "start": "2616800",
    "end": "2624800"
  },
  {
    "text": "this is real data by the way during those deploys we had no issues we had no like you know no um we didn't",
    "start": "2624800",
    "end": "2632880"
  },
  {
    "text": "see any uh we didn't drop any api calls but we did hear wake way after the deploys as you can see like",
    "start": "2632880",
    "end": "2639520"
  },
  {
    "text": "over like you know the course of a week two two failed calls that's like you know we",
    "start": "2639520",
    "end": "2647119"
  },
  {
    "text": "make the calls every minute that brings us below our sla here so that's why that's red",
    "start": "2647119",
    "end": "2652240"
  },
  {
    "text": "so um so this is a good indication of system health overall we say we're pretty we're pretty",
    "start": "2652240",
    "end": "2659119"
  },
  {
    "text": "healthy but we do want to look at eu central what the what happened there why did we lose that",
    "start": "2659119",
    "end": "2664880"
  },
  {
    "text": "um you can ignore this over here this is a just uh for our own internal masochism",
    "start": "2664880",
    "end": "2672960"
  },
  {
    "text": "this is the like availability metrics that are really important so we do check every week we have like a",
    "start": "2672960",
    "end": "2678640"
  },
  {
    "text": "recurring meeting where we just go in and review our system health metrics where we expect them to be",
    "start": "2678640",
    "end": "2685600"
  },
  {
    "text": "[Music] um",
    "start": "2685600",
    "end": "2691839"
  },
  {
    "text": "here's um here's an example where you can see over the last hour um in u.s west there was some read",
    "start": "2692000",
    "end": "2699119"
  },
  {
    "text": "availability problems we probably want to take a look my guess is that we actually got alerted on this",
    "start": "2699119",
    "end": "2705839"
  },
  {
    "text": "you know this probably like fired an alert hey that's a leading indicator there might be something wrong",
    "start": "2705839",
    "end": "2711280"
  },
  {
    "text": "in u.s west because of the lower uh than expected availability",
    "start": "2711280",
    "end": "2717280"
  },
  {
    "text": "there this is a debugging plat uh debugging um",
    "start": "2717280",
    "end": "2723680"
  },
  {
    "text": "dashboard like if there is an event we'll often open this up like we're looking at us central over the last hour",
    "start": "2723680",
    "end": "2729839"
  },
  {
    "text": "and we can see this doesn't look like there's any problems right you know the query pods are crashing all availability looks fine everywhere",
    "start": "2729839",
    "end": "2736800"
  },
  {
    "text": "um [Music] uh all these all the um",
    "start": "2736800",
    "end": "2742400"
  },
  {
    "text": "all the lines are flat which means like you know there's no there's no rogue we haven't deployed any",
    "start": "2742400",
    "end": "2749200"
  },
  {
    "text": "any pods in there sorry this is the same dashboard below",
    "start": "2749200",
    "end": "2754560"
  },
  {
    "text": "and we've just learned like what like shapes look like healthy systems and not healthy systems",
    "start": "2754560",
    "end": "2760800"
  },
  {
    "text": "so this all says that our storage tier is actually really healthy um so this is really handy if there's a",
    "start": "2760800",
    "end": "2766240"
  },
  {
    "text": "problem to go in and look is like there anything obviously wrong to help steer our attention to the right",
    "start": "2766240",
    "end": "2771520"
  },
  {
    "text": "place these uh are actual alerts so like you can see like re",
    "start": "2771520",
    "end": "2777599"
  },
  {
    "text": "query request duration if like users are making queries and those durations start to get too",
    "start": "2777599",
    "end": "2784880"
  },
  {
    "text": "high like how long they take we get alerts um [Music]",
    "start": "2784880",
    "end": "2792160"
  },
  {
    "text": "and yeah so just i just wanted to close off on a quick outro with like some of the challenges that we",
    "start": "2792160",
    "end": "2798880"
  },
  {
    "start": "2793000",
    "end": "2930000"
  },
  {
    "text": "faced as leaders like uh bringing the team towards this skid ops model and the",
    "start": "2798880",
    "end": "2806160"
  },
  {
    "text": "first was really just like a change of mindset from engineers from",
    "start": "2806160",
    "end": "2811359"
  },
  {
    "text": "releases to continuous delivery and this was a bit deep for us because like like of everywhere i've worked",
    "start": "2811359",
    "end": "2817760"
  },
  {
    "text": "like i've never worked anywhere that had smarter engineers and influx data a lot of engineers have been working on",
    "start": "2817760",
    "end": "2823040"
  },
  {
    "text": "databases for many many years but the like",
    "start": "2823040",
    "end": "2829440"
  },
  {
    "text": "releasing a database that customers install on their infrastructure is very different than having a sas",
    "start": "2829440",
    "end": "2835359"
  },
  {
    "text": "service right so like um there was a period of time",
    "start": "2835359",
    "end": "2840640"
  },
  {
    "text": "when it was hard for people to let go of the notion like every two weeks we do a release even though we were sas right and so",
    "start": "2840640",
    "end": "2848559"
  },
  {
    "text": "um that just took practice um [Music] i was like really alerting by doing",
    "start": "2848559",
    "end": "2854640"
  },
  {
    "text": "things um kind of with that was like changing a",
    "start": "2854640",
    "end": "2859680"
  },
  {
    "text": "mindset to think about how to roll out breaking changes like incrementally right so like if i'm",
    "start": "2859680",
    "end": "2865520"
  },
  {
    "text": "going to break the contract between internal apis like how do i like how do i roll that",
    "start": "2865520",
    "end": "2872960"
  },
  {
    "text": "out right because if you're just doing one monolithic release you just rebuild the whole binary",
    "start": "2872960",
    "end": "2878400"
  },
  {
    "text": "the internal apis change they all rebuilt that's no problem but that doesn't work in a",
    "start": "2878400",
    "end": "2884880"
  },
  {
    "text": "microservices architecture so um coaching people through that and then",
    "start": "2884880",
    "end": "2889920"
  },
  {
    "text": "there's also just this like fear of breaking production and like a lot like um",
    "start": "2889920",
    "end": "2896960"
  },
  {
    "text": "and that was just like no production will break it's not about not breaking",
    "start": "2896960",
    "end": "2902000"
  },
  {
    "text": "production it's about knowing that you broke production being able to recover from breaking production and having practices that",
    "start": "2902000",
    "end": "2908880"
  },
  {
    "text": "lead to fewer and fewer um you know incidents",
    "start": "2908880",
    "end": "2914400"
  },
  {
    "text": "but um you know not being paralyzed by that fear which causes you to batch up changes",
    "start": "2914400",
    "end": "2922640"
  },
  {
    "text": "to do a release a big release all at once which actually increases does not decrease your chance",
    "start": "2922640",
    "end": "2928319"
  },
  {
    "text": "of breaking production okay so next we want to get some metrics",
    "start": "2928319",
    "end": "2933520"
  },
  {
    "text": "back into the automated feedback loops as we discussed we also have found that like um our",
    "start": "2933520",
    "end": "2939280"
  },
  {
    "text": "feedback loop for a deploy is like after the deploy we check if it's healthy we need to check",
    "start": "2939280",
    "end": "2945040"
  },
  {
    "text": "during the deploy whether it's also staying healthy so we want to do is say like if availability dips",
    "start": "2945040",
    "end": "2951040"
  },
  {
    "text": "during the deploy let's not uh deploy to the next wave automatically",
    "start": "2951040",
    "end": "2957200"
  },
  {
    "text": "rather than if it's healthy after the deploy then go ahead um we are now in the process of putting",
    "start": "2957200",
    "end": "2964240"
  },
  {
    "text": "our get ops through the same metrics and alerting like the git ops itself like how long does it take to do",
    "start": "2964240",
    "end": "2970400"
  },
  {
    "text": "a deploy how many deploys do the developer like how how long does it take",
    "start": "2970400",
    "end": "2975839"
  },
  {
    "text": "to get out um to get a release out and then finally we're starting to work",
    "start": "2975839",
    "end": "2982400"
  },
  {
    "text": "on game days um because we have reduced our",
    "start": "2982400",
    "end": "2988400"
  },
  {
    "text": "level of incidences so much that like i'm a bit worried that we're",
    "start": "2988400",
    "end": "2993839"
  },
  {
    "text": "getting out of practice of handling them so like we want to make sure that we're like stay in practice for handling",
    "start": "2993839",
    "end": "2999280"
  },
  {
    "text": "incidents and then finally as i mentioned we're going to add canarying the deploys so okay i think i have a few minutes for",
    "start": "2999280",
    "end": "3007359"
  },
  {
    "text": "questions i'm not sure how the process goes now um",
    "start": "3007359",
    "end": "3012960"
  },
  {
    "text": "well thank you rick for a wonderful presentation we have about five minutes or so for questions so if you have any",
    "start": "3012960",
    "end": "3019040"
  },
  {
    "text": "last minute questions please feel free to drop them into the q a box we have one here right now can you",
    "start": "3019040",
    "end": "3025760"
  },
  {
    "text": "please give an example of the exporters you have for the custom mess metrics also can these exporters work",
    "start": "3025760",
    "end": "3034160"
  },
  {
    "text": "with alert manager and steam alerts to systems like victorops",
    "start": "3034160",
    "end": "3041280"
  },
  {
    "text": "um i'm really sorry i don't have enough context",
    "start": "3041280",
    "end": "3046640"
  },
  {
    "text": "for what they're asking to really uh answer that well i think are they i",
    "start": "3046640",
    "end": "3053119"
  },
  {
    "text": "don't know if they're asking about telegraph itself or the code that we",
    "start": "3053119",
    "end": "3058880"
  },
  {
    "text": "that we wrote my guess is that if they're asking about",
    "start": "3058880",
    "end": "3063920"
  },
  {
    "text": "whether telegraph supports services like victor ops and such i",
    "start": "3063920",
    "end": "3070079"
  },
  {
    "text": "suspect that it does but i don't know for a fact so just a matter of configuring the output plug-in",
    "start": "3070079",
    "end": "3075760"
  },
  {
    "text": "and please follow up with me if i just completely whiffed your question and i'll be i'll for sure track down to",
    "start": "3075760",
    "end": "3082880"
  },
  {
    "text": "the answer for you okay do we have anyone else",
    "start": "3082880",
    "end": "3088640"
  },
  {
    "text": "with questions at all um why do you need to add support for",
    "start": "3088640",
    "end": "3094000"
  },
  {
    "text": "cannery if argo already supports it by default um yeah that's a good question that's like",
    "start": "3094000",
    "end": "3100960"
  },
  {
    "text": "really related to",
    "start": "3100960",
    "end": "3104640"
  },
  {
    "text": "our current state of using istio so um",
    "start": "3106079",
    "end": "3112960"
  },
  {
    "text": "because we're a stateful service um there's",
    "start": "3112960",
    "end": "3119200"
  },
  {
    "text": "because you know like our storage tier is stateful there's just some difficulties there's",
    "start": "3119200",
    "end": "3125040"
  },
  {
    "text": "just some more work that we have to do to express those as services that istio understands",
    "start": "3125040",
    "end": "3130400"
  },
  {
    "text": "so that we can use things like argo or whatever other other um kubernetes native tools for that",
    "start": "3130400",
    "end": "3138319"
  },
  {
    "text": "okay here's another question i'm not sure what you mean by needing to check",
    "start": "3140480",
    "end": "3147119"
  },
  {
    "text": "the health during deploy to ensure five nines availability doesn't rolling upgrade strategies in",
    "start": "3147119",
    "end": "3153920"
  },
  {
    "text": "kubernetes take care of that um uh",
    "start": "3153920",
    "end": "3160000"
  },
  {
    "text": "yeah so we have um not found that to be the case at the",
    "start": "3160000",
    "end": "3165520"
  },
  {
    "text": "level of smoothness that um that we need so we have found",
    "start": "3165520",
    "end": "3171280"
  },
  {
    "text": "that um uh that that during deploys frequently somewhere in the chain like",
    "start": "3171280",
    "end": "3179200"
  },
  {
    "text": "like either istio or some other um or kubernetes itself will",
    "start": "3179200",
    "end": "3186000"
  },
  {
    "text": "if we're not very careful we'll um restart a pod during a uh",
    "start": "3186000",
    "end": "3192559"
  },
  {
    "text": "while we're servicing a request um some of the requests can take up to two minutes you know because the we can be crunching",
    "start": "3192559",
    "end": "3199680"
  },
  {
    "text": "a lot of data um so in fact uh",
    "start": "3199680",
    "end": "3205359"
  },
  {
    "text": "um you know we can dip below five nines but we've also had much more",
    "start": "3205359",
    "end": "3210960"
  },
  {
    "text": "profound problems where like during the deploy we just messed it up like and so we you know",
    "start": "3210960",
    "end": "3219280"
  },
  {
    "text": "at one point like the the code disconnected like our code we",
    "start": "3219280",
    "end": "3225440"
  },
  {
    "text": "disconnected a service before we created a new service and then we did a bunch of deployment work in between",
    "start": "3225440",
    "end": "3231680"
  },
  {
    "text": "and so during that time we just couldn't service requests kubernetes was doing exactly what we",
    "start": "3231680",
    "end": "3237359"
  },
  {
    "text": "told it to but since you know after the deploy",
    "start": "3237359",
    "end": "3245359"
  },
  {
    "text": "our test said oh everything's fine we went ahead and then rolled that out to our internal production environment and",
    "start": "3245359",
    "end": "3252559"
  },
  {
    "text": "you know so we had like a lack of availability during that deploy during that time",
    "start": "3252559",
    "end": "3257920"
  },
  {
    "text": "right so if we had the ability to say hey like during the deploy there's a lack of availability then stop",
    "start": "3257920",
    "end": "3264960"
  },
  {
    "text": "it so i hope that answers the question i'm like super happy to talk more about it",
    "start": "3264960",
    "end": "3270160"
  },
  {
    "text": "but",
    "start": "3270160",
    "end": "3272400"
  },
  {
    "text": "thank you for your presentation and answers i understand that deployment ordering is",
    "start": "3276000",
    "end": "3281760"
  },
  {
    "text": "critical for stateful applications and its components you mentioned custom controllers for",
    "start": "3281760",
    "end": "3287119"
  },
  {
    "text": "your application is the right path forward to ensure dependency and ordering for application components can you elaborate",
    "start": "3287119",
    "end": "3294720"
  },
  {
    "text": "on that is a is it a custom operator you have written that runs in the cluster or",
    "start": "3294720",
    "end": "3302559"
  },
  {
    "text": "are or do you have argo workflow taking care of the ordering um like so in the case that i'm",
    "start": "3302559",
    "end": "3310400"
  },
  {
    "text": "mentioning to get like to that super smooth deploy case it's absolutely a custom",
    "start": "3310400",
    "end": "3316400"
  },
  {
    "text": "uh controller that we wrote that that's running in the structure for us so we have a set",
    "start": "3316400",
    "end": "3322559"
  },
  {
    "text": "of control controllers actually that we wrote but um uh that are at different levels but",
    "start": "3322559",
    "end": "3330079"
  },
  {
    "text": "yeah we just found we just had to get very fine grain control over um over the different parts and the",
    "start": "3330079",
    "end": "3337200"
  },
  {
    "text": "only way the like there's just no offshore off the shelf solution that actually worked up to the level of",
    "start": "3337200",
    "end": "3343680"
  },
  {
    "text": "requirements that we had again most people don't have those requirements you know like that are that like through",
    "start": "3343680",
    "end": "3350240"
  },
  {
    "text": "the roof of like you know a single dropped api call single 503 is you know",
    "start": "3350240",
    "end": "3358799"
  },
  {
    "text": "like their users are aversa to that so yeah absolutely we had to write custom code and we",
    "start": "3358799",
    "end": "3364160"
  },
  {
    "text": "continue to write custom controllers okay well that just about wraps up all",
    "start": "3364160",
    "end": "3369760"
  },
  {
    "text": "the time that we have for today i want to thank rick for a wonderful presentation",
    "start": "3369760",
    "end": "3375280"
  },
  {
    "text": "um as i said before the presentation and slides will be available later today on",
    "start": "3375280",
    "end": "3380960"
  },
  {
    "text": "the cncf webinar page at cncf dot io slash webinars thank you all for attending today's",
    "start": "3380960",
    "end": "3387920"
  },
  {
    "text": "webinar take care stay safe and we will see you at the next cncf webinar",
    "start": "3387920",
    "end": "3393200"
  },
  {
    "text": "bye everybody",
    "start": "3393200",
    "end": "3399359"
  }
]