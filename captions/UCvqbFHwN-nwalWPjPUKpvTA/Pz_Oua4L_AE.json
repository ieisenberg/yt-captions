[
  {
    "text": "good morning everybody and thank you for joining our talk gups I did it again protecting your",
    "start": "1959",
    "end": "10080"
  },
  {
    "text": "GTO system from being used for privilege escalation thank you for being here",
    "start": "10080",
    "end": "16759"
  },
  {
    "text": "today gitops is a rising star in the devop and clown native community and",
    "start": "17320",
    "end": "23119"
  },
  {
    "text": "from our experience it seems like almost every organization is adopting it these days",
    "start": "23119",
    "end": "30080"
  },
  {
    "text": "in this talk we invite you on a journey to explore gitops from a security",
    "start": "30080",
    "end": "35360"
  },
  {
    "text": "focused perspective we will delve into the mind of an attacker examining kp's best",
    "start": "35360",
    "end": "42440"
  },
  {
    "text": "practices and architecture through their eyes Our intention is to equip you with",
    "start": "42440",
    "end": "50640"
  },
  {
    "text": "a deeper understanding of gitops and practical tools for its security",
    "start": "50640",
    "end": "55840"
  },
  {
    "text": "strengthening your entire organization security now just to get a general idea of our",
    "start": "55840",
    "end": "62359"
  },
  {
    "text": "audience today please raise your hand if you or your organization are active users of",
    "start": "62359",
    "end": "69119"
  },
  {
    "text": "GTO okay okay um now please raise your hand",
    "start": "69119",
    "end": "75159"
  },
  {
    "text": "if you're here to learn about gp's hacking shananigans okay so the same",
    "start": "75159",
    "end": "82759"
  },
  {
    "text": "people perfect I promise we'll have something for each group so let's begin",
    "start": "82759",
    "end": "90159"
  },
  {
    "text": "in our talk today we'll have five key steps first we will explain why we",
    "start": "90159",
    "end": "96399"
  },
  {
    "text": "identify gitops and Aro CD as emerging Technologies worth",
    "start": "96399",
    "end": "102200"
  },
  {
    "text": "researching then we will study gitops how how does it operate what is the",
    "start": "102200",
    "end": "108119"
  },
  {
    "text": "gitops manifesto and how does it look like from an attacker's",
    "start": "108119",
    "end": "113360"
  },
  {
    "text": "perspective then we will share in the exploit part we will share our research",
    "start": "113360",
    "end": "119439"
  },
  {
    "text": "story detailing how we discovered a critical vulnerability in ouro CD system and its",
    "start": "119439",
    "end": "127039"
  },
  {
    "text": "implications as well as sharing insights on how to conduct a similar",
    "start": "127039",
    "end": "132440"
  },
  {
    "text": "research after that for the GTO security versus reality",
    "start": "132440",
    "end": "137720"
  },
  {
    "text": "part we will examine gtop security best practices and identify scenarios where",
    "start": "137720",
    "end": "144160"
  },
  {
    "text": "open- Source projects and Cloud providers require a bit of extra effort on our part to to avoid being vulnerable",
    "start": "144160",
    "end": "151280"
  },
  {
    "text": "to GTH Up's attacks and finally we'll wrap everything up by discussing our",
    "start": "151280",
    "end": "158239"
  },
  {
    "text": "practical next steps and we will share a surprise to to help you apply what we've",
    "start": "158239",
    "end": "164800"
  },
  {
    "text": "learned in this talk sounds good",
    "start": "164800",
    "end": "170360"
  },
  {
    "text": "perfect a word about us my name is Orin I'm a security researcher at scyon I",
    "start": "170360",
    "end": "177159"
  },
  {
    "text": "have seven years of experience and I use to research care bus and networking and currently I research um supply chain and",
    "start": "177159",
    "end": "186480"
  },
  {
    "text": "Cloud security hey my name is alad I'm security researcher at cyod I also have",
    "start": "186480",
    "end": "193480"
  },
  {
    "text": "seven years of cyber security experience I'm mainly focusing on application security and supply chain",
    "start": "193480",
    "end": "201000"
  },
  {
    "text": "security perfect so let's begin by identifying a",
    "start": "201000",
    "end": "206920"
  },
  {
    "text": "trend but before that I I want to share with you the story of how the idea for",
    "start": "206920",
    "end": "213040"
  },
  {
    "text": "this st came to life but it's not for publication so keep it between",
    "start": "213040",
    "end": "220319"
  },
  {
    "text": "us in 2023 we tried to get accepted to cubon",
    "start": "220319",
    "end": "225360"
  },
  {
    "text": "North America and we really thought our talks would make",
    "start": "225360",
    "end": "231079"
  },
  {
    "text": "it however they got rejected which left us surprised and mainly",
    "start": "231079",
    "end": "237959"
  },
  {
    "text": "frustrated so for the next cubec con this one we decided to take a shrewd",
    "start": "237959",
    "end": "243159"
  },
  {
    "text": "approach to improve our chances of acceptance we reviewed last year's cubec",
    "start": "243159",
    "end": "249439"
  },
  {
    "text": "con schedule to try and identify security Trends um sorry technology",
    "start": "249439",
    "end": "254640"
  },
  {
    "text": "trends that might reveal security blind spots and as we review the schedule",
    "start": "254640",
    "end": "261359"
  },
  {
    "text": "we've noticed that the term giops kept appearing and while we weren't familiar",
    "start": "261359",
    "end": "266720"
  },
  {
    "text": "with it the talks were often accompanied by dramatic titles from prominent",
    "start": "266720",
    "end": "273160"
  },
  {
    "text": "companies as you can see there was gitops at",
    "start": "273160",
    "end": "278320"
  },
  {
    "text": "Adobe and giops at Spotify and even how",
    "start": "278320",
    "end": "283360"
  },
  {
    "text": "giops change our lives and can change your SCH from a person working vmw great",
    "start": "283360",
    "end": "288919"
  },
  {
    "text": "title for a talk so we were intrigued what is this giop that everybody's talking about and",
    "start": "288919",
    "end": "296560"
  },
  {
    "text": "the next question would be do people actually use it or it's just like conference stock",
    "start": "296560",
    "end": "302560"
  },
  {
    "text": "material apparently yes 91% probably like 91% of",
    "start": "302560",
    "end": "309240"
  },
  {
    "text": "the audience today are actively using gths um as stated in a micro survey",
    "start": "309240",
    "end": "316960"
  },
  {
    "text": "conducted by the cncf in 2023 and what's even crazier is that out",
    "start": "316960",
    "end": "323440"
  },
  {
    "text": "of the 9% holding back 2/3 claim that they will Embrace GTH UPS to their",
    "start": "323440",
    "end": "328960"
  },
  {
    "text": "organization during the year of 2024 there is a month and a half left",
    "start": "328960",
    "end": "334199"
  },
  {
    "text": "for this year so okay people use it there's something going on but how do they use",
    "start": "334199",
    "end": "341160"
  },
  {
    "text": "it apparently there is something called getop stools and we were familiar with some of them but the king for getop",
    "start": "341160",
    "end": "349360"
  },
  {
    "text": "toools Argo CD um on the on the left side with over 60% embracement",
    "start": "349360",
    "end": "356440"
  },
  {
    "text": "rate we didn't know about it nothing so we went to the to its",
    "start": "356440",
    "end": "364240"
  },
  {
    "text": "website and we saw that there are some small organizations that say that they use",
    "start": "364240",
    "end": "369840"
  },
  {
    "text": "Argo CD you might know some of them so GPS and Argo CD there's",
    "start": "369840",
    "end": "376280"
  },
  {
    "text": "definitely something going on but we don't know what it means probably you can explain to us later so our next step",
    "start": "376280",
    "end": "384360"
  },
  {
    "text": "would be to understand what are they exactly and I will let my colleague",
    "start": "384360",
    "end": "390840"
  },
  {
    "text": "continue thank you Rin so coming to this research we wanted to know everything",
    "start": "390840",
    "end": "397440"
  },
  {
    "text": "about giops researching it from bottom up inside out and basically be the giops",
    "start": "397440",
    "end": "404720"
  },
  {
    "text": "gurus so giops is a g source of",
    "start": "404720",
    "end": "409800"
  },
  {
    "text": "Truth giops is a g source of Truth meaning all the configuration files all",
    "start": "409800",
    "end": "414919"
  },
  {
    "text": "the resources are stored in a single git repository it could be git gitl bit",
    "start": "414919",
    "end": "421639"
  },
  {
    "text": "bucket then we have versioning meaning think about this you're launching new",
    "start": "421639",
    "end": "427360"
  },
  {
    "text": "clusters new buckets every day and when something WR goes wrong you're trying to",
    "start": "427360",
    "end": "432759"
  },
  {
    "text": "roll back and find the missing spot but the gitops this is a nonissue all you",
    "start": "432759",
    "end": "440000"
  },
  {
    "text": "need to do is go back one commit one commit backwards and your all",
    "start": "440000",
    "end": "445800"
  },
  {
    "text": "infrastructure will be rolled back and in the end of of the day the current",
    "start": "445800",
    "end": "451280"
  },
  {
    "text": "state in the git repository will represents the current the desired state",
    "start": "451280",
    "end": "457560"
  },
  {
    "text": "in the kubernetes cluster or in the cloud generally so let's visualize this a little",
    "start": "457560",
    "end": "463800"
  },
  {
    "text": "bit okay we have all of our kubernetes clust all of our kubernetes resources",
    "start": "463800",
    "end": "469759"
  },
  {
    "text": "all of our buckets terraforms everything inside a g repository then we have a GP",
    "start": "469759",
    "end": "476360"
  },
  {
    "text": "as the gitops agent that makes sure to be synced and up to dat with a G",
    "start": "476360",
    "end": "483240"
  },
  {
    "text": "repository then when a new commit comes by it will launch the latest changes to",
    "start": "483240",
    "end": "489120"
  },
  {
    "text": "the cloud environment and like we said a",
    "start": "489120",
    "end": "494280"
  },
  {
    "text": "common h g up agent is the Argo CD but before that how it looks from the",
    "start": "494280",
    "end": "501840"
  },
  {
    "text": "attacker perspective from the attacker perspective the picture look a lot",
    "start": "501840",
    "end": "508280"
  },
  {
    "text": "simpler a attackers want to get to the Cloud environment right because the",
    "start": "508280",
    "end": "513760"
  },
  {
    "text": "production environment intell resources and secrets are all in the cloud environment and who has direct access to",
    "start": "513760",
    "end": "521360"
  },
  {
    "text": "the cloud environment giops giops agents that are appealing to attackers and makes sense",
    "start": "521360",
    "end": "528160"
  },
  {
    "text": "to be appealing attack vector and the most leading Argo CD yeah",
    "start": "528160",
    "end": "535560"
  },
  {
    "text": "Argo CD it runs inside a cluster in a separate namespace it's an Rising Star",
    "start": "535560",
    "end": "542279"
  },
  {
    "text": "project on GitHub and it's an cncf graduated project",
    "start": "542279",
    "end": "548480"
  },
  {
    "text": "amazing and from ago CD perspective the picture look very similar this time in a",
    "start": "548480",
    "end": "555480"
  },
  {
    "text": "g repository we have all of our kubernetes resources in a single place",
    "start": "555480",
    "end": "561680"
  },
  {
    "text": "then Argo CD will make sure to be up to date and La launch the latest changes to",
    "start": "561680",
    "end": "568200"
  },
  {
    "text": "the kubernetes cluster so from a mind of attacker attacking Argo CD will be very",
    "start": "568200",
    "end": "577360"
  },
  {
    "text": "valuable and now to the exploitation phase we'll explain how we leveraged",
    "start": "577360",
    "end": "583839"
  },
  {
    "text": "Argo CD to gain elevated permissions inside a cluster so let let's div",
    "start": "583839",
    "end": "591760"
  },
  {
    "text": "in we're launching G CD like we said we didn't know much about it pushing some",
    "start": "591760",
    "end": "597839"
  },
  {
    "text": "buttons and creating a new application like we said before makes",
    "start": "597839",
    "end": "604120"
  },
  {
    "text": "sense the first thing will be to connect a new git repository this time is a geub",
    "start": "604120",
    "end": "611480"
  },
  {
    "text": "repository with all of our deployments and related stuff for kubernetes",
    "start": "611480",
    "end": "617760"
  },
  {
    "text": "cluster one moment go by and it's already thinking and processing and",
    "start": "617760",
    "end": "623079"
  },
  {
    "text": "everything is going smoothly and one more minute we have our cluster up and",
    "start": "623079",
    "end": "628640"
  },
  {
    "text": "running with all of our deployments pretty easy Plug and Play",
    "start": "628640",
    "end": "634760"
  },
  {
    "text": "process right but behind the scenes it's a little bit more",
    "start": "634760",
    "end": "640600"
  },
  {
    "text": "complicated we committed a new H commit to the repository right could be",
    "start": "640600",
    "end": "646240"
  },
  {
    "text": "deployment could be anything else then a repository service makes sure to be up",
    "start": "646240",
    "end": "652880"
  },
  {
    "text": "to date with the latest changes and save the latest changes in the r cash server",
    "start": "652880",
    "end": "659440"
  },
  {
    "text": "a new component then we have the kubernetes controller that thinks with that R cash",
    "start": "659440",
    "end": "667160"
  },
  {
    "text": "instance and makes sure that if he has something new launching to the cluster",
    "start": "667160",
    "end": "674720"
  },
  {
    "text": "and in the end of the day we have the current state in the G repos repository synced with the desired",
    "start": "674720",
    "end": "682839"
  },
  {
    "text": "state in the kubernetes cluster so like we saw just now",
    "start": "682839",
    "end": "690200"
  },
  {
    "text": "the red cach server is a huge component along the way kind of like a middleware",
    "start": "690200",
    "end": "697680"
  },
  {
    "text": "between the git repository and the kubernetes cluster so we went into the docs",
    "start": "697680",
    "end": "703720"
  },
  {
    "text": "researching it a little bit to see what is the main role of that ready cash",
    "start": "703720",
    "end": "710519"
  },
  {
    "text": "instance navigating to the docs revealed and interesting line secrets are",
    "start": "710519",
    "end": "716440"
  },
  {
    "text": "available to anyone who has access to the r instance",
    "start": "716440",
    "end": "722000"
  },
  {
    "text": "H we like Secrets obviously so let's access the r cach instance right tunnel",
    "start": "722000",
    "end": "730639"
  },
  {
    "text": "tunneling our way through to the red instance and we got access totally",
    "start": "730639",
    "end": "737440"
  },
  {
    "text": "Anonymous navigating inside the r instance and we see one key that is very",
    "start": "737440",
    "end": "743320"
  },
  {
    "text": "interesting to us a manifest one going to the Manifest and we see all",
    "start": "743320",
    "end": "749160"
  },
  {
    "text": "all of our deployments configuration files from the git repository just right there in a single",
    "start": "749160",
    "end": "756560"
  },
  {
    "text": "place so we are thinking to ourselves what if we can inject",
    "start": "756560",
    "end": "764480"
  },
  {
    "text": "malicious deployment straight into the red cach instance and by that",
    "start": "764480",
    "end": "770639"
  },
  {
    "text": "interfering with the conventional flow the G conventional flow and inject",
    "start": "770639",
    "end": "775680"
  },
  {
    "text": "malicious deployment straight into the red cash in",
    "start": "775680",
    "end": "781120"
  },
  {
    "text": "so let's do it we are preparing a malicious deployment that of course will be privileged to gain a elevated",
    "start": "781360",
    "end": "789240"
  },
  {
    "text": "permission within the cluster second reverse",
    "start": "789240",
    "end": "794639"
  },
  {
    "text": "shell we are want we want to create a reverse shell back to the attacker",
    "start": "794639",
    "end": "800120"
  },
  {
    "text": "server and gain remote access to the cluster and maybe a privileged one so",
    "start": "800120",
    "end": "806639"
  },
  {
    "text": "let's do it well we are waiting we are setting up our",
    "start": "806639",
    "end": "812800"
  },
  {
    "text": "environment one moment goes by one minute goes by and it",
    "start": "812800",
    "end": "820079"
  },
  {
    "text": "failed it didn't work we didn't get any connection navigating back to the radi",
    "start": "820079",
    "end": "826760"
  },
  {
    "text": "instance and like nothing got changed nothing got changed and our",
    "start": "826760",
    "end": "832880"
  },
  {
    "text": "changes got rolled back so investigate a little bit ER",
    "start": "832880",
    "end": "840279"
  },
  {
    "text": "thinking what happened in this process because we just now injected the malicious deployment to the r cash",
    "start": "840279",
    "end": "847720"
  },
  {
    "text": "instance and we found out what happened we as an external attacker",
    "start": "847720",
    "end": "854880"
  },
  {
    "text": "within the cluster in a separated name space tried to inject malicious deployment straight into the red cash",
    "start": "854880",
    "end": "862480"
  },
  {
    "text": "instance then the repository service got notified about those changes and made",
    "start": "862480",
    "end": "869320"
  },
  {
    "text": "sure that the git repository will be up to date with the r cash instance and",
    "start": "869320",
    "end": "874639"
  },
  {
    "text": "rolled back those changes back to the desired state so what now are we finding a new",
    "start": "874639",
    "end": "883440"
  },
  {
    "text": "research idea a new trend what are we planning to do from here I will let my",
    "start": "883440",
    "end": "889720"
  },
  {
    "text": "colleague Orin continue from here thank you lot it is a complicated",
    "start": "889720",
    "end": "895959"
  },
  {
    "text": "spot in this talk where you hand me the mic but I will do my best so our changes in the application",
    "start": "895959",
    "end": "902920"
  },
  {
    "text": "manifest got roll backed but how did the repository",
    "start": "902920",
    "end": "908040"
  },
  {
    "text": "service know that the application manifest was tempered could there be something we've",
    "start": "908040",
    "end": "914639"
  },
  {
    "text": "missed in the application manifest we went back to the application manifest",
    "start": "914639",
    "end": "920120"
  },
  {
    "text": "and apparently yes the first value of the application manifest is the one",
    "start": "920120",
    "end": "925480"
  },
  {
    "text": "we've missed and the first entry which is called the cash entry has and its value seems something like a",
    "start": "925480",
    "end": "933440"
  },
  {
    "text": "b 64 so could it be some kind of validation mechanism for the content of",
    "start": "933440",
    "end": "939199"
  },
  {
    "text": "the application manifest like check some maybe luckily Alo CD is an open source",
    "start": "939199",
    "end": "946480"
  },
  {
    "text": "project so we could just go straight into the source code and try and identify the function that generates",
    "start": "946480",
    "end": "952959"
  },
  {
    "text": "this value so this is what we've done and we encounter this function that generate",
    "start": "952959",
    "end": "958560"
  },
  {
    "text": "cash entry has and we thought to ourselves well probably they're using",
    "start": "958560",
    "end": "964759"
  },
  {
    "text": "some kind of private key to sign the the Manifest a secret and we thought that this is a",
    "start": "964759",
    "end": "972399"
  },
  {
    "text": "dead end but when we dove into the code to try and see what are they doing we",
    "start": "972399",
    "end": "979040"
  },
  {
    "text": "encountered this comment and it says hash the Json representation into a",
    "start": "979040",
    "end": "985519"
  },
  {
    "text": "base 64 encoded and check out this part we don't need a cryptographic hash",
    "start": "985519",
    "end": "991480"
  },
  {
    "text": "algorithm since this is only for detect detecting data corruption well great news for us right",
    "start": "991480",
    "end": "1000279"
  },
  {
    "text": "because it means that we can mimic the logic of the generate cash entry H",
    "start": "1000279",
    "end": "1007839"
  },
  {
    "text": "function in order to sign our own application manifest with the tempered",
    "start": "1007839",
    "end": "1014399"
  },
  {
    "text": "value values we've we've injected so for our second round of trying to",
    "start": "1014399",
    "end": "1022880"
  },
  {
    "text": "inject a malicious deployment to the red instance we have used the same kubernetes",
    "start": "1022880",
    "end": "1029438"
  },
  {
    "text": "deployment which contains a privilege pod which once deployed will spawn a",
    "start": "1029439",
    "end": "1036319"
  },
  {
    "text": "reverse shell to an attacker controlled server our server but this time we have",
    "start": "1036319",
    "end": "1042438"
  },
  {
    "text": "recalculated the cash entry hush we inserted the changes and waited",
    "start": "1042439",
    "end": "1049000"
  },
  {
    "text": "for the changes to take place and this time it worked and we received a",
    "start": "1049000",
    "end": "1056559"
  },
  {
    "text": "privilege connection from within the victim's cluster to our attacker",
    "start": "1056559",
    "end": "1061600"
  },
  {
    "text": "controlled server victim's cluster is research cluster right we're not attackers so in the Argo web application",
    "start": "1061600",
    "end": "1070240"
  },
  {
    "text": "now what we could see is that a new record was created and within that record there was that ATT attacker pod",
    "start": "1070240",
    "end": "1077720"
  },
  {
    "text": "which is our injected pod in the injector deployment which is now being",
    "start": "1077720",
    "end": "1083559"
  },
  {
    "text": "managed and verified that is running correctly by the Alo CD server",
    "start": "1083559",
    "end": "1090200"
  },
  {
    "text": "itself so how would it look like this attack Vector from attacker's perspective what could an attacker do so",
    "start": "1090240",
    "end": "1098360"
  },
  {
    "text": "first an attacker could access the file system of all the pods that are running",
    "start": "1098360",
    "end": "1104280"
  },
  {
    "text": "in the cluster as it has file system privileges to to the host node to the",
    "start": "1104280",
    "end": "1110440"
  },
  {
    "text": "worker node that's running it as it can give itself all the capabilities that are",
    "start": "1110440",
    "end": "1116280"
  },
  {
    "text": "available also he could steal all the secrets from the kubernetes environment",
    "start": "1116280",
    "end": "1122240"
  },
  {
    "text": "as it can just Mount himself the secret because he the attacker can now deploy whichever resource he desires and also",
    "start": "1122240",
    "end": "1129679"
  },
  {
    "text": "he could steal the token from the from the other kubernetes pods as it has access to their file system",
    "start": "1129679",
    "end": "1137280"
  },
  {
    "text": "right and if you're into networking you probably are familiar with this",
    "start": "1137280",
    "end": "1142440"
  },
  {
    "text": "application the attacker could Sniff and intercept all the pods communication",
    "start": "1142440",
    "end": "1148320"
  },
  {
    "text": "within the cluster stealing production n networking communication as it also has",
    "start": "1148320",
    "end": "1155600"
  },
  {
    "text": "capabilities for all the network interfaces of the host",
    "start": "1155600",
    "end": "1160880"
  },
  {
    "text": "node and if you're not into kubernetes don't worry we have something for you as",
    "start": "1160880",
    "end": "1165919"
  },
  {
    "text": "well the attacker could also steal the I am token off the hor node and then start",
    "start": "1165919",
    "end": "1173280"
  },
  {
    "text": "his lateral movement journey in the cloud environment so either way it is bad news",
    "start": "1173280",
    "end": "1181880"
  },
  {
    "text": "so the attacker's new P new capabilities would be as followed he could steal all",
    "start": "1181880",
    "end": "1187640"
  },
  {
    "text": "the secrets in the kubernetes cluster he could Sniff and intercept all the",
    "start": "1187640",
    "end": "1193280"
  },
  {
    "text": "networking communication he could deploy whichever resource he desires to the kubernetes",
    "start": "1193280",
    "end": "1199440"
  },
  {
    "text": "cluster and escape to the cloud",
    "start": "1199440",
    "end": "1204080"
  },
  {
    "text": "environment now imagine that any compromised pod in the",
    "start": "1204559",
    "end": "1211320"
  },
  {
    "text": "cluster could have performed this attack not",
    "start": "1211320",
    "end": "1219240"
  },
  {
    "text": "good we have reported this vulnerability to the Aro CD team and they have scored",
    "start": "1220360",
    "end": "1226360"
  },
  {
    "text": "it a critical score of 9.1 we were very happy and I want to seize this",
    "start": "1226360",
    "end": "1233000"
  },
  {
    "text": "opportunity to give a shout out to Michael Leonardo and pav from the Argo CD development team for being highly",
    "start": "1233000",
    "end": "1240320"
  },
  {
    "text": "collaborative and helping us mitigating this vulnerability in making Alo safer",
    "start": "1240320",
    "end": "1246559"
  },
  {
    "text": "for all its users okay so to recap this last part as",
    "start": "1246559",
    "end": "1254000"
  },
  {
    "text": "it was intense at least for me we have learned that any compromise from as",
    "start": "1254000",
    "end": "1259480"
  },
  {
    "text": "pod in a victim's cluster could have accessed the ready instance within the",
    "start": "1259480",
    "end": "1265640"
  },
  {
    "text": "algo CD name space in the same cluster steal all the secrets for the",
    "start": "1265640",
    "end": "1271400"
  },
  {
    "text": "application manifest if they exist and also inject whichever resource he",
    "start": "1271400",
    "end": "1277279"
  },
  {
    "text": "desires to the Manifest and by that compromising the entire",
    "start": "1277279",
    "end": "1283158"
  },
  {
    "text": "cluster do you want to see a demo of that how would that look like okay so",
    "start": "1284120",
    "end": "1289640"
  },
  {
    "text": "this is a live pre-recorded demo so here we can see the attacker server",
    "start": "1289640",
    "end": "1297240"
  },
  {
    "text": "we are listening on Port 852 waiting for a connection from the client",
    "start": "1297240",
    "end": "1302799"
  },
  {
    "text": "cluster and this is a compromised pod it could be a web show oh oh my",
    "start": "1302799",
    "end": "1308559"
  },
  {
    "text": "God we had to sorry",
    "start": "1308559",
    "end": "1314520"
  },
  {
    "text": "so this is a this is our attacker server thank you",
    "start": "1319080",
    "end": "1326200"
  },
  {
    "text": "and we're listening on Port 5852 and here is a compromised pod",
    "start": "1326200",
    "end": "1331720"
  },
  {
    "text": "within the cluster it could have been a pod with uh public net facing um to the",
    "start": "1331720",
    "end": "1337919"
  },
  {
    "text": "network and got compromised it has low Privileges and as we can see it is being",
    "start": "1337919",
    "end": "1343039"
  },
  {
    "text": "managed by the Argo CD instance to be just like um a website",
    "start": "1343039",
    "end": "1349240"
  },
  {
    "text": "and it has no privileges to the cluster it should not it should not be able to privilege",
    "start": "1349240",
    "end": "1354400"
  },
  {
    "text": "escalate and we have installed our tool that implements the this exploit",
    "start": "1354400",
    "end": "1362360"
  },
  {
    "text": "we've just discussed and this tool has two modes first the detect",
    "start": "1362360",
    "end": "1367840"
  },
  {
    "text": "mode and then the exploit mode in the detect mode it does something very cool it will try to resolve the full name of",
    "start": "1367840",
    "end": "1375440"
  },
  {
    "text": "the Argo CD ready instance with within the Argo CD namespace against the",
    "start": "1375440",
    "end": "1380679"
  },
  {
    "text": "kubernetes DNS server in order to retrieve his IP address and then if we",
    "start": "1380679",
    "end": "1386600"
  },
  {
    "text": "find a red instance and an Argo CD server we will query the version of the",
    "start": "1386600",
    "end": "1391840"
  },
  {
    "text": "Argo CD and as we can see the version is vulnerable I'm telling you and we got also the IP address of",
    "start": "1391840",
    "end": "1399400"
  },
  {
    "text": "the red instance so now for the XO part it requires two flags first the",
    "start": "1399400",
    "end": "1407320"
  },
  {
    "text": "injection file which will be whichever kubernetes yaml based resource",
    "start": "1407320",
    "end": "1414480"
  },
  {
    "text": "configuration you desire which will it will inject to the application manifest",
    "start": "1414480",
    "end": "1419679"
  },
  {
    "text": "and also the IP of the r instance so once it will log in to the red",
    "start": "1419679",
    "end": "1428000"
  },
  {
    "text": "instance if the script will succeed he will iterate over all the application",
    "start": "1428000",
    "end": "1433240"
  },
  {
    "text": "manifest and inject the malicious deployment into each and every one of them so even if the the clients performs",
    "start": "1433240",
    "end": "1439440"
  },
  {
    "text": "the r back the malicious deployment will still",
    "start": "1439440",
    "end": "1445039"
  },
  {
    "text": "remain and we can see that the attack has completed successfully it found one application manifest and recalculate the",
    "start": "1445039",
    "end": "1452480"
  },
  {
    "text": "cash entry hash and of course injected our malicious deployment so now when we will go back",
    "start": "1452480",
    "end": "1459919"
  },
  {
    "text": "to the Argo CD server we'll be able to see that he manages a new pod now that",
    "start": "1459919",
    "end": "1466559"
  },
  {
    "text": "attacker which is our pod and if you'll take a look on our",
    "start": "1466559",
    "end": "1472320"
  },
  {
    "text": "attacker server we can see that we have received a new connection from within",
    "start": "1472320",
    "end": "1477919"
  },
  {
    "text": "the client's cluster and this connection is privileged so now we could use it to",
    "start": "1477919",
    "end": "1485600"
  },
  {
    "text": "deploy whichever resource it desires and do all the bad things we've just",
    "start": "1485600",
    "end": "1492600"
  },
  {
    "text": "discussed so this is how it we look like from an attacker's perspective",
    "start": "1492600",
    "end": "1499440"
  },
  {
    "text": "sorry now elad will continue and discuss what are the actual G of security",
    "start": "1507880",
    "end": "1513960"
  },
  {
    "text": "principles we want to bring today thank you R what a great",
    "start": "1513960",
    "end": "1520919"
  },
  {
    "text": "pre-recorded live demo isn't it this research was great from studying",
    "start": "1520919",
    "end": "1526880"
  },
  {
    "text": "giops into exploiting ourd all the way to the patch along the way we learned a lot of",
    "start": "1526880",
    "end": "1534760"
  },
  {
    "text": "best practices and common pitfalls in gitops workflows and today I want to",
    "start": "1534760",
    "end": "1541200"
  },
  {
    "text": "share with you three of the things we learned the first one is cluster",
    "start": "1541200",
    "end": "1548720"
  },
  {
    "text": "separation imagine two scenarios right the first one will have our production",
    "start": "1548720",
    "end": "1556000"
  },
  {
    "text": "application in the same cluster like our gitops management tool one day sadly one of the",
    "start": "1556000",
    "end": "1564440"
  },
  {
    "text": "application pods got compromised by an external attacker attacker will start to map",
    "start": "1564440",
    "end": "1571600"
  },
  {
    "text": "everything and every resource beside them in the same cluster and what you",
    "start": "1571600",
    "end": "1578480"
  },
  {
    "text": "will find out that there is a gitops agent right near him inside the",
    "start": "1578480",
    "end": "1585039"
  },
  {
    "text": "cluster now compromising the GTH Ops agents with attacks we just saw gaining privileged",
    "start": "1585039",
    "end": "1593440"
  },
  {
    "text": "access to the GTH Ops agent and with that compromising the entire",
    "start": "1593440",
    "end": "1600240"
  },
  {
    "text": "cluster and in the second scenario we have two cluster configurations one for the application",
    "start": "1600240",
    "end": "1607360"
  },
  {
    "text": "and one for the giops management tool the same thing happens here the port got",
    "start": "1607360",
    "end": "1613840"
  },
  {
    "text": "compromised and the attacker will start to map every resource near him",
    "start": "1613840",
    "end": "1618919"
  },
  {
    "text": "but this time when trying to access a gitops agent or any other management tool it will",
    "start": "1618919",
    "end": "1626200"
  },
  {
    "text": "fail so the first PR principle today is keeping clusters separate for our",
    "start": "1626200",
    "end": "1633679"
  },
  {
    "text": "management tool in this case the gitops and our application",
    "start": "1633679",
    "end": "1639039"
  },
  {
    "text": "tool the second point is Network policy and ensures that we have a cni plugin to",
    "start": "1639039",
    "end": "1645919"
  },
  {
    "text": "enforce those Network policies for example with Argo CD Network",
    "start": "1645919",
    "end": "1651760"
  },
  {
    "text": "policies come by default with have what resources of Argo CD are able to access",
    "start": "1651760",
    "end": "1658880"
  },
  {
    "text": "the r cash instance great right",
    "start": "1658880",
    "end": "1664519"
  },
  {
    "text": "but are those Network policies being enforced by",
    "start": "1664519",
    "end": "1671360"
  },
  {
    "text": "default so we went into a journey in the three main Cloud",
    "start": "1671360",
    "end": "1676880"
  },
  {
    "text": "providers to check which one of them had Network policies enforced by a cni plug-in which one of",
    "start": "1676880",
    "end": "1685279"
  },
  {
    "text": "them do you think had that and we found out that only gcp had cni plug-in by",
    "start": "1685279",
    "end": "1693440"
  },
  {
    "text": "default without manual configuration while AWS and ASU",
    "start": "1693440",
    "end": "1699320"
  },
  {
    "text": "required more manual configuration after s setting up the",
    "start": "1699320",
    "end": "1704480"
  },
  {
    "text": "cluster so the second principle here is valid dating that we have cni plugin",
    "start": "1704480",
    "end": "1710640"
  },
  {
    "text": "that enforces that Network policies and the third one you probably",
    "start": "1710640",
    "end": "1717399"
  },
  {
    "text": "heard about that updating versions so we took Argo CD as a case study to see how",
    "start": "1717399",
    "end": "1724600"
  },
  {
    "text": "much Argo CD are patched in the wild and we found out that more than 2/3 of the",
    "start": "1724600",
    "end": "1732360"
  },
  {
    "text": "publicly exposed Argo CD application in the wild are vulnerable",
    "start": "1732360",
    "end": "1739039"
  },
  {
    "text": "6 months later so the third one like in any aspect of cyber security keeping the",
    "start": "1739039",
    "end": "1746679"
  },
  {
    "text": "Argo CD up to date as much as possible and now to wrap this all thing",
    "start": "1746679",
    "end": "1754720"
  },
  {
    "text": "up I let my my colleague Orin continue from here thank",
    "start": "1754720",
    "end": "1762600"
  },
  {
    "text": "you so as promised now we will share full",
    "start": "1763039",
    "end": "1769480"
  },
  {
    "text": "security checklist for GTO and also a surprise because we promise and this is what we do when you",
    "start": "1769480",
    "end": "1775360"
  },
  {
    "text": "promise so first adding on top of the",
    "start": "1775360",
    "end": "1780440"
  },
  {
    "text": "three security principles lades presented we have created based on our",
    "start": "1780440",
    "end": "1785679"
  },
  {
    "text": "Argo CD research and our broader research on gitops the gitops complete",
    "start": "1785679",
    "end": "1791159"
  },
  {
    "text": "Security checklist which contains many security",
    "start": "1791159",
    "end": "1796480"
  },
  {
    "text": "principles you can follow and apply to your organization and don't don't worry you",
    "start": "1796480",
    "end": "1804600"
  },
  {
    "text": "don't have to take a picture of that and to make it easier for everyone",
    "start": "1804600",
    "end": "1810240"
  },
  {
    "text": "we have created this open source project which is called the Gat of's security",
    "start": "1810240",
    "end": "1815760"
  },
  {
    "text": "champion and within that project we have inserted all the security principles we",
    "start": "1815760",
    "end": "1823799"
  },
  {
    "text": "think that are crucial for G up Security based on our research along with",
    "start": "1823799",
    "end": "1830320"
  },
  {
    "text": "explanations how to apply them and why is it important and also examples for",
    "start": "1830320",
    "end": "1835760"
  },
  {
    "text": "how can it go wrong so we invite you to to read that and maybe pass it on to",
    "start": "1835760",
    "end": "1842320"
  },
  {
    "text": "someone who who needs to read that and most important we know it's not",
    "start": "1842320",
    "end": "1850039"
  },
  {
    "text": "everything and there's a lot of more effort we could put in and therefore we",
    "start": "1850039",
    "end": "1856080"
  },
  {
    "text": "invite you to collaborate with us and contribute and maybe together we can",
    "start": "1856080",
    "end": "1861960"
  },
  {
    "text": "make GitHub safer without making it slower or like slowing down the paste",
    "start": "1861960",
    "end": "1869080"
  },
  {
    "text": "because this is not what we want to do so please join our",
    "start": "1869080",
    "end": "1876679"
  },
  {
    "text": "effort this is what we had for you for today we really appreciate your time and",
    "start": "1876679",
    "end": "1882639"
  },
  {
    "text": "the fact that you've been here and please can the QR code this is the Repository for the GitHub security agent",
    "start": "1882639",
    "end": "1890120"
  },
  {
    "text": "maybe give it a scar a star maybe open an issue maybe even add the",
    "start": "1890120",
    "end": "1896080"
  },
  {
    "text": "documentation",
    "start": "1896080",
    "end": "1899080"
  },
  {
    "text": "and and we don't have time for questions but we will be happy to stay",
    "start": "1904679",
    "end": "1911039"
  },
  {
    "text": "after the talk if you have H so please feel free to reach out and um thank you",
    "start": "1911039",
    "end": "1916600"
  },
  {
    "text": "again for being here we appreciate the opportunity",
    "start": "1916600",
    "end": "1921080"
  }
]