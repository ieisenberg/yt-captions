[
  {
    "text": "all right hello everyone and welcome to the first talk of the beginner track for the day thank you all for for coming and",
    "start": "0",
    "end": "6420"
  },
  {
    "text": "to learn about policy as code and readable Rego uh quick show of hands who here is doing some sort of policy as",
    "start": "6420",
    "end": "13440"
  },
  {
    "text": "code already in their in their stacks all right cool and how many of you are already using open policy agent",
    "start": "13440",
    "end": "19859"
  },
  {
    "text": "we got a couple that's pretty good all right well uh this is the beginner track so this is",
    "start": "19859",
    "end": "25080"
  },
  {
    "text": "going to be a very like introductory uh uh a talk on how to use open policy",
    "start": "25080",
    "end": "30539"
  },
  {
    "text": "agent what it is why it came about and then we're going to go over some quick examples of how to how to write uh",
    "start": "30539",
    "end": "36960"
  },
  {
    "text": "regular policies and how to clean up the code so uh starting off",
    "start": "36960",
    "end": "42059"
  },
  {
    "text": "my name is Peter O'Neill I am a senior devops engineer and evangelist uh for a",
    "start": "42059",
    "end": "47640"
  },
  {
    "text": "company called webwrite we help do digital Transformations and helping companies uh move their legacy",
    "start": "47640",
    "end": "53460"
  },
  {
    "text": "Technologies to the cloud cool so today's agenda talk a little bit",
    "start": "53460",
    "end": "60600"
  },
  {
    "text": "about uh why open policy agent came about the difference between authen and not Z but about what it means for",
    "start": "60600",
    "end": "67560"
  },
  {
    "text": "something to be policy as code then we'll dive into the open policy agent project and then we'll get into writing",
    "start": "67560",
    "end": "73500"
  },
  {
    "text": "regular doing some unit testing so let's get started so you've probably",
    "start": "73500",
    "end": "79200"
  },
  {
    "text": "already seen something similar to this where right we've been moving to the cloud we've taken these monoliths that",
    "start": "79200",
    "end": "84540"
  },
  {
    "text": "we've had and we've breaked them down into these uh microservices right and like breaking them into their smallest components and so when this happens",
    "start": "84540",
    "end": "91259"
  },
  {
    "text": "right there are a a lot of points now that you have to",
    "start": "91259",
    "end": "97439"
  },
  {
    "text": "make decisions right now that we have all these different Services all these Services have API endpoints all of and",
    "start": "97439",
    "end": "103979"
  },
  {
    "text": "then you have more users using these services and all these Services have more components so now you can see the complexity here of all these points now",
    "start": "103979",
    "end": "111000"
  },
  {
    "text": "you have thousands of interactions that need some sort of authorization check",
    "start": "111000",
    "end": "116579"
  },
  {
    "text": "when they happen right and so this is now while we move into the space why we need a more fine-grained uh access",
    "start": "116579",
    "end": "123960"
  },
  {
    "text": "control system or authorization tool and so",
    "start": "123960",
    "end": "130500"
  },
  {
    "text": "the reasons that a course grain system right we're talking very simple like our",
    "start": "130500",
    "end": "135780"
  },
  {
    "text": "back policies or just users where you can just have one simple rule around what a user can or can't do won't work",
    "start": "135780",
    "end": "143280"
  },
  {
    "text": "um right it kind of lacks a lot of the complexities that our Cloud native systems need right and so when we talk",
    "start": "143280",
    "end": "150060"
  },
  {
    "text": "about this right like these these policies end up being uh right like hard-coded directly into the application",
    "start": "150060",
    "end": "156420"
  },
  {
    "text": "they end up being very error prone right there's a lot of things that just don't work very well uh for the complexities",
    "start": "156420",
    "end": "163200"
  },
  {
    "text": "of the systems that we want to create uh and so",
    "start": "163200",
    "end": "169560"
  },
  {
    "text": "with that right like we we want to now extend extend and expand what we're",
    "start": "169560",
    "end": "175200"
  },
  {
    "text": "doing to be more Dynamic and to be more inclusive of uh the systems that we're creating right and so this is kind of",
    "start": "175200",
    "end": "181379"
  },
  {
    "text": "the model that we want to move into so with that we'll move into authen",
    "start": "181379",
    "end": "186480"
  },
  {
    "text": "versus auth Z and this ends up being uh a question that comes up quite a bit",
    "start": "186480",
    "end": "191519"
  },
  {
    "text": "when people are trying to adopt an authorization system because they think I already have an SSO provider I already",
    "start": "191519",
    "end": "197640"
  },
  {
    "text": "know uh I already have something that identifies my users but right this is",
    "start": "197640",
    "end": "203280"
  },
  {
    "text": "the auth end side of the problem and when we have uh but we need both sides of this coin right not only do we need",
    "start": "203280",
    "end": "209459"
  },
  {
    "text": "to identify the user but we need to Grant permissions in a way that is very modular right so you need to solve both",
    "start": "209459",
    "end": "216300"
  },
  {
    "text": "sides of this coin in order to have it through uh authorization system right so",
    "start": "216300",
    "end": "221760"
  },
  {
    "text": "when we're on the offense side that is our SSO provider that could be ldap that could be active directory right and then",
    "start": "221760",
    "end": "227519"
  },
  {
    "text": "on the other side of that is when we're actually setting up our authorization system right and this could be as simple as our back right once again that very",
    "start": "227519",
    "end": "234840"
  },
  {
    "text": "coarse grain just understanding what users belong to what groups and giving",
    "start": "234840",
    "end": "240180"
  },
  {
    "text": "them and giving them permissions based on that and then you have right you move into a little bit more complexity where",
    "start": "240180",
    "end": "246060"
  },
  {
    "text": "you have like an ABAC system or attribute based access controls where you start defining more attributes",
    "start": "246060",
    "end": "252180"
  },
  {
    "text": "around each specific user and each interaction that they're doing and it gives you a little bit more of that",
    "start": "252180",
    "end": "257820"
  },
  {
    "text": "fine-grained nature or something like I am like directly in your Cloud where you can control right individual components",
    "start": "257820",
    "end": "264780"
  },
  {
    "text": "within within the cloud right and so it's giving you more and more uh control over the interactions that need to",
    "start": "264780",
    "end": "270419"
  },
  {
    "text": "happen right and so when we think about this right we can think about",
    "start": "270419",
    "end": "275880"
  },
  {
    "text": "um right all the different places that that these interactions are happening right you can have things at the",
    "start": "275880",
    "end": "282120"
  },
  {
    "text": "infrastructure layer you know uh directly on kubernetes or Docker or uh right you can think of this as like",
    "start": "282120",
    "end": "287699"
  },
  {
    "text": "inside kubernetes you have your admission controller this is when kubernetes is actually going to create resources right we are admitting those",
    "start": "287699",
    "end": "294960"
  },
  {
    "text": "resources into kubernetes right so we need to have that that modularity to say",
    "start": "294960",
    "end": "300960"
  },
  {
    "text": "hey I want uh specific users or specific service accounts or specific X to be",
    "start": "300960",
    "end": "308160"
  },
  {
    "text": "able to create uh some type of resource in this cluster you want to be able to control what that looks like right same",
    "start": "308160",
    "end": "314100"
  },
  {
    "text": "thing with terraform you want to be able to say when I run my terraform plan I know what",
    "start": "314100",
    "end": "319740"
  },
  {
    "text": "is in scope and what is out of scope right I know that when users are creating resources VMS uh maybe entire",
    "start": "319740",
    "end": "326100"
  },
  {
    "text": "clusters right you want to know exactly how they should be created not just",
    "start": "326100",
    "end": "331139"
  },
  {
    "text": "saying because you are an admin you can create whatever you want right this ends up happening a lot in cicd pipelines",
    "start": "331139",
    "end": "337259"
  },
  {
    "text": "where those permissions end up getting like the star value admin and those",
    "start": "337259",
    "end": "343440"
  },
  {
    "text": "those CI CD pipelines end up being overpowered for what they need to do right and then on the uh on the",
    "start": "343440",
    "end": "351840"
  },
  {
    "text": "application side of this right you can think of this as uh when you are defining your applications when you are",
    "start": "351840",
    "end": "357539"
  },
  {
    "text": "building these Services what exactly are you going to allow your users uh to",
    "start": "357539",
    "end": "363240"
  },
  {
    "text": "actually do when they're interacting with the system right and so these are all different types of authorization decisions that need to happen both on",
    "start": "363240",
    "end": "369840"
  },
  {
    "text": "the infrastructure side and on the application side",
    "start": "369840",
    "end": "374060"
  },
  {
    "text": "and so what's needed right like and so this is kind of where we start getting into this",
    "start": "375180",
    "end": "381060"
  },
  {
    "text": "policy as code mindset right where now that we're looking for this Dynamic fine-grained authorization right we",
    "start": "381060",
    "end": "387780"
  },
  {
    "text": "start wanting to standardize this by using some sort of framework right by",
    "start": "387780",
    "end": "393000"
  },
  {
    "text": "having a framework now we know for all these different components from the infrastructure all the way up to the application right we can start defining",
    "start": "393000",
    "end": "400199"
  },
  {
    "text": "what these policies look like in one language right and we want to be able to say well",
    "start": "400199",
    "end": "406500"
  },
  {
    "text": "how do we do this in one place right how do we actually get these policies to apply to all of these different areas",
    "start": "406500",
    "end": "412620"
  },
  {
    "text": "and we do this by decoupling the policy logic from the tools that we're using right and so this is where we start",
    "start": "412620",
    "end": "419100"
  },
  {
    "text": "actually doing policy as code because now that we have decoupled what",
    "start": "419100",
    "end": "424259"
  },
  {
    "text": "authorization checks need to happen now we can start defining these and putting",
    "start": "424259",
    "end": "429360"
  },
  {
    "text": "them into our policy or start checking these into git as if uh like we will with the rest of our code base",
    "start": "429360",
    "end": "437360"
  },
  {
    "text": "right and so now we know a little bit uh about policy as Co or sorry uh sorry one",
    "start": "439080",
    "end": "445199"
  },
  {
    "text": "more one more slide here uh right and so the evolution of policy right and so this is kind of where we started to how",
    "start": "445199",
    "end": "451560"
  },
  {
    "text": "we got to policy as code and so right Once Upon a Time right like I remember",
    "start": "451560",
    "end": "457800"
  },
  {
    "text": "my first job my first uh systems job where they gave me access to all the",
    "start": "457800",
    "end": "463139"
  },
  {
    "text": "systems when I started right they created all my accounts and it's basically just root access to everything right it was basically them saying hey",
    "start": "463139",
    "end": "470220"
  },
  {
    "text": "when you're working with our systems make sure you don't do this and everything was written in a Wiki and",
    "start": "470220",
    "end": "476340"
  },
  {
    "text": "who really reads the wiki every time they go to do something right like it's not something that you're going and",
    "start": "476340",
    "end": "481680"
  },
  {
    "text": "manually checking to make sure you're doing the right thing every time and so it's very error prone and then so right",
    "start": "481680",
    "end": "487380"
  },
  {
    "text": "as things kind of moved along we started saying well okay well now I can just kind of put some guardrails up and just",
    "start": "487380",
    "end": "493560"
  },
  {
    "text": "kind of say let the system block a few things here and there right and make sure the system stops you from doing",
    "start": "493560",
    "end": "499500"
  },
  {
    "text": "anything that's like crucially bad and then right and then this worked",
    "start": "499500",
    "end": "505979"
  },
  {
    "text": "fairly well but we ended up defining things like who is my admin group in a dozen different places right so we had",
    "start": "505979",
    "end": "511979"
  },
  {
    "text": "that we had this hard-coded uh policies that needed to be Rewritten time and time again right and so this is where",
    "start": "511979",
    "end": "518640"
  },
  {
    "text": "we've now moved into right like okay well then how do we Define this in one place and spread it out everywhere right",
    "start": "518640",
    "end": "524940"
  },
  {
    "text": "giving us this more of a policy as code and mindset right and so when we're doing this what",
    "start": "524940",
    "end": "530640"
  },
  {
    "text": "we're doing is we are extracting that policy writing it in some sort of policy",
    "start": "530640",
    "end": "535680"
  },
  {
    "text": "language and then having a policy engine enforce this for that service right and so now we have uh whatever that service",
    "start": "535680",
    "end": "541740"
  },
  {
    "text": "is being able to call out to that policy engine right maybe it's running directly on the service maybe it's running next",
    "start": "541740",
    "end": "547200"
  },
  {
    "text": "to the service but that service now is able to make that call to say hey I",
    "start": "547200",
    "end": "552540"
  },
  {
    "text": "don't know what to do uh in this scenario and you don't want it to know right you want your policy system to be",
    "start": "552540",
    "end": "558540"
  },
  {
    "text": "able to make those decisions for it right so this ends up taking away complexity from the service and speeding",
    "start": "558540",
    "end": "563880"
  },
  {
    "text": "up uh speeding up that check every time it needs to happen",
    "start": "563880",
    "end": "569720"
  },
  {
    "text": "right and so as we're doing this right what we're doing is we are applying the same",
    "start": "571620",
    "end": "578160"
  },
  {
    "text": "principles that we use for software development for our policy right and so",
    "start": "578160",
    "end": "583500"
  },
  {
    "text": "when we typically think about uh the how we've come to build applications we have",
    "start": "583500",
    "end": "589920"
  },
  {
    "text": "this very standard idea of what the software development lifecycle is and those same practices work for your",
    "start": "589920",
    "end": "596399"
  },
  {
    "text": "policy development life cycle right you want to be able to Define things up front you want to be able to author and",
    "start": "596399",
    "end": "603180"
  },
  {
    "text": "create things and check them in to get before you're actually deploying them so that you can run your unit tests your",
    "start": "603180",
    "end": "608940"
  },
  {
    "text": "integration tests right you can verify everything that's happening before it goes into your systems because right",
    "start": "608940",
    "end": "615120"
  },
  {
    "text": "like you don't want to check in a policy that's very restrictive and have it you know block access that you need or turn",
    "start": "615120",
    "end": "622500"
  },
  {
    "text": "off access that's already there causing things to happen that are unintended right and so you're able to use that",
    "start": "622500",
    "end": "629880"
  },
  {
    "text": "same cicd pipeline to deploy policies that create the security guard rails uh",
    "start": "629880",
    "end": "635459"
  },
  {
    "text": "but you're able to use this with the same tools and mindset that you're used to for when you're doing your software",
    "start": "635459",
    "end": "640680"
  },
  {
    "text": "development right and then it gives you additional things like monitoring and logging all the other addition to uh the",
    "start": "640680",
    "end": "647940"
  },
  {
    "text": "life cycle that you want to see and so with that",
    "start": "647940",
    "end": "654300"
  },
  {
    "text": "right we have this tool called open policy agent right an open policy agent has been around for quite a while it is",
    "start": "654300",
    "end": "659880"
  },
  {
    "text": "a graduated project in the cncf uh and right it came about to solve this",
    "start": "659880",
    "end": "665700"
  },
  {
    "text": "problem of how do we enable authorization across the the tech stack",
    "start": "665700",
    "end": "671220"
  },
  {
    "text": "or across specifically your Tech stack that you're using right and it does this",
    "start": "671220",
    "end": "677040"
  },
  {
    "text": "by creating that standardized policy framework that we talked about earlier right and so",
    "start": "677040",
    "end": "682260"
  },
  {
    "text": "oppa or Opa for open policy agent is a general purpose policy engine right that general purpose meaning that it's able",
    "start": "682260",
    "end": "688560"
  },
  {
    "text": "to be used for all those tools and services right and so this tool right by by decoupling uh",
    "start": "688560",
    "end": "696120"
  },
  {
    "text": "actually we'll get to the next slide right it's going to allow you to really optimize your policy performance uh your",
    "start": "696120",
    "end": "703140"
  },
  {
    "text": "policy performance for the rest of your your stack right and so how exactly does this work",
    "start": "703140",
    "end": "710640"
  },
  {
    "text": "right and so as I mentioned we are decoupling here so the service at the top here is going to",
    "start": "710640",
    "end": "716640"
  },
  {
    "text": "make right maybe this is going to be an HTTP call maybe this is going to be running as like a side car right but",
    "start": "716640",
    "end": "721920"
  },
  {
    "text": "you're going to have these various options so that your service right can ask a question and what is a question a",
    "start": "721920",
    "end": "728880"
  },
  {
    "text": "question is going to be uh all of the input and data that your service has and",
    "start": "728880",
    "end": "734519"
  },
  {
    "text": "it's going to ship that as a Json object to open policy agent right and so we are",
    "start": "734519",
    "end": "739620"
  },
  {
    "text": "calling this a question uh but realistically this is just understanding the data in and returning",
    "start": "739620",
    "end": "746940"
  },
  {
    "text": "a data block back right and so at its simplest level what you might be returning back is like a Boolean like a",
    "start": "746940",
    "end": "753600"
  },
  {
    "text": "true or false but this could be much more complex than that as well right you might be you",
    "start": "753600",
    "end": "758640"
  },
  {
    "text": "might want to send some sort of JWT token that you want to encrypt or decrypt you might want to Hash these",
    "start": "758640",
    "end": "765360"
  },
  {
    "text": "values or create certificates on the fly right so oppa being this uh being being",
    "start": "765360",
    "end": "771060"
  },
  {
    "text": "the decision engine just understands how to take in this Json and then you're going to Define with your policies what",
    "start": "771060",
    "end": "777959"
  },
  {
    "text": "needs to be sent back right and so the magic happens inside of the policy",
    "start": "777959",
    "end": "783300"
  },
  {
    "text": "itself because the policy is going to transform this data into what you need right so uh right like as I mentioned",
    "start": "783300",
    "end": "790380"
  },
  {
    "text": "right there's the this is going to work with pretty much any of the tools in your tool stack because as a cloud native tool",
    "start": "790380",
    "end": "797100"
  },
  {
    "text": "everything basically speaks on the HTTP protocol so you're able to send these",
    "start": "797100",
    "end": "802920"
  },
  {
    "text": "requests and then Oppa will be able to compare the question coming in with the",
    "start": "802920",
    "end": "809339"
  },
  {
    "text": "policies that are defined in any external data that you want to give it as well right that external data might",
    "start": "809339",
    "end": "814740"
  },
  {
    "text": "be user data it might be right just just situational data it",
    "start": "814740",
    "end": "821160"
  },
  {
    "text": "could just be right like anything that's going to augment that policy to allow",
    "start": "821160",
    "end": "826380"
  },
  {
    "text": "to allow oppa to make the correct decision for what needs to happen",
    "start": "826380",
    "end": "832459"
  },
  {
    "text": "right",
    "start": "833579",
    "end": "836000"
  },
  {
    "text": "and so right like we typically are going to start at one",
    "start": "838680",
    "end": "844920"
  },
  {
    "text": "place inside of your Tech stack but right these decisions once again happen throughout the entirety of your",
    "start": "844920",
    "end": "851339"
  },
  {
    "text": "application so you're going to insert where these policies happen at all of",
    "start": "851339",
    "end": "857160"
  },
  {
    "text": "these different components right you're going to check when right things are being created in your CI CD pipeline the",
    "start": "857160",
    "end": "864360"
  },
  {
    "text": "policies are going to be applied there so that you know things are created in the right way you're going to include",
    "start": "864360",
    "end": "869940"
  },
  {
    "text": "policies in between your services right like so if you're using some sort of service mesh or something that that is",
    "start": "869940",
    "end": "876420"
  },
  {
    "text": "giving you that Telemetry between all of your services you want to know that what's happening when those calls go",
    "start": "876420",
    "end": "882060"
  },
  {
    "text": "from one from service a to service B that everything is happening as you",
    "start": "882060",
    "end": "887519"
  },
  {
    "text": "expect it to right and then down on the infrastructure layer you want to make sure that things are always in the form",
    "start": "887519",
    "end": "894779"
  },
  {
    "text": "and fashion that they should be right understanding what the state of your system looks like",
    "start": "894779",
    "end": "900480"
  },
  {
    "text": "and how uh and how it should look right and how you're going to want it to be",
    "start": "900480",
    "end": "905519"
  },
  {
    "text": "right so you can see how very quickly all these different components are requiring some sort of policy",
    "start": "905519",
    "end": "912540"
  },
  {
    "text": "that you're going to want to put in place and so you also want to Define what those look like and be able to",
    "start": "912540",
    "end": "919500"
  },
  {
    "text": "reuse them right you want to keep your policy infrastructure as simple as possible and once again we're doing this",
    "start": "919500",
    "end": "925860"
  },
  {
    "text": "by decoupling where that policy enforcement happens right and we're handing it off to open policy agent so",
    "start": "925860",
    "end": "932519"
  },
  {
    "text": "that all the tools you see here on the screen can speak one language when they want to make this decision",
    "start": "932519",
    "end": "939620"
  },
  {
    "text": "right and here's some some very common use cases and patterns I've kind of touched on these uh already right but",
    "start": "940560",
    "end": "947160"
  },
  {
    "text": "right kubernetes with the admission controller is a very popular one if you've seen uh if you if you've if",
    "start": "947160",
    "end": "953940"
  },
  {
    "text": "you've been involved with the open policy and project you've probably heard of gatekeeper and gatekeeper is essentially a framework on top of open",
    "start": "953940",
    "end": "961139"
  },
  {
    "text": "policy agent which turns your regular policies into crd so that you can apply",
    "start": "961139",
    "end": "966180"
  },
  {
    "text": "them in the cluster right and then there's tools like terraform which you can run either directly in like",
    "start": "966180",
    "end": "973199"
  },
  {
    "text": "terraform Cloud where they have an open policy agent uh run task or you can do this on your own in your cicd pipeline",
    "start": "973199",
    "end": "979620"
  },
  {
    "text": "by introducing oppa as like an action or just a component within your CI CD kind",
    "start": "979620",
    "end": "987180"
  },
  {
    "text": "of process and then with Envoy right we interact directly with Envoy through",
    "start": "987180",
    "end": "992880"
  },
  {
    "text": "their apis so that we can understand what's happening and make decisions from",
    "start": "992880",
    "end": "997920"
  },
  {
    "text": "service to service very quickly so we can Implement those policies without introducing addition additional Legacy",
    "start": "997920",
    "end": "1003920"
  },
  {
    "text": "or uh latency right or uh right open policy agent is a very small go",
    "start": "1003920",
    "end": "1011360"
  },
  {
    "text": "binary so you can actually run or you can create things that are very performant for your specific use cases",
    "start": "1011360",
    "end": "1017540"
  },
  {
    "text": "right we have a uh we have a go wrapper around open policy agent which is very performant",
    "start": "1017540",
    "end": "1023839"
  },
  {
    "text": "we've seen some very interesting deployments of this one of the one very recent one that I saw was a",
    "start": "1023839",
    "end": "1030798"
  },
  {
    "text": "Miro basically understanding all the interactions on a mural board and then shoving them through a data pipeline to",
    "start": "1030799",
    "end": "1038360"
  },
  {
    "text": "understand what the permissions are on the mirror board in real time which is",
    "start": "1038360",
    "end": "1044600"
  },
  {
    "text": "very impressive when you think about it because there may be dozens or you know 100 users interacting with the board",
    "start": "1044600",
    "end": "1050780"
  },
  {
    "text": "with a thousand components so the complexity there of who's allowed to",
    "start": "1050780",
    "end": "1056059"
  },
  {
    "text": "mess with which components at which time ends up you know scaling into the thousands of decisions a second very",
    "start": "1056059",
    "end": "1062299"
  },
  {
    "text": "quickly so you need to be able to create something that or create a pipeline of authorization decisions that's very",
    "start": "1062299",
    "end": "1068120"
  },
  {
    "text": "robust right and so when we're doing this right",
    "start": "1068120",
    "end": "1074539"
  },
  {
    "text": "like this was the uh kind of kind of this was this was this is what I showed earlier right and we're basically just",
    "start": "1074539",
    "end": "1080900"
  },
  {
    "text": "replacing uh a policy Engine with open policy agents specifically right oppa is",
    "start": "1080900",
    "end": "1086120"
  },
  {
    "text": "the tool that we want to use and Rego is the uh purpose-built uh policy language",
    "start": "1086120",
    "end": "1092120"
  },
  {
    "text": "that we want to write things in and so",
    "start": "1092120",
    "end": "1098900"
  },
  {
    "text": "now we're going to dig into uh now we're going to dig into open policy or sorry",
    "start": "1098900",
    "end": "1104120"
  },
  {
    "text": "Rego which is as I mentioned the purpose-built policy language right and so when I say purpose build what I mean",
    "start": "1104120",
    "end": "1109880"
  },
  {
    "text": "is that it was created alongside open policy agent to Define what our policies look like right",
    "start": "1109880",
    "end": "1116179"
  },
  {
    "text": "and so uh there were there was large discussions in the beginning around what",
    "start": "1116179",
    "end": "1121940"
  },
  {
    "text": "should a policy language look like should we just repurpose python or JavaScript or golang or just try to",
    "start": "1121940",
    "end": "1128539"
  },
  {
    "text": "write things in a language that people already understand the problem with that was that you're",
    "start": "1128539",
    "end": "1134419"
  },
  {
    "text": "bringing in all of the baggage of that language that people want to write things in a specific way and so trying",
    "start": "1134419",
    "end": "1140720"
  },
  {
    "text": "to stick to a cloud native uh mindset is having a declarative language ended up",
    "start": "1140720",
    "end": "1148340"
  },
  {
    "text": "feeling much more natural to solve this problem right so now we have this declarative language where we want to",
    "start": "1148340",
    "end": "1155059"
  },
  {
    "text": "Define what our policy is going to do uh and you're able to State this state this",
    "start": "1155059",
    "end": "1161000"
  },
  {
    "text": "in a clear fashion that now open policy agent figures out what it needs to do",
    "start": "1161000",
    "end": "1167840"
  },
  {
    "text": "and so since most most people in this room haven't written any regular before what",
    "start": "1167840",
    "end": "1173360"
  },
  {
    "text": "we're going to do is we're going to write a simple policy here which is just around our back and controlling uh or",
    "start": "1173360",
    "end": "1181179"
  },
  {
    "text": "defining what what a specific user can do right and so here on the screen uh",
    "start": "1181179",
    "end": "1187220"
  },
  {
    "text": "I'm showing some data in these pink boxes at the bottom I'm going to abstract a lot of this away but that's",
    "start": "1187220",
    "end": "1193100"
  },
  {
    "text": "kind of just like the small data block that we're working with here okay and so",
    "start": "1193100",
    "end": "1199820"
  },
  {
    "text": "with that right on the left hand side here we have a package name right this package name is a naming convention",
    "start": "1199820",
    "end": "1206780"
  },
  {
    "text": "right the naming convention uh we're uh is just a logical boundary between your policies right so this is a",
    "start": "1206780",
    "end": "1213380"
  },
  {
    "text": "full-featured uh coding language and so we have this logical boundary in order",
    "start": "1213380",
    "end": "1218600"
  },
  {
    "text": "to say like oh I have a package of policies for my AWS features I have a",
    "start": "1218600",
    "end": "1224480"
  },
  {
    "text": "package of policies for my Microsoft or Azure uh uh resources right so you just",
    "start": "1224480",
    "end": "1229880"
  },
  {
    "text": "want to be able to have that uh logical boundary so that you can call policies from one side and reuse them maybe",
    "start": "1229880",
    "end": "1236720"
  },
  {
    "text": "between teams or just between policies right and then next up we have these",
    "start": "1236720",
    "end": "1242960"
  },
  {
    "text": "this word called import and so with import what we're doing is we are",
    "start": "1242960",
    "end": "1248299"
  },
  {
    "text": "protecting backwards compatibility right and so this is very important when you're dealing with policies and you",
    "start": "1248299",
    "end": "1253760"
  },
  {
    "text": "want to know that what you're doing is not going to break what already exists right because breaking things that exist",
    "start": "1253760",
    "end": "1259520"
  },
  {
    "text": "in the with a policy could have catastrophic effects and so what we end up doing is as we",
    "start": "1259520",
    "end": "1267559"
  },
  {
    "text": "Advance the language we wrap all of these uh all these features into this future keywords import and so uh this",
    "start": "1267559",
    "end": "1275840"
  },
  {
    "text": "ends up allowing us to read the policy in a much more in in a language or make it seem",
    "start": "1275840",
    "end": "1282679"
  },
  {
    "text": "much more like English as you're reading the policies",
    "start": "1282679",
    "end": "1287019"
  },
  {
    "text": "and then so next up is right we have a declarative language and declarative languages don't really like when things",
    "start": "1289820",
    "end": "1295520"
  },
  {
    "text": "are undefined and so you end up wanting to set a baseline for",
    "start": "1295520",
    "end": "1302059"
  },
  {
    "text": "for what uh each of your rules is going to be uh at the beginning right so very typically you're going to have like and",
    "start": "1302059",
    "end": "1308299"
  },
  {
    "text": "allow uh equals false as a default and this kind of just says right fail close don't allow things to happen that aren't",
    "start": "1308299",
    "end": "1314900"
  },
  {
    "text": "intended and then now that we have our defaults",
    "start": "1314900",
    "end": "1321980"
  },
  {
    "text": "uh we're starting to abstract more of the policy way at the top but uh it's all still there right so now right this",
    "start": "1321980",
    "end": "1327679"
  },
  {
    "text": "very simple rule of like allow admins what we're doing here is right we have one rule which is that allow rule but we",
    "start": "1327679",
    "end": "1334580"
  },
  {
    "text": "are now calling out to a helper function this helper function uh is going to be what actually uh runs the logic and so",
    "start": "1334580",
    "end": "1341299"
  },
  {
    "text": "in here we can see user is an admin if admin is in data.user roles and we're",
    "start": "1341299",
    "end": "1346940"
  },
  {
    "text": "checking for that specific input.user right and so that input user on the right hand side there in the",
    "start": "1346940",
    "end": "1352820"
  },
  {
    "text": "white box right this is going to be what is shipped from what is shipped from the",
    "start": "1352820",
    "end": "1358280"
  },
  {
    "text": "service asking the question so in this case we're thinking about like an API request for a user trying to perform",
    "start": "1358280",
    "end": "1363980"
  },
  {
    "text": "some sort of action uh on a specific object with that ID and the type dog right so what we're doing now is we are",
    "start": "1363980",
    "end": "1371240"
  },
  {
    "text": "basically looking up that user that we see is Alice In The Box and trying to and understand seeing what role Alice",
    "start": "1371240",
    "end": "1377780"
  },
  {
    "text": "has assigned and so in here we can see that Alice is an admin so this rule would become true right so but what if",
    "start": "1377780",
    "end": "1385100"
  },
  {
    "text": "Alice isn't an admin right and so now we end up having to be a little bit",
    "start": "1385100",
    "end": "1390620"
  },
  {
    "text": "more granular around what this rule is going to do and so this is right so now we're breaking this",
    "start": "1390620",
    "end": "1397760"
  },
  {
    "text": "down a little bit further and we're actually checking for the specific grants that are tied to this user right",
    "start": "1397760",
    "end": "1403520"
  },
  {
    "text": "and so remember all of the information coming in is Json so we're able to navigate this Json tree just by doing",
    "start": "1403520",
    "end": "1411440"
  },
  {
    "text": "this like dot notation right and so we can see in this allow if statement right uh we are checking for a grant and this",
    "start": "1411440",
    "end": "1419059"
  },
  {
    "text": "user is granted uh kind of rules are in this rule called users granted right and",
    "start": "1419059",
    "end": "1424760"
  },
  {
    "text": "so at the second part of this rule we could see that we are we are uh kind of going through going",
    "start": "1424760",
    "end": "1432860"
  },
  {
    "text": "through uh the list of roles and through in that list of roles we are checking for Grants right and so what uh",
    "start": "1432860",
    "end": "1441860"
  },
  {
    "text": "we're looking for here in the input box right we can see Bob is trying to do an action called update on object uh ID 456",
    "start": "1441860",
    "end": "1449419"
  },
  {
    "text": "with type cat right so we're looking through we're looking through this data set on",
    "start": "1449419",
    "end": "1455480"
  },
  {
    "text": "the right hand side and we're seeing that it doesn't quite match up right Bob doesn't have this type cat assigned to",
    "start": "1455480",
    "end": "1462080"
  },
  {
    "text": "him right so as we are cycling through uh the rules and grants that Bob has assigned to him we are saying that it",
    "start": "1462080",
    "end": "1468200"
  },
  {
    "text": "doesn't quite have the permissions that he needs and so as Rego is going through this list right and when these things",
    "start": "1468200",
    "end": "1475100"
  },
  {
    "text": "don't match these rules become right defaults back to that default equals",
    "start": "1475100",
    "end": "1480620"
  },
  {
    "text": "allow equals false right and so with that right like that is just a very",
    "start": "1480620",
    "end": "1486320"
  },
  {
    "text": "simple policy uh that we've written right and so this is typically uh what we end up telling people to do is like",
    "start": "1486320",
    "end": "1492200"
  },
  {
    "text": "start really small find one very small uh rule or around what you want to",
    "start": "1492200",
    "end": "1497600"
  },
  {
    "text": "define or protect with this policy and then expand from there and so now that we have our first rule",
    "start": "1497600",
    "end": "1503840"
  },
  {
    "text": "written right like with any good uh coding practice we're going to write our unit tests around the rule",
    "start": "1503840",
    "end": "1510320"
  },
  {
    "text": "so with uh with these unit tests we the language makes it very simple",
    "start": "1510320",
    "end": "1515480"
  },
  {
    "text": "right and we normally recommend that you separate out your unit test uh into a",
    "start": "1515480",
    "end": "1521360"
  },
  {
    "text": "separate folder so this one is just rbac.tests right and you're going to Define these tests uh with this test",
    "start": "1521360",
    "end": "1527480"
  },
  {
    "text": "underscore keyword at the front and what I'm doing here is uh supplying it",
    "start": "1527480",
    "end": "1534440"
  },
  {
    "text": "with like a mock data right so before we had the input that was coming into that Json object here we are just",
    "start": "1534440",
    "end": "1540559"
  },
  {
    "text": "essentially saying imagine that this is the input and we're saying what we're",
    "start": "1540559",
    "end": "1545720"
  },
  {
    "text": "expecting to happen right and we're expecting this allowed to be true when the input input shows Alice update and",
    "start": "1545720",
    "end": "1552500"
  },
  {
    "text": "then type cat right and so uh you if you're doing any sort of good test",
    "start": "1552500",
    "end": "1558260"
  },
  {
    "text": "driven development right you're going to have be able to Define all of your unit tests up front to do this",
    "start": "1558260",
    "end": "1564260"
  },
  {
    "text": "and so uh with the inverse of that right being able to see that this negative tests not allow is also going to to",
    "start": "1564260",
    "end": "1572059"
  },
  {
    "text": "right not allow being true because we're expecting it to be false",
    "start": "1572059",
    "end": "1578000"
  },
  {
    "text": "and so with that uh the very last section here is kind of just improving your Rego",
    "start": "1578000",
    "end": "1583820"
  },
  {
    "text": "right so these are just common things that we see uh right so on the left hand side is as",
    "start": "1583820",
    "end": "1589940"
  },
  {
    "text": "people are kind of learning the language it ends up not being super clear right",
    "start": "1589940",
    "end": "1594980"
  },
  {
    "text": "the left and right hand side here both do the exact same thing but you're going to see as you progress in your learning",
    "start": "1594980",
    "end": "1601940"
  },
  {
    "text": "of the language right you start using more of the features you start using uh annotations instead of just comments",
    "start": "1601940",
    "end": "1608260"
  },
  {
    "text": "you're now also like using rule names that make more sense right it ends up",
    "start": "1608260",
    "end": "1613700"
  },
  {
    "text": "being uh very common that when you write your first rules you write something that sounds very easy to",
    "start": "1613700",
    "end": "1620779"
  },
  {
    "text": "remember but then maybe isn't super clear when you're looking at it and reviewing it right so having a super",
    "start": "1620779",
    "end": "1625820"
  },
  {
    "text": "user rule may not be the clearest thing when you're trying to review the audit logs right but using rule names like",
    "start": "1625820",
    "end": "1632960"
  },
  {
    "text": "allow lets you know that okay so this rule was trying to allow something to happen right and so",
    "start": "1632960",
    "end": "1641360"
  },
  {
    "text": "the second thing here is reusing expensive computations right and so on",
    "start": "1641360",
    "end": "1646580"
  },
  {
    "text": "the left hand side here are in the red box right we're going to see that in both of them we're doing the same check",
    "start": "1646580",
    "end": "1652340"
  },
  {
    "text": "instead of using a helper function right this helper function is what's actually going to uh",
    "start": "1652340",
    "end": "1659179"
  },
  {
    "text": "when you're scaling out and you're doing things uh at a at a much bigger scale you're going to",
    "start": "1659179",
    "end": "1665720"
  },
  {
    "text": "want to be able to use these helper functions to reduce the number of iterations and calls that you're making",
    "start": "1665720",
    "end": "1671240"
  },
  {
    "text": "right and so these reusing expensive computations isn't just for iteration but also when you're making like HTTP",
    "start": "1671240",
    "end": "1677659"
  },
  {
    "text": "calls or using external data to pull that information in and then my last one here is just nested",
    "start": "1677659",
    "end": "1685940"
  },
  {
    "text": "iteration right and this is something that also very common when you write your first rules is it ends up being",
    "start": "1685940",
    "end": "1690980"
  },
  {
    "text": "very simple to just Loop through your Loops when you're checking for things but right then you end up with these",
    "start": "1690980",
    "end": "1698120"
  },
  {
    "text": "coding problems where things take much longer than you expected you end up",
    "start": "1698120",
    "end": "1703580"
  },
  {
    "text": "trying to solve performance problems later down the line instead of defining",
    "start": "1703580",
    "end": "1708799"
  },
  {
    "text": "uh defining a list that you are a set that you can reach out to right and so",
    "start": "1708799",
    "end": "1714520"
  },
  {
    "text": "making making information reusable is a big part of writing code that uh is very",
    "start": "1714520",
    "end": "1722240"
  },
  {
    "text": "performance and so with that I just want to say thanks this is a quick primer on Opa and",
    "start": "1722240",
    "end": "1728779"
  },
  {
    "text": "Rego and yeah thanks for attending",
    "start": "1728779",
    "end": "1733299"
  },
  {
    "text": "foreign I think we have one minute uh if there's any any questions",
    "start": "1734600",
    "end": "1741580"
  },
  {
    "text": "yes",
    "start": "1743179",
    "end": "1745720"
  },
  {
    "text": "cool all right so the question was how would you measure uh performance right if as you are introducing these policies",
    "start": "1762080",
    "end": "1769279"
  },
  {
    "text": "right how do you see what's happening and so there are two things there right one is on the on the Opus side of things",
    "start": "1769279",
    "end": "1776120"
  },
  {
    "text": "as you are defining them you can run what we we have a policy benchmarking",
    "start": "1776120",
    "end": "1782120"
  },
  {
    "text": "Performance Tool uh built into the CLI so you can actually see like how much time down to like the nanosecond that",
    "start": "1782120",
    "end": "1788000"
  },
  {
    "text": "each policy takes to run and this is where you can very easily see spikes when you have like nested iteration these become very apparent that certain",
    "start": "1788000",
    "end": "1794419"
  },
  {
    "text": "rules take much longer than expected uh and then on the other side of that is uh which you wanting to kind of measure",
    "start": "1794419",
    "end": "1801320"
  },
  {
    "text": "just end to end latency to see if anything has changed with these policies or kind of two two places that you could",
    "start": "1801320",
    "end": "1807380"
  },
  {
    "text": "look when you are trying to measure uh what the performance impact is like foreign",
    "start": "1807380",
    "end": "1813760"
  },
  {
    "text": "got it yes and so uh with dashboarding yeah you can you can you can set it up to export information right like uh oppa",
    "start": "1822260",
    "end": "1829520"
  },
  {
    "text": "has management apis that you can pull all this information out of okay with that I think I'm actually at",
    "start": "1829520",
    "end": "1834620"
  },
  {
    "text": "time so thank you everyone [Applause]",
    "start": "1834620",
    "end": "1840299"
  }
]