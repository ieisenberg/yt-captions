[
  {
    "text": "hi everyone thanks for joining today so today we are going to talk about",
    "start": "179",
    "end": "6720"
  },
  {
    "text": "um dfir in container and now we can do the fir in the in container world",
    "start": "6720",
    "end": "14280"
  },
  {
    "text": "so let's start introducing ourselves I'm Stefano and I'm a threat research that",
    "start": "14280",
    "end": "19440"
  },
  {
    "text": "edit manager and at sysdig and as you can see from the picture I'm from Milano",
    "start": "19440",
    "end": "25980"
  },
  {
    "text": "Italy here is Alberto a peditary is a",
    "start": "25980",
    "end": "31560"
  },
  {
    "text": "security researcher at sisdig and he comes from a tour in Italy as well",
    "start": "31560",
    "end": "39380"
  },
  {
    "text": "Foreigner and Cloud security company uh sisdict donated Falco a runtime security",
    "start": "44719",
    "end": "52140"
  },
  {
    "text": "project in today's cncf back in 2016 and is now",
    "start": "52140",
    "end": "58739"
  },
  {
    "text": "the sandbox runtime security project at the incubation level and this is in the",
    "start": "58739",
    "end": "65518"
  },
  {
    "text": "process to to become a graduated process talking about Falco we are both faco",
    "start": "65519",
    "end": "72960"
  },
  {
    "text": "contributors and are also active in FICO community and I'm also if I could",
    "start": "72960",
    "end": "79680"
  },
  {
    "text": "reviewer for file core rules here is the agenda for today so we're",
    "start": "79680",
    "end": "86460"
  },
  {
    "text": "going to talk about the fir especially is we are going to see",
    "start": "86460",
    "end": "91500"
  },
  {
    "text": "incident response and digital forensic and then we are going to cover and refer",
    "start": "91500",
    "end": "98460"
  },
  {
    "text": "to nist um incident response life cycle and then Alberto will go through",
    "start": "98460",
    "end": "105140"
  },
  {
    "text": "some dfir container methodology techniques and also tools specific tools",
    "start": "105140",
    "end": "112439"
  },
  {
    "text": "for dfiring containers with some demos and then we will wrap up the session with some main takeaways",
    "start": "112439",
    "end": "120299"
  },
  {
    "text": "so let's start let's start talking about the fir",
    "start": "120299",
    "end": "125540"
  },
  {
    "text": "As We Know The Firs put together two different areas digital forensics and",
    "start": "125540",
    "end": "132680"
  },
  {
    "text": "instant response as we know digital phrases focus more on collecting and",
    "start": "132680",
    "end": "139920"
  },
  {
    "text": "analyzing data user activities and other piece of digital evidence to to",
    "start": "139920",
    "end": "147260"
  },
  {
    "text": "understand what's happening on a on a machine or what or who may be behind",
    "start": "147260",
    "end": "154040"
  },
  {
    "text": "specific threats on or the specific attack or whatever we recorded in our",
    "start": "154040",
    "end": "160680"
  },
  {
    "text": "environment all these activities need to be done following best practice and specific methodology to maintain the",
    "start": "160680",
    "end": "167459"
  },
  {
    "text": "chain of custody so that the evidence are are legitimate and can be used and",
    "start": "167459",
    "end": "172860"
  },
  {
    "text": "presented to the court in case of legal proceedings incident response is that uh are more",
    "start": "172860",
    "end": "179580"
  },
  {
    "text": "are focused on preparing detecting containing and recovering from a data",
    "start": "179580",
    "end": "184620"
  },
  {
    "text": "breach or or a security incident in early years and early days as we know",
    "start": "184620",
    "end": "191220"
  },
  {
    "text": "these two processes were completely different and separated however I mean of course because they",
    "start": "191220",
    "end": "199140"
  },
  {
    "text": "have different goals but tools processes methodologies are pretty similar and now",
    "start": "199140",
    "end": "205860"
  },
  {
    "text": "with tools like EDR xdr that are evolved of course",
    "start": "205860",
    "end": "212480"
  },
  {
    "text": "they empower the incident responder to do further actions like proceeding with",
    "start": "212480",
    "end": "218519"
  },
  {
    "text": "investigation and also performing other actions so it makes sense now to put them together under the under the same",
    "start": "218519",
    "end": "225599"
  },
  {
    "text": "head and referring directly to the fir uh and when we talk about the fir we",
    "start": "225599",
    "end": "234420"
  },
  {
    "text": "used to refer to the to to the next instant response um life life cycle step and here are the",
    "start": "234420",
    "end": "242879"
  },
  {
    "text": "four main uh Mains that are pretty well known of course today we are not covering all the technical and",
    "start": "242879",
    "end": "249599"
  },
  {
    "text": "non-technical aspects from from nist I leave the um the link behind in the in",
    "start": "249599",
    "end": "257040"
  },
  {
    "text": "the slide so that you can check out the the official this documentation if you are interested and you want to know more",
    "start": "257040",
    "end": "264060"
  },
  {
    "text": "about it and of course today we are we are going to cover the technical aspect",
    "start": "264060",
    "end": "270180"
  },
  {
    "text": "on how we can do dfir in containers which are the techniques the specific techniques that we need to know in order",
    "start": "270180",
    "end": "276720"
  },
  {
    "text": "to do that in in container worlds and so this is the time of the",
    "start": "276720",
    "end": "282300"
  },
  {
    "text": "presentation where we start saying the best practices and yes sure you need to",
    "start": "282300",
    "end": "287880"
  },
  {
    "text": "follow the best practice and you need to check for misconfiguration right so I know it's kind of boring but we need to",
    "start": "287880",
    "end": "294780"
  },
  {
    "text": "do that so jokes apart um when we talk about incident response",
    "start": "294780",
    "end": "299820"
  },
  {
    "text": "plan It's always important to mention that these need to be prepared in advance is fundamental attacker aren't",
    "start": "299820",
    "end": "308220"
  },
  {
    "text": "going to ask you if you are ready to receive the attack or uh I don't know we",
    "start": "308220",
    "end": "313320"
  },
  {
    "text": "are in so are you aware that we are already your environment so we need to",
    "start": "313320",
    "end": "318900"
  },
  {
    "text": "be prepared of that and and we we need we know we need also to keep in mind",
    "start": "318900",
    "end": "324840"
  },
  {
    "text": "that most of the or part of their uh instant response plan are non-technical",
    "start": "324840",
    "end": "330539"
  },
  {
    "text": "so there are some aspects like contacts people contacts people that",
    "start": "330539",
    "end": "336539"
  },
  {
    "text": "need to be involved needs to be defined in advance and people from different",
    "start": "336539",
    "end": "342660"
  },
  {
    "text": "teams they need they specifically need to know which people they need to contact and and exactly what they need",
    "start": "342660",
    "end": "349740"
  },
  {
    "text": "to do in specific and which action they need to do so all these aspects are not are more processes and is not technical",
    "start": "349740",
    "end": "357000"
  },
  {
    "text": "related but it's something that it needs to be set and and of course if we talk about",
    "start": "357000",
    "end": "363180"
  },
  {
    "text": "technical aspect as we said uh there are specific tools that that we need to run and and the list of the tool required",
    "start": "363180",
    "end": "370560"
  },
  {
    "text": "might be set in advance and also uh all the knowledge about how",
    "start": "370560",
    "end": "375660"
  },
  {
    "text": "to use the tool or uh you know specific flight that you need to use uh they need",
    "start": "375660",
    "end": "380759"
  },
  {
    "text": "to be all the knowledge should be prepared and to be there before the",
    "start": "380759",
    "end": "385919"
  },
  {
    "text": "attack because of course we can't uh spend time on understanding how this tool work or oh yeah I need this tool to",
    "start": "385919",
    "end": "393479"
  },
  {
    "text": "uh to do I don't know for a a an image a forensic image of something and we need",
    "start": "393479",
    "end": "399840"
  },
  {
    "text": "to understand how the tool works and other stuff so and all this kind of activities so timing is fundamental and",
    "start": "399840",
    "end": "407280"
  },
  {
    "text": "we need to be prepared and of course even if you have an instant response planning set we need to make sure and",
    "start": "407280",
    "end": "414240"
  },
  {
    "text": "you need to make sure that this is up to date I mean people changing companies uh",
    "start": "414240",
    "end": "419520"
  },
  {
    "text": "tools change pretty quickly as we know and so all the list of tools that need",
    "start": "419520",
    "end": "425639"
  },
  {
    "text": "to be used should be updated frequently and also the people that need to be involved need to be",
    "start": "425639",
    "end": "433400"
  },
  {
    "text": "updated frequently as well okay that's fine so we covered what we",
    "start": "433400",
    "end": "439740"
  },
  {
    "text": "need to what we need to say and of course the fir is a pretty uh well-known",
    "start": "439740",
    "end": "447900"
  },
  {
    "text": "practice and well-known methodologies and today we are not going to cover the",
    "start": "447900",
    "end": "453000"
  },
  {
    "text": "well-known tools um that of course are still valid for containers so we are not saying they're",
    "start": "453000",
    "end": "458940"
  },
  {
    "text": "not useful anymore of course they are but they are pretty well known and we",
    "start": "458940",
    "end": "464819"
  },
  {
    "text": "are just one to cover and we're just to focus on specific tools that can be used on on containers so to do the fir",
    "start": "464819",
    "end": "472680"
  },
  {
    "text": "activities in containers this happens also in other Technologies like iot or an ICS if you",
    "start": "472680",
    "end": "479940"
  },
  {
    "text": "think about it there are specific tools that need to be known and need to be used in order to perform some activities",
    "start": "479940",
    "end": "487560"
  },
  {
    "text": "on the fir so let's start talking about the fir in",
    "start": "487560",
    "end": "494580"
  },
  {
    "text": "containers so we all know containers and we are pretty familiar with them and we like a lot",
    "start": "494580",
    "end": "501740"
  },
  {
    "text": "it's super easy to deploy code it's super easy to ship code that we want in",
    "start": "501740",
    "end": "507060"
  },
  {
    "text": "our environment and deploy it so of course we know all the advantages that container can bring but of course we",
    "start": "507060",
    "end": "514140"
  },
  {
    "text": "also know that there are some challenging that we need to face and especially for the fir",
    "start": "514140",
    "end": "519800"
  },
  {
    "text": "we know that containers are [Music] uh Dynamic and are ephemeral so doing",
    "start": "519800",
    "end": "528300"
  },
  {
    "text": "activities like the fir in such a a dynamic environment could be pretty",
    "start": "528300",
    "end": "533880"
  },
  {
    "text": "challenging and of course we need to respond as quickly as possible because some activities that Alberto will show",
    "start": "533880",
    "end": "539940"
  },
  {
    "text": "now needs to be done when the container is live and need to be there then we",
    "start": "539940",
    "end": "546060"
  },
  {
    "text": "know containers are are ephemeral and and super uh and super quick to to",
    "start": "546060",
    "end": "552959"
  },
  {
    "text": "destroy and we might miss some information so it's really important to gather this information and and then",
    "start": "552959",
    "end": "559920"
  },
  {
    "text": "perform all other activities so a little Alberto Deep dive into the fir and all",
    "start": "559920",
    "end": "565620"
  },
  {
    "text": "the techniques and tools to use thank you Stefano I'm the lover one",
    "start": "565620",
    "end": "571760"
  },
  {
    "text": "so for this presentation we want also to adopt a practical approach covering the",
    "start": "571760",
    "end": "578339"
  },
  {
    "text": "previous steps that we have seen about nice incident response plan and to do so",
    "start": "578339",
    "end": "585000"
  },
  {
    "text": "we are going to cover all of those steps outlining the main aspects that may be",
    "start": "585000",
    "end": "591060"
  },
  {
    "text": "useful in the contourization words and along with tools techniques and so on and so forth and so for this reason",
    "start": "591060",
    "end": "598140"
  },
  {
    "text": "let's begin from prep operation so preparation is man is maybe one of the",
    "start": "598140",
    "end": "604140"
  },
  {
    "text": "main aspects of incident response methodologies because a good preparation allows you to not only prevent the",
    "start": "604140",
    "end": "611220"
  },
  {
    "text": "incidents but by hardening I mean your environment but also to enforce the",
    "start": "611220",
    "end": "616920"
  },
  {
    "text": "right capabilities so that an organization is ready to respond quickly we can talk about facilities",
    "start": "616920",
    "end": "623220"
  },
  {
    "text": "Communications Hardware software whatever you want but we're going to skip all the organizative and",
    "start": "623220",
    "end": "629880"
  },
  {
    "text": "traditional steps like set a word room or plan on site calls and so on and so",
    "start": "629880",
    "end": "636480"
  },
  {
    "text": "forth but we're going to focus our attention on open source tools that can",
    "start": "636480",
    "end": "641760"
  },
  {
    "text": "help incident response team to detect red flags facilitate attacks investigations and response",
    "start": "641760",
    "end": "649380"
  },
  {
    "text": "so the first tool um I mean the first kind of tool that I want to",
    "start": "649380",
    "end": "654839"
  },
  {
    "text": "um I mean to to stress is contain container runtime security tool",
    "start": "654839",
    "end": "660959"
  },
  {
    "text": "um Falco is maybe the first cncf uh runtime security tool that allows you to",
    "start": "660959",
    "end": "668579"
  },
  {
    "text": "spark threats at runtime um see whenever there are some kind of",
    "start": "668579",
    "end": "673620"
  },
  {
    "text": "threats that are running in your Linux environment in your containers and also to spot audits logs and some kind of",
    "start": "673620",
    "end": "681300"
  },
  {
    "text": "resources and requests that are made to the kubernetes API server so you may want to spot this kind of threats at",
    "start": "681300",
    "end": "688380"
  },
  {
    "text": "runtime you may also want to adopt other kind of Open Source tools and cncf",
    "start": "688380",
    "end": "693720"
  },
  {
    "text": "graduated projects like Prometheus in order to monitor your resources",
    "start": "693720",
    "end": "698760"
  },
  {
    "text": "and see if there are some pickup loads Network changes that may be relevant for",
    "start": "698760",
    "end": "705899"
  },
  {
    "text": "your investigations or also some other Solutions like logging Solutions because",
    "start": "705899",
    "end": "712740"
  },
  {
    "text": "one of the main best practices and that you need to enforce during the preparation step is also to log I mean",
    "start": "712740",
    "end": "721019"
  },
  {
    "text": "as much as you can from your applications so that you can I mean try",
    "start": "721019",
    "end": "727140"
  },
  {
    "text": "to have all the kind of information that are needed and then with tools like fluent bits and fluid D you can try to",
    "start": "727140",
    "end": "734220"
  },
  {
    "text": "forward these logs in just them parse them so that you can have all of them",
    "start": "734220",
    "end": "740640"
  },
  {
    "text": "with for example follicle alerts in one single login management platform like",
    "start": "740640",
    "end": "746279"
  },
  {
    "text": "the arc stack that is another open source projects like open search and so",
    "start": "746279",
    "end": "751680"
  },
  {
    "text": "on and so forth so in order to address the fairing containers in a realistic way we're",
    "start": "751680",
    "end": "758279"
  },
  {
    "text": "going to adopt kubernetes because I think that most of you are familiar with",
    "start": "758279",
    "end": "763980"
  },
  {
    "text": "it and also because this is one of the main uh orchestration tools used by the",
    "start": "763980",
    "end": "770220"
  },
  {
    "text": "open source community and as I mean as many of you already",
    "start": "770220",
    "end": "775800"
  },
  {
    "text": "know in kubernetes we can run the we can run pods that embeds containers in there",
    "start": "775800",
    "end": "782040"
  },
  {
    "text": "and so we can also perform the far in this kind of container so let's start",
    "start": "782040",
    "end": "787560"
  },
  {
    "text": "from the demo that we have set for this presentation here we have in this case these kubernetes clusters where we have",
    "start": "787560",
    "end": "795720"
  },
  {
    "text": "few nodes where we have demon sets like file core fluent bits and Prometheus in order to",
    "start": "795720",
    "end": "802380"
  },
  {
    "text": "um in order to monitor our resources we are going to forward this kind of alerts to the single logging management",
    "start": "802380",
    "end": "809639"
  },
  {
    "text": "platform like aux stack but as you can imagine in order to perform the far in a",
    "start": "809639",
    "end": "815220"
  },
  {
    "text": "container we need a workload that can be exploited and later analyzed so let's",
    "start": "815220",
    "end": "821700"
  },
  {
    "text": "teleport to the past and let's imagine that we are in 2021 I know that you're",
    "start": "821700",
    "end": "826860"
  },
  {
    "text": "you're thinking that I'm going to talk about log4j because I'm not I'm bored",
    "start": "826860",
    "end": "832019"
  },
  {
    "text": "about it so let's talk about another vulnerabilities that he that was his closed in",
    "start": "832019",
    "end": "838200"
  },
  {
    "text": "2021 as well that is the Apache HTTP server that was a puff traversal",
    "start": "838200",
    "end": "844139"
  },
  {
    "text": "vulnerability that under some circumstances allowed also to perform remote command executions and so in our",
    "start": "844139",
    "end": "851519"
  },
  {
    "text": "cluster we basically exposed our workloads our Apache HTTP server with a",
    "start": "851519",
    "end": "857279"
  },
  {
    "text": "kubernetes load balancers that could be exposed by attackers that could be",
    "start": "857279",
    "end": "862680"
  },
  {
    "text": "exploited by attackers so let's nowhere the incident Response Team Hot",
    "start": "862680",
    "end": "869399"
  },
  {
    "text": "an incident response team is always monitoring alerts based on Falco detection I mean alerts like the ones",
    "start": "869399",
    "end": "876420"
  },
  {
    "text": "based on Falco detection that we set to be alerted as soon as possible and to",
    "start": "876420",
    "end": "881639"
  },
  {
    "text": "promptly respond to incident let's jump into our stack and in this case here we",
    "start": "881639",
    "end": "887399"
  },
  {
    "text": "have some logs that are related to one of our Apache HTTP Depot where we can",
    "start": "887399",
    "end": "894240"
  },
  {
    "text": "found something related to launch Ingress remote file copy Tools in",
    "start": "894240",
    "end": "899279"
  },
  {
    "text": "container that is kind of speeches I don't think that it happens every day",
    "start": "899279",
    "end": "905220"
  },
  {
    "text": "that there are core loan duplicate executions that are run at runtime in your container so this is a red flag if",
    "start": "905220",
    "end": "914160"
  },
  {
    "text": "we go ahead we can also see some kind of some other kind of alerts like as",
    "start": "914160",
    "end": "920180"
  },
  {
    "text": "shallow spawned by the Apache httpd process there is kind of suspicious as",
    "start": "920180",
    "end": "925560"
  },
  {
    "text": "well and also attempts to steal sensitive credentials but",
    "start": "925560",
    "end": "931260"
  },
  {
    "text": "focusing on our our attention to the uh launching versus remote file copy Tools",
    "start": "931260",
    "end": "936480"
  },
  {
    "text": "in containers we can see that it was executed accrual wget that tried to",
    "start": "936480",
    "end": "942360"
  },
  {
    "text": "reach an endpoint the T is related to the IP address that you can see here",
    "start": "942360",
    "end": "949279"
  },
  {
    "text": "194 and blah blah blah blah where you where basically that was basically used",
    "start": "949279",
    "end": "955260"
  },
  {
    "text": "in order to download a malicious payload that we will see later so let's now uh",
    "start": "955260",
    "end": "962519"
  },
  {
    "text": "go ahead and let's see also the logs that were forwarded by fluent beat in our log management platform that are",
    "start": "962519",
    "end": "969600"
  },
  {
    "text": "related to the impacted Port if we see the logs we can see that for example there were a bunch of get requests on",
    "start": "969600",
    "end": "976980"
  },
  {
    "text": "top of this slide and then there are also some commands that were not performed uh successfully there are also",
    "start": "976980",
    "end": "985139"
  },
  {
    "text": "some other kind of um I mean operations that were not permitted and at the end if we go ahead",
    "start": "985139",
    "end": "993120"
  },
  {
    "text": "we can also see a post request that is kind of suspicious because it basically",
    "start": "993120",
    "end": "998579"
  },
  {
    "text": "tried to it X twice it it exploited DC GI being in order to spawn a shell",
    "start": "998579",
    "end": "1005500"
  },
  {
    "text": "other suggestions by the way may also come from uh open from Prometheus as I",
    "start": "1005500",
    "end": "1012199"
  },
  {
    "text": "said before because Prometheus allows you to basically",
    "start": "1012199",
    "end": "1018560"
  },
  {
    "text": "um for example query your your code that you have in this specific name space for example and you",
    "start": "1018560",
    "end": "1026058"
  },
  {
    "text": "can see for example from the memory used that at the beginning there was these",
    "start": "1026059",
    "end": "1032540"
  },
  {
    "text": "normal amount of memory that was I mean used by those ports in that",
    "start": "1032540",
    "end": "1038660"
  },
  {
    "text": "namespace and at a certain point in time there was this speaker float I mean this is just an example also because",
    "start": "1038660",
    "end": "1045380"
  },
  {
    "text": "this also means that I'm a bad programmer because I didn't accept resource quotes our resource limits in",
    "start": "1045380",
    "end": "1050720"
  },
  {
    "text": "my workload but there are other kind of indicators like Network bytes that may be explanatory for your for your",
    "start": "1050720",
    "end": "1058100"
  },
  {
    "text": "investigation purpose so let's now",
    "start": "1058100",
    "end": "1064000"
  },
  {
    "text": "let's now continue come on",
    "start": "1064000",
    "end": "1071000"
  },
  {
    "text": "okay yeah I love the office and now this is one of the main interesting part",
    "start": "1071000",
    "end": "1077600"
  },
  {
    "text": "because I mean incident Response Team um should always be prepared to such",
    "start": "1077600",
    "end": "1082880"
  },
  {
    "text": "kind of events and should be able to respond as soon as possible to the alert",
    "start": "1082880",
    "end": "1088220"
  },
  {
    "text": "that happen also because in your orchestration environments or whenever",
    "start": "1088220",
    "end": "1094160"
  },
  {
    "text": "you have a container that has been impacted you need to respond as soon as possible because as Stefano said before",
    "start": "1094160",
    "end": "1099799"
  },
  {
    "text": "they are ephemeral and these kind of containers can disappear and you may",
    "start": "1099799",
    "end": "1105740"
  },
  {
    "text": "lose the kind of informations about the attack that happened in your environment",
    "start": "1105740",
    "end": "1111620"
  },
  {
    "text": "so let's now go ahead and let's talk about the real response that is engaged",
    "start": "1111620",
    "end": "1118160"
  },
  {
    "text": "by the response team so you may want to contain to to evaluate their education",
    "start": "1118160",
    "end": "1124340"
  },
  {
    "text": "and also to recover your infrastructure so contain basically means isolate the",
    "start": "1124340",
    "end": "1130340"
  },
  {
    "text": "attack because you only want to avoid that the affected pods or container may impact",
    "start": "1130340",
    "end": "1135980"
  },
  {
    "text": "other resources if you are for example in a kubernetes cluster the code that",
    "start": "1135980",
    "end": "1142280"
  },
  {
    "text": "was impacted may have access to service account those service account May Grant you access to some requests to the",
    "start": "1142280",
    "end": "1149539"
  },
  {
    "text": "kubernetes API server and so for example the attack can generate a mass",
    "start": "1149539",
    "end": "1155440"
  },
  {
    "text": "and of course you need also to answer availability and continuity to your uh",
    "start": "1155440",
    "end": "1161299"
  },
  {
    "text": "to your resources to services that you provide and you must also assess which",
    "start": "1161299",
    "end": "1168559"
  },
  {
    "text": "resources have been impacted for example your containers may cause opponent escaping container escaping Grant to the",
    "start": "1168559",
    "end": "1176059"
  },
  {
    "text": "attackers direct access to the nodes and these of course can create some other problems and what is also important for",
    "start": "1176059",
    "end": "1184400"
  },
  {
    "text": "differensic step is to collection all the evidences about the attack so as",
    "start": "1184400",
    "end": "1190520"
  },
  {
    "text": "always the first and the main step is to always snapshot the worker node volume",
    "start": "1190520",
    "end": "1196160"
  },
  {
    "text": "because because these grants um some forensics uh some forensics",
    "start": "1196160",
    "end": "1202880"
  },
  {
    "text": "analysis uh that can be done later during the postmortem phase but you can",
    "start": "1202880",
    "end": "1209539"
  },
  {
    "text": "also enforce for example some other commands like commit and push in order",
    "start": "1209539",
    "end": "1214820"
  },
  {
    "text": "to store the container image that was impacted and also checkpoint the",
    "start": "1214820",
    "end": "1220100"
  },
  {
    "text": "container that we're going to see later and at the end of course last but not",
    "start": "1220100",
    "end": "1225260"
  },
  {
    "text": "least you should also fix at the end of this step of this uh containment",
    "start": "1225260",
    "end": "1230960"
  },
  {
    "text": "eradication recovery fix your uh fix the entry point it was exploited by",
    "start": "1230960",
    "end": "1236120"
  },
  {
    "text": "attackers um so if it is a misconfiguration or a vulnerability you need to fix it",
    "start": "1236120",
    "end": "1242480"
  },
  {
    "text": "otherwise you have to mitigate if for example the patch is not available so uh",
    "start": "1242480",
    "end": "1248600"
  },
  {
    "text": "before jumping into the crime investigation scene um I will like hold only to stress that",
    "start": "1248600",
    "end": "1255980"
  },
  {
    "text": "there are some kind of useful tools and techniques that you may want to engage Whenever there are breaches in your",
    "start": "1255980",
    "end": "1263179"
  },
  {
    "text": "containers but I want also to strike to stress that many of these tools",
    "start": "1263179",
    "end": "1268280"
  },
  {
    "text": "continuously evolve because there are some kind of tools that for example you could use few years ago in Docker but",
    "start": "1268280",
    "end": "1275960"
  },
  {
    "text": "this for example cannot be used anymore in some kind in I mean up up-to-date",
    "start": "1275960",
    "end": "1282440"
  },
  {
    "text": "kubernetes cluster due to the docker shim being deprecated",
    "start": "1282440",
    "end": "1287539"
  },
  {
    "text": "so there are of course you can interact as always with the container engine or",
    "start": "1287539",
    "end": "1292760"
  },
  {
    "text": "with the kubernetes API server to do some operations that you're going to see in a while but you may also want to adopt tools",
    "start": "1292760",
    "end": "1300799"
  },
  {
    "text": "like containerdif in order to check the differences among two different images or Docker Explorer and container",
    "start": "1300799",
    "end": "1308720"
  },
  {
    "text": "Explorer in order to check any kind of differences uh I mean in order to recover the state",
    "start": "1308720",
    "end": "1316820"
  },
  {
    "text": "of a previously snapshoted worker not volume so that you can see which were",
    "start": "1316820",
    "end": "1321980"
  },
  {
    "text": "the previously running containers by the way that's done let's start now from the",
    "start": "1321980",
    "end": "1327320"
  },
  {
    "text": "exhalations tab so in this example as we said we are in a kubernetes cluster and we know which",
    "start": "1327320",
    "end": "1335240"
  },
  {
    "text": "is the code that was impacted and the first kind of thing that we want to do is for example to label the the port",
    "start": "1335240",
    "end": "1343220"
  },
  {
    "text": "and then apply some Network policy in order to isolate the port in this way if",
    "start": "1343220",
    "end": "1349580"
  },
  {
    "text": "there was an attacker that for example exploited a river shell it will be cut off the body itself because",
    "start": "1349580",
    "end": "1356500"
  },
  {
    "text": "the network policy doesn't allow any kind of Ingress or aggress traffic",
    "start": "1356500",
    "end": "1362240"
  },
  {
    "text": "later you may want to also to call John the Pod denote where the Pod was",
    "start": "1362240",
    "end": "1368360"
  },
  {
    "text": "scheduled so in this way all the new kind of workloads that will be deployed in your cluster will be scheduled",
    "start": "1368360",
    "end": "1375500"
  },
  {
    "text": "elsewhere so in other notes and doing so you are now able to start some other",
    "start": "1375500",
    "end": "1383179"
  },
  {
    "text": "forensics processes like for example snapshot the worker node volume or",
    "start": "1383179",
    "end": "1389860"
  },
  {
    "text": "restrict the network access to the um to the worker node itself you may",
    "start": "1389860",
    "end": "1396140"
  },
  {
    "text": "want to for example remove the IP the external IP that can be used in order to",
    "start": "1396140",
    "end": "1401840"
  },
  {
    "text": "reach that kind of worker node and create an intermediate VM but all these",
    "start": "1401840",
    "end": "1407480"
  },
  {
    "text": "kind of steps are mainly related to traditional step and our focus is right",
    "start": "1407480",
    "end": "1414380"
  },
  {
    "text": "now to to focus I mean to to dig deeper into the investigation of the container",
    "start": "1414380",
    "end": "1420620"
  },
  {
    "text": "itself so let's now assume that we have them first some of these steps that I've just mentioned",
    "start": "1420620",
    "end": "1427039"
  },
  {
    "text": "um and that I'm going into the machine into the worker node that was uh that",
    "start": "1427039",
    "end": "1432320"
  },
  {
    "text": "was scheduled that are scheduled the impacted Port so",
    "start": "1432320",
    "end": "1437480"
  },
  {
    "text": "um we are now into the worker node itself and one of the first things that we want to do is for example to interact",
    "start": "1437480",
    "end": "1444020"
  },
  {
    "text": "with the container in time um of course you must be sure that for",
    "start": "1444020",
    "end": "1449419"
  },
  {
    "text": "example there there was no pods uh escaping or container escaping but we're",
    "start": "1449419",
    "end": "1455000"
  },
  {
    "text": "going to see the eradication um their education step later but one of",
    "start": "1455000",
    "end": "1460820"
  },
  {
    "text": "the main things that we you may want to do for example without interacting directly with the kubernetes API server",
    "start": "1460820",
    "end": "1465860"
  },
  {
    "text": "for example is to interact directory with the container engine see which are the logs that we already seen with",
    "start": "1465860",
    "end": "1473360"
  },
  {
    "text": "fluent pits see which are the running processes and in this example you can",
    "start": "1473360",
    "end": "1478640"
  },
  {
    "text": "see at the bottom the kinsing malware um you can also see that",
    "start": "1478640",
    "end": "1486320"
  },
  {
    "text": "there is uh we used also the uh CTR snapshot div that basically allows you",
    "start": "1486320",
    "end": "1494539"
  },
  {
    "text": "to check which are the changes in the in the file system so if for example the",
    "start": "1494539",
    "end": "1501679"
  },
  {
    "text": "attackers we're able to download some files in the file system and if there were some",
    "start": "1501679",
    "end": "1508400"
  },
  {
    "text": "changes in the file system itself you can spot them from there and you can see that in this case we're engaged the TMP",
    "start": "1508400",
    "end": "1515059"
  },
  {
    "text": "path where they downloaded some suspicious file you can of course uh commit the impacted",
    "start": "1515059",
    "end": "1523760"
  },
  {
    "text": "container so that you can push that image in a remote uh replace in a remote",
    "start": "1523760",
    "end": "1529580"
  },
  {
    "text": "registry or store it as an archive this kind of of course committed and stored",
    "start": "1529580",
    "end": "1536960"
  },
  {
    "text": "image can also be restored later from a sandboxed machine from an analyzer",
    "start": "1536960",
    "end": "1543320"
  },
  {
    "text": "machine that is isolated from your product environment and for example in some I mean",
    "start": "1543320",
    "end": "1552020"
  },
  {
    "text": "some strange other cases you may want you may also want to use a female containers that became stable in version",
    "start": "1552020",
    "end": "1560679"
  },
  {
    "text": "1.25 and that basically allows you to mainly debug the the container state or",
    "start": "1560679",
    "end": "1567679"
  },
  {
    "text": "some attacks evidences they can be useful because um they are simply some kind of strange",
    "start": "1567679",
    "end": "1574520"
  },
  {
    "text": "containers that you cannot touch to the to a Radix system pods accessing",
    "start": "1574520",
    "end": "1580640"
  },
  {
    "text": "directly the same namespace the same process name space of the impacted",
    "start": "1580640",
    "end": "1587299"
  },
  {
    "text": "container and you can see for example which are the running processes of course there are some all disadvantages",
    "start": "1587299",
    "end": "1593000"
  },
  {
    "text": "because if there are some threats they can understand that you jumped into this",
    "start": "1593000",
    "end": "1599240"
  },
  {
    "text": "kind of process name space continuing them space and so they may be dangerous sometimes",
    "start": "1599240",
    "end": "1605960"
  },
  {
    "text": "but useful if for example you have some this strategy image that don't have any kind of shell or tools utilities",
    "start": "1605960",
    "end": "1615559"
  },
  {
    "text": "and in a postmortem analysis you may also want to for example",
    "start": "1615559",
    "end": "1620840"
  },
  {
    "text": "um pool or extract the images that",
    "start": "1620840",
    "end": "1626480"
  },
  {
    "text": "that you you previously committed and pushed in order to download it in",
    "start": "1626480",
    "end": "1631940"
  },
  {
    "text": "another in into analyzer machine you can so in this way you can see for",
    "start": "1631940",
    "end": "1638539"
  },
  {
    "text": "example which were the changes in the first system or and this is one of the best practices",
    "start": "1638539",
    "end": "1644960"
  },
  {
    "text": "of course using these snapshotted volume of the worker node that you have",
    "start": "1644960",
    "end": "1650480"
  },
  {
    "text": "previously created you can use that snapshot that snapshot volume so that",
    "start": "1650480",
    "end": "1656659"
  },
  {
    "text": "you can mount it into an analyzer machine and from the analyzer machine you can",
    "start": "1656659",
    "end": "1662059"
  },
  {
    "text": "use tools like container Explorer or Docker Explorer if you're using uh if",
    "start": "1662059",
    "end": "1667640"
  },
  {
    "text": "you have previously used Docker in order to check which were the previously run in",
    "start": "1667640",
    "end": "1673520"
  },
  {
    "text": "containers and hayab here also this kind of video where",
    "start": "1673520",
    "end": "1679940"
  },
  {
    "text": "I'm showing how to use container Explorer it basically allows",
    "start": "1679940",
    "end": "1686179"
  },
  {
    "text": "you to check which were the previously running containers in the previously it's not shorted volume and from that",
    "start": "1686179",
    "end": "1692840"
  },
  {
    "text": "you can understand for example that there was the Apache impacted container",
    "start": "1692840",
    "end": "1698480"
  },
  {
    "text": "you can use the mount functionality so that you can mount the previously",
    "start": "1698480",
    "end": "1704659"
  },
  {
    "text": "impacted container into the analyzer machine container and from the analyzer machine container you can run all",
    "start": "1704659",
    "end": "1712400"
  },
  {
    "text": "different processes that you want all different steps that you want So at the",
    "start": "1712400",
    "end": "1717679"
  },
  {
    "text": "end of all this video you can see that I was able to successfully mount",
    "start": "1717679",
    "end": "1724400"
  },
  {
    "text": "the container the previously impacted contentful system and then see for example the TMP file system that",
    "start": "1724400",
    "end": "1732520"
  },
  {
    "text": "was impacted by the affected container but okay",
    "start": "1732520",
    "end": "1739360"
  },
  {
    "text": "let's go ahead and another interesting functionality that",
    "start": "1739360",
    "end": "1745600"
  },
  {
    "text": "Works smoothly in podman but not in all the other container engine is container",
    "start": "1745600",
    "end": "1751100"
  },
  {
    "text": "checkpoint a container checkpoint allows you to freeze the container state so",
    "start": "1751100",
    "end": "1756620"
  },
  {
    "text": "this also means container processes container executions so the file descriptors are opened by the con by the",
    "start": "1756620",
    "end": "1764240"
  },
  {
    "text": "processes themselves also some also the TCP connections for example stored them",
    "start": "1764240",
    "end": "1770419"
  },
  {
    "text": "into an archive and then you can later restore the container execution in a",
    "start": "1770419",
    "end": "1776899"
  },
  {
    "text": "separated environment so this is quite useful if you want to understand also",
    "start": "1776899",
    "end": "1781940"
  },
  {
    "text": "turn time which kind of execution were previously launched into the um into the",
    "start": "1781940",
    "end": "1789020"
  },
  {
    "text": "container that was impacted by the way this kind of feature as I said it works",
    "start": "1789020",
    "end": "1794120"
  },
  {
    "text": "smoothly in podman but there are container engine that are trying to integrate it",
    "start": "1794120",
    "end": "1800240"
  },
  {
    "text": "as well I think that there is also the kubernetes checkpoint feature that is a",
    "start": "1800240",
    "end": "1805880"
  },
  {
    "text": "beta a better feature right now and allows you to checkpoint a container",
    "start": "1805880",
    "end": "1811159"
  },
  {
    "text": "calling the couplet request it's it's still a work in progress by the way",
    "start": "1811159",
    "end": "1816740"
  },
  {
    "text": "so at the end of this containment collection phases of course you can do all the forensics processes that you",
    "start": "1816740",
    "end": "1823940"
  },
  {
    "text": "want but it is also important to understand",
    "start": "1823940",
    "end": "1829000"
  },
  {
    "text": "um if the attack spread elsewhere so containers as you know may be run with",
    "start": "1829100",
    "end": "1834320"
  },
  {
    "text": "privileged permissions with cut sensitive mounds and so these may allow",
    "start": "1834320",
    "end": "1840799"
  },
  {
    "text": "attackers to escape from the container from the Pod to The Host you should always take care about the",
    "start": "1840799",
    "end": "1847940"
  },
  {
    "text": "security settings the security contacts that you create in your workloads here I",
    "start": "1847940",
    "end": "1853340"
  },
  {
    "text": "posted for examples to kind of security context and their analysis that was done",
    "start": "1853340",
    "end": "1860360"
  },
  {
    "text": "by cubescore that is another open source project of course if we are talking about pods",
    "start": "1860360",
    "end": "1867440"
  },
  {
    "text": "pods by default are bound to a service account token but I mean",
    "start": "1867440",
    "end": "1873980"
  },
  {
    "text": "most of the times these service accounts token are pretty generic and doesn't",
    "start": "1873980",
    "end": "1879080"
  },
  {
    "text": "allow you to do that much but if you create custom service account",
    "start": "1879080",
    "end": "1885460"
  },
  {
    "text": "um you can communicate with the kubernetes API server create some new",
    "start": "1885679",
    "end": "1890919"
  },
  {
    "text": "make some requests to the kubernetes API server create new resources and",
    "start": "1890919",
    "end": "1897559"
  },
  {
    "text": "technically also do some lateral movement to the to the kubernetes cluster and of course if you're talking",
    "start": "1897559",
    "end": "1905299"
  },
  {
    "text": "about for example kubernetes clusters um I mean most of the time whenever we",
    "start": "1905299",
    "end": "1910640"
  },
  {
    "text": "create a Commodities cluster its worker nodes are bound to IM roles",
    "start": "1910640",
    "end": "1916100"
  },
  {
    "text": "that have some privileges and if you modify those privileges assigning",
    "start": "1916100",
    "end": "1922159"
  },
  {
    "text": "um restricted access to Some Cloud resources these May Grant attackers to",
    "start": "1922159",
    "end": "1927500"
  },
  {
    "text": "attack your Cloud resources as well and yeah of course the recovery that I",
    "start": "1927500",
    "end": "1932840"
  },
  {
    "text": "think it is one of the most uh implicit kind of thing to do at the end of an",
    "start": "1932840",
    "end": "1937880"
  },
  {
    "text": "incident so you have of course to fix the vulnerability if possible sometimes it is not always possible and you want",
    "start": "1937880",
    "end": "1944059"
  },
  {
    "text": "to enforce some mitigation like for example workload like for example delete",
    "start": "1944059",
    "end": "1949159"
  },
  {
    "text": "the workload if of course is possible according to the services that you are providing or the workload that you have",
    "start": "1949159",
    "end": "1955700"
  },
  {
    "text": "or also restore the container and hope that the attack doesn't happen again in",
    "start": "1955700",
    "end": "1961399"
  },
  {
    "text": "the future or enforce some um some Playbook of actions Whenever",
    "start": "1961399",
    "end": "1967760"
  },
  {
    "text": "there is a kind of rule that is detected by for example Falco you can enforce",
    "start": "1967760",
    "end": "1974059"
  },
  {
    "text": "some um some specific Playbook of action in order to say Hey whenever there is this",
    "start": "1974059",
    "end": "1979399"
  },
  {
    "text": "kind of rule that is triggered kill my container so in order to wrap up this session I'm",
    "start": "1979399",
    "end": "1986600"
  },
  {
    "text": "now leaving the floor to Stefan again so thanks Alberto for all the",
    "start": "1986600",
    "end": "1992179"
  },
  {
    "text": "information shared and of course the last step that required in the ascent",
    "start": "1992179",
    "end": "1999919"
  },
  {
    "text": "response plan is post incident activities so we took all the action",
    "start": "1999919",
    "end": "2006700"
  },
  {
    "text": "needed to contain eradicate the the threat and we restored and recover the",
    "start": "2006700",
    "end": "2013480"
  },
  {
    "text": "environment and this is now back to normal and it's all working great so that's fine and it's now time to do some",
    "start": "2013480",
    "end": "2021220"
  },
  {
    "text": "retrospective to get lesson learned from the incident some there are something that probably",
    "start": "2021220",
    "end": "2027220"
  },
  {
    "text": "worked other stuff that probably didn't work so it's important to understand why they didn't work and what didn't work",
    "start": "2027220",
    "end": "2034419"
  },
  {
    "text": "and perhaps understanding how we can do better so",
    "start": "2034419",
    "end": "2039460"
  },
  {
    "text": "the output of this of this phase is literally a kind of checklist of of",
    "start": "2039460",
    "end": "2045700"
  },
  {
    "text": "points and a list point of uh of what we need to improve and this is basically",
    "start": "2045700",
    "end": "2051280"
  },
  {
    "text": "the input for the for the update of the of the incident response that we have So",
    "start": "2051280",
    "end": "2056980"
  },
  {
    "text": "based on the feedback based on what we discover during during the incident we",
    "start": "2056980",
    "end": "2062138"
  },
  {
    "text": "can update our incidental response plan make it better and be sure",
    "start": "2062139",
    "end": "2067960"
  },
  {
    "text": "to avoid the same incident in the future so of course what happened we can do",
    "start": "2067960",
    "end": "2073658"
  },
  {
    "text": "much but we should take these as a good opportunity to do a better work in the",
    "start": "2073659",
    "end": "2080800"
  },
  {
    "text": "future uh so just to wrap up what we said and",
    "start": "2080800",
    "end": "2086080"
  },
  {
    "text": "just get some main uh takeaways from this talk so as I said don't be caught",
    "start": "2086080",
    "end": "2092320"
  },
  {
    "text": "unprepared uh prepare your instant plan as soon as possible uh as we said this",
    "start": "2092320",
    "end": "2098200"
  },
  {
    "text": "is fundamental you need to be prepared if something happened",
    "start": "2098200",
    "end": "2103500"
  },
  {
    "text": "of course um we need to respond as soon as possible",
    "start": "2103500",
    "end": "2109240"
  },
  {
    "text": "as we said a container are a female container may not be there some",
    "start": "2109240",
    "end": "2115000"
  },
  {
    "text": "activities needs to be done when the container is still alive so be prepared",
    "start": "2115000",
    "end": "2120700"
  },
  {
    "text": "and act as soon as possible um the other point as Alberto said",
    "start": "2120700",
    "end": "2128980"
  },
  {
    "text": "container are aren't isolated by default right as we know so there might happen",
    "start": "2128980",
    "end": "2134560"
  },
  {
    "text": "like container escaping and and the attacks move to the to the host or to the node or in other parts of your",
    "start": "2134560",
    "end": "2141820"
  },
  {
    "text": "infrastructure so don't just focus on the container that that was exploited",
    "start": "2141820",
    "end": "2147040"
  },
  {
    "text": "during your investigation but go farther and there might be more to investigate so be prepared of uh not just looking",
    "start": "2147040",
    "end": "2155020"
  },
  {
    "text": "the container but also check all the rest of infrastructure see the lateral movements if there was something and be",
    "start": "2155020",
    "end": "2162640"
  },
  {
    "text": "prepared to go further investigation and also is is important to have full",
    "start": "2162640",
    "end": "2171180"
  },
  {
    "text": "fully monitoring your your infrastructure so be sure to have all",
    "start": "2171180",
    "end": "2176740"
  },
  {
    "text": "the visibility that you need in order to perform all the activities that we saw before",
    "start": "2176740",
    "end": "2183280"
  },
  {
    "text": "um as we said there are and as we have seen there are specific tools that we need to use and we need to know how they",
    "start": "2183280",
    "end": "2190540"
  },
  {
    "text": "works and which tool we need to use as we said there are a bunch of different tools but",
    "start": "2190540",
    "end": "2197859"
  },
  {
    "text": "we need to stay updated and we need to know how to use them before the the incident happens",
    "start": "2197859",
    "end": "2204220"
  },
  {
    "text": "uh also is actually important and is actually the best practice to simulate",
    "start": "2204220",
    "end": "2210240"
  },
  {
    "text": "breaches to see the response of the plan of the people that are involved to see",
    "start": "2210240",
    "end": "2216460"
  },
  {
    "text": "if it's it's working or if you you need to involve you need to involve different",
    "start": "2216460",
    "end": "2223000"
  },
  {
    "text": "people perhaps or update contacts or whatever so check your plans is not",
    "start": "2223000",
    "end": "2228400"
  },
  {
    "text": "enough just create the plan and say okay we have done it we need to check it see if it's working if not update it and",
    "start": "2228400",
    "end": "2235660"
  },
  {
    "text": "make sure that this is working great as you expected and then be ready for the",
    "start": "2235660",
    "end": "2241660"
  },
  {
    "text": "for the real incident and last but not least um as we have seen in order to do these",
    "start": "2241660",
    "end": "2250000"
  },
  {
    "text": "kind of activities so especially in the far for containers but same for other Technologies we need people that knows",
    "start": "2250000",
    "end": "2256900"
  },
  {
    "text": "and have background on kubernetes containers but also instant response",
    "start": "2256900",
    "end": "2262599"
  },
  {
    "text": "knowledge sometimes of course we don't have the knowledge inside our",
    "start": "2262599",
    "end": "2267820"
  },
  {
    "text": "organization or inside our team so it's important to hire or engage someone else",
    "start": "2267820",
    "end": "2274180"
  },
  {
    "text": "that has this kind of knowledge and can be and can do all these activities in a",
    "start": "2274180",
    "end": "2280599"
  },
  {
    "text": "good way right as we said in also in digital forensic the we need to maintain",
    "start": "2280599",
    "end": "2286300"
  },
  {
    "text": "the chain of cars today so it's important to do some specific activities in following best practice in in good",
    "start": "2286300",
    "end": "2293740"
  },
  {
    "text": "ways so that we we can use this data in in court or wherever it was so it's not",
    "start": "2293740",
    "end": "2299560"
  },
  {
    "text": "we need to have this um uh this knowledge and we need to do the old activities in in a proper way",
    "start": "2299560",
    "end": "2307599"
  },
  {
    "text": "uh so I get that's it from us thanks for joining and I think we are actually",
    "start": "2307599",
    "end": "2313240"
  },
  {
    "text": "running out of time but if you have any questions we are here uh we can answer offline if you have any question thank",
    "start": "2313240",
    "end": "2319540"
  },
  {
    "text": "you very much",
    "start": "2319540",
    "end": "2321960"
  }
]