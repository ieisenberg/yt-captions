[
  {
    "text": "hey thanks everybody for coming to our talk today about uh",
    "start": "80",
    "end": "5600"
  },
  {
    "text": "debugging cni uh it's something that touches all of us",
    "start": "5600",
    "end": "11200"
  },
  {
    "text": "when we're kubernetes users and we wanted to share with you our experience my name is doug smith and i'm the",
    "start": "11200",
    "end": "18480"
  },
  {
    "text": "technical lead for the openshift network plumbing team we deal with kind of all things cni as",
    "start": "18480",
    "end": "25680"
  },
  {
    "text": "well as multi-networking with multi-cni and i'm a member of a network plumbing",
    "start": "25680",
    "end": "31199"
  },
  {
    "text": "working group um and i'm joined with daniel here today so hi hello everyone so i'm also being",
    "start": "31199",
    "end": "38800"
  },
  {
    "text": "part of the openshift scene networking team and i've been basically the project team lead for the",
    "start": "38800",
    "end": "43920"
  },
  {
    "text": "project we regard cnn plugins which is called query kubernetes so basically deal with a lot of networking and stuff",
    "start": "43920",
    "end": "49920"
  },
  {
    "text": "during rehab as well with that all right so what we're going to talk",
    "start": "49920",
    "end": "55039"
  },
  {
    "text": "about today is first a brief introduction to cni to help let you know",
    "start": "55039",
    "end": "60719"
  },
  {
    "text": "kind of where things live and what the touch points are and kind of a flow of",
    "start": "60719",
    "end": "66880"
  },
  {
    "text": "what cni does we're going to look at some of the basics for cni debugging and",
    "start": "66880",
    "end": "72960"
  },
  {
    "text": "then daniel's going to give us an overview of cni tool and come into a",
    "start": "72960",
    "end": "78960"
  },
  {
    "text": "demo to show you exactly how he tackles debugging",
    "start": "78960",
    "end": "85040"
  },
  {
    "text": "we're also going to then kind of feed this information back into what we think",
    "start": "85040",
    "end": "90320"
  },
  {
    "text": "needs to happen for cni 2.0 and how we can as a community make this better",
    "start": "90320",
    "end": "96960"
  },
  {
    "text": "as uh we come together so cni it's the container networking interface it",
    "start": "96960",
    "end": "104560"
  },
  {
    "text": "what cni is is an api and each of",
    "start": "104560",
    "end": "110720"
  },
  {
    "text": "the cni plug-ins are discrete binaries that live on disk that you'll see here",
    "start": "110720",
    "end": "116159"
  },
  {
    "text": "by the cni binary directory that's something you you got to know where it is",
    "start": "116159",
    "end": "122000"
  },
  {
    "text": "and you also have cni configurations that feed into those those are executed by your container",
    "start": "122000",
    "end": "130800"
  },
  {
    "text": "runtime implementation so depending on your distribution of kubernetes you'll have either a container d or a cryo",
    "start": "130800",
    "end": "138640"
  },
  {
    "text": "that's going to fire off and both there's a commonality between",
    "start": "138640",
    "end": "144239"
  },
  {
    "text": "both of those which is lib cni which is provided by the cni maintainers",
    "start": "144239",
    "end": "150080"
  },
  {
    "text": "so between your container runtime implementation the cubelet and your cni",
    "start": "150080",
    "end": "155840"
  },
  {
    "text": "plugins themselves those plugins will then go and manipulate your pod sandbox so that's",
    "start": "155840",
    "end": "163200"
  },
  {
    "text": "where you're going to have a network namespace and that's where your cni plug-in is going to do",
    "start": "163200",
    "end": "168400"
  },
  {
    "text": "its primary work of creating the network interfaces that you see",
    "start": "168400",
    "end": "173680"
  },
  {
    "text": "in your pods when you've got a cni plug-in call it's",
    "start": "173680",
    "end": "179280"
  },
  {
    "text": "really kind of a simple flow what happens is your",
    "start": "179280",
    "end": "184720"
  },
  {
    "text": "runtime implementation using libcni is going to call a binary that's on the",
    "start": "184720",
    "end": "191040"
  },
  {
    "text": "host and it's going to call it with some environment variables that give you some",
    "start": "191040",
    "end": "197360"
  },
  {
    "text": "information about the call that's being made and then it's going to feed in a",
    "start": "197360",
    "end": "202599"
  },
  {
    "text": "configuration through standard in your plugin itself then will speak via",
    "start": "202599",
    "end": "209280"
  },
  {
    "text": "standard out and it'll give a cni result as specified by the cni spec and then",
    "start": "209280",
    "end": "215920"
  },
  {
    "text": "additionally it'll have an exit code which counts so if you don't exit zero",
    "start": "215920",
    "end": "221120"
  },
  {
    "text": "that pods gonna go off into a crash loop and try again",
    "start": "221120",
    "end": "227519"
  },
  {
    "text": "yeah so as dark was mentioned in here let me see any specification we got to",
    "start": "227519",
    "end": "232879"
  },
  {
    "text": "implement basically four different differently from different calls so we'll see now add del check and version",
    "start": "232879",
    "end": "239360"
  },
  {
    "text": "even though this is somehow mandatory from this specification you don't really most of the plugins they don't implement",
    "start": "239360",
    "end": "245439"
  },
  {
    "text": "checks so as the name implies i would just basically add a container for a network or apply",
    "start": "245439",
    "end": "251519"
  },
  {
    "text": "modifications on your plugin delete would remove a container for the network um whatever buys",
    "start": "251519",
    "end": "258320"
  },
  {
    "text": "the dell operation should return zero or you may get into a terrible terrible",
    "start": "258320",
    "end": "264160"
  },
  {
    "text": "crashly backup that we will speak about later and also the delete operation may not be",
    "start": "264160",
    "end": "269360"
  },
  {
    "text": "successful should some operations in the node be happening such as a rebooting so",
    "start": "269360",
    "end": "274400"
  },
  {
    "text": "then you would need to delete basically the remaining things on your own then you got check check",
    "start": "274400",
    "end": "280400"
  },
  {
    "text": "as i said it's not really implemented i'm going to be showing an example about the cna plugin that we developed specifically for cubeco which is called",
    "start": "280400",
    "end": "286639"
  },
  {
    "text": "cubeconcinia and that does automatically nothing but uh i think it's a good example to",
    "start": "286639",
    "end": "292479"
  },
  {
    "text": "see how the you know seen applying could be bootstrapped and version will be just you know getting you back to with the virtual",
    "start": "292479",
    "end": "299360"
  },
  {
    "text": "name from the ci plugin so c9 plugins get their configuration",
    "start": "299360",
    "end": "306960"
  },
  {
    "text": "by a json file even though there's a lot of fields in the json file",
    "start": "306960",
    "end": "312800"
  },
  {
    "text": "what you should just be you know keeping up with is that you don't really need to have all these fields uh i'll be showing that",
    "start": "312800",
    "end": "319680"
  },
  {
    "text": "now as of now but the cni um elementary fields are just",
    "start": "319680",
    "end": "324880"
  },
  {
    "text": "version name and type besides that you can add whatever fields",
    "start": "324880",
    "end": "330160"
  },
  {
    "text": "you may like to use in your own implementation and then ipam and dns once uh ipam is a little special we'll",
    "start": "330160",
    "end": "337840"
  },
  {
    "text": "speak about light editor but for now let's take a quick look about the keep concentrate plugin",
    "start": "337840",
    "end": "344080"
  },
  {
    "text": "so uh i hope that this is big enough let's make a little bit bigger just in case",
    "start": "345039",
    "end": "352199"
  },
  {
    "text": "so how do i really make a ci plugin as i was saying this does nothing but as you",
    "start": "353680",
    "end": "359440"
  },
  {
    "text": "can basically figure it out we are implementing the scale from the plugin and we got the four meters there we got",
    "start": "359440",
    "end": "366720"
  },
  {
    "text": "add dell the version and as i was commenting we don't are not going to really be really implementing check at",
    "start": "366720",
    "end": "372400"
  },
  {
    "text": "all in this case but uh if you just go and check the cm the add version you see that it's",
    "start": "372400",
    "end": "379039"
  },
  {
    "text": "basically loading the netcode data from there it's going to be getting you an error should that happen and we are just",
    "start": "379039",
    "end": "384800"
  },
  {
    "text": "basically returning a json so nothing really fancy i'm mentioning this because",
    "start": "384800",
    "end": "390479"
  },
  {
    "text": "developing a scene plugin is not straightforward even if this is just so easy because there's seldom to know",
    "start": "390479",
    "end": "396400"
  },
  {
    "text": "documentation and how to do this so most of the people just read the spec but there is no a real example this is",
    "start": "396400",
    "end": "402800"
  },
  {
    "text": "something that someone should improve you're happy to you know fill any request request",
    "start": "402800",
    "end": "408080"
  },
  {
    "text": "just something to mention quick uh about this plugin that daniel is showing is",
    "start": "408080",
    "end": "414000"
  },
  {
    "text": "we've got this code available on github we've got a link later in the presentation but",
    "start": "414000",
    "end": "420319"
  },
  {
    "text": "this is what i would call a dummy cni plug-in and it's something that you could take just as a skeletal structure",
    "start": "420319",
    "end": "427840"
  },
  {
    "text": "and put in some logging and use it to substitute in for a currently running",
    "start": "427840",
    "end": "433120"
  },
  {
    "text": "cni plug-in if you wanted to get some debug data as well",
    "start": "433120",
    "end": "438639"
  },
  {
    "text": "carry on and one other cni configuration just to",
    "start": "438639",
    "end": "444560"
  },
  {
    "text": "go over briefly is what we call a conflict otherwise known as",
    "start": "444560",
    "end": "450960"
  },
  {
    "text": "chained cni plugins this is where instead of having the type field you're",
    "start": "450960",
    "end": "456080"
  },
  {
    "text": "going to have this plugins array and",
    "start": "456080",
    "end": "461360"
  },
  {
    "text": "i wanted to show this specifically because in the cni 1.0 spec",
    "start": "461360",
    "end": "467120"
  },
  {
    "text": "it will be all configurationless all conflicts so you're always going to see this",
    "start": "467120",
    "end": "473759"
  },
  {
    "text": "list even if it's a list of one in the future so just to give you a quick",
    "start": "473759",
    "end": "479680"
  },
  {
    "text": "example of that all right so let's um just get into some",
    "start": "479680",
    "end": "486319"
  },
  {
    "text": "of the basics one of the first things that you're going to want to do when you dig in and start debugging cni is to",
    "start": "486319",
    "end": "494720"
  },
  {
    "text": "figure out where are your comfter and your bender",
    "start": "494720",
    "end": "500800"
  },
  {
    "text": "this is the bender is where your cni plugins exist themselves so those",
    "start": "500800",
    "end": "507360"
  },
  {
    "text": "are the binaries that are on disk and as well as your comfter which is",
    "start": "507360",
    "end": "512399"
  },
  {
    "text": "going to have your primary cni configuration there's some defaults and most of the",
    "start": "512399",
    "end": "519599"
  },
  {
    "text": "time you're going to find these in the default directories however they're configurable and since the cubelet is",
    "start": "519599",
    "end": "527680"
  },
  {
    "text": "going to be in charge of kicking off this process that's where you're going to find",
    "start": "527680",
    "end": "533600"
  },
  {
    "text": "the configuration for these so two places that you want to look you want to look at your",
    "start": "533600",
    "end": "541279"
  },
  {
    "text": "cubelets command line arguments so just do a ps look for that see how it's",
    "start": "541600",
    "end": "547839"
  },
  {
    "text": "actually running if it's not specified there don't assume it's the fault the defaults what you're",
    "start": "547839",
    "end": "554480"
  },
  {
    "text": "going to want to do is actually pull up the cubelet configuration so",
    "start": "554480",
    "end": "559600"
  },
  {
    "text": "if you're using if your distribution happens to use a non-default location you can really burn some cycles trying",
    "start": "559600",
    "end": "566959"
  },
  {
    "text": "to look and just to the wrong place",
    "start": "566959",
    "end": "571680"
  },
  {
    "text": "something that you've got to realize related to your uh",
    "start": "572480",
    "end": "577680"
  },
  {
    "text": "binder is that the type field itself where you've got you know flannel calico",
    "start": "577680",
    "end": "583920"
  },
  {
    "text": "psyllium whatever it may happen to be that's actually referring to a binary in",
    "start": "583920",
    "end": "589680"
  },
  {
    "text": "your bender path itself so that's what it's actually going to execute so be mindful",
    "start": "589680",
    "end": "597120"
  },
  {
    "text": "of the fact that that has to be an actual file that lives on disk and that",
    "start": "597120",
    "end": "602560"
  },
  {
    "text": "matches the value that's there something that i've seen happen many a",
    "start": "602560",
    "end": "607920"
  },
  {
    "text": "time is that you're having a failure and it's because you've specified uh this",
    "start": "607920",
    "end": "614399"
  },
  {
    "text": "configuration yet your c and cni plugin itself hasn't installed properly or isn't installed on",
    "start": "614399",
    "end": "621200"
  },
  {
    "text": "disk so that's one thing to take a look for and",
    "start": "621200",
    "end": "626240"
  },
  {
    "text": "related to your configuration directory this is going to um the cni",
    "start": "626240",
    "end": "633600"
  },
  {
    "text": "configuration that's alphabetically first there is the presence of that file",
    "start": "633600",
    "end": "639120"
  },
  {
    "text": "is going to determine if your node is marked ready so if you do a cube cuddle",
    "start": "639120",
    "end": "644560"
  },
  {
    "text": "get nodes you'll see a status field ready or not ready and that cni configuration is a",
    "start": "644560",
    "end": "652880"
  },
  {
    "text": "semaphore for the cubelet to know that this node is ready to",
    "start": "652880",
    "end": "659040"
  },
  {
    "text": "handle network traffic so as a cni developer you want to be",
    "start": "659040",
    "end": "664160"
  },
  {
    "text": "mindful of how you lay down your cni configuration on disk and as an",
    "start": "664160",
    "end": "670880"
  },
  {
    "text": "administrator you want to be mindful of how this process works so that you can",
    "start": "670880",
    "end": "676720"
  },
  {
    "text": "know if your nodes are tainted properly or not",
    "start": "676720",
    "end": "682079"
  },
  {
    "text": "in order to accept these pods so you can of course set up pods that you may want to have run very",
    "start": "682079",
    "end": "689440"
  },
  {
    "text": "early in your cluster life cycle to tolerate um the not ready state",
    "start": "689440",
    "end": "695920"
  },
  {
    "text": "however if you're seeing that you're in a not ready state your pods aren't getting scheduled um go ahead and take a",
    "start": "695920",
    "end": "704320"
  },
  {
    "text": "look in your comfter to make sure that that cni configuration isn't there and",
    "start": "704320",
    "end": "710000"
  },
  {
    "text": "if it's not there you'll prob it's probably specific to um your primary cni that you would use",
    "start": "710000",
    "end": "717680"
  },
  {
    "text": "for no pod to pod traffic so for example if it's flannel that's",
    "start": "717680",
    "end": "724480"
  },
  {
    "text": "installed with a daemon set so check out what's going on with that daemon set and then enter your node to check out what's",
    "start": "724480",
    "end": "731440"
  },
  {
    "text": "up a few more just quick tips for debugging",
    "start": "731440",
    "end": "737040"
  },
  {
    "text": "uh the number one thing that will bite me is",
    "start": "737040",
    "end": "742160"
  },
  {
    "text": "json so it's great for parsing it's not so great for humans so",
    "start": "742160",
    "end": "749360"
  },
  {
    "text": "whenever you're mucking around with your cni configs in json just send them",
    "start": "749360",
    "end": "755200"
  },
  {
    "text": "through a linter all the time so jq is the one we use all the time or",
    "start": "755200",
    "end": "761519"
  },
  {
    "text": "just if you don't have it on your system just cat it out and grab a json linter on the",
    "start": "761519",
    "end": "767360"
  },
  {
    "text": "web in terms of logging this can be tricky and very",
    "start": "767360",
    "end": "774240"
  },
  {
    "text": "cni plug-in specific since these plug-ins speak uh standard",
    "start": "774240",
    "end": "779360"
  },
  {
    "text": "in standard out that standard out from your plug-in if it exits non-zero",
    "start": "779360",
    "end": "786720"
  },
  {
    "text": "that is going to be captured by the cubelet itself so that's a primary place",
    "start": "786720",
    "end": "792880"
  },
  {
    "text": "that you want to look for any cni specific errors",
    "start": "792880",
    "end": "798000"
  },
  {
    "text": "and then depending on the specific cni plugging it is the developers may have",
    "start": "798000",
    "end": "804320"
  },
  {
    "text": "implemented the logging in a specific way so check the docs to see if there's",
    "start": "804320",
    "end": "811040"
  },
  {
    "text": "any sort of parameters that could potentially enhance logging",
    "start": "811040",
    "end": "816880"
  },
  {
    "text": "and it's also possible that in some cases",
    "start": "816880",
    "end": "821920"
  },
  {
    "text": "you'll have cni plug-ins that have a daemon component that's running in a pod",
    "start": "821920",
    "end": "827360"
  },
  {
    "text": "so as i mentioned we've got these binaries that run on that are on the host and are on disk",
    "start": "827360",
    "end": "833920"
  },
  {
    "text": "and then we have some that are that could potentially be running as a daemon in a pod so check both on the",
    "start": "833920",
    "end": "841279"
  },
  {
    "text": "host and in the pods and if you're a developer please add some additional logging for",
    "start": "841279",
    "end": "848720"
  },
  {
    "text": "your administrators this is they can be particularly tricky to debug",
    "start": "848720",
    "end": "855199"
  },
  {
    "text": "last but not least when you're debugging cni you're often doing it specific node",
    "start": "855199",
    "end": "861360"
  },
  {
    "text": "to node and you'll be on one particular node and if you're making manipulations",
    "start": "861360",
    "end": "866560"
  },
  {
    "text": "to that node you'll find yourself having to muck around with labels node selectors all of that kind",
    "start": "866560",
    "end": "874160"
  },
  {
    "text": "of stuff you may want to just use static pods which allow you to put a",
    "start": "874160",
    "end": "881279"
  },
  {
    "text": "yaml file specifying your pod on that particular node and then it'll spin up on that node so it's a handy way",
    "start": "881279",
    "end": "889040"
  },
  {
    "text": "to kind of get around that",
    "start": "889040",
    "end": "893120"
  },
  {
    "text": "so i also wanted to speak a little bit about cna tool which is a tool that comes within the repo of the cni itself",
    "start": "894160",
    "end": "900000"
  },
  {
    "text": "because so recapping so how do we get the cnip plugins to work so you can see in a plugin it's a",
    "start": "900000",
    "end": "907040"
  },
  {
    "text": "binary which may get installed into all the nodes from the cluster using the demon set of whatever then you may need",
    "start": "907040",
    "end": "914160"
  },
  {
    "text": "to go see what happens when you are going to you know go and develop the binary how do you copy that then also",
    "start": "914160",
    "end": "920639"
  },
  {
    "text": "you would need to check the logins maybe as this is executed by the cubelet you may want to go to the cubelet or cryo so",
    "start": "920639",
    "end": "927199"
  },
  {
    "text": "this is maybe a little bit too excessive for a developer who might not even have access to a quantitative cluster and maybe not even kind",
    "start": "927199",
    "end": "933759"
  },
  {
    "text": "so the cni repo comes with a tool which is a swiss army knife which",
    "start": "933759",
    "end": "939279"
  },
  {
    "text": "is basically getting um your binary and getting your",
    "start": "939279",
    "end": "944880"
  },
  {
    "text": "configuration that i spoke before which is basically a json file with all the tooling from there it will create a",
    "start": "944880",
    "end": "950959"
  },
  {
    "text": "network name and space and then you will be able just to test that out we got a demo about that so",
    "start": "950959",
    "end": "956160"
  },
  {
    "text": "i'll be showing that you know for you later and in fact if you just want to create a cineplus cnn plugin check out",
    "start": "956160",
    "end": "962560"
  },
  {
    "text": "cna tool and make it work using the network namespaces because you'll definitely get an awful lot more of",
    "start": "962560",
    "end": "968639"
  },
  {
    "text": "information rather than just you know a crash loop on the pod or yes a sandbox",
    "start": "968639",
    "end": "974160"
  },
  {
    "text": "could because sandbox couldn't get created and so forth so again and as we were commenting",
    "start": "974160",
    "end": "979360"
  },
  {
    "text": "before one of the things that these cna plugins don't usually have especially the reference ones are is login a login boot",
    "start": "979360",
    "end": "986959"
  },
  {
    "text": "just makes your life so much easier and even the user or the administration",
    "start": "986959",
    "end": "992399"
  },
  {
    "text": "because they will know how to debug the thing and what's going on so let's get you started with some demo",
    "start": "992399",
    "end": "998959"
  },
  {
    "text": "okay",
    "start": "1002399",
    "end": "1004880"
  },
  {
    "text": "so is the phone big enough or they make it bigger let's make it a little bit bb here",
    "start": "1007680",
    "end": "1013040"
  },
  {
    "text": "so we'll start by creating just a kind cluster uh no rocket science just a quick uh",
    "start": "1014639",
    "end": "1021120"
  },
  {
    "text": "kubernetes over docker demo so let's get kick in by the way we had to do some",
    "start": "1021120",
    "end": "1026558"
  },
  {
    "text": "modifications because of the wi-fi from the venue so we wanted this to be real live sorry in advance guys we couldn't",
    "start": "1026559",
    "end": "1032319"
  },
  {
    "text": "make it no we are going to be starting and by",
    "start": "1032319",
    "end": "1037600"
  },
  {
    "text": "the way this kind cluster has no cnn plugins so at the beginning the node would be in the not radio state so let's",
    "start": "1037600",
    "end": "1043760"
  },
  {
    "text": "get the primary genetic plugin which is going to be zelium uh let's build the image from here",
    "start": "1043760",
    "end": "1051440"
  },
  {
    "text": "we got it and then let's load the image into kind",
    "start": "1051440",
    "end": "1057039"
  },
  {
    "text": "ok there we go um we are going to be also using",
    "start": "1057600",
    "end": "1062799"
  },
  {
    "text": "move to cni as a way to have several cnn plugins working within the same pod and",
    "start": "1062799",
    "end": "1068480"
  },
  {
    "text": "have several interfaces on the same pod",
    "start": "1068480",
    "end": "1072559"
  },
  {
    "text": "so there we go running so okay how modulus works how do i add a",
    "start": "1076960",
    "end": "1082880"
  },
  {
    "text": "secondary network interface or a secondary network so you you need to use",
    "start": "1082880",
    "end": "1088160"
  },
  {
    "text": "a network crd which is called a network type definition which has",
    "start": "1088160",
    "end": "1093679"
  },
  {
    "text": "this way if you see i'm also injecting the copy from the cinema plugin we are going to be using the plugin that we",
    "start": "1093679",
    "end": "1099760"
  },
  {
    "text": "just bought before that we developed for this for this conference the keepcon cni and again this is a binary which is",
    "start": "1099760",
    "end": "1106000"
  },
  {
    "text": "going to be accepted later on",
    "start": "1106000",
    "end": "1109840"
  },
  {
    "text": "now let's create a pod how do i hook up this secondary network in the pod you're",
    "start": "1112480",
    "end": "1117520"
  },
  {
    "text": "going to be using an annotation and if you see it has the same name",
    "start": "1117520",
    "end": "1123039"
  },
  {
    "text": "from the configuration that we used before so that would create the secondary network interface",
    "start": "1123039",
    "end": "1129360"
  },
  {
    "text": "so far this is okay so now we got a pod with two nicks running",
    "start": "1130640",
    "end": "1137840"
  },
  {
    "text": "but let's what happens if you mess up let's assume you create a secondary network with an unvalidated",
    "start": "1137919",
    "end": "1143280"
  },
  {
    "text": "configuration how would you deback this okay here we are going to create yet another",
    "start": "1143280",
    "end": "1150400"
  },
  {
    "text": "network attachment definition which is going to be nonvalid because this is just not there",
    "start": "1150400",
    "end": "1156480"
  },
  {
    "text": "and if we get to see",
    "start": "1156480",
    "end": "1159600"
  },
  {
    "text": "the pods okay let's see there we go",
    "start": "1162799",
    "end": "1168320"
  },
  {
    "text": "those are the annotations filled from the first spot this is running it's okay if you can see it has you know two",
    "start": "1168320",
    "end": "1174320"
  },
  {
    "text": "different interface as well from the ceiling scene eye and the other one from the give concealer and that's okay",
    "start": "1174320",
    "end": "1180480"
  },
  {
    "text": "but what happens with the other one the other one it says it seems to be",
    "start": "1180480",
    "end": "1186320"
  },
  {
    "text": "okay but",
    "start": "1186320",
    "end": "1189639"
  },
  {
    "text": "it's container crating and it's going to be there forever until it gets to craft loop because",
    "start": "1192720",
    "end": "1198640"
  },
  {
    "text": "as we were commenting and in earlier slides one of the most common things and issues",
    "start": "1198640",
    "end": "1205039"
  },
  {
    "text": "when creating one of these is that the cnn plugin is just not there on the binary so we are using",
    "start": "1205039",
    "end": "1210559"
  },
  {
    "text": "psyllium which is there of course it works and then we are using the kitcon cni which exists and the other one which",
    "start": "1210559",
    "end": "1216400"
  },
  {
    "text": "doesn't so how could we you know debug this out",
    "start": "1216400",
    "end": "1221840"
  },
  {
    "text": "so if we go to the keyboard locks you'll see that it's just trying to",
    "start": "1222000",
    "end": "1227039"
  },
  {
    "text": "create the pod sandbox and it's trying to hook up into the binary but it's just not there",
    "start": "1227039",
    "end": "1232559"
  },
  {
    "text": "so getting back to the cni plugin path and let's assume that we are using the",
    "start": "1232559",
    "end": "1237600"
  },
  {
    "text": "default path you could get to see that most of the blanks are there you",
    "start": "1237600",
    "end": "1243760"
  },
  {
    "text": "know we've got cylinders and i we go the cube can see now why do we don't have the other one we are referencing so this",
    "start": "1243760",
    "end": "1249039"
  },
  {
    "text": "of course would always fail",
    "start": "1249039",
    "end": "1252480"
  },
  {
    "text": "i also wanted to speak a little bit about okay how would i test this so keep can see and i",
    "start": "1254400",
    "end": "1260559"
  },
  {
    "text": "if we are on the cni plugin path you could always just go ahead and you know",
    "start": "1260559",
    "end": "1266000"
  },
  {
    "text": "call the plugin those are all binaries and if you are on each node you can just you know execute them if you see the",
    "start": "1266000",
    "end": "1272000"
  },
  {
    "text": "this hypocrite is just kicking out like today's date so it's that's nothing fancy but i think it's a great example",
    "start": "1272000",
    "end": "1279280"
  },
  {
    "text": "on how to handle this on so feel free to check that in github",
    "start": "1279280",
    "end": "1284400"
  },
  {
    "text": "and i also spoke about cni tool so how would i check locally and without having to deal with any cluster uh my",
    "start": "1284400",
    "end": "1291679"
  },
  {
    "text": "genetic plugin and the configuration so for instance this is a sample configuration that they took",
    "start": "1291679",
    "end": "1297600"
  },
  {
    "text": "out for the uh router cni which is also available on github so",
    "start": "1297600",
    "end": "1302960"
  },
  {
    "text": "basically it it's meant to be expecting a few and ip addresses and a few ports",
    "start": "1302960",
    "end": "1309600"
  },
  {
    "text": "if you sit there i'll say that the address is just called kubecon and the destination is called bimfubre so this",
    "start": "1309600",
    "end": "1316400"
  },
  {
    "text": "won't ever work so what happens let's just give the try to and test this with a cni tool",
    "start": "1316400",
    "end": "1323600"
  },
  {
    "text": "so i got this script which is just basically first i do create a network timespace",
    "start": "1324400",
    "end": "1330240"
  },
  {
    "text": "then i do call cna plugin if you check there i'm just asking for it to do a cna add command",
    "start": "1330240",
    "end": "1336880"
  },
  {
    "text": "using the error sorted binary so irrestorative binary is again the name and the type for that cni plane that",
    "start": "1336880",
    "end": "1342559"
  },
  {
    "text": "we're testing so let's run it",
    "start": "1342559",
    "end": "1349280"
  },
  {
    "text": "here this is one of the plugins that has loggings so i again the login is enabled",
    "start": "1350159",
    "end": "1357280"
  },
  {
    "text": "so this is again an awesome theme because you would be able to see what's going on so it's we",
    "start": "1357280",
    "end": "1362720"
  },
  {
    "text": "are calling out we are trying to set a gateway which of course doesn't work but you can see some stuff",
    "start": "1362720",
    "end": "1367760"
  },
  {
    "text": "this doesn't happen for any of the reference plugins and as that was commented before it's and as of now and",
    "start": "1367760",
    "end": "1374960"
  },
  {
    "text": "we hope that this is going to be you know being improved by the cine2o con specification every single plugin needs",
    "start": "1374960",
    "end": "1381039"
  },
  {
    "text": "to go and implement their own login so we're about cni they do login multicni",
    "start": "1381039",
    "end": "1387200"
  },
  {
    "text": "they do login but most of them don't let's try to do the same with the keep",
    "start": "1387200",
    "end": "1392960"
  },
  {
    "text": "consumer that we just had here again as i was commenting before",
    "start": "1392960",
    "end": "1398640"
  },
  {
    "text": "you just need to put in the type and the name and the cni version it's nothing much more so that",
    "start": "1398640",
    "end": "1404240"
  },
  {
    "text": "would be the scale of the first inner plane you're going to be playing with afterwards you could just go and add any fields that you would be happy to",
    "start": "1404240",
    "end": "1412320"
  },
  {
    "text": "this is just the same script adapted to the other ci plugin and what's going on",
    "start": "1414320",
    "end": "1420559"
  },
  {
    "text": "there you go it gives you a valid output so should it has failed we wouldn't have",
    "start": "1421360",
    "end": "1426799"
  },
  {
    "text": "any way of knowing that because there's no login so that's why i do really encourage you to please please please when developing cnn plugins please",
    "start": "1426799",
    "end": "1433520"
  },
  {
    "text": "implement login okay so thank you for attending the demo",
    "start": "1433520",
    "end": "1440880"
  },
  {
    "text": "cool thanks daniel really appreciate it all right so to briefly try to wrap this",
    "start": "1442000",
    "end": "1448720"
  },
  {
    "text": "all together and talk about how we'd like to see cni 2.0 improve",
    "start": "1448720",
    "end": "1455760"
  },
  {
    "text": "based on our experience with debugging cni 2.0 one of the main things",
    "start": "1455760",
    "end": "1462000"
  },
  {
    "text": "i'm excited about in cni 2.0 is the prospect of having",
    "start": "1462000",
    "end": "1467520"
  },
  {
    "text": "the plug-ins themselves running in pods so since we have these",
    "start": "1467520",
    "end": "1472960"
  },
  {
    "text": "plugins running as binaries on disk it's kind of a non-sequitur for how you",
    "start": "1472960",
    "end": "1479840"
  },
  {
    "text": "interact with your cluster as an administrator so that's something i'd really like to see",
    "start": "1479840",
    "end": "1485600"
  },
  {
    "text": "we're not a huge fan of having the configurations in json",
    "start": "1485600",
    "end": "1491440"
  },
  {
    "text": "it's also not exactly the same as what we're used to with our",
    "start": "1491440",
    "end": "1497760"
  },
  {
    "text": "yaml type of specifications that we're working with",
    "start": "1497760",
    "end": "1502799"
  },
  {
    "text": "additionally devices are a difficulty so we're trying to figure out if there's a",
    "start": "1502799",
    "end": "1509120"
  },
  {
    "text": "kind of a better more collapsed way to work with devices and",
    "start": "1509120",
    "end": "1515840"
  },
  {
    "text": "lastly is to have something that better handles a network",
    "start": "1515840",
    "end": "1521840"
  },
  {
    "text": "life cycle during a container's run time so when we mention the commands we've",
    "start": "1521840",
    "end": "1526960"
  },
  {
    "text": "got cni add delete etc those happen in discrete moments when your pod is",
    "start": "1526960",
    "end": "1534000"
  },
  {
    "text": "created when your pod is deleted but what if something happens between those",
    "start": "1534000",
    "end": "1540000"
  },
  {
    "text": "two detent points we'd like to see something that's a little bit richer",
    "start": "1540000",
    "end": "1545760"
  },
  {
    "text": "in that sense and just briefly something that is kind of a idea in",
    "start": "1545760",
    "end": "1553919"
  },
  {
    "text": "terms of design paradigm is the idea of a thin plug-in",
    "start": "1553919",
    "end": "1560400"
  },
  {
    "text": "and a thick plug-in a thin cni plug-in is just the binary on disk",
    "start": "1560400",
    "end": "1567600"
  },
  {
    "text": "that runs as a one-shot it starts it does its work and it exits",
    "start": "1567600",
    "end": "1573840"
  },
  {
    "text": "you could have a richer design that we call a thick plug-in and the idea is you",
    "start": "1573840",
    "end": "1580480"
  },
  {
    "text": "replace that thin plug-in that runs on disk with what we call a cni shim",
    "start": "1580480",
    "end": "1586400"
  },
  {
    "text": "that shim takes that standard in the environment variables and it packages up and sends it to a",
    "start": "1586400",
    "end": "1596320"
  },
  {
    "text": "process that's usually running in a in a pod as a long-running process that's where we call it a thick plug-in",
    "start": "1596320",
    "end": "1603520"
  },
  {
    "text": "and it takes that information does the work that it needs to do and",
    "start": "1603520",
    "end": "1608559"
  },
  {
    "text": "then sends uh the results back to the shim and the shim exits",
    "start": "1608559",
    "end": "1614640"
  },
  {
    "text": "as you can see by this diagram it's there's a number of moving parts happening here and in cni 2.0 we're",
    "start": "1614640",
    "end": "1623360"
  },
  {
    "text": "hopeful that we can standardize all of that communication",
    "start": "1623360",
    "end": "1628400"
  },
  {
    "text": "and have and have your plugins running kind of natively as a thick plug-in and then in",
    "start": "1628400",
    "end": "1636000"
  },
  {
    "text": "this sense instead of all of that work that daniel had to do in order to figure out is my pod running and not running",
    "start": "1636000",
    "end": "1642880"
  },
  {
    "text": "how did i get the logs from the cubelet what you can just do is more like a cube",
    "start": "1642880",
    "end": "1647919"
  },
  {
    "text": "cuddle get logs and get your logs out of the pot",
    "start": "1647919",
    "end": "1654200"
  },
  {
    "text": "um so yeah thank you if you have uh interest in any of this um and in",
    "start": "1654559",
    "end": "1662399"
  },
  {
    "text": "cni 2.0 as well um there's a working group that i work with that we would",
    "start": "1662399",
    "end": "1669039"
  },
  {
    "text": "love to have you join with any questions comments ideas uh",
    "start": "1669039",
    "end": "1674240"
  },
  {
    "text": "contributions etc as well as the cni maintainers i'm sure",
    "start": "1674240",
    "end": "1679840"
  },
  {
    "text": "would be happy to hear from you there's a number of uh issues in the github issues that are tagged as a cni 2.0 if",
    "start": "1679840",
    "end": "1686720"
  },
  {
    "text": "you're interested in that as well um and we have the contents available uh",
    "start": "1686720",
    "end": "1693840"
  },
  {
    "text": "that's the content and also for sure if you want to talk with us feel free to being here so kubernetes live",
    "start": "1693840",
    "end": "1700720"
  },
  {
    "text": "so yeah thank you",
    "start": "1700799",
    "end": "1705640"
  },
  {
    "text": "any questions anyone",
    "start": "1713120",
    "end": "1716679"
  },
  {
    "text": "uh i have question like this idea of cni uh plugin in ports",
    "start": "1728480",
    "end": "1734799"
  },
  {
    "text": "but do you have idea how to resolve the issue of x and [Music] chicken like",
    "start": "1734799",
    "end": "1741279"
  },
  {
    "text": "how you create the pod without cna plugin yes so what will be first yeah",
    "start": "1741279",
    "end": "1748398"
  },
  {
    "text": "that's a great question and i think that you would probably have to have a kind of special class of pod it might",
    "start": "1750559",
    "end": "1758000"
  },
  {
    "text": "look more like a static pod itself um that would be that would be my guess",
    "start": "1758000",
    "end": "1764399"
  },
  {
    "text": "but that's a great question another thing i'm thinking about in a similar sense is",
    "start": "1764399",
    "end": "1772080"
  },
  {
    "text": "in cni 2.0 if you have these plugins running in pods they're going to need",
    "start": "1772080",
    "end": "1779279"
  },
  {
    "text": "host access as well and i think that that's going to be",
    "start": "1779279",
    "end": "1784320"
  },
  {
    "text": "something tricky to be able to expose that host access to the pods and then it's also going to have security",
    "start": "1784320",
    "end": "1790960"
  },
  {
    "text": "implications so i think that there's uh a number of interesting challenges there thank you",
    "start": "1790960",
    "end": "1797919"
  },
  {
    "text": "yeah totally i think it's going to be a little bit like you know with the kubernetes api so you would need a static code and also probably",
    "start": "1797919",
    "end": "1803440"
  },
  {
    "text": "keyboarding to you know gets either capabilities for accessing networking and so forth or yes you know",
    "start": "1803440",
    "end": "1810320"
  },
  {
    "text": "related access hey",
    "start": "1810320",
    "end": "1815360"
  },
  {
    "text": "one question i finally thought that in order to have multiple cni's i have to deploy a multi so",
    "start": "1815360",
    "end": "1822320"
  },
  {
    "text": "whatever yeah it's any work in progress to be able to naturally support multiple cni's without having to resort to",
    "start": "1822320",
    "end": "1828799"
  },
  {
    "text": "multi-sources like embedding multiples and power well i'll let doc reply because he's a",
    "start": "1828799",
    "end": "1834399"
  },
  {
    "text": "motors maintainer so go ahead yeah francisco that's a great question",
    "start": "1834399",
    "end": "1839919"
  },
  {
    "text": "so this is something that we've as network plumbing working group have been",
    "start": "1839919",
    "end": "1845200"
  },
  {
    "text": "looking at over a number of years i think that sig network is becoming",
    "start": "1845200",
    "end": "1851360"
  },
  {
    "text": "increasingly more interested in the idea of having this natively in tree in kubernetes",
    "start": "1851360",
    "end": "1859360"
  },
  {
    "text": "when we first started the effort for multicni we um",
    "start": "1859360",
    "end": "1864559"
  },
  {
    "text": "the it's a lot it's a long story but the short version is it was going to create",
    "start": "1864559",
    "end": "1870320"
  },
  {
    "text": "sweeping changes across the code base of kubernetes and the maintainers weren't",
    "start": "1870320",
    "end": "1876480"
  },
  {
    "text": "super excited but i think that over time more people have seen the value in being",
    "start": "1876480",
    "end": "1882720"
  },
  {
    "text": "able to have multi-homed pods so we are continuing to drive in that",
    "start": "1882720",
    "end": "1890320"
  },
  {
    "text": "direction and i think that everyone who's a member of the network plumbing working group would like to see that",
    "start": "1890320",
    "end": "1896640"
  },
  {
    "text": "happen so stay tuned because uh it's certainly part of the discussion thank you yeah also one of the things that is",
    "start": "1896640",
    "end": "1903279"
  },
  {
    "text": "being discussed lately is that you know so far you need to do an add a network test definition so",
    "start": "1903279",
    "end": "1910159"
  },
  {
    "text": "it's a work in progress unless an idea to have a direct network primitive within you know kubernetes directly",
    "start": "1910159",
    "end": "1915840"
  },
  {
    "text": "without having to do all you know this plumbing under the hood uh thank you for the talk i really",
    "start": "1915840",
    "end": "1921840"
  },
  {
    "text": "enjoyed um slightly off topic question um what software did you use to make the",
    "start": "1921840",
    "end": "1928000"
  },
  {
    "text": "demo i thought that was great yeah it's called demo magic so basically you could do everything i mean it's on github just",
    "start": "1928000",
    "end": "1934399"
  },
  {
    "text": "secret github demo magic and i think it's a kind of cool thing to do because you",
    "start": "1934399",
    "end": "1939440"
  },
  {
    "text": "could basically mock the things up when network is not working thank you",
    "start": "1939440",
    "end": "1947240"
  },
  {
    "text": "hi one follow-up question uh related to multis can you comment on intel dbdk support so",
    "start": "1948880",
    "end": "1955519"
  },
  {
    "text": "data plane development kit where we would need additional network interfaces",
    "start": "1955519",
    "end": "1961960"
  },
  {
    "text": "uh sure so the the um the best uh context that i have for the use of dpdk",
    "start": "1963279",
    "end": "1970559"
  },
  {
    "text": "with secondary interfaces has usually been relative to the use of srov",
    "start": "1970559",
    "end": "1976640"
  },
  {
    "text": "devices and so and additionally it is one of the considerations of the",
    "start": "1976640",
    "end": "1984080"
  },
  {
    "text": "specification that we have for secondary networks was to allow you to",
    "start": "1984080",
    "end": "1990080"
  },
  {
    "text": "have kind of a blank slate if you will because if you're using dpdk you're going to bring",
    "start": "1990080",
    "end": "1996320"
  },
  {
    "text": "along your own ip stack etc so it's definitely possible and i believe that using the srov",
    "start": "1996320",
    "end": "2004880"
  },
  {
    "text": "network operator which is one of the projects as part of the network plumbing working group",
    "start": "2004880",
    "end": "2010880"
  },
  {
    "text": "there is dpdk support for srov devices as",
    "start": "2010880",
    "end": "2016399"
  },
  {
    "text": "secondary networks does does that help okay there's also another option which is let's say you got your own plugin",
    "start": "2016399",
    "end": "2023760"
  },
  {
    "text": "you've got to have any plugins that for instance would attach your new secondary nic to obs dpdk then you're getting that",
    "start": "2023760",
    "end": "2030480"
  },
  {
    "text": "for free or you can also have a secondary plug-in that would you know attach the magnet interface and then you",
    "start": "2030480",
    "end": "2035519"
  },
  {
    "text": "can you know just get the sr we pass through and so forth so i mean it kind of depends on what you want",
    "start": "2035519",
    "end": "2043000"
  },
  {
    "text": "uh i think that we have run out of time but we would um yeah we're happy to",
    "start": "2046880",
    "end": "2052638"
  },
  {
    "text": "answer questions so we'll be along for a while so thank you thank you a lot for attending today and see you",
    "start": "2052639",
    "end": "2058839"
  },
  {
    "text": "around you",
    "start": "2058839",
    "end": "2062919"
  }
]