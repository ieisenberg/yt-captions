[
  {
    "text": "all right hi everyone thank you for coming so this is our talk coop float",
    "start": "30",
    "end": "5609"
  },
  {
    "text": "Spotify building and managing a centralized platform it's not gonna be as technical of a talk it's a little bit",
    "start": "5609",
    "end": "11969"
  },
  {
    "text": "more of a case study of how we deploy coop flow at our company and the sort of",
    "start": "11969",
    "end": "18060"
  },
  {
    "text": "trials and tribulations and things we have to consider along the way I hope that you can take away something if",
    "start": "18060",
    "end": "24390"
  },
  {
    "text": "you're not using coop flow yet yourself that you can maybe take something away about how you might use it in your own",
    "start": "24390",
    "end": "29429"
  },
  {
    "text": "organization so as mentioned before my name is Ryan cloud and this is my",
    "start": "29429",
    "end": "35579"
  },
  {
    "text": "colleague Keshe dye and we're gonna start by talking a little bit about",
    "start": "35579",
    "end": "40770"
  },
  {
    "text": "Spotify and we're gonna cover a bit about our organizational structure because this is going to inform the",
    "start": "40770",
    "end": "46950"
  },
  {
    "text": "decisions that we made around centralizing cube flow as a platform and then I'll talk a little bit about how we",
    "start": "46950",
    "end": "53370"
  },
  {
    "text": "can optimize the development experience using this centralized resource and then Keshi will take over and talk about how",
    "start": "53370",
    "end": "60329"
  },
  {
    "text": "we built the platform how we manage it and some of the lessons learned that we had along the way so we're Spotify if you haven't heard of",
    "start": "60329",
    "end": "68280"
  },
  {
    "text": "us before we are a music streaming service we also have podcasts and we launched in 2008 we have 248 million",
    "start": "68280",
    "end": "76049"
  },
  {
    "text": "active users 50 million tracks on our platform and 70 were launched in 79",
    "start": "76049",
    "end": "81270"
  },
  {
    "text": "countries we use machine learning all over our products most notably in our",
    "start": "81270",
    "end": "86490"
  },
  {
    "text": "recommendations products such as discover weekly which is a weekly personalised playlist that we provide",
    "start": "86490",
    "end": "91950"
  },
  {
    "text": "for our users but it's also in many other places such as our search functionality our homepage and much more",
    "start": "91950",
    "end": "100430"
  },
  {
    "text": "I'm making the assumption that a lot of you know what coop flow is but in case you don't the brief elevator pitch is",
    "start": "100430",
    "end": "106890"
  },
  {
    "text": "that coop flow is an open source framework for running machine learning pipelines on kubernetes it transforms",
    "start": "106890",
    "end": "113280"
  },
  {
    "text": "individual components of the ml workflow such as training transformation model",
    "start": "113280",
    "end": "119070"
  },
  {
    "text": "evaluation etc into individual docker containers that can be chained together",
    "start": "119070",
    "end": "125630"
  },
  {
    "text": "so let's talk a little bit about the organizational structure at Spotify I know this is a kubernetes conference so",
    "start": "125630",
    "end": "132690"
  },
  {
    "text": "wide talk about this if you're familiar with Conway's law it's that software systems tend to",
    "start": "132690",
    "end": "138959"
  },
  {
    "text": "reflect the structure of the organization in which they're built and so I don't want you to go back to your",
    "start": "138959",
    "end": "144750"
  },
  {
    "text": "office on Monday and say let's adopt coop flow and let's deploy it this way because this is the way that Spotify did",
    "start": "144750",
    "end": "150030"
  },
  {
    "text": "it and it works for them I want you to see the trade-offs that we made and how they relate to our organizational",
    "start": "150030",
    "end": "155430"
  },
  {
    "text": "structure and use that to inform your own decision making process as to whether this would be right for you and",
    "start": "155430",
    "end": "161310"
  },
  {
    "text": "what kind of trade-offs that you need to make so we're gonna start the story with",
    "start": "161310",
    "end": "166319"
  },
  {
    "text": "you I'm gonna put you in our shoes you're now an engineer at Spotify",
    "start": "166319",
    "end": "171920"
  },
  {
    "text": "congratulations on your new job you're on you're on a team and teams at Spotify",
    "start": "171920",
    "end": "179069"
  },
  {
    "text": "we call squads and your squad is machine learning infrastructure the team that Keshi and I work on you are one squad of",
    "start": "179069",
    "end": "186989"
  },
  {
    "text": "280 squads all across the globe we have offices in Stockholm New York City which",
    "start": "186989",
    "end": "192569"
  },
  {
    "text": "is where Keshi and I are London Boston and more and these squads sort of bubble",
    "start": "192569",
    "end": "198209"
  },
  {
    "text": "up in a short hierarchy into business units for example our free products our premium product and other business units",
    "start": "198209",
    "end": "205609"
  },
  {
    "text": "some smaller percentage of these squads use machine learning and they're now",
    "start": "205609",
    "end": "210660"
  },
  {
    "text": "your customers as a machine learning infrastructure engineer so what does a typical customer team look like squads",
    "start": "210660",
    "end": "217440"
  },
  {
    "text": "at Spotify are small cross-functional and what we call responsibly autonomous",
    "start": "217440",
    "end": "223379"
  },
  {
    "text": "so a given team may be constructed of any number of back-end Engineers front-end data scientists data engineers",
    "start": "223379",
    "end": "230730"
  },
  {
    "text": "ml engineers etc based on the particular product or feature that they're working on this is opposed to a organizational",
    "start": "230730",
    "end": "238889"
  },
  {
    "text": "structure that you might call vertical or centralized where there's a single machine learning team at Spotify individual machine learning",
    "start": "238889",
    "end": "245400"
  },
  {
    "text": "practitioners are embedded on cross-functional teams for specific features or products this autonomy and",
    "start": "245400",
    "end": "253290"
  },
  {
    "text": "decentralization is a trade off for Speed versus coordination we trust teams",
    "start": "253290",
    "end": "258419"
  },
  {
    "text": "to make the decisions that make the most sense for them and in order to execute as fast as possible and this means that",
    "start": "258419",
    "end": "266039"
  },
  {
    "text": "teams are not blocked on needing some resource from another team they should be staffed in accordance to what they need to deliver",
    "start": "266039",
    "end": "271710"
  },
  {
    "text": "their feature the cons of this is that there's a lack of standardization if you",
    "start": "271710",
    "end": "277139"
  },
  {
    "text": "work in the m/l space you would know that there's a lot of different tools that you can use in ml and new ones are",
    "start": "277139",
    "end": "282330"
  },
  {
    "text": "coming out all the time and autonomous teams means that all the different machine learning teams historically will",
    "start": "282330",
    "end": "288180"
  },
  {
    "text": "be using a different tool set and this leads to a sort of information or",
    "start": "288180",
    "end": "294029"
  },
  {
    "text": "experience siloing so there are maybe teams that have been around a while and built infrastructure around the tools",
    "start": "294029",
    "end": "299610"
  },
  {
    "text": "that they use and younger teams that are just starting to use machine learning may choose to use different tools that",
    "start": "299610",
    "end": "306479"
  },
  {
    "text": "are technologically incompatible with the infrastructure that they built for themselves and then there's also the",
    "start": "306479",
    "end": "311580"
  },
  {
    "text": "problem of you know we have teams in different time zones in different countries and different business verticals that may not have exposure to",
    "start": "311580",
    "end": "318449"
  },
  {
    "text": "what other teams are doing so given this organizational structure you're posed with a question for you as",
    "start": "318449",
    "end": "327029"
  },
  {
    "text": "a machine learning infrastructure team is it better for you to create a centralized resource for your customers",
    "start": "327029",
    "end": "333270"
  },
  {
    "text": "to use and take on that operational responsibility or is it better for you to make the self deployment use case as",
    "start": "333270",
    "end": "340080"
  },
  {
    "text": "easy as possible for your customer teams we're gonna start by considering the",
    "start": "340080",
    "end": "345779"
  },
  {
    "text": "self deployment scenario because for an autonomous team this seems like the natural choice it's very common it's",
    "start": "345779",
    "end": "351599"
  },
  {
    "text": "modify for teams to own and operate their own resources we as I mentioned",
    "start": "351599",
    "end": "358289"
  },
  {
    "text": "before we trust teams to know what's best for them so they know what sort of scale and cost that they need to do to",
    "start": "358289",
    "end": "363300"
  },
  {
    "text": "to have and they don't have to worry about fighting over resources within the cluster or worrying if some other team",
    "start": "363300",
    "end": "370020"
  },
  {
    "text": "is gonna do an upgrade that will break their production pipelines so what does your job look like in this kind of a",
    "start": "370020",
    "end": "376379"
  },
  {
    "text": "scenario well first and foremost you're going to want to deploy coop flow",
    "start": "376379",
    "end": "381539"
  },
  {
    "text": "yourself and figure I figure out what kind of customizations are needed to fit within your infrastructure or networking",
    "start": "381539",
    "end": "388409"
  },
  {
    "text": "system etc and then use what you've learned to provide a tool or a script to make deployment easy then you want to",
    "start": "388409",
    "end": "395879"
  },
  {
    "text": "build on top of coop flow and provide common components for em tasks that your teams are going to want",
    "start": "395879",
    "end": "401520"
  },
  {
    "text": "to use or components that will integrate with maybe internal infrastructure that",
    "start": "401520",
    "end": "407039"
  },
  {
    "text": "you already have that maybe isn't publicly available this is particularly attractive because",
    "start": "407039",
    "end": "413099"
  },
  {
    "text": "it's the least amount of work for you and as we know good engineers do just as much work as they need to in this case",
    "start": "413099",
    "end": "420300"
  },
  {
    "text": "you don't have operational responsibilities you're not caught on call at 2:00 a.m. when someone's pipeline breaks there's no long-term",
    "start": "420300",
    "end": "426270"
  },
  {
    "text": "resource planning around you know how do I make sure that my cluster is gonna scale to the future of machine learning",
    "start": "426270",
    "end": "431280"
  },
  {
    "text": "at Spotify etc but as you begin to work on deploying coop flow you're gonna",
    "start": "431280",
    "end": "437400"
  },
  {
    "text": "notice some drawbacks to this situation and the first is that the amount of kubernetes expertise you need to deploy",
    "start": "437400",
    "end": "444120"
  },
  {
    "text": "and then long term manage the cluster is actually a lot and while you can minimize that by providing say a",
    "start": "444120",
    "end": "450270"
  },
  {
    "text": "deployment tool or and the fact that coop flow adds Drax away a lot of the",
    "start": "450270",
    "end": "455330"
  },
  {
    "text": "kubernetes details they're still going to be the case where all of these individual teams have production",
    "start": "455330",
    "end": "461250"
  },
  {
    "text": "pipelines running and something at some point is gonna go wrong on their clusters and they're gonna need to debug it and if you made things too easy for",
    "start": "461250",
    "end": "467820"
  },
  {
    "text": "them they're not gonna know enough about Cooper nineties to debug it they might be calling you anyways for help the next",
    "start": "467820",
    "end": "475139"
  },
  {
    "text": "situation is you need to consider how this scenario is going to work out long term so we already have this information",
    "start": "475139",
    "end": "481259"
  },
  {
    "text": "siloing problem where individual teams build up expertise and infrastructure",
    "start": "481259",
    "end": "486960"
  },
  {
    "text": "and if they have their own coop flow clusters you're still going to be hiding the work of teams that may not have a",
    "start": "486960",
    "end": "492659"
  },
  {
    "text": "natural level of exposure to other teams we have some inspiration within Spotify",
    "start": "492659",
    "end": "497669"
  },
  {
    "text": "already for this sort of problem we have a centralized developer platform that",
    "start": "497669",
    "end": "503250"
  },
  {
    "text": "you can log on to and see information about all sorts of pipelines and back-end services that Spotify you can",
    "start": "503250",
    "end": "509400"
  },
  {
    "text": "see their status so you can see what team owns it you can see where the code is for that service or pipeline etc I",
    "start": "509400",
    "end": "515310"
  },
  {
    "text": "think you would be really lucky as an infrastructure engineer to expose the same kind of information about machine",
    "start": "515310",
    "end": "521700"
  },
  {
    "text": "learning within your organization so for example a team that's working on a new",
    "start": "521700",
    "end": "527190"
  },
  {
    "text": "model can look at the work of other teams they can look at what datasets people are using how people are",
    "start": "527190",
    "end": "532770"
  },
  {
    "text": "transform the features from that dataset etc and that's gonna be really hard to do if every team has their own cluster with",
    "start": "532770",
    "end": "539520"
  },
  {
    "text": "their own metadata store and you have to figure out how to coalesce all of that information and get the permission from",
    "start": "539520",
    "end": "545370"
  },
  {
    "text": "everybody else's resources mm-hmm excuse me the next situation is the upgrade",
    "start": "545370",
    "end": "554580"
  },
  {
    "text": "scenario so coop flow is a relatively young project and they have quarterly releases that come out with all sorts of",
    "start": "554580",
    "end": "560820"
  },
  {
    "text": "new and amazing features but the situation here is that you'll often have",
    "start": "560820",
    "end": "566310"
  },
  {
    "text": "breaking changes and in an autonomous team scenario you can't force a team to",
    "start": "566310",
    "end": "571830"
  },
  {
    "text": "upgrade and so if your team is trying to build on top of coop flow and make assumptions about what kind of features",
    "start": "571830",
    "end": "577470"
  },
  {
    "text": "are there what version people are running you need to worry about whether or not you can get teams to upgrade to",
    "start": "577470",
    "end": "583320"
  },
  {
    "text": "use your new features and yeah basically",
    "start": "583320",
    "end": "593360"
  },
  {
    "text": "yeah if there's gonna be breaking changes you also need to get the team to take the time away from the work that",
    "start": "593360",
    "end": "599400"
  },
  {
    "text": "they're trying to do and deal with this breaking change migrating their stuff that they may not have scoped for their",
    "start": "599400",
    "end": "605880"
  },
  {
    "text": "work in that sprint or quarter etc lastly there's a bit of a technical",
    "start": "605880",
    "end": "611400"
  },
  {
    "text": "detail within Spotify that was really important to us I don't want to go into too much detail about it but it was sort",
    "start": "611400",
    "end": "616950"
  },
  {
    "text": "of the nail in the coffin for why we decided to centralize and that's our usage of what's called a shared VP see",
    "start": "616950",
    "end": "622460"
  },
  {
    "text": "the story goes like this at Spotify we're entirely on GCP but this concept",
    "start": "622460",
    "end": "628260"
  },
  {
    "text": "exists in many other cloud providers because we're autonomous every team has their own individual GCP project and as",
    "start": "628260",
    "end": "635940"
  },
  {
    "text": "you might imagine it's common that services that one team build is going to want to communicate to services other",
    "start": "635940",
    "end": "641700"
  },
  {
    "text": "internal services at the company the problem is that by default because each",
    "start": "641700",
    "end": "646710"
  },
  {
    "text": "of the products have their own networking isolation you can't do this so to solve this problem we use what's",
    "start": "646710",
    "end": "654030"
  },
  {
    "text": "called a shared V PC or virtual private cloud it's a shared networking layer that individual services can connect to",
    "start": "654030",
    "end": "660270"
  },
  {
    "text": "to communicate with each other so you might be thinking okay you've solved this problem you have the share of e PC",
    "start": "660270",
    "end": "666600"
  },
  {
    "text": "just have the teams add their kubernetes clusters to it and that's the end of the day the issue is that this is actually a",
    "start": "666600",
    "end": "673839"
  },
  {
    "text": "pretty high friction process so every individual team now",
    "start": "673839",
    "end": "679629"
  },
  {
    "text": "in the future and if we have restructuring is going to have to talk to security because you're attaching to",
    "start": "679629",
    "end": "685029"
  },
  {
    "text": "a networking layer that exposes internal services you have to talk with the networking team that owns the shared VPC",
    "start": "685029",
    "end": "691089"
  },
  {
    "text": "and they have other responsibilities and if you have all of these teams bottlenecking on a single team to deploy",
    "start": "691089",
    "end": "697449"
  },
  {
    "text": "like subnet allocations and stuff that's a lot of work and then you have to consider the fact that everyone's gonna",
    "start": "697449",
    "end": "703209"
  },
  {
    "text": "ask for more resources that then they need and you know there's a limited number of subnets for example in a",
    "start": "703209",
    "end": "709870"
  },
  {
    "text": "shared V PC and then lastly there's a lot of special configuration for gke and",
    "start": "709870",
    "end": "715449"
  },
  {
    "text": "coop flow and this is not really a common case for a lot of people and we had to figure out a lot for ourselves",
    "start": "715449",
    "end": "720490"
  },
  {
    "text": "and it's it's fairly difficult to do so to ask every individual team to do this",
    "start": "720490",
    "end": "725709"
  },
  {
    "text": "themselves is really high friction and if you're an infrastructure team and teams don't have to use the tools that",
    "start": "725709",
    "end": "732429"
  },
  {
    "text": "you make this is a huge blocker for teams that might just want to keep using what they already have you want to try",
    "start": "732429",
    "end": "738910"
  },
  {
    "text": "and optimize a bit for adoption of your tools so given that let's look at the",
    "start": "738910",
    "end": "744459"
  },
  {
    "text": "pros and the cons of the centralization use case number one our shared V PC problem is solved once people don't have",
    "start": "744459",
    "end": "750759"
  },
  {
    "text": "to worry about it number two all of the kubernetes expertise is now centralised",
    "start": "750759",
    "end": "756160"
  },
  {
    "text": "on our team T that means that teams no longer have to worry as much about the infrastructure underlying koop flow and",
    "start": "756160",
    "end": "762759"
  },
  {
    "text": "that's the whole point of coop flow teams can focus on machine learning and not the infrastructure lastly or not",
    "start": "762759",
    "end": "769870"
  },
  {
    "text": "lastly that means you get easier adaptation from the teams all they have",
    "start": "769870",
    "end": "775569"
  },
  {
    "text": "to do is you know use the coop flow DSL and submit it to the cluster and not have to worry about anything else and lastly for the future you can utilize",
    "start": "775569",
    "end": "783189"
  },
  {
    "text": "that centralized metadata and expose it in your already existing centralized platform I'd be remiss not to mention",
    "start": "783189",
    "end": "791199"
  },
  {
    "text": "the downsides of this situation which is number one we're a pretty small team and now we have this big operational",
    "start": "791199",
    "end": "797410"
  },
  {
    "text": "responsibility we have to go on call for it we have to make LoZ but this con may not be so much of a",
    "start": "797410",
    "end": "803440"
  },
  {
    "text": "con when you consider the fact that it's either us taking the burden of this responsibility or every single",
    "start": "803440",
    "end": "808810"
  },
  {
    "text": "individual team which in that case you might not consider it a con someone has",
    "start": "808810",
    "end": "814000"
  },
  {
    "text": "to take that burden and has an infrastructure team I would argue that perhaps infrastructure should be taking",
    "start": "814000",
    "end": "819790"
  },
  {
    "text": "that burden not the feature team's second is that it's a much larger risk surface so you have many tenants you",
    "start": "819790",
    "end": "826810"
  },
  {
    "text": "have to worry about how they're going to be sharing the resources if one team is going to accidentally hog up the",
    "start": "826810",
    "end": "832300"
  },
  {
    "text": "resources from another team and then the upgrade scenario if you upgrade kubernetes or you upgrade coop flow if",
    "start": "832300",
    "end": "838120"
  },
  {
    "text": "you break people's pipelines you're breaking all of machine learning at Spotify not just one team and then",
    "start": "838120",
    "end": "845380"
  },
  {
    "text": "lastly coop flow is not yet fully multi-tenant but that's coming soon and we really look forward to that hopefully",
    "start": "845380",
    "end": "851829"
  },
  {
    "text": "early next year so given some centralized resources so",
    "start": "851829",
    "end": "857560"
  },
  {
    "text": "as I mentioned before we have decided to centralize given these pros and cons so given that how can we optimize the",
    "start": "857560",
    "end": "862750"
  },
  {
    "text": "developer experience number one as I alluded to before we provide a number of common components we standardize on tf-x",
    "start": "862750",
    "end": "870730"
  },
  {
    "text": "or tensor flow extended it's a framework that's opinionated and provides a number",
    "start": "870730",
    "end": "876310"
  },
  {
    "text": "of pre-made components and runs on coop flow we have our own internal fork that",
    "start": "876310",
    "end": "882930"
  },
  {
    "text": "utilizes all of the stuff that they've written for common tasks so we don't have to write that and then we can focus",
    "start": "882930",
    "end": "887980"
  },
  {
    "text": "on tasks that are specific to Spotify or that don't exist in tf-x and tastic for example like accessing",
    "start": "887980",
    "end": "896020"
  },
  {
    "text": "our data infrastructure that you know it's not a public system so we want to",
    "start": "896020",
    "end": "901779"
  },
  {
    "text": "bake that into the components that our users can use it and then we want to build on top of coop flow so we provide",
    "start": "901779",
    "end": "909160"
  },
  {
    "text": "our users with a template repo that they can clone and we'll fill in a lot of the pre-existing information about the",
    "start": "909160",
    "end": "914649"
  },
  {
    "text": "centralized cluster and this reduces a lot of boilerplate helping adoption and then we also provide a thin CLI tool",
    "start": "914649",
    "end": "922060"
  },
  {
    "text": "that utilizes once again a lot of the assumptions around the centralized resources so we know how authentication",
    "start": "922060",
    "end": "928480"
  },
  {
    "text": "should work we know what clusters things should be submit to we can also enrich the metadata that's being",
    "start": "928480",
    "end": "934529"
  },
  {
    "text": "when they submit a coupe flow pipeline to our infrastructure and then lastly as an added benefit we can build other",
    "start": "934529",
    "end": "942419"
  },
  {
    "text": "tooling into this such as scaffold our users don't have to write or compile or",
    "start": "942419",
    "end": "947609"
  },
  {
    "text": "build docker containers themselves they merely interface with the Python DSL and",
    "start": "947609",
    "end": "952979"
  },
  {
    "text": "scaffold will build the docker containers for them as part of pipeline compilation and lastly this thin layer",
    "start": "952979",
    "end": "959909"
  },
  {
    "text": "also helps us with the upgrade scenario where for example if there's some",
    "start": "959909",
    "end": "965579"
  },
  {
    "text": "breaking change we can sort of migrate users for them using this thin layer and",
    "start": "965579",
    "end": "971509"
  },
  {
    "text": "with that I'm gonna hand over the reins Takeshi who's gonna give a little bit more detail around how we deployed our",
    "start": "971509",
    "end": "977009"
  },
  {
    "text": "centralized resources how we manage them and some of the lessons we learned with that Thank You Ryan let's first talk",
    "start": "977009",
    "end": "985889"
  },
  {
    "text": "about how we build our cluster before I dive into details I want to remind",
    "start": "985889",
    "end": "992459"
  },
  {
    "text": "everyone again that everything we do is on TCP this significantly simplifies a",
    "start": "992459",
    "end": "997829"
  },
  {
    "text": "lot of our work with the help of numerous Google cloud offerings our",
    "start": "997829",
    "end": "1004549"
  },
  {
    "text": "story of building a centralized cube flow platforms that made this year and it has gone through several iterations",
    "start": "1004549",
    "end": "1010749"
  },
  {
    "text": "in the very beginning we started with out of box default deployment or later",
    "start": "1010749",
    "end": "1016519"
  },
  {
    "text": "we switched to terraform to create create and manager TCP resources and",
    "start": "1016519",
    "end": "1021619"
  },
  {
    "text": "used caisson yet to deploy key flow apps eventually with cube flow 0.6 we",
    "start": "1021619",
    "end": "1028129"
  },
  {
    "text": "replaced a SONET who is customized next I wish you some happy experience as well",
    "start": "1028129",
    "end": "1033798"
  },
  {
    "text": "as some pin points in this journey when we start experimenting with cube flow we",
    "start": "1033799",
    "end": "1040579"
  },
  {
    "text": "use the default deployment you it relies on Google deployment manager to create TCP resources and use case on it to",
    "start": "1040579",
    "end": "1048259"
  },
  {
    "text": "deploy cue flow apps the default deployment tool comes with a nice web UI",
    "start": "1048259",
    "end": "1054830"
  },
  {
    "text": "with a few parameters it builds a cube flow cluster with a public URL through",
    "start": "1054830",
    "end": "1061129"
  },
  {
    "text": "Google Cloud endpoints so people can access it immediately after its created",
    "start": "1061129",
    "end": "1066230"
  },
  {
    "text": "meanwhile the says is protected by IEP Google identity aware proxy service so it will be as",
    "start": "1066230",
    "end": "1073860"
  },
  {
    "text": "secure as our Google services so this tool is really really simple it seems",
    "start": "1073860",
    "end": "1080790"
  },
  {
    "text": "perfect for us since we run everything onto UCP however it might be too good to",
    "start": "1080790",
    "end": "1086310"
  },
  {
    "text": "be true first the whole process is a black box we didn't really know what's going on",
    "start": "1086310",
    "end": "1093450"
  },
  {
    "text": "behind the scene so it was impossible for us to do any customization all we",
    "start": "1093450",
    "end": "1098700"
  },
  {
    "text": "could do was waiting for the cluster to magically show up and second it has no",
    "start": "1098700",
    "end": "1104040"
  },
  {
    "text": "support for sure of EPC as Robin mentioned earlier share the VPC enabling",
    "start": "1104040",
    "end": "1109320"
  },
  {
    "text": "is a requirement for Spotify centralized platform so teams can run jobs to access",
    "start": "1109320",
    "end": "1114630"
  },
  {
    "text": "services in our projects lastly there was no option to upgrade in our case we",
    "start": "1114630",
    "end": "1121800"
  },
  {
    "text": "would like to retain certain resources so upgrading cluster would not lose our users data to address those problems we",
    "start": "1121800",
    "end": "1132660"
  },
  {
    "text": "studied using deployment command line tool KF control to build our cube for",
    "start": "1132660",
    "end": "1138450"
  },
  {
    "text": "cluster it first generate all config files required by the deployment their",
    "start": "1138450",
    "end": "1144240"
  },
  {
    "text": "crates cluster and install cube flow our apps in order because this separation",
    "start": "1144240",
    "end": "1150360"
  },
  {
    "text": "between GCP resource creation and cube flow installation we were able to modify",
    "start": "1150360",
    "end": "1155850"
  },
  {
    "text": "the config file and at our own customization such as should VP say",
    "start": "1155850",
    "end": "1161580"
  },
  {
    "text": "subnets Cal Seco instance and persistent disks however it still has a lot of",
    "start": "1161580",
    "end": "1169800"
  },
  {
    "text": "problems first the customization was hacky we didn't know much about K sonnet",
    "start": "1169800",
    "end": "1175650"
  },
  {
    "text": "at a time we ended up with manually editing many settings as well as",
    "start": "1175650",
    "end": "1180720"
  },
  {
    "text": "creating our own case on deliver file those manual steps are not ideal and",
    "start": "1180720",
    "end": "1186780"
  },
  {
    "text": "cause upgrading and creating replicas extremely hard moreover KF control doesn't support",
    "start": "1186780",
    "end": "1194100"
  },
  {
    "text": "contacts so it was very error-prone and a simple human mistake could destroy the",
    "start": "1194100",
    "end": "1199410"
  },
  {
    "text": "cluster it happened before once got to change the contacts while upgrade",
    "start": "1199410",
    "end": "1204600"
  },
  {
    "text": "a cluster and I accidentally delete entire names based on different cluster",
    "start": "1204600",
    "end": "1210320"
  },
  {
    "text": "so tip for tip of today added a contact and namespace to your shell command",
    "start": "1210320",
    "end": "1215820"
  },
  {
    "text": "prompts it helps a lot at least for me on the other hand Spotify backhander",
    "start": "1215820",
    "end": "1223020"
  },
  {
    "text": "platform team is using terraform to manage energy K clusters those clusters are also configured to use shared VPSA",
    "start": "1223020",
    "end": "1230429"
  },
  {
    "text": "so why don't we consult the kubernetes experts in our back-end platform team",
    "start": "1230429",
    "end": "1235679"
  },
  {
    "text": "and also use care forum to manage our DCP resources we started to investigate",
    "start": "1235679",
    "end": "1240990"
  },
  {
    "text": "this option in June so what is terraform can form is a tool for building changing",
    "start": "1240990",
    "end": "1248880"
  },
  {
    "text": "and versioning in structure safely and efficiently with terraform KF control is",
    "start": "1248880",
    "end": "1256950"
  },
  {
    "text": "no longer in charge of creating and managing tcp resources our entire instruction stack is defining a care",
    "start": "1256950",
    "end": "1264360"
  },
  {
    "text": "forum module which includes at gke cluster cross eco instance for metadata",
    "start": "1264360",
    "end": "1269929"
  },
  {
    "text": "persistent disks service accounts and a lot more staff care forum also can fix",
    "start": "1269929",
    "end": "1277020"
  },
  {
    "text": "your VP scenario settings syncs communities secrets with DCP service accounts and the manager database",
    "start": "1277020",
    "end": "1283380"
  },
  {
    "text": "database users as well as class object rows by using careful module we can",
    "start": "1283380",
    "end": "1290220"
  },
  {
    "text": "easily replica Kloster for different environments by providing a different set of parameters so far we have seen a",
    "start": "1290220",
    "end": "1301020"
  },
  {
    "text": "lot of benefits of using terraform first there are many existing examples we",
    "start": "1301020",
    "end": "1306779"
  },
  {
    "text": "could learn from back and platform team which dramatically lower the barrier of managing our platform second it's really",
    "start": "1306779",
    "end": "1315360"
  },
  {
    "text": "easy to reboot modify track changes to our instructure it becomes less",
    "start": "1315360",
    "end": "1320700"
  },
  {
    "text": "intimidating now third cranial replica is easy with telephone module we use it",
    "start": "1320700",
    "end": "1326730"
  },
  {
    "text": "to beautify clusters for our platform one for experiments one for dev and a",
    "start": "1326730",
    "end": "1332309"
  },
  {
    "text": "worm for production finally we are able to use existing internal tools that",
    "start": "1332309",
    "end": "1339000"
  },
  {
    "text": "have been beautiful terraform for example our telephone configure deployment has been integrated with kid",
    "start": "1339000",
    "end": "1345210"
  },
  {
    "text": "workflow so when we make changes to our instructure we open a PR and our Beauty",
    "start": "1345210",
    "end": "1352470"
  },
  {
    "text": "system can plan the changes ahead so they can be revealed by peers before being applied if the beauty system",
    "start": "1352470",
    "end": "1359430"
  },
  {
    "text": "detects some resource is going to be deleted the PR will be automatically blocked at Annie's administrative",
    "start": "1359430",
    "end": "1366300"
  },
  {
    "text": "privilege to merge it because we believe reverses deletion needs extra attention",
    "start": "1366300",
    "end": "1371940"
  },
  {
    "text": "to avoid any mistakes at these points we",
    "start": "1371940",
    "end": "1378960"
  },
  {
    "text": "were pretty comfortable of using case on it after a KF control generator or the",
    "start": "1378960",
    "end": "1384090"
  },
  {
    "text": "kubernetes resource we use the case on e to self parameters for different environments such as hostname for",
    "start": "1384090",
    "end": "1390570"
  },
  {
    "text": "ingress cloud sequel instance and persistent disks in E and we in stock",
    "start": "1390570",
    "end": "1395820"
  },
  {
    "text": "cube flow apps through KF control up like mount very soon just after we must",
    "start": "1395820",
    "end": "1404400"
  },
  {
    "text": "a case on it starting from version 0.6 cube flow uses customized as a default",
    "start": "1404400",
    "end": "1410790"
  },
  {
    "text": "Department framework since K so since K sonnet project has reached its end of",
    "start": "1410790",
    "end": "1416520"
  },
  {
    "text": "life that's great we will need to learn more 12 with customized we can create",
    "start": "1416520",
    "end": "1425040"
  },
  {
    "text": "overlays on top of base manifests for customer department it was a little bit",
    "start": "1425040",
    "end": "1431280"
  },
  {
    "text": "overwhelming to us in the beginning because instead of using his own it command-line tool to update a few",
    "start": "1431280",
    "end": "1437430"
  },
  {
    "text": "parameter files now we own a tons of yama files but the process is similar we",
    "start": "1437430",
    "end": "1444000"
  },
  {
    "text": "first uses a key of control to generate manifests then we create our own overlays on top",
    "start": "1444000",
    "end": "1449340"
  },
  {
    "text": "of that and in the end K fkf control apply command to install or the cube",
    "start": "1449340",
    "end": "1454920"
  },
  {
    "text": "flow apps we are stealing in the best practice of using customized",
    "start": "1454920",
    "end": "1462150"
  },
  {
    "text": "we hope with my knowledge we were using my wisely and imagining ID award tube",
    "start": "1462150",
    "end": "1468150"
  },
  {
    "text": "flow deployment changed can be tracked and updates in the components can be easily identified in",
    "start": "1468150",
    "end": "1474960"
  },
  {
    "text": "addition if the manifest generated by Kiev control can be automatic converted to our own customized layouts then we",
    "start": "1474960",
    "end": "1482160"
  },
  {
    "text": "could use Argos ad to deploy our manifests to our cluster with get ups we",
    "start": "1482160",
    "end": "1487260"
  },
  {
    "text": "are working on this and hopefully it will be make our deployment much easier",
    "start": "1487260",
    "end": "1493400"
  },
  {
    "text": "with all these learnings and hard work we have a cube for platform that works",
    "start": "1494750",
    "end": "1500880"
  },
  {
    "text": "for Spotify people get excited and as they all want to use our platform to train the model now how to manage your",
    "start": "1500880",
    "end": "1507720"
  },
  {
    "text": "cluster becomes an important topic for us especially around user access and resource management currently we have",
    "start": "1507720",
    "end": "1517650"
  },
  {
    "text": "about a hundred spotfires using a platform and they most interact with cluster in two ways",
    "start": "1517650",
    "end": "1523860"
  },
  {
    "text": "Python SDK and web UI Python SDK is an internal library we build to help to",
    "start": "1523860",
    "end": "1530700"
  },
  {
    "text": "have a people to develop tf-x workflow to run with cube law of pipelines web UI",
    "start": "1530700",
    "end": "1536700"
  },
  {
    "text": "is mostly used to check experimental results and interact with pipeline art",
    "start": "1536700",
    "end": "1542040"
  },
  {
    "text": "for the visualizations first thing we need to make sure is only authenticated",
    "start": "1542040",
    "end": "1548520"
  },
  {
    "text": "users can use our platform luckily on GCP we can use Google our ap to secure",
    "start": "1548520",
    "end": "1554550"
  },
  {
    "text": "our web UI for the Python SDK access is managed by two layers google i am a",
    "start": "1554550",
    "end": "1562470"
  },
  {
    "text": "science user project reviewer robe and the kubernetes attack grunts user more granular permissions to access specific",
    "start": "1562470",
    "end": "1569730"
  },
  {
    "text": "set of API on cluster the other thing we",
    "start": "1569730",
    "end": "1575880"
  },
  {
    "text": "want to make sure is that teams can use their own service counts to run jobs and read and write data usually teams and",
    "start": "1575880",
    "end": "1583560"
  },
  {
    "text": "Spotify operating in different GCP projects we start service counts on cluster as secrets",
    "start": "1583560",
    "end": "1589440"
  },
  {
    "text": "so platform users can use them to trigger their machining work flow we",
    "start": "1589440",
    "end": "1594840"
  },
  {
    "text": "know starving service counts on cars is non-ideal and we look forward to you using Google workload identity in the",
    "start": "1594840",
    "end": "1602370"
  },
  {
    "text": "future after multi-tenancy is a party is implemented in the cubes or pipelines",
    "start": "1602370",
    "end": "1608420"
  },
  {
    "text": "meanwhile secrets are backing up at by Valero every era so they can be",
    "start": "1608840",
    "end": "1614250"
  },
  {
    "text": "recovered if we need to rebuild our cluster apart from user access various",
    "start": "1614250",
    "end": "1622560"
  },
  {
    "text": "machine learning jobs have different resource requirements we also need to design our cluster to address those",
    "start": "1622560",
    "end": "1629220"
  },
  {
    "text": "needs so teams can perform different types of jobs currently our cluster",
    "start": "1629220",
    "end": "1637050"
  },
  {
    "text": "offers three predefined ánotá pools when Noda pool is for standard emeritus 'kx",
    "start": "1637050",
    "end": "1642300"
  },
  {
    "text": "with balance the CPU and memory another one is for memory intensive job with",
    "start": "1642300",
    "end": "1648360"
  },
  {
    "text": "high memory machines and the last one is for GPU training when users write them",
    "start": "1648360",
    "end": "1654290"
  },
  {
    "text": "when users write their machine learning pipelines they are able to configure resource request a limit so kubernetes",
    "start": "1654290",
    "end": "1662460"
  },
  {
    "text": "can pick the right in order to launch the pod and release a we also noticed",
    "start": "1662460",
    "end": "1669840"
  },
  {
    "text": "that where more and more users are using our platform the D for the resource",
    "start": "1669840",
    "end": "1675180"
  },
  {
    "text": "config is no longer sufficient for some critical service such as sto parts a sto",
    "start": "1675180",
    "end": "1681360"
  },
  {
    "text": "telemetry and a metro server we need to manually tune those resource parameters",
    "start": "1681360",
    "end": "1686670"
  },
  {
    "text": "for them to fit our classes setups and a usage pattern for this part we are still",
    "start": "1686670",
    "end": "1692580"
  },
  {
    "text": "learning the best part is to make our cluster more reliable ok now we have",
    "start": "1692580",
    "end": "1700860"
  },
  {
    "text": "seen how we build and manager our centralized queue flow platform in the end I want to show some stats of our",
    "start": "1700860",
    "end": "1708210"
  },
  {
    "text": "platform usage we launched our in issue",
    "start": "1708210",
    "end": "1714360"
  },
  {
    "text": "version of the platform in August so far we have our they see about hundred users",
    "start": "1714360",
    "end": "1719730"
  },
  {
    "text": "using it and 15,000 runs on it you can see from graph there with a spike in the",
    "start": "1719730",
    "end": "1726450"
  },
  {
    "text": "middle that was a renegade job running every five minutes to stress test our cluster it took us a while to detect it",
    "start": "1726450",
    "end": "1735030"
  },
  {
    "text": "since we were still the RFI release but the great news is that it was running successfully and we",
    "start": "1735030",
    "end": "1741870"
  },
  {
    "text": "even didn't notice it so in the future we definitely would like to have more monitoring of our system with our",
    "start": "1741870",
    "end": "1752549"
  },
  {
    "text": "centralized cube flow platform ml engineers now can focus on designing analyzing ml experiments instead of",
    "start": "1752549",
    "end": "1760289"
  },
  {
    "text": "beauty and maintaining their own in structure this makes a model iteration cycle shorter and it results in faster",
    "start": "1760289",
    "end": "1766890"
  },
  {
    "text": "time front part Iping to production eventually we can have better Ahmir",
    "start": "1766890",
    "end": "1772230"
  },
  {
    "text": "models in our products and make our user happier before I conclude the talk I",
    "start": "1772230",
    "end": "1781770"
  },
  {
    "text": "would like to share several lessons we have learned along this journey and hope people who are working on a similar",
    "start": "1781770",
    "end": "1787919"
  },
  {
    "text": "project find them useful I remember when",
    "start": "1787919",
    "end": "1794070"
  },
  {
    "text": "we submit our proposal for this coupon talk a few months ago we put something like even with a hand for machine",
    "start": "1794070",
    "end": "1800909"
  },
  {
    "text": "learning and a daily engineers we are successfully able to manage multiple kubernetes clusters and the machine",
    "start": "1800909",
    "end": "1807090"
  },
  {
    "text": "learning workload at scale well this is not true",
    "start": "1807090",
    "end": "1813380"
  },
  {
    "text": "looking back we definitely should work with kubernetes experts fund for other",
    "start": "1813529",
    "end": "1819360"
  },
  {
    "text": "teams as early as possible because 4 ml daily engineers kubernetes he has a steep learning curve not only kubernetes",
    "start": "1819360",
    "end": "1826799"
  },
  {
    "text": "beauty a centralized mail perform also involved knowledge around yellow working",
    "start": "1826799",
    "end": "1832020"
  },
  {
    "text": "security deployment resource management a lot more stuff we need to collaborate",
    "start": "1832020",
    "end": "1837210"
  },
  {
    "text": "with experts from other domains so it's a teamwork second cube flow is too big",
    "start": "1837210",
    "end": "1846149"
  },
  {
    "text": "to chew or at once it has so many components and each of them is very complicated so you need to be patient",
    "start": "1846149",
    "end": "1853620"
  },
  {
    "text": "and understand I use them piece by piece to fit your own needs this is one of the",
    "start": "1853620",
    "end": "1859740"
  },
  {
    "text": "reason we choose to build a centralized perform so we can centralize this knowledge in infer team and they let ml",
    "start": "1859740",
    "end": "1867059"
  },
  {
    "text": "engineers focus on building products using our platform",
    "start": "1867059",
    "end": "1872120"
  },
  {
    "text": "finally nothing is small in terms of security I encourage people to initiate",
    "start": "1872179",
    "end": "1878429"
  },
  {
    "text": "a conversation we are secured team as early as possible when you start building a platform for multiple teams",
    "start": "1878429",
    "end": "1884100"
  },
  {
    "text": "so you can address their concerns along the way and keep them happy this is very",
    "start": "1884100",
    "end": "1889230"
  },
  {
    "text": "important that's all for our talk beauty",
    "start": "1889230",
    "end": "1895470"
  },
  {
    "text": "and managing our centralized the cube flow platform and Spotify if this sounds exciting to you come join",
    "start": "1895470",
    "end": "1901200"
  },
  {
    "text": "us in our awesome office in New York Stockholm Boston or London since for a",
    "start": "1901200",
    "end": "1906240"
  },
  {
    "text": "time we will get to show off what we have been working on happy to take any questions now thank you so this is the",
    "start": "1906240",
    "end": "1929789"
  },
  {
    "text": "picture from our office in oh well Mikey okay this is intelligent National Park",
    "start": "1929789",
    "end": "1939559"
  },
  {
    "text": "so the questions would have customisation we have done for our cheek a year sorry Christy again so another",
    "start": "1946019",
    "end": "1962589"
  },
  {
    "text": "question is does every developer has their own namespace in terms of",
    "start": "1962589",
    "end": "1968379"
  },
  {
    "text": "customization for gke I think we have our own DNS server for our cheek a year",
    "start": "1968379",
    "end": "1973899"
  },
  {
    "text": "and we also have shared VPS a setup for cheek a cluster that's the true like may",
    "start": "1973899",
    "end": "1981489"
  },
  {
    "text": "saying we have done for our cluster right now since the queue flow pipeline",
    "start": "1981489",
    "end": "1986889"
  },
  {
    "text": "doesn't have the match he uses apart so everybody is using the same namespace but very soon they gonna added much user",
    "start": "1986889",
    "end": "1994149"
  },
  {
    "text": "tendencies apart they are we so different teams can have their own namespace",
    "start": "1994149",
    "end": "2000109"
  },
  {
    "text": "okay so the question is how do we manager the GPU Porter resource you",
    "start": "2012169",
    "end": "2018139"
  },
  {
    "text": "right to be honest there are not many people using GPU at a Spotify the most",
    "start": "2018139",
    "end": "2024980"
  },
  {
    "text": "of machine learning tasks as Spotify is for recommendations so like we did it do",
    "start": "2024980",
    "end": "2031549"
  },
  {
    "text": "any special staff it's just uh also the cost is not a main concern at this point",
    "start": "2031549",
    "end": "2037220"
  },
  {
    "text": "for us so we just offer everybody if they want to use the they can use anything",
    "start": "2037220",
    "end": "2043210"
  },
  {
    "text": "do you want to take that one yeah I think the question was since there is no",
    "start": "2049810",
    "end": "2056290"
  },
  {
    "text": "multi-user support that one user can see everything are like within the namespace",
    "start": "2056290",
    "end": "2062070"
  },
  {
    "text": "yes however we have some sort of work around so that the secrets that we have on the cluster are more secure",
    "start": "2062070",
    "end": "2070050"
  },
  {
    "text": "the question is is the terraform module that we use for setting up the cube flow cluster available sorry no it's only",
    "start": "2079960",
    "end": "2089780"
  },
  {
    "text": "available internally but it's quite a standard away Hardwick a farmer like UK",
    "start": "2089780",
    "end": "2097460"
  },
  {
    "text": "pastor sue the tariff warm",
    "start": "2097460",
    "end": "2100810"
  },
  {
    "text": "okay so the question is the problems we are having migrating from customized to",
    "start": "2116190",
    "end": "2123000"
  },
  {
    "text": "our own get-ups right and so the one major pain point we have is so in order",
    "start": "2123000",
    "end": "2131460"
  },
  {
    "text": "to make it opsworks we need to structure order manifests in a specific way so the",
    "start": "2131460",
    "end": "2138390"
  },
  {
    "text": "tip-offs can apply them to customize but a KF control when we use K of control to",
    "start": "2138390",
    "end": "2144210"
  },
  {
    "text": "children so those are the manifests it has its own file structure so we need to",
    "start": "2144210",
    "end": "2149490"
  },
  {
    "text": "like him have some process to convert the structure generated by K of control",
    "start": "2149490",
    "end": "2154830"
  },
  {
    "text": "to our own structure we are still",
    "start": "2154830",
    "end": "2161100"
  },
  {
    "text": "working on that we right now is kind of an operation but we want to automate the",
    "start": "2161100",
    "end": "2166680"
  },
  {
    "text": "whole process",
    "start": "2166680",
    "end": "2168859"
  },
  {
    "text": "have we done cube flow upgrade yes so the first version we use is 0.5 then we",
    "start": "2176600",
    "end": "2185150"
  },
  {
    "text": "upgrade to 0.6 now we can have like halfway on the 0.7 only for the cubed",
    "start": "2185150",
    "end": "2192380"
  },
  {
    "text": "for pipeline rushing",
    "start": "2192380",
    "end": "2195250"
  },
  {
    "text": "yeah so the question is do we run pipelines everyday or when we get new",
    "start": "2204650",
    "end": "2211500"
  },
  {
    "text": "data in terms of the coop flow setup there are people running pipelines all",
    "start": "2211500",
    "end": "2217830"
  },
  {
    "text": "the time as sort of that graph showed in terms of like machine learning at Spotify there are people who do daily",
    "start": "2217830",
    "end": "2224730"
  },
  {
    "text": "retraining there are teams that don't do daily retraining historically we were",
    "start": "2224730",
    "end": "2230550"
  },
  {
    "text": "using this tool that people may have heard of called Luigi that was for mostly designed for our data pipelines",
    "start": "2230550",
    "end": "2237210"
  },
  {
    "text": "that do like daily or perhaps hourly if you want retraining or re like running a",
    "start": "2237210",
    "end": "2242310"
  },
  {
    "text": "pipeline so a lot of people historically use that to do that to schedule their training and depend on the upstream",
    "start": "2242310",
    "end": "2248220"
  },
  {
    "text": "pipelines that were that create the data that they depend on so we're moving away",
    "start": "2248220",
    "end": "2256230"
  },
  {
    "text": "from Luigi with coop flow but coop flows still so new and there are a lot of people using it but we're still very",
    "start": "2256230",
    "end": "2261870"
  },
  {
    "text": "much in a transitionary period all right",
    "start": "2261870",
    "end": "2267210"
  },
  {
    "text": "I think that's all the time we have so thank you very much for coming thank you guys thank you",
    "start": "2267210",
    "end": "2274760"
  }
]