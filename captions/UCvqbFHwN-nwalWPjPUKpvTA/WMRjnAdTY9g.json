[
  {
    "text": "uh welcome it's a small but hardcore crowd I can see here today so thank you",
    "start": "480",
    "end": "6480"
  },
  {
    "text": "for joining my talk um I know it's a talk about Legacy so",
    "start": "6480",
    "end": "13120"
  },
  {
    "text": "maybe that's why it's a hardcore crowd my talk is called uh using",
    "start": "13120",
    "end": "19199"
  },
  {
    "text": "kubernetes for operating Legacy and uh the idea about it is that we have some Legacy and we still want developers to",
    "start": "19199",
    "end": "26359"
  },
  {
    "text": "be able to work with it uh and that's what to talk about my name is",
    "start": "26359",
    "end": "32800"
  },
  {
    "text": "son uh pronounced with an Danish so I'm a software developer at",
    "start": "32800",
    "end": "40120"
  },
  {
    "text": "the platform team at bank data in Denmark uh I'm a software developer",
    "start": "40120",
    "end": "46399"
  },
  {
    "text": "heart but I'm in a platform team we are kind of platform Engineers so uh in bang",
    "start": "46399",
    "end": "52000"
  },
  {
    "text": "data the platform it has a kind of uh broad meaning more than just uh running",
    "start": "52000",
    "end": "57719"
  },
  {
    "text": "some kubernetes clusters but we will see that so let's get started so first I'm from",
    "start": "57719",
    "end": "65720"
  },
  {
    "text": "bangad and probably nobody knows bank that outside of India because it's a local uh it's a local banking",
    "start": "65720",
    "end": "72640"
  },
  {
    "text": "Association so it's an association owned by these eight Banks uh two of the banks",
    "start": "72640",
    "end": "78759"
  },
  {
    "text": "are the second and third is largest bank in Denmark but uh still uh in the Indian",
    "start": "78759",
    "end": "84200"
  },
  {
    "text": "context it probably doesn't mean uh we don't have a billions of we don't have a",
    "start": "84200",
    "end": "89680"
  },
  {
    "text": "what is is it SBI has 300 million customers uh in our",
    "start": "89680",
    "end": "95320"
  },
  {
    "text": "context every third person in Denmark they are customer in these Banks so that",
    "start": "95320",
    "end": "101640"
  },
  {
    "text": "that is the 30% of GS they bank with us um it's an association so that means",
    "start": "101640",
    "end": "108680"
  },
  {
    "text": "the banks they are the owners and we basically do any kind of it work for",
    "start": "108680",
    "end": "114600"
  },
  {
    "text": "them uh I'm doing a software development but that's also running ATMs and all",
    "start": "114600",
    "end": "120039"
  },
  {
    "text": "kinds of data laks whatever the banks may need PCS in their branches and so",
    "start": "120039",
    "end": "126079"
  },
  {
    "text": "on oops from the software perspective we",
    "start": "126079",
    "end": "131080"
  },
  {
    "text": "have uh three main things we run for them that is the some portals and there",
    "start": "131080",
    "end": "137959"
  },
  {
    "text": "are uh the net banking for people and homepages for the banks there's H for",
    "start": "137959",
    "end": "144680"
  },
  {
    "text": "the counselors Bank counselors sitting in the bank branches when they talk to customers there's an internal system and",
    "start": "144680",
    "end": "151879"
  },
  {
    "text": "there's a mobile application also for net",
    "start": "151879",
    "end": "157400"
  },
  {
    "text": "banking I put a timeline about history because I'm going to talk about Legacy today so if you can see Fang data they",
    "start": "157400",
    "end": "164360"
  },
  {
    "text": "started all the way back in 1960 and that was uh that was of course not with computers but already in the 70s they",
    "start": "164360",
    "end": "171680"
  },
  {
    "text": "started to have online access and so on and uh in the two 2000 that is uh what",
    "start": "171680",
    "end": "178400"
  },
  {
    "text": "we're going to look at the kind of of Legacy we're going to look at today and all the way up to today of",
    "start": "178400",
    "end": "185040"
  },
  {
    "text": "course let's go a little forward so when I talk about development",
    "start": "185040",
    "end": "191799"
  },
  {
    "text": "at bank data today almost all development is on kubernetes uh most Services they build",
    "start": "191799",
    "end": "199040"
  },
  {
    "text": "in Java I guess it's like that all banks and enterpris they like Java uh we have",
    "start": "199040",
    "end": "204959"
  },
  {
    "text": "a we're using a mix of spring Boot and quas for our services it depends on the",
    "start": "204959",
    "end": "210920"
  },
  {
    "text": "teams that are FR you can say they factions who prefer one of another but",
    "start": "210920",
    "end": "216680"
  },
  {
    "text": "uh from my platform team kind of view we don't really care it's just some",
    "start": "216680",
    "end": "222360"
  },
  {
    "text": "application uh they're about 1500 unique services to run uh the services that",
    "start": "222360",
    "end": "229519"
  },
  {
    "text": "bank data provides so we run those in kuon clusters uh and uh they are kind of",
    "start": "229519",
    "end": "237640"
  },
  {
    "text": "small compared to again what we have heard heard about today because even though it's 1500 they don't have to",
    "start": "237640",
    "end": "243799"
  },
  {
    "text": "service that many customers we know the number of people are kind of limited in",
    "start": "243799",
    "end": "249519"
  },
  {
    "text": "Denmark uh we think we have a kind of modern uh setup with uh Java maybe",
    "start": "249519",
    "end": "255760"
  },
  {
    "text": "little enterpris but we use git and gitops and so on and goates and we have",
    "start": "255760",
    "end": "262040"
  },
  {
    "text": "many uh we don't we have use many of the normal modern kubernetes operating",
    "start": "262040",
    "end": "271680"
  },
  {
    "text": "operators so that that is the what they mostly do today but we also operate",
    "start": "272160",
    "end": "277400"
  },
  {
    "text": "three large multinode it's called HL digital experience it's a portal server",
    "start": "277400",
    "end": "283440"
  },
  {
    "text": "installation it was called IBM hoopsphere before uh maybe some of you",
    "start": "283440",
    "end": "289039"
  },
  {
    "text": "known about that and those there are still uh even though it's very I said",
    "start": "289039",
    "end": "295400"
  },
  {
    "text": "they started in around year 2000 uh they're still uh critical for",
    "start": "295400",
    "end": "301759"
  },
  {
    "text": "the workings of the banks so I wrote here that the daily driver for the bank",
    "start": "301759",
    "end": "306919"
  },
  {
    "text": "employees the counselors in the banks that is their main work every day they log into this portal and they service",
    "start": "306919",
    "end": "313800"
  },
  {
    "text": "the customers uh the bank's homepages the websites that are custom on net",
    "start": "313800",
    "end": "319759"
  },
  {
    "text": "facing they're actually also running on these portal servers somewhere inside there's of course some layers like a",
    "start": "319759",
    "end": "326199"
  },
  {
    "text": "cloud flare whatever in front of it so you don't go directly to them but the",
    "start": "326199",
    "end": "331520"
  },
  {
    "text": "pages are somehow at some level served by a portal server uh then we have the business bank and customers there's",
    "start": "331520",
    "end": "338800"
  },
  {
    "text": "180,000 of them they are also using applications developed on this portal",
    "start": "338800",
    "end": "344319"
  },
  {
    "text": "server technolog I put them in here that of course there are developers that are working on these portal systems because",
    "start": "344319",
    "end": "351080"
  },
  {
    "text": "they has to be maintained and patched and uh I mean we are like any bank we are very regulated so we need to ensure",
    "start": "351080",
    "end": "357880"
  },
  {
    "text": "that our software is up to date by patching and so on otherwise we will get audited um so all the new uh developers",
    "start": "357880",
    "end": "366000"
  },
  {
    "text": "it's very hard to get them to work with the the Legacy systems they all look to what the other developers can do on",
    "start": "366000",
    "end": "373120"
  },
  {
    "text": "cetes so that is setting the context so",
    "start": "373120",
    "end": "378520"
  },
  {
    "text": "some of you may be sitting here and thinking what what is a portal server I already I brought you a little back to",
    "start": "378520",
    "end": "385120"
  },
  {
    "text": "the past so it's something from they started around after year 2000 it was a",
    "start": "385120",
    "end": "391720"
  },
  {
    "text": "new technology I guess all the Architects and people who worked on the",
    "start": "391720",
    "end": "397080"
  },
  {
    "text": "year 200 problem they got lazy and then they thought we have to invent something new complicated and then they came up",
    "start": "397080",
    "end": "403120"
  },
  {
    "text": "with the portal server here's a small introduction what it is so in",
    "start": "403120",
    "end": "410400"
  },
  {
    "text": "the port server you run something called portlets and they are basically Java web applications uh they adhere to a",
    "start": "410400",
    "end": "416919"
  },
  {
    "text": "framework so there are specific things you can do in then you have to define the views and so on how it is in in a in",
    "start": "416919",
    "end": "425000"
  },
  {
    "text": "a way that's conformant to this framework um there are some web page definitions page definitions you may see",
    "start": "425000",
    "end": "432680"
  },
  {
    "text": "there that you can compose the portlets into a single page um more portlets and",
    "start": "432680",
    "end": "439520"
  },
  {
    "text": "you can Define the layouts and content I mean static content of the pages uh and",
    "start": "439520",
    "end": "445160"
  },
  {
    "text": "again as part of this portal server also we have some traditional Java E",
    "start": "445160",
    "end": "450840"
  },
  {
    "text": "Resources so again if you have little history you probably know that some few years back that was the the top of the",
    "start": "450840",
    "end": "458720"
  },
  {
    "text": "line everybody wanted to um how we running it on the right",
    "start": "458720",
    "end": "464400"
  },
  {
    "text": "side here we see that um the nodes we I look at the bottom that is the portal servers portal",
    "start": "464400",
    "end": "470639"
  },
  {
    "text": "servers it's a it's a jvm a large jvm with a lot of applications inside uh how",
    "start": "470639",
    "end": "477560"
  },
  {
    "text": "do you scale it up uh we don't scale up we scale It Out by running more instances beside each other it's nothing",
    "start": "477560",
    "end": "484080"
  },
  {
    "text": "new in this uh as I'm saying they have been doing the same since uh almost 20 years now so uh at uh in this setup they",
    "start": "484080",
    "end": "494360"
  },
  {
    "text": "have sh starts when I say stores I don't mean just uh file stores it's also database stores for example so they",
    "start": "494360",
    "end": "499919"
  },
  {
    "text": "share all these instances look on noes they look at the same at the bottom on",
    "start": "499919",
    "end": "504960"
  },
  {
    "text": "top of it there's some HTTP uh proxies that kind of uh they right rules and",
    "start": "504960",
    "end": "510280"
  },
  {
    "text": "everything but they're kind of bound to how the portal servers work and on top of course we have a external load",
    "start": "510280",
    "end": "516599"
  },
  {
    "text": "balancer facing the internet or the internal network if we imagine some customer",
    "start": "516599",
    "end": "523360"
  },
  {
    "text": "coming because this setup uh users they will always be directed to the same",
    "start": "523360",
    "end": "528959"
  },
  {
    "text": "active node so moving uh if you if the node dies then",
    "start": "528959",
    "end": "536200"
  },
  {
    "text": "you will have to log in again that's uh just how it is in this",
    "start": "536200",
    "end": "541360"
  },
  {
    "text": "setup and at some point uh as I said and this setup it has been running for Neil 20",
    "start": "541360",
    "end": "548440"
  },
  {
    "text": "years and I'm in a platform team somebody came and said uh isn't this like a platform why don't you run run",
    "start": "548440",
    "end": "556120"
  },
  {
    "text": "these portal servers H it's probably somebody it is definitely somebody from management who thought that had that",
    "start": "556120",
    "end": "562920"
  },
  {
    "text": "thought because we we would like to just work on the Cates but anyway became platform as part of uh our",
    "start": "562920",
    "end": "570000"
  },
  {
    "text": "taking it into the team we decided we want to move this to run on kubernetes",
    "start": "570000",
    "end": "576000"
  },
  {
    "text": "at the same time uh we thought about how can we make a better developer experience for this because uh in the",
    "start": "576000",
    "end": "582800"
  },
  {
    "text": "old setup I didn't take any slides here but you can imagine it's something about",
    "start": "582800",
    "end": "588000"
  },
  {
    "text": "change management logging into Mainframe uh black pages and Mainframe and making",
    "start": "588000",
    "end": "594399"
  },
  {
    "text": "changes and so on and moving things around so it was also some something",
    "start": "594399",
    "end": "599680"
  },
  {
    "text": "that was design designed 20 years ago we want to uh reap the benefits of a modern",
    "start": "599680",
    "end": "607200"
  },
  {
    "text": "kuber need is developer experience just for this type of platform so as is that",
    "start": "607200",
    "end": "614000"
  },
  {
    "text": "is that SP developer insight into what is actually running in the bortle because they can press a deploy button",
    "start": "614000",
    "end": "620640"
  },
  {
    "text": "but then they don't know actually what happens um it's in production systems we",
    "start": "620640",
    "end": "625880"
  },
  {
    "text": "we can't allow them to do that because it's customer data and",
    "start": "625880",
    "end": "631440"
  },
  {
    "text": "uh and then that was just how it was uh the developer experience",
    "start": "631440",
    "end": "637160"
  },
  {
    "text": "also these people are not only Developers for for the portal servers",
    "start": "637160",
    "end": "642680"
  },
  {
    "text": "they're also developers on kubernetes so they have kind of this extra cogntive load that okay they want to develop on",
    "start": "642680",
    "end": "649279"
  },
  {
    "text": "the modern but they still have to think about how do we how do we develop these",
    "start": "649279",
    "end": "654760"
  },
  {
    "text": "portlets and it's it was very different from the normal their normal workflow uh",
    "start": "654760",
    "end": "659920"
  },
  {
    "text": "one last point I put that is that the development options for this running on servers and so on they need sometimes",
    "start": "659920",
    "end": "666040"
  },
  {
    "text": "they need a local environment they only for themselves when they sit and develop on it and that was not very easy uh we",
    "start": "666040",
    "end": "673399"
  },
  {
    "text": "made something about we uh installed the portal in the windows version and we",
    "start": "673399",
    "end": "679040"
  },
  {
    "text": "made a 20 GB zip file they could download or so on but it was not a good",
    "start": "679040",
    "end": "684639"
  },
  {
    "text": "experience so we took inspiration I mean the other",
    "start": "684639",
    "end": "690480"
  },
  {
    "text": "KU existing cncf projects that uh that that work with kues and how to",
    "start": "690480",
    "end": "697040"
  },
  {
    "text": "manage external resources so um for example cross crossplane that's one",
    "start": "697040",
    "end": "703000"
  },
  {
    "text": "thing that comes to mind it's not the same but uh it's kind of the idea that",
    "start": "703000",
    "end": "709160"
  },
  {
    "text": "something living outside of kues you can also use kues to operate then yes and then the question can we do",
    "start": "709160",
    "end": "717120"
  },
  {
    "text": "it and of course yes we can do it otherwise will not be having the talk today and and how do we do it in it's",
    "start": "717120",
    "end": "723839"
  },
  {
    "text": "controllers lots of controllers every time we see some problem that we need",
    "start": "723839",
    "end": "729639"
  },
  {
    "text": "to some problem with operating some part then we our solution is always it has",
    "start": "729639",
    "end": "735040"
  },
  {
    "text": "always been to create a controller for it to do it I listed a small list of the",
    "start": "735040",
    "end": "740839"
  },
  {
    "text": "existing controllers here so we have some we call it an environment controller and the idea is that it's a",
    "start": "740839",
    "end": "747360"
  },
  {
    "text": "controller that can spin up a portal server with the with the configured and",
    "start": "747360",
    "end": "752959"
  },
  {
    "text": "ready to use inside the control this specific controller it's not very",
    "start": "752959",
    "end": "758040"
  },
  {
    "text": "Advanced it builds on Helm and enle so there's a Helm part that spins up the parts the kubernetes parts and then",
    "start": "758040",
    "end": "764279"
  },
  {
    "text": "there's an enle part that connects into the running parts and do the",
    "start": "764279",
    "end": "770519"
  },
  {
    "text": "configuration what we call a deployment controller that is about managing these uh portal resources inside the portal",
    "start": "770519",
    "end": "778959"
  },
  {
    "text": "and um we have chest environment control I said before developers they want to develop so uh we created a controller",
    "start": "778959",
    "end": "786839"
  },
  {
    "text": "that can spin up this type of temporary environment for them with all the",
    "start": "786839",
    "end": "791920"
  },
  {
    "text": "outside necessary connections to the back ends and so on create a restart controller it turns out restarting uh",
    "start": "791920",
    "end": "799560"
  },
  {
    "text": "this type of portal server it's not as easy as pressing the kuon uh roll out",
    "start": "799560",
    "end": "806040"
  },
  {
    "text": "button um they need to be reach that has that some pre preps that need to be done",
    "start": "806040",
    "end": "811320"
  },
  {
    "text": "to shut them down in a proper way there's they have to be restarted in a specific order the parts and uh",
    "start": "811320",
    "end": "818160"
  },
  {
    "text": "afterwards we have to do some post process to make them join again uh the",
    "start": "818160",
    "end": "825199"
  },
  {
    "text": "setup there a login controller again it's a old application we're just putting it into kubernetes and running",
    "start": "825199",
    "end": "831160"
  },
  {
    "text": "it so uh it does not conform to the standard outling and so on so what do we",
    "start": "831160",
    "end": "836759"
  },
  {
    "text": "do and we create some controller that and collect connect and uh collect the",
    "start": "836759",
    "end": "842240"
  },
  {
    "text": "locks to and put it into the centralized locking management back end controller um yeah",
    "start": "842240",
    "end": "850279"
  },
  {
    "text": "that's just another controller so again there's some state in this portal that has to be there for the all the",
    "start": "850279",
    "end": "856959"
  },
  {
    "text": "application in the portal to work correctly and what do we do we look at",
    "start": "856959",
    "end": "862279"
  },
  {
    "text": "the existing logic we create a controller that mimics it and just puts it into the existing one so",
    "start": "862279",
    "end": "870120"
  },
  {
    "text": "it's state Matrix we know from kubernetes that's the coupe State Matrix where it collects all the resources kues",
    "start": "870120",
    "end": "876399"
  },
  {
    "text": "resources and expose them as promethus to and again we created some state",
    "start": "876399",
    "end": "881440"
  },
  {
    "text": "matrics for all the portal resources where we had created new custom resources for and controllers you say",
    "start": "881440",
    "end": "888639"
  },
  {
    "text": "it's not this type of controllers so when when we are we looked at the controllers without each controllers we",
    "start": "888639",
    "end": "895120"
  },
  {
    "text": "need so all these controllers they have some properties and main thing is that uh we have a",
    "start": "895120",
    "end": "901320"
  },
  {
    "text": "specification what should it be like the resource and uh the status of how is it then and that that is kept inside inside",
    "start": "901320",
    "end": "909040"
  },
  {
    "text": "the kues resource um that's the actual uh resource inside the portal that's the",
    "start": "909040",
    "end": "916160"
  },
  {
    "text": "implementation we can say of the kubernetes specification this model we like it for",
    "start": "916160",
    "end": "922040"
  },
  {
    "text": "some uh I mean there are different types of models we we like this model because it's very simple to think about it if",
    "start": "922040",
    "end": "928680"
  },
  {
    "text": "you think think about a state state machine State machines there are like you have to know what is the exact State",
    "start": "928680",
    "end": "935000"
  },
  {
    "text": "what are the edges where how can you go to the next state and so on here it's what we call level trigger level",
    "start": "935000",
    "end": "941120"
  },
  {
    "text": "triggered means we look at the complete resource and the complete status and",
    "start": "941120",
    "end": "946319"
  },
  {
    "text": "then based on that can we level up that's is what the recanalization loop",
    "start": "946319",
    "end": "951560"
  },
  {
    "text": "recanalization loop does it kind of levels up up to a final R State uh",
    "start": "951560",
    "end": "958360"
  },
  {
    "text": "resilient we can restart these deployment Loops how we want because it will always just pick up from the last",
    "start": "958360",
    "end": "964959"
  },
  {
    "text": "known State uh the last point to put temp that means that at any time we can",
    "start": "964959",
    "end": "970120"
  },
  {
    "text": "rerun the steps without any I mean that is kind of the reconation that has to implement that so uh in order for the",
    "start": "970120",
    "end": "977920"
  },
  {
    "text": "model to work there great Frameworks available already controller runtime if any of you have created controllers you",
    "start": "977920",
    "end": "984959"
  },
  {
    "text": "probably have used that uh it's part of the coup operator",
    "start": "984959",
    "end": "990000"
  },
  {
    "text": "SDK there's the Java operators SDK I said before we are Java shop so that's what we used but basically any any",
    "start": "990000",
    "end": "997480"
  },
  {
    "text": "language you like there's cou eyes for rust and there's something called coop for python they all implement this type",
    "start": "997480",
    "end": "1003240"
  },
  {
    "text": "of controller logic that you can just take down and start using it um I I",
    "start": "1003240",
    "end": "1009639"
  },
  {
    "text": "think I said most about this the desired bort resource that is just the kuet description Exel resource that is what",
    "start": "1009639",
    "end": "1016399"
  },
  {
    "text": "we say it's provisioned in inside the portal as some examples of this resource",
    "start": "1016399",
    "end": "1021480"
  },
  {
    "text": "for example a portlet we I shown before there's also data source data source is like a configuration of how to connect",
    "start": "1021480",
    "end": "1027839"
  },
  {
    "text": "to a database if you know J May probably you know all these secrets inside the kones",
    "start": "1027839",
    "end": "1034880"
  },
  {
    "text": "we have a secret but inside the portal server the same kind of implementation a different kind is and cues and so on",
    "start": "1034880",
    "end": "1043640"
  },
  {
    "text": "important is that one uh one of these portal installations it consists about 2,000 portal resources",
    "start": "1043640",
    "end": "1049559"
  },
  {
    "text": "uh that's not many you can say it's some but uh we have to think about that uh if we",
    "start": "1049559",
    "end": "1056200"
  },
  {
    "text": "have just one a portal running that's not bad but we have maybe in a cluster we can have maybe 10 of these portals",
    "start": "1056200",
    "end": "1062919"
  },
  {
    "text": "Runnings and then suddenly the number of resources that needs to be reconciled it",
    "start": "1062919",
    "end": "1069320"
  },
  {
    "text": "grows H this is a little bit more about this controller how how does it work so",
    "start": "1069320",
    "end": "1075159"
  },
  {
    "text": "there the kubernetes resource and there's a source event handler that list listens or watches the kuon resources if",
    "start": "1075159",
    "end": "1081400"
  },
  {
    "text": "it sees any change it adds it to the work CU and there the work the controller will then look at the work",
    "start": "1081400",
    "end": "1087559"
  },
  {
    "text": "queue if there are more events on the same it will kind of D duplicate them once it goes through the queue and",
    "start": "1087559",
    "end": "1093840"
  },
  {
    "text": "it's ready there's a work already to actually do the reconcilation then the controller will also make sure that only",
    "start": "1093840",
    "end": "1100720"
  },
  {
    "text": "one resource only reconciled one time uh concurrently so it can't there not two",
    "start": "1100720",
    "end": "1107480"
  },
  {
    "text": "workers that can work on the same same resource I mean different versions of the same",
    "start": "1107480",
    "end": "1113200"
  },
  {
    "text": "resource um also it will periodically reconcile all the",
    "start": "1113200",
    "end": "1118840"
  },
  {
    "text": "resources uh so just in case it gets some um it kind of gets out of state",
    "start": "1118840",
    "end": "1124360"
  },
  {
    "text": "somewhere then it's like a fail safe it will also reconcile all res at startup",
    "start": "1124360",
    "end": "1130640"
  },
  {
    "text": "and finally many of these controllers they have a caching of resources just to make it fast so it don't need to inct so",
    "start": "1130640",
    "end": "1136120"
  },
  {
    "text": "much with the Comm AA the right side we see there's a portal resource so that's",
    "start": "1136120",
    "end": "1142120"
  },
  {
    "text": "the final thing once it has been that's what the reconation loop does it somehow",
    "start": "1142120",
    "end": "1147360"
  },
  {
    "text": "interacts with the portal and updates the re actual resource um have an example have the",
    "start": "1147360",
    "end": "1153799"
  },
  {
    "text": "deployment uh controller um let's just go through it",
    "start": "1153799",
    "end": "1158960"
  },
  {
    "text": "at the left side we have a we keep all our configuration in git so we have a",
    "start": "1158960",
    "end": "1164120"
  },
  {
    "text": "git repository that defines the resources the kuon resources that are needed for for this portal U the",
    "start": "1164120",
    "end": "1170760"
  },
  {
    "text": "developer can directly interact with this configuration if if they wish to the they can also use the pipelines and",
    "start": "1170760",
    "end": "1177960"
  },
  {
    "text": "tooling around it and and we have a put an API on top of the git just to get around of this uh concurrent update of",
    "start": "1177960",
    "end": "1186440"
  },
  {
    "text": "git problem then we have a typical AR CD that takes the configuration from git and put it into the cluster in this",
    "start": "1186440",
    "end": "1193840"
  },
  {
    "text": "example then we have two uh Nam spaces portal a and portal B each one contains one",
    "start": "1193840",
    "end": "1199880"
  },
  {
    "text": "uh it describes one portal H in the case of portal a it's a",
    "start": "1199880",
    "end": "1205919"
  },
  {
    "text": "portal that runs outside of gones but in the case of portal B it's a portal that",
    "start": "1205919",
    "end": "1211240"
  },
  {
    "text": "runs inside gontis I'm just putting a single note here in there but you can imagine",
    "start": "1211240",
    "end": "1217520"
  },
  {
    "text": "there can be any number of notes depending on what I mean if it's a small",
    "start": "1217520",
    "end": "1222919"
  },
  {
    "text": "developer then there's just a single note if it's a production then maybe there are 15 or something",
    "start": "1222919",
    "end": "1229679"
  },
  {
    "text": "so the deployment controller it does it watches these resources and it updates into the portal like we saw before and",
    "start": "1229679",
    "end": "1237159"
  },
  {
    "text": "the state metric it again it watches and it exposes the metrics to promethus so",
    "start": "1237159",
    "end": "1242600"
  },
  {
    "text": "developers can get an Insight yes a little more about it so",
    "start": "1242600",
    "end": "1248840"
  },
  {
    "text": "just to sum up what we learned up to now the we said we want to solve a problem for developers and now actually we have",
    "start": "1248840",
    "end": "1254720"
  },
  {
    "text": "we have solved that problem for the developers they use git like they do in uh their normal kubernetes development",
    "start": "1254720",
    "end": "1261280"
  },
  {
    "text": "they don't really care about what portal is it a portal running inside kubernetes outside it's not uh it's not their",
    "start": "1261280",
    "end": "1267000"
  },
  {
    "text": "portal they're concerned about the portal resources that they own and they will get the status of these resources",
    "start": "1267000",
    "end": "1274159"
  },
  {
    "text": "either by looking at the kubernetes resources or by looking at the state Magics they don't need to go into the",
    "start": "1274159",
    "end": "1280799"
  },
  {
    "text": "portal itself um yeah it's just an example of some resources here we have",
    "start": "1280799",
    "end": "1289919"
  },
  {
    "text": "so how do you reconcile from into a portal you can see there there different",
    "start": "1289919",
    "end": "1296120"
  },
  {
    "text": "things that needs to be done but uh an overall theme I think we can call it that is calling some scripts inside a",
    "start": "1296120",
    "end": "1302480"
  },
  {
    "text": "portal node and that is how this portal server it works that you call these",
    "start": "1302480",
    "end": "1307559"
  },
  {
    "text": "scripts for updating different types of resources inside the portal typically",
    "start": "1307559",
    "end": "1313120"
  },
  {
    "text": "the scripts they the shell scripts they need some scripts themselves uh for",
    "start": "1313120",
    "end": "1318159"
  },
  {
    "text": "example for the first one WS web spere admin it needs to have a python script",
    "start": "1318159",
    "end": "1324039"
  },
  {
    "text": "so in order to update in Portal you give it a python script and it will do the connect to the portal API and uh get it",
    "start": "1324039",
    "end": "1332440"
  },
  {
    "text": "done um updates into the portal unfortunately there are serial and synchronous that means uh you can only",
    "start": "1332440",
    "end": "1339159"
  },
  {
    "text": "call one uh one script at a time because the state in the portal is shared it",
    "start": "1339159",
    "end": "1345159"
  },
  {
    "text": "only allows to make one modification at a time and a synchronous means that you have to call the script and you have to",
    "start": "1345159",
    "end": "1350919"
  },
  {
    "text": "wait for it to complete if you do not wait then it will just simply roll it back um and another problem some of",
    "start": "1350919",
    "end": "1357760"
  },
  {
    "text": "these updates they can take up to one minute um just in actual updates it",
    "start": "1357760",
    "end": "1363320"
  },
  {
    "text": "depends how does it run we can do it by SSH to an external one and all the scripts are just cou CLE X kind of from",
    "start": "1363320",
    "end": "1371480"
  },
  {
    "text": "the API so yeah one minute that sounds like a long time I don't know if you have any",
    "start": "1371480",
    "end": "1377919"
  },
  {
    "text": "Recon that takes one one minute and so when you construct a control on how",
    "start": "1377919",
    "end": "1386480"
  },
  {
    "text": "how to what is the best practice and that is just to reconcile reconcile every time there's a change you",
    "start": "1386480",
    "end": "1392480"
  },
  {
    "text": "reconcile you read the complete State and you decide what are the things that has to be done um here's just some quote",
    "start": "1392480",
    "end": "1400039"
  },
  {
    "text": "from our deployment controller we read the state in the",
    "start": "1400039",
    "end": "1405440"
  },
  {
    "text": "bottle and that that is one of the thing that takes time and we check if it needs the update and if it",
    "start": "1405440",
    "end": "1411000"
  },
  {
    "text": "needs then we will push the update out in the portal so if we remember the picture",
    "start": "1411000",
    "end": "1417480"
  },
  {
    "text": "before about the work queue that uh you can imagine that this work que",
    "start": "1417480",
    "end": "1423720"
  },
  {
    "text": "when the controller after starting off but also if there's this reconation event then the queue it will be full I",
    "start": "1423720",
    "end": "1430520"
  },
  {
    "text": "mean uh it will have a lot of items to process and if each item takes one minute and we had 2,000 items in up to",
    "start": "1430520",
    "end": "1439200"
  },
  {
    "text": "one minute and uh while this happens we have a developer he just uh made a new",
    "start": "1439200",
    "end": "1445799"
  },
  {
    "text": "feature and he sitting and where is my feature so that it's not",
    "start": "1445799",
    "end": "1450960"
  },
  {
    "text": "a this best practice pattern it did not work in practice for and we did a quick",
    "start": "1450960",
    "end": "1457480"
  },
  {
    "text": "U test to it's a called observ generation pattern that's something this Java operator framework supports and",
    "start": "1457480",
    "end": "1465399"
  },
  {
    "text": "it's also part of the kubernetes today that on the on the status field you put an",
    "start": "1465399",
    "end": "1471679"
  },
  {
    "text": "observe generation field that uh once you are done reconcillation then you",
    "start": "1471679",
    "end": "1476720"
  },
  {
    "text": "update the observe generation so the next time the reconation starts if there's no change if the generation in",
    "start": "1476720",
    "end": "1483240"
  },
  {
    "text": "the metadata is not changed then you can simply skip it um",
    "start": "1483240",
    "end": "1489000"
  },
  {
    "text": "does it work I mean it it has that drawback that you have to trust that",
    "start": "1489000",
    "end": "1494320"
  },
  {
    "text": "there's no changes inside the the actual portal because you don't check it at or you just check the status in the",
    "start": "1494320",
    "end": "1500360"
  },
  {
    "text": "resource you use the kubernetes resource as kind of a cash for what is there so I",
    "start": "1500360",
    "end": "1506399"
  },
  {
    "text": "says okay in production because in production we don't give developers access to actually go and change things",
    "start": "1506399",
    "end": "1513279"
  },
  {
    "text": "themselves so if something changes then it has to be a system change and that doesn't happen that often so it's okay",
    "start": "1513279",
    "end": "1520399"
  },
  {
    "text": "in development developers can log in in the in the portal and do modification so",
    "start": "1520399",
    "end": "1526200"
  },
  {
    "text": "there it's not a good idea yeah so that's another pattern then for",
    "start": "1526200",
    "end": "1534000"
  },
  {
    "text": "how to how how how to solve this uh so one is called external State pattern so",
    "start": "1534000",
    "end": "1541480"
  },
  {
    "text": "in the external State pattern um we kind of divide the reconciliation Loop in two parts uh",
    "start": "1541480",
    "end": "1550559"
  },
  {
    "text": "when a new portal resource is created here it's a portal resource but any kind of resource that use that pattern Bas",
    "start": "1550559",
    "end": "1556480"
  },
  {
    "text": "but a new portal resource is cre it at the same time the controller will create a config map in for example conf another",
    "start": "1556480",
    "end": "1563880"
  },
  {
    "text": "resource to hold the state most we use a config map the config map is set with an owner reference to this portal resource",
    "start": "1563880",
    "end": "1571520"
  },
  {
    "text": "so and then the deployment controller will watch both of both of them so it will read receive events for both of",
    "start": "1571520",
    "end": "1578200"
  },
  {
    "text": "these two resources instead of only the portal resource there's a second uh process",
    "start": "1578200",
    "end": "1585039"
  },
  {
    "text": "here on the right the deployment Observer that then does the part about reading the state inside the portal",
    "start": "1585039",
    "end": "1591640"
  },
  {
    "text": "server and once the State updates in updates to the state then it will update the config map and because the",
    "start": "1591640",
    "end": "1598360"
  },
  {
    "text": "controller watches it and it knows the relationship between the config map and the portal resource it will then Trigg",
    "start": "1598360",
    "end": "1604440"
  },
  {
    "text": "reconcillation for the portal resource and finally it will do the update um we can see that when at",
    "start": "1604440",
    "end": "1612720"
  },
  {
    "text": "startup there's no change by the deployment Observer so the config might",
    "start": "1612720",
    "end": "1618039"
  },
  {
    "text": "is the same as last time meaning the this these periodic reconciliations they",
    "start": "1618039",
    "end": "1623360"
  },
  {
    "text": "will run fast that they don't need to go to the in our case we The Observer and",
    "start": "1623360",
    "end": "1630480"
  },
  {
    "text": "the controller there in one big application but that's just our our implementation of",
    "start": "1630480",
    "end": "1637559"
  },
  {
    "text": "it um yes let's look a little into it so here we have the config map and it has",
    "start": "1637559",
    "end": "1643279"
  },
  {
    "text": "some data as we know the when is it triggered uh when is an event generated",
    "start": "1643279",
    "end": "1649000"
  },
  {
    "text": "it's only generated when the spec is updated so we have to when the data is updated here then the event is fired and",
    "start": "1649000",
    "end": "1658440"
  },
  {
    "text": "the deployment controller gets it and finally the yeah it changes then we can",
    "start": "1658440",
    "end": "1667120"
  },
  {
    "text": "read the actual resource the portal resource and we can compare it with the state that was just updated in the",
    "start": "1667120",
    "end": "1673679"
  },
  {
    "text": "config map and we can decide do we need to do something is so that resolves the",
    "start": "1673679",
    "end": "1679919"
  },
  {
    "text": "problem about the startup right um I I just mention that we had some",
    "start": "1679919",
    "end": "1688519"
  },
  {
    "text": "uh I mean uh basically this is what has to be done for us to reconcile these",
    "start": "1688519",
    "end": "1693679"
  },
  {
    "text": "external resources so that that kind of sums up that part about it I put a Pon slide in here because in know practice",
    "start": "1693679",
    "end": "1700399"
  },
  {
    "text": "my presentation always I take a few minutes too little so I talked in one of",
    "start": "1700399",
    "end": "1705440"
  },
  {
    "text": "the previous slides about we want to uh improve the developer experience also about these local environments and for",
    "start": "1705440",
    "end": "1712679"
  },
  {
    "text": "that we created the test environment controller um that I just want to quickly mention here because we used the",
    "start": "1712679",
    "end": "1719919"
  },
  {
    "text": "valer backup so before we had to get the full uh portal stat the storage out of",
    "start": "1719919",
    "end": "1727600"
  },
  {
    "text": "we have to draw it out of the portal save it somewhere externally and then they had to take it down and install it",
    "start": "1727600",
    "end": "1733960"
  },
  {
    "text": "uh using Valero and kubernetes volume snapshots we can it's like a snap it's a",
    "start": "1733960",
    "end": "1740080"
  },
  {
    "text": "snapshot to actually do it so this time to create a test environment and update",
    "start": "1740080",
    "end": "1748600"
  },
  {
    "text": "it the problem is they need to update it all the time so it's consistent with the actual environment uh they can do that",
    "start": "1748600",
    "end": "1755480"
  },
  {
    "text": "uh in few minutes now before it would take hours so the key takeaways here from my talk",
    "start": "1755480",
    "end": "1762720"
  },
  {
    "text": "today so definitely you can do it every time our our approach is that uh we need",
    "start": "1762720",
    "end": "1769600"
  },
  {
    "text": "to know the application that we want to wrap we need to know the apis uh around it and we need to yeah we",
    "start": "1769600",
    "end": "1777200"
  },
  {
    "text": "create a controller every time it is and we need to know about how to design controllers to handle the situations",
    "start": "1777200",
    "end": "1784120"
  },
  {
    "text": "about external resources that are somehow sometimes not easy to get from",
    "start": "1784120",
    "end": "1790320"
  },
  {
    "text": "the developer side uh our developers they easy access to the applications",
    "start": "1790320",
    "end": "1795519"
  },
  {
    "text": "today now so and is familiar with them so as I said there less less generally",
    "start": "1795519",
    "end": "1801240"
  },
  {
    "text": "less cogntive Lo that gives happy developers so they don't have to break so much out of the that now they're not",
    "start": "1801240",
    "end": "1808000"
  },
  {
    "text": "working with kubernetes anymore they don't have to remember that now they have to go other places to look for",
    "start": "1808000",
    "end": "1813640"
  },
  {
    "text": "Staters and so on their known workflow with Git and Aro City everything is the",
    "start": "1813640",
    "end": "1819039"
  },
  {
    "text": "same thing for them last thing they have a much faster feedback look because how we optimized",
    "start": "1819039",
    "end": "1826320"
  },
  {
    "text": "it thank you and I'm just mentioned very little today but",
    "start": "1826320",
    "end": "1831600"
  },
  {
    "text": "actually it's a part of a big setup right with a lot of technologies that a lot of good open source projects",
    "start": "1831600",
    "end": "1839440"
  },
  {
    "text": "that we have already here heard about here today so I saw other slides with I mean for",
    "start": "1839440",
    "end": "1846039"
  },
  {
    "text": "example we have something called automation highway is our way of managing environments uh through",
    "start": "1846039",
    "end": "1852200"
  },
  {
    "text": "pipelines and all all that part that is kind of good practice for for it",
    "start": "1852200",
    "end": "1858480"
  },
  {
    "text": "um I want to especially mention the development today we use for this uh most of our controllers we use quers and",
    "start": "1858480",
    "end": "1865880"
  },
  {
    "text": "quagi in the quagi verse there's a operator plugin that wraps this Java",
    "start": "1865880",
    "end": "1872240"
  },
  {
    "text": "operator SDK so it's very very simple to get started with an application that",
    "start": "1872240",
    "end": "1877880"
  },
  {
    "text": "where you get all the metrics everything out of it uh it builds on the fabricate",
    "start": "1877880",
    "end": "1883240"
  },
  {
    "text": "kuet library and the ja is key so thanks to all these great",
    "start": "1883240",
    "end": "1889639"
  },
  {
    "text": "projects that's all that I had today if any questions then let me know Q&A",
    "start": "1889639",
    "end": "1894960"
  },
  {
    "text": "session will start",
    "start": "1894960",
    "end": "1899200"
  },
  {
    "text": "thanks actually I have one question with respect to the uh reconciliation that you were talking about so uh in the",
    "start": "1901000",
    "end": "1908279"
  },
  {
    "text": "reconciliation process uh like don't isn't it better to use the hel charts to",
    "start": "1908279",
    "end": "1913840"
  },
  {
    "text": "generate a unique image ID or any hash based on certain variables we just",
    "start": "1913840",
    "end": "1919679"
  },
  {
    "text": "compare that in order to like recile rather than compare many different",
    "start": "1919679",
    "end": "1925320"
  },
  {
    "text": "variables it's I think what you are saying that was basically the second option about the observed generation",
    "start": "1925320",
    "end": "1932519"
  },
  {
    "text": "that mean you are talking about that we keep we keep the portal state inside the",
    "start": "1932519",
    "end": "1939320"
  },
  {
    "text": "kubernetes status resource so and and that is a good approach it's very fast",
    "start": "1939320",
    "end": "1944720"
  },
  {
    "text": "but it has the problem about the drift of the portal if the port toal drifts from what we know in kubernetes so at",
    "start": "1944720",
    "end": "1951080"
  },
  {
    "text": "some point we need to still make the full reconciliation and we can we we could do",
    "start": "1951080",
    "end": "1957480"
  },
  {
    "text": "that less often and then use the cast version for most of the time that is",
    "start": "1957480",
    "end": "1963519"
  },
  {
    "text": "another option oh you",
    "start": "1963519",
    "end": "1968559"
  },
  {
    "text": "right yes",
    "start": "1968880",
    "end": "1972880"
  },
  {
    "text": "no more questions then let us say thanks for today that's one question art I have",
    "start": "1978720",
    "end": "1984320"
  },
  {
    "text": "a question let me okay can you move back to the slide uh which was deployment controller sorry the slide named",
    "start": "1984320",
    "end": "1991600"
  },
  {
    "text": "deployment controller uh let me see if I can this",
    "start": "1991600",
    "end": "1996720"
  },
  {
    "text": "one yeah this one yes so you mentioned about portal B uh shared uh portal B node being inside the cluster and portal",
    "start": "1996720",
    "end": "2003639"
  },
  {
    "text": "a being outside the cluster so is Portal a your legacy deployment which is uh on",
    "start": "2003639",
    "end": "2009600"
  },
  {
    "text": "bare metal I imagine or on premises um it's all on premises okay I",
    "start": "2009600",
    "end": "2015919"
  },
  {
    "text": "mean that's uh it's something we are looking into because we we we do not uh",
    "start": "2015919",
    "end": "2023120"
  },
  {
    "text": "um once we operating it inside kubernetes we are looking into some hybrid Cloud options where we can scale",
    "start": "2023120",
    "end": "2030360"
  },
  {
    "text": "it out to I mean in Banks if any of you in Banks typically the end of the month",
    "start": "2030360",
    "end": "2036200"
  },
  {
    "text": "people need to check if salary came and the first they need to pay their bills so we have huge Peaks uh on those two",
    "start": "2036200",
    "end": "2044000"
  },
  {
    "text": "days and the rest of the month we could easily run on scale Town version sure so",
    "start": "2044000",
    "end": "2049520"
  },
  {
    "text": "so portal a node is uh running on physical hardware version Mach yes it's",
    "start": "2049520",
    "end": "2054919"
  },
  {
    "text": "running on uh it's virtualized Hardware but still it's a static Hardware we",
    "start": "2054919",
    "end": "2060158"
  },
  {
    "text": "cannot easily scale it up got it and the portal B node they are running on",
    "start": "2060159",
    "end": "2065280"
  },
  {
    "text": "kubernetes clusters that you also maintain on premises yes also on premises understood so your developers",
    "start": "2065280",
    "end": "2072440"
  },
  {
    "text": "have to only uh be aware of kubernetes yes Concepts and constructs yes yeah and",
    "start": "2072440",
    "end": "2080638"
  },
  {
    "text": "your deployment controller controls whether the deployment will happen on the physical Hardware portal a or portal",
    "start": "2080639",
    "end": "2088440"
  },
  {
    "text": "B in cubes yes understood so thanks welcome",
    "start": "2088440",
    "end": "2096040"
  },
  {
    "text": "so sorry distribution oh we are bank so we're",
    "start": "2098520",
    "end": "2103680"
  },
  {
    "text": "using open shift distribution so everything that says IBM now they bought",
    "start": "2103680",
    "end": "2109960"
  },
  {
    "text": "R head right so sorry but we are looking at different",
    "start": "2109960",
    "end": "2116720"
  },
  {
    "text": "options for the cloud uh when we want to go hybrid because the",
    "start": "2116720",
    "end": "2125640"
  },
  {
    "text": "we are looking at uh all options there recently open shift it's also available",
    "start": "2132920",
    "end": "2138880"
  },
  {
    "text": "in public clouds so but we just looking",
    "start": "2138880",
    "end": "2144160"
  },
  {
    "text": "at options what to do I mean it's um for us it's mostly a regulation problem",
    "start": "2144160",
    "end": "2150040"
  },
  {
    "text": "about what we can move to cloud and probably these applications they will not be among the first that will go so",
    "start": "2150040",
    "end": "2157920"
  },
  {
    "text": "because they contain a lot of customer information all of them",
    "start": "2157920",
    "end": "2164319"
  },
  {
    "text": "yeah any last questions on the H should we say that's",
    "start": "2166839",
    "end": "2173240"
  },
  {
    "text": "it okay thank you all for coming",
    "start": "2175680",
    "end": "2180559"
  },
  {
    "text": "[Applause]",
    "start": "2182500",
    "end": "2187199"
  }
]