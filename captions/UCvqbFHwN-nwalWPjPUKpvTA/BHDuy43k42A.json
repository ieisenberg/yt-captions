[
  {
    "text": "today what we will cover most is obviously why and the motivation of why",
    "start": "919",
    "end": "8000"
  },
  {
    "text": "we're doing this today and and then we're going to take you take you guys through the different",
    "start": "8000",
    "end": "13440"
  },
  {
    "text": "architecture that we've built we are trying to set up a demo for you",
    "start": "13440",
    "end": "21800"
  },
  {
    "text": "live um we'll see we'll see if the the demo gods are with us we did sacrifice a",
    "start": "21800",
    "end": "27640"
  },
  {
    "text": "few closers this morning so let's see if that comes through and um and then obviously we'll we'll have some",
    "start": "27640",
    "end": "33239"
  },
  {
    "text": "questions and uh and and we'll have some fun together so my name is PED Aliva I'm a Senior Solutions architect at spectr",
    "start": "33239",
    "end": "39640"
  },
  {
    "text": "cloud and I'm joined here today with my esteemed friend Tyler hi everyone I'm",
    "start": "39640",
    "end": "47239"
  },
  {
    "text": "Tyler live yeah um pleased to be here today honored to be presenting here at",
    "start": "47239",
    "end": "52559"
  },
  {
    "text": "cucon um I'm a principal software engineer at Spectre cloud and I manage our Advanced projects team so we get to",
    "start": "52559",
    "end": "59680"
  },
  {
    "text": "build PC's with all the latest greatest exciting kubernetes Tech and then sometimes integrate it with the core",
    "start": "59680",
    "end": "65439"
  },
  {
    "text": "platform one example being two node ha you get to play with the cool",
    "start": "65439",
    "end": "70759"
  },
  {
    "text": "stuff yeah that's what I means cool so let's uh let's take a a step back and",
    "start": "70759",
    "end": "78520"
  },
  {
    "text": "try to picture the scene that we're an Enterprise that effectively is managing",
    "start": "78520",
    "end": "84240"
  },
  {
    "text": "or running different petrol station stores or maybe different coffee shops",
    "start": "84240",
    "end": "89400"
  },
  {
    "text": "or perhaps a retailer right and in this scenario the matter of the fact is that",
    "start": "89400",
    "end": "94720"
  },
  {
    "text": "you will have a lot of locations right so perhaps you want to deploy uh",
    "start": "94720",
    "end": "100200"
  },
  {
    "text": "kubernetes applications there at the edge because you're going through some transformation and you want to give your customers a better user experience or",
    "start": "100200",
    "end": "107439"
  },
  {
    "text": "perhaps you're running inferencing at the edge because these days everything is about Ai and as you do that your",
    "start": "107439",
    "end": "114280"
  },
  {
    "text": "applications need to be highly available okay so because they're critical there",
    "start": "114280",
    "end": "119520"
  },
  {
    "text": "are are situations where you might be able to get away with a one node um",
    "start": "119520",
    "end": "126039"
  },
  {
    "text": "running those applications and if that's the case and your meantime to resolution",
    "start": "126039",
    "end": "131200"
  },
  {
    "text": "if the application goes down is a few hours or maybe a few days and you can sustain that then that's okay but what",
    "start": "131200",
    "end": "137160"
  },
  {
    "text": "we see actually with most of our customers and Enterprises that we work with is that there's a massive need to",
    "start": "137160",
    "end": "143280"
  },
  {
    "text": "actually run business critical applications at the edge and when this comes you actually need to have highly",
    "start": "143280",
    "end": "150280"
  },
  {
    "text": "available infrastructure and obviously highly available applications what this means is things really start to stack up",
    "start": "150280",
    "end": "159280"
  },
  {
    "text": "okay if we're in the data center things are easy right we have highly available power we have highly available virtual",
    "start": "159280",
    "end": "165080"
  },
  {
    "text": "machines bare metal nodes life is good but at the edge that's not really the case sometimes we're highly constrained",
    "start": "165080",
    "end": "171959"
  },
  {
    "text": "when it comes to power when it comes to size and uh also when it comes to money",
    "start": "171959",
    "end": "177560"
  },
  {
    "text": "because things really start to add up so high High availability at the edge really typically means multiplying",
    "start": "177560",
    "end": "183560"
  },
  {
    "text": "everything by three okay so and why is that and I think everyone will be very",
    "start": "183560",
    "end": "190360"
  },
  {
    "text": "familiar with etcd so typically etcd is the culprit",
    "start": "190360",
    "end": "197239"
  },
  {
    "text": "and um what really happens is obviously atcd is the distributed key value store",
    "start": "197239",
    "end": "203840"
  },
  {
    "text": "for kubernetes and ETD uses raft which is a consensus algorithm to figure out",
    "start": "203840",
    "end": "210040"
  },
  {
    "text": "uh who's the leader and who's in charge now you can run ATD with two nodes but",
    "start": "210040",
    "end": "218360"
  },
  {
    "text": "you have no failover if that two node goes down then your ET CD has basically",
    "start": "218360",
    "end": "225439"
  },
  {
    "text": "a catastrophic failure because you lose Quorum and if you guys have been doing kubernetes long enough and you have to",
    "start": "225439",
    "end": "232319"
  },
  {
    "text": "restore at CD you'll know how hard that is doesn't matter how cka makes it look",
    "start": "232319",
    "end": "239519"
  },
  {
    "text": "easy easy it's really not it's really not so we really trying to look at how",
    "start": "239519",
    "end": "247079"
  },
  {
    "text": "can we move away from this in a way that as the title says we move from two from",
    "start": "247079",
    "end": "252519"
  },
  {
    "text": "three and we we go into two so are there other Alternatives so we we we spoke",
    "start": "252519",
    "end": "258600"
  },
  {
    "text": "about single node yes we can go with single node but then you have no no failover so if that goes down and if",
    "start": "258600",
    "end": "264600"
  },
  {
    "text": "that's okay with you if your meantime to resolution if your critical applications can go down for perhaps hours maybe days",
    "start": "264600",
    "end": "271880"
  },
  {
    "text": "that's okay but then you have to perhaps ship your engineer out um they will have",
    "start": "271880",
    "end": "277160"
  },
  {
    "text": "to go there because the manage the store manager doesn't know anything about kubernetes or competitors or whatever",
    "start": "277160",
    "end": "282639"
  },
  {
    "text": "might be then do know that CD it's kind of the same it's pretty much the same as",
    "start": "282639",
    "end": "288360"
  },
  {
    "text": "almost running a one node cluster because if that cluster goes down and let's let's do the maths right if if",
    "start": "288360",
    "end": "295840"
  },
  {
    "text": "we're doing things that scale tens of thousands of devices or even thousands of devices the probability of",
    "start": "295840",
    "end": "302440"
  },
  {
    "text": "an sssd disc to fail on 2,000 devices",
    "start": "302440",
    "end": "307759"
  },
  {
    "text": "really high right so there will be failures and if those failures exist then ETD gets locked and then we we get",
    "start": "307759",
    "end": "314400"
  },
  {
    "text": "into a conundrum external ET CD yes we can go that route but then we are just",
    "start": "314400",
    "end": "320800"
  },
  {
    "text": "adding more complexity to our to our architecture and the same goes for cloud",
    "start": "320800",
    "end": "326080"
  },
  {
    "text": "Witnesses or external Witnesses where perhaps you move this to the cloud at CD",
    "start": "326080",
    "end": "331759"
  },
  {
    "text": "or you will have a witness to then manage who's the leader who's right who's wrong all that kind of stuff but",
    "start": "331759",
    "end": "337080"
  },
  {
    "text": "the problem is again you're adding complexity and not only that what happens if your connectivity is spotty",
    "start": "337080",
    "end": "343440"
  },
  {
    "text": "if you have intermittent connectivity or if you have to be air gapped then this doesn't actually quite covers all ranges",
    "start": "343440",
    "end": "353720"
  },
  {
    "text": "so we really went out on a quest me and Tyler I put my blonde wig up Tyler's",
    "start": "353720",
    "end": "362639"
  },
  {
    "text": "froto kind of never seen them seen them in the same room together um and on this",
    "start": "362639",
    "end": "368280"
  },
  {
    "text": "gray Quest we we set out to effectively go after a few things and these are our",
    "start": "368280",
    "end": "375039"
  },
  {
    "text": "principles for deploying two node highly available applications at the edge so we",
    "start": "375039",
    "end": "381440"
  },
  {
    "text": "focusing on two node infrastructure with highly available stateless applications",
    "start": "381440",
    "end": "387680"
  },
  {
    "text": "and the key here is highly available applications we're not focusing on",
    "start": "387680",
    "end": "393240"
  },
  {
    "text": "infrastructure availability we focusing on application availability okay so",
    "start": "393240",
    "end": "399160"
  },
  {
    "text": "that's the first one architecturally simple so when it comes to external ATD",
    "start": "399160",
    "end": "404280"
  },
  {
    "text": "external witness we we don't want to deal with any of that so we want to be architecturally simple so it's easy to",
    "start": "404280",
    "end": "410080"
  },
  {
    "text": "deploy manage and maintain okay no external dependencies as I mentioned and",
    "start": "410080",
    "end": "415560"
  },
  {
    "text": "what we really didn't want to run into is these computer science can under so we don't want to have to solve the",
    "start": "415560",
    "end": "423319"
  },
  {
    "text": "two generals rule we don't want to go into the into that rabbit hole no control we don't want to redesign",
    "start": "423319",
    "end": "429080"
  },
  {
    "text": "control plane logic none of that so we really try to make things simple and",
    "start": "429080",
    "end": "434639"
  },
  {
    "text": "when I say we I really mean Tyler he's he's the brains behind it",
    "start": "434639",
    "end": "440560"
  },
  {
    "text": "so the the other thing that I just wanted to to point out is when I mention these highly available",
    "start": "440560",
    "end": "447319"
  },
  {
    "text": "applications um I really one of the things is obviously you can start using things like no Affinity",
    "start": "447319",
    "end": "453360"
  },
  {
    "text": "anti-affinity rules all that kind of stuff but in in the application that we're actually running for our demo to",
    "start": "453360",
    "end": "459919"
  },
  {
    "text": "the gods um we actually using the the latest topology spread constraints okay",
    "start": "459919",
    "end": "465599"
  },
  {
    "text": "and this basically just spreads our application into the two nodes that we have that we have available um and and",
    "start": "465599",
    "end": "471919"
  },
  {
    "text": "this allows it to have highly available application so on to the money now how",
    "start": "471919",
    "end": "478400"
  },
  {
    "text": "does it work okay so here we see the uh standard",
    "start": "478400",
    "end": "486360"
  },
  {
    "text": "configuration in a happy path and we have these two machines uh fundamentally",
    "start": "486360",
    "end": "492159"
  },
  {
    "text": "they're powered by chyros which is a meta Linux distribution uh which allows you to pick your OS and kubernetes",
    "start": "492159",
    "end": "498039"
  },
  {
    "text": "version in this case k3s and ship that um bootable image as a container so",
    "start": "498039",
    "end": "504520"
  },
  {
    "text": "that's what gets us k3s in the first place and I've split out the control plane components just for illustration",
    "start": "504520",
    "end": "510120"
  },
  {
    "text": "purposes they're obviously bundled um in reality and then sitting beneath that we",
    "start": "510120",
    "end": "515800"
  },
  {
    "text": "have a couple of things K and postgress which are layered into the image during build time so they're immediately",
    "start": "515800",
    "end": "522000"
  },
  {
    "text": "available on boot and then we have our liveness agent which alongside some",
    "start": "522000",
    "end": "527240"
  },
  {
    "text": "other controllers that are spectr Cloud specific manage the state of the system",
    "start": "527240",
    "end": "532480"
  },
  {
    "text": "so there are a couple different state machines one that executes every time the machine turns on and then a con",
    "start": "532480",
    "end": "539399"
  },
  {
    "text": "continuous reconciliation Loop that we call the liveness service we'll get into that a little bit more um in in further",
    "start": "539399",
    "end": "545200"
  },
  {
    "text": "detail but the gist of it is that the leader machine um is configured so that",
    "start": "545200",
    "end": "550440"
  },
  {
    "text": "Kine points to postgress running on Local Host and then postgress is also running on local host on the follower",
    "start": "550440",
    "end": "556680"
  },
  {
    "text": "but it has a separate kind configuration which points to the leader postgress database and there's some convoluted",
    "start": "556680",
    "end": "563920"
  },
  {
    "text": "well not that convoluted but there's a little bit of a back and forth to ensure that the databases have the same",
    "start": "563920",
    "end": "569519"
  },
  {
    "text": "authentication um and then we have logical replication configured basically",
    "start": "569519",
    "end": "575519"
  },
  {
    "text": "to copy state so every right that hits the leader um gets streamed over to the",
    "start": "575519",
    "end": "580600"
  },
  {
    "text": "follower and that's eventually consistent and these liveness agents are constantly pinging each other with",
    "start": "580600",
    "end": "586880"
  },
  {
    "text": "health checks and they will change the state of the system depending on what they find",
    "start": "586880",
    "end": "594040"
  },
  {
    "text": "out do it's it's it's coming up I think it's",
    "start": "597640",
    "end": "602880"
  },
  {
    "text": "coming up um so we waiting for our cluster to",
    "start": "602880",
    "end": "610800"
  },
  {
    "text": "come up because we had to reconfigure so we we will move on with the architecture and hopefully come back with a demo for",
    "start": "610800",
    "end": "617800"
  },
  {
    "text": "you guys real",
    "start": "617800",
    "end": "620920"
  },
  {
    "text": "demo okay so assuming the leader goes down um what we call a promotion will",
    "start": "624640",
    "end": "630760"
  },
  {
    "text": "happen where the follower decides that it has to be in",
    "start": "630760",
    "end": "635320"
  },
  {
    "text": "charge so maybe the power cord just got unplugged or maybe the hard drive failed could be anything but we're in a",
    "start": "636880",
    "end": "643839"
  },
  {
    "text": "situation now where all of the sudden the leader is no longer online so I mentioned health checks um we do just an",
    "start": "643839",
    "end": "651160"
  },
  {
    "text": "icmp ping between The Two Hosts we also do a TCP connection to the API server um",
    "start": "651160",
    "end": "657839"
  },
  {
    "text": "and also the cube VIP end point so I didn't mention that earlier but that's",
    "start": "657839",
    "end": "662880"
  },
  {
    "text": "we're using Cube VIP to load balance between the two control planes and then any traffic that's routed to the",
    "start": "662880",
    "end": "668240"
  },
  {
    "text": "follower in the standard configuration um will just actually via the kind configuration end up sending",
    "start": "668240",
    "end": "675120"
  },
  {
    "text": "any rights to the database on the leader um so we have this default period it's",
    "start": "675120",
    "end": "681839"
  },
  {
    "text": "configurable but every 30 seconds we run these checks and if enough of them fail we'll decide that we have to initiate",
    "start": "681839",
    "end": "687680"
  },
  {
    "text": "the promotion and and in that case",
    "start": "687680",
    "end": "693519"
  },
  {
    "text": "we stop all of these services this is initiated by the liveness agent and then",
    "start": "694800",
    "end": "700600"
  },
  {
    "text": "we do a little bit of magic um to swap the kind endpoint so basically we just",
    "start": "700600",
    "end": "707240"
  },
  {
    "text": "reconfigure kind instead of pointing to the leader we now point to postgress running on Local Host and then with a",
    "start": "707240",
    "end": "714200"
  },
  {
    "text": "little bit of SQL we massage things so that the uh database is the way we want",
    "start": "714200",
    "end": "720480"
  },
  {
    "text": "it when it boots up again so really this is a learning I had which is that uh streaming replication doesn't replicate",
    "start": "720480",
    "end": "726279"
  },
  {
    "text": "sequences the database is going to look okay but really it has holes in it and uh you know there's High valued IDs then",
    "start": "726279",
    "end": "733399"
  },
  {
    "text": "you turn on k3s and all of a sudden you're getting rows coming in underneath which are violating the constraint of",
    "start": "733399",
    "end": "739240"
  },
  {
    "text": "the kind table which is that you shouldn't have a previous revision higher than the current ID and anyway we",
    "start": "739240",
    "end": "744560"
  },
  {
    "text": "figure that out and um we also delete the uh kubernetes default Services",
    "start": "744560",
    "end": "750160"
  },
  {
    "text": "endpoints which forces k3s to drop the websocket tunnel to the impaired host that just makes k3s a little bit",
    "start": "750160",
    "end": "757120"
  },
  {
    "text": "happier so once we've massaged things to how we want we turn the services back on",
    "start": "757120",
    "end": "764079"
  },
  {
    "text": "and now we're in this single node operating state which is fine and there",
    "start": "764079",
    "end": "769160"
  },
  {
    "text": "might have been a small amount of data loss I just want to um clarify that so in terms of cap theorem I would say we",
    "start": "769160",
    "end": "776000"
  },
  {
    "text": "have like a AP with a big asterisk um or medium asterisk so we can survive",
    "start": "776000",
    "end": "782480"
  },
  {
    "text": "Network partitions um as I've Illustrated here if things go down the the leader just resumes but had there",
    "start": "782480",
    "end": "789600"
  },
  {
    "text": "have been a right that hit the the the leader at the moment that it went down then that would be lost um and in terms",
    "start": "789600",
    "end": "797000"
  },
  {
    "text": "of availability like we said our goal was to achieve High availability for the app for stateless app and there is no",
    "start": "797000",
    "end": "802600"
  },
  {
    "text": "downtime but during this reboot process that I explained it does take about 3 minutes",
    "start": "802600",
    "end": "809160"
  },
  {
    "text": "for kind to turn back on so during that time we basically lose API server right ability but at the edge that's maybe not",
    "start": "809160",
    "end": "816600"
  },
  {
    "text": "such a big concern because the application is running and that's what matters there's often not a lot of",
    "start": "816600",
    "end": "821839"
  },
  {
    "text": "changes hitting the API server at a remote Edge location so 3 minutes go by the services come back up and now we're",
    "start": "821839",
    "end": "828480"
  },
  {
    "text": "good to go again um so that's kind of the asterisk on the availability but at",
    "start": "828480",
    "end": "835240"
  },
  {
    "text": "that point we have a couple of options",
    "start": "835240",
    "end": "841040"
  },
  {
    "text": "maybe the power cord just got unplugged um in which case plug it back in the uh",
    "start": "841399",
    "end": "846560"
  },
  {
    "text": "original leader uh call it leader Prime turns back on and then we initiate",
    "start": "846560",
    "end": "852079"
  },
  {
    "text": "what's called a demotion um second option is maybe it's",
    "start": "852079",
    "end": "857480"
  },
  {
    "text": "you know irremediably damaged and in that case we're going to need to get a replacement host so we ship the failed",
    "start": "857480",
    "end": "865360"
  },
  {
    "text": "host off get another one um comes in the mail to the retail store or what have",
    "start": "865360",
    "end": "871639"
  },
  {
    "text": "you you just plug it back in make a few edits on our user interface which we'll hopefully show you here soon and then uh",
    "start": "871639",
    "end": "879480"
  },
  {
    "text": "we perform a host replacement but first let's consider what happens in the demotion scenario so",
    "start": "879480",
    "end": "888199"
  },
  {
    "text": "uh we have leader Prime and it just reboots so now we have uh this other",
    "start": "888199",
    "end": "894000"
  },
  {
    "text": "state machine called the kind endpoint reconciler and it's a one shot system D",
    "start": "894000",
    "end": "899800"
  },
  {
    "text": "unit that just monitors the configuration for K on boot so prior to letting K turn on it will reach out to",
    "start": "899800",
    "end": "906720"
  },
  {
    "text": "the livess agent on the other node and ask you know what's the current state of the world from your perspective and it's",
    "start": "906720",
    "end": "913480"
  },
  {
    "text": "going to respect the opinion of the other node over what it sees or if there's a difference essentially it'll",
    "start": "913480",
    "end": "919560"
  },
  {
    "text": "say okay well I think I'm the leader but your state is more fresh than mine and you think you're the leader so I must",
    "start": "919560",
    "end": "926000"
  },
  {
    "text": "not be the leader um in which case the kind reconfiguration will happen to",
    "start": "926000",
    "end": "931519"
  },
  {
    "text": "point to the new leader and then um the database gets dropped completely and",
    "start": "931519",
    "end": "938440"
  },
  {
    "text": "then we reconfigure the streaming replication um from zero so that way we",
    "start": "938440",
    "end": "944720"
  },
  {
    "text": "avoid any this is how we survive Network partitions as we do a complete recopy um when this machine",
    "start": "944720",
    "end": "951079"
  },
  {
    "text": "starts um and now it's our new follower AKA warm warm standby at least from the",
    "start": "951079",
    "end": "957680"
  },
  {
    "text": "database perspective so now you can see we've got logical",
    "start": "957680",
    "end": "963800"
  },
  {
    "text": "replication configured in the opposite direction and similarly kind and of",
    "start": "963800",
    "end": "970279"
  },
  {
    "text": "course the health checks will resume at this point and we're able to you know",
    "start": "970279",
    "end": "975480"
  },
  {
    "text": "flip-flop back and forth as needed so what if we aren't able to do that",
    "start": "975480",
    "end": "983759"
  },
  {
    "text": "because it's not as simple as just an unplugged machine in this case um",
    "start": "983759",
    "end": "989839"
  },
  {
    "text": "we just like I said get the new device in the mail plug it in it'll become available um in a pool of edge nodes on",
    "start": "989839",
    "end": "996160"
  },
  {
    "text": "our user interface this can also be done declaratively um not through user interface but essentially what will",
    "start": "996160",
    "end": "1001880"
  },
  {
    "text": "happen is this new follower will Boot and it has an updated version of what the cluster should look like and it will",
    "start": "1001880",
    "end": "1008000"
  },
  {
    "text": "basically announce that via um an API so there's two the two liveness agents are",
    "start": "1008000",
    "end": "1013399"
  },
  {
    "text": "also running liveness servers they can communicate that way and it will just say hey I'm your new follower forget",
    "start": "1013399",
    "end": "1018959"
  },
  {
    "text": "about your the follower you used to know about um and what that looks like is",
    "start": "1018959",
    "end": "1026240"
  },
  {
    "text": "pictured here it's simple you you know think we're familiar with the diagram at this point but uh we've got the",
    "start": "1026240",
    "end": "1033520"
  },
  {
    "text": "replacement host on the left and it just basically tells the leader that it's the",
    "start": "1033520",
    "end": "1039199"
  },
  {
    "text": "new person to communicate with it'll set up replication copy the database and we're good to",
    "start": "1039199",
    "end": "1046319"
  },
  {
    "text": "go what about upgrades so there are options we've chosen a",
    "start": "1047559",
    "end": "1054000"
  },
  {
    "text": "simple option that does involve a little bit of downtime but we basically disable the liveness checks in order to ensure",
    "start": "1054000",
    "end": "1060400"
  },
  {
    "text": "that we are able to upgrade both the hosts without any change in behavior of the state machine so we tell both of",
    "start": "1060400",
    "end": "1067559"
  },
  {
    "text": "them to just stop carrying and then we arbitrarily upgrade one and then upgrade the other",
    "start": "1067559",
    "end": "1074120"
  },
  {
    "text": "and there are other ways to do this you could you know it would require two",
    "start": "1074120",
    "end": "1079640"
  },
  {
    "text": "State changes per machine though and that's a lot of change basically which in involves risk so for now this is what",
    "start": "1079640",
    "end": "1085960"
  },
  {
    "text": "we've opted to do and uh like I said there's no promotions or demotions they retain their original roles but there is",
    "start": "1085960",
    "end": "1092720"
  },
  {
    "text": "some downtime for the API server when the leader gets rebooted um we use",
    "start": "1092720",
    "end": "1098600"
  },
  {
    "text": "system update controller to stream the new chyos image um or it can be loaded in with local content but essentially",
    "start": "1098600",
    "end": "1105559"
  },
  {
    "text": "there's a reboot involved during the upgrade and for the period of time it takes for the machine to boot then the",
    "start": "1105559",
    "end": "1110919"
  },
  {
    "text": "API server on the um leader can't accept rights but of course you can still read",
    "start": "1110919",
    "end": "1116360"
  },
  {
    "text": "on the follower and applications will be",
    "start": "1116360",
    "end": "1120200"
  },
  {
    "text": "up so logical replication is really just a form of change data capture and which",
    "start": "1123799",
    "end": "1129120"
  },
  {
    "text": "is a common pattern where something happens on one machine and you want to stream that near real time to another in",
    "start": "1129120",
    "end": "1135440"
  },
  {
    "text": "order to maintain consistent state or as close to as possible we initially worked",
    "start": "1135440",
    "end": "1140760"
  },
  {
    "text": "with a tool called Marmet but due to some issues with fips compatibility we ultimately landed on postgress Marmet",
    "start": "1140760",
    "end": "1147320"
  },
  {
    "text": "uses gats under the hood and really hoping that gats will be fips compliant here soon but that was a a small hiccup",
    "start": "1147320",
    "end": "1153640"
  },
  {
    "text": "ETD mirroring is another thing that we might consider in the future um postgress is logical replication is just",
    "start": "1153640",
    "end": "1159600"
  },
  {
    "text": "pretty battle tested so we went with that for now I already mentioned the sequences but uh that's just a good",
    "start": "1159600",
    "end": "1165840"
  },
  {
    "text": "thing to know you read you should read all the docs before you try anything um",
    "start": "1165840",
    "end": "1171400"
  },
  {
    "text": "and then zero Time Zero downtime upgrades maybe something for the future",
    "start": "1171400",
    "end": "1176760"
  },
  {
    "text": "and the big thing that that we need to look at is persistent storage with uh Longhorn is the most likely candidate",
    "start": "1176760",
    "end": "1182240"
  },
  {
    "text": "that'll allow us to have synchronous uh data replication but perhaps at the cost",
    "start": "1182240",
    "end": "1187440"
  },
  {
    "text": "of performance although it's not uh there's nothing about this architecture that would preclude State full workloads",
    "start": "1187440",
    "end": "1193799"
  },
  {
    "text": "it's just if they need high performance that might be a concern",
    "start": "1193799",
    "end": "1200640"
  },
  {
    "text": "is the yeah okay I'm back um yeah so we'll",
    "start": "1201240",
    "end": "1208080"
  },
  {
    "text": "we'll show you guys a little bit of a of a demo the plan was to show you we have",
    "start": "1208080",
    "end": "1215080"
  },
  {
    "text": "three Nooks not because we're doing three nodes because we're doing two nodes and the goal was to replace one um",
    "start": "1215080",
    "end": "1221960"
  },
  {
    "text": "the demo goes are not with us today at least in this room so what we're going to do is we do have a backup plan where",
    "start": "1221960",
    "end": "1228360"
  },
  {
    "text": "we can use our usdc uh so we have uh a",
    "start": "1228360",
    "end": "1234480"
  },
  {
    "text": "we have yeah the two node at the bottom so if Tyler goes to that two node so we",
    "start": "1234480",
    "end": "1239679"
  },
  {
    "text": "have a effect effectively is the same thing right but we have two node AJ",
    "start": "1239679",
    "end": "1245039"
  },
  {
    "text": "running in as two virtual machines instead of bare metal but the concept is obviously the same so if Tyler goes to",
    "start": "1245039",
    "end": "1250840"
  },
  {
    "text": "the nodes you'll be able to see that you'll have we have two nodes we have a leader we have a follower this is pallet",
    "start": "1250840",
    "end": "1257880"
  },
  {
    "text": "our spectr Cloud product where you're able to manage and orchestrate clusters at scale um in this in this scenario now",
    "start": "1257880",
    "end": "1266120"
  },
  {
    "text": "if Tyler vpns into into our usdc lab um",
    "start": "1266120",
    "end": "1272000"
  },
  {
    "text": "and we will be able to see so we have a highly available application which is Super Mario or game box which allows you",
    "start": "1272000",
    "end": "1279440"
  },
  {
    "text": "to play um the the the good games from back in the day highly pixelated games",
    "start": "1279440",
    "end": "1285440"
  },
  {
    "text": "um and what we're going to do is we're going to show you Mario running uh and then we're going to kill or pause stop",
    "start": "1285440",
    "end": "1291880"
  },
  {
    "text": "one of the VMS uh and then you we will see which one so basically we will pause",
    "start": "1291880",
    "end": "1297200"
  },
  {
    "text": "we will show you a promotion so we will pause the leader okay so that the follower has to take over and then you",
    "start": "1297200",
    "end": "1304120"
  },
  {
    "text": "will see uh most of what um you'll see most of what Tyler just",
    "start": "1304120",
    "end": "1310000"
  },
  {
    "text": "shown you in logs so on and so forth and Aline and k3s will have to restart so on",
    "start": "1310000",
    "end": "1317039"
  },
  {
    "text": "and so forth so we'll just have to go for a quick uh quick setup here and uh",
    "start": "1317039",
    "end": "1323480"
  },
  {
    "text": "and we'll show you we'll show you that for",
    "start": "1323480",
    "end": "1329760"
  },
  {
    "text": "now awesome so what what um what Tyler is now doing is basically he's grabbing",
    "start": "1332640",
    "end": "1338240"
  },
  {
    "text": "the liveness probe Lo uh logs which is the media the the screen in the middle",
    "start": "1338240",
    "end": "1343520"
  },
  {
    "text": "so that screen is going to show you when the liveness probes fail and uh as you heard earlier here so we have some",
    "start": "1343520",
    "end": "1349440"
  },
  {
    "text": "checks so and we're checking every so often and if it fails if sequentially",
    "start": "1349440",
    "end": "1355039"
  },
  {
    "text": "those checks fail obviously we're going to fail over so things like Network partitioning unplugging or even the",
    "start": "1355039",
    "end": "1361159"
  },
  {
    "text": "completely failure of the device so if we go there and if you click on the",
    "start": "1361159",
    "end": "1368120"
  },
  {
    "text": "8,000 Port as well so that so that's our application",
    "start": "1368120",
    "end": "1374799"
  },
  {
    "text": "so that's Mario as you can see and we happy to share this so if you guys want to play in your own time um but it's",
    "start": "1374799",
    "end": "1382520"
  },
  {
    "text": "pretty cool pretty cool application as you can see it's running he's I promise you he's doing it behind the computer uh",
    "start": "1382520",
    "end": "1389080"
  },
  {
    "text": "I think you can hear it even um but um but yeah so now what we're",
    "start": "1389080",
    "end": "1396039"
  },
  {
    "text": "going to do is we're going to cube config uh into the into into the cluster",
    "start": "1396039",
    "end": "1401520"
  },
  {
    "text": "as as Tyler said we're using Cube Vib so we we are load balancing between the API servers we'll be able to see um I can I",
    "start": "1401520",
    "end": "1409159"
  },
  {
    "text": "can kill it from here yeah I'll just check which IP it",
    "start": "1409159",
    "end": "1415039"
  },
  {
    "text": "is so uh while Tyler uh once Tyler is set up I'll be able",
    "start": "1415039",
    "end": "1422080"
  },
  {
    "text": "to I I will be able to yeah you have the yeah in the",
    "start": "1422080",
    "end": "1428440"
  },
  {
    "text": "node I'll be able to do",
    "start": "1428799",
    "end": "1432600"
  },
  {
    "text": "it so just finding the node right now so",
    "start": "1433880",
    "end": "1440520"
  },
  {
    "text": "hard refresh",
    "start": "1440520",
    "end": "1444919"
  },
  {
    "text": "here and we will",
    "start": "1451120",
    "end": "1454760"
  },
  {
    "text": "have can you show me the IP of the leader because my internet is having a good",
    "start": "1458440",
    "end": "1463720"
  },
  {
    "text": "time 107 awesome thank you",
    "start": "1463720",
    "end": "1470360"
  },
  {
    "text": "uh this one yeah okay so I'm just going to kill the leader right now so I'm just",
    "start": "1478279",
    "end": "1485360"
  },
  {
    "text": "going to power it off and uh we'll start to see some liveness probes failing as",
    "start": "1485360",
    "end": "1493960"
  },
  {
    "text": "well and and obviously the status is going to change to ready so Tyler if you want to go back to",
    "start": "1493960",
    "end": "1500440"
  },
  {
    "text": "the Super Mario the game is still playable and as",
    "start": "1500440",
    "end": "1507399"
  },
  {
    "text": "you can see some of the liveness is going is going",
    "start": "1507399",
    "end": "1512679"
  },
  {
    "text": "through and we will see yeah so we have a couple liveness checks that have failed here and as soon as another",
    "start": "1512679",
    "end": "1521559"
  },
  {
    "text": "iteration goes through we'll have sufficient failures to initiate uh promotion so we see we're below the",
    "start": "1521559",
    "end": "1527600"
  },
  {
    "text": "failure threshold hold of three here um and we're printing out which checks have",
    "start": "1527600",
    "end": "1532799"
  },
  {
    "text": "failed um just give it another 15 seconds or so and we'll start to see",
    "start": "1532799",
    "end": "1539159"
  },
  {
    "text": "some more stuff",
    "start": "1539159",
    "end": "1543039"
  },
  {
    "text": "happen Okay so the control plane endpoint is down and our Cube CTL get nodes failed which is expected it'll be",
    "start": "1545760",
    "end": "1554520"
  },
  {
    "text": "about 3 minutes before that comes back up and",
    "start": "1554520",
    "end": "1560240"
  },
  {
    "text": "we see there um this machine was the follower and it says initiating",
    "start": "1563480",
    "end": "1568799"
  },
  {
    "text": "promotion and because of the GP that I have we didn't see all the logs so one",
    "start": "1568799",
    "end": "1577960"
  },
  {
    "text": "second uh I believe what's happened is it has stopped it has killed K or will be killing K here soon",
    "start": "1580039",
    "end": "1590240"
  },
  {
    "text": "let's just see if the user interface is showing us that that EDG host is EDG host is down yet",
    "start": "1612520",
    "end": "1620240"
  },
  {
    "text": "next yeah we'll have to give it some",
    "start": "1629880",
    "end": "1633799"
  },
  {
    "text": "time so what we'll do is we'll give it some time and obviously we are always",
    "start": "1635760",
    "end": "1641559"
  },
  {
    "text": "constrained on that uh so we'll just finalize it we'll open for for questions",
    "start": "1641559",
    "end": "1647399"
  },
  {
    "text": "and then uh and then we'll come back as we have some questions we'll come back to",
    "start": "1647399",
    "end": "1654159"
  },
  {
    "text": "this so if you go back to the yeah so as you saw we did get to play some",
    "start": "1654159",
    "end": "1661080"
  },
  {
    "text": "Super Mario um and like I said we're more than happy to to share this with with you",
    "start": "1661080",
    "end": "1667799"
  },
  {
    "text": "guys the idea here is that we are building this architecture so that at",
    "start": "1667799",
    "end": "1673320"
  },
  {
    "text": "scale as you deploy your kubernetes clusters um on different across different Industries right so like I",
    "start": "1673320",
    "end": "1678720"
  },
  {
    "text": "mentioned you are your petrol stations your retail stores your coffee shops um",
    "start": "1678720",
    "end": "1683880"
  },
  {
    "text": "and you starting to push all these highly available kubernetes clusters things start to add up right",
    "start": "1683880",
    "end": "1691200"
  },
  {
    "text": "and uh and then if you want to make your CFO happy then having the ability to have all of these highly available",
    "start": "1691200",
    "end": "1698080"
  },
  {
    "text": "capabilities with a 33% reduction in price in Hardware alone will actually be",
    "start": "1698080",
    "end": "1705799"
  },
  {
    "text": "a reason to put a smile on his face right right and when we're talking about thousands of devices tens of thousands",
    "start": "1705799",
    "end": "1713200"
  },
  {
    "text": "of devices most likely which is the kind of skill that we tend to deal with our customers then we're looking at hundreds",
    "start": "1713200",
    "end": "1720399"
  },
  {
    "text": "of thousands of euros dollars pounds in Savings in Hardware alone and then we",
    "start": "1720399",
    "end": "1726320"
  },
  {
    "text": "have to account for cabling Engineers on SES so on and so forth and as of today",
    "start": "1726320",
    "end": "1732080"
  },
  {
    "text": "the other very important part to talk about is obviously sustainability as well so if you're shipping out less",
    "start": "1732080",
    "end": "1737720"
  },
  {
    "text": "devices you you reducing your footprint as well because obviously less size uh",
    "start": "1737720",
    "end": "1743640"
  },
  {
    "text": "less power drawn so on and so forth so back to the dynamic duo of two highly",
    "start": "1743640",
    "end": "1750399"
  },
  {
    "text": "available nodes it's not me and Tyler it's the two nodes uh although I would",
    "start": "1750399",
    "end": "1755799"
  },
  {
    "text": "be Batman it can be Robin and um so yeah so what are the",
    "start": "1755799",
    "end": "1762080"
  },
  {
    "text": "next steps the where do we go from here so effectively as St said so this is a",
    "start": "1762080",
    "end": "1769120"
  },
  {
    "text": "project that we're running in our in our uh Advanced project team right which is",
    "start": "1769120",
    "end": "1774679"
  },
  {
    "text": "run by our CEO and led by uh led by Tyler and uh we effectively have a tech",
    "start": "1774679",
    "end": "1781480"
  },
  {
    "text": "preview an exclusive Tech preview that we're announcing on this in this talk and we have about five places left we",
    "start": "1781480",
    "end": "1788720"
  },
  {
    "text": "have three customers running today this Tech preview with us so if you guys would like to join we have five places",
    "start": "1788720",
    "end": "1795200"
  },
  {
    "text": "left so please come and talk to us we also have uh we also have another talk which is",
    "start": "1795200",
    "end": "1801640"
  },
  {
    "text": "going to be with uh One customer of ours Den ple and they are rolling out 3,000 Edge devices this year for uh",
    "start": "1801640",
    "end": "1809320"
  },
  {
    "text": "dentists um and that's going to be in 255 and so4 and you know come talk to us",
    "start": "1809320",
    "end": "1815519"
  },
  {
    "text": "U let's schedule a meeting we can go deeper and go take a deep dive onto this play some Mario or Aladdin or Doom",
    "start": "1815519",
    "end": "1823840"
  },
  {
    "text": "whatever you you choose and please give us give us some feedback so if you guys have some questions we'll be more than",
    "start": "1823840",
    "end": "1830679"
  },
  {
    "text": "happy to hear yes we have questions thank you",
    "start": "1830679",
    "end": "1838559"
  },
  {
    "text": "guys thanks for for great talk uh do you do you implement any split brain mitigations like stone or something like",
    "start": "1841200",
    "end": "1850000"
  },
  {
    "text": "that yeah so with a split brain scenario we would resolve that by it would have",
    "start": "1850000",
    "end": "1856480"
  },
  {
    "text": "to require a sele of which node you you want to be the winner basically which",
    "start": "1856480",
    "end": "1863200"
  },
  {
    "text": "like I said before there's the opportunity for a little bit of loss of of state if some rights hit the leader",
    "start": "1863200",
    "end": "1869279"
  },
  {
    "text": "and then it failed and they didn't replicate to the follower but let's just say they're both um unable to",
    "start": "1869279",
    "end": "1874799"
  },
  {
    "text": "communicate like you mean with a network partition most likely yeah okay so they're both the follower would promote",
    "start": "1874799",
    "end": "1880039"
  },
  {
    "text": "you'd have two leaders and you would have inconsistency now you just need to",
    "start": "1880039",
    "end": "1886600"
  },
  {
    "text": "decide which one you want to win and all you would do is reboot the machine like",
    "start": "1886600",
    "end": "1893480"
  },
  {
    "text": "assuming you have restored the connectivity you just reboot the one that you don't want to be the leader it",
    "start": "1893480",
    "end": "1898880"
  },
  {
    "text": "will um get demoted so it'll drop its database the replication will copy the",
    "start": "1898880",
    "end": "1905360"
  },
  {
    "text": "content of the leader you selected and then you'll be back in in action",
    "start": "1905360",
    "end": "1913360"
  },
  {
    "text": "so sorry can we have the microphone very",
    "start": "1915000",
    "end": "1920200"
  },
  {
    "text": "quickly uh for him I mean they are going to compete",
    "start": "1923279",
    "end": "1930919"
  },
  {
    "text": "yeah because uh if you have two notes that think that they are uh primary then",
    "start": "1930919",
    "end": "1936919"
  },
  {
    "text": "they are going to compete and how they are going to resolve who's going to win like that's why I was asking about",
    "start": "1936919",
    "end": "1943360"
  },
  {
    "text": "stonic like should the other note in the head if you have that kind of approach or",
    "start": "1943360",
    "end": "1948519"
  },
  {
    "text": "uh how how this is going to resolve you said something was solid",
    "start": "1948519",
    "end": "1955279"
  },
  {
    "text": "sorry I didn't stun like like this was a um solution back then when there was a",
    "start": "1955279",
    "end": "1962080"
  },
  {
    "text": "uh uh redundancy for routers when you have this similar approach you have like",
    "start": "1962080",
    "end": "1969320"
  },
  {
    "text": "two competing nodes and when uh like there was a kind of a uh comp",
    "start": "1969320",
    "end": "1976159"
  },
  {
    "text": "competition uh one tried to kill the other and the one that wins that the",
    "start": "1976159",
    "end": "1981320"
  },
  {
    "text": "wins and we have a winner uh but okay I get that uh this is kind of a not right",
    "start": "1981320",
    "end": "1988679"
  },
  {
    "text": "now implemented yeah well I mean they couldn't communicate so how would one kill the other but they both have a",
    "start": "1988679",
    "end": "1993919"
  },
  {
    "text": "state file which represents their understanding of the state of the world and assuming that the network barrier is",
    "start": "1993919",
    "end": "2000799"
  },
  {
    "text": "removed one of them would have a newer time stamp and that one would win automatically that's that's the deal",
    "start": "2000799",
    "end": "2005840"
  },
  {
    "text": "breaker it's it's just that simple they would communicate ask for each other's view of things",
    "start": "2005840",
    "end": "2011559"
  },
  {
    "text": "and yeah uh whichever one loses that it yeah that is the the tie break it's just",
    "start": "2011559",
    "end": "2017120"
  },
  {
    "text": "time stamp yeah and we can go deeper so after all just want to give other people",
    "start": "2017120",
    "end": "2022880"
  },
  {
    "text": "the opportunity to ask questions but we can go deeper into that so if there's other questions yeah there's one",
    "start": "2022880",
    "end": "2029840"
  },
  {
    "text": "there we're making you walk [Music]",
    "start": "2029840",
    "end": "2035059"
  },
  {
    "text": "sorry",
    "start": "2036720",
    "end": "2039720"
  },
  {
    "text": "uh why not buy the cheapest Raspberry Pi and build three members with gcd and",
    "start": "2042639",
    "end": "2049280"
  },
  {
    "text": "don't have all the MTH sorry what was the question why not",
    "start": "2049280",
    "end": "2055320"
  },
  {
    "text": "use raspberry pies and have three of them so yeah that's a very good question actually um so the problem is raspberry",
    "start": "2055320",
    "end": "2061240"
  },
  {
    "text": "pies are not Enterprise grade so when we when we're looking at having Enterprise grade Solutions most of most of our",
    "start": "2061240",
    "end": "2068280"
  },
  {
    "text": "Enterprise customers do not want to use raspberry pies they want to use something more ruggedized that they're",
    "start": "2068280",
    "end": "2073440"
  },
  {
    "text": "familiar with so Intel Dell Lenovo all of those thin clients it's what they",
    "start": "2073440",
    "end": "2079200"
  },
  {
    "text": "more com more comfortable with we can use raspberry pies that's fine and like like we said earlier uh we do support",
    "start": "2079200",
    "end": "2086000"
  },
  {
    "text": "chyos which is an open source project as well uh that we that we maintain and we",
    "start": "2086000",
    "end": "2092200"
  },
  {
    "text": "have Maro here doing a talk later uh and kyos does support raspberry pies as well so we could use raspberry pies and and",
    "start": "2092200",
    "end": "2099440"
  },
  {
    "text": "to your point if that's what you want to do and you want to use that CD and use three raspberry pies by all means you",
    "start": "2099440",
    "end": "2105480"
  },
  {
    "text": "can do that right we're just giving you an alternative that if you want to reduce costs and still use an Enterprise",
    "start": "2105480",
    "end": "2111320"
  },
  {
    "text": "great solution with Lenovo Intel Nooks sometimes quite expensive especially",
    "start": "2111320",
    "end": "2116800"
  },
  {
    "text": "when you start adding gpus onto these things we're talking about 10,000 uh 10,000 a box or $500 to $1,000 a box",
    "start": "2116800",
    "end": "2124920"
  },
  {
    "text": "then it starts to becoming starts to add up so that's that's the reason and it's not just Hardware there's cabling and other considerations that I",
    "start": "2124920",
    "end": "2132079"
  },
  {
    "text": "mean might sound like nothing for a couple cables but multiply that by 10,000 and you are saving cost in places",
    "start": "2132079",
    "end": "2139720"
  },
  {
    "text": "other than the hardware yeah and also you get rid of etcd right",
    "start": "2139720",
    "end": "2145800"
  },
  {
    "text": "so you don't have to do ETD restores maybe post grass but you know pick a",
    "start": "2145800",
    "end": "2151599"
  },
  {
    "text": "poison is there any other questions",
    "start": "2151599",
    "end": "2156640"
  },
  {
    "text": "yeah sorry over",
    "start": "2156640",
    "end": "2162359"
  },
  {
    "text": "there and thank you so much for the questions we love the engagement by the",
    "start": "2167800",
    "end": "2173200"
  },
  {
    "text": "way hi how you do you bootstrap after a power failure full power failure of both",
    "start": "2173200",
    "end": "2179839"
  },
  {
    "text": "notes very good question so the way it works is with with our solution we we do",
    "start": "2179839",
    "end": "2185720"
  },
  {
    "text": "ISO bootstrapping so what happens is actually in this Nooks that we have here I have actually a bunch of USB sticks so",
    "start": "2185720",
    "end": "2192680"
  },
  {
    "text": "uh for the for the for the talks and the demos that we're doing so you bootstrap with an ISO you bootstrap the Nook with",
    "start": "2192680",
    "end": "2199359"
  },
  {
    "text": "an ISO and that will have uh all it needs to talk back to pilet so there's no inbound connectivity it's all",
    "start": "2199359",
    "end": "2205800"
  },
  {
    "text": "outbound so you bootstrap uh the Nook Dell whatever it might be with an ISO",
    "start": "2205800",
    "end": "2210920"
  },
  {
    "text": "that ISO basically has the initial operating system that it needs to communicate with pallet it it might also",
    "start": "2210920",
    "end": "2218079"
  },
  {
    "text": "have all the local content required like for example all the different dependencies as well so it doesn't have",
    "start": "2218079",
    "end": "2223200"
  },
  {
    "text": "to pull anything from the internet like the operating system once actually it's registered in Pallet you'll be able to",
    "start": "2223200",
    "end": "2229440"
  },
  {
    "text": "then swap if it's a running cluster you can swap in the note pool and uh if you're creating a cluster you just add",
    "start": "2229440",
    "end": "2235560"
  },
  {
    "text": "that node which is registered onto the cluster and then pallet will bootstrap kubernetes on top of it so answering",
    "start": "2235560",
    "end": "2243480"
  },
  {
    "text": "your question very simply with a with an ISO USB stick yeah and it's headless and zero touch",
    "start": "2243480",
    "end": "2250839"
  },
  {
    "text": "provisioning so we you don't you actually can ship these boxes onto your retail stores factories whatever it",
    "start": "2250839",
    "end": "2258680"
  },
  {
    "text": "might be plug them in put the power cable in or the wireless and then they will once they reach out and talk to",
    "start": "2258680",
    "end": "2264640"
  },
  {
    "text": "pallets it's zero touch provisioning you deploy the cluster it builds and life is good",
    "start": "2264640",
    "end": "2272280"
  }
]