[
  {
    "text": "hello hello and welcome to the CNI deep dive session my name is brian Boram",
    "start": "60",
    "end": "7950"
  },
  {
    "text": "worked for a company called weave works and I am a CNI maintainer amongst other",
    "start": "7950",
    "end": "13679"
  },
  {
    "text": "things and I'm Dan Williams and I worked for red and also CNI maintainer so let's",
    "start": "13679",
    "end": "21750"
  },
  {
    "text": "just find out who's in the room who came to the intro session yesterday ah okay thank you who is a current",
    "start": "21750",
    "end": "32700"
  },
  {
    "text": "maintainer of a CNI plugin welcome who",
    "start": "32700",
    "end": "41850"
  },
  {
    "text": "knows very little about CNI oh thanks",
    "start": "41850",
    "end": "46980"
  },
  {
    "text": "for coming yes seriously okay well I wondered about that so we we",
    "start": "46980",
    "end": "53789"
  },
  {
    "text": "have some recap of the basics so those of you who've been through this before",
    "start": "53789",
    "end": "61949"
  },
  {
    "text": "bear with us a couple of minutes we'll go we'll get through that we got some",
    "start": "61949",
    "end": "67110"
  },
  {
    "text": "stories to tell you about the kind of deeper aspects of the project and technical details of what's being going",
    "start": "67110",
    "end": "73350"
  },
  {
    "text": "on and life and times and also talking",
    "start": "73350",
    "end": "78720"
  },
  {
    "text": "about the future of the project so let's",
    "start": "78720",
    "end": "84979"
  },
  {
    "text": "begin the recap so the the CNI project",
    "start": "84979",
    "end": "90930"
  },
  {
    "text": "has has two major parts to it one is a specification and that's that's a",
    "start": "90930",
    "end": "98159"
  },
  {
    "text": "document written in English or as close as we could manage and the in the same",
    "start": "98159",
    "end": "109710"
  },
  {
    "text": "repo is that is a is a library Lib C and I that's that's a go library that's used by things that call C and is and we call",
    "start": "109710",
    "end": "117149"
  },
  {
    "text": "them runtimes so the one many of you will know as kubernetes but CNI is is cross-platform",
    "start": "117149",
    "end": "125009"
  },
  {
    "text": "so it's used by what can be used by me sauce it's used by cloud foundry",
    "start": "125009",
    "end": "131160"
  },
  {
    "text": "it's used by pod man there's a bunch of alternate runtimes",
    "start": "131160",
    "end": "137320"
  },
  {
    "text": "that can call into CNI and we do stress that in the the cross project cross-platform nature CNI is a CNC F",
    "start": "137320",
    "end": "146830"
  },
  {
    "text": "project kubernetes is the CNCs project but that's you know we're all friends",
    "start": "146830",
    "end": "152560"
  },
  {
    "text": "but they're not the same thing one is not part of the other yeah so a couple",
    "start": "152560",
    "end": "159370"
  },
  {
    "text": "of tools so that's it that's on github it's all under the container networking organization the CNI repo has the spec",
    "start": "159370",
    "end": "165640"
  },
  {
    "text": "and the library the so-called base plugins that word means horrible and",
    "start": "165640",
    "end": "174850"
  },
  {
    "text": "reference nasties yeah sometimes we call them reference plugins so basically some",
    "start": "174850",
    "end": "183190"
  },
  {
    "text": "some plugins that are nowadays on both Linux and Windows that you can use just",
    "start": "183190",
    "end": "190930"
  },
  {
    "text": "without any extra you know parts without",
    "start": "190930",
    "end": "196750"
  },
  {
    "text": "installing servers and things like that just using Linux facilities to fire up",
    "start": "196750",
    "end": "202269"
  },
  {
    "text": "Network bits and pieces and and there's a reference they sort of serve as best",
    "start": "202269",
    "end": "208540"
  },
  {
    "text": "practices especially as we as we evolve the system the the reference or base",
    "start": "208540",
    "end": "214300"
  },
  {
    "text": "plugins act as a guide to how to use the new features who we are so I'm on there",
    "start": "214300",
    "end": "224890"
  },
  {
    "text": "Dan's on there these are the maintainer these are the people who show up regularly who have commit rights to the",
    "start": "224890",
    "end": "232540"
  },
  {
    "text": "repo but we do get lots of contributions and I'm sure there's lots people in the",
    "start": "232540",
    "end": "238090"
  },
  {
    "text": "room have made contributions to the lib CNI or to the spec or to to the",
    "start": "238090",
    "end": "243670"
  },
  {
    "text": "reference plugins and then there's this dozens more plugins outside of the CNI",
    "start": "243670",
    "end": "249430"
  },
  {
    "text": "project those are all CNI plugins and we love them we host references to a lot of",
    "start": "249430",
    "end": "255519"
  },
  {
    "text": "them but that's that's you know one of our aims is to make it possible for everyone to be on the same playing field",
    "start": "255519",
    "end": "261370"
  },
  {
    "text": "and everyone who's got a network implementation can't",
    "start": "261370",
    "end": "267070"
  },
  {
    "text": "that into a container runtime via C&I that's what it's for",
    "start": "267070",
    "end": "273240"
  },
  {
    "text": "a little bit about how we work the spec is quite slow in evolving intentionally",
    "start": "273760",
    "end": "282550"
  },
  {
    "text": "so yeah yeah oh yeah because we have to be very careful and really agonize over things that might break someone we are",
    "start": "282550",
    "end": "291040"
  },
  {
    "text": "at zero point I forget four or four on the spec this confuses people actually",
    "start": "291040",
    "end": "297790"
  },
  {
    "text": "the the spec and the plugins are at different versions sorry one of them",
    "start": "297790",
    "end": "306370"
  },
  {
    "text": "evolves slower than the other I mean well in one point under plugins is we need to rev the plugins more quickly",
    "start": "306370",
    "end": "312880"
  },
  {
    "text": "because you know people find bugs and plugins and you know bugs in the other libraries and stuff like that and so we",
    "start": "312880",
    "end": "319630"
  },
  {
    "text": "want to get those fixes out to people more quickly than the spec of balls because like Brian said the spec needs to move a little bit more slowly because",
    "start": "319630",
    "end": "325870"
  },
  {
    "text": "we need to be very careful about what gets added to the spec in the language there but we don't want to block point",
    "start": "325870",
    "end": "330970"
  },
  {
    "text": "releases of the plugins you know just to fix a bug with something and so we did",
    "start": "330970",
    "end": "336190"
  },
  {
    "text": "split those two apart and create different kind of streams for the plugins and the spec about maybe a year year and a half ago basically in",
    "start": "336190",
    "end": "343360"
  },
  {
    "text": "response to user requests for more quick updates of the plugins and not quite so much the spec and we're gonna get into",
    "start": "343360",
    "end": "352360"
  },
  {
    "text": "what 1.0 later later on in the deep dive",
    "start": "352360",
    "end": "359160"
  },
  {
    "text": "so for those of you prefer pictures to words this is where it fits you have a",
    "start": "359160",
    "end": "367360"
  },
  {
    "text": "you have a runtime on the left so maybe that's kubernetes maybe not you have a",
    "start": "367360",
    "end": "372880"
  },
  {
    "text": "container or in kubernetes case a pod on the right and you have a network at the",
    "start": "372880",
    "end": "378490"
  },
  {
    "text": "bottom so this this could be something that someone is set up that this could",
    "start": "378490",
    "end": "384610"
  },
  {
    "text": "be calico network or weave network or you know shifts network or something",
    "start": "384610",
    "end": "392320"
  },
  {
    "text": "from from Cisco or juniper network so you know there's a a network out there",
    "start": "392320",
    "end": "398770"
  },
  {
    "text": "we want to connect to our container and conceptually the the plugin is just",
    "start": "398770",
    "end": "405789"
  },
  {
    "text": "doing the glue in the middle I was talking to someone after the last talk and I realized maybe I didn't explain",
    "start": "405789",
    "end": "412210"
  },
  {
    "text": "this very well so so in the case of my own plugin we've net when when when",
    "start": "412210",
    "end": "419409"
  },
  {
    "text": "kubernetes calls the plugin it basically makes one rest call because we're",
    "start": "419409",
    "end": "424599"
  },
  {
    "text": "running a daemon an exit you know the plug-in itself does nothing it's talking to an implementation of a",
    "start": "424599",
    "end": "430599"
  },
  {
    "text": "network that's somewhere some of the reference plugins do their work entirely",
    "start": "430599",
    "end": "438639"
  },
  {
    "text": "because there's something already on the operating system like the bridge plug-in for instance uses a Linux bridge which",
    "start": "438639",
    "end": "445300"
  },
  {
    "text": "is in the kernel so so both of those things are CNI plugins and and I",
    "start": "445300",
    "end": "451630"
  },
  {
    "text": "recognize that might be confusing to think about but basically what needs to happen is is the runtime makes a call",
    "start": "451630",
    "end": "458319"
  },
  {
    "text": "which is very simple just add to make a make a network connection or dowel to take one away it's configured by a JSON",
    "start": "458319",
    "end": "466120"
  },
  {
    "text": "file or you know some Jason whether it's in a file or not is that me okay",
    "start": "466120",
    "end": "473909"
  },
  {
    "text": "the Jason is the configuration of what's going to happen on the network and the",
    "start": "473909",
    "end": "481210"
  },
  {
    "text": "plug-in makes it happen the plug-in makes an interface appear in the container so whatever needs to happen we",
    "start": "481210",
    "end": "488740"
  },
  {
    "text": "don't care because we're we're just making it possible for everyone else to play on the same playing field okay I",
    "start": "488740",
    "end": "499139"
  },
  {
    "text": "I'm gonna tell you a story now about a",
    "start": "499139",
    "end": "505029"
  },
  {
    "text": "CV you know of ulnar ability the I just",
    "start": "505029",
    "end": "512709"
  },
  {
    "text": "thought that so that's the recap over I I thought it'd be interesting to get into some of the life of the project and",
    "start": "512709",
    "end": "519419"
  },
  {
    "text": "understand some of how it works yeah so",
    "start": "519419",
    "end": "525610"
  },
  {
    "text": "the the story really concerns the port",
    "start": "525610",
    "end": "531550"
  },
  {
    "text": "map plugin which is which is one of the reference plugins and what what does the port MAP",
    "start": "531550",
    "end": "541750"
  },
  {
    "text": "plugin do so it is for in docker terms the - PFLAG in kubernetes terms a host",
    "start": "541750",
    "end": "549310"
  },
  {
    "text": "port so it's mapping a port from inside a container out to the host I get it",
    "start": "549310",
    "end": "556149"
  },
  {
    "text": "right okay and it works by iptables",
    "start": "556149",
    "end": "563680"
  },
  {
    "text": "rules what what doesn't and so the",
    "start": "563680",
    "end": "570399"
  },
  {
    "text": "mistake was that it inserted its IP tables rules and this works great you",
    "start": "570399",
    "end": "577420"
  },
  {
    "text": "know and all the tests that we did there was a problem though that they would go",
    "start": "577420",
    "end": "582820"
  },
  {
    "text": "ahead of rules that someone else had on their machine and in particular that could be a blocking rule such as a",
    "start": "582820",
    "end": "591730"
  },
  {
    "text": "firewall rule so just kind of depended on the order in which things were set up",
    "start": "591730",
    "end": "597430"
  },
  {
    "text": "and ended on whether you had a port map or not and so on but eventually someone",
    "start": "597430",
    "end": "602980"
  },
  {
    "text": "realized this is vulnerability the the kind of the the interesting part was",
    "start": "602980",
    "end": "610060"
  },
  {
    "text": "that oh you know how this how I became aware of this it was essentially people",
    "start": "610060",
    "end": "615070"
  },
  {
    "text": "people screaming at us on github saying",
    "start": "615070",
    "end": "620440"
  },
  {
    "text": "when are you gonna fix this issue and so we'd go like okay well I personally",
    "start": "620440",
    "end": "625510"
  },
  {
    "text": "would go okay tell tell me more about the issue they go I can't it's embargoed",
    "start": "625510",
    "end": "630990"
  },
  {
    "text": "so what we realized was is it's a it's a public project right we work in public we work on github the security committee",
    "start": "630990",
    "end": "640329"
  },
  {
    "text": "of kubernetes who were the people screaming at us were you know I tightly",
    "start": "640329",
    "end": "647560"
  },
  {
    "text": "tightly knit group they're keeping the information under wraps until they had a fix so they weren't going to publish",
    "start": "647560",
    "end": "654519"
  },
  {
    "text": "that on github and you know we sorted it out in a day or so the the fix was really easy just don't insert a pen",
    "start": "654519",
    "end": "662070"
  },
  {
    "text": "the rule but yeah we learned we learned",
    "start": "662070",
    "end": "667260"
  },
  {
    "text": "a number of lessons that that that week CNI is a very critical tiny but critical",
    "start": "667260",
    "end": "675060"
  },
  {
    "text": "part of the infrastructure we didn't have the communications channels we",
    "start": "675060",
    "end": "680340"
  },
  {
    "text": "didn't we didn't have a way to make a private build of CNI so the fix itself could be kept under wraps and while",
    "start": "680340",
    "end": "689400"
  },
  {
    "text": "there was more fun and games in actually getting it kind of vendored into kubernetes but that's that's really down",
    "start": "689400",
    "end": "695580"
  },
  {
    "text": "in the weeds ask a question if you want to hear about that but yeah the kind of",
    "start": "695580",
    "end": "701310"
  },
  {
    "text": "the kind of life life of the project this is touchwood we've only had the one",
    "start": "701310",
    "end": "707310"
  },
  {
    "text": "CVE that I can tell you tell us about but it was kind of an exciting week with",
    "start": "707310",
    "end": "713300"
  },
  {
    "text": "we actually learn well we're you know - we need we need the communications",
    "start": "713300",
    "end": "719670"
  },
  {
    "text": "channels and and also problem you know people are signed to react to these",
    "start": "719670",
    "end": "725340"
  },
  {
    "text": "things and yeah and the infrastructure",
    "start": "725340",
    "end": "731400"
  },
  {
    "text": "to be able to do private builds and things like that until vulnerability is",
    "start": "731400",
    "end": "736650"
  },
  {
    "text": "disclosed yeah well that's a work in progress I guess",
    "start": "736650",
    "end": "741740"
  },
  {
    "text": "yeah the yes although all the kind of big names that you see up on the keynote",
    "start": "744200",
    "end": "749670"
  },
  {
    "text": "stage they're all screaming at me personally and that was I was excited",
    "start": "749670",
    "end": "756660"
  },
  {
    "text": "okay I'm gonna hand over to Dan for the next story yeah so there are in the CNI",
    "start": "756660",
    "end": "763530"
  },
  {
    "text": "spec 0-4 there are a couple of interesting changes and one of the big ones is check the check verb is another",
    "start": "763530",
    "end": "771870"
  },
  {
    "text": "verb along with add and del inversion and these four things together form the",
    "start": "771870",
    "end": "777060"
  },
  {
    "text": "basis of CNI operations and these are things that run times like kubernetes or",
    "start": "777060",
    "end": "782160"
  },
  {
    "text": "pod man or cryo would call to set up containers delete containers and check",
    "start": "782160",
    "end": "789210"
  },
  {
    "text": "check is is your container healthy and it's kind of a",
    "start": "789210",
    "end": "795450"
  },
  {
    "text": "yeah it is the network of your container healthy it's something that we know we'd",
    "start": "795450",
    "end": "802590"
  },
  {
    "text": "seen for a long time as a need in the cni project we went through a number of iterations of it and I think it took",
    "start": "802590",
    "end": "808290"
  },
  {
    "text": "maybe six nine months maybe even a year to figure out exactly what the right pattern there was for the check command",
    "start": "808290",
    "end": "815030"
  },
  {
    "text": "so you know based on that let's just kind of go through it and talk a little bit more about it basically what happens",
    "start": "815030",
    "end": "824520"
  },
  {
    "text": "when kubernetes or docker or something like that restarts in your container is",
    "start": "824520",
    "end": "829680"
  },
  {
    "text": "running well dr. shim currently assumes",
    "start": "829680",
    "end": "834810"
  },
  {
    "text": "that the networking is up if the pot has an IP on the primary interface of the",
    "start": "834810",
    "end": "840000"
  },
  {
    "text": "pod but after that it basically kind of forgets about it and even if it doesn't",
    "start": "840000",
    "end": "846150"
  },
  {
    "text": "really have that IP it assumes that things are more or less okay so there's kind of a disconnect here between what",
    "start": "846150",
    "end": "852000"
  },
  {
    "text": "is the actual state of your container and what does the runtime expect that",
    "start": "852000",
    "end": "857700"
  },
  {
    "text": "state to be and if something changes does the runtime react intelligently to that",
    "start": "857700",
    "end": "863000"
  },
  {
    "text": "we thought that CNI could help here and so we created the check command and the",
    "start": "863000",
    "end": "869490"
  },
  {
    "text": "check command is essentially hey si and",
    "start": "869490",
    "end": "877410"
  },
  {
    "text": "I plug in I asked you to set up pod well is that pod still healthy is the network of that pod still healthy do you think",
    "start": "877410",
    "end": "884220"
  },
  {
    "text": "it is there were a couple of complications with that and that's why I kind of took us you know maybe almost a",
    "start": "884220",
    "end": "890880"
  },
  {
    "text": "year to really get right and pushed through because correct means something very different to a lot of different",
    "start": "890880",
    "end": "897270"
  },
  {
    "text": "network plugins it's things like is the IP address of the container the same as",
    "start": "897270",
    "end": "904200"
  },
  {
    "text": "was originally assigned to that container what if some plug-in later on decided that it wanted some details of",
    "start": "904200",
    "end": "911700"
  },
  {
    "text": "the pod and the plug-in that is doing the checking right now isn't aware of",
    "start": "911700",
    "end": "918450"
  },
  {
    "text": "those details and that was one of the things that was kind of complicated because if you're not aware in CNI we",
    "start": "918450",
    "end": "923730"
  },
  {
    "text": "have a concept of chained plugins the configuration",
    "start": "923730",
    "end": "928740"
  },
  {
    "text": "you give to the runtime to say these are the operations or these are the plugins that you need to call as a runtime as",
    "start": "928740",
    "end": "935550"
  },
  {
    "text": "kubernetes cryo mais au s-- whatever to set up the pod network it can be a list",
    "start": "935550",
    "end": "940620"
  },
  {
    "text": "of plugins and that list of plugins is you know first you usually have",
    "start": "940620",
    "end": "946680"
  },
  {
    "text": "something like the bridge plugin and then you might have an eye Pam plug-in in there to do the actual IP allocation",
    "start": "946680",
    "end": "952220"
  },
  {
    "text": "assignment then you might have something like a firewall plug-in to poke rules through the firewall you might also have",
    "start": "952220",
    "end": "957720"
  },
  {
    "text": "a tuning plug-in or a bandwidth plug-in to set up bandwidth limitations on the container well all of these different",
    "start": "957720",
    "end": "964350"
  },
  {
    "text": "plugins can interact in different ways and that was one of the big things that we kind of had to discuss and figure out",
    "start": "964350",
    "end": "970470"
  },
  {
    "text": "how to get exactly right is you know all these things do operations to the container and they can change how the",
    "start": "970470",
    "end": "977160"
  },
  {
    "text": "containers networking looks and so you know during the check operation you need to make sure you account for that",
    "start": "977160",
    "end": "984980"
  },
  {
    "text": "so the spec language says and this is pretty sure we copied this directly from the spec that the plug-in should return",
    "start": "985880",
    "end": "992940"
  },
  {
    "text": "an error if a resource included in the cni results type which are things like",
    "start": "992940",
    "end": "998399"
  },
  {
    "text": "interfaces addresses routes you know MAC addresses of the plug-in other things if",
    "start": "998399",
    "end": "1005839"
  },
  {
    "text": "that if a resource including the result that was created by this plug-in and is listed in the result that is given to",
    "start": "1005839",
    "end": "1013370"
  },
  {
    "text": "the plug-in as part of the check operation is missing or an invalid state now what exactly does that mean it's",
    "start": "1013370",
    "end": "1021140"
  },
  {
    "text": "probably worthwhile to back up a little bit and talk about how you know what proof result is and how the check",
    "start": "1021140",
    "end": "1026839"
  },
  {
    "text": "operation works so when the runtime calls the check operation the spec requires that it passes to the plug-in",
    "start": "1026839",
    "end": "1033980"
  },
  {
    "text": "the actual object that the add call returned to the runtime so first the",
    "start": "1033980",
    "end": "1040880"
  },
  {
    "text": "runtime calls add and says set up this container and all the plugins in the chain do their thing and they return one",
    "start": "1040880",
    "end": "1048290"
  },
  {
    "text": "JSON structure to the runtime that describes things like the IP address the container has DNS results routes that",
    "start": "1048290",
    "end": "1056030"
  },
  {
    "text": "might that the container has MAC address a number of different things something",
    "start": "1056030",
    "end": "1061370"
  },
  {
    "text": "needs to cache that result so that it can feed that back into subsequent calls and those",
    "start": "1061370",
    "end": "1068160"
  },
  {
    "text": "subsequent calls the two most important ones are check and delete in the case of check that pre result describes the",
    "start": "1068160",
    "end": "1075150"
  },
  {
    "text": "final results of the network operation on that container and that is what the",
    "start": "1075150",
    "end": "1080580"
  },
  {
    "text": "plugins and check need to take a look at because if some further chain plug-in decided to modify the results after your",
    "start": "1080580",
    "end": "1087809"
  },
  {
    "text": "plug-in ran then that gets fed back in and your plug-in can see that you know maybe the state is not exactly what I",
    "start": "1087809",
    "end": "1094290"
  },
  {
    "text": "thought it was when I set it up and so that's why if the resource that you",
    "start": "1094290",
    "end": "1100170"
  },
  {
    "text": "configured is listed in the pre frizzled then you can take some action on it but if it is not listed in the pre Frizzle",
    "start": "1100170",
    "end": "1105570"
  },
  {
    "text": "then your plugin should not what really needs to happen here is that if the plug-in thinks that something is invalid",
    "start": "1105570",
    "end": "1112950"
  },
  {
    "text": "it needs to return an error to the runtime and then the runtime is supposed to do something like tear the container",
    "start": "1112950",
    "end": "1118860"
  },
  {
    "text": "down so that it can restart the container with a healthy Network and so",
    "start": "1118860",
    "end": "1124260"
  },
  {
    "text": "let's you know take one example here so if your container sets up or your excuse",
    "start": "1124260",
    "end": "1129900"
  },
  {
    "text": "me your CNI plugin sets up a route inside the container and then a further",
    "start": "1129900",
    "end": "1135090"
  },
  {
    "text": "plugin later on in the chain decides to remove that route or change routing now",
    "start": "1135090",
    "end": "1141120"
  },
  {
    "text": "when that comes back for a check call to determine whether the containers healthy or not your plugin might know through",
    "start": "1141120",
    "end": "1149010"
  },
  {
    "text": "some other mechanism that it was supposed to configure that route inside the container but your plugin will see",
    "start": "1149010",
    "end": "1154620"
  },
  {
    "text": "that in the pre Frizzles that route is not present and in this case that indicates that some further plug-in",
    "start": "1154620",
    "end": "1160590"
  },
  {
    "text": "decided to change things and so your plugin should not decide that that is an error because it could not it did not",
    "start": "1160590",
    "end": "1167670"
  },
  {
    "text": "see that that thing is in the pre Frizzle hopefully that makes sense and",
    "start": "1167670",
    "end": "1172980"
  },
  {
    "text": "this is kind of one of the reasons why it was complicated to decide how check should really work but in the end we did",
    "start": "1172980",
    "end": "1182730"
  },
  {
    "text": "implement check support in all of the reference plugins and so that serves as a pretty good example of exactly how the",
    "start": "1182730",
    "end": "1190559"
  },
  {
    "text": "cni project and the spec expect check to work and again",
    "start": "1190559",
    "end": "1196250"
  },
  {
    "text": "if you see a resource in your plugin that you think should be there but it's not in the pre-freeze alt that you get",
    "start": "1196250",
    "end": "1201350"
  },
  {
    "text": "as part of that check operation that's not an error but anything else you know we would expect your plug-in to return",
    "start": "1201350",
    "end": "1208490"
  },
  {
    "text": "an error to the runtime and then the runtime would take some action on that to make sure that the container was",
    "start": "1208490",
    "end": "1214190"
  },
  {
    "text": "still healthy I think you covered that",
    "start": "1214190",
    "end": "1223100"
  },
  {
    "text": "already the one thing the important thing is there is a skip check safety valve we could come up with some",
    "start": "1223100",
    "end": "1229430"
  },
  {
    "text": "situations where this behavior could return or could result in unwanted",
    "start": "1229430",
    "end": "1235070"
  },
  {
    "text": "behavior and so you can specify in your CNI configuration that check should not actually happen result caching is the",
    "start": "1235070",
    "end": "1243230"
  },
  {
    "text": "other thing and this kind of ties directly in with the check behavior so",
    "start": "1243230",
    "end": "1249140"
  },
  {
    "text": "for example how can you actually do any kind of health checking on a container if you don't know what to check for well",
    "start": "1249140",
    "end": "1255260"
  },
  {
    "text": "the answer is that you need to pass that proof result from the add operation back into the canner back into the the check",
    "start": "1255260",
    "end": "1261740"
  },
  {
    "text": "operation and kind of the same thing for Dell it turns out that a lot of plugins don't necessarily want or need to cache",
    "start": "1261740",
    "end": "1268880"
  },
  {
    "text": "the state that they set up and so it's very useful for those plugins to get the result of the add operation and then",
    "start": "1268880",
    "end": "1275060"
  },
  {
    "text": "they can decide using that information what exactly need to clean up that's things like for example the subnet that",
    "start": "1275060",
    "end": "1282950"
  },
  {
    "text": "was that the container has an IP address on so that for example firewall rules can be cleaned up and you can use and",
    "start": "1282950",
    "end": "1289850"
  },
  {
    "text": "the firewall plug-in you can match on that subnet and do the right thing so there's also config caching and the",
    "start": "1289850",
    "end": "1298690"
  },
  {
    "text": "big issue here is what happens if you want to change Network plugins well the",
    "start": "1298690",
    "end": "1305810"
  },
  {
    "text": "cluster is running and this actually is a thing that people want to do it in",
    "start": "1305810",
    "end": "1312080"
  },
  {
    "text": "some ways it is more complicated than it should be and it might not give you the right results that you want but there",
    "start": "1312080",
    "end": "1317720"
  },
  {
    "text": "was a pretty big gap with C&I around if you change that Network plug-in out nothing actually remembered what the",
    "start": "1317720",
    "end": "1324980"
  },
  {
    "text": "network plug-in was that a particular container was set up with and so you plug in a and you get a container set up",
    "start": "1324980",
    "end": "1332599"
  },
  {
    "text": "with plugin a then you swap out the network plug-in and all the rest of the containers get started with plug-in B",
    "start": "1332599",
    "end": "1339109"
  },
  {
    "text": "but then if container a is removed or deleted nothing remembered that it was supposed",
    "start": "1339109",
    "end": "1344899"
  },
  {
    "text": "to be deleted with the first plugin it would then be deleted with the second plug-in and that obviously is not going",
    "start": "1344899",
    "end": "1350719"
  },
  {
    "text": "to give you the results that you expect and garbage collection and things like that would not do the right thing so",
    "start": "1350719",
    "end": "1358009"
  },
  {
    "text": "config caching basically saves the configuration that any given container",
    "start": "1358009",
    "end": "1363139"
  },
  {
    "text": "was started with and then it will use that configuration for subsequent operations like check and Dell this is",
    "start": "1363139",
    "end": "1372940"
  },
  {
    "text": "we implemented this both config and result caching into Lib C and I and as",
    "start": "1372940",
    "end": "1378679"
  },
  {
    "text": "Brian said this is the library the go library that the cni project provides as a reference for runtimes",
    "start": "1378679",
    "end": "1384919"
  },
  {
    "text": "to encapsulate a lot of this behavior so that the runtimes don't have to all rewrite this themselves so if your are",
    "start": "1384919",
    "end": "1391999"
  },
  {
    "text": "involved or you write a runtime that uses CNI this is mostly automatic for",
    "start": "1391999",
    "end": "1397219"
  },
  {
    "text": "you with Lib C and I and go yes as long as you wrote it and go but most of them",
    "start": "1397219",
    "end": "1403519"
  },
  {
    "text": "are written and go so that's that's not a huge issue it is fairly automatic the one thing",
    "start": "1403519",
    "end": "1409429"
  },
  {
    "text": "that is not automatic with it is the config caching for delete your runtime",
    "start": "1409429",
    "end": "1416210"
  },
  {
    "text": "does need to actually pull that out with API so that we've added to Lib C and I",
    "start": "1416210",
    "end": "1421849"
  },
  {
    "text": "so that you can then pass that configuration back to the delete call but it's actually fairly easy we have",
    "start": "1421849",
    "end": "1428210"
  },
  {
    "text": "implemented this check in other projects and some of the layers that runtimes use",
    "start": "1428210",
    "end": "1433519"
  },
  {
    "text": "so there are definitely examples out there and if you have further questions on it please ask us what's next I'm",
    "start": "1433519",
    "end": "1444169"
  },
  {
    "text": "asking myself so 11.0 is is we because we think it's",
    "start": "1444169",
    "end": "1451540"
  },
  {
    "text": "feature complete so we want to get to 1.0 we're a spectrum 0.4 plug-in 0 dot",
    "start": "1451540",
    "end": "1458080"
  },
  {
    "text": "8.3 something like that we want to declare 1.0 because some people get",
    "start": "1458080",
    "end": "1463660"
  },
  {
    "text": "anxious if if we're before 1.0 so we",
    "start": "1463660",
    "end": "1468790"
  },
  {
    "text": "think we're basically feature complete we therefore have a stable spec which is",
    "start": "1468790",
    "end": "1475450"
  },
  {
    "text": "what 1.0 means really we would like to",
    "start": "1475450",
    "end": "1481660"
  },
  {
    "text": "have more complete test coverage and we need to get our build process signing",
    "start": "1481660",
    "end": "1488650"
  },
  {
    "text": "builds that we'd like to do that conformance test is a is a great idea",
    "start": "1488650",
    "end": "1494130"
  },
  {
    "text": "actually this so this is a ask for those of you who in the audience are really interested we'd we'd love for people to",
    "start": "1494130",
    "end": "1502590"
  },
  {
    "text": "step up to help us with that if nobody steps up we'll probably declare 1.0",
    "start": "1502590",
    "end": "1509830"
  },
  {
    "text": "without a conformance test but it certainly would be a nice really great thing to have 2.0 is the one that comes",
    "start": "1509830",
    "end": "1520780"
  },
  {
    "text": "after 1.0 so just you know a taste of some ideas things that we're talking",
    "start": "1520780",
    "end": "1528850"
  },
  {
    "text": "about currently CNI is a program",
    "start": "1528850",
    "end": "1534340"
  },
  {
    "text": "interface like CGI if if you old enough to remember that the the the caller",
    "start": "1534340",
    "end": "1543010"
  },
  {
    "text": "execs a program which is the plugins and as I described for instance in in in the",
    "start": "1543010",
    "end": "1550360"
  },
  {
    "text": "network I work on all that program does his mix makes a network call a rest call to make something happen somewhere else",
    "start": "1550360",
    "end": "1556750"
  },
  {
    "text": "and a lot of implementations are like that a lot of the bigger ones so what we",
    "start": "1556750",
    "end": "1565450"
  },
  {
    "text": "might want to do and then this has been done in for instance a storage interface CSI is making a G RPC interface so so",
    "start": "1565450",
    "end": "1574480"
  },
  {
    "text": "the kubernetes or the runtime or whatever would somehow be aware that there's a",
    "start": "1574480",
    "end": "1579510"
  },
  {
    "text": "demon running and call it directly that would that would be more efficient give",
    "start": "1579510",
    "end": "1585390"
  },
  {
    "text": "us better facilities to know what the heck's going on I would also point out",
    "start": "1585390",
    "end": "1590520"
  },
  {
    "text": "that process exacting is very inefficient on Windows and I think the",
    "start": "1590520",
    "end": "1596130"
  },
  {
    "text": "the windows CNI team were some of the original people who were pushing us to think about other mechanisms than fork",
    "start": "1596130",
    "end": "1601470"
  },
  {
    "text": "exec for running CNF plugins yeah so gr",
    "start": "1601470",
    "end": "1606690"
  },
  {
    "text": "PC we'd like to do that after 1.0 configuration you know is is currently a",
    "start": "1606690",
    "end": "1614430"
  },
  {
    "text": "JSON file and and it's pretty pretty gnarly exactly how that works or",
    "start": "1614430",
    "end": "1621180"
  },
  {
    "text": "something better than that yeah mo not necessarily I have no idea",
    "start": "1621180",
    "end": "1631620"
  },
  {
    "text": "what a plug-in drop-in is KC are one of our containers he told me what they are",
    "start": "1631620",
    "end": "1638430"
  },
  {
    "text": "and I forgot so come on are slack and our ask us later yeah the idea of",
    "start": "1638430",
    "end": "1646440"
  },
  {
    "text": "garbage collection when you win so for instance the bridge plug-in the first",
    "start": "1646440",
    "end": "1651750"
  },
  {
    "text": "time you call it if there's no bridge it makes a bridge and then you add you know 20 containers or whatever and then let's",
    "start": "1651750",
    "end": "1658380"
  },
  {
    "text": "say you take them all away again they're still a bridge because there's no nobody",
    "start": "1658380",
    "end": "1663810"
  },
  {
    "text": "nobody said to take the bridge away there's no command to take the bridge away so that's the idea of garbage collection when those when there's",
    "start": "1663810",
    "end": "1669300"
  },
  {
    "text": "nothing left using a thing same applies to firewall rules and stuff like that there's it's kind of like plug in in it",
    "start": "1669300",
    "end": "1676410"
  },
  {
    "text": "and plug it or excuse me plug in tear down those are not concepts right now yeah that are in the C&I but there's",
    "start": "1676410",
    "end": "1683010"
  },
  {
    "text": "something we'd like to add to see and I because there's a use case and a need for those and G RPC might be one way to",
    "start": "1683010",
    "end": "1689460"
  },
  {
    "text": "do that yeah because it has a better idea of lifecycle yeah and and yeah what",
    "start": "1689460",
    "end": "1696260"
  },
  {
    "text": "what do you want to see I guess so I just put up the slide about how you can",
    "start": "1696260",
    "end": "1702060"
  },
  {
    "text": "talk to us I'm not sure with any you're still on IRC right",
    "start": "1702060",
    "end": "1710030"
  },
  {
    "text": "slack is is probably more popular we're on the CNC F slack in the CNI channel",
    "start": "1710860",
    "end": "1721930"
  },
  {
    "text": "github the container networking in to address that I said earlier and yeah come come speak to us here so that's",
    "start": "1721930",
    "end": "1731080"
  },
  {
    "text": "yeah over to you now questions observations yep do we have any questions I'll run the mic around",
    "start": "1731080",
    "end": "1738070"
  },
  {
    "text": "please raise your hand if you do Thanks",
    "start": "1738070",
    "end": "1746630"
  },
  {
    "text": "so if you use the multis plugin where you have multiple interfaces for each pod can you have different see and I",
    "start": "1746630",
    "end": "1753470"
  },
  {
    "text": "like implementations rst ins for each interface yeah I think that's the whole",
    "start": "1753470",
    "end": "1760880"
  },
  {
    "text": "point yeah maybe maybe an interesting well it's interesting to meet",
    "start": "1760880",
    "end": "1766670"
  },
  {
    "text": "clarification so CNI has always supported the idea of multiple networks",
    "start": "1766670",
    "end": "1773860"
  },
  {
    "text": "kubernetes has not and Tim Hawken was going on and on about the limitations in",
    "start": "1773860",
    "end": "1781700"
  },
  {
    "text": "in that this morning so maltose kind of was maltose exists to paper over a",
    "start": "1781700",
    "end": "1788690"
  },
  {
    "text": "limitation in kubernetes montez's is taking advantage of the feature of CNI",
    "start": "1788690",
    "end": "1794390"
  },
  {
    "text": "that it always supported multiple networks and sort of one call in",
    "start": "1794390",
    "end": "1799820"
  },
  {
    "text": "multiple calls out yeah that's a great example of how they use the flexibility",
    "start": "1799820",
    "end": "1805850"
  },
  {
    "text": "of the openness of the system to make something happen",
    "start": "1805850",
    "end": "1810550"
  },
  {
    "text": "I could repeat that or you could repeat",
    "start": "1814429",
    "end": "1824059"
  },
  {
    "text": "it for the further people couldn't hear from the telecom in 2c maltose and",
    "start": "1824059",
    "end": "1829369"
  },
  {
    "text": "multiple networking is key and in many respects sort of the the maltose is sort",
    "start": "1829369",
    "end": "1837619"
  },
  {
    "text": "of a step toward a in the CNI context yeah it's it's so you I don't know if",
    "start": "1837619",
    "end": "1842690"
  },
  {
    "text": "everyone can hear that you're saying that the Montes is essential in some areas like like telecoms and it's",
    "start": "1842690",
    "end": "1849919"
  },
  {
    "text": "considered a stepdaughter by kubernetes yes it's it's a it's a it's a CNI",
    "start": "1849919",
    "end": "1857210"
  },
  {
    "text": "plugins perfectly valid so you know I plugin it's just as good as all the other ones",
    "start": "1857210",
    "end": "1862360"
  },
  {
    "text": "it's kubernetes that has that problem so",
    "start": "1862360",
    "end": "1869629"
  },
  {
    "text": "good in continuation to the multis plugin you talked about change plug-in and you're introducing checks and",
    "start": "1869629",
    "end": "1875950"
  },
  {
    "text": "results previous results how how are these new plugins which are actually",
    "start": "1875950",
    "end": "1882860"
  },
  {
    "text": "delegate plugins impacted by that change sure you do have to be a little bit",
    "start": "1882860",
    "end": "1890600"
  },
  {
    "text": "careful and basically our default implementation for check is success so",
    "start": "1890600",
    "end": "1896509"
  },
  {
    "text": "if you don't want to implement check at this point in your plugin or you want to you know do some more research first to",
    "start": "1896509",
    "end": "1903379"
  },
  {
    "text": "figure out the right way to do it you don't have to do anything it's backwards compatible and it will still work exactly like it currently does if you do",
    "start": "1903379",
    "end": "1910399"
  },
  {
    "text": "want to implement check then you do need to be a little bit aware around what",
    "start": "1910399",
    "end": "1915980"
  },
  {
    "text": "other chain plugins might do after your plug-in if they do alter some of the",
    "start": "1915980",
    "end": "1921470"
  },
  {
    "text": "things that your plug-in sets up that's explicitly allowed by the CNI specification and so that's why we have",
    "start": "1921470",
    "end": "1928039"
  },
  {
    "text": "the wording in the specification around if you see something you did in the",
    "start": "1928039",
    "end": "1933710"
  },
  {
    "text": "previous alt then you can check it if you don't see something in the brief results that you did then you have to",
    "start": "1933710",
    "end": "1939710"
  },
  {
    "text": "assume that some other plug-in in the chain changed that and it's okay microphone how do I identify",
    "start": "1939710",
    "end": "1951580"
  },
  {
    "text": "in the changeset that what corresponds to me and how do I look forward and then",
    "start": "1951580",
    "end": "1957340"
  },
  {
    "text": "say that okay some somebody next to me might be modifying if I know in advance",
    "start": "1957340",
    "end": "1962970"
  },
  {
    "text": "what the result is going to be for that modification by another plug-in you know",
    "start": "1962970",
    "end": "1969310"
  },
  {
    "text": "i'm implicitly creating a dependency on something that is going to happen so is",
    "start": "1969310",
    "end": "1974350"
  },
  {
    "text": "there a way for me to identify in this result like what did i do and how does in other change impact my change yeah",
    "start": "1974350",
    "end": "1983830"
  },
  {
    "text": "that's a good question you know at this point there isn't a good way to identify exactly what changes were made by which",
    "start": "1983830",
    "end": "1990580"
  },
  {
    "text": "plug-in I can think of some ways that we could possibly enhance the cni spec to",
    "start": "1990580",
    "end": "1996640"
  },
  {
    "text": "make that happen but at the end of the day you can also just say my plug-in you",
    "start": "1996640",
    "end": "2001980"
  },
  {
    "text": "know should not be used in certain ways with certain chain plugins it's kind of up to the administrator of whatever",
    "start": "2001980",
    "end": "2007770"
  },
  {
    "text": "system you're creating whether it's a kubernetes cluster or whether it's something else to kind of put together the networking",
    "start": "2007770",
    "end": "2013890"
  },
  {
    "text": "set up and you know I mean it you get something that you can shoot yourself in",
    "start": "2013890",
    "end": "2020700"
  },
  {
    "text": "the foot with and you know if you choose to do that that's okay or if the cluster master it chooses to do that then they",
    "start": "2020700",
    "end": "2027150"
  },
  {
    "text": "can do that but you know again you do have to be careful and we set around for a long time and discussed exactly how",
    "start": "2027150",
    "end": "2033210"
  },
  {
    "text": "this stuff works with chain plugins to try to make the best approach that we",
    "start": "2033210",
    "end": "2038310"
  },
  {
    "text": "could that was still flexible you know to accommodate a lot of the chain plug-in use cases but still kind of keep",
    "start": "2038310",
    "end": "2045480"
  },
  {
    "text": "it straightforward so if you have more questions about that feel free to talk to us later or engage us on slack github",
    "start": "2045480",
    "end": "2054379"
  },
  {
    "text": "why is poor mapping in CNI so essentially we want to take all the",
    "start": "2056420",
    "end": "2063690"
  },
  {
    "text": "network specific code out of kubernetes so that's kubernetes also wants to do",
    "start": "2063690",
    "end": "2069960"
  },
  {
    "text": "the same thing oh yeah sorry I said you know I spent half my time I emphasizing that they're completely separate",
    "start": "2069960",
    "end": "2075810"
  },
  {
    "text": "projects and and you also might need to remember that we all work on both of them we're all",
    "start": "2075810",
    "end": "2082010"
  },
  {
    "text": "members of Signet work and kubernetes and so there's where different hats at different times but but yeah",
    "start": "2082010",
    "end": "2087440"
  },
  {
    "text": "specifically we want everybody wants to take the network specific code out of",
    "start": "2087440",
    "end": "2094899"
  },
  {
    "text": "kubernetes particularly couplet or docker shim and so that is why we",
    "start": "2094900",
    "end": "2102380"
  },
  {
    "text": "created a specific implementation in CNI",
    "start": "2102380",
    "end": "2106779"
  },
  {
    "text": "so port mapping is not about stitching a network inside a part actually it's it's",
    "start": "2108820",
    "end": "2114530"
  },
  {
    "text": "something about additional IP table rules or routing or matting that you are doing it has nothing to do with the core",
    "start": "2114530",
    "end": "2120620"
  },
  {
    "text": "networking word and you move a vet inside a network namespace assign an IP and you know just have some roads added",
    "start": "2120620",
    "end": "2127790"
  },
  {
    "text": "into the container well you're entitled to that opinion I I also would say that you know we are",
    "start": "2127790",
    "end": "2134720"
  },
  {
    "text": "trying to figure out how the CNI specification can address features at somewhat higher levels of the stack as",
    "start": "2134720",
    "end": "2141350"
  },
  {
    "text": "well we're always looking to try to find out how we can standardize behaviors that we see as common across a number of",
    "start": "2141350",
    "end": "2148490"
  },
  {
    "text": "different platforms and port mapping was one of those things that is quite popular and so we created a",
    "start": "2148490",
    "end": "2154400"
  },
  {
    "text": "specification or as part of the CNI specification we've defined how port mapping can work in CNI but the port map",
    "start": "2154400",
    "end": "2162440"
  },
  {
    "text": "plug-in is one implementation of that and there are other implementations that consume the same input which is the",
    "start": "2162440",
    "end": "2168590"
  },
  {
    "text": "runtime capabilities and the port mappings but do different things with them than IP tables and you know what",
    "start": "2168590",
    "end": "2174710"
  },
  {
    "text": "the port map plug-in itself does the owner actually in this back is it it's a convention so we can talk about",
    "start": "2174710",
    "end": "2181190"
  },
  {
    "text": "convention versus spec that is true but you know it's kind of do you factor I think maybe one more quick question and",
    "start": "2181190",
    "end": "2187100"
  },
  {
    "text": "then we're out of time",
    "start": "2187100",
    "end": "2190930"
  },
  {
    "text": "so I have a question related to NP w g how do you relate to that network",
    "start": "2196430",
    "end": "2202380"
  },
  {
    "text": "plumbing workgroup I see some interesting discussion on their Google",
    "start": "2202380",
    "end": "2208890"
  },
  {
    "text": "Docs about multi C and export or doing something where to do that so just wondering how the CNR a project relates",
    "start": "2208890",
    "end": "2217380"
  },
  {
    "text": "to that so network plumbing working group is",
    "start": "2217380",
    "end": "2222720"
  },
  {
    "text": "kind of a informal group that is part of kubernetes it's not formally part of the",
    "start": "2222720",
    "end": "2228120"
  },
  {
    "text": "kubernetes project but it is related and it's formed by people who are members of cig network and some other groups as",
    "start": "2228120",
    "end": "2234180"
  },
  {
    "text": "well around a common interest of how you might do multiple networks in a pod",
    "start": "2234180",
    "end": "2240060"
  },
  {
    "text": "within the context of kubernetes that said it is not directly related to CNI",
    "start": "2240060",
    "end": "2245150"
  },
  {
    "text": "although some of the same people are in both groups but network plumbing working group also in the standard or de-facto",
    "start": "2245150",
    "end": "2252720"
  },
  {
    "text": "specification that that group developed specified behavior of multiple networks",
    "start": "2252720",
    "end": "2260070"
  },
  {
    "text": "when a CNI plugin is used to implement that behavior so there are I mean as",
    "start": "2260070",
    "end": "2265440"
  },
  {
    "text": "Brian said many of us are members of many different groups and we all try to",
    "start": "2265440",
    "end": "2271230"
  },
  {
    "text": "you know kind of work together and develop things that we think will push different areas forward but then also",
    "start": "2271230",
    "end": "2276240"
  },
  {
    "text": "try to make sure that you know individual projects work for a number of different use cases and groups as well",
    "start": "2276240",
    "end": "2281930"
  },
  {
    "text": "so if you want to talk more about that I'm happy to to talk more I mean part of",
    "start": "2281930",
    "end": "2287280"
  },
  {
    "text": "the essence of it is is things move forward when someone shows up to do some",
    "start": "2287280",
    "end": "2292500"
  },
  {
    "text": "work you know a lot of a lot of people show up to demand things or complain or",
    "start": "2292500",
    "end": "2299250"
  },
  {
    "text": "whatever and I sympathize you know I all",
    "start": "2299250",
    "end": "2304350"
  },
  {
    "text": "these people are correct about the way they feel but it doesn't get anything done so things get done when people show",
    "start": "2304350",
    "end": "2311580"
  },
  {
    "text": "up so the network plumbing working group is some people who showed up to do work that's that's how things move forward",
    "start": "2311580",
    "end": "2319590"
  },
  {
    "text": "the the CNI project that we is doing a particular kind of work very thin layer",
    "start": "2319590",
    "end": "2325350"
  },
  {
    "text": "hopefully and kubernetes is doing other work so yeah this hope to hope to kind of",
    "start": "2325350",
    "end": "2332820"
  },
  {
    "text": "explain how that all works well yeah we're we're past time thank you very",
    "start": "2332820",
    "end": "2339060"
  },
  {
    "text": "much for for coming [Applause]",
    "start": "2339060",
    "end": "2347249"
  }
]