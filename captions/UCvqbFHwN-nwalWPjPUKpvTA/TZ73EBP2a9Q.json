[
  {
    "text": "hi everyone today we're going to speak on access control in kubernetes",
    "start": "170",
    "end": "5210"
  },
  {
    "text": "specifically what's missing and how to fix it so first off a caveat because",
    "start": "5210",
    "end": "12950"
  },
  {
    "text": "access control is a security topic and security is extremely important this is",
    "start": "12950",
    "end": "19770"
  },
  {
    "text": "not a talk about how lifts run systems it's not a talk about how Trilly runs",
    "start": "19770",
    "end": "24990"
  },
  {
    "text": "systems these are our personal opinions as operators largely working with small companies and small clusters and we are",
    "start": "24990",
    "end": "32040"
  },
  {
    "text": "generalists with kubernetes were not security experts we may be wrong so with",
    "start": "32040",
    "end": "38460"
  },
  {
    "text": "that said in Kerber Nettie's users interact with a virtual object model so some of these objects are very logically",
    "start": "38460",
    "end": "45690"
  },
  {
    "text": "corresponding like pods are a thing sometimes it's a lot more virtual like a replica set or a priority class we use",
    "start": "45690",
    "end": "53070"
  },
  {
    "text": "something that's analogous to rest crud with the kubernetes api to interact with these objects and like any system we",
    "start": "53070",
    "end": "59640"
  },
  {
    "text": "need a way to gate this access so that we don't make every single thing interacting with the cluster run as",
    "start": "59640",
    "end": "65189"
  },
  {
    "text": "effectively rude all right so before we dive in and list off a bunch of tools",
    "start": "65189",
    "end": "71760"
  },
  {
    "text": "things like that helps to think about the fundamentals there's three broad",
    "start": "71760",
    "end": "78710"
  },
  {
    "text": "categories of access control in kubernetes we have first up the runtime",
    "start": "78710",
    "end": "84750"
  },
  {
    "text": "characteristics so do your pods have access to the disk under the hood what do resource limits look like privileges",
    "start": "84750",
    "end": "91470"
  },
  {
    "text": "things like that next up we have the network side of things so how do these",
    "start": "91470",
    "end": "96840"
  },
  {
    "text": "things talk to each other what can communicate with what and things like that lastly is the kind of meta aspect which",
    "start": "96840",
    "end": "103799"
  },
  {
    "text": "is what has access to our control plane and our data plane and that's important",
    "start": "103799",
    "end": "109740"
  },
  {
    "text": "because that's control of kubernetes itself and with access to those things you can probably modify the first two",
    "start": "109740",
    "end": "118820"
  },
  {
    "text": "all right so there's a bunch of different approaches and tools like Valerie said we're not experts but",
    "start": "119240",
    "end": "126240"
  },
  {
    "text": "we're gonna focus on a small but useful subset of them the first one being our back role based access control a lot of",
    "start": "126240",
    "end": "133470"
  },
  {
    "text": "people should be familiar with that and namespaces that go along with it you can use to limit your scope of your are back",
    "start": "133470",
    "end": "139880"
  },
  {
    "text": "and things like that Network policies again helps with communication what can",
    "start": "139880",
    "end": "146970"
  },
  {
    "text": "talk to what things like that custom kubernetes api gateways are the next",
    "start": "146970",
    "end": "152340"
  },
  {
    "text": "thing putting something in front of the kubernetes api and limiting what has",
    "start": "152340",
    "end": "157380"
  },
  {
    "text": "been exposed next admission web hooks validating and mutating is it allowed in",
    "start": "157380",
    "end": "163140"
  },
  {
    "text": "the cluster and do we need to change it before it's created in the cluster and lastly the open policy agent which is an",
    "start": "163140",
    "end": "169050"
  },
  {
    "text": "external tool and can be used to simplify web hooks and other policy management and note that this since",
    "start": "169050",
    "end": "176850"
  },
  {
    "text": "we're talking about a subset security there's many security tools beyond this we're specifically focusing on access control in this talk so let's start by",
    "start": "176850",
    "end": "185160"
  },
  {
    "text": "looking at the built-in authorization system our back our box been around for a long time it went GA in about 1.8",
    "start": "185160",
    "end": "191180"
  },
  {
    "text": "hopefully people who are using kubernetes in production are familiar by now but as a recap our back provides",
    "start": "191180",
    "end": "197489"
  },
  {
    "text": "roles which have several components there's two kinds role or cluster role role applies specifically to namespace",
    "start": "197489",
    "end": "204090"
  },
  {
    "text": "level resources cluster role applies to things that don't fit within a namespace like a new space itself we specify an",
    "start": "204090",
    "end": "211140"
  },
  {
    "text": "API group and resources which refers to what kind of thing the policy applies to say pods in the core API group then we",
    "start": "211140",
    "end": "218549"
  },
  {
    "text": "specify whatever crud style verbs we want to allow this profile to be able to",
    "start": "218549",
    "end": "225239"
  },
  {
    "text": "perform so next up is the role binding the role binding associates a user and a",
    "start": "225239",
    "end": "231870"
  },
  {
    "text": "role so there's similar to roles there's",
    "start": "231870",
    "end": "237120"
  },
  {
    "text": "a role binding at a cluster role binding and again that's at the printings base level or at the entire cluster scope we",
    "start": "237120",
    "end": "244380"
  },
  {
    "text": "give it some users and service accounts we want it to apply to you and then we give it the roles or cluster roles we're",
    "start": "244380",
    "end": "249450"
  },
  {
    "text": "linking to and you can kind of mix and match a lot of these so it's not necessarily one role to one user",
    "start": "249450",
    "end": "256160"
  },
  {
    "text": "so this chain of things can be easiest to visualize I find it's very easy to get things wrong because you have a very",
    "start": "256260",
    "end": "262320"
  },
  {
    "text": "wide chain of connected resources between the thing that you're running and the actual permissions that you've",
    "start": "262320",
    "end": "268990"
  },
  {
    "text": "assigned so these are all fairly pluggable things lately I've been",
    "start": "268990",
    "end": "275950"
  },
  {
    "text": "playing around with ways to aggregate resource view and so in cabinet is because there's often a concept of",
    "start": "275950",
    "end": "281080"
  },
  {
    "text": "chains where one thing will create or own or link with another so this is the",
    "start": "281080",
    "end": "286180"
  },
  {
    "text": "kind of view that I think is very helpful to come up with especially when you're debugging because there's many ways that you can typo or forget",
    "start": "286180",
    "end": "293200"
  },
  {
    "text": "something where you don't necessarily have the permissions that you expect so",
    "start": "293200",
    "end": "299380"
  },
  {
    "text": "aside from our back there's a few other forms of object access control so there",
    "start": "299380",
    "end": "304510"
  },
  {
    "text": "is no base access control which is what couplets use internally essentially it's a list of what a couplet needs to run",
    "start": "304510",
    "end": "310240"
  },
  {
    "text": "inherently and kind of the summer permissions that are necessary for the workloads on it so the idea is that",
    "start": "310240",
    "end": "315460"
  },
  {
    "text": "couplets can't actually access everything they can only do what's relevant for the pods actively on them",
    "start": "315460",
    "end": "320889"
  },
  {
    "text": "as a way to help prevent escalation through arbitrary couplets there's a Bock which is the deprecated",
    "start": "320889",
    "end": "327880"
  },
  {
    "text": "predecessor to arbok it basically jammed permissions directly onto users with a",
    "start": "327880",
    "end": "333370"
  },
  {
    "text": "really a concept of being able to reuse those profiles and then those webhook",
    "start": "333370",
    "end": "339070"
  },
  {
    "text": "off which completely outsource of the decision outside of the cluster so you give it a URL it posts to that external",
    "start": "339070",
    "end": "346000"
  },
  {
    "text": "system and then uses the response to decide whether or not to allow the authorization so our box main limitation",
    "start": "346000",
    "end": "355419"
  },
  {
    "text": "is its lack of granularity for example our bat grants permission by a kind of resource but doesn't allow you to",
    "start": "355419",
    "end": "362490"
  },
  {
    "text": "discriminate on that within a namespace so say if you grant permission to modify pods within a namespace there's no way",
    "start": "362490",
    "end": "369520"
  },
  {
    "text": "to say but only the Redis pods is all of them and so similarly you also can't",
    "start": "369520",
    "end": "376169"
  },
  {
    "text": "narrow scope within fields so I can't say you can only edit labels or you can",
    "start": "376169",
    "end": "382120"
  },
  {
    "text": "only edit replicas if you can edit something you can edit all the fields in all its properties",
    "start": "382120",
    "end": "388260"
  },
  {
    "text": "so let's look at namespaces which are the companion to our back is for a scoping things namespaces are somewhat",
    "start": "388260",
    "end": "394770"
  },
  {
    "text": "analogous to containers in that they are a way to segment to the control plane and share the data plan in a logical",
    "start": "394770",
    "end": "401160"
  },
  {
    "text": "fashion so they're introduced as a way to run like different apps different systems on one cluster without worrying",
    "start": "401160",
    "end": "407340"
  },
  {
    "text": "about the cost and pain that comes with running many actual clusters most",
    "start": "407340",
    "end": "413310"
  },
  {
    "text": "resources fit in the per namespace levels some resources are cluster wide and this is very important in spaces are",
    "start": "413310",
    "end": "421050"
  },
  {
    "text": "resource boundary they're not a security boundary so there's no not necessarily",
    "start": "421050",
    "end": "427110"
  },
  {
    "text": "any segmentation of resources so if someone gets onto a host doesn't really matter what namespace what's in so many",
    "start": "427110",
    "end": "435570"
  },
  {
    "text": "spaces let a scope are back this means we can just wrap everything in lots of tiny tiny namespaces and give it exactly",
    "start": "435570",
    "end": "442200"
  },
  {
    "text": "the permissions we want right not quite so if we get very granular with namespaces we start to want to cross",
    "start": "442200",
    "end": "449790"
  },
  {
    "text": "these namespaces and that gets tricky this is an eternal problem when it comes",
    "start": "449790",
    "end": "456240"
  },
  {
    "text": "to any kind of resource control and computing we want to encapsulate stuff wrap it up and then suddenly there is",
    "start": "456240",
    "end": "461340"
  },
  {
    "text": "some kind of scope creep between things and it gets messy so first off we have",
    "start": "461340",
    "end": "467400"
  },
  {
    "text": "many clear chains of resources and communities like but employment who owns replicas sets owns pods or ingress has",
    "start": "467400",
    "end": "474690"
  },
  {
    "text": "services which map to pods so the vertex we need to keep these together and we're",
    "start": "474690",
    "end": "480510"
  },
  {
    "text": "probably gonna want to wrap stuff even bigger than that so that means we have to have a pretty wide scope with our back even though we",
    "start": "480510",
    "end": "487350"
  },
  {
    "text": "technically have the ability to constrain it so what else can we do all",
    "start": "487350",
    "end": "492600"
  },
  {
    "text": "right so we're gonna look at a few ways to supplement access within namespaces what we can do to control things within",
    "start": "492600",
    "end": "498810"
  },
  {
    "text": "that namespace starting with the most manual approach which is creating a custom API gateway or a deputy that sits",
    "start": "498810",
    "end": "504960"
  },
  {
    "text": "in front of your kubernetes api so what if we don't want to expose direct access",
    "start": "504960",
    "end": "510570"
  },
  {
    "text": "to these resources you can do the same thing you do in other forms of software create a gateway in front of the resource put an API in front of the",
    "start": "510570",
    "end": "518219"
  },
  {
    "text": "kubernetes api and only expose things to downstream systems either",
    "start": "518219",
    "end": "523539"
  },
  {
    "text": "other systems or users the majority of the time this is not something you're",
    "start": "523539",
    "end": "528850"
  },
  {
    "text": "going to want to do because you're solving a problem in a complicated way probably something that could be solved",
    "start": "528850",
    "end": "534459"
  },
  {
    "text": "by just a few lines of config in some other tools so in this example what",
    "start": "534459",
    "end": "540399"
  },
  {
    "text": "we've done we've got our kubernetes api and a deployment and we've put a gateway API in front and all we're exposing is",
    "start": "540399",
    "end": "547060"
  },
  {
    "text": "let's say we let the users change the replica count on this deployment and that's it",
    "start": "547060",
    "end": "552370"
  },
  {
    "text": "so this is nice because consumers of this API only have to understand the",
    "start": "552370",
    "end": "557529"
  },
  {
    "text": "replicas for that deployment nothing else they understand the simple API",
    "start": "557529",
    "end": "562990"
  },
  {
    "text": "rather than the full deployment object which I don't know about everybody here but was really confusing when I first",
    "start": "562990",
    "end": "568959"
  },
  {
    "text": "saw it and additional logic can be built in maybe allowing control for the rate",
    "start": "568959",
    "end": "574600"
  },
  {
    "text": "of change that you can't scale this up or scale it down too fast and you can get as complex as you want so this is",
    "start": "574600",
    "end": "580990"
  },
  {
    "text": "neat but it has some obvious drawbacks it's another moving part in a system with a lot of moving parts and it's a",
    "start": "580990",
    "end": "586540"
  },
  {
    "text": "code burden in your system and fills a very nice role at least in this case but",
    "start": "586540",
    "end": "592720"
  },
  {
    "text": "luckily there's other ways to do this kind of logical gating in a more kubernetes native way so next up",
    "start": "592720",
    "end": "600600"
  },
  {
    "text": "admission web hooks so bringing request gating to the API itself and hopefully",
    "start": "600600",
    "end": "606100"
  },
  {
    "text": "eliminating your need to run a custom service so Mission web hooks run after",
    "start": "606100",
    "end": "612490"
  },
  {
    "text": "authentication and authorization and before admission hence the name two kinds validating and mutating validating",
    "start": "612490",
    "end": "620380"
  },
  {
    "text": "is does the object I want to create comply with some sort of policy a",
    "start": "620380",
    "end": "625630"
  },
  {
    "text": "replica count it does it come from a trusted image repository do I have resource limits set privileges things",
    "start": "625630",
    "end": "632110"
  },
  {
    "text": "like that second is the mutating web hook I'm going to let you create this object in my cluster but I'm going to",
    "start": "632110",
    "end": "638380"
  },
  {
    "text": "change it in some way you'll see this a lot with sidecar injection with a lot of service meshes out there you go to",
    "start": "638380",
    "end": "643600"
  },
  {
    "text": "create a deployment and it just dynamically injects that sidecar if it doesn't already exist things like that",
    "start": "643600",
    "end": "649839"
  },
  {
    "text": "so both of these can ensure valid things are launched into your class",
    "start": "649839",
    "end": "654850"
  },
  {
    "text": "obviously you can use them together all right so you can do a lot of things manually",
    "start": "654850",
    "end": "662350"
  },
  {
    "text": "with admission webhooks but another way if you're looking to kind of standardize your policy management you can use the open policy",
    "start": "662350",
    "end": "669100"
  },
  {
    "text": "agent I am by no means an expert in Opa there's an intro session after this there's a deep dive tomorrow go to those",
    "start": "669100",
    "end": "675879"
  },
  {
    "text": "if you really want to dive in or talk to the steerer folks in the vendors area",
    "start": "675879",
    "end": "682498"
  },
  {
    "text": "but we want to have policies on things created in our cluster what's the",
    "start": "682799",
    "end": "688839"
  },
  {
    "text": "simpler way to do this the open policy agent is I think one of their tag lines",
    "start": "688839",
    "end": "694269"
  },
  {
    "text": "is a lightweight policy engine what does that mean it takes the decisions for",
    "start": "694269",
    "end": "700269"
  },
  {
    "text": "allow deny things like that the policy out of your service so when you go to",
    "start": "700269",
    "end": "705819"
  },
  {
    "text": "create something make a change things like that OPA knows what's running in",
    "start": "705819",
    "end": "711189"
  },
  {
    "text": "your cluster has some policies you've created and will check against those and",
    "start": "711189",
    "end": "716739"
  },
  {
    "text": "say hey is this allowed could be something like I'm trying to pull a public image from docker hub but I only",
    "start": "716739",
    "end": "722679"
  },
  {
    "text": "am allowed to pull internal images for my company's repository so that would be a deny and then would not be allowed so",
    "start": "722679",
    "end": "730539"
  },
  {
    "text": "you can do this you know context specific dynamic the image use you've",
    "start": "730539",
    "end": "735579"
  },
  {
    "text": "used what ports are open what protocols are they serving are they running privileged things like that and this can",
    "start": "735579",
    "end": "742239"
  },
  {
    "text": "work together so you don't have to really speck out these combinations OPA can aggregate it for you so you can use",
    "start": "742239",
    "end": "751389"
  },
  {
    "text": "open policy agent and a controller I know gatekeepers really popular I think that one's still in alpha there's",
    "start": "751389",
    "end": "757029"
  },
  {
    "text": "a tutorial on opens website though but does your object meet my defined criteria whatever that object is is it a",
    "start": "757029",
    "end": "764799"
  },
  {
    "text": "service with an incorrect load balancer name things like that and then can return to you why you're not allowed to",
    "start": "764799",
    "end": "771729"
  },
  {
    "text": "take that action instead of just giving you some obscure error that your yeah Milles incorrect or something like that",
    "start": "771729",
    "end": "777059"
  },
  {
    "text": "which is always more useful than just getting an explicit sorry can't do this",
    "start": "777059",
    "end": "782069"
  },
  {
    "text": "another nice thing is it can be leveraged to return a patch in the form of JSON that tells you what",
    "start": "782069",
    "end": "788500"
  },
  {
    "text": "you need to apply to your object hey you didn't do this thing come back when you",
    "start": "788500",
    "end": "793510"
  },
  {
    "text": "have resource limits you're using you know you're gonna use all the CPU on this node you could even leverage this in an",
    "start": "793510",
    "end": "799450"
  },
  {
    "text": "either in a dynamic way and create a mutating webhook and actually patch it for your users manually maybe just give",
    "start": "799450",
    "end": "805810"
  },
  {
    "text": "them some sort of base resource limit that they need to require when they just try to create something into the cluster",
    "start": "805810",
    "end": "811360"
  },
  {
    "text": "without anything specific so this allows you to have this kind of separation of duties and enhance the coverage and",
    "start": "811360",
    "end": "818320"
  },
  {
    "text": "security so you don't end up with you know let's say a bunch of little itty-bitty security holes that in the",
    "start": "818320",
    "end": "825100"
  },
  {
    "text": "aggregate can be a bigger issue and again I mentioned gatekeeper please check that one out that one's a great",
    "start": "825100",
    "end": "832840"
  },
  {
    "text": "way to get started so lastly I've not seen anyone do this publicly yet but",
    "start": "832840",
    "end": "839380"
  },
  {
    "text": "I've heard about it is using the open policy agent to leverage network policies again controlling that what can",
    "start": "839380",
    "end": "845800"
  },
  {
    "text": "talk to what and a lot of these happen it you know layer for this can't talk to that but what if we could be dynamic and",
    "start": "845800",
    "end": "852670"
  },
  {
    "text": "do that at little layer 7 can I post to widgets but God can I not post to",
    "start": "852670",
    "end": "858070"
  },
  {
    "text": "widgets and but I can get widgets based on some sort of labels or annotations or",
    "start": "858070",
    "end": "863440"
  },
  {
    "text": "something on my pods and then you can combine network policy admission",
    "start": "863440",
    "end": "870670"
  },
  {
    "text": "controllers and the open policy agent and say I'm going to read labels and annotations on these pods and adjust the",
    "start": "870670",
    "end": "877300"
  },
  {
    "text": "network policy accordingly leveraging admission controllers to ensure that those labels and annotations exist",
    "start": "877300",
    "end": "883180"
  },
  {
    "text": "because if the tools looking for some sort of label and it doesn't exist you're out of luck it's not going to",
    "start": "883180",
    "end": "888340"
  },
  {
    "text": "manage or control anything for you so open lets's narrowly restrict at a",
    "start": "888340",
    "end": "895720"
  },
  {
    "text": "logical level beyond just what our pack does so Seth mentioned network policies",
    "start": "895720",
    "end": "901090"
  },
  {
    "text": "network policies are another key part of the access puzzle kubernetes by default",
    "start": "901090",
    "end": "906970"
  },
  {
    "text": "has a flat network and this is one of those things that I was shocked when I learned it so every single pod by",
    "start": "906970",
    "end": "913540"
  },
  {
    "text": "default can talk to every single other pod this includes pause without services and this includes cross namespaces if",
    "start": "913540",
    "end": "920650"
  },
  {
    "text": "there's a port open on a container it can be accessed and that's pretty scary an attacker can use that to traverse",
    "start": "920650",
    "end": "927520"
  },
  {
    "text": "your network or escalate or do anything nasty and on top of that potentially having that wide network behind the",
    "start": "927520",
    "end": "934810"
  },
  {
    "text": "perimeter means you can start building up some accidental service dependencies that perhaps aren't properly known and dealt",
    "start": "934810",
    "end": "941890"
  },
  {
    "text": "with so that can be a big surprise one day so with any service we have a",
    "start": "941890",
    "end": "948600"
  },
  {
    "text": "defined set of calls that the service can make within one another so you can",
    "start": "948600",
    "end": "954580"
  },
  {
    "text": "get this if your service is small and simple enough from just putting it on a napkin you might use a service mash but",
    "start": "954580",
    "end": "959890"
  },
  {
    "text": "either way you can create a graph of what calls what what we'd like to be",
    "start": "959890",
    "end": "967060"
  },
  {
    "text": "able to do is specifically segment everything such that only the things that are supposed to call one another",
    "start": "967060",
    "end": "973030"
  },
  {
    "text": "actually can access one another to prevent some nasty surprises so this is",
    "start": "973030",
    "end": "978250"
  },
  {
    "text": "often easy to think about service the service but we can potentially get very granular the easiest way to do this is",
    "start": "978250",
    "end": "985240"
  },
  {
    "text": "with the communities network policy so the network policy is a native object",
    "start": "985240",
    "end": "990430"
  },
  {
    "text": "although somewhat perplexingly there's no native controller for it so if you just take an off-the-shelf cluster apply",
    "start": "990430",
    "end": "996670"
  },
  {
    "text": "some Network policy amyl nothing will happen you need a third party controller such as calico so the policy uses",
    "start": "996670",
    "end": "1003300"
  },
  {
    "text": "selectors like namespaces and pod selectors to apply to pods when it applies to them those just have no",
    "start": "1003300",
    "end": "1011280"
  },
  {
    "text": "networking allowed unless you put overrides in the overrides let you do things like say service a is only",
    "start": "1011280",
    "end": "1017700"
  },
  {
    "text": "allowed to talk to service B or service B is only allowed to talk to the outside world to restrict that network graph",
    "start": "1017700",
    "end": "1026420"
  },
  {
    "text": "here we have a simple example of that service a to service B type llamo we use a selector for ingress and we use a",
    "start": "1026689",
    "end": "1034410"
  },
  {
    "text": "selector for egress between two different services and I mean service in the lowercase s sense so there's",
    "start": "1034410",
    "end": "1044640"
  },
  {
    "text": "surprisingly few add-ons in my opinion that support this right now calico is one of the main ones that people talk",
    "start": "1044640",
    "end": "1050130"
  },
  {
    "text": "about as far as executing on network policies there's also a lot of tools things in",
    "start": "1050130",
    "end": "1055760"
  },
  {
    "text": "like the service messy space that don't necessarily work with network policy but offer a similar functionality for",
    "start": "1055760",
    "end": "1061970"
  },
  {
    "text": "example this teo has ways to restrict inter-service traffic so some of the",
    "start": "1061970",
    "end": "1069740"
  },
  {
    "text": "issues we've identified come from core functionality that doesn't exist for example the flat open network where",
    "start": "1069740",
    "end": "1076700"
  },
  {
    "text": "there's no controller some of it is just ways where namespace is in the our back are too wide could be tough to manage so",
    "start": "1076700",
    "end": "1083360"
  },
  {
    "text": "we see kind of two ways that someone when they're architecting out their cluster can address this problem one is",
    "start": "1083360",
    "end": "1090710"
  },
  {
    "text": "getting very granular within namespaces and having sub namespace permissioning",
    "start": "1090710",
    "end": "1096110"
  },
  {
    "text": "the other is having lots of tiny namespaces and leaning more on our back so let's kind of examine some ideas in",
    "start": "1096110",
    "end": "1102740"
  },
  {
    "text": "both of those spaces first thing is we",
    "start": "1102740",
    "end": "1108140"
  },
  {
    "text": "had a kind of theoretical approach to having sub names based granularity based",
    "start": "1108140",
    "end": "1113570"
  },
  {
    "text": "on object level permission so instead of relying on tiny namespaces you can grant",
    "start": "1113570",
    "end": "1119000"
  },
  {
    "text": "permissions on singular objects however is necessary and therefore have",
    "start": "1119000",
    "end": "1124690"
  },
  {
    "text": "essentially whatever access control you want with a real protecting the cluster",
    "start": "1124690",
    "end": "1129970"
  },
  {
    "text": "so this inspiration comes from in UNIX where everything is a file somewhat similar to an kubernetes where",
    "start": "1129970",
    "end": "1136970"
  },
  {
    "text": "everything is an object that has some yellow that represents it so in UNIX everything has the permission octal it's",
    "start": "1136970",
    "end": "1143360"
  },
  {
    "text": "a set of digits that correspond to four different groups who can do what and",
    "start": "1143360",
    "end": "1148900"
  },
  {
    "text": "what those set of permissions are so such as like the owner can read write",
    "start": "1148900",
    "end": "1154340"
  },
  {
    "text": "execute this can be messy but it's also very powerful so since everything",
    "start": "1154340",
    "end": "1161870"
  },
  {
    "text": "accumulate is the structured object we have our API version kind metadata spec status metadata is kind of the easiest",
    "start": "1161870",
    "end": "1167809"
  },
  {
    "text": "thing to fuzz around if we want to insert something with a custom controller we could also potentially",
    "start": "1167809",
    "end": "1173750"
  },
  {
    "text": "abuse annotations it's very common to essentially stringify some JSON and just",
    "start": "1173750",
    "end": "1180530"
  },
  {
    "text": "put that entirely in an annotation so that can be a good way if you're not modifying the career days core itself so",
    "start": "1180530",
    "end": "1189790"
  },
  {
    "text": "hypothetically we can put something in this metadata around granting ownership",
    "start": "1189790",
    "end": "1195170"
  },
  {
    "text": "on that object rather than try to apply things namespace wide so this could be done fairly simply by giving like full",
    "start": "1195170",
    "end": "1202070"
  },
  {
    "text": "owners or we could get very very granular like saying certain fields that",
    "start": "1202070",
    "end": "1207590"
  },
  {
    "text": "these can edit and access however the more we thought about it the more we figured out that this was not",
    "start": "1207590",
    "end": "1213650"
  },
  {
    "text": "necessarily a good idea so I don't know about many of you I've administered some",
    "start": "1213650",
    "end": "1220700"
  },
  {
    "text": "pretty large and messy VMs in my time and the more custom and bespoke individual objects in a system get the",
    "start": "1220700",
    "end": "1227260"
  },
  {
    "text": "harder and more unclear they are to manage and lack of clarity and difficulty is a security flaw because",
    "start": "1227260",
    "end": "1234440"
  },
  {
    "text": "you're more likely to get things wrong so this isn't a good idea instead we",
    "start": "1234440",
    "end": "1239690"
  },
  {
    "text": "should lean on something like admission web hooks or OPA if we want to have particular restrictions on something",
    "start": "1239690",
    "end": "1246950"
  },
  {
    "text": "very fine-tuned and then fall back to our back for a kind of our coarse grained security permissions or we could",
    "start": "1246950",
    "end": "1255710"
  },
  {
    "text": "go in the opposite direction and keep per namespace our back and have more smaller namespaces think of it like the",
    "start": "1255710",
    "end": "1263870"
  },
  {
    "text": "genie in Aladdin phenomenal cosmic power a DVD living space phenomenal cluster power anybody name",
    "start": "1263870",
    "end": "1268940"
  },
  {
    "text": "space so as it stands objects that rely on one another need to be housed in the",
    "start": "1268940",
    "end": "1276380"
  },
  {
    "text": "same namespace ingress is target a service that then targets pods or endpoints deployments control replicas",
    "start": "1276380",
    "end": "1283010"
  },
  {
    "text": "sets that go down to pods so this leads",
    "start": "1283010",
    "end": "1288020"
  },
  {
    "text": "to the issue where namespace level service accounts can't be used in multiple namespaces so if you have BOTS",
    "start": "1288020",
    "end": "1295310"
  },
  {
    "text": "or service accounts things like that you're going to need to create them in every single namespace where they're required or consider making them",
    "start": "1295310",
    "end": "1303620"
  },
  {
    "text": "clustered level for example in many cases you'd want a cluster level controller for a resource so",
    "start": "1303620",
    "end": "1311480"
  },
  {
    "text": "to keep namespaces small we need to accept cross namespace functionality trying to get rid of it leads to more",
    "start": "1311480",
    "end": "1318050"
  },
  {
    "text": "complexity than it's worth so you can restrict access between namespaces and only allow explicitly",
    "start": "1318050",
    "end": "1325010"
  },
  {
    "text": "permitted services to cross those namespaces and you could even try and restrict things further within that",
    "start": "1325010",
    "end": "1332390"
  },
  {
    "text": "namespace so when you end up with controllers or external systems that need to target things in multiple",
    "start": "1332390",
    "end": "1337970"
  },
  {
    "text": "namespaces you can either consider duplicating that component such as the",
    "start": "1337970",
    "end": "1343430"
  },
  {
    "text": "per deploy credentials and namespaces or as Valerie mentioned operating it at cluster level such as like a cluster",
    "start": "1343430",
    "end": "1350360"
  },
  {
    "text": "wide controller on your reticence tenses or things like that so in case you are",
    "start": "1350360",
    "end": "1358040"
  },
  {
    "text": "all distracted on Twitter what do you need to take away from this firstly criminales design priority is",
    "start": "1358040",
    "end": "1364040"
  },
  {
    "text": "deliberately extensibility over out-of-the-box usability so this is why",
    "start": "1364040",
    "end": "1370190"
  },
  {
    "text": "we're all here this is why coop con is so big because we can make it work for us but the problem is we do need to make it work for us",
    "start": "1370190",
    "end": "1375890"
  },
  {
    "text": "it is not something that we necessarily just install and go so security is one",
    "start": "1375890",
    "end": "1381740"
  },
  {
    "text": "of those many considerations where it may work it will probably not work well without some fine-tuning",
    "start": "1381740",
    "end": "1389110"
  },
  {
    "text": "so you can group resources together where it makes sense I can do namespaces",
    "start": "1389530",
    "end": "1396080"
  },
  {
    "text": "for your front end bits namespace for the back end a namespace for your data related things there can be some sort of",
    "start": "1396080",
    "end": "1402170"
  },
  {
    "text": "best practices around this something along those lines but it's probably going to look different for everybody based on your",
    "start": "1402170",
    "end": "1407870"
  },
  {
    "text": "individual use cases we can't tell you the best way to chop up the namespaces in your cluster I could try but I don't",
    "start": "1407870",
    "end": "1415250"
  },
  {
    "text": "know your environment and I'd probably be wrong so when you have new spaces",
    "start": "1415250",
    "end": "1420950"
  },
  {
    "text": "that are as small as is reasonable to make them use our back to make access as reasonably tight as you need it this is",
    "start": "1420950",
    "end": "1428270"
  },
  {
    "text": "something where you may make compromises based on just what is going to rabbit",
    "start": "1428270",
    "end": "1433640"
  },
  {
    "text": "hole in security for your business and your priorities as well as leaning on",
    "start": "1433640",
    "end": "1439580"
  },
  {
    "text": "those other technologies that we mentioned rather than trying to do everything in pure our back",
    "start": "1439580",
    "end": "1444789"
  },
  {
    "text": "so using tooling like admission webhooks you can start with just validating web",
    "start": "1444789",
    "end": "1450889"
  },
  {
    "text": "hooks just to puerile our deny on something and you know don't allow the objects in your cluster that don't meet",
    "start": "1450889",
    "end": "1456559"
  },
  {
    "text": "your requirements improper environment variables privileges I don't like not going to happen",
    "start": "1456559",
    "end": "1462110"
  },
  {
    "text": "you can move onto mutating hooks to change the things that you're launching in your cluster and maybe bring them",
    "start": "1462110",
    "end": "1467179"
  },
  {
    "text": "into line just a little bit if they're only you know a step out of line you can use tools from the community like open",
    "start": "1467179",
    "end": "1473000"
  },
  {
    "text": "policy agent to standardize the policy for things like this you know bring some uniform management to your policy for",
    "start": "1473000",
    "end": "1479149"
  },
  {
    "text": "things in and out of cluster so we",
    "start": "1479149",
    "end": "1484159"
  },
  {
    "text": "didn't introduce ourselves at the beginning I'm Valerie I recently joined at lyft I have been in the Korean community for",
    "start": "1484159",
    "end": "1490190"
  },
  {
    "text": "a while and I do a little bit of everything these days I'm trying to focus on sig network but I do all kinds of stuff",
    "start": "1490190",
    "end": "1496610"
  },
  {
    "text": "upstream and downstream right now and I'm stuff I work at trailer I came from",
    "start": "1496610",
    "end": "1502070"
  },
  {
    "text": "an IT operations background so I was not a software engineer when I started doing these things and when I'm not messing",
    "start": "1502070",
    "end": "1508730"
  },
  {
    "text": "with kubernetes I like to play guitar and collect fountain pens and thanks for coming all right we're ready to take",
    "start": "1508730",
    "end": "1514130"
  },
  {
    "text": "questions we're also willing to take",
    "start": "1514130",
    "end": "1522500"
  },
  {
    "text": "questions while the music plays in the background because it was just really cool like James Bond intro theme thing going on so if you guys are more into",
    "start": "1522500",
    "end": "1527510"
  },
  {
    "text": "that we can bring that back to thank you",
    "start": "1527510",
    "end": "1540980"
  },
  {
    "text": "whoever picked it up thank you thanks for the give us some information we actually stumble upon a lot of all of",
    "start": "1540980",
    "end": "1547730"
  },
  {
    "text": "these trying to build a multi-user solution for cube flow and one of the problems were having is we're having a",
    "start": "1547730",
    "end": "1553880"
  },
  {
    "text": "multi user scenario where it's user has a separate namespace which i think is",
    "start": "1553880",
    "end": "1558980"
  },
  {
    "text": "pretty common right and the thing is we had the problem with the scenario where",
    "start": "1558980",
    "end": "1564350"
  },
  {
    "text": "we want its user to be able to delete his own namespace but this doesn't make sense in our buck I mean have you",
    "start": "1564350",
    "end": "1572059"
  },
  {
    "text": "encountered this domain do you maybe have a workaround have you thought about this I've never encountered anything",
    "start": "1572059",
    "end": "1578269"
  },
  {
    "text": "like that just to clarify did you mention that every user has their own namespace exactly oh yeah I've never",
    "start": "1578269",
    "end": "1585080"
  },
  {
    "text": "configured anything like that that would be an interesting problem to solve for me I've always just configured you know",
    "start": "1585080",
    "end": "1591230"
  },
  {
    "text": "grouping like projects and things together Valerie do you have any thoughts I'm trying to remember if you",
    "start": "1591230",
    "end": "1598970"
  },
  {
    "text": "can nicely segment that or not you could definitely pull something off with OPA but I'm not sure if vanilla Arabic would",
    "start": "1598970",
    "end": "1606019"
  },
  {
    "text": "be able to assign permission of a clustered little resource like that you",
    "start": "1606019",
    "end": "1611029"
  },
  {
    "text": "have to do something with if your user ends up deleting their namespace how do they get it back you don't want to give them you know permissions to create a",
    "start": "1611029",
    "end": "1618139"
  },
  {
    "text": "bunch of namespaces cluster wide so that's an interesting problem so yeah",
    "start": "1618139",
    "end": "1625760"
  },
  {
    "text": "OPA couldn't quite do it because you don't know which user is requesting that you're only out the admission path you",
    "start": "1625760",
    "end": "1631700"
  },
  {
    "text": "don't know which user is issuing that request right so I was looking a bit",
    "start": "1631700",
    "end": "1638029"
  },
  {
    "text": "into admission web whoo sorry I mean authorization web code there is that option to to plug into your own",
    "start": "1638029",
    "end": "1643850"
  },
  {
    "text": "authorization but it seems that they don't want to make it dynamic upstream that's the feeling I got have you looked",
    "start": "1643850",
    "end": "1649820"
  },
  {
    "text": "into this a little bit dynamic web poke authorization I have not too much thanks a lot anybody",
    "start": "1649820",
    "end": "1660500"
  },
  {
    "text": "from steerer here that works on OPA we can make that happen yeah what's that just throw the mic just",
    "start": "1660500",
    "end": "1668890"
  },
  {
    "text": "bad idea yes on a PA Oh PA when you get the request you have a user info on the",
    "start": "1668890",
    "end": "1677810"
  },
  {
    "text": "request so assuming so you have the identity you can use the identity in OPA yeah but you have to have like another",
    "start": "1677810",
    "end": "1684920"
  },
  {
    "text": "sidecar container that extract the identities from LDAP or water what is your identity provider because you only",
    "start": "1684920",
    "end": "1691520"
  },
  {
    "text": "have the object ID so you have to have to inject in OPA other information but",
    "start": "1691520",
    "end": "1696950"
  },
  {
    "text": "it's there can I also have a question yeah of course yeah you've already got the mic",
    "start": "1696950",
    "end": "1702770"
  },
  {
    "text": "I'm gonna take it away so one issue that we're having is that we went with the route to use OPA with",
    "start": "1702770",
    "end": "1711850"
  },
  {
    "text": "being more granular than are back at the namespace level so we allow we create",
    "start": "1711850",
    "end": "1718040"
  },
  {
    "text": "for examples and default Network policies but we also like to allow the user to create or delete metal policies",
    "start": "1718040",
    "end": "1727280"
  },
  {
    "text": "from this itself himself and the issue is that we'd like to to somehow make the",
    "start": "1727280",
    "end": "1733070"
  },
  {
    "text": "default resources that were created immutable so they don't delete the",
    "start": "1733070",
    "end": "1738140"
  },
  {
    "text": "default metal policies and stuff like that so I'm wondering if anyone or you can recommend the way to do that can we",
    "start": "1738140",
    "end": "1746930"
  },
  {
    "text": "make resources immutable not to delete them or something I don't believe so I'm",
    "start": "1746930",
    "end": "1752600"
  },
  {
    "text": "looking at Valerie to fill in the blanks no no no if kubernetes allows you to",
    "start": "1752600",
    "end": "1759440"
  },
  {
    "text": "have like immutable resources for",
    "start": "1759440",
    "end": "1763090"
  },
  {
    "text": "where the gate we can edit it but okay so we don't be a thank you.thank get",
    "start": "1765780",
    "end": "1773280"
  },
  {
    "text": "super meta and control opa with opa yeah you might need a custom gateway for that where the Gateway has edit access but",
    "start": "1773280",
    "end": "1779970"
  },
  {
    "text": "that's not exposed to the user turtles all the way down awesome well thanks for",
    "start": "1779970",
    "end": "1786210"
  },
  {
    "text": "coming everyone I had a question oh cool Laurie yeah you didn't stand up I didn't see you I'm",
    "start": "1786210",
    "end": "1791700"
  },
  {
    "text": "sorry okay and it talks about East you are back and open policy or agent",
    "start": "1791700",
    "end": "1797130"
  },
  {
    "text": "working together have you tried that how to maybe enable open police agent in",
    "start": "1797130",
    "end": "1803580"
  },
  {
    "text": "mixer in East you alright so I know there's some sections of the sto documentation I was in Gareth's unit",
    "start": "1803580",
    "end": "1810480"
  },
  {
    "text": "testing kubernetes with OPA before this I haven't douve a lot into using OPA and",
    "start": "1810480",
    "end": "1816000"
  },
  {
    "text": "sto together but I do know it is one project that is bringing it in and it's going to support it natively so you",
    "start": "1816000",
    "end": "1821550"
  },
  {
    "text": "don't have to be super happy with it okay thanks",
    "start": "1821550",
    "end": "1826160"
  },
  {
    "text": "I have questions because you're also mention that dividing to multiple nine",
    "start": "1837570",
    "end": "1843149"
  },
  {
    "text": "space to get more control also for your experience what is based on your",
    "start": "1843149",
    "end": "1849779"
  },
  {
    "text": "experience the approach better that one big cluster for multi-tenant user or do",
    "start": "1849779",
    "end": "1855749"
  },
  {
    "text": "you have some limits when I don't know you reach like twenty nine space and you create a separate clusters and also did",
    "start": "1855749",
    "end": "1863070"
  },
  {
    "text": "you experiment with cross cross cross there connections I think so I'm sure",
    "start": "1863070",
    "end": "1871109"
  },
  {
    "text": "there's some kind of point at which sed would fall over with too many namespaces but certainly wouldn't be xx rule of",
    "start": "1871109",
    "end": "1877049"
  },
  {
    "text": "thumb is more likely when you get to too big of a cluster size in terms of nodes that workload you'd look at splitting up",
    "start": "1877049",
    "end": "1883129"
  },
  {
    "text": "personally I advise against splitting workloads between clusters unnecessarily unless they either have very different",
    "start": "1883129",
    "end": "1888659"
  },
  {
    "text": "SLA is required very different clusters themselves or have like entirely different security classes like payment",
    "start": "1888659",
    "end": "1894869"
  },
  {
    "text": "processing versus a website I tend to limit my number of namespaces to the max",
    "start": "1894869",
    "end": "1900779"
  },
  {
    "text": "of when it gets difficult to remember what goes in each different namespace which is different for every company but",
    "start": "1900779",
    "end": "1906059"
  },
  {
    "text": "that's when you automate we have many many namespaces well trailers not lived",
    "start": "1906059",
    "end": "1912690"
  },
  {
    "text": "apologies yes thanks just one on the",
    "start": "1912690",
    "end": "1917879"
  },
  {
    "text": "number of namespaces yeah it's from a different story but OpenShift support limit is on the order of ten thousand I",
    "start": "1917879",
    "end": "1923700"
  },
  {
    "text": "think the question I wanted to ask was about so you looked at supplementing",
    "start": "1923700",
    "end": "1930869"
  },
  {
    "text": "objects resource definitions with as I think you put it well abusing annotations but have you looked at",
    "start": "1930869",
    "end": "1937769"
  },
  {
    "text": "extending the role and the role binding objects would that be like something like a label selector potentially the",
    "start": "1937769",
    "end": "1947639"
  },
  {
    "text": "concern is it's way easier to make it too hard and easy to kind of foot gun yourself versus useful but that's",
    "start": "1947639",
    "end": "1955019"
  },
  {
    "text": "definitely another approach that could be done cuz that's also a bit more unified because in Kiruna is individual",
    "start": "1955019",
    "end": "1960389"
  },
  {
    "text": "objects are a bit more mass-produced and less bespoke compared to like the",
    "start": "1960389",
    "end": "1965460"
  },
  {
    "text": "traditional model of a unix file I think we have maybe time for one more",
    "start": "1965460",
    "end": "1972790"
  },
  {
    "text": "I think we're gonna get kicked out soon I think I see people walking in so one",
    "start": "1972790",
    "end": "1980110"
  },
  {
    "text": "more and then I'm gonna hang out out there after this if anybody else wants talked about more stanky so we are",
    "start": "1980110",
    "end": "1987660"
  },
  {
    "text": "running the following oscillation we have an Apache server in front of the kubernetes cluster and a firewall",
    "start": "1987660",
    "end": "1994000"
  },
  {
    "text": "between them we are setting a lot of rules on the Apache server like a long",
    "start": "1994000",
    "end": "2000180"
  },
  {
    "text": "methods and directory based rules how do I avoid over managing configurations on",
    "start": "2000180",
    "end": "2007530"
  },
  {
    "text": "the Apache and then with the network policies with the pod policies what methods can I access and so on because",
    "start": "2007530",
    "end": "2016170"
  },
  {
    "text": "I'm just I just fear if I do it all over the place I'm going to lose control",
    "start": "2016170",
    "end": "2021450"
  },
  {
    "text": "some some time part of that might be a matter of preference for your system",
    "start": "2021450",
    "end": "2027510"
  },
  {
    "text": "personally I would break it up to application level logic goes into Apache and then more lower-level Network logic",
    "start": "2027510",
    "end": "2034740"
  },
  {
    "text": "like pure allow deny for any traffic should be at the cluster level cool",
    "start": "2034740",
    "end": "2041580"
  },
  {
    "text": "thanks for coming everyone [Applause]",
    "start": "2041580",
    "end": "2049950"
  }
]