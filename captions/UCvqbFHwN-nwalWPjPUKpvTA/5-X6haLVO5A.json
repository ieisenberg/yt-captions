[
  {
    "text": "so hello everyone um Welcome to our talk welcome to the tutorial uh writing a",
    "start": "40",
    "end": "5359"
  },
  {
    "text": "cluster API provider um we're just going to quickly introduce ourselves I am Anusha I am a technical",
    "start": "5359",
    "end": "13519"
  },
  {
    "text": "product manager at nirmata I recently shifted my focus to kubernetes policy and governance but prior to this I",
    "start": "13519",
    "end": "20519"
  },
  {
    "text": "extensively worked on cluster API and I'm also a maintainer of cluster API provider for bring your own",
    "start": "20519",
    "end": "27480"
  },
  {
    "text": "host hi everyone my name is Richard I work as a p engineer at Susa I'm",
    "start": "27480",
    "end": "34239"
  },
  {
    "text": "currently one of the maintainers of the AWS and microv VM capy providers and I",
    "start": "34239",
    "end": "40039"
  },
  {
    "text": "have a particular interest in how you represent managed kubernetes in cluster",
    "start": "40039",
    "end": "46320"
  },
  {
    "text": "API I'm a visi Trager from Red Hat among other things I'm uh one of the leads of",
    "start": "46320",
    "end": "54399"
  },
  {
    "text": "deployment open shift on Prem um part of that using",
    "start": "54399",
    "end": "61920"
  },
  {
    "text": "API hi um this is wian so I'm engineering manager at P Mo and I'm also",
    "start": "62039",
    "end": "68880"
  },
  {
    "text": "contributor to cross API provider AWS and gcp and also worked on many this",
    "start": "68880",
    "end": "75479"
  },
  {
    "text": "coordin in Cross API okay okay then let's get started uh",
    "start": "75479",
    "end": "82119"
  },
  {
    "text": "sorry the podium is here the slides are there and we're going to talk from here um so quick show hands how many here are",
    "start": "82119",
    "end": "90320"
  },
  {
    "text": "familiar with cluster API what cluster API is cool uh have you all worked with the",
    "start": "90320",
    "end": "97200"
  },
  {
    "text": "provider before yes yes perfect and how many here",
    "start": "97200",
    "end": "103680"
  },
  {
    "text": "want to have an actual use case to write the provider from",
    "start": "103680",
    "end": "108840"
  },
  {
    "text": "scratch and how many are looking to you know start contributing to existing providers or cluster",
    "start": "108840",
    "end": "116320"
  },
  {
    "text": "API okay perfect I think our tutorial is well cater to all of these",
    "start": "116320",
    "end": "123370"
  },
  {
    "text": "[Music] so today we'll be learning we'll start with what is cluster API just the basics",
    "start": "123370",
    "end": "130080"
  },
  {
    "text": "so that you know all of us are on the same page we will go a little bit into the cluster API provider Theory and then",
    "start": "130080",
    "end": "137120"
  },
  {
    "text": "uh jump right into writing a provider uh so before that we have a",
    "start": "137120",
    "end": "143280"
  },
  {
    "text": "GitHub repo with all uh the instructions present so if you can scan the QR code",
    "start": "143280",
    "end": "148959"
  },
  {
    "text": "or directly head over to capy samples GitHub IO so we have all the prerequisites listed there uh feel free",
    "start": "148959",
    "end": "155519"
  },
  {
    "text": "to you know start uh doing the prerequisits it's just a bunch of tools that you'll have to install uh while we",
    "start": "155519",
    "end": "161400"
  },
  {
    "text": "go through the basics in",
    "start": "161400",
    "end": "164560"
  },
  {
    "text": "parallel okay okay uh",
    "start": "172640",
    "end": "181080"
  },
  {
    "text": "can we move on all right thanks um and also so we have only about",
    "start": "181080",
    "end": "188680"
  },
  {
    "text": "90 minutes today uh and I'm going to take up like 10 15 minutes of those talking Theory so in case you need help",
    "start": "188680",
    "end": "195519"
  },
  {
    "text": "during the tutorial and also if there are any audience joining us virtually I recommend you join our slack channel in",
    "start": "195519",
    "end": "202400"
  },
  {
    "text": "the cncf slack it's called cubec con na 2022 cppy provider tutorial so you can",
    "start": "202400",
    "end": "208560"
  },
  {
    "text": "either raise your hand here and one of us will come help you out or in case we cannot please use the channel for all",
    "start": "208560",
    "end": "215680"
  },
  {
    "text": "discussions and not just during the session if you run if you run out of time today and you're still determined",
    "start": "215680",
    "end": "221439"
  },
  {
    "text": "to complete the tutorial you can continue to use the slack post the session as well so I'm going to stay on",
    "start": "221439",
    "end": "227840"
  },
  {
    "text": "the slide for about 5",
    "start": "227840",
    "end": "231000"
  },
  {
    "text": "Seconds all right so let's get started so what is cluster",
    "start": "236599",
    "end": "242360"
  },
  {
    "text": "API so it is a solution for declaratively specifying a kubernetes cluster just like you declaratively",
    "start": "242360",
    "end": "249200"
  },
  {
    "text": "specify workloads that run on the cluster so this pro project was built on the premise that cluster life cycle",
    "start": "249200",
    "end": "255560"
  },
  {
    "text": "management is difficult because historically there have been a number of ways and methods and tools to provision",
    "start": "255560",
    "end": "262199"
  },
  {
    "text": "a kubernetes clusters and uh the user experience is not consistent amongst these tools so what clust Ria aims at is",
    "start": "262199",
    "end": "269440"
  },
  {
    "text": "providing providing a consistent user experience in the life cycle management of clusters so be it like create upgrade",
    "start": "269440",
    "end": "275960"
  },
  {
    "text": "delete the entire LCM part of it um and also we have a CLI called",
    "start": "275960",
    "end": "283000"
  },
  {
    "text": "cluster CTL so it handles the um life cycle of the cppy management cluster",
    "start": "283000",
    "end": "288759"
  },
  {
    "text": "which in turns does the life cycle management of workload clusters so you can use cluster CTL for initializing",
    "start": "288759",
    "end": "294960"
  },
  {
    "text": "your provider or upgrading your provider Etc so there are community calls that is",
    "start": "294960",
    "end": "300520"
  },
  {
    "text": "weekly office hours on Wednesdays and every provider has their separate office hours in a separate Cadence all of these",
    "start": "300520",
    "end": "308160"
  },
  {
    "text": "is available on the kubernetes community calendar and for a complete walkthrough",
    "start": "308160",
    "end": "313759"
  },
  {
    "text": "of cppy and understanding what cppy is the working of it so there is a series",
    "start": "313759",
    "end": "319400"
  },
  {
    "text": "on YouTube by Stefan and feio called let's talk about feel free to check it out and also on Friday afternoon there",
    "start": "319400",
    "end": "327120"
  },
  {
    "text": "is a Cappy tutorial Happening by the core cppy team so uh that might be of",
    "start": "327120",
    "end": "333280"
  },
  {
    "text": "interest to some of you all so what is a cluster API provider a",
    "start": "333280",
    "end": "339680"
  },
  {
    "text": "provider is essentially a kubernetes operator uh it implements infrastructure",
    "start": "339680",
    "end": "344919"
  },
  {
    "text": "or operating environment specific functionality that is used together with core cppy to manage the life cycle of a",
    "start": "344919",
    "end": "351160"
  },
  {
    "text": "kubernetes cluster the provider will adhere to certain contracts that is defined by Kappy Kappy specifies",
    "start": "351160",
    "end": "357960"
  },
  {
    "text": "different kinds of contracts for different kinds of providers so we will shortly look at what are the different",
    "start": "357960",
    "end": "363960"
  },
  {
    "text": "types of providers but there is a contract defined for each type of Provider the contract is implemented bya",
    "start": "363960",
    "end": "370919"
  },
  {
    "text": "the providers using the custom resource definitions and the adherence to contract allows interaction between core",
    "start": "370919",
    "end": "377560"
  },
  {
    "text": "cppy and its providers um so let's refresh our cppy",
    "start": "377560",
    "end": "384160"
  },
  {
    "text": "glossery so the cppy cluster API book has pretty extensive documentation on",
    "start": "384160",
    "end": "389599"
  },
  {
    "text": "various Concepts experimental features and there are like lots of cod Snippets for examples um but these are some of the",
    "start": "389599",
    "end": "396000"
  },
  {
    "text": "high level things like what is a management cluster so it is a kubernetes cluster that manages the life cycle of",
    "start": "396000",
    "end": "401720"
  },
  {
    "text": "workload clusters a management cluster is also where you run your providers and custom resources like machine or machine",
    "start": "401720",
    "end": "408840"
  },
  {
    "text": "sets would be stored workload cluster is where you run your workloads on the control plane is a set of components",
    "start": "408840",
    "end": "415879"
  },
  {
    "text": "that serve the kubernetes API and continuously reconcile from a given state to a desired State and",
    "start": "415879",
    "end": "422919"
  },
  {
    "text": "machine is the declarative spec for an infrastructure component hosting a kubernetes node and machine deployment",
    "start": "422919",
    "end": "429520"
  },
  {
    "text": "and machine set now this is analogous to a deployment and a replica set so this makes sure there are always the desired",
    "start": "429520",
    "end": "436199"
  },
  {
    "text": "number of machines present in your cluster and machine health check as the name suggests checks the health of your",
    "start": "436199",
    "end": "442199"
  },
  {
    "text": "machine uh if it is deemed unhealthy it cppy just rolls out a new machine for you",
    "start": "442199",
    "end": "449800"
  },
  {
    "text": "so we talked about different provider types so there are currently three types of providers in cppy one is the",
    "start": "449919",
    "end": "455039"
  },
  {
    "text": "infrastructure provider and this is the most widely available and as the name suggest so this type of provider is used",
    "start": "455039",
    "end": "461400"
  },
  {
    "text": "to provision any infrastructure that is used to create a kubernetes cluster in a Target environment for example cluster",
    "start": "461400",
    "end": "468599"
  },
  {
    "text": "API provider for AWS creates AWS resources like vpcs or ec2",
    "start": "468599",
    "end": "474120"
  },
  {
    "text": "instances but the infrastructure provider itself doesn't uh provision kubernetes and for that you'll have to",
    "start": "474120",
    "end": "480120"
  },
  {
    "text": "use a bootstrap provider so bootstrap provider is something that provides with bootstrap scripts suppose say you're",
    "start": "480120",
    "end": "487039"
  },
  {
    "text": "using qadium as your bootstrap provider it will provide you with either Cub adum init or Cub adum joint depending on",
    "start": "487039",
    "end": "494479"
  },
  {
    "text": "whether you want to initialize or join a cluster these uh scripts will be",
    "start": "494479",
    "end": "500319"
  },
  {
    "text": "available in the form of secrets that your infrastructure provider will read and execute so that uh you can bootstrap",
    "start": "500319",
    "end": "507720"
  },
  {
    "text": "the cluster itself and and the third type of provider is the control plane provider it is used to represent and",
    "start": "507720",
    "end": "514518"
  },
  {
    "text": "manage the life cycle of a kubernetes control plane or if you're using a managed kubernetes service like eks or",
    "start": "514519",
    "end": "520919"
  },
  {
    "text": "AKs then uh it will directly manage those services in AWS and",
    "start": "520919",
    "end": "527040"
  },
  {
    "text": "Azure uh quickly moving on yeah sorry to inter maybe let's go",
    "start": "527040",
    "end": "532880"
  },
  {
    "text": "back to the prequisite slide to make sure everyone is okay yeah so I think for people who joined in late",
    "start": "532880",
    "end": "540320"
  },
  {
    "text": "um we do have a we do have a documentation on GitHub",
    "start": "540320",
    "end": "545760"
  },
  {
    "text": "and I urge you all to go through the prerequisites and you know install a bunch of tools that are needed so that",
    "start": "545760",
    "end": "551279"
  },
  {
    "text": "when we get to the tutorial section we can jump right in and I want to give a quick disclaimer we just figured out",
    "start": "551279",
    "end": "557760"
  },
  {
    "text": "today morning I think Docker desktop version 4 413 413 we found some issues",
    "start": "557760",
    "end": "564640"
  },
  {
    "text": "so uh anything up to 412 will work perfectly fine there was some problem with the kind create cluster I guess",
    "start": "564640",
    "end": "573079"
  },
  {
    "text": "yeah okay I'm going to jump back so so let's quickly discuss the",
    "start": "573640",
    "end": "580839"
  },
  {
    "text": "different custom resource types in cppy so cppy has a number of custom resource types to logically difference part of a",
    "start": "580839",
    "end": "587240"
  },
  {
    "text": "kubernetes cluster um and all the gray boxes here represent the cppy custom",
    "start": "587240",
    "end": "593360"
  },
  {
    "text": "resources so the so the one on top the cluster itself so it's it it logically",
    "start": "593360",
    "end": "598560"
  },
  {
    "text": "represents the cluster as a whole and contains General configuration information like the pot cider block or",
    "start": "598560",
    "end": "605120"
  },
  {
    "text": "what is your kubernetes uh version itself of the cluster uh we have these resource kinds",
    "start": "605120",
    "end": "611440"
  },
  {
    "text": "that represent a way to manage machines so we have machine machine deployment machine sets and machine pool a machine",
    "start": "611440",
    "end": "619000"
  },
  {
    "text": "is equivalent to a single node whereas a machine deployment and machine set make",
    "start": "619000",
    "end": "624360"
  },
  {
    "text": "sure the number of replicas of your machine is always in the desired number of replicas that you want whereas",
    "start": "624360",
    "end": "631480"
  },
  {
    "text": "machine pool is used um in terms of like Auto scaling or virtual machine scale",
    "start": "631480",
    "end": "636839"
  },
  {
    "text": "sets in Azure you can dynamically scale up and scale down machine",
    "start": "636839",
    "end": "642440"
  },
  {
    "text": "pool and then we have machine health check like we described earlier it checks the health of your machine if any",
    "start": "643920",
    "end": "650200"
  },
  {
    "text": "machine Goes Down And if it's deemed unreachable or unhealthy then cluster API U Provisions new machines for you",
    "start": "650200",
    "end": "660160"
  },
  {
    "text": "now if you're creating so that was core cppy cluster resources now if you're creating a bootstrap provider uh you'll",
    "start": "660160",
    "end": "666560"
  },
  {
    "text": "be creating custom resources to represent bootstrap information so it will need to contain configuration like",
    "start": "666560",
    "end": "673200"
  },
  {
    "text": "cuum in it or join depending on whether you want to initialize your cluster or join a note to an existing cluster so in",
    "start": "673200",
    "end": "681000"
  },
  {
    "text": "this diagram all the pink boxes represent a bootstrap provider Resource One thing to note here is all",
    "start": "681000",
    "end": "687360"
  },
  {
    "text": "the pink boxes are encompassed in inside the gray boxes so it means either uh the core capy resource own these um provider",
    "start": "687360",
    "end": "695240"
  },
  {
    "text": "resources or they reference to these resources next if you're writing an",
    "start": "695240",
    "end": "701600"
  },
  {
    "text": "infrastructure provider then you'll be creating a custom resource to represent the infrastructure you'll be creating in",
    "start": "701600",
    "end": "707040"
  },
  {
    "text": "the Target environment so all the orange boxes here represent an infr provider resource the infra cluster on top is it",
    "start": "707040",
    "end": "715240"
  },
  {
    "text": "represents the base infrastructure that is required for the cluster so this uh involves things like networking and",
    "start": "715240",
    "end": "721160"
  },
  {
    "text": "security groups but it doesn't uh contain any information that is particular to the",
    "start": "721160",
    "end": "726560"
  },
  {
    "text": "machine itself for that you have infr machine infr machine template these custom resources uh have configuration",
    "start": "726560",
    "end": "733720"
  },
  {
    "text": "information that is needed to actually bring up a compute instance for example an E2 instance or a vsphere",
    "start": "733720",
    "end": "740320"
  },
  {
    "text": "VM and you can also see the examples of the naming convention that is being adopted by different providers so you",
    "start": "740320",
    "end": "746600"
  },
  {
    "text": "just prefix the resource kind with the provider name like you have AWS cluster Docker cluster similarly you'll have an",
    "start": "746600",
    "end": "753079"
  },
  {
    "text": "AWS machine or a Docker Machine by now you get the drift similarly you'll have a control plane",
    "start": "753079",
    "end": "760040"
  },
  {
    "text": "provider resource and all of these resources will either be owned by core capy resources or referenced by capy",
    "start": "760040",
    "end": "768440"
  },
  {
    "text": "sources so uh so so what actually makes up a provider so we discussed so far",
    "start": "768440",
    "end": "774440"
  },
  {
    "text": "that cppy defines certain contracts for different kinds of providers and depending on the type of Prov provider",
    "start": "774440",
    "end": "779519"
  },
  {
    "text": "you want you need to adhere to the contract so all these uh uh so you can adhere to the contract based on",
    "start": "779519",
    "end": "786399"
  },
  {
    "text": "crds and we also discussed that a provider is nothing but a kubernetes operator so it means it it'll have a",
    "start": "786399",
    "end": "793240"
  },
  {
    "text": "bunch of controllers that will reconcile the crds that you've written then there will be additional Kates resources to",
    "start": "793240",
    "end": "799440"
  },
  {
    "text": "deploy the controller itself so these are a bunch of yaml files and things like rback",
    "start": "799440",
    "end": "805760"
  },
  {
    "text": "configuration and then metadata and repo layout so this is not necessarily a cppy",
    "start": "805760",
    "end": "810839"
  },
  {
    "text": "contract but it's sort of like a best practices that is followed which makes your provider releases easier and also",
    "start": "810839",
    "end": "818399"
  },
  {
    "text": "like if you want to use cluster CTL to initialize your provider uh if it is in a certain repository layout it'll be",
    "start": "818399",
    "end": "824639"
  },
  {
    "text": "easier for cluster CTL to discover your provider and initialize all right I think that was",
    "start": "824639",
    "end": "831800"
  },
  {
    "text": "enough Theory uh over to",
    "start": "831800",
    "end": "836160"
  },
  {
    "text": "Richard cool so we've now could now move on to the Practical part of this so this",
    "start": "837680",
    "end": "844320"
  },
  {
    "text": "is the actual tutorial so it's expected to be um practical so you do the work",
    "start": "844320",
    "end": "852399"
  },
  {
    "text": "yourself um and actually build your own",
    "start": "852399",
    "end": "856759"
  },
  {
    "text": "provider so what what we actually going to be building so we are going to be building a infrastructure provider uh",
    "start": "857839",
    "end": "864440"
  },
  {
    "text": "for Docker so this is going to be Loosely based on the existing provider",
    "start": "864440",
    "end": "869880"
  },
  {
    "text": "within cppy but it's going to be simplified and achievable within the time frame that we have allotted to us",
    "start": "869880",
    "end": "878240"
  },
  {
    "text": "as a as n mentions as it's an infrastructure provider our provider will have to provision any",
    "start": "878240",
    "end": "883560"
  },
  {
    "text": "infrastructure that is required for the cluster now in the case of this provider it's going to provision container",
    "start": "883560",
    "end": "889920"
  },
  {
    "text": "instances so we will be provision uh creating a container instance for a load balancer and the load balancer is for",
    "start": "889920",
    "end": "896000"
  },
  {
    "text": "the API server and then we will be creating container instances for every",
    "start": "896000",
    "end": "901360"
  },
  {
    "text": "machine or node within that cluster so we will be interacting with the docker",
    "start": "901360",
    "end": "906600"
  },
  {
    "text": "API to to spin these container instances up we will be using the cube ADM control",
    "start": "906600",
    "end": "914839"
  },
  {
    "text": "plane and bootstrap providers so those are the things that we'll be doing actual bootstrapping of",
    "start": "914839",
    "end": "920720"
  },
  {
    "text": "kubernetes within those containers for us but we'll just be using those",
    "start": "920720",
    "end": "928000"
  },
  {
    "text": "so bit about the tutorial format so um the idea is you will work through the",
    "start": "930440",
    "end": "937759"
  },
  {
    "text": "various sections within the tutorial docs I will put the link up again in a minute in case anyone hasn't got it so",
    "start": "937759",
    "end": "944639"
  },
  {
    "text": "you the idea is you work through them in order and it will slowly build up the",
    "start": "944639",
    "end": "949800"
  },
  {
    "text": "provider for you so we're going to allow a certain amount of time per per section",
    "start": "949800",
    "end": "957440"
  },
  {
    "text": "uh for you to to work on that but we will then move on to the next section just so that we can discuss each section",
    "start": "957440",
    "end": "964279"
  },
  {
    "text": "as we go along but the main thing is don't panic you don't have to finish it",
    "start": "964279",
    "end": "969440"
  },
  {
    "text": "uh within that time just just take your own time um but we just just for the",
    "start": "969440",
    "end": "974480"
  },
  {
    "text": "sake of the tutorial moving things along we will move on to the next",
    "start": "974480",
    "end": "979079"
  },
  {
    "text": "section and the main thing is what we want to do is give you everything that is required or needed for you to go away",
    "start": "983199",
    "end": "990720"
  },
  {
    "text": "and potentially build your own uh cluster API provider so if you if you",
    "start": "990720",
    "end": "996160"
  },
  {
    "text": "get stuck or if you just have any questions uh please just raise your hand uh and one of us will come and help you",
    "start": "996160",
    "end": "1003519"
  },
  {
    "text": "so as you go through this there may be questions or there may be issues so yeah just make sure you raise your hand um or",
    "start": "1003519",
    "end": "1010120"
  },
  {
    "text": "also if you just want some extra context also just raise your hand and we we can answer any questions you want so",
    "start": "1010120",
    "end": "1016040"
  },
  {
    "text": "hopefully you don't go away with any questions answered but if you do you know you can",
    "start": "1016040",
    "end": "1021800"
  },
  {
    "text": "always follow up with us on the slack Channel after this session uh or or grab us afterwards or the rest of",
    "start": "1021800",
    "end": "1029558"
  },
  {
    "text": "cuon so I'm just going to put the link up again uh for those that have just uh",
    "start": "1031319",
    "end": "1037480"
  },
  {
    "text": "arrived if you if you scan that code it'll take you to the tutorial documentation um that's going to live",
    "start": "1037480",
    "end": "1043438"
  },
  {
    "text": "there as well after this session so you know you can go back to it and use it as reference",
    "start": "1043439",
    "end": "1049799"
  },
  {
    "text": "also within that um so if you go to the to the to the site and click through to",
    "start": "1049799",
    "end": "1054960"
  },
  {
    "text": "to GitHub you'll also see a reference implementation that goes along with this as well um but again also just feel free to",
    "start": "1054960",
    "end": "1062559"
  },
  {
    "text": "to join slack as well so there are a number of sections",
    "start": "1062559",
    "end": "1068960"
  },
  {
    "text": "in there so we are going to well hopefully you've already started",
    "start": "1068960",
    "end": "1075039"
  },
  {
    "text": "installing the prerequisites then we're going to do some basic setup um that's going to be dealing with the",
    "start": "1075039",
    "end": "1080640"
  },
  {
    "text": "repositories Etc then we're going to do some scaffolding so Cod generation and",
    "start": "1080640",
    "end": "1086320"
  },
  {
    "text": "then we're going to move on to uh setting up tilt now tilt is essential to it's an essential quality of life",
    "start": "1086320",
    "end": "1092480"
  },
  {
    "text": "Improvement for you um otherwise it can be quite a painful iterative process",
    "start": "1092480",
    "end": "1097799"
  },
  {
    "text": "without that then we're going to get move on to to the meat of writing that they provider and this is a thing that",
    "start": "1097799",
    "end": "1104240"
  },
  {
    "text": "starts to differentiate it from a normal operator so we're going to implement",
    "start": "1104240",
    "end": "1109559"
  },
  {
    "text": "the docker cluster or the infrastructure cluster as Cappy sometimes calls it then we'll move on to the docker machine",
    "start": "1109559",
    "end": "1116000"
  },
  {
    "text": "representation and its controllers and then we will talk",
    "start": "1116000",
    "end": "1121039"
  },
  {
    "text": "about what web hooks after we've done all of that then",
    "start": "1121039",
    "end": "1127760"
  },
  {
    "text": "we can actually create a cluster with our provider and hopefully we'll all get to that point so that you can then apply",
    "start": "1127760",
    "end": "1133400"
  },
  {
    "text": "AEL to your management cluster and see your new provider create a kubernetes cluster for for you which will be great",
    "start": "1133400",
    "end": "1140120"
  },
  {
    "text": "and then right at the end we are going to cover some stuff around uh releases",
    "start": "1140120",
    "end": "1145440"
  },
  {
    "text": "so if you want your provider to be installable via cluster cudle or cluster CTL then there's certain things that you",
    "start": "1145440",
    "end": "1152840"
  },
  {
    "text": "must do as a provider implementer uh around GitHub and and certain files and we will cover that as well if we have",
    "start": "1152840",
    "end": "1162039"
  },
  {
    "text": "time oh so I'm going to just switch the slides off and then we",
    "start": "1164080",
    "end": "1171000"
  },
  {
    "text": "will so give me two",
    "start": "1171600",
    "end": "1175360"
  },
  {
    "text": "seconds",
    "start": "1177760",
    "end": "1180760"
  },
  {
    "text": "so hopefully everyone can see that screen all right um please raise your hands if you can't see it if you need",
    "start": "1189039",
    "end": "1196520"
  },
  {
    "text": "anything bigger and also again just a reminder just to raise hands if you have any questions so we won't be executing",
    "start": "1196520",
    "end": "1203200"
  },
  {
    "text": "every single command from those tutorial documents so for some sections we will",
    "start": "1203200",
    "end": "1208640"
  },
  {
    "text": "just to highlight some some key points but the rest of the sections we will",
    "start": "1208640",
    "end": "1213919"
  },
  {
    "text": "will give you an overview when we get to that um with the expectation that you will run through those instructions from",
    "start": "1213919",
    "end": "1220799"
  },
  {
    "text": "the site so",
    "start": "1220799",
    "end": "1226679"
  },
  {
    "text": "so when you go to the site um the your tutorial site if you just click on start tutorial and then you'll see the various",
    "start": "1231360",
    "end": "1237679"
  },
  {
    "text": "sections uh on the left hand side so just a note about the prerequisites is everyone has everyone",
    "start": "1237679",
    "end": "1244520"
  },
  {
    "text": "installed the prerequisites yet or is are people still doing that anyone need more",
    "start": "1244520",
    "end": "1250760"
  },
  {
    "text": "time no no one's raising the hand so oh you need more time oh done oh you're",
    "start": "1250760",
    "end": "1256280"
  },
  {
    "text": "done cool that's even better um great so the first thing is is the setup",
    "start": "1256280",
    "end": "1262120"
  },
  {
    "text": "so in the setup we are essentially going to have to do two things first of",
    "start": "1262120",
    "end": "1268360"
  },
  {
    "text": "all ideally Fork the clust API repo or clone it down to your to your local",
    "start": "1268360",
    "end": "1275480"
  },
  {
    "text": "machine um you can do either or thing to note here is when you are cloning it",
    "start": "1275480",
    "end": "1282080"
  },
  {
    "text": "clone it into your go path um it seems a bit Antiquated now to clone things actually into the go path but the these",
    "start": "1282080",
    "end": "1289440"
  },
  {
    "text": "are for historic reasons so some of the tool co-generation tooling doesn't work",
    "start": "1289440",
    "end": "1295000"
  },
  {
    "text": "outside of the goath and you ends up embedding it in Crazy locations so it's much easier if you actually clone these",
    "start": "1295000",
    "end": "1302039"
  },
  {
    "text": "into your go paath so if you can do that with the the",
    "start": "1302039",
    "end": "1307440"
  },
  {
    "text": "cluster API repo and then after you've done that you will need to create a new repo in GitHub",
    "start": "1307440",
    "end": "1315200"
  },
  {
    "text": "under your own username called cluster hyphen API hyphen provider hyphen",
    "start": "1315200",
    "end": "1322320"
  },
  {
    "text": "Docker now the name there is follows conventions um probably don't need to",
    "start": "1322320",
    "end": "1328919"
  },
  {
    "text": "explain the conventions um it's pretty self-explanatory but pretty much all providers are named the same there are",
    "start": "1328919",
    "end": "1334840"
  },
  {
    "text": "some slight variations and then then at the bottom we just add some uh get ignores um feel",
    "start": "1334840",
    "end": "1343159"
  },
  {
    "text": "free to to do those or not it's up to you um so I'll probably give",
    "start": "1343159",
    "end": "1350840"
  },
  {
    "text": "people couple of minutes to do that and if anyone has any questions in",
    "start": "1350840",
    "end": "1356480"
  },
  {
    "text": "the meantime",
    "start": "1356480",
    "end": "1362240"
  },
  {
    "text": "no so I'm going to do the same as well um",
    "start": "1364360",
    "end": "1370919"
  },
  {
    "text": "so crit yeah I can do that",
    "start": "1370919",
    "end": "1377679"
  },
  {
    "text": "is that better yeah yep cool so I've already created the repo in",
    "start": "1378840",
    "end": "1385440"
  },
  {
    "text": "in GitHub so I'm just going to clone it down to my machine so I generally have two windows",
    "start": "1385440",
    "end": "1392000"
  },
  {
    "text": "open at a time or two terminal Windows um or panes depending on if you're using",
    "start": "1392000",
    "end": "1397720"
  },
  {
    "text": "uh tmox so the first one is in the directory of of my the provider I'm",
    "start": "1397720",
    "end": "1403320"
  },
  {
    "text": "working on and the second one was is in the directory of cppy itself",
    "start": "1403320",
    "end": "1410440"
  },
  {
    "text": "cool does anyone need more time with that this first",
    "start": "1419799",
    "end": "1425480"
  },
  {
    "text": "part and when you go through these these instructions sometimes you'll see",
    "start": "1437440",
    "end": "1443080"
  },
  {
    "text": "reference to within GitHub to capy hyen samples uh in most instances of that you",
    "start": "1443080",
    "end": "1448960"
  },
  {
    "text": "will be especially on commands you'll be replacing those with your username so in",
    "start": "1448960",
    "end": "1454520"
  },
  {
    "text": "case there's any that have been missed Within These these documents just to",
    "start": "1454520",
    "end": "1460200"
  },
  {
    "text": "know cool so now that we have the rep",
    "start": "1462559",
    "end": "1469000"
  },
  {
    "text": "set up and cloned down to our local machine we can actually move on to to scaffold",
    "start": "1469000",
    "end": "1474440"
  },
  {
    "text": "him and the purpose of this section is to essentially scaffold the project or",
    "start": "1474440",
    "end": "1480919"
  },
  {
    "text": "you know or to generate all of the code that is required as a basis uh for you",
    "start": "1480919",
    "end": "1486080"
  },
  {
    "text": "to then build your controller it takes a lot of the the pain out of doing all",
    "start": "1486080",
    "end": "1492480"
  },
  {
    "text": "that initial code because Cube Builder will generate that for you now these steps are essentially",
    "start": "1492480",
    "end": "1500919"
  },
  {
    "text": "applicable to any operator that you build using CU Builder so you can take",
    "start": "1500919",
    "end": "1506480"
  },
  {
    "text": "this away and build whatever operator you you",
    "start": "1506480",
    "end": "1511440"
  },
  {
    "text": "want so I am going to do these steps but essentially what we're going to do is we're going to use Cube Builder to",
    "start": "1511640",
    "end": "1518240"
  },
  {
    "text": "initialize a project and then we are going to use Cube Builder to add apis",
    "start": "1518240",
    "end": "1524600"
  },
  {
    "text": "and controllers for our Docker cluster and Docker machine to that project and",
    "start": "1524600",
    "end": "1529880"
  },
  {
    "text": "at that point it's going to generate a whole bunch of code for us and and yaml that we can then use without that having",
    "start": "1529880",
    "end": "1536559"
  },
  {
    "text": "to write it ourselves so",
    "start": "1536559",
    "end": "1542360"
  },
  {
    "text": "if so the first thing we going to do is initialize the project so going to use the cube builder in it here so there's a",
    "start": "1555240",
    "end": "1561039"
  },
  {
    "text": "couple of things to note is the domain so most providers create their crd",
    "start": "1561039",
    "end": "1567760"
  },
  {
    "text": "definitions within an API Group that ends with this uh cluster. xkes",
    "start": "1567760",
    "end": "1575760"
  },
  {
    "text": "doio the other thing to mention here is obviously in the-- repo put your repo in here that you have",
    "start": "1575760",
    "end": "1582640"
  },
  {
    "text": "just created so what this will do is it will entally generate some code for for",
    "start": "1582640",
    "end": "1588679"
  },
  {
    "text": "us and then tell us oh well now we've created a project you should probably add an API to it so that's what we're",
    "start": "1588679",
    "end": "1594880"
  },
  {
    "text": "going to do next I'll just pause for a",
    "start": "1594880",
    "end": "1601840"
  },
  {
    "text": "minute so the next thing we are going to do was going to add a new API definition",
    "start": "1605559",
    "end": "1610919"
  },
  {
    "text": "or crd um so this is going to be for our Docker cluster as you can see at the end here",
    "start": "1610919",
    "end": "1618640"
  },
  {
    "text": "is in the kind another thing to note is we are using a group here so this is a",
    "start": "1618640",
    "end": "1624720"
  },
  {
    "text": "prefix to that domain that we just used and the convention is that the group is",
    "start": "1624720",
    "end": "1632039"
  },
  {
    "text": "prefixed with the type of Provider you are building so in now in our case we're building an infrastructure provider so",
    "start": "1632039",
    "end": "1638480"
  },
  {
    "text": "we're going to prefix the API version kubernetes API version with",
    "start": "1638480",
    "end": "1643760"
  },
  {
    "text": "infrastructure you also see just to overload the terms um we are specifying",
    "start": "1643760",
    "end": "1648960"
  },
  {
    "text": "an actual API version in in the sense of kubernetes and crds of of V1 alpha 1 um",
    "start": "1648960",
    "end": "1655080"
  },
  {
    "text": "you can choose whatever you want here um but just be aware that depending on your level of the API there are certain API",
    "start": "1655080",
    "end": "1662720"
  },
  {
    "text": "guarantees you should adhere to so Alpha apis are the most lenient to",
    "start": "1662720",
    "end": "1670240"
  },
  {
    "text": "change so I'm going to execute that it's going to ask you should I create the resource so should I create the custom",
    "start": "1670240",
    "end": "1676240"
  },
  {
    "text": "resource definition so yep and shall I then create a controller",
    "start": "1676240",
    "end": "1682519"
  },
  {
    "text": "for that so there are situations when you run this where you won't want to create a controller and this is",
    "start": "1682519",
    "end": "1690080"
  },
  {
    "text": "specifically for things like templates so you will have later on something",
    "start": "1690080",
    "end": "1695120"
  },
  {
    "text": "called a machine template and as the name suggest that's a template that ultimately results in an actual machine",
    "start": "1695120",
    "end": "1701279"
  },
  {
    "text": "so you don't need a controller to be generated for a template resource but in this instance we are",
    "start": "1701279",
    "end": "1707640"
  },
  {
    "text": "creating a the cluster infrastructure resource or Docker cluster so we do want a controller so I'm just going to say",
    "start": "1707640",
    "end": "1715080"
  },
  {
    "text": "yes it's going to then generate a whole bunch of stuff for me code and",
    "start": "1715080",
    "end": "1721600"
  },
  {
    "text": "yaml so then what I generally do then",
    "start": "1721600",
    "end": "1727518"
  },
  {
    "text": "is this is wait so then we we need to do this",
    "start": "1727720",
    "end": "1733600"
  },
  {
    "text": "basically the same but for the machine so we are going to have essentially two API definitions dock a cluster do a",
    "start": "1733600",
    "end": "1740559"
  },
  {
    "text": "machine so one to represent the cluster as a whole the infrastructure and one to represent individual machines and that's",
    "start": "1740559",
    "end": "1746440"
  },
  {
    "text": "exactly the same command obviously just changing the name so I'm going to execute that",
    "start": "1746440",
    "end": "1752320"
  },
  {
    "text": "now I want to create the crd and the",
    "start": "1752320",
    "end": "1757880"
  },
  {
    "text": "controller so as part of the code generation or the the initial in it it's",
    "start": "1759640",
    "end": "1765279"
  },
  {
    "text": "going to create a make file for you and there's a bunch of Target in there that you'll need to use as you develop your",
    "start": "1765279",
    "end": "1771559"
  },
  {
    "text": "your provider so the first one is",
    "start": "1771559",
    "end": "1780919"
  },
  {
    "text": "um make generate so what mate generate does as the name suggests is it's going",
    "start": "1781519",
    "end": "1788240"
  },
  {
    "text": "to run a bunch of code generation tools against your API definitions so it specifically for",
    "start": "1788240",
    "end": "1795880"
  },
  {
    "text": "things like generating deep copy functions so it allows you to create",
    "start": "1795880",
    "end": "1801200"
  },
  {
    "text": "copies of your your uh API types but it will also run things like uh default",
    "start": "1801200",
    "end": "1807240"
  },
  {
    "text": "Generations so if you want to have Supply default values of some sort that don't necessarily fit into the Q Builder",
    "start": "1807240",
    "end": "1815480"
  },
  {
    "text": "defaults definitions so if you want to do something a bit more complex with your defaults you can also create",
    "start": "1815480",
    "end": "1822399"
  },
  {
    "text": "something called defaulters uh and then there is a code generation tool that would be run from make as well to do",
    "start": "1822399",
    "end": "1828880"
  },
  {
    "text": "that so I'm just going to run that now and we'll soon have a look at what",
    "start": "1828880",
    "end": "1835960"
  },
  {
    "text": "this is all done so the next make Target that you",
    "start": "1835960",
    "end": "1841120"
  },
  {
    "text": "need to be aware of is make manifests so as a name suggests this is",
    "start": "1841120",
    "end": "1847240"
  },
  {
    "text": "actually going to create the kubernetes Manifest um from your definition from",
    "start": "1847240",
    "end": "1852880"
  },
  {
    "text": "your code mainly um so what you'll see is when we start to look at the code there's going to be a whole bunch of",
    "start": "1852880",
    "end": "1860080"
  },
  {
    "text": "cube Builder special comments throughout the",
    "start": "1860080",
    "end": "1865639"
  },
  {
    "text": "code and this make manifest will run some tooling that understands scans the",
    "start": "1865639",
    "end": "1871039"
  },
  {
    "text": "source code looks for these these comments and it generates kubernetes artifacts as a result so as you make",
    "start": "1871039",
    "end": "1878880"
  },
  {
    "text": "changes to your API definitions and your controllers make sure that you",
    "start": "1878880",
    "end": "1884240"
  },
  {
    "text": "are running make generate and make manifest to do that code",
    "start": "1884240",
    "end": "1890919"
  },
  {
    "text": "generation cool so now we've got our code we've got",
    "start": "1894080",
    "end": "1899799"
  },
  {
    "text": "our manifests um we should probably just check that it actually compiles because it might not do so there is a build",
    "start": "1899799",
    "end": "1909278"
  },
  {
    "text": "Target okay how's everyone getting on with that so",
    "start": "1914919",
    "end": "1922639"
  },
  {
    "text": "far any problems",
    "start": "1922639",
    "end": "1928960"
  },
  {
    "text": "no oh no problem no problem",
    "start": "1929840",
    "end": "1934840"
  },
  {
    "text": "cool a few minutes",
    "start": "1936519",
    "end": "1943559"
  },
  {
    "text": "okay yes I'll give you a few minutes just to to get to this point because",
    "start": "1943559",
    "end": "1948960"
  },
  {
    "text": "this is the the starting point for the rest of the",
    "start": "1948960",
    "end": "1953639"
  },
  {
    "text": "sections okay so I I will also for anyone that's just joined I will also",
    "start": "1956080",
    "end": "1962200"
  },
  {
    "text": "just show the",
    "start": "1962200",
    "end": "1967480"
  },
  {
    "text": "link so if you just joined feel free to um scan this and go to the tutorial",
    "start": "1972519",
    "end": "1982000"
  },
  {
    "text": "docs so we are just in the setup",
    "start": "1982120",
    "end": "1986960"
  },
  {
    "text": "section and the scaffolding",
    "start": "1987480",
    "end": "1994799"
  },
  {
    "text": "y yeah if anybody have questions you can raise hand we can we can comment",
    "start": "1995240",
    "end": "2002919"
  },
  {
    "text": "and also if anyone missed it um there is a slack channel in the cncf slack that",
    "start": "2015240",
    "end": "2020399"
  },
  {
    "text": "you can join you can ask questions there now or after this session and we will",
    "start": "2020399",
    "end": "2025519"
  },
  {
    "text": "try and answer them as well",
    "start": "2025519",
    "end": "2029440"
  },
  {
    "text": "controller forgot what",
    "start": "2053599",
    "end": "2057320"
  },
  {
    "text": "generus okay I I think I've seen this issue before I've seen it I just forgot",
    "start": "2062760",
    "end": "2069639"
  },
  {
    "text": "okay what you can do",
    "start": "2075359",
    "end": "2079000"
  },
  {
    "text": "is so there is actually make Target controller probably give people another minute or so and then I'll carry on so",
    "start": "2088000",
    "end": "2095878"
  },
  {
    "text": "let's do this so actually create the converion then if you run what are we",
    "start": "2095879",
    "end": "2104240"
  },
  {
    "text": "running make generate yeah so if you do that it it oh",
    "start": "2104240",
    "end": "2111680"
  },
  {
    "text": "what such",
    "start": "2111680",
    "end": "2115119"
  },
  {
    "text": "fire do you have to create",
    "start": "2120920",
    "end": "2126040"
  },
  {
    "text": "okay cool okay so now we're going to have a look",
    "start": "2139079",
    "end": "2145040"
  },
  {
    "text": "at what the these commands have generated for us so I'm just going to use vs code um I",
    "start": "2145040",
    "end": "2153560"
  },
  {
    "text": "probably need to change the size of that do I",
    "start": "2153560",
    "end": "2158760"
  },
  {
    "text": "hopefully that's better so there's a couple of things to note from the from the generat this has",
    "start": "2159240",
    "end": "2164400"
  },
  {
    "text": "all been generated by those Cube Builder commands so I'm going to just start at",
    "start": "2164400",
    "end": "2170800"
  },
  {
    "text": "the top and and work my way down just to give you an idea what it's generated so the",
    "start": "2170800",
    "end": "2176480"
  },
  {
    "text": "first part that it's generated is our API definitions or our crds so these are",
    "start": "2176480",
    "end": "2182119"
  },
  {
    "text": "in the API folder so we ran two Q Builder commands one's the docker",
    "start": "2182119",
    "end": "2188240"
  },
  {
    "text": "cluster API and one to create the docker machine API so it has",
    "start": "2188240",
    "end": "2193920"
  },
  {
    "text": "generated two API definitions for us so I'm not going to go into too much details but if you go in there you'll",
    "start": "2193920",
    "end": "2200319"
  },
  {
    "text": "see that there are definitions for Docker cluster it spec and it status",
    "start": "2200319",
    "end": "2205680"
  },
  {
    "text": "these will be covered a bit more later on and the same has been done for Docker machine so in if you also remember the",
    "start": "2205680",
    "end": "2213040"
  },
  {
    "text": "make generate command so that has generated the anything with Z",
    "start": "2213040",
    "end": "2219000"
  },
  {
    "text": "zcore that is autogenerated by that make generate command and it and the underlying code generation tools so if",
    "start": "2219000",
    "end": "2225599"
  },
  {
    "text": "you see see those you don't need to do any modifications to any files with z z",
    "start": "2225599",
    "end": "2234000"
  },
  {
    "text": "underscore as well as creating the API definitions we said yes to creating the",
    "start": "2235760",
    "end": "2241640"
  },
  {
    "text": "controllers so these live in the controllers folder and again there is one for each of of the apis that we",
    "start": "2241640",
    "end": "2249040"
  },
  {
    "text": "created so One controller for dock machine and for cluster again I'm not going to go into",
    "start": "2249040",
    "end": "2255200"
  },
  {
    "text": "too much details here but you can see",
    "start": "2255200",
    "end": "2261040"
  },
  {
    "text": "to is it yeah but col is have theule yeah I don't know what to do",
    "start": "2261040",
    "end": "2267800"
  },
  {
    "text": "about the link is in there can the",
    "start": "2267800",
    "end": "2273280"
  },
  {
    "text": "screen yeah yeah is",
    "start": "2276040",
    "end": "2283359"
  },
  {
    "text": "it okay yeah is it because",
    "start": "2283440",
    "end": "2290680"
  },
  {
    "text": "it's hazy or it's okay yeah I think the contrast",
    "start": "2290680",
    "end": "2297560"
  },
  {
    "text": "is a little bit hard to see but yeah yeah okay um so yeah so it has generated",
    "start": "2297560",
    "end": "2304359"
  },
  {
    "text": "controllers for us it scaffolded so mentioned earlier about the CU Builder",
    "start": "2304359",
    "end": "2309760"
  },
  {
    "text": "comments so you can see some examples here and this is where you can spe add C",
    "start": "2309760",
    "end": "2315640"
  },
  {
    "text": "builder comments to your code and specifically here around arbac and when",
    "start": "2315640",
    "end": "2320839"
  },
  {
    "text": "you do the make manifests it goes through the code and it sees comments like this and it",
    "start": "2320839",
    "end": "2326800"
  },
  {
    "text": "generates um arbac uh definitions for us and there's various other forms of these",
    "start": "2326800",
    "end": "2332760"
  },
  {
    "text": "these comments throughout the code so that moves on to the config section so this is where Cube Builder has spent out",
    "start": "2332760",
    "end": "2340520"
  },
  {
    "text": "a whole bunch of kubernetes yaml for our provider uh we will be making changes to",
    "start": "2340520",
    "end": "2346520"
  },
  {
    "text": "this and some of this is influenced by these comments in the",
    "start": "2346520",
    "end": "2353559"
  },
  {
    "text": "code that's probably pretty much um I'm going to walk through on this you know",
    "start": "2355359",
    "end": "2361240"
  },
  {
    "text": "the code um but you know there's usual other stuff one thing also to know is the project file here and this is a cube",
    "start": "2361240",
    "end": "2367960"
  },
  {
    "text": "Builder thing where it records everything that is created for you just so you",
    "start": "2367960",
    "end": "2374720"
  },
  {
    "text": "know",
    "start": "2376160",
    "end": "2379160"
  },
  {
    "text": "right so there is one small change that we want to do at this stage from the autogenerated code is to change the port",
    "start": "2381520",
    "end": "2390839"
  },
  {
    "text": "number of the health end point so it has generated it with the port number of 8081",
    "start": "2390839",
    "end": "2397560"
  },
  {
    "text": "um we just need to change that to 9440 so what you'll need to do is go to",
    "start": "2397560",
    "end": "2405079"
  },
  {
    "text": "the main find the health prob bind address",
    "start": "2405079",
    "end": "2410400"
  },
  {
    "text": "and you'll see it is 8081 just change that to",
    "start": "2410400",
    "end": "2416319"
  },
  {
    "text": "9440 and save and this is mainly because we are",
    "start": "2416319",
    "end": "2423000"
  },
  {
    "text": "simplifying the artifacts and deleting some of the um artifacts that are used",
    "start": "2423000",
    "end": "2428480"
  },
  {
    "text": "by customize where it's using a different port",
    "start": "2428480",
    "end": "2434599"
  },
  {
    "text": "number so that's pretty much the scaffold in so we've scaffolded the code we've got the you know the Bare Bones",
    "start": "2434599",
    "end": "2441440"
  },
  {
    "text": "for our API and our controllers so now we can move",
    "start": "2441440",
    "end": "2446000"
  },
  {
    "text": "on so before we actually get to implementing the controllers and the API definitions uh we want to cover",
    "start": "2447400",
    "end": "2454599"
  },
  {
    "text": "something called tilt so as anyone used tilt nice",
    "start": "2454599",
    "end": "2461040"
  },
  {
    "text": "good yeah it's a real quality of life uh Improvement um before tilt it was just",
    "start": "2461040",
    "end": "2468440"
  },
  {
    "text": "so painful to to run your your controllers and and debug them um and",
    "start": "2468440",
    "end": "2475520"
  },
  {
    "text": "the the cppy contributors have really put a lot of work into their tilt file",
    "start": "2475520",
    "end": "2480960"
  },
  {
    "text": "and it has a lot of features within it that is really really helpful so to give",
    "start": "2480960",
    "end": "2487400"
  },
  {
    "text": "example and then we'll be going through this you have the option to start your",
    "start": "2487400",
    "end": "2492440"
  },
  {
    "text": "controllers via delve and then so you can just set a connect and set a break",
    "start": "2492440",
    "end": "2498319"
  },
  {
    "text": "point and debug your controller within the",
    "start": "2498319",
    "end": "2502520"
  },
  {
    "text": "cluster so for your provider to be usable via the Upstream capy tilt file",
    "start": "2503720",
    "end": "2512160"
  },
  {
    "text": "you need to tell that tilt file about your provider",
    "start": "2512160",
    "end": "2517280"
  },
  {
    "text": "and this is done via a file in the root of your repo called uh tilt hyen",
    "start": "2517280",
    "end": "2523440"
  },
  {
    "text": "provider and this just gives various information to to the Cappy tilt file",
    "start": "2523440",
    "end": "2529359"
  },
  {
    "text": "about your provider so we're going to create this file now",
    "start": "2529359",
    "end": "2535960"
  },
  {
    "text": "so I'm going to have to",
    "start": "2535960",
    "end": "2540599"
  },
  {
    "text": "spe uped",
    "start": "2550640",
    "end": "2554640"
  },
  {
    "text": "up yeah cool so I am just going to clone the",
    "start": "2557800",
    "end": "2563760"
  },
  {
    "text": "repo so we don't have to create all of the files on",
    "start": "2563760",
    "end": "2567880"
  },
  {
    "text": "here yeah so if you want to do that as well um it's up to you or you can carry on going through the",
    "start": "2572680",
    "end": "2578960"
  },
  {
    "text": "instructions and building it",
    "start": "2578960",
    "end": "2582599"
  },
  {
    "text": "yourself so we were just on the Tilt so in instructions you're going to create a tilt provider file um in the RO of your",
    "start": "2595520",
    "end": "2602760"
  },
  {
    "text": "repo so it's going to look like this so hopefully you can see that",
    "start": "2602760",
    "end": "2608680"
  },
  {
    "text": "so there a few things you need to be aware of in this in this file number one is the name so this is the name that",
    "start": "2608760",
    "end": "2615720"
  },
  {
    "text": "you're going to use with cluster cutle later on when you say you want to install this provider into your cluster",
    "start": "2615720",
    "end": "2621960"
  },
  {
    "text": "so choose a name that represents your provider the next is the image so this",
    "start": "2621960",
    "end": "2629079"
  },
  {
    "text": "is important the image you specify here you have to also use that within your",
    "start": "2629079",
    "end": "2634680"
  },
  {
    "text": "manifest definitions for your controller within the deployment if they don't match when you run tilt it's not going",
    "start": "2634680",
    "end": "2641880"
  },
  {
    "text": "to replace the image with your locally built one and so you're going to have",
    "start": "2641880",
    "end": "2649640"
  },
  {
    "text": "issues and then it's the live reloads uh section so you can specify folders and",
    "start": "2649640",
    "end": "2656040"
  },
  {
    "text": "files that you want tilt to watch and if there's any changes to those files tilt",
    "start": "2656040",
    "end": "2661839"
  },
  {
    "text": "will essentially recompile your uh provider and redeploy it into your cluster so you you can get into this",
    "start": "2661839",
    "end": "2668800"
  },
  {
    "text": "iterative development cycle so on every change it builds and redeploys for",
    "start": "2668800",
    "end": "2675838"
  },
  {
    "text": "you in the instructions there are some various other com um tasks around just",
    "start": "2675880",
    "end": "2683599"
  },
  {
    "text": "making changes to the the kubernetes manifests so you'll need to do those but",
    "start": "2683599",
    "end": "2691520"
  },
  {
    "text": "essentially if you do all of that",
    "start": "2691520",
    "end": "2696160"
  },
  {
    "text": "you get to the point where you can create a kind",
    "start": "2703480",
    "end": "2709599"
  },
  {
    "text": "cluster you can have to use a specific kind configuration here and this is",
    "start": "2709599",
    "end": "2715480"
  },
  {
    "text": "because you need to pass in the docker socket from your host machine into kind",
    "start": "2715480",
    "end": "2720559"
  },
  {
    "text": "so that it can then be used uh via your provider",
    "start": "2720559",
    "end": "2725839"
  },
  {
    "text": "so if we go to the",
    "start": "2727839",
    "end": "2730960"
  },
  {
    "text": "instructions so it's going to ask you to do a whole bunch of stuff with the",
    "start": "2733160",
    "end": "2738920"
  },
  {
    "text": "manifests and then it's going to ask you to create a tilt settings file in the",
    "start": "2741359",
    "end": "2747319"
  },
  {
    "text": "cluster API folder now this is the thing that when you run tilt and it interprets",
    "start": "2747319",
    "end": "2754280"
  },
  {
    "text": "the cabby tilt file it knows to locate your provider so you'll see at the",
    "start": "2754280",
    "end": "2759760"
  },
  {
    "text": "top um a reference to your provider so the repost so you'll see in here it's a",
    "start": "2759760",
    "end": "2765359"
  },
  {
    "text": "relative um location so you need to make sure that is right so that that's what will tell",
    "start": "2765359",
    "end": "2772280"
  },
  {
    "text": "tell to to load your provider along with the Tilt provider set file that you've",
    "start": "2772280",
    "end": "2777599"
  },
  {
    "text": "just created and there's a few other things you can do within the settings so if you want to enable experimental",
    "start": "2777599",
    "end": "2784119"
  },
  {
    "text": "features in your provider or within Cappy you can set the environment variables here to enable those features",
    "start": "2784119",
    "end": "2791240"
  },
  {
    "text": "likewise you can override the arguments for your controller so a common usage of",
    "start": "2791240",
    "end": "2796520"
  },
  {
    "text": "this is to increase the login level so you get Trace messages uh as opposed to",
    "start": "2796520",
    "end": "2802640"
  },
  {
    "text": "just informational messages like normal and then the really like magical",
    "start": "2802640",
    "end": "2808800"
  },
  {
    "text": "part from from implementing your provider is the debug section down the bottom here if you have a if you had had",
    "start": "2808800",
    "end": "2815240"
  },
  {
    "text": "this debug section and you add it for your provider so you you'll see in this",
    "start": "2815240",
    "end": "2821280"
  },
  {
    "text": "um in this instance the um debug and then the docker hyphen cubec section in",
    "start": "2821280",
    "end": "2827480"
  },
  {
    "text": "there that's specific to my provider and what I'm what it's basically saying is when you run my provider in in um in the",
    "start": "2827480",
    "end": "2834640"
  },
  {
    "text": "cluster start my provider via delve and make it listen on the port specified",
    "start": "2834640",
    "end": "2840359"
  },
  {
    "text": "here so you can then just use vs code create a launch configuration and set a",
    "start": "2840359",
    "end": "2846000"
  },
  {
    "text": "break point and ATT ATT to your provider and start debugging",
    "start": "2846000",
    "end": "2851318"
  },
  {
    "text": "it so after you've done that it's going to like I said you're going to have to",
    "start": "2852720",
    "end": "2858359"
  },
  {
    "text": "use a specific configuration file when you're creating your kind cluster now your kind cluster is going to act as",
    "start": "2858359",
    "end": "2864839"
  },
  {
    "text": "your management cluster in this instance and this is just to pass in the docker socket like I said so I'm going to do",
    "start": "2864839",
    "end": "2870480"
  },
  {
    "text": "that now so that will run",
    "start": "2870480",
    "end": "2877200"
  },
  {
    "text": "maybe start sometime soon once you've done",
    "start": "2891720",
    "end": "2896920"
  },
  {
    "text": "that you can do tilt up and you press",
    "start": "2896920",
    "end": "2902800"
  },
  {
    "text": "it that's not good start",
    "start": "2902800",
    "end": "2907359"
  },
  {
    "text": "so that's what will happen if you put in the wrong path it will fail to start with tilt and you'll get a big red",
    "start": "2929799",
    "end": "2935720"
  },
  {
    "text": "message so if I change that to Cy sample so I'm going to use the reference",
    "start": "2935720",
    "end": "2943040"
  },
  {
    "text": "implementation it should be a lot happier now when I",
    "start": "2943040",
    "end": "2948319"
  },
  {
    "text": "started so this will take some time what you'll see in a minute is on the left hand side as it enables and installs the",
    "start": "2951240",
    "end": "2959119"
  },
  {
    "text": "compiles and installs the providers um you'll see them appear on the left hand",
    "start": "2959119",
    "end": "2964520"
  },
  {
    "text": "side into various groups so groups and by provider type um but also by you know binaries",
    "start": "2964520",
    "end": "2972640"
  },
  {
    "text": "and controllers as a",
    "start": "2972640",
    "end": "2975640"
  },
  {
    "text": "whole so whilst it's doing that whil it's starting up so because we added the",
    "start": "2978680",
    "end": "2984400"
  },
  {
    "text": "debug section if you wanted to um you could actually then create a",
    "start": "2984400",
    "end": "2992720"
  },
  {
    "text": "if you're using V code or something else you can do the same in goand or on the command line if you create",
    "start": "2992720",
    "end": "2999440"
  },
  {
    "text": "a launch configuration for go say connect to",
    "start": "2999440",
    "end": "3006079"
  },
  {
    "text": "server and then you'll have to give it to the same port as you put into the Tilt settings file which I think was",
    "start": "3008480",
    "end": "3017200"
  },
  {
    "text": "31,000 so at that point you should be able",
    "start": "3017200",
    "end": "3023240"
  },
  {
    "text": "to set a break point within your controllers if you want to for",
    "start": "3023240",
    "end": "3029480"
  },
  {
    "text": "example there we go and then start the debugger and it will hit the break point",
    "start": "3031480",
    "end": "3037160"
  },
  {
    "text": "I'm not going to do that now because we will cover that later",
    "start": "3037160",
    "end": "3042640"
  },
  {
    "text": "on so you can see now that all of the providers have started on the left hand side and you should see",
    "start": "3042920",
    "end": "3051520"
  },
  {
    "text": "our Docker provider there as well so if you do all this",
    "start": "3051960",
    "end": "3057920"
  },
  {
    "text": "this is what will happen for you um yeah if you",
    "start": "3057920",
    "end": "3063200"
  },
  {
    "text": "change any of the files it will then reload it for you so I think we're done with that",
    "start": "3063200",
    "end": "3071319"
  },
  {
    "text": "section so now you can get to the real implementation which AE will",
    "start": "3072760",
    "end": "3079599"
  },
  {
    "text": "do people need more time to uh run the run your tip",
    "start": "3079720",
    "end": "3087520"
  },
  {
    "text": "hi no everyone's good testing you need time yeah yeah let's",
    "start": "3091280",
    "end": "3097040"
  },
  {
    "text": "let's give five minutes because it it's extra a lot of things yeah",
    "start": "3097040",
    "end": "3105079"
  },
  {
    "text": "yeah yeah we need to keep people timeing",
    "start": "3106960",
    "end": "3111799"
  },
  {
    "text": "yeah because like one person was like trying to create kind cluster it those",
    "start": "3113240",
    "end": "3118599"
  },
  {
    "text": "are taking forever yeah yeah",
    "start": "3118599",
    "end": "3125240"
  },
  {
    "text": "yeah you know like tutorial is like we give people time to do it this",
    "start": "3155319",
    "end": "3163240"
  },
  {
    "text": "do you all need some more time or can we",
    "start": "3188359",
    "end": "3192759"
  },
  {
    "text": "proceed okay give a couple more minutes",
    "start": "3201079",
    "end": "3206280"
  },
  {
    "text": "we 25 minutes meeting we we have 35 minut meeting",
    "start": "3231079",
    "end": "3238440"
  },
  {
    "text": "keep going okay so we're going to work on the",
    "start": "3238440",
    "end": "3244440"
  },
  {
    "text": "docker cluster uh resource now I'll go through it with you in the",
    "start": "3244440",
    "end": "3251640"
  },
  {
    "text": "tutorial I recommend you not to copy and paste all the lines of code right now uh",
    "start": "3251640",
    "end": "3259119"
  },
  {
    "text": "you can kind of look along in the Cappy samples",
    "start": "3259119",
    "end": "3264720"
  },
  {
    "text": "repo but I think it'll be more valuable for you to kind of understand what we're",
    "start": "3264720",
    "end": "3270599"
  },
  {
    "text": "doing rather than typing it all out right now um so basically when we're",
    "start": "3270599",
    "end": "3278799"
  },
  {
    "text": "implementing Docker cluster what makes it different than any other controller any other API is that",
    "start": "3278799",
    "end": "3286920"
  },
  {
    "text": "we have to adhere to the specification to the contract that we have with",
    "start": "3286920",
    "end": "3292480"
  },
  {
    "text": "cluster API itself so you can see here a bit of uh",
    "start": "3292480",
    "end": "3299079"
  },
  {
    "text": "overview we can see that it's telling us that we must have a spec with control",
    "start": "3299079",
    "end": "3305559"
  },
  {
    "text": "plane endpoint in it and we must have a status with ready",
    "start": "3305559",
    "end": "3312440"
  },
  {
    "text": "as a Boolean and it also has some optional fields that we can",
    "start": "3312440",
    "end": "3318920"
  },
  {
    "text": "add um this is part of the What's called the cluster API book highly recommended",
    "start": "3318920",
    "end": "3325200"
  },
  {
    "text": "reference uh um it has some more details in here if you go along on your own time",
    "start": "3325200",
    "end": "3331119"
  },
  {
    "text": "including a flowchart of what a typical controller would",
    "start": "3331119",
    "end": "3336400"
  },
  {
    "text": "do um for our example as Richard and",
    "start": "3337280",
    "end": "3343640"
  },
  {
    "text": "anusa mentioned we're going to be implementing machines as Docker",
    "start": "3343640",
    "end": "3349760"
  },
  {
    "text": "containers so each machine that we bring up will be a Docker container both for control plane and for workers",
    "start": "3349760",
    "end": "3358240"
  },
  {
    "text": "and because we have we're going to have three control plane nodes right for",
    "start": "3358559",
    "end": "3364640"
  },
  {
    "text": "implemented as Docker containers we need a load balancer to sit in front of them and direct the API traffic to those",
    "start": "3364640",
    "end": "3371960"
  },
  {
    "text": "three control plane notes so that's the main work that our",
    "start": "3371960",
    "end": "3378000"
  },
  {
    "text": "uh Docker cluster controller is going to do so the first thing we're going to do",
    "start": "3378000",
    "end": "3385799"
  },
  {
    "text": "is Define the docker cluster API so as part of the scaffolding that you did in",
    "start": "3385799",
    "end": "3391079"
  },
  {
    "text": "step three we got you know just some empty kind of file not empty but you",
    "start": "3391079",
    "end": "3399160"
  },
  {
    "text": "know just the basics there's a in the spec there's a foo string in there you",
    "start": "3399160",
    "end": "3405559"
  },
  {
    "text": "can delete that and we're going to put in the control plane endpoint that the",
    "start": "3405559",
    "end": "3411079"
  },
  {
    "text": "specification requires of us and in the status we're going to to",
    "start": "3411079",
    "end": "3417079"
  },
  {
    "text": "put in the ready ready is something that Cappy itself is going to look at and once it's",
    "start": "3417079",
    "end": "3424720"
  },
  {
    "text": "true it knows that all the infrastructure is ready and it can",
    "start": "3424720",
    "end": "3429838"
  },
  {
    "text": "proceed in addition in the spec we have uh the load balancer image which you can",
    "start": "3431559",
    "end": "3439799"
  },
  {
    "text": "uh users can use to optionally override and we have a finalizer uh for",
    "start": "3439799",
    "end": "3446440"
  },
  {
    "text": "those of you not familiar a finalizer if it's placed on a resource",
    "start": "3446440",
    "end": "3451640"
  },
  {
    "text": "it means that the resource won't be deleted as long as that finalizer is there",
    "start": "3451640",
    "end": "3457760"
  },
  {
    "text": "so if a user goes and tries to delete the the docker",
    "start": "3457760",
    "end": "3465280"
  },
  {
    "text": "cluster uh kubernetes won't allow it the controller that we're going to implement",
    "start": "3465280",
    "end": "3471480"
  },
  {
    "text": "now we'll see that that Docker cluster is being deleted",
    "start": "3471480",
    "end": "3476640"
  },
  {
    "text": "it'll clean up the infrastructure mainly the load balancer and then the",
    "start": "3476640",
    "end": "3481680"
  },
  {
    "text": "controller will remove the finalizer once everything is cleaned up and then kubernetes can go ahead and delete the",
    "start": "3481680",
    "end": "3488720"
  },
  {
    "text": "docker cluster so if you did that yourself or",
    "start": "3488720",
    "end": "3494760"
  },
  {
    "text": "if you're using the example you would run out make generate make manifests and",
    "start": "3494760",
    "end": "3500119"
  },
  {
    "text": "that would update all of the generated scaffolding that we did at the beginning",
    "start": "3500119",
    "end": "3505280"
  },
  {
    "text": "to reflect those changes and now we'll look at the",
    "start": "3505280",
    "end": "3513280"
  },
  {
    "text": "controller itself that's in the file uh controllers Docker cluster",
    "start": "3513280",
    "end": "3522680"
  },
  {
    "text": "controller and the reconcile method so for those of you who are new to",
    "start": "3522920",
    "end": "3528240"
  },
  {
    "text": "controllers basically kubernetes will call this reconcile method every time",
    "start": "3528240",
    "end": "3536160"
  },
  {
    "text": "something changes okay what is that something by default it'll be only",
    "start": "3536160",
    "end": "3542280"
  },
  {
    "text": "Docker cluster I'll skip down a",
    "start": "3542280",
    "end": "3548640"
  },
  {
    "text": "bit so if you look at the setup with manager function this defines exactly",
    "start": "3556200",
    "end": "3563440"
  },
  {
    "text": "when the reconcile function will be called so so it's going to be called for",
    "start": "3563440",
    "end": "3569400"
  },
  {
    "text": "Docker cluster and for your own uh controllers",
    "start": "3569400",
    "end": "3575880"
  },
  {
    "text": "you'll see it with the docker machine cluster in a bit you can also watch",
    "start": "3575880",
    "end": "3582280"
  },
  {
    "text": "other other resources and you have to make sure that",
    "start": "3582280",
    "end": "3587920"
  },
  {
    "text": "your reconcile function is going to be called whenever it needs to be okay if",
    "start": "3587920",
    "end": "3593319"
  },
  {
    "text": "you're missing something if you're not watching the proper resources kubernetes",
    "start": "3593319",
    "end": "3599680"
  },
  {
    "text": "won't know to call your reconcile function and then things won't",
    "start": "3599680",
    "end": "3605838"
  },
  {
    "text": "happen Okay so we're going to implement so we're going to create the docker",
    "start": "3610559",
    "end": "3615960"
  },
  {
    "text": "cluster reconciler struct uh initialize the logger",
    "start": "3615960",
    "end": "3621079"
  },
  {
    "text": "initialize the context",
    "start": "3621079",
    "end": "3625200"
  },
  {
    "text": "Imports and let's get to the real work so the",
    "start": "3627440",
    "end": "3632920"
  },
  {
    "text": "first thing we do we got our reconcile function got called we don't know for what yet so the",
    "start": "3632920",
    "end": "3641039"
  },
  {
    "text": "first thing we need to do is to fetch the docker cluster instance that was",
    "start": "3641039",
    "end": "3646160"
  },
  {
    "text": "modified right so our reconcile is going to be called whenever Docker cluster is",
    "start": "3646160",
    "end": "3652240"
  },
  {
    "text": "modified or at some other points for example if we returned an error then",
    "start": "3652240",
    "end": "3659319"
  },
  {
    "text": "we'll get called again at a later point in time to try again uh if we return for",
    "start": "3659319",
    "end": "3665960"
  },
  {
    "text": "example recue we told kubernetes to recue us then we'll get called but it's",
    "start": "3665960",
    "end": "3672920"
  },
  {
    "text": "generally C when a Docker cluster uh instance is",
    "start": "3672920",
    "end": "3678799"
  },
  {
    "text": "modified so we fetch that Docker cluster next we get the Cappy cluster",
    "start": "3678799",
    "end": "3685760"
  },
  {
    "text": "that that owns this Docker cluster so there's a utility that makes",
    "start": "3685760",
    "end": "3691280"
  },
  {
    "text": "that easy for US based on the owner reference now if we got an error so this",
    "start": "3691280",
    "end": "3698839"
  },
  {
    "text": "is all part of the controller convention we got an error we return the error and",
    "start": "3698839",
    "end": "3703880"
  },
  {
    "text": "that will recue and call the reconcile function again at a later time and if the cluster is n we it",
    "start": "3703880",
    "end": "3713000"
  },
  {
    "text": "wasn't set yet so we just return and we'll try again",
    "start": "3713000",
    "end": "3719278"
  },
  {
    "text": "later we might have an annotation is paused um that can so if for example",
    "start": "3724279",
    "end": "3733160"
  },
  {
    "text": "cluster CTL move will pause the cluster so we're just not going to do anything",
    "start": "3733160",
    "end": "3738640"
  },
  {
    "text": "right now because it's paused so we return and now finally after all that",
    "start": "3738640",
    "end": "3745400"
  },
  {
    "text": "initial ization stuff we can do what we set out to do which is create a load balancer so we create",
    "start": "3745400",
    "end": "3753200"
  },
  {
    "text": "this we create the load balancer uh object we create a patch Helper",
    "start": "3753200",
    "end": "3762400"
  },
  {
    "text": "because as you're all familiar with every time a controller does something",
    "start": "3762400",
    "end": "3768119"
  },
  {
    "text": "it should update the status of the resource so this patch helper is going",
    "start": "3768119",
    "end": "3773640"
  },
  {
    "text": "to do that for us and and we have a defer so anytime we return from now on",
    "start": "3773640",
    "end": "3781200"
  },
  {
    "text": "we're going to patch the resource which means updating it in at",
    "start": "3781200",
    "end": "3788480"
  },
  {
    "text": "CD and now we're basically kind of have a fork in the logic so",
    "start": "3790039",
    "end": "3796760"
  },
  {
    "text": "if we're detecting that the uh Docker cluster instance was deleted we do that",
    "start": "3796760",
    "end": "3803920"
  },
  {
    "text": "by checking if the Tim stamp is not zero then we're going to call a function called reconcile",
    "start": "3803920",
    "end": "3810720"
  },
  {
    "text": "delete and if it was not deleted we'll call a function called reconcile",
    "start": "3810720",
    "end": "3818559"
  },
  {
    "text": "normal okay so we Define those two functions and let's look at what",
    "start": "3818559",
    "end": "3825559"
  },
  {
    "text": "reconcile normal does so again we set up the",
    "start": "3825559",
    "end": "3830760"
  },
  {
    "text": "logging um the first thing we do if we check if the do cluster instance already",
    "start": "3830760",
    "end": "3837880"
  },
  {
    "text": "has the finalizer that we talked about earlier if not we add",
    "start": "3837880",
    "end": "3843359"
  },
  {
    "text": "it and then we return with recq true so we add the finalizer and then we come",
    "start": "3843359",
    "end": "3849440"
  },
  {
    "text": "back to and a reconcile function will be called",
    "start": "3849440",
    "end": "3855400"
  },
  {
    "text": "again uh an important thing to note here a reconcile function it's always",
    "start": "3856880",
    "end": "3863240"
  },
  {
    "text": "taking a look at the spec taking a look at the real world and making the real",
    "start": "3863240",
    "end": "3869960"
  },
  {
    "text": "world match the spec and then uh displaying in the status the status",
    "start": "3869960",
    "end": "3877680"
  },
  {
    "text": "of that real world right so it has to be ad imp potent anytime don't assume that",
    "start": "3877680",
    "end": "3884559"
  },
  {
    "text": "you know your reconcile function got cold earlier don't assume that it wasn't cold earlier you really have to check",
    "start": "3884559",
    "end": "3890920"
  },
  {
    "text": "and make sure that it's totally item potent",
    "start": "3890920",
    "end": "3896680"
  },
  {
    "text": "so that's why we're going to now create the actual load",
    "start": "3897640",
    "end": "3904480"
  },
  {
    "text": "balancer and get the IP from IP of",
    "start": "3904480",
    "end": "3911160"
  },
  {
    "text": "that so lb IP we'll have the IP of the load balancer and then we put that IP",
    "start": "3911799",
    "end": "3919720"
  },
  {
    "text": "and the port into the spec. control plane endpoint",
    "start": "3919720",
    "end": "3926680"
  },
  {
    "text": "finally once we do that we set status. ready and we can return remember we had",
    "start": "3927559",
    "end": "3934240"
  },
  {
    "text": "that defer function uh earlier so it'll patch the docker cluster",
    "start": "3934240",
    "end": "3941079"
  },
  {
    "text": "instance and we're good to [Music] go the next thing we do for delete I'm",
    "start": "3941079",
    "end": "3949079"
  },
  {
    "text": "not going to go through it in detail but we're going to delete the load balancer",
    "start": "3949079",
    "end": "3954440"
  },
  {
    "text": "right so we got the docker cluster instance was deleted we delete the",
    "start": "3954440",
    "end": "3960799"
  },
  {
    "text": "instance and we remove the finalizer so that the instance will actually be",
    "start": "3960799",
    "end": "3967039"
  },
  {
    "text": "deleted and that's pretty much it for",
    "start": "3967039",
    "end": "3973520"
  },
  {
    "text": "this um oh I'm sorry one thing I missed",
    "start": "3973520",
    "end": "3978799"
  },
  {
    "text": "earlier about the setup with manager so we're watching the docker cluster but",
    "start": "3978799",
    "end": "3985319"
  },
  {
    "text": "we're also watching cppy cluster and not all of the Cappy",
    "start": "3985319",
    "end": "3991799"
  },
  {
    "text": "clusters if you look at it's it's watching only the Cappy",
    "start": "3991799",
    "end": "3997720"
  },
  {
    "text": "clusters who have a kind who are pointing to Docker",
    "start": "3997720",
    "end": "4004160"
  },
  {
    "text": "clusters it's important to and when you're watching to kind of filter out as much as you can for example if you're",
    "start": "4004559",
    "end": "4011160"
  },
  {
    "text": "watching if you need to watch secrets for Secrets changing don't watch all the secrets in in your entire system it's",
    "start": "4011160",
    "end": "4017920"
  },
  {
    "text": "going to take forever so maybe watch in a specific name space or by label or",
    "start": "4017920",
    "end": "4023880"
  },
  {
    "text": "something like that and again once you're finished all",
    "start": "4023880",
    "end": "4031599"
  },
  {
    "text": "that make build uh make manifest make build so that everything you just did",
    "start": "4031599",
    "end": "4038000"
  },
  {
    "text": "will take effect okay the next thing we're going",
    "start": "4038000",
    "end": "4044960"
  },
  {
    "text": "to do is the machine Docker machine I'll hopefully go through this a bit",
    "start": "4044960",
    "end": "4050960"
  },
  {
    "text": "quicker um the API has a provider id that's according to the contract that's",
    "start": "4050960",
    "end": "4058640"
  },
  {
    "text": "a unique ID which will be a reference to this machine it has",
    "start": "4058640",
    "end": "4065400"
  },
  {
    "text": "the the the ready Boolean just like the cluster did and it has addresses which",
    "start": "4065400",
    "end": "4071480"
  },
  {
    "text": "will contain the IP addresses for this machine and just like the cluster we have a",
    "start": "4071480",
    "end": "4078480"
  },
  {
    "text": "machine finalizer and after you finish defining your API make generate make manifest as",
    "start": "4078480",
    "end": "4087000"
  },
  {
    "text": "usual okay so what are we doing here um users aren't creating machines",
    "start": "4087000",
    "end": "4094599"
  },
  {
    "text": "directly when you create uh your cluster definition you typically will create a",
    "start": "4094599",
    "end": "4100199"
  },
  {
    "text": "machine deployment which is similar to deployment that you might be familiar",
    "start": "4100199",
    "end": "4105960"
  },
  {
    "text": "with with pods which among other things has account count of how many machines should exist and it has a Docker machine",
    "start": "4105960",
    "end": "4114199"
  },
  {
    "text": "template which will tell cluster API how to create each individual Docker machine",
    "start": "4114199",
    "end": "4120000"
  },
  {
    "text": "Docker machine okay so what does the reconcile",
    "start": "4120000",
    "end": "4128278"
  },
  {
    "text": "here look like",
    "start": "4128279",
    "end": "4131838"
  },
  {
    "text": "the first thing it'll check is if cluster so excuse me first we're going",
    "start": "4139199",
    "end": "4145679"
  },
  {
    "text": "to do all the you know getting the machine getting the cluster and so on I'm not going to",
    "start": "4145679",
    "end": "4153600"
  },
  {
    "text": "go into that here in this step you can see it in the in the GitHub of the cppy",
    "start": "4153600",
    "end": "4159880"
  },
  {
    "text": "sample so assume we already got the docker machine we got the docker cluster we got the",
    "start": "4159880",
    "end": "4165880"
  },
  {
    "text": "cppy machine we got the cppy cluster we got all of that and now we're going to",
    "start": "4165880",
    "end": "4172758"
  },
  {
    "text": "check if the status of the clust if cluster status infrastructure ready is",
    "start": "4172759",
    "end": "4179798"
  },
  {
    "text": "false we don't have anything to do at this point we're waiting for that infrastructure to come",
    "start": "4179799",
    "end": "4186920"
  },
  {
    "text": "up if the machine already has a provider id that means we have no work left to do",
    "start": "4187239",
    "end": "4193520"
  },
  {
    "text": "we probably just uh we're missing the status that ready so we set it and",
    "start": "4193520",
    "end": "4201600"
  },
  {
    "text": "return okay now we want to do the actual work to do that we need a",
    "start": "4201600",
    "end": "4208000"
  },
  {
    "text": "bootstrap okay if if we don't have the bootstrap data",
    "start": "4208000",
    "end": "4213719"
  },
  {
    "text": "we're going to return the bootstrap data is basically what will turn that simple",
    "start": "4213719",
    "end": "4219679"
  },
  {
    "text": "Docker container into a kubernetes node okay so it has all of the instructions",
    "start": "4219679",
    "end": "4225360"
  },
  {
    "text": "to do that uh either in Cloud init or ignition format and if you're doing it with a",
    "start": "4225360",
    "end": "4232800"
  },
  {
    "text": "cloud provider then the cloud provider will typically execute the uh Cloud init",
    "start": "4232800",
    "end": "4238719"
  },
  {
    "text": "or ignition for you here because we're Docker we don't",
    "start": "4238719",
    "end": "4243880"
  },
  {
    "text": "have that luxury we're going to actually execute it ourselves in the",
    "start": "4243880",
    "end": "4250440"
  },
  {
    "text": "code okay so we check external machines exist if",
    "start": "4250440",
    "end": "4256199"
  },
  {
    "text": "if the external machine meaning the docker container that we want to create now doesn't exist yet we create",
    "start": "4256199",
    "end": "4263199"
  },
  {
    "text": "it and now that we created the docker",
    "start": "4263199",
    "end": "4268560"
  },
  {
    "text": "container we're checking if it's a control plane machine and we haven't yet configured",
    "start": "4268560",
    "end": "4274800"
  },
  {
    "text": "the load balancer for this machine then we update the configuration of the load balancer so that it'll point to this",
    "start": "4274800",
    "end": "4282159"
  },
  {
    "text": "Ducker container that we just created and if we did that then we set status.",
    "start": "4282159",
    "end": "4289400"
  },
  {
    "text": "load balancer configure to true and we can move on now we check if the machine was if",
    "start": "4289400",
    "end": "4297840"
  },
  {
    "text": "the docker machine has been bootstrapped already if not then we do what I",
    "start": "4297840",
    "end": "4303679"
  },
  {
    "text": "mentioned we're going to get the bootstrap data that's with a helper function and",
    "start": "4303679",
    "end": "4310639"
  },
  {
    "text": "then exec bootstrap and that's basically just going to execute all those command commands one by one in the docker",
    "start": "4310639",
    "end": "4319280"
  },
  {
    "text": "container you can see the get bootstrap data function",
    "start": "4319280",
    "end": "4325600"
  },
  {
    "text": "here now we get the IP address of the docker container and set",
    "start": "4326679",
    "end": "4333760"
  },
  {
    "text": "it um set it in the status",
    "start": "4333760",
    "end": "4339760"
  },
  {
    "text": "okay the next this next thing that we need to do is a bit uh of an implementation detail",
    "start": "4349800",
    "end": "4356679"
  },
  {
    "text": "but it's important we're setting the provider",
    "start": "4356679",
    "end": "4362080"
  },
  {
    "text": "id okay the provider id is what I mentioned it's a unique identifier for",
    "start": "4362080",
    "end": "4367320"
  },
  {
    "text": "this machine we're setting it on the docker machine it'll be copied to the Cy",
    "start": "4367320",
    "end": "4373719"
  },
  {
    "text": "machine and it has and it will be set on the Node in the cluster that we're",
    "start": "4373719",
    "end": "4380480"
  },
  {
    "text": "creating and it we have to make sure that the provider id on the machine and",
    "start": "4380480",
    "end": "4385840"
  },
  {
    "text": "the node match um it's important for things like Auto scaling so that capy can see okay",
    "start": "4385840",
    "end": "4393280"
  },
  {
    "text": "I'm now deleting this machine that corresponds to this node it's used uh",
    "start": "4393280",
    "end": "4398679"
  },
  {
    "text": "for CSR certificate signing request approval um so we're doing that manually",
    "start": "4398679",
    "end": "4406560"
  },
  {
    "text": "here we get the provider id we're setting it on",
    "start": "4406560",
    "end": "4413520"
  },
  {
    "text": "the we're we're setting it on the Node here and we're setting it in the spec.",
    "start": "4413520",
    "end": "4421719"
  },
  {
    "text": "provider id okay so at the end of this we have the node and the docker machine",
    "start": "4421719",
    "end": "4427920"
  },
  {
    "text": "having provider id set I can skip these details for now we",
    "start": "4427920",
    "end": "4437040"
  },
  {
    "text": "set status. ready to true and then the defer statement will patch the docker",
    "start": "4437040",
    "end": "4443840"
  },
  {
    "text": "machine instance for delete it's very similar to the delete of the docker cluster so we",
    "start": "4443840",
    "end": "4452159"
  },
  {
    "text": "delete the docker container we update the load balancer configuration if it's",
    "start": "4452159",
    "end": "4457280"
  },
  {
    "text": "a control plane to no longer point to this container we remove the finalizer",
    "start": "4457280",
    "end": "4463960"
  },
  {
    "text": "and we're done um the setup with manager here is very",
    "start": "4463960",
    "end": "4470840"
  },
  {
    "text": "similar to that of the docker cluster and not going to go into it right now and the last thing is the docker machine",
    "start": "4470840",
    "end": "4478440"
  },
  {
    "text": "template also not going to go into details right now because of time constraints you can see it in the Cappy",
    "start": "4478440",
    "end": "4484440"
  },
  {
    "text": "samples but basically it's just a new crd that's",
    "start": "4484440",
    "end": "4490159"
  },
  {
    "text": "pointing to the spec of the docker machine and",
    "start": "4490159",
    "end": "4495920"
  },
  {
    "text": "that way uh Kappy knows how to create uh",
    "start": "4495920",
    "end": "4501600"
  },
  {
    "text": "Docker machines when it needs to for cloud providers it might have things like you know amount of CPU cores amount",
    "start": "4501600",
    "end": "4508480"
  },
  {
    "text": "of ram things like that things that you want each of your specific machine to",
    "start": "4508480",
    "end": "4514080"
  },
  {
    "text": "have those properties",
    "start": "4514080",
    "end": "4519960"
  },
  {
    "text": "when yeah I I need to change the computer",
    "start": "4522320",
    "end": "4526960"
  },
  {
    "text": "so are you sure you have 15 minutes you have I don't know how",
    "start": "4528120",
    "end": "4535080"
  },
  {
    "text": "to create CH on that okay do you to do you want to go and we'll switch",
    "start": "4535080",
    "end": "4543638"
  },
  {
    "text": "it but I have them",
    "start": "4543719",
    "end": "4548560"
  },
  {
    "text": "here WR infrastructure provider",
    "start": "4550880",
    "end": "4556280"
  },
  {
    "text": "uh so uh in the capy samples repo we already have a cluster provider for",
    "start": "4557840",
    "end": "4563440"
  },
  {
    "text": "Docker um uploaded so if you all want if you like feel like you're not able to",
    "start": "4563440",
    "end": "4569239"
  },
  {
    "text": "catch up within the next few minutes feel free to like browse through the code and Vinnie will run through a demo",
    "start": "4569239",
    "end": "4575520"
  },
  {
    "text": "so it'll be easier to follow along and also uh the tutorial is live and the slack channel will be active for a few",
    "start": "4575520",
    "end": "4581920"
  },
  {
    "text": "more days after the session so feel free to ask us question questions over there",
    "start": "4581920",
    "end": "4586960"
  },
  {
    "text": "um yeah so I think the idea is to help you get started to writing a provider and also maybe you know uh get your",
    "start": "4586960",
    "end": "4594679"
  },
  {
    "text": "contributions to Cluster API and its providers you know uh you can get started with all of those so yeah okay",
    "start": "4594679",
    "end": "4602840"
  },
  {
    "text": "uh so we actually have a material on web books and also like releasing but we",
    "start": "4602840",
    "end": "4610120"
  },
  {
    "text": "have like only 13 minutes so I will not go through the adding webbook",
    "start": "4610120",
    "end": "4615679"
  },
  {
    "text": "but uh basically like CU Builder take care of all the logistics of creating",
    "start": "4615679",
    "end": "4621840"
  },
  {
    "text": "webook server and like providing the uh certificate and everything so just like",
    "start": "4621840",
    "end": "4627480"
  },
  {
    "text": "follow this along uh when when you have time after this this one so I just go to",
    "start": "4627480",
    "end": "4634199"
  },
  {
    "text": "a create cluster section so now we built the we we set we created API we um set",
    "start": "4634199",
    "end": "4642920"
  },
  {
    "text": "we actually wrote the controllers and we now want to actually create",
    "start": "4642920",
    "end": "4648400"
  },
  {
    "text": "cluster so every provider usually uh Supply template so if you look at our",
    "start": "4648400",
    "end": "4659239"
  },
  {
    "text": "provider we actually already made the uh 0.1.0 release um and you can see",
    "start": "4659239",
    "end": "4668560"
  },
  {
    "text": "actually cluster template we uh provide as a provider um and",
    "start": "4668560",
    "end": "4675800"
  },
  {
    "text": "this section actually has a section how to create the default template and all",
    "start": "4675800",
    "end": "4681560"
  },
  {
    "text": "this but I I actually not go through this and instead what I will",
    "start": "4681560",
    "end": "4686800"
  },
  {
    "text": "do is that um just hold",
    "start": "4686800",
    "end": "4692638"
  },
  {
    "text": "on so so basically if you follow through our",
    "start": "4696159",
    "end": "4701560"
  },
  {
    "text": "instruction um there will be a template trory that has a cluster template so",
    "start": "4701560",
    "end": "4708000"
  },
  {
    "text": "this has a definition of a cluster doer cluster doer machine cuum control plane",
    "start": "4708000",
    "end": "4715400"
  },
  {
    "text": "like everything you need to create cluster so you have this",
    "start": "4715400",
    "end": "4720880"
  },
  {
    "text": "in um so that's what we are explaining",
    "start": "4720880",
    "end": "4726480"
  },
  {
    "text": "here and we actually um so there is instruction to generate the template so",
    "start": "4726480",
    "end": "4733320"
  },
  {
    "text": "as you can see here we actually have a sum R variable what we call token here",
    "start": "4733320",
    "end": "4740080"
  },
  {
    "text": "and this uh when you when you uh generate the template you can actually set them as an environment variable and",
    "start": "4740080",
    "end": "4748639"
  },
  {
    "text": "when you use cluster cuddle generate cluster from this template it will",
    "start": "4748639",
    "end": "4753880"
  },
  {
    "text": "actually replace uh those variable with our environment variable so um so this is how you",
    "start": "4753880",
    "end": "4762800"
  },
  {
    "text": "generate the template and I actually already created the template uh uh just",
    "start": "4762800",
    "end": "4771840"
  },
  {
    "text": "hold on so",
    "start": "4771840",
    "end": "4778000"
  },
  {
    "text": "um uh so I already have a template generated so what I will do is uh on the",
    "start": "4780639",
    "end": "4787080"
  },
  {
    "text": "left side I will actually run this watch uh watch cluster C descrip cluster",
    "start": "4787080",
    "end": "4796719"
  },
  {
    "text": "uh command so you will watch so we don't have cluster yet and on the right side I",
    "start": "4796719",
    "end": "4802400"
  },
  {
    "text": "will actually also um watch darker PS because we are creating darker",
    "start": "4802400",
    "end": "4809120"
  },
  {
    "text": "containers so let me do this so if I apply this",
    "start": "4809120",
    "end": "4816960"
  },
  {
    "text": "template so it ex generate buch of Yammer and you can see that um this",
    "start": "4816960",
    "end": "4824960"
  },
  {
    "text": "cluster cutter describe it is actually showing the status of our cluster",
    "start": "4824960",
    "end": "4830440"
  },
  {
    "text": "generation as you can see it's like changing uh it's actually scaling up",
    "start": "4830440",
    "end": "4835840"
  },
  {
    "text": "bootstrapping and it's it's actually showing the ladies the ladies status of",
    "start": "4835840",
    "end": "4840920"
  },
  {
    "text": "the cluster creation and if you see the right here you actually see that this",
    "start": "4840920",
    "end": "4847360"
  },
  {
    "text": "container is uh the load B balancer container uh abish explained and and the",
    "start": "4847360",
    "end": "4855880"
  },
  {
    "text": "next one we have a control plane uh coming up and this is our worker node",
    "start": "4855880",
    "end": "4861560"
  },
  {
    "text": "coming up so it's almost",
    "start": "4861560",
    "end": "4866760"
  },
  {
    "text": "done uh [Music] and I was actually giving uh some",
    "start": "4866760",
    "end": "4872880"
  },
  {
    "text": "command here you can you can use so you you can watch your cluster status here",
    "start": "4872880",
    "end": "4879080"
  },
  {
    "text": "but if you want to like know a little bit more about different things",
    "start": "4879080",
    "end": "4885520"
  },
  {
    "text": "what you can do is um you can actually get cluster so so you you see that oh",
    "start": "4885520",
    "end": "4892159"
  },
  {
    "text": "it's probis and you can actually see our doer cluster and you can get the docker",
    "start": "4892159",
    "end": "4900520"
  },
  {
    "text": "machine and you can you see the control plane and uh like work work node and if",
    "start": "4900520",
    "end": "4907159"
  },
  {
    "text": "you want to know like more about this like oh what's actually happening uh then you can actually get the",
    "start": "4907159",
    "end": "4915120"
  },
  {
    "text": "ymer of this Tucker Machine and we actually have a conditions for uh this",
    "start": "4915120",
    "end": "4923199"
  },
  {
    "text": "doer machine so you can see that a container is provision bootstrap",
    "start": "4923199",
    "end": "4928560"
  },
  {
    "text": "execution succeeded and uh combining this there is like ready conditions",
    "start": "4928560",
    "end": "4934199"
  },
  {
    "text": "showing that this doer machine is like ready",
    "start": "4934199",
    "end": "4939480"
  },
  {
    "text": "uh so yeah so um that's actually what's",
    "start": "4939480",
    "end": "4947080"
  },
  {
    "text": "happening uh yes it's done so so this uh machine deployment is forc because uh we",
    "start": "4947080",
    "end": "4953159"
  },
  {
    "text": "didn't we didn't uh apply sh yet uh but once you apply shni it will actually",
    "start": "4953159",
    "end": "4960159"
  },
  {
    "text": "become ready so I will not go through that uh but basically our cluster is",
    "start": "4960159",
    "end": "4966400"
  },
  {
    "text": "ready except that it doesn't have cni yet and it it shows all the darker PS",
    "start": "4966400",
    "end": "4971480"
  },
  {
    "text": "and everything and and and just uh for your inform uh if you want to like know what's",
    "start": "4971480",
    "end": "4978320"
  },
  {
    "text": "really going on you actually can uh look at the logs of our controller so for our",
    "start": "4978320",
    "end": "4986199"
  },
  {
    "text": "darker controller you can actually I I like normally follow uh and",
    "start": "4986199",
    "end": "4993040"
  },
  {
    "text": "or like if you have tilt you can actually get from tilt to UI so it's",
    "start": "4993040",
    "end": "4998280"
  },
  {
    "text": "it's actually showing like all the steps done done with the our uh provider what",
    "start": "4998280",
    "end": "5004159"
  },
  {
    "text": "what is doing it's like reconcile request ship it's like waiting for bootstrap provider controller to set the",
    "start": "5004159",
    "end": "5010320"
  },
  {
    "text": "bootstrap data so if you have some issue you can actually look at the looks of this controller and see what's",
    "start": "5010320",
    "end": "5018920"
  },
  {
    "text": "happening so yeah so we have 5 minutes so right come come",
    "start": "5019760",
    "end": "5025840"
  },
  {
    "text": "on um yeah so that's actually all I had but um there are like",
    "start": "5025840",
    "end": "5032840"
  },
  {
    "text": "more instructions in in this tutorial so please take a look at it and we actually",
    "start": "5032840",
    "end": "5039000"
  },
  {
    "text": "have a release section that uh that explains how to release a provider using",
    "start": "5039000",
    "end": "5045600"
  },
  {
    "text": "GitHub actions with all the examples so yeah take a look at it and yeah Ros",
    "start": "5045600",
    "end": "5054000"
  },
  {
    "text": "no guess has anyone got any questions",
    "start": "5054639",
    "end": "5060120"
  },
  {
    "text": "[Applause]",
    "start": "5060450",
    "end": "5067069"
  }
]