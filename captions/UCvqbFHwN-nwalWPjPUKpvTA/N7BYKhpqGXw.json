[
  {
    "text": "good afternoon welcome to our virtual talk uh this is a talk on kubernetes persistent data challenges availability",
    "start": "160",
    "end": "6240"
  },
  {
    "text": "zones regions and multi-cloud patterns so what's the next slide um quick hellos",
    "start": "6240",
    "end": "11440"
  },
  {
    "text": "from us uh my name is chris milstead i'm a solution architect at on that so working with customers around all things",
    "start": "11440",
    "end": "18080"
  },
  {
    "text": "data and kubernetes and my co-presenter is dr mcfadden um i work in data stacks i",
    "start": "18080",
    "end": "24080"
  },
  {
    "text": "work in developer relations and developer experience and i work in the apache cassandra project and a few",
    "start": "24080",
    "end": "29359"
  },
  {
    "text": "others but mostly around open source data and kubernetes i'm also writing a book right",
    "start": "29359",
    "end": "35120"
  },
  {
    "text": "now um cloud native data on managing cloud native data on kubernetes available at a bookstore soon chris very",
    "start": "35120",
    "end": "41920"
  },
  {
    "text": "soon oh but i've got an order don't you worry yeah well you can you can still download it we'll show the link at the",
    "start": "41920",
    "end": "47360"
  },
  {
    "text": "end brilliant and uh before we get into the bulk of the presentation just a quick couple of",
    "start": "47360",
    "end": "52480"
  },
  {
    "text": "thanks um to alex and rags alex is one of the engineers on the kate sandra project and",
    "start": "52480",
    "end": "59199"
  },
  {
    "text": "has been invaluable help in setting up a lot of the demos and stuff we're going to show later and rags actually built a",
    "start": "59199",
    "end": "65040"
  },
  {
    "text": "lot of the multi-cloud crazy demo that we're going to show right at the very end so",
    "start": "65040",
    "end": "70320"
  },
  {
    "text": "with that onto the bulk of the presentation and i believe you can leave this off patrick i will so",
    "start": "70320",
    "end": "77200"
  },
  {
    "text": "chris i think everyone's going to ask this question why would we even do this so i'm going to walk you through some of",
    "start": "77200",
    "end": "83360"
  },
  {
    "text": "the reasons that you may want to be outside of one data center one rack uh and this is a pretty typical",
    "start": "83360",
    "end": "90320"
  },
  {
    "text": "question because it does add complexity um it's very simple let's let's be very",
    "start": "90320",
    "end": "96000"
  },
  {
    "text": "clear it's very simple to run something that's running on your laptop and that's the most simple way to do it but of course that's not how we put things into",
    "start": "96000",
    "end": "102640"
  },
  {
    "text": "production so when we think about production workloads um in trying to",
    "start": "102640",
    "end": "108079"
  },
  {
    "text": "conceptualize failure this is this is why we're using multiple az's multiple",
    "start": "108079",
    "end": "114720"
  },
  {
    "text": "multi-anything is things around failures and then there's more",
    "start": "114720",
    "end": "120159"
  },
  {
    "text": "relevant reasons for contemporary reasons i would say which i'll get into in a minute but like",
    "start": "120159",
    "end": "125840"
  },
  {
    "text": "we'll start with just availability zones so availability zones are built by clouds for this problem is to mitigate",
    "start": "125840",
    "end": "132560"
  },
  {
    "text": "certain types of failure so i have a little chart here that is is",
    "start": "132560",
    "end": "137680"
  },
  {
    "text": "out there you can it's it's nothing new but it's about you know managing your your failures and the service level",
    "start": "137680",
    "end": "144080"
  },
  {
    "text": "agreement the slas that people that clouds give on like an individual vm is you get three nines okay that's not bad",
    "start": "144080",
    "end": "151200"
  },
  {
    "text": "but it's not great either you know that's still minutes or hours of downtime with hardware failures and when we're",
    "start": "151200",
    "end": "157760"
  },
  {
    "text": "talking about cloud usually one piece of hardware could run multiple vms you know multiple images",
    "start": "157760",
    "end": "164000"
  },
  {
    "text": "multiple containers but that you know you get a five on the end of that but when we're talking about entire data",
    "start": "164000",
    "end": "169920"
  },
  {
    "text": "centers you know we're now into a night of four nines and that's when multiple availability zones",
    "start": "169920",
    "end": "176720"
  },
  {
    "text": "come in because um if you look at like a map uh if you look at the satellite map in northern virginia you'll see all",
    "start": "176720",
    "end": "182159"
  },
  {
    "text": "these really big buildings with no windows well you can see them all lined up in one part of near reston that's",
    "start": "182159",
    "end": "189280"
  },
  {
    "text": "amazon east and each one of those buildings is an availability zone and they could lose power",
    "start": "189280",
    "end": "195840"
  },
  {
    "text": "network or anything in one of those and that that's what we're trying to avoid now when you get into multi-region and",
    "start": "195840",
    "end": "202000"
  },
  {
    "text": "like amazon has regions all over the world there's there's like i said more contemporary reasons to do this where",
    "start": "202000",
    "end": "208720"
  },
  {
    "text": "you may want to be actually closer to your customers speed of light is still",
    "start": "208720",
    "end": "213840"
  },
  {
    "text": "pretty much halfway around the world um you're looking at hundreds of milliseconds",
    "start": "224959",
    "end": "230959"
  },
  {
    "text": "around time and if you're if your data is in one place and your customers are in another somebody's gonna lose out and",
    "start": "230959",
    "end": "237840"
  },
  {
    "text": "so getting your data closer to customers is the name of the game now if you have global customers you need global data",
    "start": "237840",
    "end": "243519"
  },
  {
    "text": "there's also a lot of regulatory requirements that you have to manage um every sovereign data protection law has",
    "start": "243519",
    "end": "250400"
  },
  {
    "text": "different rules if you're in europe if you're in north america uh if you're in australia like any of these uh any of",
    "start": "250400",
    "end": "257280"
  },
  {
    "text": "these governments that are gonna and they're always changing by the way are gonna have regulatory requirements on",
    "start": "257280",
    "end": "263600"
  },
  {
    "text": "privacy and things like that you have to manage that but sometimes you have when you have customers in",
    "start": "263600",
    "end": "268880"
  },
  {
    "text": "those different areas you need to manage the data that goes there and then finally i mean this is my favorite part is maximum up time um and",
    "start": "268880",
    "end": "276080"
  },
  {
    "text": "i i say this like you have zero percent chance of a 100 uptime if you're only in one region one region can fail and um if",
    "start": "276080",
    "end": "284320"
  },
  {
    "text": "you just do a quick google on uh cloud failures you can see that this happens",
    "start": "284320",
    "end": "289360"
  },
  {
    "text": "quite often and then multi-cloud and this is getting into like where people really get freaked out but why like why would you",
    "start": "289360",
    "end": "296240"
  },
  {
    "text": "be do multi-cloud and it's a funny thing because sometimes it's something that's done to you as an sra or an operator uh",
    "start": "296240",
    "end": "304080"
  },
  {
    "text": "multi-cloud can come about whenever for instance if you have an acquisition and you acquire a company that is in a",
    "start": "304080",
    "end": "310000"
  },
  {
    "text": "different cloud provider than you're in or if you're migrating to a new provider let's say you're going from amazon to",
    "start": "310000",
    "end": "315280"
  },
  {
    "text": "google well while you're in the middle of that which is probably going to be three or four years maybe five you are",
    "start": "315280",
    "end": "320720"
  },
  {
    "text": "now a multi-cloud company um and there's the my favorite which happens all the",
    "start": "320720",
    "end": "326240"
  },
  {
    "text": "time which is there's some rogue unit in your company that's just decided to go use a different cloud why",
    "start": "326240",
    "end": "332320"
  },
  {
    "text": "i i don't know no one's ever figured out exactly why but it happens all the time and i know a lot of you are probably shaking your head and like yeah that's",
    "start": "332320",
    "end": "338240"
  },
  {
    "text": "that group you know um and you know multi-cloud is there's other reasons and i think these",
    "start": "338240",
    "end": "344160"
  },
  {
    "text": "are more relevant contemporary like i said that we're at the point now where we're",
    "start": "344160",
    "end": "350000"
  },
  {
    "text": "talking about avoiding lock-in we're talking about um you know spreading your bet",
    "start": "350000",
    "end": "355440"
  },
  {
    "text": "using uh the cost basis of cloud in a better way so you know this is where",
    "start": "355440",
    "end": "361840"
  },
  {
    "text": "we're getting into this world of hybrid and hybrid is like when we're building out uh this is",
    "start": "361840",
    "end": "368479"
  },
  {
    "text": "probably where a lot of you are now where we're trying to save money in the cloud but we still own a lot of data",
    "start": "368479",
    "end": "374240"
  },
  {
    "text": "centers and when you're migrating from your physical data center that you spent billions of dollars on and you're moving",
    "start": "374240",
    "end": "380720"
  },
  {
    "text": "over to the cloud during that time frame again probably measured in years you are now in the",
    "start": "380720",
    "end": "385919"
  },
  {
    "text": "hybrid zone and when you're in the hybrid zone you have a whole different management challenge so",
    "start": "385919",
    "end": "391199"
  },
  {
    "text": "what we're attempting to do i think at this point is help you manage that and make it less painful",
    "start": "391199",
    "end": "398240"
  },
  {
    "text": "chris brilliant yeah and the other thing i think just to add to all of these kind of",
    "start": "398240",
    "end": "404319"
  },
  {
    "text": "you know the um the things we're using to build these kubernetes platforms and how we're",
    "start": "404319",
    "end": "410560"
  },
  {
    "text": "trying to get this maximum uptime is we're also talking here about data and why are we saying it's now going to",
    "start": "410560",
    "end": "417840"
  },
  {
    "text": "be critical to get your data into the kubernetes clusters i'm a big fan of looking back at history",
    "start": "417840",
    "end": "423120"
  },
  {
    "text": "and i'm pretty sure that there's nothing really that new we've come up with in the it industry over the last 20 years",
    "start": "423120",
    "end": "429199"
  },
  {
    "text": "we probably did it in the last 40 years before and i think two of those trends are the first one is",
    "start": "429199",
    "end": "434319"
  },
  {
    "text": "looking at the data problems you know we've moved our compute to the data if you look at the whole kind of",
    "start": "434319",
    "end": "440560"
  },
  {
    "text": "mapreduce um shift we had and how we do did um you know data transformation data",
    "start": "440560",
    "end": "446800"
  },
  {
    "text": "information data you know i need information from my data how do i mine it we found out that moving data sets",
    "start": "446800",
    "end": "452880"
  },
  {
    "text": "around is just too costly so interestingly in that sense we took a compute to the data but",
    "start": "452880",
    "end": "460160"
  },
  {
    "text": "all our compute now is in kubernetes clusters so actually qed we need to have our data in our kubernetes clusters",
    "start": "460160",
    "end": "467199"
  },
  {
    "text": "and um the other side of it is virtualization so um",
    "start": "467199",
    "end": "472720"
  },
  {
    "text": "we still think of like i'm going to go grab some storage and we still think of like grabbing a disc",
    "start": "472720",
    "end": "479680"
  },
  {
    "text": "if you look at i think uh 15k discs from yesteryear",
    "start": "479680",
    "end": "484800"
  },
  {
    "text": "there's like 200 iops that they max out on if it's random you know we can take",
    "start": "484800",
    "end": "490800"
  },
  {
    "text": "you know an enterprise-grade ssd nvme drive and we get a million iops out of that without batting an eyelid",
    "start": "490800",
    "end": "497759"
  },
  {
    "text": "and um the gentleman who looks after a lot of the linux kernel components here he's",
    "start": "497759",
    "end": "504080"
  },
  {
    "text": "got to set up with a couple of um octane cards so two opt-in cards and he can get 10 million iops out of two cards so",
    "start": "504080",
    "end": "511440"
  },
  {
    "text": "thinking about what did we do when processors got that much that much more powerful we",
    "start": "511440",
    "end": "516560"
  },
  {
    "text": "virtualized them so these two trends about looking at how do we make the best",
    "start": "516560",
    "end": "521839"
  },
  {
    "text": "use of our resources and if we're virtualizing them how do we then get the spare resources when they're not being",
    "start": "521839",
    "end": "526880"
  },
  {
    "text": "used and how do we go back to those virtualization principles and the other side of it is how do we actually bring our data into the kubernetes cluster",
    "start": "526880",
    "end": "535519"
  },
  {
    "text": "so if you look at the next slide as well the reasons for doing this as well",
    "start": "535519",
    "end": "542640"
  },
  {
    "text": "and there's a community that myself and my company's involved with and patrick's um heavily involved with",
    "start": "542640",
    "end": "549120"
  },
  {
    "text": "as well which is this data on kubernetes so we're surveying all the people in there and saying to the people",
    "start": "549120",
    "end": "555120"
  },
  {
    "text": "what are you finding when you put data in kubernetes they're finding there's a few things they've got to fix but actually they're",
    "start": "555120",
    "end": "560720"
  },
  {
    "text": "finding that all the benefits they were getting from their applications and the standardization the ci cd and the you",
    "start": "560720",
    "end": "567920"
  },
  {
    "text": "know clicking a button and putting their developers closer to the computer and giving them back control and moving",
    "start": "567920",
    "end": "573200"
  },
  {
    "text": "faster you know applications to production safely in a day all those kinds of things we're looking for",
    "start": "573200",
    "end": "579440"
  },
  {
    "text": "data is actually complementing that as well there's a few things to solve but",
    "start": "579440",
    "end": "584959"
  },
  {
    "text": "it it's the it's the what we're seeing is what people are looking to do in their kubernetes platforms now so watch out for this is the revolution",
    "start": "584959",
    "end": "591680"
  },
  {
    "text": "and i think patrick you're going to talk about hybrid base centers next",
    "start": "591680",
    "end": "596480"
  },
  {
    "text": "yeah the the thing that i i feel like and this is a very important part of what you know this is part of my book",
    "start": "596959",
    "end": "603440"
  },
  {
    "text": "chris so this is a shameless plug but it's this concept of in kubernetes where we're building",
    "start": "603440",
    "end": "609120"
  },
  {
    "text": "building out something um very revolutionary and evolutionary at the same time where we went from",
    "start": "609120",
    "end": "615440"
  },
  {
    "text": "physical servers to virtual machines to containers and now we're orchestrating",
    "start": "615440",
    "end": "620800"
  },
  {
    "text": "containers with a little bit of magic and creating virtual data centers it's this is",
    "start": "620800",
    "end": "626240"
  },
  {
    "text": "a logical progression in our virtualization where instead of owning a data center and and",
    "start": "626240",
    "end": "633920"
  },
  {
    "text": "managing the power managing the network all those things we are at the point now where we're",
    "start": "633920",
    "end": "639279"
  },
  {
    "text": "renting compute network and storage creating our own virtual data centers for what we need bespoke",
    "start": "639279",
    "end": "644800"
  },
  {
    "text": "and the reason is because we are building applications that have a certain amount of input and then we",
    "start": "644800",
    "end": "650720"
  },
  {
    "text": "require a certain amount of output and what happens inside that virtual data center we can be very specific about and we can build the tools that we need",
    "start": "650720",
    "end": "657040"
  },
  {
    "text": "instead of just um you know renting a service or something like that all the time we're",
    "start": "657040",
    "end": "662959"
  },
  {
    "text": "we're thinking a lot more about what builds our business and being more agile so um just one thing before we go into",
    "start": "662959",
    "end": "670160"
  },
  {
    "text": "you know the data patterns and look at how we can complement the data in kubernetes and",
    "start": "670160",
    "end": "676079"
  },
  {
    "text": "where some applications have got application level capabilities we're not saying to change any of the",
    "start": "676079",
    "end": "681839"
  },
  {
    "text": "kubernetes architectural patterns they're already out there there's a link at the bottom here to the cncf disaster",
    "start": "681839",
    "end": "687360"
  },
  {
    "text": "recovery paper it's very good broadly it's don't stretch your kubernetes clusters across",
    "start": "687360",
    "end": "692640"
  },
  {
    "text": "regions um start doing that at the application space as patrick said earlier you know the speed of light is finite",
    "start": "692640",
    "end": "699200"
  },
  {
    "text": "um as soon as you leave an availability zone if you're building in the cloud um things cost money",
    "start": "699200",
    "end": "705120"
  },
  {
    "text": "and you know bandwidth is not infinite and all those other fallacies so at some point you",
    "start": "705120",
    "end": "710399"
  },
  {
    "text": "know cap theorem will pick in and your partition or availability or your consistency one of",
    "start": "710399",
    "end": "716320"
  },
  {
    "text": "these things will have to give so what we're saying is this is how to complement with the data layer",
    "start": "716320",
    "end": "722880"
  },
  {
    "text": "but don't think we're saying do anything different at the kubernetes layer so we'll just be very clear on that before we go any further so yes um",
    "start": "722880",
    "end": "730560"
  },
  {
    "text": "on to the next slide so now we're going to get to the bulk of the um fun which is the first set of patterns so",
    "start": "730560",
    "end": "736320"
  },
  {
    "text": "this is the demo that i've put together what i'm going to try and do is show the",
    "start": "736320",
    "end": "741440"
  },
  {
    "text": "single cluster single ac single region and for that what i've picked is i'll call it a traditional",
    "start": "741440",
    "end": "748160"
  },
  {
    "text": "application so i'm picking prometheus so it would like to have a single um",
    "start": "748160",
    "end": "753760"
  },
  {
    "text": "data store and if the pod dies then it will want to restart and want to reconnect to that same data store",
    "start": "753760",
    "end": "760480"
  },
  {
    "text": "on the other side i've got cassandra which is using stateful sets and it's",
    "start": "760480",
    "end": "765600"
  },
  {
    "text": "you know we can cassandra is a fantastic application and we can stretch that halfway across the world as we'll see",
    "start": "765600",
    "end": "771440"
  },
  {
    "text": "in the next demo but in this one what i'm going to show is how we can allow cassandra to do all the kind of",
    "start": "771440",
    "end": "777360"
  },
  {
    "text": "um storage layer intelligence so the important thing in both in these kind of two demos on the left hand side",
    "start": "777360",
    "end": "783920"
  },
  {
    "text": "of the right hand side is how we complement with the csi so the container storage interface plug-in",
    "start": "783920",
    "end": "790800"
  },
  {
    "text": "and the application so making sure these two things are working in harmony so there's about an hour and 45",
    "start": "790800",
    "end": "797440"
  },
  {
    "text": "from cold to cold start to end of this demo we've cut it down to about eight minutes so i'm going to try and narrate",
    "start": "797440",
    "end": "803120"
  },
  {
    "text": "it as we go along so patrick let's go for it so first step we're going to spin up our cluster i'm using aws",
    "start": "803120",
    "end": "810639"
  },
  {
    "text": "because i can use eksctl just to easily spin up my cluster i'm using i3en",
    "start": "810639",
    "end": "816000"
  },
  {
    "text": "instances those are instances with local ssds and i'm using that because i want to get you",
    "start": "816000",
    "end": "821440"
  },
  {
    "text": "know 300 000 iops i want to get the fastest storage i can um and you can hopefully see in there",
    "start": "821440",
    "end": "826959"
  },
  {
    "text": "there's some two here in each of the 1a1b1c those availability zones so",
    "start": "826959",
    "end": "832399"
  },
  {
    "text": "hopefully that aligns with the picture that you saw on the previous page so if you're going to lens i'm just",
    "start": "832399",
    "end": "837600"
  },
  {
    "text": "using that as my um ide my gui so you can see what's going on you can see my cluster and there's no",
    "start": "837600",
    "end": "843120"
  },
  {
    "text": "metrics so that's the important thing on that page that we just went past i'm using my under um component as my",
    "start": "843120",
    "end": "849600"
  },
  {
    "text": "csi plugin i'm using that because it can run against local ssds and will allow me",
    "start": "849600",
    "end": "855680"
  },
  {
    "text": "to do intelligent things like storage replication encryption topology awareness and",
    "start": "855680",
    "end": "863120"
  },
  {
    "text": "i can also do things like um fencing for faster failovers so i'm taking dumb ssds or nvme drives and i'm",
    "start": "863120",
    "end": "870399"
  },
  {
    "text": "using a csi plugin to add some intelligence to that so um",
    "start": "870399",
    "end": "876959"
  },
  {
    "text": "i've installed um the storage os is the underlying technology name the on that product onto the",
    "start": "876959",
    "end": "883120"
  },
  {
    "text": "platform and you'll see that that component is coming up there so when it installs",
    "start": "883120",
    "end": "888320"
  },
  {
    "text": "by default we'll get a storage class created which is just give me i'll call it dumb storage but just give",
    "start": "888320",
    "end": "894639"
  },
  {
    "text": "me straight here's a bit of storage from an nvme drive i also created in there a",
    "start": "894639",
    "end": "900160"
  },
  {
    "text": "more intelligent storage class where i'm asking the storage layer to do replication and i've told it to",
    "start": "900160",
    "end": "906240"
  },
  {
    "text": "also encrypt it so we can do per volume encryption i've also asked it to replicate it between the three azs",
    "start": "906240",
    "end": "911600"
  },
  {
    "text": "and that's the one i'm going to use for prometheus the more intelligent one because prometheus doesn't have the smarts to replicate the data",
    "start": "911600",
    "end": "917839"
  },
  {
    "text": "but for um cassandra i'm going to do that so we're now into installing the actual workloads so certificate manager's been",
    "start": "917839",
    "end": "924800"
  },
  {
    "text": "going on in the background there and then i'm using customize here to actually build and deploy the um",
    "start": "924800",
    "end": "931279"
  },
  {
    "text": "kate sandra operator so so far we've had a cube ctl plugin",
    "start": "931279",
    "end": "936639"
  },
  {
    "text": "we've had customize and we've had um cubes uh just a box down cube ctl apply so we've had",
    "start": "936639",
    "end": "943040"
  },
  {
    "text": "three different ways to install it so now we're going to try and put prometheus onto the box so we'll go for the fourth way of installing things so",
    "start": "943040",
    "end": "949360"
  },
  {
    "text": "we'll use the um community helm charts so we're going to put prometheus onto my cluster now as",
    "start": "949360",
    "end": "955120"
  },
  {
    "text": "well so what we're going to get to is the point where we have that kind of traditional",
    "start": "955120",
    "end": "960720"
  },
  {
    "text": "workload and we should start to see metrics in our cluster and we also should have our in a second",
    "start": "960720",
    "end": "966800"
  },
  {
    "text": "we're actually going to spin up our actual kate sandra sorry cassandra cluster using the case android operator",
    "start": "966800",
    "end": "972720"
  },
  {
    "text": "so um let's just go and apply that so there should be a um a custom resource of um",
    "start": "972720",
    "end": "980399"
  },
  {
    "text": "oh i'm going too quick there we go but um hopefully the important thing in there was there's one a one b one c so i told",
    "start": "980399",
    "end": "986639"
  },
  {
    "text": "cassandra the case under operator to deploy a cassandra cluster and there should be a staple set in rack",
    "start": "986639",
    "end": "992800"
  },
  {
    "text": "one rack two rack three and those are pinned to the 1a 1b 1c availability zones so hopefully in the bottom right",
    "start": "992800",
    "end": "999519"
  },
  {
    "text": "you can see there's that little 181 b1c so um i also do a little trick here i'm",
    "start": "999519",
    "end": "1006320"
  },
  {
    "text": "going to actually label them on at the on that layer to do fencing so what we can do is we can do faster",
    "start": "1006320",
    "end": "1012480"
  },
  {
    "text": "failovers so if a node times out rather than waiting the five minutes for a kubernetes node timeout to expire",
    "start": "1012480",
    "end": "1018800"
  },
  {
    "text": "um the platform can actually monitor it and kill the pod and uh actually um start a faster failover",
    "start": "1018800",
    "end": "1026240"
  },
  {
    "text": "if you wanted to do that so just a little trick to speed up the stuff the other thing here i'm now running a",
    "start": "1026240",
    "end": "1031438"
  },
  {
    "text": "job so i'm running um no sql bench so i'm running workload now",
    "start": "1031439",
    "end": "1037038"
  },
  {
    "text": "and it's running live against this cassandra cluster i've now got running on these components",
    "start": "1037039",
    "end": "1042798"
  },
  {
    "text": "and you see top right there we got metrics so prometheus is running we've got metric storage",
    "start": "1042799",
    "end": "1048319"
  },
  {
    "text": "for prometheus cassandra's running you can see my nosql bench i'll be ticking along we'll keep",
    "start": "1048319",
    "end": "1053440"
  },
  {
    "text": "going back to the nosql bench and what you should see is we get up to about 60 through my workload it's not running a",
    "start": "1053440",
    "end": "1059600"
  },
  {
    "text": "hard benchmark but it's just running background load so now we're going to do something nasty we're going to cordon and drain a node",
    "start": "1059600",
    "end": "1066559"
  },
  {
    "text": "um so i think this is the one in one c i can't remember exactly but it's one of",
    "start": "1066559",
    "end": "1072000"
  },
  {
    "text": "the availability zones and i picked a node because it's running both one of the cassandra pods and it's running my",
    "start": "1072000",
    "end": "1077440"
  },
  {
    "text": "promethi server are you sure you want to drain the note yes of course i am i want to kill my workload mid-flight and see what happens",
    "start": "1077440",
    "end": "1085600"
  },
  {
    "text": "so um kubernetes has been kubernetes yeah exactly kubernetes being kubernetes does",
    "start": "1085600",
    "end": "1090960"
  },
  {
    "text": "its happy thing goes oh i've evicted my pods i'd better go and talk to my scheduler and go and see",
    "start": "1090960",
    "end": "1096480"
  },
  {
    "text": "where to put them so the prometheus server is coming up there and if we go and look at the cassandra",
    "start": "1096480",
    "end": "1102080"
  },
  {
    "text": "so here we go you see my rack 2 instance is a very orange",
    "start": "1102080",
    "end": "1107120"
  },
  {
    "text": "there very pending it's not very happy so let's check um my newest girl bench",
    "start": "1107120",
    "end": "1112720"
  },
  {
    "text": "benchmark is still running through so even though cassandra has lost a node it's not using any smarts at the csi",
    "start": "1112720",
    "end": "1119600"
  },
  {
    "text": "plug-in it's just using raw swell it's using the csi plugin to do smart things to be able to automate access to the",
    "start": "1119600",
    "end": "1124799"
  },
  {
    "text": "nvme drives but it's not doing any replication of that layer it's doing that all in the cassandra layer",
    "start": "1124799",
    "end": "1130480"
  },
  {
    "text": "it's still running so happy days but my prometheus workload",
    "start": "1130480",
    "end": "1135600"
  },
  {
    "text": "we killed it on a node it was using a local ssd but luckily i've got replication at the",
    "start": "1135600",
    "end": "1140799"
  },
  {
    "text": "storage layer so even though that workload is moved to another node another local nvme drive",
    "start": "1140799",
    "end": "1147120"
  },
  {
    "text": "if we have a look in a set we should see if we go into one of these we've still got metrics and we've got all the historical metrics as well you can go",
    "start": "1147120",
    "end": "1153440"
  },
  {
    "text": "back and look at the time stamps and you'll see that that's running all the way through so we'll bring that node back into the cluster as well",
    "start": "1153440",
    "end": "1160240"
  },
  {
    "text": "um and now of course because i'm evil uh we're gonna go for the big test which is",
    "start": "1160240",
    "end": "1168320"
  },
  {
    "text": "uh rather than turn things off nicely let's just check our nosql bench yep",
    "start": "1168320",
    "end": "1173520"
  },
  {
    "text": "still got workload going through our casino cluster brilliant things are still ticking along um we're",
    "start": "1173520",
    "end": "1178799"
  },
  {
    "text": "going to pull the plug out the server so i'm going to go into my aws console and i'm going to terminate my instance",
    "start": "1178799",
    "end": "1185440"
  },
  {
    "text": "and of course it's going to say to me are you sure because you're using very fast local nvme 300 000 io devices",
    "start": "1185440",
    "end": "1193520"
  },
  {
    "text": "but if you kill them you lose them and like yeah don't worry we've got that covered we're using a different plug-in",
    "start": "1193520",
    "end": "1198720"
  },
  {
    "text": "it's fine so we kill it and um you notice i've lost one of my other",
    "start": "1198720",
    "end": "1204720"
  },
  {
    "text": "cassandra nodes now but my no skill bench still plugging away so brilliant i'm still got",
    "start": "1204720",
    "end": "1211280"
  },
  {
    "text": "world over up to about 40 of that run 44 of that run at the moment so it's still running along through now",
    "start": "1211280",
    "end": "1218720"
  },
  {
    "text": "um what actually happened here um it couldn't recover to",
    "start": "1218840",
    "end": "1224400"
  },
  {
    "text": "the the second node in that availability zone because the stargate pod was running and i discovered later on",
    "start": "1224400",
    "end": "1230960"
  },
  {
    "text": "in the cassandra operator there's actually a flag you have to set if you want to allow stargate and um cassandra to",
    "start": "1230960",
    "end": "1237360"
  },
  {
    "text": "actually coexist on a node so what actually happened here was kubernetes did its stuff so if you go in and look",
    "start": "1237360",
    "end": "1242960"
  },
  {
    "text": "at the kubernetes cluster and in the eks you'll see we get it's initializing here so it's actually building a seventh node",
    "start": "1242960",
    "end": "1249840"
  },
  {
    "text": "to replace the sixth one that i nastily killed so taints as it comes up",
    "start": "1249840",
    "end": "1255039"
  },
  {
    "text": "and then as it comes up notice on the right hand side the metrics there is a small gap in the metrics here because we",
    "start": "1255039",
    "end": "1260320"
  },
  {
    "text": "killed that no we killed that um stateful set by pulling the power out",
    "start": "1260320",
    "end": "1265440"
  },
  {
    "text": "but there we go um there's another storage os uh demon set so we brought storage the demon sets running on there",
    "start": "1265440",
    "end": "1271200"
  },
  {
    "text": "so we can access the storage over the network now and there we go a cassandra cluster is",
    "start": "1271200",
    "end": "1276320"
  },
  {
    "text": "back to full health we've got three stateful sets in three azs and our nosql bench is running along",
    "start": "1276320",
    "end": "1283600"
  },
  {
    "text": "so there we go um hopefully that everyone followed that as i said is about now 45 end to end in",
    "start": "1283760",
    "end": "1289200"
  },
  {
    "text": "real time you've we've compressed it to eight minutes and if we go on to the next slide",
    "start": "1289200",
    "end": "1294720"
  },
  {
    "text": "there you go you know this is the you know the big takeaways for me from this",
    "start": "1294720",
    "end": "1300080"
  },
  {
    "text": "follow the kubernetes design principles we're not trying to do clever things by stretching kubernetes clusters",
    "start": "1300080",
    "end": "1306799"
  },
  {
    "text": "we are doing clever things with the csi plugins i'm trying to get the fastest storage at the most cost effective point",
    "start": "1306799",
    "end": "1312880"
  },
  {
    "text": "i can and i'm trying to make sure that that csi plugin is doing the right things for",
    "start": "1312880",
    "end": "1319200"
  },
  {
    "text": "the right workload so for a work like prometheus i'm doing storage level replication storage level encryption",
    "start": "1319200",
    "end": "1325360"
  },
  {
    "text": "storage level topology awareness all of those components in there but for cassandra i'm just saying hey i will automate you access to these nvme",
    "start": "1325360",
    "end": "1332640"
  },
  {
    "text": "drives so you can have as many iops as you want to do your back end storage and what we're trying to say is as we",
    "start": "1332640",
    "end": "1339679"
  },
  {
    "text": "said you know you can get to no to load down time using a single region by taking this",
    "start": "1339679",
    "end": "1346640"
  },
  {
    "text": "approach even using it because this approach as well because we're using local nvme drives this will",
    "start": "1346640",
    "end": "1352320"
  },
  {
    "text": "map to you know your eks anywhere or you're on premise anything like that",
    "start": "1352320",
    "end": "1357360"
  },
  {
    "text": "hopefully you can see as well you know there's nothing special about running this in the cloud we're using local nvme so you could take this and",
    "start": "1357360",
    "end": "1363840"
  },
  {
    "text": "run this in your data center today as well and i believe that's the end of the",
    "start": "1363840",
    "end": "1369200"
  },
  {
    "text": "first kind of set of patterns and i'm going to hand back to patrick now to take us into the um multi-reed uh",
    "start": "1369200",
    "end": "1375200"
  },
  {
    "text": "multi-region multi-provider ones now yeah the the multi-multi multi the multiverse the multi multiverse of",
    "start": "1375200",
    "end": "1381200"
  },
  {
    "text": "madness um speaking of shameless plugs the so this is uh this is another pattern and uh",
    "start": "1381200",
    "end": "1388880"
  },
  {
    "text": "it exploits the the goodness of cassandra so this is again using kate sander which is a project to help um",
    "start": "1388880",
    "end": "1396960"
  },
  {
    "text": "this built for running cassandra and kubernetes uh without pain batteries included and so there's some really cool",
    "start": "1396960",
    "end": "1403600"
  },
  {
    "text": "things that keep sandra can do especially with the latest operator about running a multi-cluster",
    "start": "1403600",
    "end": "1409640"
  },
  {
    "text": "multi-kubernetes cluster so if you have multiple kubernetes clusters across regions or different clouds it doesn't",
    "start": "1409640",
    "end": "1415280"
  },
  {
    "text": "really matter thankfully uh rags is really the expert in this and he recorded a quick video",
    "start": "1415280",
    "end": "1422240"
  },
  {
    "text": "about how to do this i'm gonna just let him walk through it and um and then at the",
    "start": "1422240",
    "end": "1428159"
  },
  {
    "text": "end i'll just go through some lessons learned there and some takeaways this is a demo about",
    "start": "1428159",
    "end": "1433679"
  },
  {
    "text": "cassandra on multiple clusters so the first thing",
    "start": "1433679",
    "end": "1438960"
  },
  {
    "text": "you're probably going to want to do is set up the networking the routing peering and all that i myself am not a",
    "start": "1438960",
    "end": "1446240"
  },
  {
    "text": "networking geek so what i do is i have used a product called aviatrix and using aviatrix",
    "start": "1446240",
    "end": "1452960"
  },
  {
    "text": "you can set up um you know the vpcs that are taking the pairing fairly easily so",
    "start": "1452960",
    "end": "1458320"
  },
  {
    "text": "essentially this is the aviatrix controller um and it's running you know on the cloud somewhere right",
    "start": "1458320",
    "end": "1463679"
  },
  {
    "text": "and as you can see here i've set it up in such a way that you know aks",
    "start": "1463679",
    "end": "1470159"
  },
  {
    "text": "which is the azure kubernetes service uh is running in 10.2 and 10.",
    "start": "1470159",
    "end": "1476400"
  },
  {
    "text": "2.0 and 10.2.128 and so on um and um you",
    "start": "1476400",
    "end": "1481600"
  },
  {
    "text": "know on the eks it's 10.1 uh and on gke it's 10.3",
    "start": "1481600",
    "end": "1487039"
  },
  {
    "text": "uh and we can take a really brief look at the um terraform scripts um it's essentially on this uh",
    "start": "1487039",
    "end": "1494720"
  },
  {
    "text": "you know particular github the rags and s avx multi-cloud communities and i basically",
    "start": "1494720",
    "end": "1501200"
  },
  {
    "text": "forked it from from aviatrix and essentially what you can do here is you can specify the",
    "start": "1501200",
    "end": "1508400"
  },
  {
    "text": "different cloud accounts and once you've onboarded these accounts which i haven't talked about you set up the controller",
    "start": "1508400",
    "end": "1514720"
  },
  {
    "text": "ip the username and the password and and um you know then the rest of the",
    "start": "1514720",
    "end": "1520159"
  },
  {
    "text": "terraform scripts use this to um you know do the appropriate uh networking uh",
    "start": "1520159",
    "end": "1526159"
  },
  {
    "text": "let's go into lens okay and and uh look at these different clusters as you can see here i have a bunch of different",
    "start": "1526159",
    "end": "1533039"
  },
  {
    "text": "clusters uh but i've added them to the hotbar here the aks avs abs",
    "start": "1533039",
    "end": "1539440"
  },
  {
    "text": "cluster the eks avx cluster and the gke avx cluster okay so these are the three",
    "start": "1539440",
    "end": "1546240"
  },
  {
    "text": "ones so now that we have seen this the next step uh you know once i have to set",
    "start": "1546240",
    "end": "1551279"
  },
  {
    "text": "up the clusters and on on the three public clouds",
    "start": "1551279",
    "end": "1556480"
  },
  {
    "text": "there used to be a manual step if you wanted to do a multi-cluster in which you had to manually inject the",
    "start": "1556480",
    "end": "1562880"
  },
  {
    "text": "seeds from one cluster into another you don't have to do that anymore instead what you do is you you have the",
    "start": "1562880",
    "end": "1569679"
  },
  {
    "text": "concept of what is referred to as a control plane and then you have the concept of a data plane um you know very",
    "start": "1569679",
    "end": "1575440"
  },
  {
    "text": "similar to you know what the community services provide uh the control planes essentially take care of installing",
    "start": "1575440",
    "end": "1583279"
  },
  {
    "text": "cassandra on a communities multi-cluster multi-region multi-cloud again doesn't",
    "start": "1583279",
    "end": "1589120"
  },
  {
    "text": "matter um and and the control plane kind of handles that for you so so what i what i did to",
    "start": "1589120",
    "end": "1597039"
  },
  {
    "text": "install the control plane is pretty straightforward um you know basically what i did was i",
    "start": "1597039",
    "end": "1604320"
  },
  {
    "text": "installed the kit center operator um okay and then",
    "start": "1604320",
    "end": "1609360"
  },
  {
    "text": "you know essentially there's the concept of the control plane and and you set that to true um so you can if you if you look at you",
    "start": "1609360",
    "end": "1616400"
  },
  {
    "text": "know the different clusters uh you will see that one of them uh the aks is set up in as a control plane and um you know",
    "start": "1616400",
    "end": "1624240"
  },
  {
    "text": "the remaining two which is gke and uh eks are set up as data planes so",
    "start": "1624240",
    "end": "1629679"
  },
  {
    "text": "as you can see here there's a gk cluster right and and you can see here that it has the kate sandra operator right and",
    "start": "1629679",
    "end": "1637360"
  },
  {
    "text": "and if you dig through this uh you know kate sandra operator uh you'll be able to see that this is uh",
    "start": "1637360",
    "end": "1643520"
  },
  {
    "text": "operating as a data plane um and and you know aks is the control plane uh so",
    "start": "1643520",
    "end": "1649919"
  },
  {
    "text": "that's kind of how how i set that up so to install the kit center operand on the control plane what you do is you",
    "start": "1649919",
    "end": "1655200"
  },
  {
    "text": "essentially you know set the control plane as equal to true for the control plane but for the data",
    "start": "1655200",
    "end": "1662720"
  },
  {
    "text": "planes what you're going to do is you're going to set the control plane as equal to flaw next part is to be able to",
    "start": "1662720",
    "end": "1668080"
  },
  {
    "text": "install the client configurations uh into the control plane cluster so you",
    "start": "1668080",
    "end": "1673440"
  },
  {
    "text": "take the gke client config and install it in aks and likewise um you know take",
    "start": "1673440",
    "end": "1680240"
  },
  {
    "text": "what is an eks and and you know let um the control plane on the aks know",
    "start": "1680240",
    "end": "1685760"
  },
  {
    "text": "that you know eks is you know is part of it and look at client conflict um you",
    "start": "1685760",
    "end": "1690799"
  },
  {
    "text": "can see that you know these two clusters have been set up which is the eks cluster and the gke cluster on on on aks",
    "start": "1690799",
    "end": "1697679"
  },
  {
    "text": "to install the cluster um you know what i do is i and we can take a quick look at this uh",
    "start": "1697679",
    "end": "1704080"
  },
  {
    "text": "essentially this is the we are installing a kit sander cluster you can specify some default values for",
    "start": "1704080",
    "end": "1711039"
  },
  {
    "text": "the storage class but as you know you know the storage class is going to vary in in the different clouds so for gke",
    "start": "1711039",
    "end": "1718159"
  },
  {
    "text": "i'm using premium rwo for eks i'm using gp2 and then i'm going to",
    "start": "1718159",
    "end": "1724080"
  },
  {
    "text": "set uh stargate which is our unified apis for rest sql",
    "start": "1724080",
    "end": "1729120"
  },
  {
    "text": "grpc and you know graphql and so on now that we've done that let's go take a look at",
    "start": "1729120",
    "end": "1735760"
  },
  {
    "text": "one of the clusters like let's take a look at gk let me take a look at the parts that",
    "start": "1735760",
    "end": "1740960"
  },
  {
    "text": "are running and most critically the cassandra data center itself so this is the gke",
    "start": "1740960",
    "end": "1746960"
  },
  {
    "text": "cluster um and you know if you if i go back and look at",
    "start": "1746960",
    "end": "1752000"
  },
  {
    "text": "the eks you'll find something similar as wow um so if you look at the",
    "start": "1752000",
    "end": "1757279"
  },
  {
    "text": "cassandra radiation data center this is an eks and essentially what happens is",
    "start": "1757279",
    "end": "1762399"
  },
  {
    "text": "when you install cage center operator with the control planes and the data planes appropriately",
    "start": "1762399",
    "end": "1767600"
  },
  {
    "text": "they will set up a protocol called gossip protocol so you need to be able to enable those",
    "start": "1767600",
    "end": "1773360"
  },
  {
    "text": "ports to be able to talk to each other and and you know once they're able to talk to each other they can form a",
    "start": "1773360",
    "end": "1780880"
  },
  {
    "text": "a multi-cluster and one of the critical things that you do is basically make sure that it's one",
    "start": "1780880",
    "end": "1788000"
  },
  {
    "text": "giant um you know humongous cluster basically is like a node tool command so so what you're going to do here is",
    "start": "1788000",
    "end": "1795279"
  },
  {
    "text": "you exec the pod that is running the data center right",
    "start": "1795279",
    "end": "1800480"
  },
  {
    "text": "and then you specify the obviously the name space and then you specify the username and",
    "start": "1800480",
    "end": "1805840"
  },
  {
    "text": "the password and it will tell you you know what kind of a data center it is and essentially coming",
    "start": "1805840",
    "end": "1811919"
  },
  {
    "text": "back saying that you know it is a multi-data center on eks and gke",
    "start": "1811919",
    "end": "1818399"
  },
  {
    "text": "so so essentially what what i showed here is how do you",
    "start": "1818399",
    "end": "1823840"
  },
  {
    "text": "set up a multi uh cluster with cassandra is pretty straightforward um because once you",
    "start": "1823840",
    "end": "1830960"
  },
  {
    "text": "enable networking cassandra is able to talk to you know to the other data center or the",
    "start": "1830960",
    "end": "1836559"
  },
  {
    "text": "other node um and and automatically join up the cluster",
    "start": "1836559",
    "end": "1841919"
  },
  {
    "text": "so that was a a really quick and interesting demo about how we can",
    "start": "1841919",
    "end": "1847360"
  },
  {
    "text": "run a multi-cloud and there were some really important takeaways inside of that um",
    "start": "1847360",
    "end": "1852399"
  },
  {
    "text": "and the first one really and rags was very clear about how he did it he used aviatrix but he's getting the network",
    "start": "1852399",
    "end": "1858559"
  },
  {
    "text": "right when you're transiting from one region or from one cloud to another that's uh that's not just a click of a",
    "start": "1858559",
    "end": "1865039"
  },
  {
    "text": "button and so we're not going to try to sugarcoat that and getting the network right means that you need to have your routes you need to have your security",
    "start": "1865039",
    "end": "1871279"
  },
  {
    "text": "and everything else right it's it's not impossible we've done worse things those of you who've ever",
    "start": "1871279",
    "end": "1876320"
  },
  {
    "text": "done bgp and cisco networking know that this is probably going to be way easier than that but it is the most important",
    "start": "1876320",
    "end": "1881919"
  },
  {
    "text": "thing in this case and keep in mind mind your charges because when you do transit that's when the charges for clouds get",
    "start": "1881919",
    "end": "1888559"
  },
  {
    "text": "really up there the next thing is about the if you'll notice in the demo he did this cross",
    "start": "1888559",
    "end": "1895120"
  },
  {
    "text": "credentials where um like google needed azure credentials uh from the cluster",
    "start": "1895120",
    "end": "1900240"
  },
  {
    "text": "from one cluster to the other that's just a really important thing to take note of because when you're when you're",
    "start": "1900240",
    "end": "1905679"
  },
  {
    "text": "spanning one kubernetes cluster to another they need to be cool with each other and the way we do that is with",
    "start": "1905679",
    "end": "1911200"
  },
  {
    "text": "credentials and then um finally with the cage sandra operator uh we do have this difference between a",
    "start": "1911200",
    "end": "1917600"
  },
  {
    "text": "control plane and a data plane and that's an important call out because it's not just one full thing you have to",
    "start": "1917600",
    "end": "1924080"
  },
  {
    "text": "think about like what we're trying to do is running across multiple kubernetes clusters um we're",
    "start": "1924080",
    "end": "1929919"
  },
  {
    "text": "against what kubernetes really wants to do it's like i want to run it all well it you have to share you have to like",
    "start": "1929919",
    "end": "1935760"
  },
  {
    "text": "share now so the kate sander operator does the the important work for making sure that cassandra works across",
    "start": "1935760",
    "end": "1941679"
  },
  {
    "text": "multiple clouds and chris you got the next one yeah so i think just a summary of it all",
    "start": "1941679",
    "end": "1948799"
  },
  {
    "text": "so hopefully you've seen how you can put data into your kubernetes clusters safely and how you can take these",
    "start": "1948799",
    "end": "1955120"
  },
  {
    "text": "patterns and how you can build applications with no low downtime and how to use the right i mean this is the",
    "start": "1955120",
    "end": "1962799"
  },
  {
    "text": "big thing the big chunk in the middle here is complement your csi provider with your application there's got to be",
    "start": "1962799",
    "end": "1968000"
  },
  {
    "text": "that contract between kind of the infrastructure kind of operations of kubernetes and the applications",
    "start": "1968000",
    "end": "1973440"
  },
  {
    "text": "consuming it so they've got to know how to design their application you don't want them to have like nine times replication",
    "start": "1973440",
    "end": "1979840"
  },
  {
    "text": "where you've got three-way replication in the application and three-way replication at the storage layer",
    "start": "1979840",
    "end": "1985120"
  },
  {
    "text": "um the thing in there as well you know protect yourself don't let yourself get",
    "start": "1985120",
    "end": "1990640"
  },
  {
    "text": "a denial of service think about your usual kubernetes kind of resource quotas and limit ranges and all those kind of",
    "start": "1990640",
    "end": "1996559"
  },
  {
    "text": "things use a csi plugin um and lastly you know",
    "start": "1996559",
    "end": "2003039"
  },
  {
    "text": "the thing as patrick said before is that you can do this and you will be swapping",
    "start": "2003039",
    "end": "2008559"
  },
  {
    "text": "kind of uh complexity into the network and",
    "start": "2008559",
    "end": "2014000"
  },
  {
    "text": "security layers by doing this stuff and always remember about what your costs will be as soon as you exit anything",
    "start": "2014000",
    "end": "2021440"
  },
  {
    "text": "ingress and egress costs are going to be the things that will start costing you money when you start running this in anger across large distances spans",
    "start": "2021440",
    "end": "2028640"
  },
  {
    "text": "yeah and that's that's a really important point neither of us are here saying this is uh just oh this is a click a button easy um",
    "start": "2028640",
    "end": "2036080"
  },
  {
    "text": "and it's because the clouds don't get along with each other that's okay but uh it's it should be something that",
    "start": "2036080",
    "end": "2042480"
  },
  {
    "text": "we're all used to as engineers and operators as the you know there are the hard parts that's why we still get paid money if it was a click of a button then",
    "start": "2042480",
    "end": "2048800"
  },
  {
    "text": "developers would do this all day right indeed and and i think you know in",
    "start": "2048800",
    "end": "2054800"
  },
  {
    "text": "summary we're saying you know data and kubernetes if you're going to be successful in kubernetes you've got to get your data",
    "start": "2054800",
    "end": "2061280"
  },
  {
    "text": "into kubernetes so i'm expecting over the next year 20 12 24 months every",
    "start": "2061280",
    "end": "2068158"
  },
  {
    "text": "person's going to be having this is their kind of next next leg of their kubernetes strategy so",
    "start": "2068159",
    "end": "2074800"
  },
  {
    "text": "you know hopefully there's some good questions for us after this and please hit us up on the q a tool and um",
    "start": "2074800",
    "end": "2082320"
  },
  {
    "text": "some links in here as well all right um i just thank you everyone for listening and hope has been useful",
    "start": "2082320",
    "end": "2087599"
  },
  {
    "text": "and we've had a lot of fun um putting this stuff together so thank you everyone yes",
    "start": "2087599",
    "end": "2095638"
  }
]