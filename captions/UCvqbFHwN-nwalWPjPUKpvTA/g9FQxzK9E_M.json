[
  {
    "start": "0",
    "end": "41000"
  },
  {
    "text": "everyone so my name is Ricardo I work at CERN in Geneva I'm a computer engineer",
    "start": "0",
    "end": "5850"
  },
  {
    "text": "there and CERN is the European Organization for Nuclear Research for those that are not aware today I'll try",
    "start": "5850",
    "end": "14759"
  },
  {
    "text": "to describe a bit how we've been adopting containers but specially on the area of how we use home to track the",
    "start": "14759",
    "end": "21390"
  },
  {
    "text": "application configuration and I have a live demo at the end this will be the",
    "start": "21390",
    "end": "28260"
  },
  {
    "text": "light last live demo I do this year I've done quite a few Alworth this one I had to switch the laptop at the last minute",
    "start": "28260",
    "end": "34320"
  },
  {
    "text": "which is not my laptop but let's see maybe this will still work otherwise I hope it still has enough content so a",
    "start": "34320",
    "end": "42510"
  },
  {
    "start": "41000",
    "end": "104000"
  },
  {
    "text": "bit about CERN we are a big physics laboratory that spans the border between",
    "start": "42510",
    "end": "49079"
  },
  {
    "text": "France and Switzerland close to Geneva we build large scientific experiments to",
    "start": "49079",
    "end": "55440"
  },
  {
    "text": "explore to do fundamental physics research and explore the universe and",
    "start": "55440",
    "end": "60600"
  },
  {
    "text": "the origin of the universe try to answer questions like what is matter made of what is dark energy dark matter why",
    "start": "60600",
    "end": "67439"
  },
  {
    "text": "don't we see antimatter and for this we build very large machines this is the largest scientific experiment ever built",
    "start": "67439",
    "end": "74280"
  },
  {
    "text": "largest hadron collider it's a ring of 27 kilometers where we accelerate",
    "start": "74280",
    "end": "79320"
  },
  {
    "text": "protons in the two beams of protons in different directions and we make them collide at specific points where we",
    "start": "79320",
    "end": "85259"
  },
  {
    "text": "build these large detectors I to have an idea of the size you can see the Geneva",
    "start": "85259",
    "end": "90479"
  },
  {
    "text": "Airport there on the down right so the it's it's a tunnel and a hundred meters",
    "start": "90479",
    "end": "95549"
  },
  {
    "text": "underground it's quite large and we have this four main experiment CMS a little HTTP an Atlas where we built these",
    "start": "95549",
    "end": "102200"
  },
  {
    "text": "detectors it looks like this so this is 100 meters underground the tunnel this",
    "start": "102200",
    "end": "107430"
  },
  {
    "start": "104000",
    "end": "169000"
  },
  {
    "text": "is the Large Hadron Collider it's a superconductor it's made of superconducting magnets and to achieve",
    "start": "107430",
    "end": "112470"
  },
  {
    "text": "this we put them at the parallel low temperature very close to the absolute zero 1.7 Kelvin and then at this point",
    "start": "112470",
    "end": "120689"
  },
  {
    "text": "where we make the protons collide we build these gigantic machines so this is the compact muon solenoid CMS it's not",
    "start": "120689",
    "end": "128640"
  },
  {
    "text": "very compact compact is 14 tons and it's 40 minutes but 40 meters by 40 meters it",
    "start": "128640",
    "end": "133660"
  },
  {
    "text": "fills up the cavern it's also a 100 meters underground this acts like a gigantic camera where we try to",
    "start": "133660",
    "end": "139390"
  },
  {
    "text": "understand what happened during these collisions between the protons and we try to prove theories about the nature",
    "start": "139390",
    "end": "147310"
  },
  {
    "text": "of physics of the universe and basically we are taking 40 million pixel pictures",
    "start": "147310",
    "end": "153880"
  },
  {
    "text": "a second it's not really pictures but you can think of it like pictures and this is basically a lot of data so it",
    "start": "153880",
    "end": "160210"
  },
  {
    "text": "generates something like 1 petabyte a second we have to trim this down so that we can compute we still generates",
    "start": "160210",
    "end": "165250"
  },
  {
    "text": "everything like 10 to 15 gigabytes a second when the beam is on to produce to",
    "start": "165250",
    "end": "171310"
  },
  {
    "start": "169000",
    "end": "211000"
  },
  {
    "text": "process all this data we have a large private clouds it has close to 300",
    "start": "171310",
    "end": "178360"
  },
  {
    "text": "thousand colors these days for this talk you can see all the numbers there but for this talk the interesting part is",
    "start": "178360",
    "end": "183970"
  },
  {
    "text": "the number of clusters that we contain or clusters that we have we started by offering multiple container",
    "start": "183970",
    "end": "190540"
  },
  {
    "text": "orchestration options kubernetes by far the most popular swarm has one use case",
    "start": "190540",
    "end": "196810"
  },
  {
    "text": "which is 4-bit lab CI where people have quite a few clusters there but it still",
    "start": "196810",
    "end": "201959"
  },
  {
    "text": "it will a lot of people are also migrating to kubernetes and then missiles and DCOs we eventually",
    "start": "201959",
    "end": "207370"
  },
  {
    "text": "deprecated support because we had very few users now this is the current state",
    "start": "207370",
    "end": "213580"
  },
  {
    "start": "211000",
    "end": "258000"
  },
  {
    "text": "there's something really interesting at CERN which is we've been doing computing on large scale computing for many",
    "start": "213580",
    "end": "219490"
  },
  {
    "text": "decades which means our data center is kind of a history piece of computing and you can see on the Left picture is the",
    "start": "219490",
    "end": "227530"
  },
  {
    "text": "picture from 1970s where you can see some mainframes some cray cray man mainframes on the back and then",
    "start": "227530",
    "end": "234550"
  },
  {
    "text": "eventually the layout of the computer center changed quite a lot to have racks and here 2007 we actually had racks with",
    "start": "234550",
    "end": "243489"
  },
  {
    "text": "desktop PCs so this is truly commodity hardware that we would suffer under",
    "start": "243489",
    "end": "249090"
  },
  {
    "text": "where everyone else was shopping he'd also see some old tape silos on the right we still use tapes for a lot of",
    "start": "249090",
    "end": "255220"
  },
  {
    "text": "things but they are not round anymore they're all corridors eventually we moved to a more like",
    "start": "255220",
    "end": "261660"
  },
  {
    "start": "258000",
    "end": "306000"
  },
  {
    "text": "modern data center and this is how it looks today the building is still quite old",
    "start": "261660",
    "end": "267400"
  },
  {
    "text": "have been too high difficult to cool but we have more traditional things now in addition to all this computing that we",
    "start": "267400",
    "end": "274240"
  },
  {
    "text": "use for a large scale processing we also have people doing funny things in their offices so this is the next computer",
    "start": "274240",
    "end": "280630"
  },
  {
    "text": "that Tim berners-lee used to when he created the world wide web and was the first world wide web server and you can",
    "start": "280630",
    "end": "286690"
  },
  {
    "text": "see that this was really an imported server because it has a sticker and in this sticker it said this machine is a",
    "start": "286690",
    "end": "292990"
  },
  {
    "text": "server do not power down and this was basically the message that if when",
    "start": "292990",
    "end": "298210"
  },
  {
    "text": "cleaning if someone unplugs to plug the vacuum cleaner the web is down so that's not good and he was very clear about now",
    "start": "298210",
    "end": "307060"
  },
  {
    "start": "306000",
    "end": "438000"
  },
  {
    "text": "with the move to commodity hardware in large scale a large number of nodes we",
    "start": "307060",
    "end": "314050"
  },
  {
    "text": "had to improve a lot of the automation and efficiency of our systems and I will try to describe here a bit some of the",
    "start": "314050",
    "end": "321460"
  },
  {
    "text": "parameters that have changed a bit the way we do so when we had purely physical",
    "start": "321460",
    "end": "327010"
  },
  {
    "text": "infrastructure provisioning nodes could take days weeks maybe months if we didn't have the word the hardware and",
    "start": "327010",
    "end": "334030"
  },
  {
    "text": "you had to order it we had to the ticket way to explain your request things like this maintenance was highly intrusive we",
    "start": "334030",
    "end": "340510"
  },
  {
    "text": "frequently have two updates of the operating system and we had to coordinate with the users going to do",
    "start": "340510",
    "end": "346150"
  },
  {
    "text": "this deployments and updates we started using configuration management pretty early but still in some cases complex",
    "start": "346150",
    "end": "352810"
  },
  {
    "text": "applications can take minutes or even hours to update and it is a civilization is very poor because it's dedicated to a",
    "start": "352810",
    "end": "359050"
  },
  {
    "text": "single application even if it's not that big then introduction of quality is and especially virtualization this allowed",
    "start": "359050",
    "end": "366040"
  },
  {
    "text": "us to have a very quick way to do provisioning of resources and to kind of separate the hardware procurement from",
    "start": "366040",
    "end": "373120"
  },
  {
    "text": "the rest the maintenance in if the application was designed so that it",
    "start": "373120",
    "end": "379480"
  },
  {
    "text": "could be easily live migration migrates it we could do this without being intrusive deployment and update was",
    "start": "379480",
    "end": "386680"
  },
  {
    "text": "pretty much the same because we're already relying on configuration management utilization became much better because",
    "start": "386680",
    "end": "392440"
  },
  {
    "text": "we can overcome it resources and make sure that the loads are the nodes are balanced and",
    "start": "392440",
    "end": "398870"
  },
  {
    "text": "then containers of course we are all here so everything is great and the provisioning now is that it can take",
    "start": "398870",
    "end": "404930"
  },
  {
    "text": "seconds this is true it's less intrusive because you expressed on the application how the application can tolerate being",
    "start": "404930",
    "end": "412370"
  },
  {
    "text": "moved around so the orchestrator will do this for you you can drain notes and expect that it will deal with moving the",
    "start": "412370",
    "end": "418970"
  },
  {
    "text": "application around as appropriate and then deployment and update became faster",
    "start": "418970",
    "end": "424460"
  },
  {
    "text": "and this is what we will cover in the rest of the talk and the utilization became better mostly because we don't",
    "start": "424460",
    "end": "430520"
  },
  {
    "text": "have to external layer from the virtualization so we can make much better use especially of memory and then",
    "start": "430520",
    "end": "438830"
  },
  {
    "start": "438000",
    "end": "495000"
  },
  {
    "text": "some experiences so during this transition it's quite interesting to see how our users deal with this so when we",
    "start": "438830",
    "end": "446240"
  },
  {
    "text": "moved from physical machines to like virtual machines and cloud API we had this question constantly where is my",
    "start": "446240",
    "end": "452509"
  },
  {
    "text": "machine now I want to know where my machine is hosted things like this so people really treated them as pets and",
    "start": "452509",
    "end": "458599"
  },
  {
    "text": "they were very doubtful of the cloud so",
    "start": "458599",
    "end": "463909"
  },
  {
    "text": "they would doubt that the problems they are seeing they would blame us like as",
    "start": "463909",
    "end": "469310"
  },
  {
    "text": "first thing sometimes it's stupid sometimes it's not but still the transition was pretty easy because the",
    "start": "469310",
    "end": "475250"
  },
  {
    "text": "provisioning was much better once they were confident with it they were happy to take it but then the all the the rest",
    "start": "475250",
    "end": "482810"
  },
  {
    "text": "you still SSH to your node you can use system D you can use whatever configuration management C's log everything feels pretty much the same so",
    "start": "482810",
    "end": "489560"
  },
  {
    "text": "the the the learning curve is not very high to start using this kind of",
    "start": "489560",
    "end": "494680"
  },
  {
    "text": "infrastructure now two containers this is much more different and we have a large number of users and we get a bunch",
    "start": "494680",
    "end": "501650"
  },
  {
    "start": "495000",
    "end": "538000"
  },
  {
    "text": "of questions because you express things in a very different way you need to know",
    "start": "501650",
    "end": "506840"
  },
  {
    "text": "how to use kubernetes all the notions on kubernetes and it's not kubernetes only",
    "start": "506840",
    "end": "512510"
  },
  {
    "text": "its ingress its helm it's the CSI drivers all these things persistent",
    "start": "512510",
    "end": "517909"
  },
  {
    "text": "volumes so we get a lot of questions and there's a steep learning curve also people are still used to going to the",
    "start": "517909",
    "end": "524420"
  },
  {
    "text": "nodes so they want to access the node and then in our case we use the remote distribution so they won't be able to",
    "start": "524420",
    "end": "531480"
  },
  {
    "text": "install a package or anything and they start asking why can't I do it and we have to explain how to do this to try it",
    "start": "531480",
    "end": "538769"
  },
  {
    "start": "538000",
    "end": "583000"
  },
  {
    "text": "so this our disk is some of these cases we have one of the most interesting ones",
    "start": "538769",
    "end": "544500"
  },
  {
    "text": "is the trigger fans this is the these firms that filter the data coming in to reduce the amount of data we have to",
    "start": "544500",
    "end": "550769"
  },
  {
    "text": "process and this is a very interesting use case because they have to change the application running in the cluster very",
    "start": "550769",
    "end": "556800"
  },
  {
    "text": "fast if there's beam they want to use the to have the filter running when the beam is down they want to read to",
    "start": "556800",
    "end": "562620"
  },
  {
    "text": "redeploy simulation applications so that they make the best use of this these resources all the time so we had a lot",
    "start": "562620",
    "end": "569430"
  },
  {
    "text": "of iterations with them we also offer spark as a service where people can have a spark service in their own kubernetes",
    "start": "569430",
    "end": "574829"
  },
  {
    "text": "cluster coop flow and this we did machine learning batch on kubernetes HT",
    "start": "574829",
    "end": "581370"
  },
  {
    "text": "condor and other internal services now to try to make this transition easier we organized some trainings internally we",
    "start": "581370",
    "end": "589050"
  },
  {
    "start": "583000",
    "end": "682000"
  },
  {
    "text": "organized workshops from time to time and office hours we took this idea from the kubernetes community and this is",
    "start": "589050",
    "end": "594180"
  },
  {
    "text": "quite popular we have end-users talking to us but also between each other this is really nice",
    "start": "594180",
    "end": "599940"
  },
  {
    "text": "now one thing is quite similar most of our service managers are used already to",
    "start": "599940",
    "end": "605250"
  },
  {
    "text": "use git to maintain their configuration we so now it's called get ops but",
    "start": "605250",
    "end": "611850"
  },
  {
    "text": "storing and maintaining the versioning of the configuration of your applications in git is something that we",
    "start": "611850",
    "end": "617370"
  },
  {
    "text": "are already used to doing and this is kind of a nice opportunity to ease the",
    "start": "617370",
    "end": "622680"
  },
  {
    "text": "transition to pronounce is still having to learn everything about kubernetes they can learn how to maintain an",
    "start": "622680",
    "end": "627959"
  },
  {
    "text": "application that is running on two grenadiers just by accessing the configuration in gate and with time they",
    "start": "627959",
    "end": "634019"
  },
  {
    "text": "get more used and more confident with the internals of coronaries itself as",
    "start": "634019",
    "end": "639180"
  },
  {
    "text": "well so if you look in our case we're using puppet for all the configuration",
    "start": "639180",
    "end": "644730"
  },
  {
    "text": "the transition to helm you have manifests in puppet you have going going templates in helm yeah the",
    "start": "644730",
    "end": "652889"
  },
  {
    "text": "configuration itself we have here in in puppet and we have the values files for",
    "start": "652889",
    "end": "660000"
  },
  {
    "text": "for for a home and these are both llamo so like everyone hates yam yam abides",
    "start": "660000",
    "end": "666240"
  },
  {
    "text": "everywhere and it's something that everyone knows so it's it's quite nice it also has it's very easy to show the",
    "start": "666240",
    "end": "673290"
  },
  {
    "text": "benefits when you are using puppet to transition to something like home because of the speed of deployment and",
    "start": "673290",
    "end": "678900"
  },
  {
    "text": "iteration on the features so I'll focus the rest of the talk on helm and some of",
    "start": "678900",
    "end": "685980"
  },
  {
    "start": "682000",
    "end": "789000"
  },
  {
    "text": "the tooling that we have around to manage all of this so the first thing I",
    "start": "685980",
    "end": "691590"
  },
  {
    "text": "would like to mention is that we maintain our own charts repository actually the repositories so initially",
    "start": "691590",
    "end": "697410"
  },
  {
    "text": "we were just packaging charts from upstream and putting them into the local history the reason for this is that we",
    "start": "697410",
    "end": "702930"
  },
  {
    "text": "want to have full control over them then we move to chart museum it's still using",
    "start": "702930",
    "end": "708180"
  },
  {
    "text": "an s3 back-end but actually having an API makes things much easier also because they provide a nice plugin with",
    "start": "708180",
    "end": "714270"
  },
  {
    "text": "home push and then we have also we have two types of reporters what is what we",
    "start": "714270",
    "end": "720660"
  },
  {
    "text": "call certain repository we have all the apps to internal charts this is like to deploy and maintain the clients for our",
    "start": "720660",
    "end": "727110"
  },
  {
    "text": "storage systems and similar and also we have mirror charts these are just sync",
    "start": "727110",
    "end": "732180"
  },
  {
    "text": "triples between the upstream charts and our local ones again because we want to",
    "start": "732180",
    "end": "739050"
  },
  {
    "text": "keep some control and then we we have did the gitlab CI triggering all the maintenance of the repositories if if an",
    "start": "739050",
    "end": "747960"
  },
  {
    "text": "app streamed repository or chart gets updated its synced with our local repos",
    "start": "747960",
    "end": "754590"
  },
  {
    "text": "and then we can we maintain a branch which is our release branch where we can trigger a tag and the tag will run lint",
    "start": "754590",
    "end": "761340"
  },
  {
    "text": "tests and then eventually package and push them to the chart museum making",
    "start": "761340",
    "end": "766470"
  },
  {
    "text": "this new version available to whoever wants use it it you can define the",
    "start": "766470",
    "end": "772290"
  },
  {
    "text": "specific version of the home chart you want to use and this is really important also because not all users want to move",
    "start": "772290",
    "end": "778890"
  },
  {
    "text": "at the same time the versioning scheme we take the upstream one and we add an internal one just so that we can iterate",
    "start": "778890",
    "end": "784530"
  },
  {
    "text": "also internally if we change something in the system and then the main",
    "start": "784530",
    "end": "791649"
  },
  {
    "start": "789000",
    "end": "884000"
  },
  {
    "text": "think that we do which also other companies and institutions are doing is",
    "start": "791649",
    "end": "797019"
  },
  {
    "text": "that we don't take individual charts as the deployment unit so if you take the",
    "start": "797019",
    "end": "803199"
  },
  {
    "text": "my simple chart we will never deploy them icicle chart directly what we do is we have this meta charts or umbrella",
    "start": "803199",
    "end": "809079"
  },
  {
    "text": "charts that have all the dependencies of the actual deployment you want to do so",
    "start": "809079",
    "end": "815019"
  },
  {
    "text": "say you have an internet server with a my simple back-end what you want to deploy is the two together so we have",
    "start": "815019",
    "end": "820629"
  },
  {
    "text": "this notion of meta charts that are kept in a separate git repo where you define",
    "start": "820629",
    "end": "826540"
  },
  {
    "text": "the deployment units or releases as we will call them later we started by doing",
    "start": "826540",
    "end": "831939"
  },
  {
    "text": "this pretty much like by our own with",
    "start": "831939",
    "end": "837249"
  },
  {
    "text": "our own structure the main points here is the requirements so this is I put an example here in this case the",
    "start": "837249",
    "end": "843309"
  },
  {
    "text": "application only has one requirement which binder hub actually binder hub has many other requirements and then you",
    "start": "843309",
    "end": "849550"
  },
  {
    "text": "have the values file which is the default configuration and then you have templates and in these templates we can",
    "start": "849550",
    "end": "855519"
  },
  {
    "text": "add stuff to the charts so say for example in this case we want binder hobbies this is Jupiter notebook",
    "start": "855519",
    "end": "862600"
  },
  {
    "text": "style deployment say we want to support GPUs in the cluster the the upstream",
    "start": "862600",
    "end": "869649"
  },
  {
    "text": "chart does not handle this so we have a specific template to configure the GPU",
    "start": "869649",
    "end": "876490"
  },
  {
    "text": "setup and then a pod security policy and anything else we might have want here and now the other interesting part is",
    "start": "876490",
    "end": "883120"
  },
  {
    "text": "how to manage secrets so there are basically two options that we consider one is to build on kubernetes secrets",
    "start": "883120",
    "end": "891220"
  },
  {
    "start": "884000",
    "end": "942000"
  },
  {
    "text": "themselves or similar CRD so there is no easy way or obvious way to plug in a external secret providers in the",
    "start": "891220",
    "end": "897579"
  },
  {
    "text": "coronaries there's things like vietnamese sealed secrets that are good but there are custom resources which means that if you",
    "start": "897579",
    "end": "904120"
  },
  {
    "text": "use them it kind of breaks most of the obstruent home charts and vault is a fully managed solution but we don't have",
    "start": "904120",
    "end": "911769"
  },
  {
    "text": "a vault service in-house now the second option is to not treat handle the",
    "start": "911769",
    "end": "917019"
  },
  {
    "text": "coronary secrets directly but just to treat secrets as configuration what this means is that all the secret",
    "start": "917019",
    "end": "923259"
  },
  {
    "text": "configuration is just in the values file and you encrypt that part so whatever is is not you",
    "start": "923259",
    "end": "931520"
  },
  {
    "text": "cannot just expose the configuration then you encrypt it and there's a tool called hum-hum secrets from future",
    "start": "931520",
    "end": "938540"
  },
  {
    "text": "simple that does this with also supporting subs internally we do have a secret storage service a secret service",
    "start": "938540",
    "end": "945980"
  },
  {
    "start": "942000",
    "end": "999000"
  },
  {
    "text": "as if you wish and we built a plugin for a home that is very similar what it does",
    "start": "945980",
    "end": "952040"
  },
  {
    "text": "it builds on our only identity scheme so this part is solved we just rely on it",
    "start": "952040",
    "end": "957770"
  },
  {
    "text": "the tool is called Barbican and from OpenStack and we can just rely on the on this identity to manage all the secrets",
    "start": "957770",
    "end": "963980"
  },
  {
    "text": "the comments look like this you put hum and then you name the released the name of the release plus the project your",
    "start": "963980",
    "end": "970430"
  },
  {
    "text": "your configured in will define where the name of the encryption key that will be",
    "start": "970430",
    "end": "976610"
  },
  {
    "text": "fetched to manage the secrets then you can view just exposing the contents you can edit where the crips in memory and",
    "start": "976610",
    "end": "984250"
  },
  {
    "text": "encrypts for for storage again when you save then we have wrappers for install upgrade and and linked you have the",
    "start": "984250",
    "end": "992000"
  },
  {
    "text": "workflow there we ended up taking the plugin and reusing it also directly with coop CTO now the most interesting part i",
    "start": "992000",
    "end": "1003190"
  },
  {
    "start": "999000",
    "end": "1140000"
  },
  {
    "text": "think is when you start doing the wool flow so all of this was kind of manual a",
    "start": "1003190",
    "end": "1009760"
  },
  {
    "text": "lot of people would trigger things in their little app see is that with the push into the cluster but this means",
    "start": "1009760",
    "end": "1015340"
  },
  {
    "text": "that you have to put the cluster credentials somewhere in your gate system or in some system that interacts",
    "start": "1015340",
    "end": "1022540"
  },
  {
    "text": "with git but this was always our end goal as I mentioned to try to simplify the life of our users and then you have",
    "start": "1022540",
    "end": "1029380"
  },
  {
    "text": "here on the top right the comment that you usually use which is how many install flux where we use flux CD to",
    "start": "1029380",
    "end": "1038010"
  },
  {
    "text": "maintain this there's other options I will mention also at the end but flux",
    "start": "1038010",
    "end": "1043120"
  },
  {
    "text": "worked quite well for us we pass a bunch of default configuration and you can see",
    "start": "1043120",
    "end": "1050070"
  },
  {
    "text": "what it does it basically defines the interval that it sinks back to the",
    "start": "1050070",
    "end": "1055870"
  },
  {
    "text": "and additional repositories we need and if you look to the options there we see",
    "start": "1055870",
    "end": "1062049"
  },
  {
    "text": "a get poly interval which is the polling interval the URL URL is just the URL of",
    "start": "1062049",
    "end": "1067690"
  },
  {
    "text": "the git repo holding the meta chart on umbrella chart that it should be deployed locally and then flux what it",
    "start": "1067690",
    "end": "1074200"
  },
  {
    "text": "does it runs in your cluster and it contacts the the the git repo checking",
    "start": "1074200",
    "end": "1080710"
  },
  {
    "text": "for updates when it when it sees an update it updates a local home release",
    "start": "1080710",
    "end": "1085870"
  },
  {
    "text": "which is a custom resource and then it has a home operator that is listening to this that is implementing this custom",
    "start": "1085870",
    "end": "1093940"
  },
  {
    "text": "resource and then it applies it in the cluster so all the flow is there now",
    "start": "1093940",
    "end": "1099190"
  },
  {
    "text": "flux also does something in addition which is when you you could define a policy on the image versions where if",
    "start": "1099190",
    "end": "1107350"
  },
  {
    "text": "you update the image via some other mean in the in a docker registry it would actually write update the charts",
    "start": "1107350",
    "end": "1115149"
  },
  {
    "text": "directly and get itself making like the full cycle we are not doing this yet and",
    "start": "1115149",
    "end": "1121769"
  },
  {
    "text": "we are not sure we want to do this so what we do now we have a completely separate CI to maintain in the",
    "start": "1121769",
    "end": "1127990"
  },
  {
    "text": "applications with their their tests and then when there's a new release the",
    "start": "1127990",
    "end": "1133659"
  },
  {
    "text": "service manager has to go to the meta chart and update the version of the image directly and the configuration files and then a home release looks like",
    "start": "1133659",
    "end": "1141789"
  },
  {
    "start": "1140000",
    "end": "1244000"
  },
  {
    "text": "this you define again the the git repo that you want to pick up the home chart",
    "start": "1141789",
    "end": "1148509"
  },
  {
    "text": "from the location of the home chart and I'll try to show it in a bit and then",
    "start": "1148509",
    "end": "1155080"
  },
  {
    "text": "the branch that you want to use so by allowing to specify the branch you can play with a lot of things like having",
    "start": "1155080",
    "end": "1161470"
  },
  {
    "text": "test environments in the grid lab CI and then on the bottom you just specify the",
    "start": "1161470",
    "end": "1166869"
  },
  {
    "text": "values for for the application the structure of meta chart looks like what",
    "start": "1166869",
    "end": "1174639"
  },
  {
    "text": "is on the right so you have the meta chart on charts in this case it's called hub and inside you have this",
    "start": "1174639",
    "end": "1180669"
  },
  {
    "text": "requirements file the values file and the cust manifests that indicates before was the GPU and then you have the releases while",
    "start": "1180669",
    "end": "1187270"
  },
  {
    "text": "the namespaces and then you have the releases so in this case we maintain two different releases of this application",
    "start": "1187270",
    "end": "1192490"
  },
  {
    "text": "one for production one for staging this allows us to override the default values",
    "start": "1192490",
    "end": "1198070"
  },
  {
    "text": "for each of the environment and then the only specific thing we have is because",
    "start": "1198070",
    "end": "1203890"
  },
  {
    "text": "we have this specific secrets plugin for home we kind of put the secrets outside",
    "start": "1203890",
    "end": "1209650"
  },
  {
    "text": "of flux this is not ideal but it allows us to track this secret the",
    "start": "1209650",
    "end": "1217330"
  },
  {
    "text": "configuration part that is encrypted together with the rest of the configuration while still benefiting",
    "start": "1217330",
    "end": "1222549"
  },
  {
    "text": "from flux so this means that whenever you update the secrets you actually have",
    "start": "1222549",
    "end": "1228669"
  },
  {
    "text": "to update the cluster manual but this is not that often as the rest of the",
    "start": "1228669",
    "end": "1233679"
  },
  {
    "text": "configuration ideally this should be inside flux as well and once it supports",
    "start": "1233679",
    "end": "1239260"
  },
  {
    "text": "something like soaps we will be able to do this so now I'll switch to the demo",
    "start": "1239260",
    "end": "1246940"
  },
  {
    "start": "1244000",
    "end": "1677000"
  },
  {
    "text": "which I hope it works so I've never used this laptop my session is working",
    "start": "1246940",
    "end": "1255539"
  },
  {
    "text": "command yes cool sorry Mac is it good",
    "start": "1257190",
    "end": "1268620"
  },
  {
    "text": "cool okay so what I will do is I will",
    "start": "1268620",
    "end": "1275470"
  },
  {
    "text": "start by doing I'll run this command ok",
    "start": "1275470",
    "end": "1281830"
  },
  {
    "text": "so what this will do is like a pre setup of the cluster this sets up things like the namespace that we saw there that has",
    "start": "1281830",
    "end": "1288789"
  },
  {
    "text": "to be created before and as I mentioned we have to manage the secrets independently so this is what it does",
    "start": "1288789",
    "end": "1294030"
  },
  {
    "text": "and then so if I look into",
    "start": "1294030",
    "end": "1302159"
  },
  {
    "text": "okay so this is the comment that we saw before how install and then you pass the",
    "start": "1307050",
    "end": "1312190"
  },
  {
    "text": "default values for flux with all the default configuration and then we say that we want to pull interval of one",
    "start": "1312190",
    "end": "1318070"
  },
  {
    "text": "minute here yeah and then the URL of the",
    "start": "1318070",
    "end": "1323740"
  },
  {
    "text": "the repo using the meta chart and then we say also that we want to use a specific branch that is called demo so",
    "start": "1323740",
    "end": "1330490"
  },
  {
    "text": "what I will do is Outrigger this okay so",
    "start": "1330490",
    "end": "1341920"
  },
  {
    "text": "this just deployed flux okay this is this is I'm actually on the CERN system",
    "start": "1341920",
    "end": "1347740"
  },
  {
    "text": "right now so I'm doing this life lots of things can go wrong so we see already",
    "start": "1347740",
    "end": "1353320"
  },
  {
    "text": "that hum has one release that is called flux while this is going what I will do",
    "start": "1353320",
    "end": "1358750"
  },
  {
    "text": "is I will show you a bit more in detail what what I was talking about before so the first area we saw is this charts hub",
    "start": "1358750",
    "end": "1366190"
  },
  {
    "text": "this is the meta chart and if I look into the requirements I see that I have one requirement in this case which is",
    "start": "1366190",
    "end": "1372790"
  },
  {
    "text": "binder hub this is actually quite complex application where it well while it is deploying it actually defines the",
    "start": "1372790",
    "end": "1378760"
  },
  {
    "text": "storage for for my sequel database its deploying ingress and so it's not it's",
    "start": "1378760",
    "end": "1384730"
  },
  {
    "text": "not that simple and then we have also the hub templates GPU where we deploy",
    "start": "1384730",
    "end": "1394150"
  },
  {
    "text": "the nvidia driver on the cluster this is tied to the kernel of course so if you are handling GPUs you will know how much",
    "start": "1394150",
    "end": "1401860"
  },
  {
    "text": "fun this is and so it's basically deploying this is also for the cluster",
    "start": "1401860",
    "end": "1406870"
  },
  {
    "text": "to be able to handle GPUs and then the releases have all this that we saw the",
    "start": "1406870",
    "end": "1412420"
  },
  {
    "text": "prod the staging and then we have this and inside the demo one we have a home",
    "start": "1412420",
    "end": "1418750"
  },
  {
    "text": "release where we define things we said",
    "start": "1418750",
    "end": "1424300"
  },
  {
    "text": "that the demo branch is using this external configuration to fetch the",
    "start": "1424300",
    "end": "1429730"
  },
  {
    "text": "secret data and then a bunch of stuff for for the configuration of the application so if I look now there we go",
    "start": "1429730",
    "end": "1437490"
  },
  {
    "text": "so now we have while we were talking flux detected now I have a new I saw a",
    "start": "1437490",
    "end": "1444450"
  },
  {
    "text": "hum release in the git repo I will deploy it and then the helm operator saw the new hum release and applied it to",
    "start": "1444450",
    "end": "1452880"
  },
  {
    "text": "the to the cluster so we have two releases here if we see quickly here",
    "start": "1452880",
    "end": "1459890"
  },
  {
    "text": "it's still creating so it's deploy its finalizing the requirement there we go",
    "start": "1459890",
    "end": "1466320"
  },
  {
    "text": "so now it's validating so that we are almost there and what I will do is I",
    "start": "1466320",
    "end": "1472050"
  },
  {
    "text": "will try to access it so you can see that's 404 not found because I opened it because before deploying earlier now if",
    "start": "1472050",
    "end": "1479730"
  },
  {
    "text": "all go we'll go I'll have to login also so you'll see the new cern login page",
    "start": "1479730",
    "end": "1487670"
  },
  {
    "text": "this works yeah so this also takes care of things",
    "start": "1487670",
    "end": "1493050"
  },
  {
    "text": "like single sign-on registration and things like this so it's quite complete even if it took only a couple of seconds",
    "start": "1493050",
    "end": "1499410"
  },
  {
    "text": "and now logged in and there we go so we have a full Jupiter notebook application",
    "start": "1499410",
    "end": "1505710"
  },
  {
    "text": "running with the my simple database and all the fancy whistles if I would I",
    "start": "1505710",
    "end": "1511230"
  },
  {
    "text": "could create it here my server and what I will do I don't know choose some",
    "start": "1511230",
    "end": "1516930"
  },
  {
    "text": "machine learning thing and I will go for GPUs and I could just go and deploy my",
    "start": "1516930",
    "end": "1523230"
  },
  {
    "text": "notebook there's another application that I deployed here I will do a slide",
    "start": "1523230",
    "end": "1528270"
  },
  {
    "text": "cheat here I assume which is the the second chart actually has one bug that",
    "start": "1528270",
    "end": "1535380"
  },
  {
    "text": "was introduced recently so I have to do a quick patch for this to work but it's a coupe city or patch it's also quite",
    "start": "1535380",
    "end": "1540840"
  },
  {
    "text": "fast and useful for demos so this should hopefully work",
    "start": "1540840",
    "end": "1546950"
  },
  {
    "text": "now yeah so we also have this is the main application that relies on an adapter hub deployment behind and the",
    "start": "1552070",
    "end": "1559580"
  },
  {
    "text": "main application says welcome to certain binder hub and it's running on a certain cluster now what I will try to do here",
    "start": "1559580",
    "end": "1565580"
  },
  {
    "text": "quickly if I have some time I will actually edit this",
    "start": "1565580",
    "end": "1571150"
  },
  {
    "text": "live from cocoon and I will add it",
    "start": "1577570",
    "end": "1586679"
  },
  {
    "text": "commit and in theory now if we wait up",
    "start": "1586799",
    "end": "1600399"
  },
  {
    "text": "to a minute how flux will detect this and apply that we can also trigger it",
    "start": "1600399",
    "end": "1606369"
  },
  {
    "text": "immediately by doing this so this is",
    "start": "1606369",
    "end": "1611919"
  },
  {
    "text": "actually triggering and it's so that there's a new commit and you can see the commit ID here matching the one we just",
    "start": "1611919",
    "end": "1618519"
  },
  {
    "text": "did here this is all looking good we'll take a second okay and now if we do a",
    "start": "1618519",
    "end": "1628929"
  },
  {
    "text": "hammer less we probably won't see it we already see a revision to so it already applied the change there if we do now",
    "start": "1628929",
    "end": "1638019"
  },
  {
    "text": "refresh here there we go",
    "start": "1638019",
    "end": "1643090"
  },
  {
    "text": "live from coca-cola in the banner so the change I did was just doing a small change in the banner",
    "start": "1643090",
    "end": "1650609"
  },
  {
    "text": "and that's it for a live demo so that was the last one of the year and I'm happy it also worked although there's",
    "start": "1651720",
    "end": "1659309"
  },
  {
    "text": "always something okay so okay so this",
    "start": "1659309",
    "end": "1665220"
  },
  {
    "text": "was just a this is actually how we deployed this application I'm using a repository that is actually the stuff we",
    "start": "1665220",
    "end": "1674789"
  },
  {
    "text": "use for production so it's just a branch on it so the last bit I'll finalize now",
    "start": "1674789",
    "end": "1679980"
  },
  {
    "text": "there's a way what we also want to extend this not only to manage the applications for the end-users but to",
    "start": "1679980",
    "end": "1686039"
  },
  {
    "text": "manage the clusters themselves so right now our cluster rocket orchestration Orchestrator is is doing all the add-ons",
    "start": "1686039",
    "end": "1692309"
  },
  {
    "text": "also and this is a quite messy mix of batch script sound charts and things like this so we want to move it",
    "start": "1692309",
    "end": "1698250"
  },
  {
    "text": "completely to a hunger release that will be managed by flux and maintain two or a",
    "start": "1698250",
    "end": "1703470"
  },
  {
    "text": "couple of environments production staging maybe others so that people can choose when they register there when",
    "start": "1703470",
    "end": "1709380"
  },
  {
    "text": "they create a cluster they want to use the staging branch or the production branch and then we'll centrally manage",
    "start": "1709380",
    "end": "1714990"
  },
  {
    "text": "all the add-ons which will simplify a lot the upgrades and here I put some some example so the dependencies we",
    "start": "1714990",
    "end": "1721830"
  },
  {
    "text": "would manage these things like font II and the configuration to push the logs to our elastic search parameters and",
    "start": "1721830",
    "end": "1726929"
  },
  {
    "text": "pushing the metrics to our central metric service traffic for ingress things like this so I come to the",
    "start": "1726929",
    "end": "1734309"
  },
  {
    "start": "1733000",
    "end": "1866000"
  },
  {
    "text": "conclusion we are relying a lot on home as you could see and we are now relying",
    "start": "1734309",
    "end": "1741299"
  },
  {
    "text": "on things like flux or art or flux as a familiar tool set to handle can tell",
    "start": "1741299",
    "end": "1747780"
  },
  {
    "text": "containerized applications if you think about it it's basically doing the same we were doing for for note management",
    "start": "1747780",
    "end": "1754049"
  },
  {
    "text": "but for containers which has like all the benefits of using containers instead of individual nodes we want to remain as",
    "start": "1754049",
    "end": "1762330"
  },
  {
    "text": "we'd get as the source of truth so this allows us to define all the permissions on the git repositories and separate by",
    "start": "1762330",
    "end": "1772200"
  },
  {
    "text": "groups there we are ready doing it so this is one of the main reasons why we want to keep doing it and now for future",
    "start": "1772200",
    "end": "1777750"
  },
  {
    "text": "steps we want as everyone to use HMMWV 3 so this was a demo with v2 but we all",
    "start": "1777750",
    "end": "1784830"
  },
  {
    "text": "right started using v33 to get rid of chiller mostly but there are also other nice",
    "start": "1784830",
    "end": "1791010"
  },
  {
    "text": "features there's the home hub or it's unclear to us how we will manage this",
    "start": "1791010",
    "end": "1796410"
  },
  {
    "text": "but the idea would be to have a local replica of this or at least the charts we are interested as we want to keep",
    "start": "1796410",
    "end": "1802740"
  },
  {
    "text": "some control and we want to start signing charts so this is something that we are working on right now",
    "start": "1802740",
    "end": "1809480"
  },
  {
    "text": "now automating the container image deployment is something that we might",
    "start": "1809480",
    "end": "1815250"
  },
  {
    "text": "reconsider we will see how this goes and then the main thing we are working on",
    "start": "1815250",
    "end": "1821130"
  },
  {
    "text": "now is to have clusters not being pets the same way we were not so happy that",
    "start": "1821130",
    "end": "1826680"
  },
  {
    "text": "people treat notice as pets one of the main frustrations is I know a",
    "start": "1826680",
    "end": "1832590"
  },
  {
    "text": "lot of things can go wrong with the cluster we do the tools to recover it but it also causes frustration so we're",
    "start": "1832590",
    "end": "1838950"
  },
  {
    "text": "trying to convince people to have this kind of easy way of deploying their application to new clusters so that they",
    "start": "1838950",
    "end": "1845430"
  },
  {
    "text": "can have they can spread the load and maybe lose some capacity when one goes",
    "start": "1845430",
    "end": "1850500"
  },
  {
    "text": "down but at least keep the application always up and then using cannery and",
    "start": "1850500",
    "end": "1856790"
  },
  {
    "text": "surface finished for cannery deployments we are still not very experienced with",
    "start": "1856790",
    "end": "1863460"
  },
  {
    "text": "the service mesh but we started looking at it so I don't know if you follow this area when you choose a tool like we",
    "start": "1863460",
    "end": "1871290"
  },
  {
    "start": "1866000",
    "end": "1889000"
  },
  {
    "text": "chose hum and we chose flux there's always the problem of will it last it",
    "start": "1871290",
    "end": "1876900"
  },
  {
    "text": "will there be something new argh OCD is a good option also and it's",
    "start": "1876900",
    "end": "1882930"
  },
  {
    "text": "really it's really good that they decided to merge it have the effort and call it our go flux in a single project",
    "start": "1882930",
    "end": "1888360"
  },
  {
    "text": "now and with this I come to the conclusion I open for questions but if",
    "start": "1888360",
    "end": "1894630"
  },
  {
    "start": "1889000",
    "end": "1921000"
  },
  {
    "text": "you want to come and visit us so we have a visit service that you can visit CERN every day and until the end of next year",
    "start": "1894630",
    "end": "1900840"
  },
  {
    "text": "we'll be in a shutdown period during upgrades which means you can go underground and visit the experiments which is really really cool and we also",
    "start": "1900840",
    "end": "1907410"
  },
  {
    "text": "have a tech blog that you can see at this URL and if you have any questions just contact me also after thank you",
    "start": "1907410",
    "end": "1914520"
  },
  {
    "text": "[Applause]",
    "start": "1914520",
    "end": "1922859"
  }
]