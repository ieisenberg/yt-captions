[
  {
    "text": "hello hello everybody officially day number one I guess",
    "start": "0",
    "end": "8299"
  },
  {
    "text": "day plus one or two if you've been to some of the co-located events",
    "start": "8760",
    "end": "15440"
  },
  {
    "text": "thank you for coming",
    "start": "16440",
    "end": "19340"
  },
  {
    "text": "I'm Evan Gilman I'm a maintainer on uh spiffy inspired projects both",
    "start": "21539",
    "end": "28140"
  },
  {
    "text": "I've been on those projects for uh since they were started I guess as",
    "start": "28140",
    "end": "34680"
  },
  {
    "text": "for five and a half years maybe or so in 2017. and um title of the talk today is don't",
    "start": "34680",
    "end": "41160"
  },
  {
    "text": "mind the gap we're going to be talking predominantly about how to use spit the identities to",
    "start": "41160",
    "end": "47879"
  },
  {
    "text": "authenticate to third-party resources um specifically to",
    "start": "47879",
    "end": "53160"
  },
  {
    "text": "the three major Cloud providers there's a few tricks up our sleeve we can talk about others have kind of",
    "start": "53160",
    "end": "59940"
  },
  {
    "text": "clued into the trick over the last year or two um which some of you may have noticed",
    "start": "59940",
    "end": "66798"
  },
  {
    "text": "I'm trying to keep this talk as casual as possible",
    "start": "67860",
    "end": "73100"
  },
  {
    "text": "I've got 20 slides it's been around 20 minutes if folks have questions anything like that please feel free to raise your hand",
    "start": "73200",
    "end": "79320"
  },
  {
    "text": "in the middle of the talk I'm happy to kind of stop and answer your questions make it personal",
    "start": "79320",
    "end": "85799"
  },
  {
    "text": "I've got a mic up here there's a mic back there or we can shout or we'll figure it out",
    "start": "85799",
    "end": "91880"
  },
  {
    "text": "um so we'll talk first about the spiffy Basics kind of we won't go over all of spiffy",
    "start": "93000",
    "end": "99119"
  },
  {
    "text": "but we'll go over the things that are important to understand for the content in this in this presentation",
    "start": "99119",
    "end": "107298"
  },
  {
    "text": "um similar thing for aspire cover kind of at a high level some of the important things",
    "start": "107460",
    "end": "114119"
  },
  {
    "text": "that you'll you'll need to kind of make sense of the rest of the talk and then I'll step through kind of like three",
    "start": "114119",
    "end": "119820"
  },
  {
    "text": "examples of how to do this AWS Azure and gcp they're all kind of",
    "start": "119820",
    "end": "127740"
  },
  {
    "text": "um they all leverage kind of the same underlying technology but you know have",
    "start": "127740",
    "end": "133680"
  },
  {
    "text": "their little quirks and differences here and there kind of thing and then finally we'll have hopefully",
    "start": "133680",
    "end": "139860"
  },
  {
    "text": "plenty of time at the end for Q a uh if nobody raises their hand during my presentation which I hope they do",
    "start": "139860",
    "end": "147140"
  },
  {
    "text": "so without further ado you can dive on oops wrong one spiffy",
    "start": "148920",
    "end": "154080"
  },
  {
    "text": "basics the first thing to know about spiffy is a spiffy ID and I apologize I some",
    "start": "154080",
    "end": "160020"
  },
  {
    "text": "people here tend to be newcomers some people tend to not be so bear with me",
    "start": "160020",
    "end": "165599"
  },
  {
    "text": "the spiffy ideas kind of what it sounds like it's basically like a username for workloads",
    "start": "165599",
    "end": "171000"
  },
  {
    "text": "and specifically deals with workload identity this is kind of like the core thing and as you can see here it's it's like a",
    "start": "171000",
    "end": "177959"
  },
  {
    "text": "structured string is structured as a URI it is compatible with 3986 or whatever that your irfc is it does have some like",
    "start": "177959",
    "end": "186000"
  },
  {
    "text": "additional limitations placed on top of that and to constrain so there's a lot of stuff in that RFC if you spend",
    "start": "186000",
    "end": "192239"
  },
  {
    "text": "adequate amount of time you'll you'll understand that and uh so there's a few kind of critical",
    "start": "192239",
    "end": "198180"
  },
  {
    "text": "parts um the first one is of course the scheme of spiffy which just kind of States this is a specific ID",
    "start": "198180",
    "end": "204540"
  },
  {
    "text": "the second is this piece we call the trust domain and Trust domain is",
    "start": "204540",
    "end": "211159"
  },
  {
    "text": "what I would call kind of like a security domain you use a one-to-one relationship between a trust domain name",
    "start": "211200",
    "end": "216659"
  },
  {
    "text": "and a set of identity issuers so when you look at a trust domain name you should immediately know okay it's",
    "start": "216659",
    "end": "222900"
  },
  {
    "text": "coming from kind of this zone or these set of issuers and you can see because it's part of the",
    "start": "222900",
    "end": "229019"
  },
  {
    "text": "ID all of the spiffy IDs are qualified by this trust domain name and then the final piece is kind of the",
    "start": "229019",
    "end": "235319"
  },
  {
    "text": "name of the service and this can be you know you can have multiple levels in there the same as a regular URI you can make it hierarchical you can make it",
    "start": "235319",
    "end": "241260"
  },
  {
    "text": "however you want the spec doesn't say much about restricting kind of the values of these",
    "start": "241260",
    "end": "247500"
  },
  {
    "text": "things this is a little bit of a Choose Your Own Adventure but given the spiffy ID you can kind of see immediately you",
    "start": "247500",
    "end": "253920"
  },
  {
    "text": "know which authority issued this identity and what is the identity of the workload",
    "start": "253920",
    "end": "259739"
  },
  {
    "text": "that it's supposed to represent right the name of the workload is supposed to represent and then these specific ideas they get",
    "start": "259739",
    "end": "267060"
  },
  {
    "text": "encoded into a document specifically supports two documents right now it supports a x509 certificate",
    "start": "267060",
    "end": "274500"
  },
  {
    "text": "and it also supports jot token ATM machine and uh so there's some spec around kind",
    "start": "274500",
    "end": "282240"
  },
  {
    "text": "of like how you embed this ID into a cert or into a jaw and where you find it how you validated all that kind of stuff",
    "start": "282240",
    "end": "290160"
  },
  {
    "text": "so that's the 50 ID thing and a little bit of what we call that document and svid uh spiffy verifiable",
    "start": "290160",
    "end": "297300"
  },
  {
    "text": "identity document then we have this thing called the bundle the bundle is that collection of",
    "start": "297300",
    "end": "304620"
  },
  {
    "text": "authority Keys you know so when I talk about a trust domain and there's some set of authorities in a trust domain",
    "start": "304620",
    "end": "310320"
  },
  {
    "text": "that are responsible for issuing identities you know they have these authorities have a set of public",
    "start": "310320",
    "end": "315600"
  },
  {
    "text": "private key pair this bundle is a collection of those things so you know you'll have a one",
    "start": "315600",
    "end": "321840"
  },
  {
    "text": "bundle per trust domain and the bundle captures all the signing keys that are authoritative for that trust domain",
    "start": "321840",
    "end": "328680"
  },
  {
    "text": "you can see that they're specified that this it's for this kind of exit or that kind of s vid",
    "start": "328680",
    "end": "335100"
  },
  {
    "text": "uh and these can grow you know we do uh spiffy supports root rotation this way you know so these can kind of grow and",
    "start": "335100",
    "end": "341400"
  },
  {
    "text": "Shrink as time goes on you know you can introduce a new key in advance rotate to it remove the old key that kind of thing",
    "start": "341400",
    "end": "347220"
  },
  {
    "text": "so these bundles are kind of living and breathing in a way and then you know the keys that are",
    "start": "347220",
    "end": "353880"
  },
  {
    "text": "referenced in this bundle then used to sign message for that trust domain and that's how the validation happens",
    "start": "353880",
    "end": "360740"
  },
  {
    "text": "so then when we talk about spiffy Federation what does that mean you know that's like hey I want to take identities from one",
    "start": "361440",
    "end": "367800"
  },
  {
    "text": "domain or one set of systems and talk across this boundary to another set of systems into another domain",
    "start": "367800",
    "end": "373560"
  },
  {
    "text": "how does that happen that's fairly simply just this collection of kind of bundle data that",
    "start": "373560",
    "end": "379919"
  },
  {
    "text": "we just looked at and you'll keep this map and you'll know hey I trust domain Foo there's the bundle Tresemme bar",
    "start": "379919",
    "end": "385319"
  },
  {
    "text": "here's the bundle and when you encounter one of these svids you can kind of do this lookup you",
    "start": "385319",
    "end": "390539"
  },
  {
    "text": "can say okay this test fit is there's this Smithy ID therefore is from this trust domain and I select the bundle for that trust",
    "start": "390539",
    "end": "397139"
  },
  {
    "text": "domain to do the validation by doing it this way it's a lot different than like webpki",
    "start": "397139",
    "end": "403680"
  },
  {
    "text": "which has kind of a set of you know keys and search handed down",
    "start": "403680",
    "end": "409319"
  },
  {
    "text": "from on high that are good for anything kind of thing right spiffy like delineates this and says okay we",
    "start": "409319",
    "end": "416759"
  },
  {
    "text": "want only authorities to be good for certain aspects and this gives the kind of isolation I had mentioned earlier",
    "start": "416759",
    "end": "422340"
  },
  {
    "text": "security domain you know if one of these trust domains is compromised it doesn't",
    "start": "422340",
    "end": "427699"
  },
  {
    "text": "automatically translate into another trust it may be compromised because they're totally separate signing infrastructure and totally separate keys",
    "start": "427699",
    "end": "434340"
  },
  {
    "text": "so we usually see people use these trust domains things like staging production Coke Pepsi you know cross org cross",
    "start": "434340",
    "end": "442680"
  },
  {
    "text": "environment that kind of stuff so that's spiffy one of the important",
    "start": "442680",
    "end": "449639"
  },
  {
    "text": "parts for this talk at least we'll talk a little bit about Spire for",
    "start": "449639",
    "end": "454919"
  },
  {
    "text": "a minute Spire is a software implementation of the spiffy specs",
    "start": "454919",
    "end": "461220"
  },
  {
    "text": "so we talk about circs and Trust domains and all this stuff like who is signing those shirts",
    "start": "461220",
    "end": "467160"
  },
  {
    "text": "you know and where do I get them from all this kind of stuff that's what Spire does",
    "start": "467160",
    "end": "472800"
  },
  {
    "text": "expires written and go it's designed to run in as many environments as possible spiffy is platform agnostic",
    "start": "472800",
    "end": "479340"
  },
  {
    "text": "and Spire is kind of like what should I say like the darling implementation of spiffy",
    "start": "479340",
    "end": "486180"
  },
  {
    "text": "and so in as much as spiffy is intended to be run out of everywhere Aspire is as well",
    "start": "486180",
    "end": "492620"
  },
  {
    "text": "runs on Linux runs on Darwin or run on your bsds and as I've recently it'll run",
    "start": "492620",
    "end": "499319"
  },
  {
    "text": "on Windows too so these are the kind of the high level",
    "start": "499319",
    "end": "504479"
  },
  {
    "text": "components so Inspire Spire has a server or component and an agent component",
    "start": "504479",
    "end": "510360"
  },
  {
    "text": "the server component is the piece that does all the siding just got the keys it's got all that good",
    "start": "510360",
    "end": "516360"
  },
  {
    "text": "sensitive stuff then we have these agents these agents run nominally on a per node basis and they're the ones who are actually",
    "start": "516360",
    "end": "522539"
  },
  {
    "text": "providing the identities to the workloads one of the",
    "start": "522539",
    "end": "528240"
  },
  {
    "text": "really important things about spiffy is that it solves this problem that we call secure introduction or a",
    "start": "528240",
    "end": "534480"
  },
  {
    "text": "secret zero problem so you know we need to play software and it pops up",
    "start": "534480",
    "end": "540060"
  },
  {
    "text": "how does it speak to the first system you know how does it begin that first authentication process a lot of people",
    "start": "540060",
    "end": "546120"
  },
  {
    "text": "try to solve this through injection of credentials baking things in the containers and all kinds of other stuff",
    "start": "546120",
    "end": "553440"
  },
  {
    "text": "spiffy doesn't require any of that it has this concept of what we call workload API and that's what these",
    "start": "553440",
    "end": "558899"
  },
  {
    "text": "agents provide so when a workload is deployed and it pops up it talks to these agents over this workload API it doesn't the",
    "start": "558899",
    "end": "564779"
  },
  {
    "text": "workload doesn't have to have any kind of secret or anything like that and he doesn't need a token or anything it kind of just",
    "start": "564779",
    "end": "570720"
  },
  {
    "text": "says hey who am I and then it's the spiffy implementation's job in this case Spire to figure that out and the end result of",
    "start": "570720",
    "end": "577920"
  },
  {
    "text": "that process is the issuance of an identity and so when we talk about doing this",
    "start": "577920",
    "end": "583080"
  },
  {
    "text": "without any kind of uh secret being necessary or token or what have you",
    "start": "583080",
    "end": "588300"
  },
  {
    "text": "you kind of need a way to describe things right and you need you need to declare hey you know Bob is Bob",
    "start": "588300",
    "end": "594360"
  },
  {
    "text": "Alice is Alice so Aspire has this concept of registration",
    "start": "594360",
    "end": "600600"
  },
  {
    "text": "in order for a workload to get an identity from spire it must first be registered",
    "start": "600600",
    "end": "606540"
  },
  {
    "text": "and the registration is basically saying like hey look we've got this workloader her name is Alice",
    "start": "606540",
    "end": "612779"
  },
  {
    "text": "she runs generally in this cluster over here this is her General shape and look she's this tall and whatnot when you see",
    "start": "612779",
    "end": "619260"
  },
  {
    "text": "this workload you know that's Alice and you give her the Alice identity so this is uh together this information",
    "start": "619260",
    "end": "626459"
  },
  {
    "text": "is what we would call a registration which is effectively that description what is the workload's name what does it",
    "start": "626459",
    "end": "632940"
  },
  {
    "text": "look like and where should it be running and then the final piece of all this",
    "start": "632940",
    "end": "638760"
  },
  {
    "text": "Aspire component stuff is what we call the Spire oidc Discovery",
    "start": "638760",
    "end": "644040"
  },
  {
    "text": "provider this is a separate piece of software it's shipped as part of the Spire release",
    "start": "644040",
    "end": "650160"
  },
  {
    "text": "as a supporting utility and it can run kind of next to Spire",
    "start": "650160",
    "end": "655200"
  },
  {
    "text": "server or next to an agent whichever makes more sense for you and its job is to kind of massage this",
    "start": "655200",
    "end": "661980"
  },
  {
    "text": "spiffy bundle into something that looks a little bit like oidc oidc is",
    "start": "661980",
    "end": "668040"
  },
  {
    "text": "a technology ice openid connect so technology that was I should say a",
    "start": "668040",
    "end": "673800"
  },
  {
    "text": "standard that was defined predominantly for user auth but it's kind of a hijacked a bit here",
    "start": "673800",
    "end": "679860"
  },
  {
    "text": "and and in other places too to do also kind of workload off um it's very very simple HTT HTTP based",
    "start": "679860",
    "end": "689519"
  },
  {
    "text": "process regular web TLS protection around it so this IDC Discovery provider",
    "start": "689519",
    "end": "695279"
  },
  {
    "text": "supports acne so you know you can deploy this thing it'll come up and you know it can grab a webpk icer and it can kind of",
    "start": "695279",
    "end": "701160"
  },
  {
    "text": "serve these Keys up for you in a public fashion and then what it does is in this massaging here as you see the oidc spec",
    "start": "701160",
    "end": "709560"
  },
  {
    "text": "is is very the Smithy the bundle spec is very very similar to the",
    "start": "709560",
    "end": "714600"
  },
  {
    "text": "oidc key spec however there are some minor divergences and so what this oidc",
    "start": "714600",
    "end": "720779"
  },
  {
    "text": "discovery provider effectively does is Munch this thing and expose it with a",
    "start": "720779",
    "end": "726240"
  },
  {
    "text": "what PK I start so you can see here we redacted like some of the x509 related key material",
    "start": "726240",
    "end": "732240"
  },
  {
    "text": "and we also redact this particular use field which we have found uh to be",
    "start": "732240",
    "end": "737820"
  },
  {
    "text": "problematic with some oidc validators so this is kind of the final piece to",
    "start": "737820",
    "end": "743760"
  },
  {
    "text": "like make the whole thing work end to end so you know our previous diagram",
    "start": "743760",
    "end": "749160"
  },
  {
    "text": "you know if we replace the right hand side with just AWS uh AWS can kind of stand in here and and",
    "start": "749160",
    "end": "755579"
  },
  {
    "text": "hit this by our server and grab those keys and do validation the same way that another Spire server might be able to do",
    "start": "755579",
    "end": "760620"
  },
  {
    "text": "this I didn't though the diagram I have here doesn't show the oidc discovery provider but it",
    "start": "760620",
    "end": "767399"
  },
  {
    "text": "would be running kind of in this diagram collocated with the Spire server as a part of his pod or something like",
    "start": "767399",
    "end": "773760"
  },
  {
    "text": "that and so how exactly does this work",
    "start": "773760",
    "end": "780620"
  },
  {
    "text": "oopsies AWS has this concept of a Federated web",
    "start": "780779",
    "end": "787139"
  },
  {
    "text": "identity there's a service in AWS called the STS I can't remember it's simple or secure",
    "start": "787139",
    "end": "793320"
  },
  {
    "text": "token service I'm pretty sure it's the last two and uh what it enables you to do is is",
    "start": "793320",
    "end": "798959"
  },
  {
    "text": "to go and exchange a credential for an AWS credential so what we can do using this endpoint is we can come to it with",
    "start": "798959",
    "end": "806639"
  },
  {
    "text": "a spiffy ID with a spiffy credential and we can exchange the spiffy credential for a time-bound temporary AWS secret",
    "start": "806639",
    "end": "814560"
  },
  {
    "text": "access key and the magic about this is that hey you know spiffy doesn't require you to like",
    "start": "814560",
    "end": "821579"
  },
  {
    "text": "store secrets on disk or do anything it does all the stuff at runtime doesn't require to do Secrets injection Secrets",
    "start": "821579",
    "end": "826980"
  },
  {
    "text": "management anytime that you have to talk to S3 for example",
    "start": "826980",
    "end": "832560"
  },
  {
    "text": "you're going to need an AWS secret access key and there's a lot of pain around managing these things oftentimes they don't expire people have",
    "start": "832560",
    "end": "839639"
  },
  {
    "text": "MFA policies on their account but then they have to get the non-mfa secret access keys for their workloads because how do you do MFA with your workload",
    "start": "839639",
    "end": "846660"
  },
  {
    "text": "all these kinds of pain so the way that we do this is we create this mapping this trust relationship in",
    "start": "846660",
    "end": "852000"
  },
  {
    "text": "AWS and we set up this web identity provider and you point it at the IDC",
    "start": "852000",
    "end": "857700"
  },
  {
    "text": "Discovery thing that runs next to your Spire server and once you've set this up",
    "start": "857700",
    "end": "862740"
  },
  {
    "text": "you can then create this mapping like I said here on the top you can see that there's a role AR on so here what we're saying is this particular AWS IM role is",
    "start": "862740",
    "end": "870600"
  },
  {
    "text": "mapped to this particular Smithy ID on the bottom right spiffy example.com that's through testdot and so when",
    "start": "870600",
    "end": "877380"
  },
  {
    "text": "somebody hits STS and they've got this particular identity and this particular audience this is",
    "start": "877380",
    "end": "883440"
  },
  {
    "text": "with jot token by the way then the caller is entitled to receive",
    "start": "883440",
    "end": "888899"
  },
  {
    "text": "temporary credentials for the role described at the top and this is pretty awesome because it",
    "start": "888899",
    "end": "895500"
  },
  {
    "text": "negates the whole where do the keys go where do they live I put them in a vault how do they get injected how do I rotate",
    "start": "895500",
    "end": "900839"
  },
  {
    "text": "them well things break if I rotate them and all this kind of stuff so this is this is kind of the basic",
    "start": "900839",
    "end": "906839"
  },
  {
    "text": "trick uh it is made way cooler by this little",
    "start": "906839",
    "end": "912899"
  },
  {
    "text": "project that square wrote you'll notice a theme and and and these Integrations that all three of the cloud",
    "start": "912899",
    "end": "919920"
  },
  {
    "text": "Integrations I'm talking about today have been written and published by the community we have a really strong wonderful Community species buyer and",
    "start": "919920",
    "end": "926940"
  },
  {
    "text": "people publish these kinds of things all the time and supporting code to go with it so kind of standing on the shoulders of",
    "start": "926940",
    "end": "933120"
  },
  {
    "text": "giants and and a bit in the parts of this presentation so square has written and published this",
    "start": "933120",
    "end": "939839"
  },
  {
    "text": "Tool uh to help you do this authentication in AWS with a lot less headache even though you've already",
    "start": "939839",
    "end": "946380"
  },
  {
    "text": "removed the headache of the AWS secret access key there's more headache to be removed and the way that this works",
    "start": "946380",
    "end": "953639"
  },
  {
    "text": "is by shipping this little utility that hooks into the standard AWS config",
    "start": "953639",
    "end": "960600"
  },
  {
    "text": "file and so all you basically all you have to do is you drop this little config file",
    "start": "960600",
    "end": "966420"
  },
  {
    "text": "on disk and you also drop this if the AWS assumeral utility on disk",
    "start": "966420",
    "end": "971880"
  },
  {
    "text": "and so long as your app uses uh the AWS SDK to talk to S3 or redshift or",
    "start": "971880",
    "end": "978060"
  },
  {
    "text": "whatever else you're using the the logic to hook and look for this config file and call out and do all this",
    "start": "978060",
    "end": "984300"
  },
  {
    "text": "stuff is already there so these apps that have this AWS SDK they can be running anywhere they can be",
    "start": "984300",
    "end": "989699"
  },
  {
    "text": "running on-prem they can be running in azure you name it it could be running under your desk",
    "start": "989699",
    "end": "995339"
  },
  {
    "text": "so long as they're able to get a spiffy credential then they don't actually have to be",
    "start": "995339",
    "end": "1002060"
  },
  {
    "text": "written with the spiffy SDK they can just use the regular out of the box AWS SDK with this little helper utility and",
    "start": "1002060",
    "end": "1008120"
  },
  {
    "text": "what this helper utility does is it knows how to talk to the workload API grab a Smithy identity go talk to STS",
    "start": "1008120",
    "end": "1014839"
  },
  {
    "text": "grab the temporary STS credential and then return it back to the app",
    "start": "1014839",
    "end": "1019880"
  },
  {
    "text": "so we have a lot of people who have migrated apps out of AWS",
    "start": "1019880",
    "end": "1025298"
  },
  {
    "text": "that are none the wiser effectively because none of the app code has to be changed all they need to do is drop",
    "start": "1025299",
    "end": "1030798"
  },
  {
    "text": "these configs on disk and you're Off to the Races so that's pretty cool",
    "start": "1030799",
    "end": "1038620"
  },
  {
    "text": "I'll show you a little bit about azure similar thing",
    "start": "1039199",
    "end": "1044240"
  },
  {
    "text": "they have a service that you can go to and again it knows how to do the oidc swap and you can bring your spiffy drop",
    "start": "1044240",
    "end": "1049940"
  },
  {
    "text": "there and they can map that back too an Azure identity",
    "start": "1049940",
    "end": "1055820"
  },
  {
    "text": "this blog post identity digest blog is an excellent blog",
    "start": "1055820",
    "end": "1061640"
  },
  {
    "text": "Uday I believe as a identity architect at Microsoft he's been there almost a quarter century",
    "start": "1061640",
    "end": "1067760"
  },
  {
    "text": "wrote up this really great how-to on how to use spiffy identities to authenticate to azure",
    "start": "1067760",
    "end": "1074360"
  },
  {
    "text": "and he also published this diagram which is kind of you know",
    "start": "1074360",
    "end": "1081140"
  },
  {
    "text": "spelling out the flow that I was just describing right you have Aspire server you have this IDC",
    "start": "1081140",
    "end": "1087260"
  },
  {
    "text": "thing you've got a workload it comes up it gets a spiffy ID it goes and talks to this endpoint in Azure does this",
    "start": "1087260",
    "end": "1093140"
  },
  {
    "text": "exchange it gets back Azure creds and then with the Azure credits you can do whatever it wants",
    "start": "1093140",
    "end": "1099140"
  },
  {
    "text": "now you know that kubernetes cluster that big green part there like I said that can be anywhere it doesn't have to be in Azure because the spiffy identity",
    "start": "1099140",
    "end": "1105320"
  },
  {
    "text": "is platform agnostic and finally we have gcp",
    "start": "1105320",
    "end": "1114380"
  },
  {
    "text": "similar trick here this is from Christoph grotz he's an engineer on Google Cloud team",
    "start": "1114380",
    "end": "1120140"
  },
  {
    "text": "uh Google Professional Services actually published this blog post and this",
    "start": "1120140",
    "end": "1125360"
  },
  {
    "text": "utility which is similar to similar to the magic that square",
    "start": "1125360",
    "end": "1131780"
  },
  {
    "text": "published this utility uh is designed to kind of",
    "start": "1131780",
    "end": "1136820"
  },
  {
    "text": "let your on-prem instances talk back to gcp without any application modification the same way that the AWS thing does",
    "start": "1136820",
    "end": "1144380"
  },
  {
    "text": "rather than using a file and a helper process of the call out",
    "start": "1144380",
    "end": "1149539"
  },
  {
    "text": "this integration actually turns on a proxy and this proxy steps into the Google metadata endpoint and emulates",
    "start": "1149539",
    "end": "1157400"
  },
  {
    "text": "effectively emulates the answers like the Google metadata endpoint would give you if you were running on Google Cloud",
    "start": "1157400",
    "end": "1164299"
  },
  {
    "text": "so similar to the AWS thing or software can kind of pop up it already or you're using the gcp SDK it knows it can talk",
    "start": "1164299",
    "end": "1171200"
  },
  {
    "text": "to this metadata API it reaches out and it finds this proxy and this proxy has the smarts to get the spiffy identity go",
    "start": "1171200",
    "end": "1177799"
  },
  {
    "text": "and make the exchange with gcp and then bring back your gcp credible question",
    "start": "1177799",
    "end": "1184600"
  },
  {
    "text": "the question was that this diagram presupposes that trust is already established I think that you're asking about that screen from the AWS yes it",
    "start": "1189799",
    "end": "1197600"
  },
  {
    "text": "does there's a configuration that you need to do in gcp similar to AWS where you point it back to your oidc provider",
    "start": "1197600",
    "end": "1204440"
  },
  {
    "text": "your Spire server there's a certificate involved there usually webpki certificate involved",
    "start": "1204440",
    "end": "1209539"
  },
  {
    "text": "there so this this diagram presupposes that that configuration has been done already",
    "start": "1209539",
    "end": "1216460"
  },
  {
    "text": "the the direction so the questionnaire is the direction of request is it from cloud provider to Aspire server as a",
    "start": "1225200",
    "end": "1230299"
  },
  {
    "text": "Spire server to the cloud provider uh well in terms of the Spire server it's fire server to the cloud or cloud",
    "start": "1230299",
    "end": "1236299"
  },
  {
    "text": "provider to the Spire server so the cloud provider periodically will reach the Spire server grab the recent public",
    "start": "1236299",
    "end": "1242419"
  },
  {
    "text": "Keys pull them back the workload obviously reaches into gcp",
    "start": "1242419",
    "end": "1249320"
  },
  {
    "text": "so you can see you know I talked earlier kind of about how it's it's all kind of",
    "start": "1253160",
    "end": "1258679"
  },
  {
    "text": "a similar underlying technology here that enables this with different kind of",
    "start": "1258679",
    "end": "1264200"
  },
  {
    "text": "nuances on each one you know different Cloud providers decide they want to do this thing differently and so the way",
    "start": "1264200",
    "end": "1269419"
  },
  {
    "text": "you can figure them the way you can see them kind of subtly varies from case to case however the underlying mechanism is",
    "start": "1269419",
    "end": "1276200"
  },
  {
    "text": "relatively universally applicable a lot of software supports this kind of oidc auth",
    "start": "1276200",
    "end": "1281240"
  },
  {
    "text": "you know so today we talk about AWS Azure gcp but there's a lot of off-the-shelf software and other",
    "start": "1281240",
    "end": "1286580"
  },
  {
    "text": "third-party services out there that also support oidc auth I hear about them all the time and so if you're using something that",
    "start": "1286580",
    "end": "1294020"
  },
  {
    "text": "supports oidc office off the shelf where it's a service or something like that there's a good chance that it will be compatible in this way",
    "start": "1294020",
    "end": "1301000"
  },
  {
    "text": "and so the key takeaways here number one is that spiffy shots are oidc compatible",
    "start": "1301220",
    "end": "1308360"
  },
  {
    "text": "um if you look there's like a little logo it's like an o with an i a little circle thing a lot of these software support IDC",
    "start": "1308360",
    "end": "1315500"
  },
  {
    "text": "already and those that do you it's like a 90 99 chance 90 95 chance that it's",
    "start": "1315500",
    "end": "1320539"
  },
  {
    "text": "just going to work out of the box specifically Aspire both platform agnostic they can run anywhere Aspire is",
    "start": "1320539",
    "end": "1325580"
  },
  {
    "text": "super super pluggable uh so all the kinds of things that aspired needs to rely on underlying",
    "start": "1325580",
    "end": "1331220"
  },
  {
    "text": "platforms are all pluggable so as AWS plugins there's plugins to interact with Hardware TPM search plugins to do all",
    "start": "1331220",
    "end": "1337580"
  },
  {
    "text": "this different kind of stuff um so the the real thing here is that you know a lot of times access to these",
    "start": "1337580",
    "end": "1344360"
  },
  {
    "text": "Services has been kind of gated by where you're running your workload and that is no longer if you want to use the Google",
    "start": "1344360",
    "end": "1350659"
  },
  {
    "text": "machine learning stuff from inside your data center you can do that very easily and you don't have to fool around with any of these keys",
    "start": "1350659",
    "end": "1357020"
  },
  {
    "text": "uh and yeah so that's one weird trick to avoid the all the pain and management",
    "start": "1357020",
    "end": "1362419"
  },
  {
    "text": "around kind of managing these tokens storing them encrypting them injecting them all this stuff all the specific",
    "start": "1362419",
    "end": "1368600"
  },
  {
    "text": "identities are all kind of short-lived fast rotated everything's fully automated from the root down so this",
    "start": "1368600",
    "end": "1374360"
  },
  {
    "text": "problem kind of just vanishes if you want to learn more about this stuff",
    "start": "1374360",
    "end": "1379520"
  },
  {
    "text": "we have obviously our GitHub repos these are a couple of the repos I talked about today with the helper utility from AWS",
    "start": "1379520",
    "end": "1386299"
  },
  {
    "text": "and and square and also the helper utility from Google Cloud platform to do so if you asked from anywhere",
    "start": "1386299",
    "end": "1394400"
  },
  {
    "text": "that's all I have for you today open up for questions I'll leave this up for a minute post on take pictures and",
    "start": "1394400",
    "end": "1399799"
  },
  {
    "text": "I've got a QR code for talk feedback thank you for coming it's great to see you all [Applause]",
    "start": "1399799",
    "end": "1412589"
  },
  {
    "text": "nope foreign",
    "start": "1425360",
    "end": "1429220"
  },
  {
    "text": "[Laughter]",
    "start": "1435670",
    "end": "1439820"
  },
  {
    "text": "thank you yeah so I'm in the process of trying to cook up a Spire deployment for my environment right now and the",
    "start": "1441640",
    "end": "1449000"
  },
  {
    "text": "challenge I'm coming I'm encountering is that the list of trust domains keeps growing and growing and growing",
    "start": "1449000",
    "end": "1455179"
  },
  {
    "text": "and so there's also it appears to me a tight relationship between trust domain inspired deployment",
    "start": "1455179",
    "end": "1461780"
  },
  {
    "text": "so let's say I'm gonna have 50 trust domains now I have to manage 50 Aspire server deployments yeah are there any",
    "start": "1461780",
    "end": "1468500"
  },
  {
    "text": "plans to consider consolidating multiple trust domains in in one server",
    "start": "1468500",
    "end": "1473840"
  },
  {
    "text": "deployment so I don't have to I'm fixing one problem that I'm creating an operational uh burden on the other hand is there any",
    "start": "1473840",
    "end": "1480559"
  },
  {
    "text": "advice or thoughts around that yes well I have some thoughts I don't know about advice",
    "start": "1480559",
    "end": "1487299"
  },
  {
    "text": "um the the kind of exploding trust domain problem is a problem that I've seen a",
    "start": "1487640",
    "end": "1494000"
  },
  {
    "text": "number of times particularly at Shops with larger scale uh you know I think this also kind of",
    "start": "1494000",
    "end": "1499460"
  },
  {
    "text": "comes down to a trade-off you know there are some tricks you can do so the",
    "start": "1499460",
    "end": "1505280"
  },
  {
    "text": "first thing is that you know Spire server can be deployed in what we call its nested model so you can have multiple Spire clusters participating in",
    "start": "1505280",
    "end": "1511760"
  },
  {
    "text": "one larger trust domain oftentimes people reach for many trust domains because this is kind",
    "start": "1511760",
    "end": "1518299"
  },
  {
    "text": "of like the easy thing to do with their model for example if I'm just stamping out a bunch of kind of like equivalent",
    "start": "1518299",
    "end": "1523460"
  },
  {
    "text": "spy uh kubernetes clusters the easiest thing to do oftentimes is just say okay",
    "start": "1523460",
    "end": "1528740"
  },
  {
    "text": "well each one of these is its own trust domain um there are there are drawbacks with that",
    "start": "1528740",
    "end": "1534080"
  },
  {
    "text": "you know this Federated auth we talked I talked about earlier where you look at the trust domain and you",
    "start": "1534080",
    "end": "1540200"
  },
  {
    "text": "choose the correct bundle I mean envoys have put supports this natively other software support this natively but not everyone does",
    "start": "1540200",
    "end": "1546860"
  },
  {
    "text": "you know engine X doesn't and a couple others so anytime that you talk about this Federated author already you're",
    "start": "1546860",
    "end": "1553400"
  },
  {
    "text": "kind of talking about the cost the the other piece of this is that each",
    "start": "1553400",
    "end": "1558500"
  },
  {
    "text": "one of these bundles there's a size and when you have a lot of them they get quite large and there's a lot of network",
    "start": "1558500",
    "end": "1563539"
  },
  {
    "text": "traffic involved in that and the agent stuck these things down and uh so",
    "start": "1563539",
    "end": "1569779"
  },
  {
    "text": "you know we're we're exploring ways to kind of make this problem better we do have like the largest Spire deployments",
    "start": "1569779",
    "end": "1575360"
  },
  {
    "text": "are over a million agents so they're like way way bigger than largest kubernetes deployments",
    "start": "1575360",
    "end": "1581059"
  },
  {
    "text": "um so these things can be done but we tend to see usually these really large deployments go for like two three four",
    "start": "1581059",
    "end": "1586220"
  },
  {
    "text": "trust domains kind of thing and then they lean on kind of these nested architectures and other kind of",
    "start": "1586220",
    "end": "1591500"
  },
  {
    "text": "tree-like topologies to to achieve the scale and and reliability that their",
    "start": "1591500",
    "end": "1596720"
  },
  {
    "text": "deployments need so I would say I guess I guess my advice would just be like hey you know",
    "start": "1596720",
    "end": "1602600"
  },
  {
    "text": "the trust domain thing is kind of like a big hammer and like kind of go about it as like put it in",
    "start": "1602600",
    "end": "1609080"
  },
  {
    "text": "the places where you really need it and not the places where you know that's just kind of the easiest thing to deploy",
    "start": "1609080",
    "end": "1615620"
  },
  {
    "text": "I I hope that makes sense without knowing more about your environment it's hard to make them more concrete yeah would you be opposed to one large trust",
    "start": "1615620",
    "end": "1622279"
  },
  {
    "text": "domain than the receiver of the of the credential like looking at the latter part of the spiffy ID and like",
    "start": "1622279",
    "end": "1627740"
  },
  {
    "text": "dissecting that because it's minted in so like if you want an environmental segmentation would you like would it be",
    "start": "1627740",
    "end": "1633799"
  },
  {
    "text": "okay to have one large domain but let's say a receiver is only in like a staged environment and they could look at it a",
    "start": "1633799",
    "end": "1639860"
  },
  {
    "text": "bit in the URI to say oh this is staging and then authorize on that do you think is that an anti-pattern according to uh",
    "start": "1639860",
    "end": "1646279"
  },
  {
    "text": "according to you uh you definitely want to check the workload ID I mean there are some services that it's okay to just",
    "start": "1646279",
    "end": "1653360"
  },
  {
    "text": "say like anything from staging but in general you really want to check the workload ID the things I think about",
    "start": "1653360",
    "end": "1659960"
  },
  {
    "text": "like ntp DNS things that are like centralized Services you know that make sense for but",
    "start": "1659960",
    "end": "1665900"
  },
  {
    "text": "I would recommend like the the trust the trust domain name should be part of your authorization policy but so should the",
    "start": "1665900",
    "end": "1671120"
  },
  {
    "text": "workload ID thanks",
    "start": "1671120",
    "end": "1675700"
  },
  {
    "text": "hey um I think I have a small question so as I understand from the spiral",
    "start": "1685880",
    "end": "1691760"
  },
  {
    "text": "registration to the spvspid it is kind of a a fixed one-to-one mapping that you",
    "start": "1691760",
    "end": "1699380"
  },
  {
    "text": "specific specify a list of selectors and and that is mapped to a specifics vpid I",
    "start": "1699380",
    "end": "1707120"
  },
  {
    "text": "wonder is any plans to make this mapping a little bit more flexible and the dynamic for example by it could be as",
    "start": "1707120",
    "end": "1715100"
  },
  {
    "text": "simple as some like a format a substitution or maybe a limited expression aggregious here so that with",
    "start": "1715100",
    "end": "1721400"
  },
  {
    "text": "a single spiral registration that can be used to map to like maybe a thousand or",
    "start": "1721400",
    "end": "1727520"
  },
  {
    "text": "hundred like pvid for 4900 workloads",
    "start": "1727520",
    "end": "1733179"
  },
  {
    "text": "let me make sure I understand your question uh you're asking you're asking if it's",
    "start": "1734179",
    "end": "1741260"
  },
  {
    "text": "possible like if we've been thinking about having Spire Breakaway from this kind of like",
    "start": "1741260",
    "end": "1746720"
  },
  {
    "text": "one registration to one workload ID pattern and as dead like be able to",
    "start": "1746720",
    "end": "1752360"
  },
  {
    "text": "configure Spire with a regex or something that would then issue identities from that or yeah something",
    "start": "1752360",
    "end": "1758659"
  },
  {
    "text": "like that maybe a more concrete example is for example I have a selector service",
    "start": "1758659",
    "end": "1763940"
  },
  {
    "text": "limb uh the value could be anything and I want to impair the service value into",
    "start": "1763940",
    "end": "1769100"
  },
  {
    "text": "the specific ID so that I do not need to repeat the other value part",
    "start": "1769100",
    "end": "1774140"
  },
  {
    "text": "you do not want to repeat what I'm sorry um like a as a selector like a uh the",
    "start": "1774140",
    "end": "1780500"
  },
  {
    "text": "value of Alexa yeah yeah uh one of the problems that we have is with this is the",
    "start": "1780500",
    "end": "1787580"
  },
  {
    "text": "security model so Spire is designed to survive node",
    "start": "1787580",
    "end": "1793159"
  },
  {
    "text": "compromise so if you know any node in the kubernetes cluster or any physical note or otherwise is compromised",
    "start": "1793159",
    "end": "1800240"
  },
  {
    "text": "the security model is such that you know there's an agent running there the security model is such that you cannot",
    "start": "1800240",
    "end": "1805820"
  },
  {
    "text": "just take control of this agent and go into any identity you want uh and in order to put that security",
    "start": "1805820",
    "end": "1811100"
  },
  {
    "text": "control in place you kind of have to know which agents are authorized to Mint which identities",
    "start": "1811100",
    "end": "1816500"
  },
  {
    "text": "and so it's difficult to kind of say hey this agent can mint you know any of Foo",
    "start": "1816500",
    "end": "1822799"
  },
  {
    "text": "or bar namespace identity because you still kind of need mappings for that and",
    "start": "1822799",
    "end": "1827899"
  },
  {
    "text": "oftentimes the agent identity is like very disjoint from the namespace of the workload",
    "start": "1827899",
    "end": "1833539"
  },
  {
    "text": "and so this is something that I've been thinking about personally like",
    "start": "1833539",
    "end": "1839980"
  },
  {
    "text": "what could we do to avoid kind of this registration overhead you know",
    "start": "1840260",
    "end": "1845600"
  },
  {
    "text": "in in kubernetes uh we have what's the Spire controller manager which is a",
    "start": "1845600",
    "end": "1850760"
  },
  {
    "text": "controller that watches deployments as they're placed and will automatically manage all these registration entries for you",
    "start": "1850760",
    "end": "1855919"
  },
  {
    "text": "and you can kind of annotate or label uh these deployments with specific IDs that you would like them to",
    "start": "1855919",
    "end": "1862220"
  },
  {
    "text": "take on and so some of this overhead is is negated in that way but I think there's more we can do and",
    "start": "1862220",
    "end": "1868279"
  },
  {
    "text": "right now some of the core kind of core design and security principles",
    "start": "1868279",
    "end": "1874399"
  },
  {
    "text": "Aspire make it difficult I don't know if that's exactly what you were asking but I feel that it's something related to",
    "start": "1874399",
    "end": "1880820"
  },
  {
    "text": "like registration management and like defining identities for a large number",
    "start": "1880820",
    "end": "1885860"
  },
  {
    "text": "of workloads in advance and this kind of thing yeah thank you",
    "start": "1885860",
    "end": "1891580"
  },
  {
    "text": "hey so in the examples that you showed it looked like you're effectively swapping your spiffy ID for a like",
    "start": "1903919",
    "end": "1910399"
  },
  {
    "text": "short-lived Cloud credentials so is there kind of any work going on or",
    "start": "1910399",
    "end": "1915799"
  },
  {
    "text": "any interest in like the cloud providers supporting svids like natively so you wouldn't have to do a dance",
    "start": "1915799",
    "end": "1923740"
  },
  {
    "text": "um I have not",
    "start": "1924679",
    "end": "1930620"
  },
  {
    "text": "heard of this but you see that you know this gcp answer was written by Google",
    "start": "1930620",
    "end": "1935960"
  },
  {
    "text": "Cloud AWS has also began to like AWS at mesh",
    "start": "1935960",
    "end": "1941419"
  },
  {
    "text": "has native integration with Spire so you can bring your spire and plug it into AWS app mesh so I haven't seen",
    "start": "1941419",
    "end": "1947899"
  },
  {
    "text": "Cloud providers directly trying to pick up spiffy off maybe in the future they will but we but we do see them is we do",
    "start": "1947899",
    "end": "1954559"
  },
  {
    "text": "see them kind of engaging and making this story better",
    "start": "1954559",
    "end": "1959440"
  },
  {
    "text": "any more questions",
    "start": "1963679",
    "end": "1966640"
  },
  {
    "text": "thanks everyone oh one more one more one more sorry false start faster",
    "start": "1969740",
    "end": "1977140"
  },
  {
    "text": "I I think you skipped in the talk but there is a process in AWS to get the trust of the oidc provider so what is",
    "start": "1979520",
    "end": "1986179"
  },
  {
    "text": "the like the oedc provider for um for the spiffy identity like how does",
    "start": "1986179",
    "end": "1992539"
  },
  {
    "text": "that connection get uh so you respire server",
    "start": "1992539",
    "end": "1998299"
  },
  {
    "text": "and your IDC provider you can ship it kind of in the same pod the RDC provider talks Aspire server it",
    "start": "1998299",
    "end": "2004600"
  },
  {
    "text": "gets all the bundle data and then it kind of turns on a little web server that serves the oidc discovery document",
    "start": "2004600",
    "end": "2010059"
  },
  {
    "text": "and a few other kind of documents make oidc work and it also munges these disk bundles to be kind of like aligned with",
    "start": "2010059",
    "end": "2017320"
  },
  {
    "text": "the four method or IDC validators expect it speaks Acme and grabs a webpki cert and so when you configure your cloud",
    "start": "2017320",
    "end": "2024279"
  },
  {
    "text": "provider it'll talk back to this oidc provider part of this stuff is saying you know here's the DNS name you are expecting",
    "start": "2024279",
    "end": "2030940"
  },
  {
    "text": "webpki some of the clouds like AWS for example will say like hey like paste in",
    "start": "2030940",
    "end": "2036399"
  },
  {
    "text": "the thumbprint of the actual cert that you're serving over there and we'll validate that thing so that's how the",
    "start": "2036399",
    "end": "2041799"
  },
  {
    "text": "trust between the provider the cloud provider and the oidc on-prem stuff",
    "start": "2041799",
    "end": "2047580"
  },
  {
    "text": "all right thanks everyone [Applause]",
    "start": "2053020",
    "end": "2059239"
  }
]