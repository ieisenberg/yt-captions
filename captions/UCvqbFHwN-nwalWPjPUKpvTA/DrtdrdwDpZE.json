[
  {
    "start": "0",
    "end": "63000"
  },
  {
    "text": "first a little bit about myself this is my github handle I am a maintainer of",
    "start": "0",
    "end": "6390"
  },
  {
    "text": "open-source at CD what's this presentation for I'm hoping that this",
    "start": "6390",
    "end": "12660"
  },
  {
    "text": "talk will be helpful if you're you know raft and you want to start reading or",
    "start": "12660",
    "end": "18900"
  },
  {
    "text": "you just started reading the raft source code I'm hoping that this presentation",
    "start": "18900",
    "end": "24150"
  },
  {
    "text": "will give you a nice starting point on reading the code and also for those who",
    "start": "24150",
    "end": "30210"
  },
  {
    "text": "wants to understand the relationship between at City and raft basically how at city uses raft or why raft is",
    "start": "30210",
    "end": "39090"
  },
  {
    "text": "important to at CD we're gonna talk about this in this talk also if you are",
    "start": "39090",
    "end": "45149"
  },
  {
    "text": "writing your own project your own application you want to import you want",
    "start": "45149",
    "end": "50250"
  },
  {
    "text": "to embed raft package this things we're gonna talk about how @cd uses raft it",
    "start": "50250",
    "end": "56340"
  },
  {
    "text": "can be an example of how your application uses raft alright so this is",
    "start": "56340",
    "end": "64830"
  },
  {
    "start": "63000",
    "end": "101000"
  },
  {
    "text": "today's agenda first we're gonna do a very quick recap of the raft so everybody is on the same page and then",
    "start": "64830",
    "end": "71760"
  },
  {
    "text": "the second point is we're gonna we're gonna talk about how at City uses raft and then we're gonna diverge a little",
    "start": "71760",
    "end": "78900"
  },
  {
    "text": "bit from the second point we're gonna talk about third point which is the implementation details of the raft and",
    "start": "78900",
    "end": "85049"
  },
  {
    "text": "after the third point we're gonna revisit the second point because by then we're gonna have more details to talk",
    "start": "85049",
    "end": "91470"
  },
  {
    "text": "about and last we're gonna talk about some of the ongoing effort effort I'm",
    "start": "91470",
    "end": "96570"
  },
  {
    "text": "aware of in the raft okay all right so",
    "start": "96570",
    "end": "102479"
  },
  {
    "start": "101000",
    "end": "201000"
  },
  {
    "text": "raft recap first quickly some concepts",
    "start": "102479",
    "end": "107630"
  },
  {
    "text": "what is a quorum a quorum is basically maturity so if Q 1 and Q 2 are quorum",
    "start": "107630",
    "end": "117360"
  },
  {
    "text": "their intersection is not empty so what is the crown for example if you have a",
    "start": "117360",
    "end": "123060"
  },
  {
    "text": "cluster of size 1 so one server in your cluster the quorum is one if you have",
    "start": "123060",
    "end": "128940"
  },
  {
    "text": "two servers your core on is two but then you have three servers your quorum is",
    "start": "128940",
    "end": "135340"
  },
  {
    "text": "not three is two because you can pick any two out of the three and you can",
    "start": "135340",
    "end": "140920"
  },
  {
    "text": "find intersection node between the quorum right so in this example where",
    "start": "140920",
    "end": "146950"
  },
  {
    "text": "you have five five servers in your cluster the Krone is three so here you",
    "start": "146950",
    "end": "153730"
  },
  {
    "text": "can see these three becomes a quorum and the next next time these three becomes a",
    "start": "153730",
    "end": "159280"
  },
  {
    "text": "quorum and they do have an intersecting node right so what's the nice thing",
    "start": "159280",
    "end": "165250"
  },
  {
    "text": "about raft consensus protocol is that the entire cluster can make progress as",
    "start": "165250",
    "end": "172000"
  },
  {
    "text": "long as there is agreement among the quorum what does that mean so in this",
    "start": "172000",
    "end": "178030"
  },
  {
    "text": "example you don't need all five servers to be available for you to serve the",
    "start": "178030",
    "end": "184000"
  },
  {
    "text": "client you can have at most two servers unavailable at the moment but as long as",
    "start": "184000",
    "end": "191170"
  },
  {
    "text": "you have quorum which is three and if they Greece to something you can the",
    "start": "191170",
    "end": "197019"
  },
  {
    "text": "entire cluster can still serve client right so what is the problem",
    "start": "197019",
    "end": "205150"
  },
  {
    "start": "201000",
    "end": "397000"
  },
  {
    "text": "raft tries to solve imagine you have a collection of servers each server is a",
    "start": "205150",
    "end": "212530"
  },
  {
    "text": "state machine for example in at CD is a key value store right you can write keys",
    "start": "212530",
    "end": "217870"
  },
  {
    "text": "you can read keys it is a state machine you have a cluster of servers each server is a state machine then when the",
    "start": "217870",
    "end": "226090"
  },
  {
    "text": "client interact with this cluster how do you make sure that from clients view",
    "start": "226090",
    "end": "232930"
  },
  {
    "text": "this cluster of servers behaves like a single state machine a single reliable",
    "start": "232930",
    "end": "240609"
  },
  {
    "text": "state machine so for example the client my at this moment right it choose to",
    "start": "240609",
    "end": "246220"
  },
  {
    "text": "issue a write command it writes a key value to the state machine and one of",
    "start": "246220",
    "end": "253690"
  },
  {
    "text": "the servers in your cluster served this request let's say server a and the next",
    "start": "253690",
    "end": "259180"
  },
  {
    "text": "moment the client wants to read that key but server a is not available at that",
    "start": "259180",
    "end": "265120"
  },
  {
    "text": "time is a different server let's say server be served the client how do you make",
    "start": "265120",
    "end": "271360"
  },
  {
    "text": "sure server B's local state machine has the same state so that when it serves",
    "start": "271360",
    "end": "277450"
  },
  {
    "text": "the client it returns the correct result right so that's the problem how do you",
    "start": "277450",
    "end": "282730"
  },
  {
    "text": "how do you achieve a replicated state machine now the nice thing about state",
    "start": "282730",
    "end": "288760"
  },
  {
    "text": "machine is that a state machine given its current state given its current",
    "start": "288760",
    "end": "294370"
  },
  {
    "text": "input its next state and its output is determined so if these state machines if",
    "start": "294370",
    "end": "303640"
  },
  {
    "text": "they all have the same initial state which you have to make sure right so",
    "start": "303640",
    "end": "309160"
  },
  {
    "text": "whatever bootstrapping process you are using you have to make sure when these server starts they're gonna have the",
    "start": "309160",
    "end": "315130"
  },
  {
    "text": "same initial State and then if you can somehow achieve this",
    "start": "315130",
    "end": "320170"
  },
  {
    "text": "if you can make sure that each server also has the same input sequence then",
    "start": "320170",
    "end": "326740"
  },
  {
    "text": "it's guaranteed that basically they're so for these state machines right",
    "start": "326740",
    "end": "332980"
  },
  {
    "text": "they're always going to have the same state and output right so the problem becomes how do you achieve this how",
    "start": "332980",
    "end": "341530"
  },
  {
    "text": "rough does it so the raft consensus protocol achieve this by basically doing",
    "start": "341530",
    "end": "348310"
  },
  {
    "text": "this it it manages the replicate right a headlock so whatever the the request the",
    "start": "348310",
    "end": "355450"
  },
  {
    "text": "client wants to execute on the state machine it first needs to be write to",
    "start": "355450",
    "end": "361360"
  },
  {
    "text": "this to a log which is managed by the consensus protocol in our case it's raft",
    "start": "361360",
    "end": "367390"
  },
  {
    "text": "right so it's the consensus protocols job to make sure that these logs are",
    "start": "367390",
    "end": "374020"
  },
  {
    "text": "actually coherent are the same across different servers in your cluster so",
    "start": "374020",
    "end": "380800"
  },
  {
    "text": "that because these are these are input sequences to the state machine right so if these are the same then when they",
    "start": "380800",
    "end": "387730"
  },
  {
    "text": "input to a state machines with initial same initial state then the problem is",
    "start": "387730",
    "end": "393700"
  },
  {
    "text": "solved right now how does raft actually does it roughly",
    "start": "393700",
    "end": "401300"
  },
  {
    "start": "397000",
    "end": "471000"
  },
  {
    "text": "speaking it has two parts first is leader election the second is how leader",
    "start": "401300",
    "end": "407420"
  },
  {
    "text": "replicate its logs to the rest of the servers in the cluster so we're gonna first sorry",
    "start": "407420",
    "end": "413390"
  },
  {
    "text": "we're gonna first talk about leader election a raft node in the cluster can be either a candidate a follower or a",
    "start": "413390",
    "end": "420710"
  },
  {
    "text": "leader so term what is the term a term is basically a logic clock in the raft",
    "start": "420710",
    "end": "427280"
  },
  {
    "text": "starting of each term there is going to be a election so each node can vote for",
    "start": "427280",
    "end": "434450"
  },
  {
    "text": "one node in a given term when a node gets majority of the votes",
    "start": "434450",
    "end": "441190"
  },
  {
    "text": "remember the quorum will talk about so if you get votes from a quorum then it",
    "start": "441190",
    "end": "446810"
  },
  {
    "text": "becomes a leader so you can have at most one leader in your term now once a",
    "start": "446810",
    "end": "454940"
  },
  {
    "text": "leader is elected it manages the rest of the term the leader will periodically",
    "start": "454940",
    "end": "462200"
  },
  {
    "text": "send out a heartbeat messages to make sure everybody else knows that the leader is still presence right so this",
    "start": "462200",
    "end": "469850"
  },
  {
    "text": "is the first step then so now we have the leader right so the leader is",
    "start": "469850",
    "end": "475610"
  },
  {
    "start": "471000",
    "end": "619000"
  },
  {
    "text": "responsible for manages those logs we just talked about earlier right so the",
    "start": "475610",
    "end": "480830"
  },
  {
    "text": "leader is going to append to the log so whenever there is a client request comes",
    "start": "480830",
    "end": "486470"
  },
  {
    "text": "to the leader that request becomes a new raft log entry the leader is going to",
    "start": "486470",
    "end": "493760"
  },
  {
    "text": "append that entry to its own log and then leader also tries keeps trying to",
    "start": "493760",
    "end": "501080"
  },
  {
    "text": "replicate its own log to the other raft node in the cluster when maturity of the node in the cluster",
    "start": "501080",
    "end": "508430"
  },
  {
    "text": "has this particular log entry so basically the logs are indexed there is",
    "start": "508430",
    "end": "513680"
  },
  {
    "text": "log entry 0 1 2 3 4 right so the leader is trying to replicate these logs to the",
    "start": "513680",
    "end": "520070"
  },
  {
    "text": "followers the leader also monitors everybody's progress let's say node a",
    "start": "520070",
    "end": "525770"
  },
  {
    "text": "has up to maybe log index 3 node B",
    "start": "525770",
    "end": "531120"
  },
  {
    "text": "has more logs maybe has log 0 up to 6 so leader monitors the progress and when it",
    "start": "531120",
    "end": "539790"
  },
  {
    "text": "finds out the maturity of the node in a cluster has a particular look that log",
    "start": "539790",
    "end": "546540"
  },
  {
    "text": "is marked as committed so when when it's marked as committed it is it is safe for",
    "start": "546540",
    "end": "554699"
  },
  {
    "text": "everybody to apply that log right in our previous an example let's say leader",
    "start": "554699",
    "end": "562230"
  },
  {
    "text": "finds out so it let's say leader has 10 lakhs right from 0 to 9 and it remember",
    "start": "562230",
    "end": "569009"
  },
  {
    "text": "it tries to replicate logs to other nodes right let's say there's two other nodes node a and node B besides from the",
    "start": "569009",
    "end": "575819"
  },
  {
    "text": "leader right so node a has log 0 1 2 3 and node B has 0 1 2 3 4 for example",
    "start": "575819",
    "end": "584839"
  },
  {
    "text": "then well I guess since the leader and",
    "start": "584839",
    "end": "592309"
  },
  {
    "text": "node B they they both have log entry for",
    "start": "592309",
    "end": "597899"
  },
  {
    "text": "right so from 0 to 4 they are all basically committed because you have",
    "start": "597899",
    "end": "603540"
  },
  {
    "text": "majority of node have those logs once committed it's it's safe to apply those",
    "start": "603540",
    "end": "610230"
  },
  {
    "text": "logs so each each local node is gonna know from the leader which logs are committed and it's gonna apply those",
    "start": "610230",
    "end": "616949"
  },
  {
    "text": "logs right all right so now let's talk about how raft uses at City this graph",
    "start": "616949",
    "end": "624839"
  },
  {
    "text": "is basically the same as the one we just saw remember we already explained how a",
    "start": "624839",
    "end": "631559"
  },
  {
    "text": "raft can help to solve the replicated state machine problem right now in this",
    "start": "631559",
    "end": "638069"
  },
  {
    "text": "graph it's basically the same here is just a client this is an example",
    "start": "638069",
    "end": "643259"
  },
  {
    "text": "application it's a city code o is a command line tool it empaths the @cd client library",
    "start": "643259",
    "end": "650220"
  },
  {
    "text": "another example can be in Cabrini kubernetes api server also ambassadors client v3 which can talks to the at CD",
    "start": "650220",
    "end": "658470"
  },
  {
    "text": "cluster now when a client sends a request to the server",
    "start": "658470",
    "end": "664770"
  },
  {
    "text": "the request is relative to the raft consensus module for this example let's",
    "start": "664770",
    "end": "671670"
  },
  {
    "text": "say this server is a follower it's not a leader right so let's say this is the",
    "start": "671670",
    "end": "677160"
  },
  {
    "text": "cluster and this is one of the server in the cluster and it's not a leader it's a follower so once the request is relative",
    "start": "677160",
    "end": "685380"
  },
  {
    "text": "to the raft module it's going to be forwarded to the raft leader the raft",
    "start": "685380",
    "end": "692100"
  },
  {
    "text": "leader will append that request to its own raft log and then it will tries to",
    "start": "692100",
    "end": "699300"
  },
  {
    "text": "replicate that log entry to other nodes for example this note showed here right",
    "start": "699300",
    "end": "704760"
  },
  {
    "text": "this is a follower and once he knows maturity of the node has that particular",
    "start": "704760",
    "end": "710910"
  },
  {
    "text": "raft entry it's going to be marked as committed and now this server knows ok",
    "start": "710910",
    "end": "716459"
  },
  {
    "text": "that particular log entry is committed so I can apply that so it now it's going",
    "start": "716459",
    "end": "722190"
  },
  {
    "text": "to be applied to this state machine which in at CD is multi-version",
    "start": "722190",
    "end": "727800"
  },
  {
    "text": "concurrency control key value store so it's gonna apply that to this machine",
    "start": "727800",
    "end": "732930"
  },
  {
    "text": "remember that log could be it is a request from the client right for example it can be read a key or write a",
    "start": "732930",
    "end": "738899"
  },
  {
    "text": "key value so whatever the output is if your writing is gonna tell you ok write",
    "start": "738899",
    "end": "744089"
  },
  {
    "text": "successful if your reading is gonna return the the value of that key right so whatever that apply the result is",
    "start": "744089",
    "end": "750750"
  },
  {
    "text": "it's gonna be returned routed back to the client just quickly saying that because the",
    "start": "750750",
    "end": "757380"
  },
  {
    "text": "server can crush and restart it's very important that the input to the state",
    "start": "757380",
    "end": "762990"
  },
  {
    "text": "machine and the state machine they needs to be persisted on the disk right so when they crash and restart they can",
    "start": "762990",
    "end": "770190"
  },
  {
    "text": "replay whatever was before so they can go back to the correct state all right",
    "start": "770190",
    "end": "778050"
  },
  {
    "text": "so we're gonna revisit this graph later after we talked about raft implementation the design philosophy for",
    "start": "778050",
    "end": "788190"
  },
  {
    "start": "785000",
    "end": "844000"
  },
  {
    "text": "the raft package in @cd is that it tries to keep it minimalistic meaning that the",
    "start": "788190",
    "end": "795240"
  },
  {
    "text": "raft package does not implement Network transport between the raft nodes remember there are going to be messages",
    "start": "795240",
    "end": "803819"
  },
  {
    "text": "between raft notes right like just like we saw the leader my replicators locks",
    "start": "803819",
    "end": "808889"
  },
  {
    "text": "to the follower but this package does not implement network transport also it",
    "start": "808889",
    "end": "817290"
  },
  {
    "text": "does not implement the persistent storage layer so whoever is using this",
    "start": "817290",
    "end": "822779"
  },
  {
    "text": "raft package needs to implement network transport and persistent storage layer",
    "start": "822779",
    "end": "828050"
  },
  {
    "text": "by including less in the raft package it makes the package more flexible because",
    "start": "828050",
    "end": "833309"
  },
  {
    "text": "now you can choose your own implementation it also makes the",
    "start": "833309",
    "end": "838410"
  },
  {
    "text": "behavior of the raft package to be deterministic as a result the raft",
    "start": "838410",
    "end": "847170"
  },
  {
    "start": "844000",
    "end": "905000"
  },
  {
    "text": "well deterministic has is a very very nice thing because if the behavior of",
    "start": "847170",
    "end": "854040"
  },
  {
    "text": "the raft package is deterministic it usually means it's easier to implement",
    "start": "854040",
    "end": "859259"
  },
  {
    "text": "is easier to test it's also easier to argue its correctness",
    "start": "859259",
    "end": "865429"
  },
  {
    "text": "so the raft itself is actually modeled as a state machine now let me go back to",
    "start": "865429",
    "end": "872399"
  },
  {
    "text": "the to this to this graph now we're just going to focus on the raft package",
    "start": "872399",
    "end": "879199"
  },
  {
    "text": "implementation itself right so we're not talking about this state machine here",
    "start": "879199",
    "end": "884730"
  },
  {
    "text": "we're talking about raft and we're saying the raft is modeled as a state",
    "start": "884730",
    "end": "890639"
  },
  {
    "text": "machine right just remember all right so raft is a state machine then what is its",
    "start": "890639",
    "end": "898620"
  },
  {
    "text": "state what is its input and output how does state transition between each other",
    "start": "898620",
    "end": "904639"
  },
  {
    "text": "so now we're gonna dive a little bit into the code just a quick disclaimer",
    "start": "904639",
    "end": "909929"
  },
  {
    "start": "905000",
    "end": "1031000"
  },
  {
    "text": "the code I'm showing here is mostly pseudocode so that they can actually fit in the screen and you can still see it",
    "start": "909929",
    "end": "915540"
  },
  {
    "text": "but they look very similar to the actual source code so when you see this and",
    "start": "915540",
    "end": "920730"
  },
  {
    "text": "then later when you read the source code it's going to be very familiar and you're it's easier for you to understand",
    "start": "920730",
    "end": "926399"
  },
  {
    "text": "what the source code does alright so the state here is basically wrapped into",
    "start": "926399",
    "end": "931470"
  },
  {
    "text": "this structure called raft you can see there is a node ID there's a term remember",
    "start": "931470",
    "end": "936550"
  },
  {
    "text": "term is like a clock vote each member can vote for one node in a term so this",
    "start": "936550",
    "end": "942660"
  },
  {
    "text": "indicates which node a voted this is the the log we talk about like how remember",
    "start": "942660",
    "end": "950200"
  },
  {
    "text": "we said raft consensus protocol helps manages the log to make sure that log on",
    "start": "950200",
    "end": "956140"
  },
  {
    "text": "each node is the same this is the log and the state basically says a wrap can",
    "start": "956140",
    "end": "962830"
  },
  {
    "text": "be either a leader a candidate or follower this is an interesting function it's a called stop function it has",
    "start": "962830",
    "end": "969100"
  },
  {
    "text": "different implementations depends on if you are a leader it's going to be a step",
    "start": "969100",
    "end": "974350"
  },
  {
    "text": "leader function if you're a follower it's a step follower function right et cetera now what's what's the input to",
    "start": "974350",
    "end": "982090"
  },
  {
    "text": "the raft state machine it is a message what is the message first it has a type",
    "start": "982090",
    "end": "987810"
  },
  {
    "text": "so messages are of different types for example you can have a message vote",
    "start": "987810",
    "end": "993040"
  },
  {
    "text": "which is for requesting a vote or a message append which is used by the",
    "start": "993040",
    "end": "999310"
  },
  {
    "text": "leader when they tries to replicate its logs to other nodes it's gonna issue a message with a message Japan type 2 is",
    "start": "999310",
    "end": "1007260"
  },
  {
    "text": "the destination node from is where the message is from we're gonna skip this",
    "start": "1007260",
    "end": "1012600"
  },
  {
    "text": "and entries so a message can a message can carry a whole bunch of entries for",
    "start": "1012600",
    "end": "1019380"
  },
  {
    "text": "example when the leader tries to replicate logs from itself to the followers it's gonna increase include",
    "start": "1019380",
    "end": "1026400"
  },
  {
    "text": "the ref log entries here ok what's the",
    "start": "1026400",
    "end": "1032730"
  },
  {
    "start": "1031000",
    "end": "1167000"
  },
  {
    "text": "output of this raft state machine the output is wrapped in into this structure",
    "start": "1032730",
    "end": "1039630"
  },
  {
    "text": "which is called ready it means these are ready to be consumed to be processed by",
    "start": "1039630",
    "end": "1047520"
  },
  {
    "text": "whoever is using the raft package all right so first one is the state of the raft next one this state needs to be",
    "start": "1047520",
    "end": "1055380"
  },
  {
    "text": "saved to the storage because remember the raft package itself does not include implementation of persistent storage",
    "start": "1055380",
    "end": "1062610"
  },
  {
    "text": "right and these is these are the entry that needs to be saved to storage these",
    "start": "1062610",
    "end": "1068570"
  },
  {
    "text": "are the committed entries which are remember safe to be applied to this to",
    "start": "1068570",
    "end": "1074720"
  },
  {
    "text": "the key value store and these are the messages remember the raft package does not",
    "start": "1074720",
    "end": "1081409"
  },
  {
    "text": "implement network transport so it's whoever is using the wrap package needs",
    "start": "1081409",
    "end": "1087650"
  },
  {
    "text": "to consume this consume these messages and actually deliver these messages to",
    "start": "1087650",
    "end": "1093799"
  },
  {
    "text": "their destinations that's why they are including in the in output now how do",
    "start": "1093799",
    "end": "1099440"
  },
  {
    "text": "the state transition the core function is going to be the function called step",
    "start": "1099440",
    "end": "1106070"
  },
  {
    "text": "with the capital S step function advance the raft state machine using the given",
    "start": "1106070",
    "end": "1112820"
  },
  {
    "text": "input remember what's the input of the state machine it's the message right so this is the input to the state machine",
    "start": "1112820",
    "end": "1119120"
  },
  {
    "text": "and you call this function it's gonna advance your wraps in the state machine",
    "start": "1119120",
    "end": "1124159"
  },
  {
    "text": "to the next state and output the thing here if we look into this function it",
    "start": "1124159",
    "end": "1131450"
  },
  {
    "text": "eventually calls this function and in the beginning there's some common logic for no matter whether you're a leader or",
    "start": "1131450",
    "end": "1138830"
  },
  {
    "text": "candidate or follower and then it calls this lowercased step function which is",
    "start": "1138830",
    "end": "1144640"
  },
  {
    "text": "different depends on whether you're a leader than this function is going to be called step leader etc right so it",
    "start": "1144640",
    "end": "1151490"
  },
  {
    "text": "depends on your state this function is going to be different now let's go to an example in terms",
    "start": "1151490",
    "end": "1160510"
  },
  {
    "text": "okay now let's say we want to propose a",
    "start": "1164050",
    "end": "1170950"
  },
  {
    "start": "1167000",
    "end": "1660000"
  },
  {
    "text": "change to the KB store right remember let's quickly go back to this slides",
    "start": "1170950",
    "end": "1177300"
  },
  {
    "text": "when a client request to execute a",
    "start": "1177300",
    "end": "1182380"
  },
  {
    "text": "command for example a read command or write command - the key value store it's",
    "start": "1182380",
    "end": "1188440"
  },
  {
    "text": "gonna so how it's gonna do is gonna propose a change the raft so this is the",
    "start": "1188440",
    "end": "1194440"
  },
  {
    "text": "example we're gonna talk about so the first function is proposed function this",
    "start": "1194440",
    "end": "1200680"
  },
  {
    "text": "data here is basically a serialized data so for example if you want to write",
    "start": "1200680",
    "end": "1207640"
  },
  {
    "text": "something it has a key and value it's going to be the serialized so that key",
    "start": "1207640",
    "end": "1214030"
  },
  {
    "text": "and value serialize to the bites bite slice right so this data corresponds to the clients command now what this",
    "start": "1214030",
    "end": "1223600"
  },
  {
    "text": "function does is it generates a message and feed that message as input to",
    "start": "1223600",
    "end": "1233430"
  },
  {
    "text": "servers local raft state machine in this example let's assume it's a follower who",
    "start": "1233430",
    "end": "1240460"
  },
  {
    "text": "is serving the client request okay so what's in this message you can see the",
    "start": "1240460",
    "end": "1246400"
  },
  {
    "text": "type is message prop and it includes the entries this is the data",
    "start": "1246400",
    "end": "1252730"
  },
  {
    "text": "remember this corresponds to the client request right so this is the data so",
    "start": "1252730",
    "end": "1258130"
  },
  {
    "text": "this message let's call it message a goes to into the follower raft state",
    "start": "1258130",
    "end": "1265330"
  },
  {
    "text": "machine now if you go to the source code remember it's going to be sent to the",
    "start": "1265330",
    "end": "1274030"
  },
  {
    "text": "step function which eventually because it is a follower it eventually goes to step follower function now this function",
    "start": "1274030",
    "end": "1281890"
  },
  {
    "text": "depends on its input message is gonna do different things right it's gonna",
    "start": "1281890",
    "end": "1287500"
  },
  {
    "text": "execute different code path in this example because our input message is of",
    "start": "1287500",
    "end": "1293410"
  },
  {
    "text": "this type so it goes to this code path and what it does is basically mark a",
    "start": "1293410",
    "end": "1300120"
  },
  {
    "text": "destination node to be the leader of the raft cluster and sent that message what",
    "start": "1300120",
    "end": "1307480"
  },
  {
    "text": "that stent mean because remember raft package does not actually implement network transport between the rough",
    "start": "1307480",
    "end": "1315070"
  },
  {
    "text": "notes right so if you look at this send function this is basically marking this",
    "start": "1315070",
    "end": "1320110"
  },
  {
    "text": "function this message is from myself and then it's simply append this message a",
    "start": "1320110",
    "end": "1327220"
  },
  {
    "text": "right this is the message and that is appended to its local message queue and",
    "start": "1327220",
    "end": "1333300"
  },
  {
    "text": "this message queue is going to be so remember the raft state machines output",
    "start": "1333300",
    "end": "1340990"
  },
  {
    "text": "is something called a ready right it's a ready structure let's just quickly go back through to make sure everybody",
    "start": "1340990",
    "end": "1347830"
  },
  {
    "text": "still remembers so this is the output of the raft state machine right we just saw its input now its output is going to",
    "start": "1347830",
    "end": "1356980"
  },
  {
    "text": "include this this message a see this message a is appended to this message Q",
    "start": "1356980",
    "end": "1363340"
  },
  {
    "text": "then it's going to be included in this message so what's the output of this",
    "start": "1363340",
    "end": "1368770"
  },
  {
    "text": "follower a raft state machine it's going to be a ready structure but for simplicity we're just tracking the",
    "start": "1368770",
    "end": "1375490"
  },
  {
    "text": "messages okay the ready has other fields but we're",
    "start": "1375490",
    "end": "1380770"
  },
  {
    "text": "just tracking the messages so it basically is the same message right but",
    "start": "1380770",
    "end": "1386830"
  },
  {
    "text": "marked from as from itself and to to the leader we call this message be now",
    "start": "1386830",
    "end": "1395890"
  },
  {
    "text": "whoever is using this wrap package needs to needs to process those messages needs",
    "start": "1395890",
    "end": "1402700"
  },
  {
    "text": "to process these messages from the output of the raft state machine right in this case these messages will be sent",
    "start": "1402700",
    "end": "1409150"
  },
  {
    "text": "to their destinations so let's look at the leader here this message is this is",
    "start": "1409150",
    "end": "1416170"
  },
  {
    "text": "the same message B is going to be so remember you need to implement the",
    "start": "1416170",
    "end": "1422320"
  },
  {
    "text": "network transport right so that Network transport implementation needs to forward the message B from the followers",
    "start": "1422320",
    "end": "1428680"
  },
  {
    "text": "output to this leaders input now it's here let's look at that leaders function again this is the message be",
    "start": "1428680",
    "end": "1436230"
  },
  {
    "text": "here and it's of this type message prop so let's see what leader does it first a",
    "start": "1436230",
    "end": "1444670"
  },
  {
    "text": "pens all the entries from this message to its own raft log this is what it does",
    "start": "1444670",
    "end": "1452320"
  },
  {
    "text": "and then this function tries to append its raft logs to two other raft nodes in",
    "start": "1452320",
    "end": "1461560"
  },
  {
    "text": "this cluster so let's say we have two other nodes in this cluster it's gonna",
    "start": "1461560",
    "end": "1467470"
  },
  {
    "text": "for each of those nodes it's gonna call this function which is a new message of",
    "start": "1467470",
    "end": "1474760"
  },
  {
    "text": "a different type now message Japan because now we're trying to replicate or",
    "start": "1474760",
    "end": "1480280"
  },
  {
    "text": "the leaders own log to other nodes right - is - that pier then entries includes",
    "start": "1480280",
    "end": "1487480"
  },
  {
    "text": "leaders own entry commits we're gonna talk about later so this is basically I'll actually already talk about it",
    "start": "1487480",
    "end": "1493390"
  },
  {
    "text": "right so when Lee cuz leader leader monitors each knows progress will",
    "start": "1493390",
    "end": "1499090"
  },
  {
    "text": "majority of those already have a certain entry is gonna be marked as committed",
    "start": "1499090",
    "end": "1504700"
  },
  {
    "text": "right so this is leader telling everybody the progress of the entire",
    "start": "1504700",
    "end": "1509920"
  },
  {
    "text": "cluster which means like which which ref logs are actually committed and after he",
    "start": "1509920",
    "end": "1516250"
  },
  {
    "text": "generates this this message is gonna send this message this is the same sin function we just saw so this is going to",
    "start": "1516250",
    "end": "1523420"
  },
  {
    "text": "be a pen to leaders local message queue and eventually it goes to leaders ready",
    "start": "1523420",
    "end": "1530470"
  },
  {
    "text": "output the ready structure right okay so",
    "start": "1530470",
    "end": "1536200"
  },
  {
    "text": "I think we are going to probably skip some of the steps what I'm trying to",
    "start": "1536200",
    "end": "1543130"
  },
  {
    "text": "show here is how to read how to how to read a source code like given given an",
    "start": "1543130",
    "end": "1550930"
  },
  {
    "text": "an input based on whatever the current",
    "start": "1550930",
    "end": "1556240"
  },
  {
    "text": "state is whether you're a leader whether you're a follower it's gonna have different state transition and in return",
    "start": "1556240",
    "end": "1563560"
  },
  {
    "text": "it's going to generate more messages and maybe more entries and they are going to show up in the rav",
    "start": "1563560",
    "end": "1570940"
  },
  {
    "text": "state machines output which is the structure we called ready right so maybe",
    "start": "1570940",
    "end": "1577450"
  },
  {
    "text": "let's just fast forward to the last step of this example which so what we have",
    "start": "1577450",
    "end": "1583960"
  },
  {
    "text": "saying we've saying that we've saying the clients request which is the message",
    "start": "1583960",
    "end": "1591220"
  },
  {
    "text": "a including this message a was forwarded to the leader right we saw a step - its",
    "start": "1591220",
    "end": "1596590"
  },
  {
    "text": "forwarded to the leader appended - leaders local RAF log and leader tries",
    "start": "1596590",
    "end": "1602110"
  },
  {
    "text": "to replicate that RAF lock to other nodes in this cluster and eventually it's going to be successful so let's say",
    "start": "1602110",
    "end": "1609670"
  },
  {
    "text": "most of the knows already has this new raft entry and the leader knows that and",
    "start": "1609670",
    "end": "1615250"
  },
  {
    "text": "leader marks that new raft entry as committed and eventually is going to send a message with the updated",
    "start": "1615250",
    "end": "1622150"
  },
  {
    "text": "committed index so when this message is received by the follower the original",
    "start": "1622150",
    "end": "1630610"
  },
  {
    "text": "follower it knows oh that new raft entry is committed so I'm it's safe to be",
    "start": "1630610",
    "end": "1636460"
  },
  {
    "text": "applied what happens then is that because remember this new raft raft log",
    "start": "1636460",
    "end": "1644320"
  },
  {
    "text": "entry is committed from the output of this followers raft state machine from its output you're",
    "start": "1644320",
    "end": "1651730"
  },
  {
    "text": "gonna see that new raft entry show up here as committed entries now it's ready",
    "start": "1651730",
    "end": "1657700"
  },
  {
    "text": "to be applied alright so this is the",
    "start": "1657700",
    "end": "1663340"
  },
  {
    "start": "1660000",
    "end": "1907000"
  },
  {
    "text": "graph we just saw earlier we're going to talk about with more details because now we see more details first we don't care",
    "start": "1663340",
    "end": "1670840"
  },
  {
    "text": "about the client side now so the first thing we we know is that the raft",
    "start": "1670840",
    "end": "1675970"
  },
  {
    "text": "package does not implement persistent storage interface it does not implement",
    "start": "1675970",
    "end": "1682720"
  },
  {
    "text": "Network transport between the raft nodes so these are actually if you are using",
    "start": "1682720",
    "end": "1688090"
  },
  {
    "text": "the wrap package you need to implement these and then if you're using this this",
    "start": "1688090",
    "end": "1696400"
  },
  {
    "text": "raft package you are probably going to with something like this a handling loop you're gonna need to consume and process",
    "start": "1696400",
    "end": "1703999"
  },
  {
    "text": "all the output from your local raft state machine so this gives you the",
    "start": "1703999",
    "end": "1709970"
  },
  {
    "text": "ready structure we just saw it's stored in here the first thing you should do is",
    "start": "1709970",
    "end": "1717019"
  },
  {
    "text": "this storage is your own implementation of the storage interface you need to",
    "start": "1717019",
    "end": "1722749"
  },
  {
    "text": "save the state save the entries and then the next step is that this is your own",
    "start": "1722749",
    "end": "1728599"
  },
  {
    "text": "implementation of the network transport between the raft nodes you need to send",
    "start": "1728599",
    "end": "1733940"
  },
  {
    "text": "those messages remember you are responsible for actually delivering those messages and then for all the",
    "start": "1733940",
    "end": "1741590"
  },
  {
    "text": "committed entries it's safe to be applied so what's the lifecycle of a",
    "start": "1741590",
    "end": "1749419"
  },
  {
    "text": "client request a client request is first going to be remember it's going to be relative to the raft and it's gonna call",
    "start": "1749419",
    "end": "1758330"
  },
  {
    "text": "this proposed function which generates a message a raft message right and within",
    "start": "1758330",
    "end": "1765139"
  },
  {
    "text": "the raft consensus protocol it's gonna so the local raft state machine is gonna generate based on that raft message it's",
    "start": "1765139",
    "end": "1773749"
  },
  {
    "text": "gonna generate a whole bunch of new raft messages and be sent to other node another node in return might generate",
    "start": "1773749",
    "end": "1780559"
  },
  {
    "text": "other messages right so it's back and forth but eventually if that raft log",
    "start": "1780559",
    "end": "1787729"
  },
  {
    "text": "entry is committed which means most node has that entry eventually it's going to",
    "start": "1787729",
    "end": "1793789"
  },
  {
    "text": "show up in your output field committed entries so now the server server needs",
    "start": "1793789",
    "end": "1802970"
  },
  {
    "text": "to apply the committed log entries to the key value store and the applied",
    "start": "1802970",
    "end": "1808220"
  },
  {
    "text": "result is going to be sent back to the client",
    "start": "1808220",
    "end": "1813099"
  },
  {
    "text": "all right so quickly this is on some of the ongoing efforts I'm aware of the",
    "start": "1814479",
    "end": "1821509"
  },
  {
    "text": "first one is actually completed so the raft package itself supports learner and",
    "start": "1821509",
    "end": "1828049"
  },
  {
    "text": "normal team member actually for a while now but recently at sea server also adds support for learner and",
    "start": "1828049",
    "end": "1835370"
  },
  {
    "text": "normal team member if you're interested here's the link for you to start another ongoing effort is that there is a raft",
    "start": "1835370",
    "end": "1843080"
  },
  {
    "text": "membership there is joint consensus for a raft membership reconfiguration which is different than the current membership",
    "start": "1843080",
    "end": "1849500"
  },
  {
    "text": "reconfiguration implementation in raft if you're interested there this is the",
    "start": "1849500",
    "end": "1855309"
  },
  {
    "text": "starting point for you alright so do we have time for Q&A or have plenty of time",
    "start": "1855309",
    "end": "1863750"
  },
  {
    "text": "okay good any questions you're waiting charges",
    "start": "1863750",
    "end": "1880240"
  },
  {
    "text": "when you refer a change oh just help you well okay you you can't change okay go",
    "start": "1880240",
    "end": "1888050"
  },
  {
    "text": "go your residential use much fibula so it has some - two Toads hands",
    "start": "1888050",
    "end": "1894380"
  },
  {
    "text": "interlocked now how would take a lager so - wait - wait hold up hah gigolo goes",
    "start": "1894380",
    "end": "1901070"
  },
  {
    "text": "to talk with pseudo header where they go pantego it's about now - fun - what's my",
    "start": "1901070",
    "end": "1908660"
  },
  {
    "text": "channel as you see she's been sound crazy much shorter she foil the foil",
    "start": "1908660",
    "end": "1914390"
  },
  {
    "text": "that you got a client and I sing Shana anyway Condon says you may will achieve",
    "start": "1914390",
    "end": "1921290"
  },
  {
    "text": "out Chun fishing soil the flow the client addressing showed total change at",
    "start": "1921290",
    "end": "1927350"
  },
  {
    "text": "all chica loca shaumyan to thai side changing that she executes search engine I should've done years ago",
    "start": "1927350",
    "end": "1933500"
  },
  {
    "text": "they hold the key value storage is Chen toilet actually so important you should read the hydrorite how much it had a",
    "start": "1933500",
    "end": "1940160"
  },
  {
    "text": "command that to go to she saw a magician info tomato",
    "start": "1940160",
    "end": "1946370"
  },
  {
    "text": "then considered when should you go Raph - paper don't wanna see you go to college in Hangzhou Chattanooga she go",
    "start": "1946370",
    "end": "1952790"
  },
  {
    "text": "read request you should know - don't wanna see a new clip I pass Tagalog and if we do so logical log anyway you",
    "start": "1952790",
    "end": "1960080"
  },
  {
    "text": "should turn on I'm a solid number you should sad city",
    "start": "1960080",
    "end": "1966570"
  },
  {
    "text": "is standing in each hole linearizable to read the cheating trying to read the hardship which shows I said earlier that",
    "start": "1966570",
    "end": "1972240"
  },
  {
    "text": "she's near boucle by passage and go raft you choose issue to which I introducing many when you cannot you cannot meet a",
    "start": "1972240",
    "end": "1978030"
  },
  {
    "text": "lot so long anyway you mean she articulates about young fishing here are three tequilas he won't usual then he",
    "start": "1978030",
    "end": "1984630"
  },
  {
    "text": "sold out to go to the sauna you know when he's a leader show miss entire cluster young women guy applied on I",
    "start": "1984630",
    "end": "1990720"
  },
  {
    "text": "know I can trailer nominees at local that you go deep on y'all yeah y'all tongue slowly she I applied",
    "start": "1990720",
    "end": "1997260"
  },
  {
    "text": "at all high one donation yeah but latest the chicken soil the sending children are you got twitching shoulder she hold",
    "start": "1997260",
    "end": "2003470"
  },
  {
    "text": "my attention just authorizing to me - I'll apply that this year commander",
    "start": "2003470",
    "end": "2009350"
  },
  {
    "text": "Moodle apply one lady whole is how he should do so you shall wait on me sir -",
    "start": "2009350",
    "end": "2014630"
  },
  {
    "text": "is Joe clay pipe has Co question who shot a toy because you go disc IO I'll sign a nice quick it's a rough log Lima",
    "start": "2014630",
    "end": "2024800"
  },
  {
    "text": "she click and I'll read a and Twitter so you holding a smell when T",
    "start": "2024800",
    "end": "2037480"
  },
  {
    "text": "100 you going to shore oil never logged into master the one notch omega P Gina",
    "start": "2038110",
    "end": "2044990"
  },
  {
    "text": "y'all go into Shore Oh see now with the client come with y'all with a cynical",
    "start": "2044990",
    "end": "2050810"
  },
  {
    "text": "with ego follow ho not too much okay Nikki Bella stars",
    "start": "2050810",
    "end": "2057370"
  },
  {
    "text": "oh you got your fidelity go and here which others okay",
    "start": "2057370",
    "end": "2063379"
  },
  {
    "text": "so anyway us you should soil me to essentialist and then you see a magician",
    "start": "2063380",
    "end": "2069290"
  },
  {
    "text": "is slow the request you should watch and see Lewis as you go along some expansion you so to request Oh eating serializable",
    "start": "2069290",
    "end": "2075379"
  },
  {
    "text": "toting linearize the switch put something into it since i cellular the whole that's an IE whole night you should",
    "start": "2075380",
    "end": "2080990"
  },
  {
    "text": "wanna shout - Adonis is in the video she didn't even to use their followers when you're clear to technician wins our",
    "start": "2080990",
    "end": "2086929"
  },
  {
    "text": "leaders an authority on a whole new Pandi Kenosha Tunisia",
    "start": "2086929",
    "end": "2092450"
  },
  {
    "text": "County arguin see you soon",
    "start": "2092450",
    "end": "2095950"
  },
  {
    "text": "she sounds that when he swore it was she was chasing - Aloha maybe sitting Shahrukh walk can touch all who the",
    "start": "2100480",
    "end": "2106849"
  },
  {
    "text": "server she go follow our number she leader has your followers that kind here I was torn and I'm a key value store so she sent me go server John Doe yo-yo the",
    "start": "2106849",
    "end": "2114740"
  },
  {
    "text": "negotiation shown away so she a entryway forward the dog leader in the beyond a hole leader who a panda",
    "start": "2114740",
    "end": "2121010"
  },
  {
    "text": " untreated log Samia Omega leader Chacon away bar make log he'll",
    "start": "2121010",
    "end": "2126980"
  },
  {
    "text": "replicate that had a Papa followers ambience we eventually follower yoy analog the hotel double foreign toilet",
    "start": "2126980",
    "end": "2134089"
  },
  {
    "text": "eagle on a leader who allow Chanel - she mentioned I ugh but her Markham committed cynically apply law same place",
    "start": "2134089",
    "end": "2141349"
  },
  {
    "text": "you apply the not medusa show you took a log entry the node poked logical follower module which you apply apply",
    "start": "2141349",
    "end": "2147859"
  },
  {
    "text": "one Leona chicka result we found quickly in easy go can you tell who the little client",
    "start": "2147859",
    "end": "2154150"
  },
  {
    "text": "what's our you went you just acquire any good Lords canal solutions a true",
    "start": "2161079",
    "end": "2176150"
  },
  {
    "text": "Tom Buddha Partridge who wrote down i've sink know about loggers their own true  on it's not a job you're going to",
    "start": "2176150",
    "end": "2182930"
  },
  {
    "text": "talk analog its charge will promote our economy our I've sink junk I know he was seen I went to do which our charger is",
    "start": "2182930",
    "end": "2190579"
  },
  {
    "text": "it easy for me - Laura - reading Felicia Twitter in",
    "start": "2190579",
    "end": "2195890"
  },
  {
    "text": "which institutions are after tomorrow at City demand higher sure you got a package you can Doha type how do you",
    "start": "2195890",
    "end": "2202609"
  },
  {
    "text": "lose a manager job it means the connects all weird and confusing technical means is your waters wal your folders and it's usually",
    "start": "2202609",
    "end": "2209630"
  },
  {
    "text": "implements that you should just took",
    "start": "2209630",
    "end": "2214869"
  },
  {
    "text": "- secret tape movement you see you could tell who the Walker an enzyme no no ha",
    "start": "2216160",
    "end": "2221620"
  },
  {
    "text": "ha jiggle pushing Megaton to the log and she doe don't wait and to a diversity sky or thing I should patch the position",
    "start": "2221620",
    "end": "2234880"
  },
  {
    "text": "make that can i : haha - can you clean",
    "start": "2234880",
    "end": "2251020"
  },
  {
    "text": "Senegal at City the ripples immensities alga usual or winter or corner leisure so you should need some a",
    "start": "2251020",
    "end": "2256180"
  },
  {
    "text": "human to go raft raft package that when he just needs some much you so much you",
    "start": "2256180",
    "end": "2261460"
  },
  {
    "text": "consumed how to output him is awful email quickly and easy go quickly in ichika entries she gradually shot you to",
    "start": "2261460",
    "end": "2267070"
  },
  {
    "text": "cannot summon the raft log no magical to tease the material question what does he",
    "start": "2267070",
    "end": "2272800"
  },
  {
    "text": "kind of at city you're after the holland heart happy bushy booshy insurance or",
    "start": "2272800",
    "end": "2278170"
  },
  {
    "text": "depot semihot past dates from about rough logs when oh yah ha type a message sandy key she had a rough log as rough",
    "start": "2278170",
    "end": "2286030"
  },
  {
    "text": "note now whole tree holes that she applies you go committed entries to acknowledge other secrets finished you",
    "start": "2286030",
    "end": "2293380"
  },
  {
    "text": "can hear - it actually nice actually I just saw your vocal I went here to go what kind of an uglier actually where",
    "start": "2293380",
    "end": "2299050"
  },
  {
    "text": "Ichigo issue interpret Hollinger yes",
    "start": "2299050",
    "end": "2308620"
  },
  {
    "text": "enjoys a it is leading at you should you your only place your objects",
    "start": "2308620",
    "end": "2313840"
  },
  {
    "text": "how it later event no no food on his father's synagogue kubernetes Nemean young at City the tour spirit is you",
    "start": "2313840",
    "end": "2321610"
  },
  {
    "text": "know usually on Hanukkah event doing elephant or not how we do it really when",
    "start": "2321610",
    "end": "2326920"
  },
  {
    "text": "should you toward chimney Hong Kong yeah to Okinawa what we see are concise",
    "start": "2326920",
    "end": "2333160"
  },
  {
    "text": "worldly events your teacher or the d'Ivoire military coup de Janeiro events squared hasha gillece unreleased",
    "start": "2333160",
    "end": "2339850"
  },
  {
    "text": "or can see the default is also hard or harder to talk we have a bit single",
    "start": "2339850",
    "end": "2345580"
  },
  {
    "text": "other DVI otro lado a single wait [Music]",
    "start": "2345580",
    "end": "2352139"
  },
  {
    "text": "No yo yo yo - show yourself disability -",
    "start": "2354900",
    "end": "2367150"
  },
  {
    "text": "you know mr. Tomo you guys know about Santa generally fun happy now you told",
    "start": "2367150",
    "end": "2373119"
  },
  {
    "text": "me we were sent to another on kanji for a phone back on typical - um okay Stella",
    "start": "2373119",
    "end": "2381219"
  },
  {
    "text": "what'd you think when she pushed her guitar a mysterious half dollar oh yeah yeah",
    "start": "2381219",
    "end": "2388779"
  },
  {
    "text": "yeah yeah",
    "start": "2388779",
    "end": "2391859"
  }
]