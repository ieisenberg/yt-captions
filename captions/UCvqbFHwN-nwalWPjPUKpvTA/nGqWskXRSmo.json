[
  {
    "text": "hello everybody welcome to this cheeky new toy it can sound strange but all of this",
    "start": "480",
    "end": "5520"
  },
  {
    "text": "talk is to share with you all the findings of an experiment finding new ways to bypass a cncf cool",
    "start": "5520",
    "end": "11519"
  },
  {
    "text": "tool called falco falco is a runtime security project and i shoot that",
    "start": "11519",
    "end": "16960"
  },
  {
    "text": "i'm one of its outdoors my name is leonardo but people usually shorten my name so feel",
    "start": "16960",
    "end": "22720"
  },
  {
    "text": "free to just call me leo here's a photo of me moving ends like a real italian",
    "start": "22720",
    "end": "28000"
  },
  {
    "text": "usual promise falco's one to the first one guessing the exact meaning i'm writing it to my twitter direct messages",
    "start": "28000",
    "end": "34480"
  },
  {
    "text": "what i do daily well i'm an open source software engineer at sysdig where my daily job is to",
    "start": "34480",
    "end": "39920"
  },
  {
    "text": "guess what write code for falco and maintain it maybe you're confused at this point what",
    "start": "39920",
    "end": "45600"
  },
  {
    "text": "a maintainer falco talking on how to bypass it i know crazy times to be alive",
    "start": "45600",
    "end": "51600"
  },
  {
    "text": "i firmly believe that challenging your software really hard is the only way to actually improve it but just give me some minutes and i'll",
    "start": "51600",
    "end": "58719"
  },
  {
    "text": "completely explain to you the reasoning behind this approach in the meantime you can find me on twitter where i tweeted these slides",
    "start": "58719",
    "end": "65360"
  },
  {
    "text": "with the nickname leodido feel free to drop me a line follow me ask questions about falco bpf kernel",
    "start": "65360",
    "end": "71280"
  },
  {
    "text": "whatever no problem at all first things first where does falco come from",
    "start": "71280",
    "end": "77520"
  },
  {
    "text": "falco is a runtime security project originally created in 2016 by sysdig",
    "start": "77520",
    "end": "82720"
  },
  {
    "text": "the company that pays me a salary i don't know why then in 2018 it was donated to the cncf",
    "start": "82720",
    "end": "90640"
  },
  {
    "text": "a branch of the linux foundation thus becoming the fourth cncf sandbox runtime security project",
    "start": "90640",
    "end": "96479"
  },
  {
    "text": "it started to gain some serious traction to the point that the other maintainers and i had to even",
    "start": "96479",
    "end": "102720"
  },
  {
    "text": "start weekly community calls to which by the way i invite anyone to participate every wednesday at 5 p.m italian time",
    "start": "102720",
    "end": "110240"
  },
  {
    "text": "this past january falco was the first ever runtime security project to be promoted",
    "start": "110240",
    "end": "115280"
  },
  {
    "text": "to the cncf incubation level the next natural step is to bring farco to a",
    "start": "115280",
    "end": "120640"
  },
  {
    "text": "level of maturity so as to make it possible to graduate it but in order to do this it's absolutely",
    "start": "120640",
    "end": "127920"
  },
  {
    "text": "essential that we identify and assess its faults it's also with this mind that i talked about",
    "start": "127920",
    "end": "134160"
  },
  {
    "text": "this experiment in this talk stressing our software challenging its limits so to be able to improve them is the",
    "start": "134160",
    "end": "141360"
  },
  {
    "text": "fourth step and invite anyone here to try falco challenge it and report back to us and",
    "start": "141360",
    "end": "147280"
  },
  {
    "text": "to the falco community the findings so we can gain more and more awareness",
    "start": "147280",
    "end": "152319"
  },
  {
    "text": "in the end breaking things is the best way to understand how to fix them isn't it",
    "start": "152319",
    "end": "158000"
  },
  {
    "text": "anyways the plan for the next 20 minutes is to look up photos of my beautiful homeland in southern",
    "start": "158000",
    "end": "164160"
  },
  {
    "text": "italy that i miss so much remembering the good old times when we were all free to travel around and",
    "start": "164160",
    "end": "169599"
  },
  {
    "text": "pandemics were only a movie thing in the meanwhile i'll approach the",
    "start": "169599",
    "end": "174640"
  },
  {
    "text": "reasons behind the choice to stress falcon why i think this is the best possible approach to make a runtime security",
    "start": "174640",
    "end": "180400"
  },
  {
    "text": "software more and more solid day after day in order to do so we also need to",
    "start": "180400",
    "end": "185599"
  },
  {
    "text": "briefly get skinny on our farco solves the runtime security problem even for the cloud native environments",
    "start": "185599",
    "end": "192319"
  },
  {
    "text": "based on kubernetes and the way to do this is by looking at how it actually works under the olds",
    "start": "192319",
    "end": "198640"
  },
  {
    "text": "i mean that's the way to go when you really want to understand things not to mention when you want to bypass",
    "start": "198640",
    "end": "204400"
  },
  {
    "text": "them we'll also reflect a bit on the security landscape in general",
    "start": "204400",
    "end": "209840"
  },
  {
    "text": "shortly after this page i'll demo some of the possible ways to bypass",
    "start": "209840",
    "end": "215040"
  },
  {
    "text": "falco developing them as accounted for the most of the work that went into preparing this talk so",
    "start": "215040",
    "end": "222560"
  },
  {
    "text": "please be kind with me i'll also present some mitigation and even fixes that we",
    "start": "222560",
    "end": "227760"
  },
  {
    "text": "put in place to prevent you from using my ideas to bypass my blood falco in the future",
    "start": "227760",
    "end": "233280"
  },
  {
    "text": "consider it an encouragement to find and develop your own as soon as this tool got accepted i told",
    "start": "233280",
    "end": "240640"
  },
  {
    "text": "my dad look paw i'm gonna teach people how to bypass the software rebuild i'll spare you the details but what",
    "start": "240640",
    "end": "246640"
  },
  {
    "text": "ensued was a fairly predictable and stereotypical italian family drama he",
    "start": "246640",
    "end": "252080"
  },
  {
    "text": "started yelling at me and shouted that to do such a thing was a grave and unforgivable mistake",
    "start": "252080",
    "end": "257199"
  },
  {
    "text": "that since they could have should have fired me for even conceiving something as twisted",
    "start": "257199",
    "end": "263199"
  },
  {
    "text": "as this indeed according to him presenting in public the shortcomings",
    "start": "263199",
    "end": "269280"
  },
  {
    "text": "of the software contribute to creating amount to admit some sort of failure either mine or of my team or of my",
    "start": "269280",
    "end": "276639"
  },
  {
    "text": "company as a wall in his eyes it was an admission of defeat the product",
    "start": "276639",
    "end": "282240"
  },
  {
    "text": "of a subversive attitude i tried in vain as he was still shouting",
    "start": "282240",
    "end": "289280"
  },
  {
    "text": "to explain that a constructive attitude begins with a quest for our weaknesses it's the first unnecessary step in",
    "start": "289280",
    "end": "295600"
  },
  {
    "text": "gaining self-awareness it's only by getting to really know our limits that we can hope to overcome them",
    "start": "295600",
    "end": "301360"
  },
  {
    "text": "it's only after having looked into the ravines long enough that we can imagine ways of feeling them",
    "start": "301360",
    "end": "307120"
  },
  {
    "text": "it's a matter of epistemic hunger of knowing that the path to real improvement is almost inevitably convoluted",
    "start": "307120",
    "end": "314160"
  },
  {
    "text": "difficult even painful software development can be conceived as a process was main feature",
    "start": "314160",
    "end": "321120"
  },
  {
    "text": "is the continuous strive for the attainment of perfection that is by definition unattainable the",
    "start": "321120",
    "end": "327360"
  },
  {
    "text": "life of software is really over only when it's no longer fixed or improved",
    "start": "327360",
    "end": "333280"
  },
  {
    "text": "any software will always present some glitches but broken does mean unfixable software",
    "start": "333280",
    "end": "339600"
  },
  {
    "text": "is improved over time and made more robust and reliable by this continuous process of tinkering playing",
    "start": "339600",
    "end": "345759"
  },
  {
    "text": "fixing improving this is the case in every subfield of computer science but even more so in a real mess dynamic",
    "start": "345759",
    "end": "353039"
  },
  {
    "text": "as security in which every day carries the possibility that our solutions suddenly become obsolete and",
    "start": "353039",
    "end": "360720"
  },
  {
    "text": "in a need of a fix a patch or generally an improvement when i think about this often kitsuji",
    "start": "360720",
    "end": "367440"
  },
  {
    "text": "pops to my mind kitsuji is an ancient japanese art consisting of repairing",
    "start": "367440",
    "end": "372479"
  },
  {
    "text": "broken pottery by maintaining the iris with powered gold silver or platinum",
    "start": "372479",
    "end": "377520"
  },
  {
    "text": "it threats breakage and repair as part of the history of an object rather than something to disguise",
    "start": "377520",
    "end": "384319"
  },
  {
    "text": "in a very real sense this japanese practice that fascinates me captures the core of what i said so far",
    "start": "384319",
    "end": "392080"
  },
  {
    "text": "indeed developing software is a therapeutic process that inscribes the way we deal with imperfections glitches",
    "start": "392080",
    "end": "398960"
  },
  {
    "text": "fisheries into the essence of our software making it more precious and more solid as a result",
    "start": "398960",
    "end": "404880"
  },
  {
    "text": "but let's come back to real world now okay so what does security mean to me how to characterize the security problem",
    "start": "404880",
    "end": "412400"
  },
  {
    "text": "i don't know about you but i personally wouldn't want anything to happen to my system without me even",
    "start": "412400",
    "end": "417840"
  },
  {
    "text": "noticing it at least in this context i want to be able to determine what things can happen and what cannot since preempting control",
    "start": "417840",
    "end": "425280"
  },
  {
    "text": "is not always possible i also want to possess deep visibility",
    "start": "425280",
    "end": "430319"
  },
  {
    "text": "so as to be able to know what just happened as soon as possible basically i think of security in terms",
    "start": "430319",
    "end": "436639"
  },
  {
    "text": "of two words prevention and detection what does these two words have in common policies",
    "start": "436639",
    "end": "445440"
  },
  {
    "text": "both concepts use some kind of policies to describe the love or disallowed behavior for a process",
    "start": "445440",
    "end": "451360"
  },
  {
    "text": "in terms of system calls their arguments and those resources assessed the main",
    "start": "451360",
    "end": "457440"
  },
  {
    "text": "differences is this the first world prevention is connected to the concept of enforcement",
    "start": "457440",
    "end": "463120"
  },
  {
    "text": "in other words do not allow some actions to take place to open a tone because of some policies tools in these",
    "start": "463120",
    "end": "469440"
  },
  {
    "text": "categories such as second second bpfc linux app armor or even authorization mechanism",
    "start": "469440",
    "end": "475280"
  },
  {
    "text": "like kubernetes or back or the kubernetes policy-based transmission plugins change the behavior of a process by",
    "start": "475280",
    "end": "481440"
  },
  {
    "text": "preventing actions sometimes cisco's from succeeding or in some cases also",
    "start": "481440",
    "end": "486879"
  },
  {
    "text": "killing the process trying to perform those actions on the other end the second approach to",
    "start": "486879",
    "end": "492879"
  },
  {
    "text": "security is to use the policy to monitor the behavior of a process and notify when it steps",
    "start": "492879",
    "end": "498639"
  },
  {
    "text": "outside the policy falco belongs to this second group a topic that especially in cloud native",
    "start": "498639",
    "end": "504960"
  },
  {
    "text": "environments has not been solved yet maybe you're wondering now can falco solve all our security concerns",
    "start": "504960",
    "end": "512719"
  },
  {
    "text": "honestly not at all software is made of layers so is security this is even more true in",
    "start": "512719",
    "end": "519039"
  },
  {
    "text": "the current cloud native environments as you can see the scheme on the slide pod services ingress",
    "start": "519039",
    "end": "524320"
  },
  {
    "text": "containers and so on up and down these are environments that embrace change as their fundamental component",
    "start": "524320",
    "end": "531200"
  },
  {
    "text": "constantly opening the doors to the unknown so falco exists to enable us to detect",
    "start": "531200",
    "end": "536399"
  },
  {
    "text": "intrusions malicious behaviors security threats in general at runtime let me also be clear that",
    "start": "536399",
    "end": "543200"
  },
  {
    "text": "since security is made of layers my suggestion is to combine falco with prevention tools thus applying a defense in-depth",
    "start": "543200",
    "end": "550000"
  },
  {
    "text": "strategy the idea is to defend a system against any particular attack using several",
    "start": "550000",
    "end": "555760"
  },
  {
    "text": "independent methods the first specific example that comes to my mind is using falco to identify malicious attempts to",
    "start": "555760",
    "end": "562320"
  },
  {
    "text": "assess sensitive resources by observing the word behavior of your environments and then write appropriate enforcement",
    "start": "562320",
    "end": "568800"
  },
  {
    "text": "policies for example up armor profiles for your containers that will prevent the episode to happen again in",
    "start": "568800",
    "end": "574640"
  },
  {
    "text": "the future basically implementing a sort of feedback loop continuously improving the",
    "start": "574640",
    "end": "579680"
  },
  {
    "text": "security posture of our environments so what's runtime security with this tour i",
    "start": "579680",
    "end": "584959"
  },
  {
    "text": "refer to the practice of using detection tooling to detect unwanted behavior such that it",
    "start": "584959",
    "end": "590320"
  },
  {
    "text": "can then be prevented using prevention techniques so to continuously improve your threat",
    "start": "590320",
    "end": "595680"
  },
  {
    "text": "model its last line of defense this means that in case it is not able to promptly detect and",
    "start": "595680",
    "end": "602160"
  },
  {
    "text": "alert you of malicious attempts you will end up like sitting ducks defenseless",
    "start": "602160",
    "end": "607920"
  },
  {
    "text": "let's try with a metaphor she's kelly look how beautiful she was i have locks",
    "start": "607920",
    "end": "613839"
  },
  {
    "text": "on my door and also an allen think of them as compliance rules but she allows me when things",
    "start": "613839",
    "end": "619920"
  },
  {
    "text": "aren't going right policy violations when little bro is misbehaving think of him like a",
    "start": "619920",
    "end": "626320"
  },
  {
    "text": "compromised insider or if there's something suspicious happening outside or nearby a normally",
    "start": "626320",
    "end": "631680"
  },
  {
    "text": "or zero day she detects runtime anomalies in my life at home and she was may she rest in",
    "start": "631680",
    "end": "637360"
  },
  {
    "text": "peace very very serious about her job as you can see the picture so why prevention is about locking",
    "start": "637360",
    "end": "645279"
  },
  {
    "text": "the doors detection is about continuously monitoring the inside and the perimeter",
    "start": "645279",
    "end": "650880"
  },
  {
    "text": "still bad people were able to enter my house and put her to sleep",
    "start": "650880",
    "end": "656240"
  },
  {
    "text": "i think i made myself a bit more clear now sadly in case you're still not convinced that",
    "start": "656240",
    "end": "661920"
  },
  {
    "text": "there's no such thing as perfectly safe and perfectly secure software and the layered approach is the best",
    "start": "661920",
    "end": "667600"
  },
  {
    "text": "possible strategy for software security just allow me to emphasize a few points how to trust cloud",
    "start": "667600",
    "end": "675040"
  },
  {
    "text": "providers and their ability to detect malicious or compromised insiders how to prevent an undisclosed",
    "start": "675040",
    "end": "681360"
  },
  {
    "text": "vulnerability or a zero-day bug that allows someone to brag into your system i mean cv still",
    "start": "681360",
    "end": "688079"
  },
  {
    "text": "happens linux kubernetes name an open source software that has not experienced a cv and software than explore falco had",
    "start": "688079",
    "end": "695760"
  },
  {
    "text": "one too i think it's clear now that prevention tools are not enough alone neither are detection tools",
    "start": "695760",
    "end": "702240"
  },
  {
    "text": "alone good computer security is hard it requires a lot",
    "start": "702240",
    "end": "707440"
  },
  {
    "text": "of technical knowledge and takes a lot of time and effort and at the end of the day there will",
    "start": "707440",
    "end": "713760"
  },
  {
    "text": "always still be weaknesses in your system this means that you should never below the intel false",
    "start": "713760",
    "end": "719839"
  },
  {
    "text": "sense of security thinking that you're working on a secure system your system can be more or",
    "start": "719839",
    "end": "726079"
  },
  {
    "text": "less secure but a perfect one doesn't exist this does not mean that you should do nothing",
    "start": "726079",
    "end": "732720"
  },
  {
    "text": "it's just about awareness and surely there are ways to harden your runtime for example dropping",
    "start": "732720",
    "end": "739839"
  },
  {
    "text": "capabilities so preventing things to happen when a container starts in a way to harden it but that's just one side of",
    "start": "739839",
    "end": "746560"
  },
  {
    "text": "the coin when you have a goal of reinforcing the isolation between the container and the",
    "start": "746560",
    "end": "751920"
  },
  {
    "text": "asteroids using a container more like a sandbox the main option you have is",
    "start": "751920",
    "end": "756959"
  },
  {
    "text": "cisco monitoring right surely somebody could still argue but why tracing the",
    "start": "756959",
    "end": "762560"
  },
  {
    "text": "ciscos because in the end whatever program you run it will end up making a lot of c schools",
    "start": "762560",
    "end": "768240"
  },
  {
    "text": "cisco's are the way programs ask the kernel where everything really happens to perform",
    "start": "768240",
    "end": "773600"
  },
  {
    "text": "some tasks whether the task regards networking io processes and so on this does matter",
    "start": "773600",
    "end": "780240"
  },
  {
    "text": "here falco enters the game falco is designed to leverage libsy's to add a layer of security on",
    "start": "780240",
    "end": "786880"
  },
  {
    "text": "top of your containers and your nodes its approach for detecting security threats",
    "start": "786880",
    "end": "792240"
  },
  {
    "text": "is to go at the lowest possible level and trace all the footprints and the context in which they happened",
    "start": "792240",
    "end": "798000"
  },
  {
    "text": "the lymph systems are a special augmented structure containing infotainment by tracing the",
    "start": "798000",
    "end": "803279"
  },
  {
    "text": "syscalls going on in the kernel plus container and time and kubernetes metadata",
    "start": "803279",
    "end": "809200"
  },
  {
    "text": "related to the signals it uses those events to match a release that you can define with a",
    "start": "809200",
    "end": "814959"
  },
  {
    "text": "simple yet expressive language as we'll see very soon at the moment",
    "start": "814959",
    "end": "820399"
  },
  {
    "text": "falco can receive those events in three alternative ways that we call drivers through a kernel",
    "start": "820399",
    "end": "826320"
  },
  {
    "text": "module or within a bpf probe or with a ptrace based driver called",
    "start": "826320",
    "end": "831360"
  },
  {
    "text": "pdig that's really helpful in environments where you can't install the other two drivers",
    "start": "831360",
    "end": "837839"
  },
  {
    "text": "just mentioned anyways falco can also use other input sources",
    "start": "837839",
    "end": "843600"
  },
  {
    "text": "at the same time i'm referring to the kubernetes audit logs in particular that",
    "start": "843600",
    "end": "849040"
  },
  {
    "text": "proven to be very useful when leveraged by far code improved visibility into your kubernetes clusters so",
    "start": "849040",
    "end": "857040"
  },
  {
    "text": "we will ship also an input api that will allow the falco community to",
    "start": "857040",
    "end": "863519"
  },
  {
    "text": "create even more input sources i mentioned the falco rules language in",
    "start": "863519",
    "end": "869120"
  },
  {
    "text": "the previous slide right so maybe you're asking yourself okay leo but how do we define policies how do we describe",
    "start": "869120",
    "end": "876959"
  },
  {
    "text": "what's a security threat for us the falco rules are very simple to write since they are basically",
    "start": "876959",
    "end": "882839"
  },
  {
    "text": "yaml and this makes them very easy to write to learn and very very hard to indent",
    "start": "882839",
    "end": "888399"
  },
  {
    "text": "correctly but that's yammer fault not ours don't blame me",
    "start": "888399",
    "end": "893600"
  },
  {
    "text": "falco rules proven to be very straightforward to adopt unlike the policy languages of other",
    "start": "893600",
    "end": "899279"
  },
  {
    "text": "tools in the security space we mentioned earlier i mean have you ever tried writing c",
    "start": "899279",
    "end": "904480"
  },
  {
    "text": "linux policies and things like that in a falcon rule set you can write",
    "start": "904480",
    "end": "909519"
  },
  {
    "text": "conditions you can group them into macro studios later you can define lists you can give names",
    "start": "909519",
    "end": "915600"
  },
  {
    "text": "to rules customize their output message and the details it has to contain and so on",
    "start": "915600",
    "end": "921360"
  },
  {
    "text": "you can also override and mix things totally or partially finally focus ships with the default",
    "start": "921360",
    "end": "927920"
  },
  {
    "text": "huge rule set for reasons we are gonna explore understand better in a bit in case you",
    "start": "927920",
    "end": "935040"
  },
  {
    "text": "want to jump into reading thousands of lines of yaml i put a link in the slide footnote you're welcome for",
    "start": "935040",
    "end": "942320"
  },
  {
    "text": "example here we have a rule to detect untrusted shell being spawned below",
    "start": "942320",
    "end": "947680"
  },
  {
    "text": "an onshore application by looking at its condition we can see that",
    "start": "947680",
    "end": "952800"
  },
  {
    "text": "aside from specific applications that are allowed to spawn shell this rule emits an output dollar",
    "start": "952800",
    "end": "959680"
  },
  {
    "text": "in case the macros pawn underscore process evaluates to true",
    "start": "959680",
    "end": "965120"
  },
  {
    "text": "which means an exact vsc score was detected which in turn means a program has been executed",
    "start": "965120",
    "end": "972240"
  },
  {
    "text": "the name of the current process is one in the shell underscore products list so bash dash and so on the current",
    "start": "972240",
    "end": "980160"
  },
  {
    "text": "process as apparent one the name of the ancestor of the current process",
    "start": "980160",
    "end": "985600"
  },
  {
    "text": "is one of those listed by protected shell spawning binaries list",
    "start": "985600",
    "end": "990639"
  },
  {
    "text": "the first thing that catches my eye here is the spawned underscore process macro",
    "start": "990639",
    "end": "996959"
  },
  {
    "text": "that only checks for exact va event this cisco is part of the exact",
    "start": "996959",
    "end": "1002160"
  },
  {
    "text": "family it executes a program referred to by the path name given to it as the",
    "start": "1002160",
    "end": "1007600"
  },
  {
    "text": "first argument but exactly as siblings in this family let's see if we can circumvent this rule",
    "start": "1007600",
    "end": "1014880"
  },
  {
    "text": "by using a brother or sister of the exec via cisco are you ready",
    "start": "1014880",
    "end": "1022079"
  },
  {
    "text": "demo time so this is macro that got our interest it only checks for",
    "start": "1022079",
    "end": "1030000"
  },
  {
    "text": "exactly it's the first operand in the condition",
    "start": "1030000",
    "end": "1035600"
  },
  {
    "text": "of the run shell and trusted so the plan is simple we suspect that the process spawning a shell through exactly a hat remains",
    "start": "1035600",
    "end": "1042640"
  },
  {
    "text": "unnoticed by falco thinking deeply about this rule i have",
    "start": "1042640",
    "end": "1048400"
  },
  {
    "text": "also other ideas like changing the name of the process pointing a shell to one of the names treated",
    "start": "1048400",
    "end": "1053919"
  },
  {
    "text": "as exception by this rule or sim linking the shell to an unlisted name but i",
    "start": "1053919",
    "end": "1059600"
  },
  {
    "text": "leave this as exercises at all in this little demo we're gonna use the current development",
    "start": "1059600",
    "end": "1065600"
  },
  {
    "text": "release of falcon basically it's master branch from the tub in particular we have falco version",
    "start": "1065600",
    "end": "1072960"
  },
  {
    "text": "0261-43 43 comets ahead of the latest release driver version 2a8",
    "start": "1073000",
    "end": "1081840"
  },
  {
    "text": "let's check if we already have the kernel module inserted we have perfect falco can start",
    "start": "1082480",
    "end": "1091200"
  },
  {
    "text": "let's start falco with one of its default rule sets",
    "start": "1091200",
    "end": "1096559"
  },
  {
    "text": "and falco is here let's verify now the target rule works as intended",
    "start": "1096559",
    "end": "1102320"
  },
  {
    "text": "to do so we'll use the event generator project it's a nice go tool in the focal security organization that helps you",
    "start": "1102320",
    "end": "1108080"
  },
  {
    "text": "easily generate a variety of suspect actions detected by the default falco rule sets",
    "start": "1108080",
    "end": "1113840"
  },
  {
    "text": "i quickly change this comma to make the shelled spawns create a chow file inside the temp test directory",
    "start": "1113840",
    "end": "1121200"
  },
  {
    "text": "let's check the show file is here let's remove it",
    "start": "1121200",
    "end": "1128400"
  },
  {
    "text": "to make things more clear we can easily trigger this falco rule again ow",
    "start": "1128400",
    "end": "1135120"
  },
  {
    "text": "this way let's create a sim link to given the generator name httpd let's create a pizza file",
    "start": "1135120",
    "end": "1144960"
  },
  {
    "text": "which is a simple script that basically calls the event generator run shell",
    "start": "1144960",
    "end": "1151120"
  },
  {
    "text": "command let's make it executable",
    "start": "1151120",
    "end": "1156000"
  },
  {
    "text": "executing this script we just created focus should detect it anyway",
    "start": "1157360",
    "end": "1164960"
  },
  {
    "text": "in fact it does as you can see there are two alerts the one that we just triggered by",
    "start": "1164960",
    "end": "1171280"
  },
  {
    "text": "launching the pizza script and the previous one now what if we are",
    "start": "1171280",
    "end": "1176480"
  },
  {
    "text": "going to execute this through exactly at cisco my kernel",
    "start": "1176480",
    "end": "1181679"
  },
  {
    "text": "is this one so i have the exactly axis column disaster because it should be there since version",
    "start": "1181679",
    "end": "1189320"
  },
  {
    "text": "3.19 of the linux kernel it operates in same way as",
    "start": "1189320",
    "end": "1196880"
  },
  {
    "text": "exactly except for some differences in the handling of the path name",
    "start": "1196880",
    "end": "1202320"
  },
  {
    "text": "let's see if falco driver traces it already or not",
    "start": "1202320",
    "end": "1207840"
  },
  {
    "text": "oh as you can see it doesn't hello we have a very strong candidate for our",
    "start": "1210320",
    "end": "1215520"
  },
  {
    "text": "bypass i know you all were waiting for this this is time to write some",
    "start": "1215520",
    "end": "1221679"
  },
  {
    "text": "beautiful c code i'm joking i already written it let's just take a look at it",
    "start": "1221679",
    "end": "1229120"
  },
  {
    "text": "as you can see a bunch of enclosed as usual here i'm basically calling the exact via",
    "start": "1230320",
    "end": "1235919"
  },
  {
    "text": "c school telling it to execute tab test httpd with these two arguments",
    "start": "1235919",
    "end": "1244000"
  },
  {
    "text": "let's compile it okay let's execute it",
    "start": "1244000",
    "end": "1253919"
  },
  {
    "text": "who seems to have executed as you can see there is no rule launched",
    "start": "1254000",
    "end": "1260960"
  },
  {
    "text": "by farco but do we have the show file yes we have",
    "start": "1260960",
    "end": "1268320"
  },
  {
    "text": "so it worked but got and noticed by falco so we discovered together our ciscos are",
    "start": "1268320",
    "end": "1274400"
  },
  {
    "text": "the joy and torment at the same time for falco they are a very powerful mechanism that acts as the",
    "start": "1274400",
    "end": "1279679"
  },
  {
    "text": "kernel api that abstracts all the artwork for us falco magic is based upon them and will",
    "start": "1279679",
    "end": "1284799"
  },
  {
    "text": "not be possible otherwise but aside from the fact that tracing all the sea from a user space perspective often",
    "start": "1284799",
    "end": "1292080"
  },
  {
    "text": "is not that comfortable the issue the real issue is that there are a lot",
    "start": "1292080",
    "end": "1297679"
  },
  {
    "text": "of ciscos and with every kernel release they can change gain a new parameter new ciscos can be",
    "start": "1297679",
    "end": "1303440"
  },
  {
    "text": "introduced old ones got deprecated and things like that so it can be really really painful for us",
    "start": "1303440",
    "end": "1309360"
  },
  {
    "text": "as maintainers to keep on track for example we still miss the copy",
    "start": "1309360",
    "end": "1315600"
  },
  {
    "text": "file range cisco this can be used to bypass falco rules looking for sensitive fire renames",
    "start": "1315600",
    "end": "1322799"
  },
  {
    "text": "a malicious actor could use it to copy all the bytes of a sensitive file and falco will not be able to",
    "start": "1322799",
    "end": "1329280"
  },
  {
    "text": "detect it because it only looks for a name rene matt renamed two c schools",
    "start": "1329280",
    "end": "1334559"
  },
  {
    "text": "in the renamed macro also renamed two was missing until two months ago we had",
    "start": "1334559",
    "end": "1340320"
  },
  {
    "text": "the support for it in falco 025 so we're putting an effort to support more and more c-schools",
    "start": "1340320",
    "end": "1347280"
  },
  {
    "text": "before releasing falcod 1.0 especially the ones that could impact the detection",
    "start": "1347280",
    "end": "1352320"
  },
  {
    "text": "abilities of falco you can read more about it in the issue linked in the slide",
    "start": "1352320",
    "end": "1357679"
  },
  {
    "text": "we definitely need help from the community from you to cover as many c schools as",
    "start": "1357679",
    "end": "1363360"
  },
  {
    "text": "possible this is a wonderful opportunity to contribute to falco don't miss it i think it's useful now to quickly show",
    "start": "1363360",
    "end": "1370000"
  },
  {
    "text": "you how how to determine which schools are not supported yet by falco drivers otherwise you won't know where to start",
    "start": "1370000",
    "end": "1376880"
  },
  {
    "text": "right i provide you this little best script don't forget to clone this degree procedure where the falcon",
    "start": "1376880",
    "end": "1382559"
  },
  {
    "text": "drivers live since leaves gap still reside but expect to find them soon in the falco",
    "start": "1382559",
    "end": "1388720"
  },
  {
    "text": "security organization as you can see on the right falco 026 the one used in the previous demo",
    "start": "1388720",
    "end": "1394960"
  },
  {
    "text": "does support yet exactly at cisco has said needed support copy file range but it",
    "start": "1394960",
    "end": "1401840"
  },
  {
    "text": "supports rename at 2. then we surely should talk a bit",
    "start": "1401840",
    "end": "1406960"
  },
  {
    "text": "just a bit about the idea to extend falco to something more than cisco's yes there's more in the",
    "start": "1406960",
    "end": "1413600"
  },
  {
    "text": "linux kernel new very cool apis like io ring are landing the io ring is a new",
    "start": "1413600",
    "end": "1420080"
  },
  {
    "text": "asynchronous api with very very little hover ad that times to overcome the limitations",
    "start": "1420080",
    "end": "1425120"
  },
  {
    "text": "of the current select paul e paul or aio family of system",
    "start": "1425120",
    "end": "1430400"
  },
  {
    "text": "codes but i suppose this is a topic for a next tool right i imagine it's way more useful now to",
    "start": "1430400",
    "end": "1437600"
  },
  {
    "text": "show you how to add support for a new cisco right when you hit the manual page for name",
    "start": "1437600",
    "end": "1442880"
  },
  {
    "text": "syscalls you got no surprises in fact as name suggests they allow us",
    "start": "1442880",
    "end": "1448080"
  },
  {
    "text": "to rename a file moving it between directories in this family we also have the rename",
    "start": "1448080",
    "end": "1453200"
  },
  {
    "text": "add and rename at two ciscos the rename at cisco operates in exactly the same way",
    "start": "1453200",
    "end": "1458960"
  },
  {
    "text": "as renamed as except for some differences in how the file paths the old ones and the new ones",
    "start": "1458960",
    "end": "1464720"
  },
  {
    "text": "are handled the rename map to cisco is equivalent to during math it only has an",
    "start": "1464720",
    "end": "1470799"
  },
  {
    "text": "additional flags argument used to specify whether the name should be atomic or not",
    "start": "1470799",
    "end": "1476000"
  },
  {
    "text": "whether you want to allow the override of a file and so on let's briefly take a look at how support",
    "start": "1476000",
    "end": "1483200"
  },
  {
    "text": "for renemachu was added in pull request 1654 so that maybe",
    "start": "1483200",
    "end": "1489440"
  },
  {
    "text": "you can easily contribute your additions to let's look at how we added support for",
    "start": "1489440",
    "end": "1494640"
  },
  {
    "text": "the cisco rene mac 2 the first thing to do is modifying the dryer's ppm events public heater",
    "start": "1494640",
    "end": "1501760"
  },
  {
    "text": "by adding constants to the ppm event type in a table for the entry and exit fillers of the",
    "start": "1501760",
    "end": "1507520"
  },
  {
    "text": "renamer to cisco and adding an item for the relay match",
    "start": "1507520",
    "end": "1512880"
  },
  {
    "text": "to school to the ppm cisco code inum table here we also need to define their name",
    "start": "1512880",
    "end": "1519760"
  },
  {
    "text": "at two flags and the struct for holding them now we can populate in the flags table c",
    "start": "1519760",
    "end": "1527039"
  },
  {
    "text": "file destruct while in the cisco info table c file inside",
    "start": "1527039",
    "end": "1535120"
  },
  {
    "text": "libs gap we need to instruct libscop about those flags",
    "start": "1535120",
    "end": "1540960"
  },
  {
    "text": "and don't forget to increment the number of supported c schools",
    "start": "1540960",
    "end": "1546158"
  },
  {
    "text": "at this point in the driver filler stable c file we need to match the filler constants",
    "start": "1547600",
    "end": "1556480"
  },
  {
    "text": "with their actual implementations so that falco drivers know which code to execute at the entry",
    "start": "1556480",
    "end": "1562480"
  },
  {
    "text": "and the exit when the target syscall is detected we also need to represent the name up to",
    "start": "1562480",
    "end": "1569360"
  },
  {
    "text": "cisco into the driver even table c5 now by editing the g event info array",
    "start": "1569360",
    "end": "1577760"
  },
  {
    "text": "adding to it two items one for the entrance of the c school and one for the exit",
    "start": "1577760",
    "end": "1584080"
  },
  {
    "text": "each line should represent the signature of the cisco we are adding so its arguments and its return value",
    "start": "1584080",
    "end": "1591520"
  },
  {
    "text": "for example here we are telling the falco driver to look for their name at two flags",
    "start": "1591520",
    "end": "1597039"
  },
  {
    "text": "tracked instance we declared before when it looks for the renamer to flags",
    "start": "1597039",
    "end": "1602960"
  },
  {
    "text": "bitmask argument now go into the cisco table c file",
    "start": "1602960",
    "end": "1609440"
  },
  {
    "text": "and edit the reference table for 32 and 64 bit architectures first add the name at",
    "start": "1609440",
    "end": "1616480"
  },
  {
    "text": "2 item to the cisco table populating its value with references",
    "start": "1616480",
    "end": "1622480"
  },
  {
    "text": "to the syscall entry and exit fillers then we also need to edit the",
    "start": "1622480",
    "end": "1629520"
  },
  {
    "text": "cisco code routing table adding an item for renamer to cisco and pointing it to the cisco code",
    "start": "1629520",
    "end": "1637360"
  },
  {
    "text": "we are seeing to it last but not least we need to define our",
    "start": "1637360",
    "end": "1642880"
  },
  {
    "text": "fillers buff for the 4kb pf driver and for the kernel module 1. for brady we're going to look only at",
    "start": "1642880",
    "end": "1649360"
  },
  {
    "text": "the filler for the camera module the one for the bpf drive is very very similar just uses some different apis for",
    "start": "1649360",
    "end": "1656320"
  },
  {
    "text": "collecting the data and pushing them to the user space in this case we only",
    "start": "1656320",
    "end": "1662080"
  },
  {
    "text": "define the exit filter because we grab the rename to parameters only when it completes",
    "start": "1662080",
    "end": "1668080"
  },
  {
    "text": "as you can see here we get the value of all the for the old path new d file descriptor",
    "start": "1668080",
    "end": "1674000"
  },
  {
    "text": "new path and flags and we put them into the ring buffer with val touring",
    "start": "1674000",
    "end": "1679440"
  },
  {
    "text": "method so populating a new event that falco will use to detect renames made with renamed to cisco",
    "start": "1679440",
    "end": "1687360"
  },
  {
    "text": "at this point we're done but good luck with the compilation now in the falco default rule set we",
    "start": "1687360",
    "end": "1694080"
  },
  {
    "text": "also ship this rule in the slide to let you detect when someone is using the package manager",
    "start": "1694080",
    "end": "1699279"
  },
  {
    "text": "inside your containerized environments it's very simple it fires when a process is spawned inside your container",
    "start": "1699279",
    "end": "1706320"
  },
  {
    "text": "and its name is one in the list you can see on the left so apt-get rpt apk and so on",
    "start": "1706320",
    "end": "1713760"
  },
  {
    "text": "let's bypass it now this time we'll not use unsupported ciscos rather something way simpler",
    "start": "1713760",
    "end": "1721679"
  },
  {
    "text": "so this is the falco rule that triggers when someone is launching a package manager",
    "start": "1721679",
    "end": "1727039"
  },
  {
    "text": "inside your containers as you can see there's the spawn process macro but this time we'll target",
    "start": "1727039",
    "end": "1734240"
  },
  {
    "text": "the package management prox macro that monitors if the process name is one",
    "start": "1734240",
    "end": "1742559"
  },
  {
    "text": "of the element in the package management binaries list",
    "start": "1742559",
    "end": "1747440"
  },
  {
    "text": "so start again falco and gave some space to the standard output where by default it emits",
    "start": "1748399",
    "end": "1754880"
  },
  {
    "text": "alerts when we run an ubuntu container spawning a shell into it",
    "start": "1754880",
    "end": "1762159"
  },
  {
    "text": "falco detects it but when we run apt update you can see falco promptly",
    "start": "1762159",
    "end": "1769840"
  },
  {
    "text": "emitting the alert of the role we're targeting let's exit from this container",
    "start": "1769840",
    "end": "1776240"
  },
  {
    "text": "since we know alpine is the most used basic image in the world let's try with an alpine",
    "start": "1778799",
    "end": "1785760"
  },
  {
    "text": "we know that the package management macro checks whether the process name is equal to apk in this case let's",
    "start": "1788559",
    "end": "1795919"
  },
  {
    "text": "simply try to create a sim link named people to it",
    "start": "1795919",
    "end": "1800960"
  },
  {
    "text": "if we run pip update we see that falco do not detect we're launching a",
    "start": "1805279",
    "end": "1811919"
  },
  {
    "text": "package management process in this container just because we called it people",
    "start": "1811919",
    "end": "1817760"
  },
  {
    "text": "anyway if we actually install something",
    "start": "1817760",
    "end": "1823840"
  },
  {
    "text": "falco alerts us that someone somehow modified a file below a binary directory",
    "start": "1825039",
    "end": "1831760"
  },
  {
    "text": "but it does not tell us that someone used the package management",
    "start": "1831760",
    "end": "1838240"
  },
  {
    "text": "tool of alpine in my opinion the role we targeted as flows and it should be more precise",
    "start": "1838240",
    "end": "1846480"
  },
  {
    "text": "as we've just seen maybe we need to make falco rules also monitor the sim links",
    "start": "1846480",
    "end": "1852320"
  },
  {
    "text": "we're thinking to build something inside it that automatically does it this way we don't have to edit all the",
    "start": "1852320",
    "end": "1858000"
  },
  {
    "text": "rules and we don't have to remember to also monitor the sim link every time a rule looks for a binary or",
    "start": "1858000",
    "end": "1863360"
  },
  {
    "text": "a file etc but we need to make a bigger conversation and we'd love your feedback too so",
    "start": "1863360",
    "end": "1869600"
  },
  {
    "text": "please join the falco community codes we proved that falcalone is not enough",
    "start": "1869600",
    "end": "1874960"
  },
  {
    "text": "but this is something we all already knew furthermore its rule set or the one you using can be",
    "start": "1874960",
    "end": "1882080"
  },
  {
    "text": "incomplete or ineffective there's a huge interconnection between different rules maybe",
    "start": "1882080",
    "end": "1887440"
  },
  {
    "text": "you bypass the one detecting the usage of package managers in containers as they just did but then the one",
    "start": "1887440",
    "end": "1894159"
  },
  {
    "text": "monitoring binaries directories alerts you so think about it when you disable a rule",
    "start": "1894159",
    "end": "1899760"
  },
  {
    "text": "maybe you don't need it directly for your use case but that rule at least notifies you when someone",
    "start": "1899760",
    "end": "1905760"
  },
  {
    "text": "broke the rule monitoring your use case for example a rule that detects the execution of a specific",
    "start": "1905760",
    "end": "1911679"
  },
  {
    "text": "banner is okay alone only if it also monitors the copy the sim link and the rename of that file even the",
    "start": "1911679",
    "end": "1917840"
  },
  {
    "text": "open cisco because someone could think to cut that binary into another file even more",
    "start": "1917840",
    "end": "1924080"
  },
  {
    "text": "a very malicious actor could pipe from the outside a base64 encoded binary and",
    "start": "1924080",
    "end": "1929279"
  },
  {
    "text": "regulate it line by line inside the container and how to monitor batch scripts",
    "start": "1929279",
    "end": "1934880"
  },
  {
    "text": "with dersha banks better prevent too in that case like removing bash from the container",
    "start": "1934880",
    "end": "1940960"
  },
  {
    "text": "reducing the attack surface by creating the container image from scratch not from alpine even if we love it then",
    "start": "1940960",
    "end": "1947120"
  },
  {
    "text": "put inside them the read-only binary that has to act as the entry point of the container make only one specific path writable",
    "start": "1947120",
    "end": "1955039"
  },
  {
    "text": "and also restrict it to contain non-executable files with flag netseq finally you can create a falcon rule",
    "start": "1955039",
    "end": "1961279"
  },
  {
    "text": "that monitors the only binary executing in that container is the entry point you",
    "start": "1961279",
    "end": "1966480"
  },
  {
    "text": "intended this way you should have reduced a lot the odds of an attacker now another little bypass demo very",
    "start": "1966480",
    "end": "1973840"
  },
  {
    "text": "different from the others we've just seen it's last one i promise",
    "start": "1973840",
    "end": "1979200"
  },
  {
    "text": "for this demo we don't mind selecting a particular falco rule since we're ambitious and we intend to",
    "start": "1979200",
    "end": "1985279"
  },
  {
    "text": "be able to bypass all of them anyways for the sake of this demo we're",
    "start": "1985279",
    "end": "1991840"
  },
  {
    "text": "gonna select this rule it detects when something runs with the privileges of the owning user or group",
    "start": "1991840",
    "end": "1998240"
  },
  {
    "text": "which means it has a set with your set gd bits set i'm not using falco built from",
    "start": "1998240",
    "end": "2005039"
  },
  {
    "text": "source this time rather i already installed the falcon from its deb repositories",
    "start": "2005039",
    "end": "2011039"
  },
  {
    "text": "on bin tray let's now trigger the rule i create a leo file in",
    "start": "2011039",
    "end": "2017840"
  },
  {
    "text": "the temp directory i start falco and then i set the group",
    "start": "2017840",
    "end": "2023760"
  },
  {
    "text": "id on temp leo5 as you can see falco alerts us maybe you don't know but",
    "start": "2023760",
    "end": "2031600"
  },
  {
    "text": "when falco get installed it puts the default yaml rule sets in the atc directory but also",
    "start": "2031600",
    "end": "2038559"
  },
  {
    "text": "it puts some very important lua files inside user share falco lua",
    "start": "2038559",
    "end": "2047840"
  },
  {
    "text": "the output.lua file should catch our tension let's edit it",
    "start": "2048800",
    "end": "2061839"
  },
  {
    "text": "we commend this line which is the gate from which the output methods of falco pass through",
    "start": "2062000",
    "end": "2069520"
  },
  {
    "text": "save the file and exit if falcon for some reasons restarts",
    "start": "2069520",
    "end": "2076398"
  },
  {
    "text": "it will not send any more any output to us",
    "start": "2076399",
    "end": "2082960"
  },
  {
    "text": "look no output i know to bring on this attack",
    "start": "2082960",
    "end": "2091200"
  },
  {
    "text": "the malicious user should already have a lot of privileges on the target task it should already be able to manually",
    "start": "2091200",
    "end": "2097920"
  },
  {
    "text": "kill the falco process for example but that's not the point the point is that it's way more likely that malicious",
    "start": "2097920",
    "end": "2104240"
  },
  {
    "text": "attacker will do more selective things in the output lua files that we",
    "start": "2104240",
    "end": "2109359"
  },
  {
    "text": "edited like excluding only some rule alerts or even modifying the output messages",
    "start": "2109359",
    "end": "2116079"
  },
  {
    "text": "this way your attention will not be drawn because you'll probably continue to think falco is still",
    "start": "2116079",
    "end": "2122240"
  },
  {
    "text": "operating perfectly as intended and anyways focus should at least",
    "start": "2122240",
    "end": "2127440"
  },
  {
    "text": "alert us it has been restarted from who and how don't you think so how to solve the",
    "start": "2127440",
    "end": "2133440"
  },
  {
    "text": "problem of blue outputs we already did it no worries we have wrote the complete outputs module of falco inc",
    "start": "2133440",
    "end": "2140960"
  },
  {
    "text": "plus starting with the next release of falco the gate of the outputs will be built inside the falcon binary",
    "start": "2140960",
    "end": "2147280"
  },
  {
    "text": "we plan to also write the parser and the engine completely in c plus this will enable us to reduce the",
    "start": "2147280",
    "end": "2154800"
  },
  {
    "text": "dependency surface of falco removing lua related dependencies too so stay in touch and in case you want to",
    "start": "2154800",
    "end": "2161200"
  },
  {
    "text": "take a look at how we did it i put a link to the pull request in the slide as usual so thanks anyone for",
    "start": "2161200",
    "end": "2166560"
  },
  {
    "text": "being here this talk was really tough even to prepare and to listen admit but i hope you enjoyed my approach my",
    "start": "2166560",
    "end": "2173280"
  },
  {
    "text": "findings and my considerations see you soon let's hope in person in the meantime follow me on twitter join the",
    "start": "2173280",
    "end": "2179440"
  },
  {
    "text": "falco calls and let's keep in touch",
    "start": "2179440",
    "end": "2184160"
  }
]