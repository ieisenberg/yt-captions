[
  {
    "text": "all right hello welcome everyone um so",
    "start": "320",
    "end": "2840"
  },
  {
    "text": "one of the principles that we've had uh",
    "start": "2840",
    "end": "4640"
  },
  {
    "text": "in celum since kind of the beginning is",
    "start": "4640",
    "end": "7120"
  },
  {
    "text": "this idea that if we're to build the the",
    "start": "7120",
    "end": "8880"
  },
  {
    "text": "networking from scratch for kubernetes",
    "start": "8880",
    "end": "11280"
  },
  {
    "text": "how are we going to do that to to make",
    "start": "11280",
    "end": "12639"
  },
  {
    "text": "it as efficient as possible uh and BPF",
    "start": "12639",
    "end": "15360"
  },
  {
    "text": "is really a key part of this because it",
    "start": "15360",
    "end": "16880"
  },
  {
    "text": "allows us to extend that flexibility all",
    "start": "16880",
    "end": "19279"
  },
  {
    "text": "the way down into the kernel so we can",
    "start": "19279",
    "end": "21039"
  },
  {
    "text": "look at holistically at the entire sort",
    "start": "21039",
    "end": "23119"
  },
  {
    "text": "of networking implementation and figure",
    "start": "23119",
    "end": "24760"
  },
  {
    "text": "out uh you know how should we Implement",
    "start": "24760",
    "end": "27119"
  },
  {
    "text": "each networking piece to efficiently",
    "start": "27119",
    "end": "29240"
  },
  {
    "text": "handle events that happening within the",
    "start": "29240",
    "end": "30920"
  },
  {
    "text": "system and so today we're going to talk",
    "start": "30920",
    "end": "32880"
  },
  {
    "text": "about Network policy uh and we're going",
    "start": "32880",
    "end": "36280"
  },
  {
    "text": "to focus particularly on this idea of",
    "start": "36280",
    "end": "37879"
  },
  {
    "text": "like scalable",
    "start": "37879",
    "end": "39640"
  },
  {
    "text": "enforcement so when I talk about",
    "start": "39640",
    "end": "41600"
  },
  {
    "text": "scalability I'm talking about like doing",
    "start": "41600",
    "end": "43760"
  },
  {
    "text": "as little as possible each time",
    "start": "43760",
    "end": "45680"
  },
  {
    "text": "something happens within the system and",
    "start": "45680",
    "end": "47800"
  },
  {
    "text": "so there are different ways you can kind",
    "start": "47800",
    "end": "49320"
  },
  {
    "text": "of optimize this so you can reduce the",
    "start": "49320",
    "end": "51160"
  },
  {
    "text": "number of events in the system and that",
    "start": "51160",
    "end": "52719"
  },
  {
    "text": "that's certainly one Focus area uh of",
    "start": "52719",
    "end": "55320"
  },
  {
    "text": "the project at the same time you are",
    "start": "55320",
    "end": "58039"
  },
  {
    "text": "still going to have a certain number of",
    "start": "58039",
    "end": "59320"
  },
  {
    "text": "events and so for each of those events",
    "start": "59320",
    "end": "61079"
  },
  {
    "text": "that are happening in the system uh you",
    "start": "61079",
    "end": "63039"
  },
  {
    "text": "need to be able to minimize the amount",
    "start": "63039",
    "end": "64439"
  },
  {
    "text": "of work that that you're doing uh in",
    "start": "64439",
    "end": "66200"
  },
  {
    "text": "order to implement an efficient data",
    "start": "66200",
    "end": "68040"
  },
  {
    "text": "plan and of course in the context of",
    "start": "68040",
    "end": "70040"
  },
  {
    "text": "network policy uh we need to actually",
    "start": "70040",
    "end": "72320"
  },
  {
    "text": "enforce that policy so the the user has",
    "start": "72320",
    "end": "74320"
  },
  {
    "text": "a certain intent about who should be",
    "start": "74320",
    "end": "76280"
  },
  {
    "text": "able to talk to who uh and we need to",
    "start": "76280",
    "end": "78200"
  },
  {
    "text": "carry out those instructions to to have",
    "start": "78200",
    "end": "79759"
  },
  {
    "text": "a secure",
    "start": "79759",
    "end": "82520"
  },
  {
    "text": "implementation so when we look at a",
    "start": "82720",
    "end": "84799"
  },
  {
    "text": "particular cluster we have various",
    "start": "84799",
    "end": "86119"
  },
  {
    "text": "different events that are happening in",
    "start": "86119",
    "end": "87240"
  },
  {
    "text": "that cluster um so there may be control",
    "start": "87240",
    "end": "89600"
  },
  {
    "text": "plane events um so things like State",
    "start": "89600",
    "end": "92720"
  },
  {
    "text": "distribution between the different nodes",
    "start": "92720",
    "end": "94399"
  },
  {
    "text": "between kubernetes AP API server",
    "start": "94399",
    "end": "97920"
  },
  {
    "text": "individual nodes uh and of course this",
    "start": "97920",
    "end": "100040"
  },
  {
    "text": "is scaling you know we're thinking about",
    "start": "100040",
    "end": "101799"
  },
  {
    "text": "hundreds of clusters you know thousands",
    "start": "101799",
    "end": "103840"
  },
  {
    "text": "of nodes perhaps tens or or hundreds of",
    "start": "103840",
    "end": "105719"
  },
  {
    "text": "thousands of workloads um and so",
    "start": "105719",
    "end": "107880"
  },
  {
    "text": "minimizing the amount of work that we're",
    "start": "107880",
    "end": "109280"
  },
  {
    "text": "doing uh in order to handle the network",
    "start": "109280",
    "end": "112439"
  },
  {
    "text": "policy implementation across that sort",
    "start": "112439",
    "end": "113880"
  },
  {
    "text": "of scale uh and then from an individual",
    "start": "113880",
    "end": "116880"
  },
  {
    "text": "node perspective you know as you scale",
    "start": "116880",
    "end": "118640"
  },
  {
    "text": "those workloads uh those workloads are",
    "start": "118640",
    "end": "121079"
  },
  {
    "text": "talking to one another and so if we",
    "start": "121079",
    "end": "123360"
  },
  {
    "text": "think about data plane events we've got",
    "start": "123360",
    "end": "125079"
  },
  {
    "text": "perhaps millions of packets per second",
    "start": "125079",
    "end": "126960"
  },
  {
    "text": "that are running through the system and",
    "start": "126960",
    "end": "128920"
  },
  {
    "text": "so at that level of scale like how are",
    "start": "128920",
    "end": "130640"
  },
  {
    "text": "we minimizing the amount of work that we",
    "start": "130640",
    "end": "132280"
  },
  {
    "text": "do to still scalably uh enforce the",
    "start": "132280",
    "end": "135920"
  },
  {
    "text": "policy and so as I mentioned there there",
    "start": "135920",
    "end": "138040"
  },
  {
    "text": "are different areas of focus that you",
    "start": "138040",
    "end": "139440"
  },
  {
    "text": "can do to optimize how this is going to",
    "start": "139440",
    "end": "141959"
  },
  {
    "text": "be the most efficient uh implementation",
    "start": "141959",
    "end": "144480"
  },
  {
    "text": "that that you can do um today we're",
    "start": "144480",
    "end": "146840"
  },
  {
    "text": "going to focus particularly on",
    "start": "146840",
    "end": "148519"
  },
  {
    "text": "individual node perspective um and so",
    "start": "148519",
    "end": "151920"
  },
  {
    "text": "that's influenced partly by the control",
    "start": "151920",
    "end": "153519"
  },
  {
    "text": "plane events that are happening in the",
    "start": "153519",
    "end": "155000"
  },
  {
    "text": "system um but then it's also uh you know",
    "start": "155000",
    "end": "158360"
  },
  {
    "text": "matters how the the data plane events",
    "start": "158360",
    "end": "160159"
  },
  {
    "text": "are being handled by",
    "start": "160159",
    "end": "162239"
  },
  {
    "text": "celium so we're going to focus on three",
    "start": "162239",
    "end": "164560"
  },
  {
    "text": "areas uh today uh so first we're going",
    "start": "164560",
    "end": "167000"
  },
  {
    "text": "to talk about how we apply the policy",
    "start": "167000",
    "end": "168680"
  },
  {
    "text": "efficiently so we're talking about",
    "start": "168680",
    "end": "170239"
  },
  {
    "text": "taking like a user facing high level",
    "start": "170239",
    "end": "172840"
  },
  {
    "text": "policy human readable and converting",
    "start": "172840",
    "end": "174840"
  },
  {
    "text": "that into a machine friendly uh",
    "start": "174840",
    "end": "176560"
  },
  {
    "text": "implementation in BPF that that can then",
    "start": "176560",
    "end": "178840"
  },
  {
    "text": "Implement that policy",
    "start": "178840",
    "end": "180959"
  },
  {
    "text": "secondly we'll talk about how we're",
    "start": "180959",
    "end": "182400"
  },
  {
    "text": "efficiently enforcing that policy so as",
    "start": "182400",
    "end": "185640"
  },
  {
    "text": "packets come into the system what are we",
    "start": "185640",
    "end": "187480"
  },
  {
    "text": "doing to be able to uh enforce that",
    "start": "187480",
    "end": "189440"
  },
  {
    "text": "Network policy at the data plane",
    "start": "189440",
    "end": "192080"
  },
  {
    "text": "level and finally an important part of",
    "start": "192080",
    "end": "194480"
  },
  {
    "text": "scale is how you have the tooling to be",
    "start": "194480",
    "end": "196599"
  },
  {
    "text": "able to understand what happens when",
    "start": "196599",
    "end": "198280"
  },
  {
    "text": "something goes wrong so we'll talk a bit",
    "start": "198280",
    "end": "200000"
  },
  {
    "text": "about about the uh debuggability tools",
    "start": "200000",
    "end": "202159"
  },
  {
    "text": "that are available in the system so with",
    "start": "202159",
    "end": "204440"
  },
  {
    "text": "that I'll hand over to who can talk",
    "start": "204440",
    "end": "207080"
  },
  {
    "text": "about applying policy efficiently",
    "start": "207080",
    "end": "211760"
  },
  {
    "text": "uh thanks CH so if you want to enforce",
    "start": "212439",
    "end": "216080"
  },
  {
    "text": "Network policy with celum our users",
    "start": "216080",
    "end": "218280"
  },
  {
    "text": "currently have two major options so you",
    "start": "218280",
    "end": "220560"
  },
  {
    "text": "can either write Network policy with",
    "start": "220560",
    "end": "222599"
  },
  {
    "text": "kubernetes network policies or celium",
    "start": "222599",
    "end": "224959"
  },
  {
    "text": "network policies so if you've ever",
    "start": "224959",
    "end": "227519"
  },
  {
    "text": "written a celium network policy some of",
    "start": "227519",
    "end": "229959"
  },
  {
    "text": "this might look familiar to you but",
    "start": "229959",
    "end": "232560"
  },
  {
    "text": "primarily the celium network policy has",
    "start": "232560",
    "end": "234840"
  },
  {
    "text": "three major components there's the",
    "start": "234840",
    "end": "236959"
  },
  {
    "text": "subject workload that allows users to",
    "start": "236959",
    "end": "239159"
  },
  {
    "text": "Define which workloads this network",
    "start": "239159",
    "end": "242200"
  },
  {
    "text": "policy should select and then there's",
    "start": "242200",
    "end": "244120"
  },
  {
    "text": "the target part which allows users to",
    "start": "244120",
    "end": "246239"
  },
  {
    "text": "specify in the selected workloads which",
    "start": "246239",
    "end": "249159"
  },
  {
    "text": "traffic related to that workload should",
    "start": "249159",
    "end": "251840"
  },
  {
    "text": "this network policy be enforced on and",
    "start": "251840",
    "end": "255000"
  },
  {
    "text": "finally the action part which allows",
    "start": "255000",
    "end": "257479"
  },
  {
    "text": "users to specify what should celium do",
    "start": "257479",
    "end": "260880"
  },
  {
    "text": "with the traffic that was selected by",
    "start": "260880",
    "end": "262440"
  },
  {
    "text": "this",
    "start": "262440",
    "end": "263440"
  },
  {
    "text": "policy so before we understand how this",
    "start": "263440",
    "end": "266440"
  },
  {
    "text": "policy is actually implemented we need",
    "start": "266440",
    "end": "268479"
  },
  {
    "text": "to understand Cam's identity based",
    "start": "268479",
    "end": "271039"
  },
  {
    "text": "security model so what this really means",
    "start": "271039",
    "end": "273560"
  },
  {
    "text": "is it allows users to express Network",
    "start": "273560",
    "end": "275960"
  },
  {
    "text": "policy in terms of who is allowed to",
    "start": "275960",
    "end": "279320"
  },
  {
    "text": "talk to whom instead of having to worry",
    "start": "279320",
    "end": "281479"
  },
  {
    "text": "about where a workload is deployed on or",
    "start": "281479",
    "end": "284280"
  },
  {
    "text": "what IP addresses are associated with it",
    "start": "284280",
    "end": "287120"
  },
  {
    "text": "so in this example I have three entities",
    "start": "287120",
    "end": "289520"
  },
  {
    "text": "that are ti fighter dead star and X-Wing",
    "start": "289520",
    "end": "292479"
  },
  {
    "text": "pods and these are deployed in",
    "start": "292479",
    "end": "294600"
  },
  {
    "text": "kubernetes as",
    "start": "294600",
    "end": "296440"
  },
  {
    "text": "parts and in kubernetes every work with",
    "start": "296440",
    "end": "300199"
  },
  {
    "text": "a unique set of label gets its own",
    "start": "300199",
    "end": "302240"
  },
  {
    "text": "security",
    "start": "302240",
    "end": "303320"
  },
  {
    "text": "identity and because it's a lot more",
    "start": "303320",
    "end": "305560"
  },
  {
    "text": "efficient to store and compare numbers",
    "start": "305560",
    "end": "309080"
  },
  {
    "text": "every security identity gets its own",
    "start": "309080",
    "end": "311960"
  },
  {
    "text": "integer integer",
    "start": "311960",
    "end": "313960"
  },
  {
    "text": "ID",
    "start": "313960",
    "end": "315800"
  },
  {
    "text": "so this is a really powerful concept",
    "start": "315800",
    "end": "318759"
  },
  {
    "text": "because it allows us to represent um",
    "start": "318759",
    "end": "321800"
  },
  {
    "text": "Network policy it allows us to have a a",
    "start": "321800",
    "end": "324759"
  },
  {
    "text": "network policy representation in the",
    "start": "324759",
    "end": "327080"
  },
  {
    "text": "kernel that does not get impacted by CH",
    "start": "327080",
    "end": "330520"
  },
  {
    "text": "so your pods can come and go but our",
    "start": "330520",
    "end": "332639"
  },
  {
    "text": "identity allocated for each of these",
    "start": "332639",
    "end": "334360"
  },
  {
    "text": "entity does not really",
    "start": "334360",
    "end": "337719"
  },
  {
    "text": "change so our goal for this section is",
    "start": "337800",
    "end": "341080"
  },
  {
    "text": "to understand how the network policy",
    "start": "341080",
    "end": "343160"
  },
  {
    "text": "that is defined by our users in terms of",
    "start": "343160",
    "end": "345240"
  },
  {
    "text": "crds is converted into an identity based",
    "start": "345240",
    "end": "348240"
  },
  {
    "text": "allow list in the kernel which will be",
    "start": "348240",
    "end": "350400"
  },
  {
    "text": "used to enforce Network",
    "start": "350400",
    "end": "353440"
  },
  {
    "text": "policy so every celum asion that is",
    "start": "353440",
    "end": "356639"
  },
  {
    "text": "running in the cluster registers a",
    "start": "356639",
    "end": "358479"
  },
  {
    "text": "watcher with the kuet control plane to",
    "start": "358479",
    "end": "360800"
  },
  {
    "text": "get updates on celum network policy or",
    "start": "360800",
    "end": "363280"
  },
  {
    "text": "network policy",
    "start": "363280",
    "end": "365080"
  },
  {
    "text": "objects so every time a user creates a",
    "start": "365080",
    "end": "367680"
  },
  {
    "text": "network policy object these updates are",
    "start": "367680",
    "end": "369840"
  },
  {
    "text": "sent to every single node in the cluster",
    "start": "369840",
    "end": "372280"
  },
  {
    "text": "it might sound a little counterintuitive",
    "start": "372280",
    "end": "374160"
  },
  {
    "text": "to send or broadcast updates to every",
    "start": "374160",
    "end": "376160"
  },
  {
    "text": "single node but it's important that we",
    "start": "376160",
    "end": "378440"
  },
  {
    "text": "have all the latest policy that is",
    "start": "378440",
    "end": "380080"
  },
  {
    "text": "defined in the cluster already available",
    "start": "380080",
    "end": "382199"
  },
  {
    "text": "on the Node so that when a part is",
    "start": "382199",
    "end": "384039"
  },
  {
    "text": "scheduled onto that node we can enforce",
    "start": "384039",
    "end": "386560"
  },
  {
    "text": "the time required to enforce that policy",
    "start": "386560",
    "end": "388800"
  },
  {
    "text": "as as minimum as",
    "start": "388800",
    "end": "391120"
  },
  {
    "text": "possible so when the agent receives an",
    "start": "391120",
    "end": "393520"
  },
  {
    "text": "update whether it's from celium Network",
    "start": "393520",
    "end": "395680"
  },
  {
    "text": "policy or kubernetes network policy the",
    "start": "395680",
    "end": "398039"
  },
  {
    "text": "first thing that the agent does is",
    "start": "398039",
    "end": "399680"
  },
  {
    "text": "convert that into a standardized",
    "start": "399680",
    "end": "401360"
  },
  {
    "text": "internal representation and store that",
    "start": "401360",
    "end": "403639"
  },
  {
    "text": "in the policy repository so the",
    "start": "403639",
    "end": "405560"
  },
  {
    "text": "implementation detail um soam actually",
    "start": "405560",
    "end": "408240"
  },
  {
    "text": "implements both the policies in the same",
    "start": "408240",
    "end": "411440"
  },
  {
    "text": "way so if you take a look at a naive",
    "start": "411440",
    "end": "414160"
  },
  {
    "text": "algorithm on how a policy computation",
    "start": "414160",
    "end": "416639"
  },
  {
    "text": "algorithm might look like for every",
    "start": "416639",
    "end": "419639"
  },
  {
    "text": "policy that is known in the repository",
    "start": "419639",
    "end": "421639"
  },
  {
    "text": "and for every endpoint that's running in",
    "start": "421639",
    "end": "423440"
  },
  {
    "text": "the node for each and every Pro Port",
    "start": "423440",
    "end": "426240"
  },
  {
    "text": "protocol and Direction combination and",
    "start": "426240",
    "end": "428319"
  },
  {
    "text": "for every security Target you might want",
    "start": "428319",
    "end": "430720"
  },
  {
    "text": "to allow traffic to you need to have an",
    "start": "430720",
    "end": "432960"
  },
  {
    "text": "entry in a BPF",
    "start": "432960",
    "end": "434840"
  },
  {
    "text": "map to illustrate how um how much volume",
    "start": "434840",
    "end": "439080"
  },
  {
    "text": "this can generate our users today might",
    "start": "439080",
    "end": "442000"
  },
  {
    "text": "be writing thousands of clusters",
    "start": "442000",
    "end": "443960"
  },
  {
    "text": "thousands of policies in a cluster and",
    "start": "443960",
    "end": "446919"
  },
  {
    "text": "every single node might have hundreds of",
    "start": "446919",
    "end": "449080"
  },
  {
    "text": "parts running on them and you might want",
    "start": "449080",
    "end": "451560"
  },
  {
    "text": "to allow traffic to tens of thousands of",
    "start": "451560",
    "end": "454440"
  },
  {
    "text": "security identities depending on how",
    "start": "454440",
    "end": "456879"
  },
  {
    "text": "many how many workloads are running in",
    "start": "456879",
    "end": "459160"
  },
  {
    "text": "this cluster or how many clusters are",
    "start": "459160",
    "end": "461720"
  },
  {
    "text": "meshed",
    "start": "461720",
    "end": "463199"
  },
  {
    "text": "together so you can see here that uh",
    "start": "463199",
    "end": "466479"
  },
  {
    "text": "very easily you might have hundreds of",
    "start": "466479",
    "end": "468479"
  },
  {
    "text": "thousands of uh BPF map entry updates",
    "start": "468479",
    "end": "471400"
  },
  {
    "text": "that need to happen on every policy",
    "start": "471400",
    "end": "473199"
  },
  {
    "text": "iteration",
    "start": "473199",
    "end": "474840"
  },
  {
    "text": "Loop so how can we do better here maybe",
    "start": "474840",
    "end": "478639"
  },
  {
    "text": "we don't have to proc every single",
    "start": "478639",
    "end": "480319"
  },
  {
    "text": "policy update event we can be smart",
    "start": "480319",
    "end": "482319"
  },
  {
    "text": "about it or maybe we can cash and reuse",
    "start": "482319",
    "end": "484960"
  },
  {
    "text": "all the intermediate computed State and",
    "start": "484960",
    "end": "487919"
  },
  {
    "text": "maybe we can employ some efficient data",
    "start": "487919",
    "end": "489599"
  },
  {
    "text": "structures to do fast lookup and",
    "start": "489599",
    "end": "491599"
  },
  {
    "text": "efficient",
    "start": "491599",
    "end": "493400"
  },
  {
    "text": "computation so let's look at a few",
    "start": "493400",
    "end": "495720"
  },
  {
    "text": "common scenarios that the agent",
    "start": "495720",
    "end": "497319"
  },
  {
    "text": "generally has to deal with and we'll",
    "start": "497319",
    "end": "499479"
  },
  {
    "text": "walk through what the agent does when",
    "start": "499479",
    "end": "501599"
  },
  {
    "text": "when it receives each of these",
    "start": "501599",
    "end": "503720"
  },
  {
    "text": "updates so the first update is policy",
    "start": "503720",
    "end": "506919"
  },
  {
    "text": "create event so let's imagine a scenario",
    "start": "506919",
    "end": "509159"
  },
  {
    "text": "where you you have a kubernetes cluster",
    "start": "509159",
    "end": "510879"
  },
  {
    "text": "which has no workloads on it and a user",
    "start": "510879",
    "end": "513200"
  },
  {
    "text": "creates a network policy and I call this",
    "start": "513200",
    "end": "516360"
  },
  {
    "text": "policy de star Empire axis what this is",
    "start": "516360",
    "end": "519159"
  },
  {
    "text": "basically defining is we want to allow",
    "start": "519159",
    "end": "521839"
  },
  {
    "text": "Ingress traffic from any part that",
    "start": "521839",
    "end": "524440"
  },
  {
    "text": "belongs to AR",
    "start": "524440",
    "end": "526080"
  },
  {
    "text": "Empire",
    "start": "526080",
    "end": "527959"
  },
  {
    "text": "from from pods that have the labels or",
    "start": "527959",
    "end": "530920"
  },
  {
    "text": "Empire and class dead star so basically",
    "start": "530920",
    "end": "533720"
  },
  {
    "text": "we want to allow traffic from dead star",
    "start": "533720",
    "end": "535519"
  },
  {
    "text": "to any part that's running in AR",
    "start": "535519",
    "end": "538079"
  },
  {
    "text": "Empire so the the first thing agent does",
    "start": "538079",
    "end": "540880"
  },
  {
    "text": "is it basically takes the contents of",
    "start": "540880",
    "end": "543200"
  },
  {
    "text": "the CNP and converts that into a",
    "start": "543200",
    "end": "545079"
  },
  {
    "text": "standardized representation as we",
    "start": "545079",
    "end": "546760"
  },
  {
    "text": "discussed before and it's stored in the",
    "start": "546760",
    "end": "548800"
  },
  {
    "text": "policy repository and every policy gets",
    "start": "548800",
    "end": "552160"
  },
  {
    "text": "a revision number we'll talk a little",
    "start": "552160",
    "end": "554120"
  },
  {
    "text": "bit more about how this revision number",
    "start": "554120",
    "end": "555839"
  },
  {
    "text": "is",
    "start": "555839",
    "end": "556680"
  },
  {
    "text": "used and the next part is we want to",
    "start": "556680",
    "end": "559519"
  },
  {
    "text": "allow Ingress traffic from parts that",
    "start": "559519",
    "end": "562360"
  },
  {
    "text": "have the labels or Empire right so if",
    "start": "562360",
    "end": "565480"
  },
  {
    "text": "you want to convert this section into a",
    "start": "565480",
    "end": "568800"
  },
  {
    "text": "BPF identity Al love list we need to",
    "start": "568800",
    "end": "571200"
  },
  {
    "text": "convert these or Empire labels into its",
    "start": "571200",
    "end": "574079"
  },
  {
    "text": "corresponding identities right",
    "start": "574079",
    "end": "577320"
  },
  {
    "text": "so every time we want to convert a set",
    "start": "577320",
    "end": "580000"
  },
  {
    "text": "of labels into its own identities it's a",
    "start": "580000",
    "end": "582680"
  },
  {
    "text": "very expensive operation so celium tries",
    "start": "582680",
    "end": "585079"
  },
  {
    "text": "to Cache every time it tries to convert",
    "start": "585079",
    "end": "587800"
  },
  {
    "text": "or empire into its backing identities so",
    "start": "587800",
    "end": "591399"
  },
  {
    "text": "this data is stored in something called",
    "start": "591399",
    "end": "593000"
  },
  {
    "text": "a selector cache and at this point we",
    "start": "593000",
    "end": "595120"
  },
  {
    "text": "have no workloads running on this",
    "start": "595120",
    "end": "596440"
  },
  {
    "text": "cluster so it selects no identities",
    "start": "596440",
    "end": "600600"
  },
  {
    "text": "now let's imagine there's a new pod",
    "start": "600600",
    "end": "602240"
  },
  {
    "text": "called de star one that's scheduled onto",
    "start": "602240",
    "end": "604200"
  },
  {
    "text": "this node and this pod has labels or",
    "start": "604200",
    "end": "607000"
  },
  {
    "text": "Empire and class de star and because our",
    "start": "607000",
    "end": "609959"
  },
  {
    "text": "cluster has never seen these set of",
    "start": "609959",
    "end": "612079"
  },
  {
    "text": "labels before it has a security ident it",
    "start": "612079",
    "end": "614880"
  },
  {
    "text": "it gets allocated a security identity",
    "start": "614880",
    "end": "616920"
  },
  {
    "text": "called 1 2 3 4 and uh this identity gets",
    "start": "616920",
    "end": "620600"
  },
  {
    "text": "stored in something called as an",
    "start": "620600",
    "end": "621800"
  },
  {
    "text": "identity",
    "start": "621800",
    "end": "623440"
  },
  {
    "text": "store so now that we have a pod with an",
    "start": "623440",
    "end": "626200"
  },
  {
    "text": "identity 1 2 3 4 and it also has orgm",
    "start": "626200",
    "end": "629440"
  },
  {
    "text": "buyer the select a cache entry is now",
    "start": "629440",
    "end": "632279"
  },
  {
    "text": "updated to reflect 1 2 3",
    "start": "632279",
    "end": "635760"
  },
  {
    "text": "4",
    "start": "635760",
    "end": "637360"
  },
  {
    "text": "so every every CA asan pod has a",
    "start": "637360",
    "end": "640959"
  },
  {
    "text": "dedicated worker for every endpoint",
    "start": "640959",
    "end": "643320"
  },
  {
    "text": "that's running every endpoint or pod",
    "start": "643320",
    "end": "645040"
  },
  {
    "text": "that's running on this node so the",
    "start": "645040",
    "end": "646839"
  },
  {
    "text": "responsibility of this worker is to",
    "start": "646839",
    "end": "648959"
  },
  {
    "text": "basically make sure that the policy",
    "start": "648959",
    "end": "651000"
  },
  {
    "text": "representation for that endpoint is up",
    "start": "651000",
    "end": "653800"
  },
  {
    "text": "to date with the latest revision number",
    "start": "653800",
    "end": "655680"
  },
  {
    "text": "that's present in the policy",
    "start": "655680",
    "end": "657680"
  },
  {
    "text": "repository so what do worker does here",
    "start": "657680",
    "end": "660440"
  },
  {
    "text": "is it it gets the latest uh known policy",
    "start": "660440",
    "end": "663800"
  },
  {
    "text": "and it compares the labels that are",
    "start": "663800",
    "end": "665560"
  },
  {
    "text": "present on this SP with the labels that",
    "start": "665560",
    "end": "667760"
  },
  {
    "text": "are expressed in the network policy and",
    "start": "667760",
    "end": "670040"
  },
  {
    "text": "it comes up with the relevant set of",
    "start": "670040",
    "end": "671680"
  },
  {
    "text": "rules for this specific endpoint and",
    "start": "671680",
    "end": "674639"
  },
  {
    "text": "again this is also an expensive",
    "start": "674639",
    "end": "676399"
  },
  {
    "text": "operation so Cel agent tries to cach",
    "start": "676399",
    "end": "678720"
  },
  {
    "text": "that in something called as policy cache",
    "start": "678720",
    "end": "681440"
  },
  {
    "text": "and what we can do here is we can cach",
    "start": "681440",
    "end": "683720"
  },
  {
    "text": "that against the identity of the Pod so",
    "start": "683720",
    "end": "686600"
  },
  {
    "text": "that this allows us to reuse this",
    "start": "686600",
    "end": "688160"
  },
  {
    "text": "computed policy the next time we have a",
    "start": "688160",
    "end": "690839"
  },
  {
    "text": "part that looks like",
    "start": "690839",
    "end": "692560"
  },
  {
    "text": "this and celm agent also does something",
    "start": "692560",
    "end": "695440"
  },
  {
    "text": "interesting here so it goes back to the",
    "start": "695440",
    "end": "697600"
  },
  {
    "text": "selector so soon after the entry in the",
    "start": "697600",
    "end": "699760"
  },
  {
    "text": "policy cache is added it goes back to",
    "start": "699760",
    "end": "701760"
  },
  {
    "text": "the selector cache and updates",
    "start": "701760",
    "end": "703639"
  },
  {
    "text": "references to entries and policy cache",
    "start": "703639",
    "end": "706760"
  },
  {
    "text": "for every entry that selects ARG",
    "start": "706760",
    "end": "711200"
  },
  {
    "text": "Empire so finally we have all the data",
    "start": "711200",
    "end": "714399"
  },
  {
    "text": "we want and we can join the data between",
    "start": "714399",
    "end": "716560"
  },
  {
    "text": "select a cache and policy cache to",
    "start": "716560",
    "end": "718399"
  },
  {
    "text": "compute the final identity I love list",
    "start": "718399",
    "end": "720440"
  },
  {
    "text": "and update to this endpoints ppf",
    "start": "720440",
    "end": "724360"
  },
  {
    "text": "map now what happens if you have another",
    "start": "724560",
    "end": "727680"
  },
  {
    "text": "pod called de star 2 and this pod also",
    "start": "727680",
    "end": "730519"
  },
  {
    "text": "has the same set of labels so it",
    "start": "730519",
    "end": "732240"
  },
  {
    "text": "inherits the identity 1 2 3",
    "start": "732240",
    "end": "734560"
  },
  {
    "text": "4 and we already have all the data that",
    "start": "734560",
    "end": "737040"
  },
  {
    "text": "is necessary to compute policy for this",
    "start": "737040",
    "end": "738920"
  },
  {
    "text": "endpoint so we simply join that data and",
    "start": "738920",
    "end": "741480"
  },
  {
    "text": "update the contents into this endpoints",
    "start": "741480",
    "end": "743639"
  },
  {
    "text": "ppf",
    "start": "743639",
    "end": "745480"
  },
  {
    "text": "map now so far we've been talking about",
    "start": "745480",
    "end": "748480"
  },
  {
    "text": "events that are happen happen on just",
    "start": "748480",
    "end": "749760"
  },
  {
    "text": "one node but what happens if there's a",
    "start": "749760",
    "end": "751639"
  },
  {
    "text": "new pod that's created on a remote node",
    "start": "751639",
    "end": "753920"
  },
  {
    "text": "so let's say there's another node called",
    "start": "753920",
    "end": "755440"
  },
  {
    "text": "node 2 and this time there's a pod",
    "start": "755440",
    "end": "757600"
  },
  {
    "text": "called TIE fighter and this has the",
    "start": "757600",
    "end": "759320"
  },
  {
    "text": "labels or gempire and class TI fighter",
    "start": "759320",
    "end": "762440"
  },
  {
    "text": "and because we' have not seen these",
    "start": "762440",
    "end": "763680"
  },
  {
    "text": "labels before c maloc getes a new",
    "start": "763680",
    "end": "765600"
  },
  {
    "text": "identity for this called",
    "start": "765600",
    "end": "768440"
  },
  {
    "text": "2345 and the node one instantly gets",
    "start": "768440",
    "end": "771399"
  },
  {
    "text": "notified about this new security",
    "start": "771399",
    "end": "773320"
  },
  {
    "text": "identity and it gets updated in its own",
    "start": "773320",
    "end": "775480"
  },
  {
    "text": "local identity",
    "start": "775480",
    "end": "777800"
  },
  {
    "text": "store and this is the state uh in node",
    "start": "777800",
    "end": "781040"
  },
  {
    "text": "one before it received an update about 2",
    "start": "781040",
    "end": "783160"
  },
  {
    "text": "3 4 5 right so now that we have another",
    "start": "783160",
    "end": "787000"
  },
  {
    "text": "identity that selects AR Empire this",
    "start": "787000",
    "end": "790399"
  },
  {
    "text": "gets updated with 2345 as well and",
    "start": "790399",
    "end": "794160"
  },
  {
    "text": "remember we spoke about um how selector",
    "start": "794160",
    "end": "796880"
  },
  {
    "text": "cache has mappings back to policy cache",
    "start": "796880",
    "end": "799639"
  },
  {
    "text": "so now from selector cache we can",
    "start": "799639",
    "end": "801680"
  },
  {
    "text": "quickly jump to entries in policy cache",
    "start": "801680",
    "end": "805279"
  },
  {
    "text": "that are relevant here and this allows",
    "start": "805279",
    "end": "807399"
  },
  {
    "text": "us to very quickly compute only the new",
    "start": "807399",
    "end": "809959"
  },
  {
    "text": "entries that need to be updated to the",
    "start": "809959",
    "end": "811639"
  },
  {
    "text": "BPF map so there could already be like",
    "start": "811639",
    "end": "814320"
  },
  {
    "text": "thousands of entries in a BPF map but",
    "start": "814320",
    "end": "816560"
  },
  {
    "text": "all we need to compute is entries for",
    "start": "816560",
    "end": "818800"
  },
  {
    "text": "identity 2 3 4 5 so this allows us to",
    "start": "818800",
    "end": "822360"
  },
  {
    "text": "have really fast incremental policy",
    "start": "822360",
    "end": "825720"
  },
  {
    "text": "updates now what happens if there's",
    "start": "825720",
    "end": "828079"
  },
  {
    "text": "another part called Ti Fighter 2 on a",
    "start": "828079",
    "end": "830519"
  },
  {
    "text": "remote node we already know the labels",
    "start": "830519",
    "end": "832759"
  },
  {
    "text": "for this SP so it inherits the identity",
    "start": "832759",
    "end": "834959"
  },
  {
    "text": "2 3 4 5 and we don't have all we don't",
    "start": "834959",
    "end": "839680"
  },
  {
    "text": "have anything to do on node one for this",
    "start": "839680",
    "end": "842079"
  },
  {
    "text": "all the policy that is necessary for",
    "start": "842079",
    "end": "844120"
  },
  {
    "text": "2345 is already in place so from a",
    "start": "844120",
    "end": "847079"
  },
  {
    "text": "policy computation perspective there's",
    "start": "847079",
    "end": "849120"
  },
  {
    "text": "absolutely no work that needs to be",
    "start": "849120",
    "end": "851839"
  },
  {
    "text": "done so to recap the section um what we",
    "start": "851839",
    "end": "855639"
  },
  {
    "text": "learned here is that celium agent uses",
    "start": "855639",
    "end": "858279"
  },
  {
    "text": "uh celum agent tries to cash all the",
    "start": "858279",
    "end": "860680"
  },
  {
    "text": "expensive operations during policy",
    "start": "860680",
    "end": "862680"
  },
  {
    "text": "computation and we are being smart about",
    "start": "862680",
    "end": "865000"
  },
  {
    "text": "when we regenerate the policy we only",
    "start": "865000",
    "end": "867199"
  },
  {
    "text": "generate the policy once the first time",
    "start": "867199",
    "end": "869399"
  },
  {
    "text": "we see a new identity and we're also",
    "start": "869399",
    "end": "871639"
  },
  {
    "text": "using efficient data structures to make",
    "start": "871639",
    "end": "873440"
  },
  {
    "text": "sure we are able to quickly regenerate",
    "start": "873440",
    "end": "875639"
  },
  {
    "text": "uh policy incremental",
    "start": "875639",
    "end": "878120"
  },
  {
    "text": "policy so now I'll let Joe talk about",
    "start": "878120",
    "end": "881079"
  },
  {
    "text": "how this computed policy uh is used in",
    "start": "881079",
    "end": "884040"
  },
  {
    "text": "the data path to enforce the network",
    "start": "884040",
    "end": "887959"
  },
  {
    "text": "policy all right so so taking it back to",
    "start": "890320",
    "end": "892680"
  },
  {
    "text": "the high level we're kind of trying to",
    "start": "892680",
    "end": "894240"
  },
  {
    "text": "say how are we doing as little work as",
    "start": "894240",
    "end": "896440"
  },
  {
    "text": "possible anytime events occur in in in",
    "start": "896440",
    "end": "898360"
  },
  {
    "text": "the system",
    "start": "898360",
    "end": "901040"
  },
  {
    "text": "a little bit more on this last part of",
    "start": "959000",
    "end": "960519"
  },
  {
    "text": "the diagram here so what are we trying",
    "start": "960519",
    "end": "963399"
  },
  {
    "text": "to achieve uh so first we're going to",
    "start": "963399",
    "end": "965839"
  },
  {
    "text": "take uh all the Pod metadata that we",
    "start": "965839",
    "end": "968279"
  },
  {
    "text": "have for this particular pod so things",
    "start": "968279",
    "end": "970199"
  },
  {
    "text": "like IP addresses the security identity",
    "start": "970199",
    "end": "972720"
  },
  {
    "text": "and other configuration for that",
    "start": "972720",
    "end": "974240"
  },
  {
    "text": "endpoint uh and if we take all of that",
    "start": "974240",
    "end": "976279"
  },
  {
    "text": "information together we can actually",
    "start": "976279",
    "end": "978040"
  },
  {
    "text": "tailor the individual BPF program for",
    "start": "978040",
    "end": "980319"
  },
  {
    "text": "the particular endpoint or the",
    "start": "980319",
    "end": "981800"
  },
  {
    "text": "particular pod uh and so by doing things",
    "start": "981800",
    "end": "984759"
  },
  {
    "text": "like embedding the security identity",
    "start": "984759",
    "end": "986440"
  },
  {
    "text": "like directly into the assembly",
    "start": "986440",
    "end": "988000"
  },
  {
    "text": "instructions at BPF we can make that",
    "start": "988000",
    "end": "990160"
  },
  {
    "text": "incredibly uh efficient um and so once",
    "start": "990160",
    "end": "993279"
  },
  {
    "text": "we've compiled that BPF program for the",
    "start": "993279",
    "end": "994959"
  },
  {
    "text": "particular endpoint uh we can then load",
    "start": "994959",
    "end": "997360"
  },
  {
    "text": "those BPF programs into the kernel along",
    "start": "997360",
    "end": "999720"
  },
  {
    "text": "with map state which is more Dynamic",
    "start": "999720",
    "end": "1001519"
  },
  {
    "text": "state that uh the the kernel needs to be",
    "start": "1001519",
    "end": "1004000"
  },
  {
    "text": "able to perform networking functions uh",
    "start": "1004000",
    "end": "1006639"
  },
  {
    "text": "and then we attach that program to the",
    "start": "1006639",
    "end": "1008199"
  },
  {
    "text": "event like a packet processing event",
    "start": "1008199",
    "end": "1011160"
  },
  {
    "text": "finally once we've implemented all of",
    "start": "1011160",
    "end": "1012720"
  },
  {
    "text": "this we can return from our cni ad call",
    "start": "1012720",
    "end": "1015480"
  },
  {
    "text": "and uh you know the the network is ready",
    "start": "1015480",
    "end": "1018279"
  },
  {
    "text": "to actually hand traffic and container",
    "start": "1018279",
    "end": "1020360"
  },
  {
    "text": "runtime can can start your",
    "start": "1020360",
    "end": "1023360"
  },
  {
    "text": "application so one of the things we uh",
    "start": "1023360",
    "end": "1025400"
  },
  {
    "text": "you know noticed when we actually",
    "start": "1025400",
    "end": "1026319"
  },
  {
    "text": "started to measure this is that the",
    "start": "1026319",
    "end": "1028280"
  },
  {
    "text": "compile step eror was was taking a",
    "start": "1028280",
    "end": "1030079"
  },
  {
    "text": "little too long or longer than we'd like",
    "start": "1030079",
    "end": "1031558"
  },
  {
    "text": "it to to take um and so we put metrics",
    "start": "1031559",
    "end": "1034120"
  },
  {
    "text": "in place to be able to measure the",
    "start": "1034120",
    "end": "1035400"
  },
  {
    "text": "different phases um and we identified",
    "start": "1035400",
    "end": "1038199"
  },
  {
    "text": "the the compilation step is taking too",
    "start": "1038199",
    "end": "1040240"
  },
  {
    "text": "long now with this compilation step what",
    "start": "1040240",
    "end": "1042880"
  },
  {
    "text": "we were trying to achieve is for every",
    "start": "1042880",
    "end": "1044959"
  },
  {
    "text": "single packet happening being handled in",
    "start": "1044959",
    "end": "1047160"
  },
  {
    "text": "the system we want to minimize the",
    "start": "1047160",
    "end": "1048679"
  },
  {
    "text": "amount of work that we want to do uh in",
    "start": "1048679",
    "end": "1050840"
  },
  {
    "text": "order to handle that packet but then we",
    "start": "1050840",
    "end": "1053039"
  },
  {
    "text": "introduced this trade-off here where the",
    "start": "1053039",
    "end": "1055120"
  },
  {
    "text": "Pod turn rate would then be increased um",
    "start": "1055120",
    "end": "1057679"
  },
  {
    "text": "so we kind of wanted a way to be able to",
    "start": "1057679",
    "end": "1059039"
  },
  {
    "text": "actually achieve both of these things uh",
    "start": "1059039",
    "end": "1061440"
  },
  {
    "text": "and so the solution we came up with was",
    "start": "1061440",
    "end": "1063039"
  },
  {
    "text": "what we call elf elf templating so the",
    "start": "1063039",
    "end": "1065600"
  },
  {
    "text": "idea is that when you compile the uh the",
    "start": "1065600",
    "end": "1068200"
  },
  {
    "text": "BPF programs in the the very first time",
    "start": "1068200",
    "end": "1070840"
  },
  {
    "text": "on the system uh we store references to",
    "start": "1070840",
    "end": "1073840"
  },
  {
    "text": "where the security identities and IP",
    "start": "1073840",
    "end": "1075480"
  },
  {
    "text": "addresses and so on are within the BPF",
    "start": "1075480",
    "end": "1077840"
  },
  {
    "text": "instructions uh and template that and so",
    "start": "1077840",
    "end": "1081000"
  },
  {
    "text": "what happens when a second or later pod",
    "start": "1081000",
    "end": "1083520"
  },
  {
    "text": "uh gets deployed onto the node is that",
    "start": "1083520",
    "end": "1085120"
  },
  {
    "text": "we can then take this elf we can uh",
    "start": "1085120",
    "end": "1087880"
  },
  {
    "text": "substitute the uh individual BPF",
    "start": "1087880",
    "end": "1089960"
  },
  {
    "text": "instructions security identity and so on",
    "start": "1089960",
    "end": "1092640"
  },
  {
    "text": "um and then we'll get all the efficiency",
    "start": "1092640",
    "end": "1095039"
  },
  {
    "text": "per packet that we got before but we've",
    "start": "1095039",
    "end": "1097000"
  },
  {
    "text": "also drastically decreased the amount of",
    "start": "1097000",
    "end": "1098880"
  },
  {
    "text": "time that it takes uh for that pod",
    "start": "1098880",
    "end": "1100760"
  },
  {
    "text": "initialization to to",
    "start": "1100760",
    "end": "1103960"
  },
  {
    "text": "occur so with that in mind what we'",
    "start": "1104200",
    "end": "1106480"
  },
  {
    "text": "finally arrived at is what happens when",
    "start": "1106480",
    "end": "1108440"
  },
  {
    "text": "an indiv ual packet actually gets sent",
    "start": "1108440",
    "end": "1110559"
  },
  {
    "text": "through the system and so in this case",
    "start": "1110559",
    "end": "1112480"
  },
  {
    "text": "we've got the the Tie Fighter and and it",
    "start": "1112480",
    "end": "1113880"
  },
  {
    "text": "sends a packet it's trying to reach out",
    "start": "1113880",
    "end": "1115480"
  },
  {
    "text": "to the Death Star and so there are very",
    "start": "1115480",
    "end": "1118039"
  },
  {
    "text": "various different uh Network functions",
    "start": "1118039",
    "end": "1120200"
  },
  {
    "text": "that are necessary to implement policy",
    "start": "1120200",
    "end": "1122200"
  },
  {
    "text": "so I'm not going to go in a deep dive of",
    "start": "1122200",
    "end": "1123679"
  },
  {
    "text": "all of the data path here uh but some of",
    "start": "1123679",
    "end": "1126039"
  },
  {
    "text": "the key key areas that that that are",
    "start": "1126039",
    "end": "1128880"
  },
  {
    "text": "important um so first thing uh if the",
    "start": "1128880",
    "end": "1131360"
  },
  {
    "text": "traffic is destined to like the Death",
    "start": "1131360",
    "end": "1132640"
  },
  {
    "text": "Star service then we need to load",
    "start": "1132640",
    "end": "1134760"
  },
  {
    "text": "balance that traffic to an individual",
    "start": "1134760",
    "end": "1136480"
  },
  {
    "text": "back end uh CU then with the back end we",
    "start": "1136480",
    "end": "1138480"
  },
  {
    "text": "can deter determine the security policy",
    "start": "1138480",
    "end": "1139960"
  },
  {
    "text": "for that particular",
    "start": "1139960",
    "end": "1141679"
  },
  {
    "text": "traffic secondly um we go into what we",
    "start": "1141679",
    "end": "1144720"
  },
  {
    "text": "call the connection tracking table so at",
    "start": "1144720",
    "end": "1147200"
  },
  {
    "text": "a high level when you're defining a",
    "start": "1147200",
    "end": "1148559"
  },
  {
    "text": "network policy uh you tend to express it",
    "start": "1148559",
    "end": "1151080"
  },
  {
    "text": "in terms of something like TI fighter",
    "start": "1151080",
    "end": "1153120"
  },
  {
    "text": "can talk to death star so this is",
    "start": "1153120",
    "end": "1155159"
  },
  {
    "text": "inherently connection oriented you're",
    "start": "1155159",
    "end": "1156919"
  },
  {
    "text": "talking about one particular uh",
    "start": "1156919",
    "end": "1158720"
  },
  {
    "text": "application talking to another but at",
    "start": "1158720",
    "end": "1160840"
  },
  {
    "text": "the packet level you actually have",
    "start": "1160840",
    "end": "1162200"
  },
  {
    "text": "two-way communication you have reply",
    "start": "1162200",
    "end": "1164159"
  },
  {
    "text": "packets sending back to the original TI",
    "start": "1164159",
    "end": "1166919"
  },
  {
    "text": "fighter uh and so when we to implement",
    "start": "1166919",
    "end": "1169320"
  },
  {
    "text": "the policy to say TI fighter can talk to",
    "start": "1169320",
    "end": "1171039"
  },
  {
    "text": "death star we actually need to allow the",
    "start": "1171039",
    "end": "1172840"
  },
  {
    "text": "replies back as well uh so what this",
    "start": "1172840",
    "end": "1175360"
  },
  {
    "text": "connection T tracking table uh does is",
    "start": "1175360",
    "end": "1177559"
  },
  {
    "text": "it allows us to associate their reply",
    "start": "1177559",
    "end": "1179720"
  },
  {
    "text": "packets back to the original connection",
    "start": "1179720",
    "end": "1182120"
  },
  {
    "text": "uh and then we can just Express the",
    "start": "1182120",
    "end": "1183400"
  },
  {
    "text": "policy purely in terms of the original",
    "start": "1183400",
    "end": "1185120"
  },
  {
    "text": "Direction",
    "start": "1185120",
    "end": "1186960"
  },
  {
    "text": "traffic so now we move on to uh",
    "start": "1186960",
    "end": "1189919"
  },
  {
    "text": "determining the identity of the of the",
    "start": "1189919",
    "end": "1191640"
  },
  {
    "text": "target traffic and so there are various",
    "start": "1191640",
    "end": "1193799"
  },
  {
    "text": "different ways we can do this we can",
    "start": "1193799",
    "end": "1195240"
  },
  {
    "text": "pull this information out of uh headers",
    "start": "1195240",
    "end": "1197200"
  },
  {
    "text": "from a tunnel uh packet uh or we can",
    "start": "1197200",
    "end": "1199440"
  },
  {
    "text": "distribute this state between nodes",
    "start": "1199440",
    "end": "1201120"
  },
  {
    "text": "through um through the control",
    "start": "1201120",
    "end": "1203200"
  },
  {
    "text": "plane uh and so this will depend on",
    "start": "1203200",
    "end": "1205200"
  },
  {
    "text": "whether you got Ingress you're applying",
    "start": "1205200",
    "end": "1206880"
  },
  {
    "text": "this traffic on Ingress or egress or",
    "start": "1206880",
    "end": "1208520"
  },
  {
    "text": "tunneling mode and various different",
    "start": "1208520",
    "end": "1209840"
  },
  {
    "text": "things like",
    "start": "1209840",
    "end": "1210880"
  },
  {
    "text": "that and finally with now that we know",
    "start": "1210880",
    "end": "1213640"
  },
  {
    "text": "everything about this traffic we know",
    "start": "1213640",
    "end": "1215120"
  },
  {
    "text": "where who it's uh who is talking to who",
    "start": "1215120",
    "end": "1218200"
  },
  {
    "text": "uh we can then look up this policy map",
    "start": "1218200",
    "end": "1220120"
  },
  {
    "text": "and this is all the stuff that Hima",
    "start": "1220120",
    "end": "1221960"
  },
  {
    "text": "described earlier um and we can",
    "start": "1221960",
    "end": "1223720"
  },
  {
    "text": "efficiently figure out should we drop",
    "start": "1223720",
    "end": "1225760"
  },
  {
    "text": "the traffic should we allow the traffic",
    "start": "1225760",
    "end": "1227320"
  },
  {
    "text": "should we redirect it uh and after that",
    "start": "1227320",
    "end": "1229720"
  },
  {
    "text": "we can apply things like authentication",
    "start": "1229720",
    "end": "1231320"
  },
  {
    "text": "and rout the traffic to where it's going",
    "start": "1231320",
    "end": "1233320"
  },
  {
    "text": "to so I want to look into a few",
    "start": "1233320",
    "end": "1235960"
  },
  {
    "text": "optimizations we put in place at",
    "start": "1235960",
    "end": "1237640"
  },
  {
    "text": "individual steps through this process uh",
    "start": "1237640",
    "end": "1240559"
  },
  {
    "text": "so first up uh if any any of you are",
    "start": "1240559",
    "end": "1243039"
  },
  {
    "text": "around for Martinez's talk and and San",
    "start": "1243039",
    "end": "1244840"
  },
  {
    "text": "Diego uh he did a deep dive into how",
    "start": "1244840",
    "end": "1247200"
  },
  {
    "text": "selum CP proxy replacement Works um and",
    "start": "1247200",
    "end": "1250159"
  },
  {
    "text": "so one of the core ideas here is",
    "start": "1250159",
    "end": "1251440"
  },
  {
    "text": "actually to move the load balancing",
    "start": "1251440",
    "end": "1252919"
  },
  {
    "text": "decision up to the socket layer uh so",
    "start": "1252919",
    "end": "1255520"
  },
  {
    "text": "that when it comes to per packet",
    "start": "1255520",
    "end": "1256960"
  },
  {
    "text": "processing we actually have nothing to",
    "start": "1256960",
    "end": "1258240"
  },
  {
    "text": "do anymore more um so there's nothing",
    "start": "1258240",
    "end": "1260760"
  },
  {
    "text": "quicker to do than absolutely nothing um",
    "start": "1260760",
    "end": "1263400"
  },
  {
    "text": "so from a prayer packet you know uh you",
    "start": "1263400",
    "end": "1266080"
  },
  {
    "text": "know speed um kind of perspective that",
    "start": "1266080",
    "end": "1268919"
  },
  {
    "text": "that's uh that's really",
    "start": "1268919",
    "end": "1270840"
  },
  {
    "text": "fast uh secondly um so we use what we",
    "start": "1270840",
    "end": "1273679"
  },
  {
    "text": "call lru based hash table for the",
    "start": "1273679",
    "end": "1276200"
  },
  {
    "text": "connection tracker so what's interesting",
    "start": "1276200",
    "end": "1278360"
  },
  {
    "text": "about the connection tracker as a kind",
    "start": "1278360",
    "end": "1280679"
  },
  {
    "text": "of part of a networking system is that",
    "start": "1280679",
    "end": "1282840"
  },
  {
    "text": "it's really tracking all of the active",
    "start": "1282840",
    "end": "1284600"
  },
  {
    "text": "connections that are running through the",
    "start": "1284600",
    "end": "1285919"
  },
  {
    "text": "system at this time and so depending on",
    "start": "1285919",
    "end": "1289120"
  },
  {
    "text": "the scale of your system that table can",
    "start": "1289120",
    "end": "1291440"
  },
  {
    "text": "end up being very very large uh and so",
    "start": "1291440",
    "end": "1294240"
  },
  {
    "text": "one of the problems we have is like how",
    "start": "1294240",
    "end": "1295840"
  },
  {
    "text": "how do we efficiently keep that table uh",
    "start": "1295840",
    "end": "1298640"
  },
  {
    "text": "accurately tracking the the active",
    "start": "1298640",
    "end": "1300159"
  },
  {
    "text": "connections that are going right now uh",
    "start": "1300159",
    "end": "1302039"
  },
  {
    "text": "and that involves things like cleanup",
    "start": "1302039",
    "end": "1303520"
  },
  {
    "text": "and you do spend some CPU U Cycles on on",
    "start": "1303520",
    "end": "1306200"
  },
  {
    "text": "trying to clean up this table and so by",
    "start": "1306200",
    "end": "1308760"
  },
  {
    "text": "using a hash table with the least",
    "start": "1308760",
    "end": "1310520"
  },
  {
    "text": "recently used property uh when a new",
    "start": "1310520",
    "end": "1312840"
  },
  {
    "text": "connection uh arrives we can actually",
    "start": "1312840",
    "end": "1314840"
  },
  {
    "text": "automatically bump out old connections",
    "start": "1314840",
    "end": "1316640"
  },
  {
    "text": "from that table uh and then the garbage",
    "start": "1316640",
    "end": "1319000"
  },
  {
    "text": "collection process is much",
    "start": "1319000",
    "end": "1321880"
  },
  {
    "text": "faster and finally if we look at the the",
    "start": "1321880",
    "end": "1324159"
  },
  {
    "text": "policy level um you know we want to try",
    "start": "1324159",
    "end": "1327760"
  },
  {
    "text": "to ensure that when we enforce policy it",
    "start": "1327760",
    "end": "1330440"
  },
  {
    "text": "has a constant time uh you know uh",
    "start": "1330440",
    "end": "1333679"
  },
  {
    "text": "performance uh characteristic and so if",
    "start": "1333679",
    "end": "1336559"
  },
  {
    "text": "you have thousands and thousands of",
    "start": "1336559",
    "end": "1337880"
  },
  {
    "text": "policies at the kubernetes layer we",
    "start": "1337880",
    "end": "1339799"
  },
  {
    "text": "don't want to map that down into the",
    "start": "1339799",
    "end": "1341320"
  },
  {
    "text": "data path so that every time you know",
    "start": "1341320",
    "end": "1343200"
  },
  {
    "text": "millions of packets have flowing through",
    "start": "1343200",
    "end": "1344600"
  },
  {
    "text": "the the system per second we don't want",
    "start": "1344600",
    "end": "1346360"
  },
  {
    "text": "to be running through thousands of rules",
    "start": "1346360",
    "end": "1347840"
  },
  {
    "text": "to be able to Det DET should we allow",
    "start": "1347840",
    "end": "1349640"
  },
  {
    "text": "the traffic or not and so all the work",
    "start": "1349640",
    "end": "1352080"
  },
  {
    "text": "that um Hima talked about is about",
    "start": "1352080",
    "end": "1354279"
  },
  {
    "text": "amortizing that cost and and and",
    "start": "1354279",
    "end": "1356200"
  },
  {
    "text": "building up this map so that when we",
    "start": "1356200",
    "end": "1358520"
  },
  {
    "text": "identify who can talk to who um we can",
    "start": "1358520",
    "end": "1362240"
  },
  {
    "text": "prepare all the information we need to",
    "start": "1362240",
    "end": "1363840"
  },
  {
    "text": "make that decision in the data path uh",
    "start": "1363840",
    "end": "1365880"
  },
  {
    "text": "so that it can it can happen constant",
    "start": "1365880",
    "end": "1369400"
  },
  {
    "text": "time so to to wrap up the section uh so",
    "start": "1369400",
    "end": "1372559"
  },
  {
    "text": "we talked about embedding pod metadata",
    "start": "1372559",
    "end": "1374279"
  },
  {
    "text": "things like security identity like",
    "start": "1374279",
    "end": "1375640"
  },
  {
    "text": "directly into the instructions um about",
    "start": "1375640",
    "end": "1377799"
  },
  {
    "text": "how we measured amortize the costs of",
    "start": "1377799",
    "end": "1379799"
  },
  {
    "text": "pod",
    "start": "1379799",
    "end": "1380600"
  },
  {
    "text": "turn um and then how we can like",
    "start": "1380600",
    "end": "1383279"
  },
  {
    "text": "different strategies we've used the data",
    "start": "1383279",
    "end": "1384840"
  },
  {
    "text": "path level to optimize the performance",
    "start": "1384840",
    "end": "1387000"
  },
  {
    "text": "whether it's you know triggering on",
    "start": "1387000",
    "end": "1388640"
  },
  {
    "text": "events with a lower frequency um or",
    "start": "1388640",
    "end": "1391440"
  },
  {
    "text": "mitigating the CPU usage for maintaining",
    "start": "1391440",
    "end": "1393559"
  },
  {
    "text": "tables or um you know avoiding linear",
    "start": "1393559",
    "end": "1396279"
  },
  {
    "text": "iteration at the actual per packet level",
    "start": "1396279",
    "end": "1398640"
  },
  {
    "text": "uh so that we're doing as little work at",
    "start": "1398640",
    "end": "1401120"
  },
  {
    "text": "the packet level as as",
    "start": "1401120",
    "end": "1402679"
  },
  {
    "text": "possible uh so with all that in place um",
    "start": "1402679",
    "end": "1405159"
  },
  {
    "text": "H's going to walk through debugging the",
    "start": "1405159",
    "end": "1407000"
  },
  {
    "text": "the policy",
    "start": "1407000",
    "end": "1410520"
  },
  {
    "text": "thank",
    "start": "1410919",
    "end": "1412480"
  },
  {
    "text": "you so every once in a while you might",
    "start": "1412480",
    "end": "1415679"
  },
  {
    "text": "want to validate if celum is enforcing",
    "start": "1415679",
    "end": "1417960"
  },
  {
    "text": "the network policy the intended Network",
    "start": "1417960",
    "end": "1420000"
  },
  {
    "text": "policy correctly or you might have users",
    "start": "1420000",
    "end": "1423159"
  },
  {
    "text": "reaching out to you asking you why",
    "start": "1423159",
    "end": "1425159"
  },
  {
    "text": "they're unable to talk to their",
    "start": "1425159",
    "end": "1426400"
  },
  {
    "text": "destination service or why they're",
    "start": "1426400",
    "end": "1428720"
  },
  {
    "text": "seeing timeouts to this specific IP",
    "start": "1428720",
    "end": "1430679"
  },
  {
    "text": "address or tens of other variants of the",
    "start": "1430679",
    "end": "1433320"
  },
  {
    "text": "same question so luckily celium from the",
    "start": "1433320",
    "end": "1437200"
  },
  {
    "text": "get-go has invested in some tooling to",
    "start": "1437200",
    "end": "1439400"
  },
  {
    "text": "inspect and debug every stage of this",
    "start": "1439400",
    "end": "1441679"
  },
  {
    "text": "policy computation process so in the",
    "start": "1441679",
    "end": "1444120"
  },
  {
    "text": "section I'll walk through some of the",
    "start": "1444120",
    "end": "1445400"
  },
  {
    "text": "tooling that already exist today and how",
    "start": "1445400",
    "end": "1447320"
  },
  {
    "text": "we can look at some of the sections we",
    "start": "1447320",
    "end": "1449320"
  },
  {
    "text": "talked about in the earlier",
    "start": "1449320",
    "end": "1451240"
  },
  {
    "text": "sections so the first step is if you",
    "start": "1451240",
    "end": "1454400"
  },
  {
    "text": "want to inspect all the policy that a",
    "start": "1454400",
    "end": "1457120"
  },
  {
    "text": "given celium agent knows about we can",
    "start": "1457120",
    "end": "1459039"
  },
  {
    "text": "EXA into the celium agent process and",
    "start": "1459039",
    "end": "1460799"
  },
  {
    "text": "there's a binary called celium debug and",
    "start": "1460799",
    "end": "1463240"
  },
  {
    "text": "we can use this command called celium",
    "start": "1463240",
    "end": "1464760"
  },
  {
    "text": "debug policy get this dumps All the",
    "start": "1464760",
    "end": "1467200"
  },
  {
    "text": "known policies on on this specific",
    "start": "1467200",
    "end": "1469159"
  },
  {
    "text": "cimation",
    "start": "1469159",
    "end": "1471320"
  },
  {
    "text": "process and we spoke about select a",
    "start": "1471320",
    "end": "1473880"
  },
  {
    "text": "cache if you want to inspect the in",
    "start": "1473880",
    "end": "1475399"
  },
  {
    "text": "memory select a cache we can use celium",
    "start": "1475399",
    "end": "1477320"
  },
  {
    "text": "debug policy select celum debug policy",
    "start": "1477320",
    "end": "1479760"
  },
  {
    "text": "selectors get to look at every selector",
    "start": "1479760",
    "end": "1482799"
  },
  {
    "text": "and the identities that it maps to and",
    "start": "1482799",
    "end": "1484919"
  },
  {
    "text": "you can see the identities 1 2 3 4 and 2",
    "start": "1484919",
    "end": "1487240"
  },
  {
    "text": "3 45 we spoke about",
    "start": "1487240",
    "end": "1489720"
  },
  {
    "text": "earlier and we don't have a direct way",
    "start": "1489720",
    "end": "1492679"
  },
  {
    "text": "to look at the policy cache but you can",
    "start": "1492679",
    "end": "1495200"
  },
  {
    "text": "do celium debug endpoint list to get the",
    "start": "1495200",
    "end": "1498000"
  },
  {
    "text": "list of all the endpoints that are",
    "start": "1498000",
    "end": "1499320"
  },
  {
    "text": "running on the Node and once you have",
    "start": "1499320",
    "end": "1500960"
  },
  {
    "text": "the endpoint ID you can get the full",
    "start": "1500960",
    "end": "1503960"
  },
  {
    "text": "contents of this specific endpoint and",
    "start": "1503960",
    "end": "1506720"
  },
  {
    "text": "one interesting property here is that",
    "start": "1506720",
    "end": "1508559"
  },
  {
    "text": "you can see that uh the derived from",
    "start": "1508559",
    "end": "1511080"
  },
  {
    "text": "rule section has a policy called de star",
    "start": "1511080",
    "end": "1513960"
  },
  {
    "text": "Empire axis so if you're curious on what",
    "start": "1513960",
    "end": "1517200"
  },
  {
    "text": "policy is being selected on this given",
    "start": "1517200",
    "end": "1519000"
  },
  {
    "text": "endpoint you can always verify it from",
    "start": "1519000",
    "end": "1523279"
  },
  {
    "text": "here and finally if you want to look at",
    "start": "1523440",
    "end": "1526000"
  },
  {
    "text": "the computed BPF based I love list you",
    "start": "1526000",
    "end": "1528679"
  },
  {
    "text": "can do celium debug BPF policy get this",
    "start": "1528679",
    "end": "1532240"
  },
  {
    "text": "uh tell this is a direct representation",
    "start": "1532240",
    "end": "1534880"
  },
  {
    "text": "of the uh data that's written to the per",
    "start": "1534880",
    "end": "1537559"
  },
  {
    "text": "endpoint BPF map and what you see here",
    "start": "1537559",
    "end": "1540919"
  },
  {
    "text": "is the target identities are already",
    "start": "1540919",
    "end": "1542760"
  },
  {
    "text": "converted into the backing labels but if",
    "start": "1542760",
    "end": "1546279"
  },
  {
    "text": "you want to look at the raw contents you",
    "start": "1546279",
    "end": "1547919"
  },
  {
    "text": "can always use BPF tool map dump to get",
    "start": "1547919",
    "end": "1550799"
  },
  {
    "text": "the exact cont to to get the raw",
    "start": "1550799",
    "end": "1553600"
  },
  {
    "text": "content and cium debug has a lot more",
    "start": "1553600",
    "end": "1557080"
  },
  {
    "text": "sub commands like this um one more",
    "start": "1557080",
    "end": "1559399"
  },
  {
    "text": "important one could be celum debug and",
    "start": "1559399",
    "end": "1561440"
  },
  {
    "text": "point log which gives you all the recent",
    "start": "1561440",
    "end": "1564240"
  },
  {
    "text": "uh logs that have happened in the",
    "start": "1564240",
    "end": "1565640"
  },
  {
    "text": "context of one specific",
    "start": "1565640",
    "end": "1567559"
  },
  {
    "text": "endpoint and there are also a lot of",
    "start": "1567559",
    "end": "1569880"
  },
  {
    "text": "metrics that are available you can",
    "start": "1569880",
    "end": "1571600"
  },
  {
    "text": "monitor celium BPF map pressure uh",
    "start": "1571600",
    "end": "1574039"
  },
  {
    "text": "martinus had a demo about this earlier",
    "start": "1574039",
    "end": "1576840"
  },
  {
    "text": "and you can have metrics on policy",
    "start": "1576840",
    "end": "1578760"
  },
  {
    "text": "enforcement status to understand how",
    "start": "1578760",
    "end": "1580840"
  },
  {
    "text": "many endpoints are currently in enforced",
    "start": "1580840",
    "end": "1582720"
  },
  {
    "text": "mode and you can also monitor uh your",
    "start": "1582720",
    "end": "1585399"
  },
  {
    "text": "policy enforcement",
    "start": "1585399",
    "end": "1587320"
  },
  {
    "text": "delay so I'd highly recommend uh check",
    "start": "1587320",
    "end": "1590000"
  },
  {
    "text": "out docs. cm. to look at all the command",
    "start": "1590000",
    "end": "1593559"
  },
  {
    "text": "reference that we",
    "start": "1593559",
    "end": "1595200"
  },
  {
    "text": "have uh and if you haven't used this",
    "start": "1595200",
    "end": "1597880"
  },
  {
    "text": "already um there's a quick shout out to",
    "start": "1597880",
    "end": "1600200"
  },
  {
    "text": "this tool called Hubble observe this is",
    "start": "1600200",
    "end": "1602159"
  },
  {
    "text": "more user facing so you can look at",
    "start": "1602159",
    "end": "1603840"
  },
  {
    "text": "which identities are talking to what",
    "start": "1603840",
    "end": "1606000"
  },
  {
    "text": "destination identities and if you are a",
    "start": "1606000",
    "end": "1608039"
  },
  {
    "text": "developer and if you want to get more",
    "start": "1608039",
    "end": "1609840"
  },
  {
    "text": "details on why exactly you have a drop",
    "start": "1609840",
    "end": "1612520"
  },
  {
    "text": "you can get references to the exact line",
    "start": "1612520",
    "end": "1614880"
  },
  {
    "text": "number on the BPF code to understand",
    "start": "1614880",
    "end": "1616600"
  },
  {
    "text": "where the drop is coming from",
    "start": "1616600",
    "end": "1620240"
  },
  {
    "text": "all right so hopefully you've got a bit",
    "start": "1623320",
    "end": "1624799"
  },
  {
    "text": "of the picture about how we make",
    "start": "1624799",
    "end": "1626600"
  },
  {
    "text": "scalable policy enforcement by doing as",
    "start": "1626600",
    "end": "1628720"
  },
  {
    "text": "little as we can uh whenever events",
    "start": "1628720",
    "end": "1630960"
  },
  {
    "text": "occur in the in the system um so we",
    "start": "1630960",
    "end": "1632960"
  },
  {
    "text": "talked about how to apply the policy",
    "start": "1632960",
    "end": "1634520"
  },
  {
    "text": "efficiently how to enforce that policy",
    "start": "1634520",
    "end": "1636360"
  },
  {
    "text": "efficiently and how to debug that system",
    "start": "1636360",
    "end": "1638520"
  },
  {
    "text": "efficiently um so if you're interested",
    "start": "1638520",
    "end": "1640320"
  },
  {
    "text": "to discuss more with us come and have a",
    "start": "1640320",
    "end": "1642200"
  },
  {
    "text": "chat with us we have a booth uh and",
    "start": "1642200",
    "end": "1644520"
  },
  {
    "text": "himont she has another talk on",
    "start": "1644520",
    "end": "1645840"
  },
  {
    "text": "scalability later this week uh and of",
    "start": "1645840",
    "end": "1648360"
  },
  {
    "text": "course we'll be happy to receive your",
    "start": "1648360",
    "end": "1650159"
  },
  {
    "text": "feedback on the talk so thank",
    "start": "1650159",
    "end": "1653170"
  },
  {
    "text": "[Applause]",
    "start": "1653170",
    "end": "1656080"
  },
  {
    "text": "you",
    "start": "1656080",
    "end": "1659080"
  }
]