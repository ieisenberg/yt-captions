[
  {
    "text": "um yeah thank you for this uh wonderful opportunity to speak about um some of",
    "start": "1000",
    "end": "6799"
  },
  {
    "text": "the extensions that we have been working on at Ericson and um we are really",
    "start": "6799",
    "end": "11960"
  },
  {
    "text": "thankful to the community and to the contributions and that's why we intended to kind of Upstream this uh particular",
    "start": "11960",
    "end": "19119"
  },
  {
    "text": "extension that we had developed based on some existing implementations that were already there um so this one uh is a",
    "start": "19119",
    "end": "28400"
  },
  {
    "text": "mixture of uh two different concepts so one is um the implementation of the uh",
    "start": "28400",
    "end": "34440"
  },
  {
    "text": "tapping filter uh the grpc tapping sync and the other one is um Hardware",
    "start": "34440",
    "end": "39680"
  },
  {
    "text": "accelerator mem copy which is done by um my colleague yuu from uh",
    "start": "39680",
    "end": "45800"
  },
  {
    "text": "Intel um so just as a background uh what we do um so uh we are a small group of",
    "start": "45800",
    "end": "52879"
  },
  {
    "text": "uh NY developers within Ericson who uh modify extend um Envoy uh http2 fil",
    "start": "52879",
    "end": "59920"
  },
  {
    "text": "filters to fit within the use cases and requirements for a 5G core um Network",
    "start": "59920",
    "end": "67040"
  },
  {
    "text": "function uh so uh in this particular Endeavor uh I was assisted by my dear",
    "start": "67040",
    "end": "73400"
  },
  {
    "text": "colleague spin AKA who couldn't be here due to some reason and um uh also yuu",
    "start": "73400",
    "end": "80439"
  },
  {
    "text": "from Intel who couldn't be here because of some issues",
    "start": "80439",
    "end": "86360"
  },
  {
    "text": "um uh so uh the agenda for today so we would give some background on what was",
    "start": "86360",
    "end": "93640"
  },
  {
    "text": "the um main use case this was uh trying to solve and um why tapping particularly",
    "start": "93640",
    "end": "101560"
  },
  {
    "text": "and then the overview of the existing tapping syns and why we decided to go for a new grpc based tapping sync and",
    "start": "101560",
    "end": "109719"
  },
  {
    "text": "then some additional customizations that we added on top as well um to get some",
    "start": "109719",
    "end": "116240"
  },
  {
    "text": "uh statistics and uh address Fame caching ENT replay um mechanism uh",
    "start": "116240",
    "end": "122280"
  },
  {
    "text": "introduced within that tapping uh filter and then lastly uh it would be regarding",
    "start": "122280",
    "end": "128560"
  },
  {
    "text": "the hardware acceleration for M copies um uh that was done by my colleague",
    "start": "128560",
    "end": "134480"
  },
  {
    "text": "Yu um so starting with uh just to give some background on why we kind of",
    "start": "134480",
    "end": "141080"
  },
  {
    "text": "launched into this whole Endeavor uh so this is how the 5G core Network roughly looks like and it is basically um you",
    "start": "141080",
    "end": "149120"
  },
  {
    "text": "can consider as a service mesh uh with all the interfaces are connected via",
    "start": "149120",
    "end": "155239"
  },
  {
    "text": "http2 and so um um the network functions",
    "start": "155239",
    "end": "160519"
  },
  {
    "text": "on which uh me and my colleagues work on are the ones marked in green which are called uh a service communication proxy",
    "start": "160519",
    "end": "167159"
  },
  {
    "text": "and a security and Edge protection proxy uh both of them use Envoy within for",
    "start": "167159",
    "end": "173800"
  },
  {
    "text": "specific rooting observability or other traffic uh network uh traffic",
    "start": "173800",
    "end": "179800"
  },
  {
    "text": "requirements that we have uh to fulfill within uh a 5G core Network um and so uh let's start with",
    "start": "179800",
    "end": "188640"
  },
  {
    "text": "the uh question itself that we got is um why to trace traffic like um there are",
    "start": "188640",
    "end": "195319"
  },
  {
    "text": "already some existing uh good mechanisms to observe what is happening within a",
    "start": "195319",
    "end": "200360"
  },
  {
    "text": "network for example metrics uh but metrics can only show a",
    "start": "200360",
    "end": "205879"
  },
  {
    "text": "limited information about the certain failure situation as label cannot just go on forever and they cannot also",
    "start": "205879",
    "end": "213200"
  },
  {
    "text": "include complete header body or query information and then um this particular",
    "start": "213200",
    "end": "220239"
  },
  {
    "text": "diagram shows um a particular paino that we have in a in our network uh which is",
    "start": "220239",
    "end": "226640"
  },
  {
    "text": "that we have a multivendor ecosystem and so each vendor comes up with his or her",
    "start": "226640",
    "end": "231879"
  },
  {
    "text": "own implementation of the network function and uh you can assume that um",
    "start": "231879",
    "end": "237879"
  },
  {
    "text": "the orange one is made up of of one particular vendor the blue ones from one uh different one the Green from uh a",
    "start": "237879",
    "end": "245319"
  },
  {
    "text": "third vendor and the gray one from a fourth and so let's say there was some",
    "start": "245319",
    "end": "251319"
  },
  {
    "text": "sort of fault in the uh orange uh colored vendor and it tried to send a",
    "start": "251319",
    "end": "258199"
  },
  {
    "text": "wrong subscribe request to uh the target Upstream uh so let's say you wanted to",
    "start": "258199",
    "end": "265479"
  },
  {
    "text": "isolate somehow uh that this Orange um node was the cause of the problem and",
    "start": "265479",
    "end": "273400"
  },
  {
    "text": "you started looking at the metric and you cannot figure out because metrix only show that you get a",
    "start": "273400",
    "end": "279880"
  },
  {
    "text": "5xx uh from PCF but it doesn't give you any more information than that and",
    "start": "279880",
    "end": "285919"
  },
  {
    "text": "another thing that you can do is raise the log levels uh but then another",
    "start": "285919",
    "end": "291080"
  },
  {
    "text": "beautiful thing about 5G core networks and in live operation is that uh you're pretty much never allowed to raise the",
    "start": "291080",
    "end": "297520"
  },
  {
    "text": "log levels or something by the operator and so there are very little means by",
    "start": "297520",
    "end": "303320"
  },
  {
    "text": "which we can get any meaningful information by uh by uh locks and then",
    "start": "303320",
    "end": "309639"
  },
  {
    "text": "another two methods that we could have is TCP dump or some ebpf based tracing",
    "start": "309639",
    "end": "315280"
  },
  {
    "text": "TCP dump uh on the interface could work but that would involve elevating",
    "start": "315280",
    "end": "320319"
  },
  {
    "text": "privileges which is a big no no and um also ebpf has the same problem",
    "start": "320319",
    "end": "328120"
  },
  {
    "text": "of elevated privileges and other security issues um so all of that makes",
    "start": "328120",
    "end": "334639"
  },
  {
    "text": "um the envoy that sits in this blue SCP uh a prime candidate for observing their",
    "start": "334639",
    "end": "342160"
  },
  {
    "text": "traffic um and um basically going with the um",
    "start": "342160",
    "end": "349240"
  },
  {
    "text": "decision flow that we had to make on how the architecture should look like so",
    "start": "349240",
    "end": "354759"
  },
  {
    "text": "Envoy has both um Ingress and egress um uh custom filters and uh we have our own",
    "start": "354759",
    "end": "362440"
  },
  {
    "text": "specific set of http2 filters that we use for all of our um supporting all of",
    "start": "362440",
    "end": "367599"
  },
  {
    "text": "our use cases and um one of the easiest ways to provide",
    "start": "367599",
    "end": "374319"
  },
  {
    "text": "this http2 information is by simply logging however if there's too many logs",
    "start": "374319",
    "end": "381280"
  },
  {
    "text": "then um the uh uh so this blue processing unit that you see which is",
    "start": "381280",
    "end": "388440"
  },
  {
    "text": "consuming the information for um the traffic it will need to process multiple",
    "start": "388440",
    "end": "394880"
  },
  {
    "text": "log lines and um that would add additional stress to that particular",
    "start": "394880",
    "end": "400479"
  },
  {
    "text": "process So eventually we then decided to start using tapping filter that were",
    "start": "400479",
    "end": "407000"
  },
  {
    "text": "there and um uh we decided to make some experiments with it and try a few things",
    "start": "407000",
    "end": "413880"
  },
  {
    "text": "out and eventually we learned a few things um so uh there are two basic uh",
    "start": "413880",
    "end": "421479"
  },
  {
    "text": "methods by which you can get uh tap uh within nvoy one is via TCP tapping and",
    "start": "421479",
    "end": "427879"
  },
  {
    "text": "the other one is via HTTP um tapping TCP tapping creates um traffic Trace",
    "start": "427879",
    "end": "434520"
  },
  {
    "text": "representations on a TCP event that is on a connection open or close or on",
    "start": "434520",
    "end": "440080"
  },
  {
    "text": "connection read or right HTTP tapping uh on the other hand creates uh traffic",
    "start": "440080",
    "end": "445160"
  },
  {
    "text": "Trace representation on an HTTP event uh on which is a header data trailer encoding",
    "start": "445160",
    "end": "452960"
  },
  {
    "text": "or decoding sequence uh so these basically operate as a call back more or less and um the",
    "start": "452960",
    "end": "461039"
  },
  {
    "text": "main function of tapping is to just um send these internal representation whenever these call backs are",
    "start": "461039",
    "end": "468919"
  },
  {
    "text": "invoked um so uh basically the way I like to think about um filter chains",
    "start": "468919",
    "end": "475720"
  },
  {
    "text": "within enoy is to look at them like U pancakes uh so basically different type of a um",
    "start": "475720",
    "end": "484599"
  },
  {
    "text": "filter functionality represents a different pancake and I like to layer them in a particular",
    "start": "484599",
    "end": "490840"
  },
  {
    "text": "sequence and um say on the Ingress side I like to layer them as TLS and then a",
    "start": "490840",
    "end": "496800"
  },
  {
    "text": "buffer and then the tapping and then I have all my custom http2 filter chains",
    "start": "496800",
    "end": "502960"
  },
  {
    "text": "that sit in the middle uh and then on the egress side we have again our um t",
    "start": "502960",
    "end": "510159"
  },
  {
    "text": "uh transport socket and the buffer transport socket and TLS transport",
    "start": "510159",
    "end": "515399"
  },
  {
    "text": "socket um and um and then um let's look at uh having",
    "start": "515399",
    "end": "525000"
  },
  {
    "text": "more functionality within it uh which is to only Trace selectively on particular",
    "start": "525000",
    "end": "531519"
  },
  {
    "text": "traffic paths so for that we had to extend um some parts of the uh tap",
    "start": "531519",
    "end": "537519"
  },
  {
    "text": "config imple um uh classes within Envoy so as to provide on The Listener side um",
    "start": "537519",
    "end": "544640"
  },
  {
    "text": "uh some sort of filtering based on Source or uh Source IP port and then on the erress side uh we",
    "start": "544640",
    "end": "553399"
  },
  {
    "text": "used um existing Machinery uh which is to use this transport socket matches",
    "start": "553399",
    "end": "559000"
  },
  {
    "text": "filter which has been very handy to um selectively tap uh just the endpoints",
    "start": "559000",
    "end": "565519"
  },
  {
    "text": "that we need so the way uh nvoy works is uh it has a representation called as an",
    "start": "565519",
    "end": "572200"
  },
  {
    "text": "endpoint for each Upstream host that you want to connect to and each of those",
    "start": "572200",
    "end": "577399"
  },
  {
    "text": "endpoints can be selectively matched to a type of a transport socket based on",
    "start": "577399",
    "end": "582760"
  },
  {
    "text": "some metadata that you insert to this transport socket so for example you have",
    "start": "582760",
    "end": "588399"
  },
  {
    "text": "three hosts H1 H2 and H3 uh that you configure in your nvoy filter with um a",
    "start": "588399",
    "end": "595279"
  },
  {
    "text": "certain uh metadata called tap which you set to true for H1 and H3 and for H2 you",
    "start": "595279",
    "end": "602160"
  },
  {
    "text": "set it to false and then you set up two transport sockets uh one of them um uh",
    "start": "602160",
    "end": "609600"
  },
  {
    "text": "enables uh tapping filter when the uh tap metadata is present and the other",
    "start": "609600",
    "end": "615480"
  },
  {
    "text": "one doesn't enable a t filter it just has a robw buffer socket and so in this",
    "start": "615480",
    "end": "620959"
  },
  {
    "text": "way uh on egis you can selectively Trace only the requests that go to H1 and H3",
    "start": "620959",
    "end": "627720"
  },
  {
    "text": "and not to H to um this has been kind of critical for us because um the networks",
    "start": "627720",
    "end": "634440"
  },
  {
    "text": "that we work with have um 400 to 500 upstreams and like equal number of",
    "start": "634440",
    "end": "640279"
  },
  {
    "text": "downstreams and all of them are processing basically your 5G core network uh signaling requests so they",
    "start": "640279",
    "end": "648079"
  },
  {
    "text": "are at uh several million requests per second um across multiple NY nodes so um",
    "start": "648079",
    "end": "657160"
  },
  {
    "text": "we don't want to overload our system with needless tracing and so selectivity has been critical and then finally um uh",
    "start": "657160",
    "end": "667000"
  },
  {
    "text": "the question is basically which um tapping sync to use uh so NY already",
    "start": "667000",
    "end": "672680"
  },
  {
    "text": "offers um uh uh two tapping syncs one is file based and the other one is admin",
    "start": "672680",
    "end": "679279"
  },
  {
    "text": "based um file based tapping syncs are unacceptable for critical use cases with",
    "start": "679279",
    "end": "685600"
  },
  {
    "text": "um security and privacy concerns because they basically F uh dump every uh",
    "start": "685600",
    "end": "691440"
  },
  {
    "text": "information regarding the uh request onto a file and um that would then put",
    "start": "691440",
    "end": "698920"
  },
  {
    "text": "additional uh requirements on the storage and so on so forth so we don't",
    "start": "698920",
    "end": "704360"
  },
  {
    "text": "want to go into that direction admin sync um is the or seem like the prime",
    "start": "704360",
    "end": "711120"
  },
  {
    "text": "candidate that we could have used however on a closer inspection uh",
    "start": "711120",
    "end": "716839"
  },
  {
    "text": "we found out that it had a um bit of an",
    "start": "716839",
    "end": "722160"
  },
  {
    "text": "issue uh so basically uh what we had was a kind of a bottleneck onto the main",
    "start": "722160",
    "end": "727839"
  },
  {
    "text": "thread so um NY has this basic Silo threading approach which is uh quite",
    "start": "727839",
    "end": "734600"
  },
  {
    "text": "fantastic when you want to extend um custom filters they are quite easy to write and um they are quite easy to",
    "start": "734600",
    "end": "741959"
  },
  {
    "text": "understand uh with regards to connection and request lifetimes um however the problem comes",
    "start": "741959",
    "end": "749120"
  },
  {
    "text": "in with this tapping filter that the admin sync is basically existing on the main thread because that's where the",
    "start": "749120",
    "end": "755360"
  },
  {
    "text": "admin interface largely lives and therefore the worker threads had to send these traces back to the uh admin um",
    "start": "755360",
    "end": "764040"
  },
  {
    "text": "interface and that created a bottleneck on the main thread which you can see in the red one uh so this was uh with an",
    "start": "764040",
    "end": "772800"
  },
  {
    "text": "example config with static configuration and um you can see without tapping the",
    "start": "772800",
    "end": "778600"
  },
  {
    "text": "main main thread is hardly activated it is just the stats uh syncing that was",
    "start": "778600",
    "end": "784160"
  },
  {
    "text": "happening and with um admin interface tapping we see that the um CPU",
    "start": "784160",
    "end": "791120"
  },
  {
    "text": "utilization just spikes uh a lot uh and",
    "start": "791120",
    "end": "796480"
  },
  {
    "text": "um we decided to avoid that mainly because we have a custom control plane",
    "start": "796480",
    "end": "802560"
  },
  {
    "text": "and we never wanted our XTS um uh procedures to ever be blocked or our",
    "start": "802560",
    "end": "809120"
  },
  {
    "text": "stats to be uh interrupted um so for that we decided to",
    "start": "809120",
    "end": "815320"
  },
  {
    "text": "go with a new tapping interface uh with the main objective that we don't um",
    "start": "815320",
    "end": "822160"
  },
  {
    "text": "interfere with the main thread as far as possible to stream the uh traces and",
    "start": "822160",
    "end": "827760"
  },
  {
    "text": "then we decided um to build up on the interfaces for the grpc uh tapping sync",
    "start": "827760",
    "end": "835160"
  },
  {
    "text": "uh we took inspiration from an earlier discussion around this topic uh within the community uh within the GitHub and",
    "start": "835160",
    "end": "842680"
  },
  {
    "text": "um uh we uh made a prototype of it and then um yeah um with a custom traffic",
    "start": "842680",
    "end": "851639"
  },
  {
    "text": "sync and with u multiple worker threads initially and then we kind of fine-tuned",
    "start": "851639",
    "end": "857040"
  },
  {
    "text": "it and a lot of other stuff um so basically the um a",
    "start": "857040",
    "end": "863079"
  },
  {
    "text": "fundamental aspect is that um these uh information regarding tapping comes in",
    "start": "863079",
    "end": "868279"
  },
  {
    "text": "two part Parts one is the connection related information which is basically uh Source destination IP and port and",
    "start": "868279",
    "end": "876759"
  },
  {
    "text": "then a connection reference ID that is associated with it and then there are",
    "start": "876759",
    "end": "882199"
  },
  {
    "text": "your actual Trace information which is just Bas 64 encoded header and body",
    "start": "882199",
    "end": "887320"
  },
  {
    "text": "information that would be present in your http2 request um and the trace information",
    "start": "887320",
    "end": "894720"
  },
  {
    "text": "carries a reference to the connection to which it belongs so each connection",
    "start": "894720",
    "end": "900360"
  },
  {
    "text": "information would have a connection ID and that connection ID would be represented within each Trace frame and",
    "start": "900360",
    "end": "907360"
  },
  {
    "text": "then you can do postprocessing on it do it live pretty much and um that is the",
    "start": "907360",
    "end": "913519"
  },
  {
    "text": "cool part uh and um get a more suitable representation for example pcap or peap",
    "start": "913519",
    "end": "920560"
  },
  {
    "text": "NG and uh give it to a post-processing sync or analytics unit which gives you",
    "start": "920560",
    "end": "926639"
  },
  {
    "text": "live bulk tracing information of your entire network uh so uh one shortcoming however",
    "start": "926639",
    "end": "934720"
  },
  {
    "text": "with this uh PR with this thought uh experiment was that say your um sync had",
    "start": "934720",
    "end": "944759"
  },
  {
    "text": "some sort of a disturbance and it had to restart since uh the connection",
    "start": "944759",
    "end": "950440"
  },
  {
    "text": "information was only sent once and later on you're just um giving it some",
    "start": "950440",
    "end": "956600"
  },
  {
    "text": "reference that connection information is essentially lost by the sync on a",
    "start": "956600",
    "end": "961639"
  },
  {
    "text": "restart and so we decided to give a custom handshake procedure and a um",
    "start": "961639",
    "end": "969079"
  },
  {
    "text": "connection uh and an address connection replay uh Machinery which is this",
    "start": "969079",
    "end": "976319"
  },
  {
    "text": "um uh additional uh cache that we introduce within each worker thread uh",
    "start": "976319",
    "end": "982880"
  },
  {
    "text": "basically it's just a map of a connection reference and um a connection",
    "start": "982880",
    "end": "988040"
  },
  {
    "text": "reference ID and the whole connection information and it would be uh populated",
    "start": "988040",
    "end": "995360"
  },
  {
    "text": "basically on an Connection in it and uh basically removed from the cache on a",
    "start": "995360",
    "end": "1000839"
  },
  {
    "text": "connection close which are given via uh very friendly call backs within T config",
    "start": "1000839",
    "end": "1005880"
  },
  {
    "text": "imput and based on that you can uh detect a connection uh termination or",
    "start": "1005880",
    "end": "1012079"
  },
  {
    "text": "disruption via Uh custom handshake sequence or via uh attaching TCP sock",
    "start": "1012079",
    "end": "1018959"
  },
  {
    "text": "properties uh to the client that is uh initiating that grpc",
    "start": "1018959",
    "end": "1024918"
  },
  {
    "text": "push um and then you could replay the connection information to the remote sync and that way um your connection",
    "start": "1024919",
    "end": "1033280"
  },
  {
    "text": "information is always represented uh for all your Trace",
    "start": "1033280",
    "end": "1038360"
  },
  {
    "text": "information um there are some additional options as well uh for example there's",
    "start": "1038360",
    "end": "1043600"
  },
  {
    "text": "buffering option and um there is um uh",
    "start": "1043600",
    "end": "1048640"
  },
  {
    "text": "also uh tapping at the HTTP level however H um the way Silo threading",
    "start": "1048640",
    "end": "1055039"
  },
  {
    "text": "basically works is um at a particular layer it creates um an object so since",
    "start": "1055039",
    "end": "1061640"
  },
  {
    "text": "we are dealing with uh traffic that are mostly low in number of connection but",
    "start": "1061640",
    "end": "1066799"
  },
  {
    "text": "high in number of requests we don't want to create too many objects by uh spawning an HTTP uh level tapping filter",
    "start": "1066799",
    "end": "1074760"
  },
  {
    "text": "so we instead went with this uh connection level uh tapping filter uh and also um live streaming uh",
    "start": "1074760",
    "end": "1083760"
  },
  {
    "text": "rather than buffering meant that we could see uh the traffic as it was getting processed on the Ingress and",
    "start": "1083760",
    "end": "1090880"
  },
  {
    "text": "eress of the nway side and um another thing that we added",
    "start": "1090880",
    "end": "1097320"
  },
  {
    "text": "was the capability to observe um um the traces that we were producing and",
    "start": "1097320",
    "end": "1103679"
  },
  {
    "text": "produce some uh statistics for it we had a similar counterpart for our tracing uh",
    "start": "1103679",
    "end": "1110039"
  },
  {
    "text": "sync um uh for um Counting similar number of Trace events and stuff and",
    "start": "1110039",
    "end": "1117000"
  },
  {
    "text": "that's the way we ensured that um on live networks we had a consistency of what we were intending to",
    "start": "1117000",
    "end": "1124520"
  },
  {
    "text": "tap and um overall we were quite happy with the tracing solution that we",
    "start": "1124520",
    "end": "1130120"
  },
  {
    "text": "developed um the overhead introduced by the tapping system was roughly was",
    "start": "1130120",
    "end": "1135559"
  },
  {
    "text": "lesser than 5% in our Max RPS capacity capity for one eny um node and end to",
    "start": "1135559",
    "end": "1144120"
  },
  {
    "text": "end latency with tapping enabled on multiple listeners and cluster was in the order of uh 1 to 2 milliseconds",
    "start": "1144120",
    "end": "1150840"
  },
  {
    "text": "however uh this has to be taken with um big conditions applied it depends on uh",
    "start": "1150840",
    "end": "1156120"
  },
  {
    "text": "what is the loading condition what is the network setup all that but um it was",
    "start": "1156120",
    "end": "1162480"
  },
  {
    "text": "quite good uh for uh Telecom based application so it is uh",
    "start": "1162480",
    "end": "1170000"
  },
  {
    "text": "really working quite well and it has been extremely stable in production networks with some of the notes being",
    "start": "1170000",
    "end": "1177080"
  },
  {
    "text": "deployed uh since day one um couple of uh at least three or four quart quarters",
    "start": "1177080",
    "end": "1182840"
  },
  {
    "text": "back and um with uh several hundred thousand to few million requests per",
    "start": "1182840",
    "end": "1188440"
  },
  {
    "text": "seconds being traced in live iGo networks and for the Hardway",
    "start": "1188440",
    "end": "1195880"
  },
  {
    "text": "acceleration part I um would like to present um a recorded video by my",
    "start": "1195880",
    "end": "1202240"
  },
  {
    "text": "colleague uh who would explain further details about",
    "start": "1202240",
    "end": "1207440"
  },
  {
    "text": "this",
    "start": "1213240",
    "end": "1216240"
  },
  {
    "text": "sorry",
    "start": "1219600",
    "end": "1222600"
  },
  {
    "text": "oh everyone this is eel from Intel very",
    "start": "1227159",
    "end": "1234039"
  },
  {
    "text": "glad to share this topic with that to you at invo call unfortunately for some",
    "start": "1234039",
    "end": "1240159"
  },
  {
    "text": "reason I can't draw you today in Chicago so I got to share my part from",
    "start": "1240159",
    "end": "1245360"
  },
  {
    "text": "video now let's let me continue our session on Hardware",
    "start": "1245360",
    "end": "1250520"
  },
  {
    "text": "acceleration as you may know for most cases memory copy is not a problem for",
    "start": "1250520",
    "end": "1256600"
  },
  {
    "text": "enloy request and response are limited to a few kilobytes in size and won't",
    "start": "1256600",
    "end": "1262000"
  },
  {
    "text": "take much time in the overall proide but for some special scenarios",
    "start": "1262000",
    "end": "1267520"
  },
  {
    "text": "and requirements things are different like traffic mirror a feature",
    "start": "1267520",
    "end": "1273960"
  },
  {
    "text": "allow user shattering traffic from one cluster to another this is a very useful feature",
    "start": "1273960",
    "end": "1280559"
  },
  {
    "text": "that allows feature teams to bring changes to production with as little",
    "start": "1280559",
    "end": "1286039"
  },
  {
    "text": "risk as possible and why we make a copy of live request",
    "start": "1286039",
    "end": "1291279"
  },
  {
    "text": "data to mirror service with increasing request size the",
    "start": "1291279",
    "end": "1296840"
  },
  {
    "text": "data copied can be quite sub substantial and another example is TOS",
    "start": "1296840",
    "end": "1303559"
  },
  {
    "text": "memory linearize this is an operation defined in buffer system occurs before",
    "start": "1303559",
    "end": "1309520"
  },
  {
    "text": "TS encryption is applied lariz copy and recombining",
    "start": "1309520",
    "end": "1315679"
  },
  {
    "text": "multiple small size buffer into a large one to reduce the frequency of",
    "start": "1315679",
    "end": "1321520"
  },
  {
    "text": "encryption and Associated over attack for large side response lariz",
    "start": "1321520",
    "end": "1328159"
  },
  {
    "text": "also come with a significant amount of Caray which can up to 10% of overall",
    "start": "1328159",
    "end": "1334960"
  },
  {
    "text": "processing our test and for traffic tapping our topic",
    "start": "1334960",
    "end": "1341520"
  },
  {
    "text": "today memory copy is also a crucial issue that cannot be ignored when it",
    "start": "1341520",
    "end": "1347600"
  },
  {
    "text": "comes to a large request or response tying filter would make a copy",
    "start": "1347600",
    "end": "1353600"
  },
  {
    "text": "of all traffic to generate Pro buffer fail then save it locally or send to",
    "start": "1353600",
    "end": "1359559"
  },
  {
    "text": "remote service for later analysis this scenario perer more",
    "start": "1359559",
    "end": "1364919"
  },
  {
    "text": "intensively copy compared to previous scenarios based on our observation the",
    "start": "1364919",
    "end": "1372559"
  },
  {
    "text": "proportion of Copic up to 20% of entire process in some cases",
    "start": "1372559",
    "end": "1379080"
  },
  {
    "text": "so we believe it can be a scenario suitable for Hardware",
    "start": "1379080",
    "end": "1384960"
  },
  {
    "text": "acceleration now let's have a brief into Hardware we're using for",
    "start": "1387080",
    "end": "1392400"
  },
  {
    "text": "acceleration Thea sh for data streaming accelerator is a PCI device integrate in",
    "start": "1392400",
    "end": "1399640"
  },
  {
    "text": "First Generation Z processor as well of the accelerator it's already hit the market",
    "start": "1399640",
    "end": "1406000"
  },
  {
    "text": "this year there support a series of memory copy operations like move the",
    "start": "1406000",
    "end": "1412320"
  },
  {
    "text": "memory copy dcast copy data from one address to another two addresses at once",
    "start": "1412320",
    "end": "1419400"
  },
  {
    "text": "and so on one thing we should know about the factors that effect memory operator",
    "start": "1419400",
    "end": "1425919"
  },
  {
    "text": "acceleration is the copy side is the key value when the copy side exceed a",
    "start": "1425919",
    "end": "1432520"
  },
  {
    "text": "certain range like 200 kilobytes we can expect benefit from",
    "start": "1432520",
    "end": "1439480"
  },
  {
    "text": "DSA otherwise using CPU is a better idea so there's also an issue we taking",
    "start": "1439480",
    "end": "1447360"
  },
  {
    "text": "into consideration in our acceleration",
    "start": "1447360",
    "end": "1451520"
  },
  {
    "text": "test then let's consider the issue of integration the provides two kinds of",
    "start": "1453799",
    "end": "1460440"
  },
  {
    "text": "Library allow us to offload at two levels DML a library work set at",
    "start": "1460440",
    "end": "1467840"
  },
  {
    "text": "application Level or using dto shout for DSA transparent offload library at a",
    "start": "1467840",
    "end": "1474799"
  },
  {
    "text": "library level the advantage of using DML is that",
    "start": "1474799",
    "end": "1480440"
  },
  {
    "text": "we can Pressly control every single copy but the draw back is you need very",
    "start": "1480440",
    "end": "1487240"
  },
  {
    "text": "best knowledge on how acceleration can help as we say before in many cases it",
    "start": "1487240",
    "end": "1494360"
  },
  {
    "text": "is not a good idea to upload small side copy p and another downside is the",
    "start": "1494360",
    "end": "1501679"
  },
  {
    "text": "modification to the code increase complexity and maintenance costs that",
    "start": "1501679",
    "end": "1507640"
  },
  {
    "text": "may out of our control so what we want to use is a",
    "start": "1507640",
    "end": "1514320"
  },
  {
    "text": "transparent non intrusive approach we hope that Library works at a",
    "start": "1514320",
    "end": "1520960"
  },
  {
    "text": "low level determine if each Cy operation is suitable for",
    "start": "1520960",
    "end": "1526679"
  },
  {
    "text": "acceleration if the copy site above the St hold we set",
    "start": "1526679",
    "end": "1532480"
  },
  {
    "text": "offloaded otherwise give it back to CPU to do it and that is exactly how detail",
    "start": "1532480",
    "end": "1541480"
  },
  {
    "text": "works the detail is preloaded within vo by environment variable and intercept AR",
    "start": "1541480",
    "end": "1548799"
  },
  {
    "text": "memory copy function to g liip c all the copies are classified into two",
    "start": "1548799",
    "end": "1555640"
  },
  {
    "text": "categories based on size small ones to CPU large one to",
    "start": "1555640",
    "end": "1561679"
  },
  {
    "text": "DSA in the whole process we don't have to mess with the code and Rec compel it",
    "start": "1561679",
    "end": "1569279"
  },
  {
    "text": "all the offload are transparent to invoid so that's the",
    "start": "1569279",
    "end": "1576120"
  },
  {
    "text": "plan next let's see how we perform our test and what we got from the",
    "start": "1577440",
    "end": "1584440"
  },
  {
    "text": "acceleration we design our test using TCP tapping with HTP 1.1 protocol when s",
    "start": "1584440",
    "end": "1592159"
  },
  {
    "text": "Clans connect concurrently Fields requested by Clan which is the body of the response from",
    "start": "1592159",
    "end": "1599120"
  },
  {
    "text": "aoy ranging from 64 kiloby to 1 megabytes in",
    "start": "1599120",
    "end": "1604880"
  },
  {
    "text": "size we also use direct response which means the Eno responds directly with the",
    "start": "1604880",
    "end": "1611399"
  },
  {
    "text": "prepare fi in once instead of communicating with Upstream cluster that",
    "start": "1611399",
    "end": "1618279"
  },
  {
    "text": "will significantly increase the proportion of the memory copy overall",
    "start": "1618279",
    "end": "1624240"
  },
  {
    "text": "process we have two groups one for CPU another using dto with",
    "start": "1624240",
    "end": "1631679"
  },
  {
    "text": "DSA the dto r hold is set to 256 kilobytes which means it will only",
    "start": "1631679",
    "end": "1638799"
  },
  {
    "text": "upload for copy site above",
    "start": "1638799",
    "end": "1643080"
  },
  {
    "text": "256 and for the result as sh in the diagram CPU got an advantage initially",
    "start": "1644360",
    "end": "1652799"
  },
  {
    "text": "and the copy size increased the running neck and neck at",
    "start": "1652799",
    "end": "1658159"
  },
  {
    "text": "256 following that DSC got better latency than CPU which align with our",
    "start": "1658159",
    "end": "1665519"
  },
  {
    "text": "prediction and understanding on Thea that we got more performance benefit",
    "start": "1665519",
    "end": "1670679"
  },
  {
    "text": "from bigger cop size you might have questions about the",
    "start": "1670679",
    "end": "1675799"
  },
  {
    "text": "performance difference below to6 say both are CPU based operations",
    "start": "1675799",
    "end": "1684039"
  },
  {
    "text": "why is such a difference observed I think that may comes from the",
    "start": "1684039",
    "end": "1689200"
  },
  {
    "text": "interception overhead intercept and determine which way to use need to take some CP",
    "start": "1689200",
    "end": "1697720"
  },
  {
    "text": "resource and finally let's look at what would happen for Hardware memory",
    "start": "1702919",
    "end": "1708679"
  },
  {
    "text": "acceleration and what we can expect it first from a hardware perspective DSC",
    "start": "1708679",
    "end": "1718279"
  },
  {
    "text": "is back to a persistent feature in future generation of Z",
    "start": "1718279",
    "end": "1724120"
  },
  {
    "text": "products so it may be faster or support more upload operations that we can",
    "start": "1724120",
    "end": "1730279"
  },
  {
    "text": "introduce intoo acceleration and second for aoid our",
    "start": "1730279",
    "end": "1738519"
  },
  {
    "text": "software level as a community is still exploring the potential of enoy many new",
    "start": "1738519",
    "end": "1745760"
  },
  {
    "text": "scenarios and projects that can VI Gateway or something",
    "start": "1745760",
    "end": "1751320"
  },
  {
    "text": "emerging so it will be reason to expect there are more suitable cases like CDN",
    "start": "1751320",
    "end": "1758200"
  },
  {
    "text": "or something for void to do acceleration so that's all for my",
    "start": "1758200",
    "end": "1764159"
  },
  {
    "text": "sharing thank you for your listening",
    "start": "1764159",
    "end": "1769320"
  },
  {
    "text": "uh thank you for the um uh kind listening and um regarding the um status",
    "start": "1775440",
    "end": "1784679"
  },
  {
    "text": "so we had introduced an RFC a while back to Upstream this uh tapping filter and",
    "start": "1784679",
    "end": "1791600"
  },
  {
    "text": "um unfortunately due to other commitments I couldn't continue with it",
    "start": "1791600",
    "end": "1797080"
  },
  {
    "text": "at that time uh however we are planning to push it um continue working on it",
    "start": "1797080",
    "end": "1802600"
  },
  {
    "text": "soon and submit the patches um but sometime in 2024 hopefully",
    "start": "1802600",
    "end": "1810440"
  },
  {
    "text": "and yeah that's about it if there are any questions or comments",
    "start": "1810440",
    "end": "1818240"
  },
  {
    "text": "um we're kind of up against okay should we take one we're kind of up against time after that you might have to do the",
    "start": "1819200",
    "end": "1824240"
  },
  {
    "text": "rest offline um have you considered like more traditional sort of tracing you you",
    "start": "1824240",
    "end": "1830159"
  },
  {
    "text": "you mentioned tracing quite a lot here but so so so that's why I'm asking like open t lemetry Tracer there are other",
    "start": "1830159",
    "end": "1836760"
  },
  {
    "text": "HTTP tracing uh plugins in Envoy and if you have considered like",
    "start": "1836760",
    "end": "1843480"
  },
  {
    "text": "why why could you use them why why did you need to go into the route of actually you know tapping the full",
    "start": "1843480",
    "end": "1851080"
  },
  {
    "text": "request um yeah so one reason because the distributed uh tracing requirements",
    "start": "1851080",
    "end": "1858799"
  },
  {
    "text": "were slightly different than what we had in mind for this um this particular uh",
    "start": "1858799",
    "end": "1865519"
  },
  {
    "text": "tracing requirement was basically um to be as uh low overhead as possible and um",
    "start": "1865519",
    "end": "1874440"
  },
  {
    "text": "to uh consistently give out um uh the representation for the HTTP request in a",
    "start": "1874440",
    "end": "1882039"
  },
  {
    "text": "p peap or peap NG format so that meant that we had to do quite a lot of",
    "start": "1882039",
    "end": "1887679"
  },
  {
    "text": "postprocessing outside of envoy and so we needed to get some sort of a representation for that and",
    "start": "1887679",
    "end": "1895600"
  },
  {
    "text": "um the um open Telemetry based um",
    "start": "1895600",
    "end": "1901120"
  },
  {
    "text": "Solutions didn't exactly fit this one so rather what um fits that kind of a use",
    "start": "1901120",
    "end": "1907799"
  },
  {
    "text": "case is really tapping syns and so we had to use",
    "start": "1907799",
    "end": "1914278"
  },
  {
    "text": "that um cool thank you if there's any more questions uh I guess you'd probably have",
    "start": "1916159",
    "end": "1922799"
  },
  {
    "text": "to catch Dean after thank you so much but thank you great for the [Applause]",
    "start": "1922799",
    "end": "1929440"
  },
  {
    "text": "talk",
    "start": "1929440",
    "end": "1932440"
  }
]