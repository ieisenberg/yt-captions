[
  {
    "text": "hello everybody my name is Maya LaVine I'm a product manager here at cig and today",
    "start": "399",
    "end": "8120"
  },
  {
    "text": "I'm going to talk to you about real Cloud security breaches that have occurred and how you can prevent them",
    "start": "8120",
    "end": "14440"
  },
  {
    "text": "from happening to you basically and I want to do a quick disclaimer if your company is one of the ones that are",
    "start": "14440",
    "end": "20039"
  },
  {
    "text": "mentioned here I apologize in advance for the ptsc that I'm probably bringing on but in all seriousness I do feel that",
    "start": "20039",
    "end": "28439"
  },
  {
    "text": "as an industry we should should be as open as possible about why and how breaches have occurred I never shame",
    "start": "28439",
    "end": "35320"
  },
  {
    "text": "anybody for being the victim of a breach especially because they're only becoming more and more",
    "start": "35320",
    "end": "41079"
  },
  {
    "text": "common in fact a Verizon 2021 report showed that cloud assets are actually",
    "start": "41079",
    "end": "47199"
  },
  {
    "text": "starting to become more targeted than on premise assets for breaches and if we",
    "start": "47199",
    "end": "52640"
  },
  {
    "text": "think about some of the more major attacks in the cloud versus on premise let's start with ransomware on premise",
    "start": "52640",
    "end": "59640"
  },
  {
    "text": "it's usually a fishing email but in the cloud It's All About Storage databases",
    "start": "59640",
    "end": "65119"
  },
  {
    "text": "and there's many different paths that attackers can take to get there could be misconfigurations or overly permissive",
    "start": "65119",
    "end": "72040"
  },
  {
    "text": "policies and when we think of supply chain compromises it's arguably a lot",
    "start": "72040",
    "end": "77119"
  },
  {
    "text": "easier to execute those in the cloud because of the modern way that applications are being built with many",
    "start": "77119",
    "end": "83640"
  },
  {
    "text": "services and it's just harder to tell kind of what is using what and finally",
    "start": "83640",
    "end": "89400"
  },
  {
    "text": "crypto mining cloud is probably the perfect breeding ground for crypto mining attacks due to the infinite",
    "start": "89400",
    "end": "96119"
  },
  {
    "text": "amount of elastic compute that most users have access to so jumping right in to our first",
    "start": "96119",
    "end": "103360"
  },
  {
    "text": "attack the focus on this one is ransomware and unlike in Austin Powers",
    "start": "103360",
    "end": "108520"
  },
  {
    "text": "it's never really a laughing matter in this case the victim was onus",
    "start": "108520",
    "end": "114360"
  },
  {
    "text": "which is one of the biggest cryptocurrency Platforms in Vietnam and attackers were able to exploit a log for",
    "start": "114360",
    "end": "121200"
  },
  {
    "text": "J vulnerability in a cyclo server of onus and they left back doors behind and",
    "start": "121200",
    "end": "126759"
  },
  {
    "text": "named them kworker for the purpose of disguising as the Linux operating systems kworker",
    "start": "126759",
    "end": "133000"
  },
  {
    "text": "service and that was used as a tunnel to connect back to their command and control server via SSH which is a wise",
    "start": "133000",
    "end": "140040"
  },
  {
    "text": "way to avoid detection so the attackers established a remote shell and discovered a a",
    "start": "140040",
    "end": "147440"
  },
  {
    "text": "configuration file which held AWS credentials now these credentials had",
    "start": "147440",
    "end": "152760"
  },
  {
    "text": "full access permissions so using them the attackers were able to access S3",
    "start": "152760",
    "end": "158720"
  },
  {
    "text": "buckets and continue with an extortion scheme the next day onus discovered that",
    "start": "158720",
    "end": "165239"
  },
  {
    "text": "customer data had been deleted from their S3 buckets and so of course at this point they deactivated all of the",
    "start": "165239",
    "end": "171720"
  },
  {
    "text": "access keys but at that point it was already too late they received a ransom",
    "start": "171720",
    "end": "177080"
  },
  {
    "text": "request from the attackers via Telegram for5 million us now they declined this request and",
    "start": "177080",
    "end": "185480"
  },
  {
    "text": "had to go and disclose the breed to their customers and find and remove all of the nodes that had back doors in",
    "start": "185480",
    "end": "193120"
  },
  {
    "text": "them and ransomware has been around for years now that's because cyber criminals",
    "start": "193120",
    "end": "199159"
  },
  {
    "text": "know that companies hate seeing their operations grind to a halt the financial incentive is definitely still there and",
    "start": "199159",
    "end": "206080"
  },
  {
    "text": "there were a few failures which allowed this specific breach to happen the first was that the system was not patched for",
    "start": "206080",
    "end": "211959"
  },
  {
    "text": "log for J but this really wasn't on us' fault because they actually patched as",
    "start": "211959",
    "end": "217000"
  },
  {
    "text": "soon as cyclos released one it was just too late by that point they had already been compromised so I think it's more",
    "start": "217000",
    "end": "224000"
  },
  {
    "text": "noteworthy that they had very overly permissive access keys this is really",
    "start": "224000",
    "end": "229200"
  },
  {
    "text": "what enabled the attackers to overwrite and delete the information from the S3",
    "start": "229200",
    "end": "234599"
  },
  {
    "text": "buckets and the impact here is that 2 million onuses users had their personal",
    "start": "234599",
    "end": "239879"
  },
  {
    "text": "information leaked including government IDs and password hashes and if we think",
    "start": "239879",
    "end": "245400"
  },
  {
    "text": "of gdpr for example this could result in massive fines if they were within the",
    "start": "245400",
    "end": "251000"
  },
  {
    "text": "scope this chart here is showing the fines levied by ddpr in the past few",
    "start": "251000",
    "end": "256160"
  },
  {
    "text": "years and we can see that the number is just getting higher and higher so that's another thing to worry about when it",
    "start": "256160",
    "end": "261840"
  },
  {
    "text": "comes to ransomware attacks so what can we learn from this",
    "start": "261840",
    "end": "267280"
  },
  {
    "text": "attack the first is that you should pass PCH as soon as you can uh but like I",
    "start": "267280",
    "end": "272360"
  },
  {
    "text": "mentioned in this case log for J went from announcement to being weaponized faster than vendors could release",
    "start": "272360",
    "end": "279039"
  },
  {
    "text": "patches so if you are waiting for a patch consider other mitigating controls",
    "start": "279039",
    "end": "284759"
  },
  {
    "text": "something like a web application firewall could have filtered out log for Jay and finally overly permissive is a",
    "start": "284759",
    "end": "293160"
  },
  {
    "text": "gift that you are giving to attackers if they manage to find a way into your environment and everything is kind of",
    "start": "293160",
    "end": "300000"
  },
  {
    "text": "freefor all for them then they're really going to wreak havoc and move laterally and escalate very",
    "start": "300000",
    "end": "307360"
  },
  {
    "text": "quickly for attack number two the focus is on compromise credentials and",
    "start": "307360",
    "end": "312680"
  },
  {
    "text": "unfortunately it didn't really take me very long to find a real life example of this on the internet uh yeah turns out",
    "start": "312680",
    "end": "320319"
  },
  {
    "text": "people think it's okay to post their credit cards on social media with the security codes and I am not saying that",
    "start": "320319",
    "end": "328080"
  },
  {
    "text": "developers would do anything like this but there are many ways that credentials",
    "start": "328080",
    "end": "333319"
  },
  {
    "text": "can be compromised and there have been known cases of accidentally posting",
    "start": "333319",
    "end": "339319"
  },
  {
    "text": "credentials in public code now the MDR expel discovered this",
    "start": "339319",
    "end": "344919"
  },
  {
    "text": "attack on one of their customers and it all started with the root user's access key that was leaked it was never",
    "start": "344919",
    "end": "351120"
  },
  {
    "text": "determined how but the attacker used these access keys to generate ec2 SSH",
    "start": "351120",
    "end": "358120"
  },
  {
    "text": "keys and then spin up ec2 instances with the Run instances",
    "start": "358120",
    "end": "363600"
  },
  {
    "text": "API they created new security groups and allowed inbound access from the internet",
    "start": "363600",
    "end": "369800"
  },
  {
    "text": "and then these instances began to communicate with the known cryptocurrency server Monero hash so one",
    "start": "369800",
    "end": "376880"
  },
  {
    "text": "leaked root access key allowed attackers to spin up SSH keys in AWS which allowed",
    "start": "376880",
    "end": "383960"
  },
  {
    "text": "them to install the crypto Miner remotely and I do want to mention that",
    "start": "383960",
    "end": "389000"
  },
  {
    "text": "abusing a leaked access key especially a root access key can allow an attacker to",
    "start": "389000",
    "end": "395000"
  },
  {
    "text": "create a very large amount of new instances likely way more than the",
    "start": "395000",
    "end": "400560"
  },
  {
    "text": "victim would ever create on their own and likely so many that will generate a",
    "start": "400560",
    "end": "405639"
  },
  {
    "text": "bill that is the stuff of nightmares for most people in this room so the takeaways here are really",
    "start": "405639",
    "end": "414280"
  },
  {
    "text": "understand that Secrets management is a critical part of operating in the cloud",
    "start": "414280",
    "end": "419360"
  },
  {
    "text": "but but alongside that you also need realtime monitoring of your environment",
    "start": "419360",
    "end": "424599"
  },
  {
    "text": "to understand if malicious activity is occurring using those secrets and the",
    "start": "424599",
    "end": "429960"
  },
  {
    "text": "realtime part is super key because it actually doesn't take attackers very long to generate huge bills if they have",
    "start": "429960",
    "end": "438160"
  },
  {
    "text": "the right access and in this specific attack real-time monitoring could have",
    "start": "438160",
    "end": "443560"
  },
  {
    "text": "notifi the the victim that suspicious SSH key pairs were being generated and",
    "start": "443560",
    "end": "450000"
  },
  {
    "text": "that the instances were communicating with known cryptocurrency",
    "start": "450000",
    "end": "455319"
  },
  {
    "text": "servers for aack number three I really love the example of a poisoned well this",
    "start": "455919",
    "end": "461759"
  },
  {
    "text": "attack is an a supply chain compromise via a malicious image distribution and just like an",
    "start": "461759",
    "end": "468879"
  },
  {
    "text": "unsuspecting villager who goes to drink from a well that has been poisoned developers are unknowingly using images",
    "start": "468879",
    "end": "476400"
  },
  {
    "text": "that are actually malicious that have been planted as traps in public repositories and this happened back in",
    "start": "476400",
    "end": "483840"
  },
  {
    "text": "2020 an attacker utilized an Amazon machine image or Ami which is basically",
    "start": "483840",
    "end": "490319"
  },
  {
    "text": "just a prepackaged ec2 instance in this case it was a Windows Server 2008",
    "start": "490319",
    "end": "495879"
  },
  {
    "text": "instance and they took their malicious Ami and put it in the AWS Marketplace",
    "start": "495879",
    "end": "501280"
  },
  {
    "text": "which is a very public well um and by embedding a crypto Miner in their Ami",
    "start": "501280",
    "end": "507639"
  },
  {
    "text": "they basically can generate passive income if anybody happens to use this instance when it gets started up a",
    "start": "507639",
    "end": "514760"
  },
  {
    "text": "script placed by the threat actor will run crypto miners in the background so",
    "start": "514760",
    "end": "520039"
  },
  {
    "text": "for an attacker this is definitely a low effort High reward type of",
    "start": "520039",
    "end": "526880"
  },
  {
    "text": "attack and in Cy's latest Cloud native threat report we found that it's not just Amazon images that people need to",
    "start": "526880",
    "end": "533600"
  },
  {
    "text": "worry about there's a lot of places where malicious images can be put and a lot of different malicious image",
    "start": "533600",
    "end": "539480"
  },
  {
    "text": "categories other than crypto mining which as you can see is definitely the top of all the categories because of how",
    "start": "539480",
    "end": "546320"
  },
  {
    "text": "easy it is to execute for attackers but I think it's interesting to look at how Global events can affect",
    "start": "546320",
    "end": "554360"
  },
  {
    "text": "these kinds of Trends so the most popular incentive for attacks is obviously financial gain but the second",
    "start": "554360",
    "end": "561880"
  },
  {
    "text": "most popular one that we see is espionage or political objectives and",
    "start": "561880",
    "end": "567519"
  },
  {
    "text": "the goals of disrupting it infrastructure or utilities have led to a four-fold increase in DOS attacks uh",
    "start": "567519",
    "end": "576640"
  },
  {
    "text": "since the start of the conflict between Ukraine and Russia so dos agents are",
    "start": "576640",
    "end": "581760"
  },
  {
    "text": "often added to botnets which attackers can use as their dos as a service",
    "start": "581760",
    "end": "587600"
  },
  {
    "text": "operation what's interesting here is that containers were actually used in this conflict to quickly crowdsource",
    "start": "587600",
    "end": "594800"
  },
  {
    "text": "participation in these attacks a container image would be set up with all of the tools that an attacker needs to",
    "start": "594800",
    "end": "601800"
  },
  {
    "text": "join a malicious campaign with basically no prior technical knowledge and this is something that we haven't really seen",
    "start": "601800",
    "end": "609920"
  },
  {
    "text": "before so really only look for trusted sources when it comes for images that",
    "start": "611360",
    "end": "617320"
  },
  {
    "text": "you're using and even if it's coming from a trusted Source runtime security",
    "start": "617320",
    "end": "622760"
  },
  {
    "text": "tools should be installed on these instances to ensure that no malicious activity is occurring",
    "start": "622760",
    "end": "631160"
  },
  {
    "text": "now for attack number four I want everybody to consider what happens when you build something with really faulty",
    "start": "632079",
    "end": "639800"
  },
  {
    "text": "foundations in the case of a home I would say this is probably worst case scenario but in the case of modern",
    "start": "639800",
    "end": "647040"
  },
  {
    "text": "applications using open source software and other dependencies as your building",
    "start": "647040",
    "end": "652240"
  },
  {
    "text": "blocks as your foundations if you're unknowingly using something malicious this can lead to",
    "start": "652240",
    "end": "658440"
  },
  {
    "text": "really bad effects down the line and pytorch which is a very popular and",
    "start": "658440",
    "end": "664040"
  },
  {
    "text": "widely used python-based machine learning library fell victim to this",
    "start": "664040",
    "end": "669600"
  },
  {
    "text": "kind of supply chain compromise in December of 2022 so it turns out that pytorch",
    "start": "669600",
    "end": "676279"
  },
  {
    "text": "Imports some of its dependencies based on the piie index and they assume that",
    "start": "676279",
    "end": "681639"
  },
  {
    "text": "the most popular one is the one that they should use so an attacker uploaded",
    "start": "681639",
    "end": "686880"
  },
  {
    "text": "a poison piie dependency that hid under the real dependency name torch Triton",
    "start": "686880",
    "end": "693920"
  },
  {
    "text": "and this Trojan version of torch Triton behaved exactly the same as the original",
    "start": "693920",
    "end": "699519"
  },
  {
    "text": "except it also had extra code to exfiltrate sensitive information to a command and control",
    "start": "699519",
    "end": "706120"
  },
  {
    "text": "server now this issue persisted for 5 days but thankfully never made it into",
    "start": "706120",
    "end": "711839"
  },
  {
    "text": "the stable version of pytorch and really this happened because",
    "start": "711839",
    "end": "717079"
  },
  {
    "text": "of the blind Trust of the PIP Pi repository index for a dependency uh",
    "start": "717079",
    "end": "722360"
  },
  {
    "text": "this kid learned the hard way blind trust not a great idea in the cyber world also I think we should hold that",
    "start": "722360",
    "end": "729920"
  },
  {
    "text": "um really there's a lot of layers of dependencies in modern applications especially ones that are use using open-",
    "start": "729920",
    "end": "736440"
  },
  {
    "text": "Source software and that means that there's a lot of vulnerable points and a",
    "start": "736440",
    "end": "741920"
  },
  {
    "text": "clever attacker was able to exploit this trust relationship to get their own code",
    "start": "741920",
    "end": "747560"
  },
  {
    "text": "into pytorch and the malicious version of pytorch was",
    "start": "747560",
    "end": "752959"
  },
  {
    "text": "downloaded over 2,000 times in this 5day period that is not an insignificant",
    "start": "752959",
    "end": "759000"
  },
  {
    "text": "amount and we're only going to learn of subsequent incidences and the true impact here as time goes on because some",
    "start": "759000",
    "end": "767519"
  },
  {
    "text": "of that exfiltrated data included credentials and keys and as I previously stated that can be a starting point for",
    "start": "767519",
    "end": "775199"
  },
  {
    "text": "another attack so keep in mind that any code",
    "start": "775199",
    "end": "781240"
  },
  {
    "text": "that isn't totally under your Project's control runs some kind of risk and this",
    "start": "781240",
    "end": "787240"
  },
  {
    "text": "isn't just limited to open source software commercial closed Source software is also vulnerable we can think",
    "start": "787240",
    "end": "793680"
  },
  {
    "text": "of solar winds as the most obvious example so you need to operate under a",
    "start": "793680",
    "end": "799120"
  },
  {
    "text": "trust but verify mentality meaning trust a package enough to use it only if you",
    "start": "799120",
    "end": "807000"
  },
  {
    "text": "can verify that it's behaving as a it should and for this you need security",
    "start": "807000",
    "end": "812320"
  },
  {
    "text": "testing static analysis can be really good for helping you define unwanted code but there are ways of fooling it",
    "start": "812320",
    "end": "819760"
  },
  {
    "text": "what's harder to trick is dynamic or runtime analysis which looks at the actual behavior of an application in the",
    "start": "819760",
    "end": "827320"
  },
  {
    "text": "case of pytorch they could have detected the connection to the command and control",
    "start": "827320",
    "end": "833120"
  },
  {
    "text": "server and I think it's worth noting that the best way of doing this verification is as close to the",
    "start": "833120",
    "end": "839320"
  },
  {
    "text": "developer push is possible the earlier you find out the better it is and I'm sure there are many sessions this week",
    "start": "839320",
    "end": "846480"
  },
  {
    "text": "this week on shift left so I'm not going to get into it all right attack number five we're",
    "start": "846480",
    "end": "853279"
  },
  {
    "text": "focusing on a threat actor group that's just like Wy coyote they're not too sophisticated lots of Brute Force",
    "start": "853279",
    "end": "860600"
  },
  {
    "text": "explosive methods and really have an affinity for TNT since they used it in their name looking at a very quick very",
    "start": "860600",
    "end": "869279"
  },
  {
    "text": "summarized history of this group they started in 2019 by targeting reddis uh",
    "start": "869279",
    "end": "875079"
  },
  {
    "text": "there was a high rate of misconfigured misconfigurations and vulnerabilities and the exploit was part",
    "start": "875079",
    "end": "882320"
  },
  {
    "text": "of met exploit so they targeted them for crypto",
    "start": "882320",
    "end": "887360"
  },
  {
    "text": "Mining and a few years later they moved on to the next easiest Target people",
    "start": "887360",
    "end": "893079"
  },
  {
    "text": "leave their Docker API endpoints exposed which allows anyone anywhere to run",
    "start": "893079",
    "end": "899440"
  },
  {
    "text": "Docker images on your computer and so this attacker would run custom images",
    "start": "899440",
    "end": "904720"
  },
  {
    "text": "that deployed miners the next year they started an even more advanced campaign and they",
    "start": "904720",
    "end": "913320"
  },
  {
    "text": "expanded their attack vectors to many different sources including kubernetes",
    "start": "913320",
    "end": "918519"
  },
  {
    "text": "now so you can see that they're getting comfortable with the cloud at this point they're using the same methods as before",
    "start": "918519",
    "end": "925240"
  },
  {
    "text": "but the scope has really expanded and the final iteration that",
    "start": "925240",
    "end": "930279"
  },
  {
    "text": "we've seen uh was interesting because it wasn't just about crypto mining anymore",
    "start": "930279",
    "end": "935480"
  },
  {
    "text": "it was also about credential theft through crypto worms at a very high level what they did was talk to the AWS",
    "start": "935480",
    "end": "943519"
  },
  {
    "text": "metadata endpoint which stores all of the credential information for that resource and they're looking for what",
    "start": "943519",
    "end": "950680"
  },
  {
    "text": "else they can access they're looking for AWS and SSH keys and they actually used",
    "start": "950680",
    "end": "956480"
  },
  {
    "text": "open- Source tools like lasagna to scrape system memory for credential credentials or",
    "start": "956480",
    "end": "964079"
  },
  {
    "text": "passwords and what you're seeing here is a screen grab that a researcher from Germany managed to take of Team TNT's",
    "start": "964079",
    "end": "971800"
  },
  {
    "text": "control panel this is showing different workers and their uptime and I want to call attention here because 600 hours is",
    "start": "971800",
    "end": "980480"
  },
  {
    "text": "a very long time to mine without getting caught if you're mining for free um cig",
    "start": "980480",
    "end": "987079"
  },
  {
    "text": "has estimated that for every dollar that an attacker makes the victim is build",
    "start": "987079",
    "end": "993319"
  },
  {
    "text": "around $53 so think of that when thinking of the financial",
    "start": "993319",
    "end": "999560"
  },
  {
    "text": "impact another cryptojacking campaign that was discovered recently has very similar infrastructure to team TNT and",
    "start": "999560",
    "end": "1007519"
  },
  {
    "text": "it got its name in from a domain called kiss a dog hence the very weird matching",
    "start": "1007519",
    "end": "1013240"
  },
  {
    "text": "hoodie photo I found um The Domain was used to trigger a shell script",
    "start": "1013240",
    "end": "1019639"
  },
  {
    "text": "uh payload on the compromise container using an encoded python command and the",
    "start": "1019639",
    "end": "1025678"
  },
  {
    "text": "attack chain subsequently escapes the container and moves laterally into the",
    "start": "1025679",
    "end": "1031400"
  },
  {
    "text": "breach Network while simultaneously taking steps to terminate Cloud monitoring",
    "start": "1031400",
    "end": "1036959"
  },
  {
    "text": "services and the ultimate goal here was crypto mining but what I want to talk about and draw attention to was the fact",
    "start": "1036959",
    "end": "1044038"
  },
  {
    "text": "that they did container escapes that was a huge concern in the early of security and was thought to be",
    "start": "1044039",
    "end": "1050720"
  },
  {
    "text": "mitigated by proper configuration but the impact is that we can't discount the possibility that",
    "start": "1050720",
    "end": "1057640"
  },
  {
    "text": "attackers can escape the container now which makes this statistic that cising found all the more",
    "start": "1057640",
    "end": "1064799"
  },
  {
    "text": "alarming now if you don't have container running as root container escapes are",
    "start": "1064799",
    "end": "1070280"
  },
  {
    "text": "still possible but with this it's a lot easier for attackers to get root on the",
    "start": "1070280",
    "end": "1075919"
  },
  {
    "text": "host which is obviously something that we want to avoid",
    "start": "1075919",
    "end": "1080840"
  },
  {
    "text": "so try to avoid containers running as root realistically some things will need",
    "start": "1082039",
    "end": "1088240"
  },
  {
    "text": "those abilities but you should be really deliberate about it is this a system agent that actually needs it and if it",
    "start": "1088240",
    "end": "1095280"
  },
  {
    "text": "does you need to actively monitor it to see that it's not doing anything",
    "start": "1095280",
    "end": "1101120"
  },
  {
    "text": "weird also consider not letting your instances initiate new ones because that",
    "start": "1101120",
    "end": "1107120"
  },
  {
    "text": "was one way that team TNT was able to spread once they accessed an ec2 they",
    "start": "1107120",
    "end": "1112400"
  },
  {
    "text": "would spin up new ones if they could and then mine on each of",
    "start": "1112400",
    "end": "1118000"
  },
  {
    "text": "them for attack number six the hackers abused free tier accounts this is what I",
    "start": "1118679",
    "end": "1125000"
  },
  {
    "text": "imagine their face was when they realized that they could make money off of that this was an attack discovered by",
    "start": "1125000",
    "end": "1130880"
  },
  {
    "text": "the Cy threat research team uh it's a very extensive and sophisticated active",
    "start": "1130880",
    "end": "1136679"
  },
  {
    "text": "crypto mining campaign and we call called it purple urchin this is where a threat actor",
    "start": "1136679",
    "end": "1142640"
  },
  {
    "text": "targeted some of the largest cicd service providers including GitHub Heroku and buddy works to run and scale",
    "start": "1142640",
    "end": "1150640"
  },
  {
    "text": "this massive Cloud operation the activity that we observed we're calling free jacking this is when",
    "start": "1150640",
    "end": "1158799"
  },
  {
    "text": "attackers abuse compute that's allocated for free tier",
    "start": "1158799",
    "end": "1164799"
  },
  {
    "text": "accounts now the efforts that purple urchin invested here are pretty abnormal",
    "start": "1165080",
    "end": "1171600"
  },
  {
    "text": "uh with an extensive list of service providers and open source tools beyond what we're even showing here so this is",
    "start": "1171600",
    "end": "1178480"
  },
  {
    "text": "not that low effort High reward attack that I was describing the initial",
    "start": "1178480",
    "end": "1184200"
  },
  {
    "text": "investment in getting this level of automation required a",
    "start": "1184200",
    "end": "1190080"
  },
  {
    "text": "lot and it all started with uh Cy's container analysis engine capturing",
    "start": "1190080",
    "end": "1196360"
  },
  {
    "text": "suspicious Behavior associated with a ER image everything looked a bit obscure so",
    "start": "1196360",
    "end": "1202200"
  },
  {
    "text": "we decided to dig in a bit and it turns out that this container acted as the",
    "start": "1202200",
    "end": "1207760"
  },
  {
    "text": "command and control container as well as the stratum relay server which is What",
    "start": "1207760",
    "end": "1213320"
  },
  {
    "text": "receives connections from all of the active mining agents so this container acted like the central Hub of operation",
    "start": "1213320",
    "end": "1219919"
  },
  {
    "text": "for this attack and how did these attackers manage to automate creating so many free",
    "start": "1219919",
    "end": "1227159"
  },
  {
    "text": "tier accounts uh each GitHub repository that was created was typically used",
    "start": "1227159",
    "end": "1232559"
  },
  {
    "text": "within a day or two and each repository had a GitHub action to run Docker",
    "start": "1232559",
    "end": "1238320"
  },
  {
    "text": "images so a shell script was responsible for creating the GitHub actions yl",
    "start": "1238320",
    "end": "1245520"
  },
  {
    "text": "workflow in each of the threat actors repositories and it tried to obfuscate",
    "start": "1245520",
    "end": "1250960"
  },
  {
    "text": "and hide the actions by naming them with random strings now in order to push this",
    "start": "1250960",
    "end": "1257280"
  },
  {
    "text": "workflow to workflow file to each repository the script also added SSH",
    "start": "1257280",
    "end": "1263480"
  },
  {
    "text": "keys for use with the GitHub CLI so it creates a GitHub repository",
    "start": "1263480",
    "end": "1269960"
  },
  {
    "text": "and it pushes this previously created GitHub workflow to the master branch of",
    "start": "1269960",
    "end": "1275200"
  },
  {
    "text": "the new repository and the results of this whole automated workflow was the creation of a",
    "start": "1275200",
    "end": "1282760"
  },
  {
    "text": "GitHub account and repository and the successful execution of many GitHub",
    "start": "1282760",
    "end": "1288159"
  },
  {
    "text": "actions to run mining operations which is what I'm going to discuss now how did",
    "start": "1288159",
    "end": "1293360"
  },
  {
    "text": "they automate that mining part well they had another script that went through the",
    "start": "1293360",
    "end": "1298840"
  },
  {
    "text": "list of previously created GitHub accounts and used curl to pass a",
    "start": "1298840",
    "end": "1303880"
  },
  {
    "text": "pre-made Docker command to each repository's action including that IP",
    "start": "1303880",
    "end": "1309120"
  },
  {
    "text": "address of the stratum relay server so that it could report back on the GitHub side it just receives",
    "start": "1309120",
    "end": "1315919"
  },
  {
    "text": "a Docker command and runs it so it starts the mining container the fact that these attackers",
    "start": "1315919",
    "end": "1322640"
  },
  {
    "text": "used their own strata mining protocol relay helped them to avoid network-based",
    "start": "1322640",
    "end": "1328840"
  },
  {
    "text": "detections that are looking for outbound connections to publicly known mining",
    "start": "1328840",
    "end": "1335320"
  },
  {
    "text": "pools and to pull off an automated operation of this scale they employed",
    "start": "1335320",
    "end": "1341120"
  },
  {
    "text": "quite a few techniques to bypass those bot protections that are in place to prevent exactly this openvpn was used to",
    "start": "1341120",
    "end": "1350320"
  },
  {
    "text": "make sure that the source IP was different for every account and they used programmatic mouse and keyboard",
    "start": "1350320",
    "end": "1356720"
  },
  {
    "text": "inputs as well as speech recognition of audio files to bypass",
    "start": "1356720",
    "end": "1362679"
  },
  {
    "text": "capture and a container with IMAP and postfix servers to handle the emails for",
    "start": "1362679",
    "end": "1369480"
  },
  {
    "text": "account creation and verification and unless you work for",
    "start": "1369480",
    "end": "1374559"
  },
  {
    "text": "these companies you might be thinking to yourself why do I care about this like how does this affect me and the answer",
    "start": "1374559",
    "end": "1381679"
  },
  {
    "text": "is it ruins a good thing for everybody because we can't expect that these cicd",
    "start": "1381679",
    "end": "1388480"
  },
  {
    "text": "service providers are just going to absorb these costs cytic estimated that",
    "start": "1388480",
    "end": "1393840"
  },
  {
    "text": "every GitHub account that purple urchin created cost them about $15 a month and",
    "start": "1393840",
    "end": "1400039"
  },
  {
    "text": "at these rates it would take a threat actor $100,000 to mine a single Monero coin",
    "start": "1400039",
    "end": "1408120"
  },
  {
    "text": "and these thread actors are not even mining Monero they're currently mining cryptocurrencies with low profit",
    "start": "1408120",
    "end": "1415159"
  },
  {
    "text": "margins so it's possible that this operation is really just a lowrisk low",
    "start": "1415159",
    "end": "1420799"
  },
  {
    "text": "reward test uh before purple urgent moves on to higher valued coins like",
    "start": "1420799",
    "end": "1425919"
  },
  {
    "text": "Bitcoin and Monero and it's also possible and probably scarier that purple urchin is",
    "start": "1425919",
    "end": "1432760"
  },
  {
    "text": "preparing to attack the underlying blockchains cuz proof of work algorithms are vulnerable to a 51%",
    "start": "1432760",
    "end": "1441679"
  },
  {
    "text": "attack so as I mentioned this kind of activity could put free trials that we",
    "start": "1441679",
    "end": "1447320"
  },
  {
    "text": "all know and love at risk um we can't there might not be free trials for",
    "start": "1447320",
    "end": "1452400"
  },
  {
    "text": "personal use and it might make the costs for Enterprise and business accounts go",
    "start": "1452400",
    "end": "1457880"
  },
  {
    "text": "up and for you personally just know that you can't rely solely on malicious IP",
    "start": "1457880",
    "end": "1464600"
  },
  {
    "text": "detection remember that the stratum mining protocol really made it so that",
    "start": "1464600",
    "end": "1469640"
  },
  {
    "text": "we couldn't detect that they were going to a known uh mining",
    "start": "1469640",
    "end": "1475360"
  },
  {
    "text": "pool now for the very last attack I want everybody here to consider that",
    "start": "1475480",
    "end": "1480720"
  },
  {
    "text": "sometimes attacks are much more malicious and indepth than how it",
    "start": "1480720",
    "end": "1485760"
  },
  {
    "text": "appears on the surface this attack was also discovered by Cy's threat research team and we call",
    "start": "1485760",
    "end": "1493120"
  },
  {
    "text": "it Scarlet eel I guess we like sea animals um and the attack began with",
    "start": "1493120",
    "end": "1500159"
  },
  {
    "text": "hackers exploiting a vulnerable public facing service on a kubernetes cluster",
    "start": "1500159",
    "end": "1506120"
  },
  {
    "text": "that's hosted in AWS once the attacker gained access to the Pod the malware was able to perform",
    "start": "1506120",
    "end": "1514360"
  },
  {
    "text": "two initial actions the first was downloading and launching a crypto Miner",
    "start": "1514360",
    "end": "1520720"
  },
  {
    "text": "but during that installation we also observed a bass script running simultaneously on the container to",
    "start": "1520720",
    "end": "1527840"
  },
  {
    "text": "enumerate and extract additional information from this environment looking for",
    "start": "1527840",
    "end": "1533520"
  },
  {
    "text": "credentials after they gained that initial access to the account they then gathered information about other",
    "start": "1533520",
    "end": "1540480"
  },
  {
    "text": "deployed resources focusing specifically on Lambda and S3",
    "start": "1540480",
    "end": "1546759"
  },
  {
    "text": "services in The Next Step the attacker used the credentials that they found in",
    "start": "1548200",
    "end": "1553279"
  },
  {
    "text": "the previous step to move laterally and contact the AWS API there trying to",
    "start": "1553279",
    "end": "1558720"
  },
  {
    "text": "enumerate this account further and continue to kind of expand their reach and here they were able to do three",
    "start": "1558720",
    "end": "1565600"
  },
  {
    "text": "things the first was they disabled the cloud trail logs to evade",
    "start": "1565600",
    "end": "1571120"
  },
  {
    "text": "detection the second was they actually stole proprietary software they managed",
    "start": "1571120",
    "end": "1576399"
  },
  {
    "text": "to do a data exportation and the third was they found the credentials of an IM user that was",
    "start": "1576399",
    "end": "1583919"
  },
  {
    "text": "related to a different AWS account by discovering terraform State files in",
    "start": "1583919",
    "end": "1589480"
  },
  {
    "text": "those S3 in an S3 bucket now those credentials that they found in the terraform State file they",
    "start": "1589480",
    "end": "1596960"
  },
  {
    "text": "used to basically repeat that kill chain again so they're trying again to enumerate and find other ways to spread",
    "start": "1596960",
    "end": "1603720"
  },
  {
    "text": "but fortunately in this case they were unsuccessful due to a lack of",
    "start": "1603720",
    "end": "1609919"
  },
  {
    "text": "permissions so while Cloud security is is relatively young we are seeing that",
    "start": "1611279",
    "end": "1617919"
  },
  {
    "text": "cyber cyber attackers are really learning about the cloud and starting to experiment with what is possible this",
    "start": "1617919",
    "end": "1624679"
  },
  {
    "text": "attacker had great knowledge of cloud native Native tools and was able to adeptly move and navigate and escalate",
    "start": "1624679",
    "end": "1632520"
  },
  {
    "text": "their attack so I'm personally concerned that we'll get to a stage where the",
    "start": "1632520",
    "end": "1638440"
  },
  {
    "text": "knowledge of attackers of cloud native tools and services will surpass that of",
    "start": "1638440",
    "end": "1643640"
  },
  {
    "text": "the average person that is using the cloud to build their applications and post their",
    "start": "1643640",
    "end": "1649039"
  },
  {
    "text": "infrastructure um this terraform State file is a good example most people don't know that terraform leaves a state file",
    "start": "1649039",
    "end": "1656200"
  },
  {
    "text": "on an S3 bucket with credentials on it and it's that kind of thing where if you don't know to handle it with care",
    "start": "1656200",
    "end": "1663320"
  },
  {
    "text": "attackers might be able to use it to their advantage and I urge everybody here to",
    "start": "1663320",
    "end": "1669840"
  },
  {
    "text": "not dismiss crypto mining if you see it in your own environment as totally",
    "start": "1669840",
    "end": "1675240"
  },
  {
    "text": "normal just because it's so widespread because the attack might not have stopped there um if the victim here",
    "start": "1675240",
    "end": "1683320"
  },
  {
    "text": "didn't continue to do incident response then they might not have discovered that there was actually data that was",
    "start": "1683320",
    "end": "1691600"
  },
  {
    "text": "exfiltrated so keep the ability to disable or delete security logs to as",
    "start": "1692240",
    "end": "1699840"
  },
  {
    "text": "few users as possible uh the fact that the attacker disabled the cloud trail logs made the incident's response harder",
    "start": "1699840",
    "end": "1709519"
  },
  {
    "text": "and terraform is a really great tool but it should be handled with care terraform",
    "start": "1709519",
    "end": "1715039"
  },
  {
    "text": "access should only be given to those who really need it and terraform State files",
    "start": "1715039",
    "end": "1720559"
  },
  {
    "text": "should be stored somewhere secure not here in what seem to be a very easily accessible S3",
    "start": "1720559",
    "end": "1727840"
  },
  {
    "text": "bucket and finally you can't assume that just because attackers can't alter",
    "start": "1727840",
    "end": "1735279"
  },
  {
    "text": "anything that there won't be any impact to your organiz ation because with read only attackers can still read",
    "start": "1735279",
    "end": "1742039"
  },
  {
    "text": "credentials or Lambda code and there is still an impact so consider that when you're thinking of least permissive you",
    "start": "1742039",
    "end": "1749279"
  },
  {
    "text": "can't just go read only across the board and think that you're",
    "start": "1749279",
    "end": "1753799"
  },
  {
    "text": "safe now to wrap up all of that lots of different attacks and kind of things",
    "start": "1754799",
    "end": "1761240"
  },
  {
    "text": "that we've seen uh where do we think that cloud breaches Trends in general",
    "start": "1761240",
    "end": "1767159"
  },
  {
    "text": "are going to be in the future crypto mining is probably only",
    "start": "1767159",
    "end": "1772480"
  },
  {
    "text": "going to increase in popularity which seems a little counterintuitive because a lot of cryptocurrencies are crashing",
    "start": "1772480",
    "end": "1779000"
  },
  {
    "text": "in value but it doesn't change the fact that crypto mining attacks are low",
    "start": "1779000",
    "end": "1785039"
  },
  {
    "text": "effort High rewards attackers don't need to do much and they can passively earn",
    "start": "1785039",
    "end": "1790440"
  },
  {
    "text": "income but what we will probably see is that the scale of these crypto mining",
    "start": "1790440",
    "end": "1795880"
  },
  {
    "text": "attacks will increase if the value is less you have to mine more to make the same amount or more uh but",
    "start": "1795880",
    "end": "1803919"
  },
  {
    "text": "it's not just true of crypto mining attacks we're seeing that threat actor groups are almost like a startup like",
    "start": "1803919",
    "end": "1810039"
  },
  {
    "text": "they're getting to that stage where they are ramping up their operations and doing uh attacks at a really larger",
    "start": "1810039",
    "end": "1818720"
  },
  {
    "text": "scale we can also expect the sophistication of cloud infrastructure",
    "start": "1818720",
    "end": "1824600"
  },
  {
    "text": "attacks to increase and I just mentioned we don't want to get to the stage where",
    "start": "1824600",
    "end": "1830760"
  },
  {
    "text": "attackers are more knowledgeable about Cloud native tools and services than we are so we need to make sure that we can",
    "start": "1830760",
    "end": "1837840"
  },
  {
    "text": "keep up and that we are aware of all of the different kind of methods that they're using to breach our Cloud",
    "start": "1837840",
    "end": "1846080"
  },
  {
    "text": "environments and this one's a bit obvious but supply chain compromises can really have devastating effects and most",
    "start": "1846799",
    "end": "1854480"
  },
  {
    "text": "people I think when they hear supply chain compromise they think of zero day exploits the ones that we don't know",
    "start": "1854480",
    "end": "1860720"
  },
  {
    "text": "about that attackers are using against us but even the ones that we do know",
    "start": "1860720",
    "end": "1866279"
  },
  {
    "text": "about like log for J can go from announcement to being weaponized far",
    "start": "1866279",
    "end": "1872279"
  },
  {
    "text": "faster than attackers can use it to exp uh then sorry then we can release",
    "start": "1872279",
    "end": "1878519"
  },
  {
    "text": "patches for it so all of this to say how can we cope",
    "start": "1878519",
    "end": "1884240"
  },
  {
    "text": "I've mentioned it quite a few times but that realtime visibility is key because",
    "start": "1884240",
    "end": "1890000"
  },
  {
    "text": "even if we can't always control whether attackers breach our environments at the",
    "start": "1890000",
    "end": "1895240"
  },
  {
    "text": "very least we know that most attackers are doing the same kinds of actions once they do breach an environment so we can",
    "start": "1895240",
    "end": "1902480"
  },
  {
    "text": "really look for those repeating actions and at least be notified of a breach",
    "start": "1902480",
    "end": "1908440"
  },
  {
    "text": "when it does occur and our time and effort and",
    "start": "1908440",
    "end": "1915080"
  },
  {
    "text": "Manpower is a valuable resource there are more things to fix than time or",
    "start": "1915080",
    "end": "1922159"
  },
  {
    "text": "ability to fix them so cytic found that 87% of container images have high or",
    "start": "1922159",
    "end": "1928399"
  },
  {
    "text": "critical vulnerabilities how can you narrow that down and figure out which",
    "start": "1928399",
    "end": "1934200"
  },
  {
    "text": "ones do I fix first the answer is kind of simple you go for the ones that",
    "start": "1934200",
    "end": "1939840"
  },
  {
    "text": "attackers are Mo are most likely to go after first you go for the lwh hanging fruit and to do that you can apply",
    "start": "1939840",
    "end": "1947559"
  },
  {
    "text": "different filters to prioritize so of all those critical or high",
    "start": "1947559",
    "end": "1952799"
  },
  {
    "text": "vulnerabilities which ones actually have a fix available but aren't patched yet which ones are actually in use at",
    "start": "1952799",
    "end": "1959919"
  },
  {
    "text": "runtime and which ones are actually exploitable add all of these filters up",
    "start": "1959919",
    "end": "1965360"
  },
  {
    "text": "and start with those and work your way down and last but certainly not least is",
    "start": "1965360",
    "end": "1973559"
  },
  {
    "text": "least permissive cytic found that 90% of granted permissions are not used that is",
    "start": "1973559",
    "end": "1980639"
  },
  {
    "text": "an excessive amount and I think we can very much do better and I have seen that",
    "start": "1980639",
    "end": "1987600"
  },
  {
    "text": "not every organization wants to prioritize lease permissive again limited Manpower limited time what do",
    "start": "1987600",
    "end": "1994600"
  },
  {
    "text": "you focus on first I urge you all to reconsider if lease permissive is not a",
    "start": "1994600",
    "end": "1999840"
  },
  {
    "text": "major goal of your organization because as I mentioned unfortunately we can't",
    "start": "1999840",
    "end": "2005519"
  },
  {
    "text": "always control whether a breach occurs but if a breach does occur and your",
    "start": "2005519",
    "end": "2012880"
  },
  {
    "text": "environment is basically the Wild West free-for-all in terms of permissions attackers are going to be able to do so",
    "start": "2012880",
    "end": "2020000"
  },
  {
    "text": "much more and wreak so much more Havoc than if you are reducing the scope of",
    "start": "2020000",
    "end": "2025240"
  },
  {
    "text": "your permissions to what is actually needed so with that I'm going to end",
    "start": "2025240",
    "end": "2031760"
  },
  {
    "text": "this session I appreciate all of you for showing up and I'll be here if anybody",
    "start": "2031760",
    "end": "2037000"
  },
  {
    "text": "has any questions thank you",
    "start": "2037000",
    "end": "2041320"
  },
  {
    "text": "[Applause]",
    "start": "2043790",
    "end": "2047400"
  }
]