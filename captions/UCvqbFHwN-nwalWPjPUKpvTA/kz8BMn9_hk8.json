[
  {
    "text": "so welcome everybody so we have it late because we have machinery future taught",
    "start": "60",
    "end": "5279"
  },
  {
    "text": "by Daniel was Justin's other building so we were running and but yeah",
    "start": "5279",
    "end": "10830"
  },
  {
    "text": "so deep dive we have two topics mainly I have some slides about CID conversion",
    "start": "10830",
    "end": "16650"
  },
  {
    "text": "which we didn't show in the last talk bye-bye medium Eddie I will go over them",
    "start": "16650",
    "end": "22590"
  },
  {
    "text": "first then you has something about apply so I said apply also a big thing for 2019 and then we just have Q day so if",
    "start": "22590",
    "end": "31980"
  },
  {
    "text": "you have questions about those topics but anything I guess just feel free to ask so they have focus I might be able",
    "start": "31980",
    "end": "44239"
  },
  {
    "text": "deep dive so I think most of you have seen that we have see ad conversion",
    "start": "44239",
    "end": "49890"
  },
  {
    "text": "since 113 is either via web hooks and I just want to yeah give some slides add",
    "start": "49890",
    "end": "56969"
  },
  {
    "text": "some questions which came up afterwards so there was a question about ordering Wednesday is conversion actually and",
    "start": "56969",
    "end": "62820"
  },
  {
    "text": "houses place with admission and those things and I will try to answer them quickly so this is a pipeline of the API",
    "start": "62820",
    "end": "69240"
  },
  {
    "text": "server and see at least in this case they come in here goes who authentication authorization and so on",
    "start": "69240",
    "end": "75659"
  },
  {
    "text": "and end up in the handlers and see at least our Jason on the wire so the",
    "start": "75659",
    "end": "80790"
  },
  {
    "text": "decoded and admission is executed on them as for any other resource maybe there are books called attends as usual",
    "start": "80790",
    "end": "88320"
  },
  {
    "text": "test logic being applied which might include at see the XS and any other more",
    "start": "88320",
    "end": "93930"
  },
  {
    "text": "complicated things and then something is encoded again and sent back to the client and yeah conversion so this is",
    "start": "93930",
    "end": "105420"
  },
  {
    "text": "our old slight general slide and there are some words conversion somewhere in there and I highlighted some so there's",
    "start": "105420",
    "end": "112530"
  },
  {
    "text": "three places basically where we have conversion and they play a role of obviously also for CDs but not really",
    "start": "112530",
    "end": "118829"
  },
  {
    "text": "so those places would be candidates for conversion where because the conversion stick now adays",
    "start": "118829",
    "end": "124860"
  },
  {
    "text": "but luckily we we did something we don't",
    "start": "124860",
    "end": "129989"
  },
  {
    "text": "have internal types so if you know api service for native types and go we Nate if internal taps as well and we",
    "start": "129989",
    "end": "136330"
  },
  {
    "text": "have to convert a lot for CDs we didn't do that for CDs we have requests version",
    "start": "136330",
    "end": "142930"
  },
  {
    "text": "everywhere in the pipeline so you see this blue v1 everywhere it's v1 in LCD",
    "start": "142930",
    "end": "148600"
  },
  {
    "text": "it might be v2 so this dog version might be different and yeah as you can imagine",
    "start": "148600",
    "end": "153610"
  },
  {
    "text": "a lot of source yellow bubbles just go away you don't have conversions there so CID conversion is not called as much as",
    "start": "153610",
    "end": "160300"
  },
  {
    "text": "for native resources luckily because obviously it's a it's a failure or a",
    "start": "160300",
    "end": "165540"
  },
  {
    "text": "point where where an error can occur or it's performance issues latency and so",
    "start": "165540",
    "end": "171280"
  },
  {
    "text": "on so basically you have those two two points there in the stack on an update",
    "start": "171280",
    "end": "176310"
  },
  {
    "text": "we have to get something from Exedy and we apply something so they have some conversion back and forth so maybe two",
    "start": "176310",
    "end": "183310"
  },
  {
    "text": "or three something like that at the end here there's nothing because we are",
    "start": "183310",
    "end": "189340"
  },
  {
    "text": "Whitney's right we're on the netbook cords it's the same we answer white version it's just a non conversion so",
    "start": "189340",
    "end": "194800"
  },
  {
    "text": "you won't be caught by those points patches are a bit more complicated so",
    "start": "194800",
    "end": "201220"
  },
  {
    "text": "patches heavier each wire mechanism internally which means there might be an additional conversions because each each",
    "start": "201220",
    "end": "208239"
  },
  {
    "text": "time on each each why you have to read from Exedy again on convert so patches bit more heavy um but still it's very",
    "start": "208239",
    "end": "216100"
  },
  {
    "text": "contained at those two positions we have watches watches are also burdened there",
    "start": "216100",
    "end": "222519"
  },
  {
    "text": "might be yeah one more per version which is not the storage version so this is",
    "start": "222519",
    "end": "228370"
  },
  {
    "text": "yeah roughly is a idea or a number which you can expect from from the Red Hook",
    "start": "228370",
    "end": "233700"
  },
  {
    "text": "for CID conversion yeah I talked about internal versions this is a picture here",
    "start": "233700",
    "end": "239489"
  },
  {
    "text": "this is for native resources and they see everywhere inside of this pipeline here you have internal objects and",
    "start": "239489",
    "end": "246489"
  },
  {
    "text": "everywhere on the site on the edge you have to convert so this is where we were heavy and conversion is so important for",
    "start": "246489",
    "end": "252970"
  },
  {
    "text": "internal conversion there's actually a discussion maybe to change that do we",
    "start": "252970",
    "end": "259299"
  },
  {
    "text": "really need those internal types anymore maybe we want something called a hub type which would also make this easier",
    "start": "259299",
    "end": "265300"
  },
  {
    "text": "maybe the second topic about CID is haunt",
    "start": "265300",
    "end": "271860"
  },
  {
    "text": "ability so I show the slides we do how to test for native resources everywhere very heavily so on each change in the",
    "start": "271860",
    "end": "280440"
  },
  {
    "text": "API we weren't thousands of randomized conversion tests so we we just fill",
    "start": "280440",
    "end": "286590"
  },
  {
    "text": "object with random values convert to another version via the internal version and back and see it nothing was lost on",
    "start": "286590",
    "end": "292710"
  },
  {
    "text": "the way so hound tripping is very important and we highlight a set like 10 times in the last talk I just wanted to",
    "start": "292710",
    "end": "298800"
  },
  {
    "text": "show before you start doing that we have patterns for that so you find a lot of",
    "start": "298800",
    "end": "304020"
  },
  {
    "text": "examples of volunteer chests in the code they more or less look like that so we use a library called Gophers which gives",
    "start": "304020",
    "end": "313020"
  },
  {
    "text": "you randomization of structs and references and slices and everything",
    "start": "313020",
    "end": "318620"
  },
  {
    "text": "often it's not enough so this is fast no custom so no custom coils here but often",
    "start": "318620",
    "end": "326340"
  },
  {
    "text": "you have to fix certain things like you have to apply defaults can imagine if you don't have default and you convert",
    "start": "326340",
    "end": "332400"
  },
  {
    "text": "to another version and back and there might come and come in default value suddenly so better default before you",
    "start": "332400",
    "end": "339960"
  },
  {
    "text": "will notice that very early on when you when you have those cases with defaults where on table testing fails but it",
    "start": "339960",
    "end": "346440"
  },
  {
    "text": "shouldn't so it's pretty obvious that defaulting is missing and also other",
    "start": "346440",
    "end": "352280"
  },
  {
    "text": "type invariants sometimes you only support certain string formats like some",
    "start": "352280",
    "end": "357630"
  },
  {
    "text": "syntax in strings but the father of course puts Wenham date has and this is not supported by the conversions and you",
    "start": "357630",
    "end": "363330"
  },
  {
    "text": "need to to enforce certain type invariants and by that you you create a list of those fuzzer functions and we",
    "start": "363330",
    "end": "371070"
  },
  {
    "text": "put them into a funk slice usually and then we have a machinery and API",
    "start": "371070",
    "end": "376199"
  },
  {
    "text": "machinery so some some package called round trip where we have our own trip test for API group you give it so",
    "start": "376199",
    "end": "382169"
  },
  {
    "text": "testing T and the insert function for the scheme those functions and it just",
    "start": "382169",
    "end": "387240"
  },
  {
    "text": "wanted a thousand times or something like that in all directions with all versions between all those ones you have",
    "start": "387240",
    "end": "393150"
  },
  {
    "text": "or conversions you have to find and that's basically it so that's how all to ability testing looks like in our code",
    "start": "393150",
    "end": "399750"
  },
  {
    "text": "and jeez you can just use the same mechanism yeah outlook I just repeated and we",
    "start": "399750",
    "end": "407070"
  },
  {
    "text": "showed it in the last talk already um a big topic is see a yeast should pga next",
    "start": "407070",
    "end": "412920"
  },
  {
    "text": "year and there's a big issue just look to it with 20 or something ish",
    "start": "412920",
    "end": "418590"
  },
  {
    "text": "sub-issues which we have there and those are the ones which are critical so which",
    "start": "418590",
    "end": "424110"
  },
  {
    "text": "we declared as being critical before we go to j there's a discussion in this",
    "start": "424110",
    "end": "429420"
  },
  {
    "text": "issue if you have a different opinion go there and comment that's more or less consensus at the moment but yeah it's",
    "start": "429420",
    "end": "437220"
  },
  {
    "text": "it's out it's one of the big topics next year to work on those the first one is nearly done so I guess",
    "start": "437220",
    "end": "442980"
  },
  {
    "text": "in the next release we will have set it's nearly what it missed 1:13 just by",
    "start": "442980",
    "end": "449250"
  },
  {
    "text": "a few days I guess quota we have ideas we had some implementation by Nikita she is here and we want another",
    "start": "449250",
    "end": "456210"
  },
  {
    "text": "implementation where we have everything necessary I guess now generic inform us it's a topic there default and prunings",
    "start": "456210",
    "end": "463200"
  },
  {
    "text": "as a kept open we have to decide what to do there next year and some smaller",
    "start": "463200",
    "end": "468300"
  },
  {
    "text": "topics but that's basically it for J yeah so I will hand over to Daniel so I",
    "start": "468300",
    "end": "475170"
  },
  {
    "text": "said apply is a second huge topic yeah",
    "start": "475170",
    "end": "480080"
  },
  {
    "text": "before going to the server side apply I got a comment after the CRT thing and",
    "start": "480690",
    "end": "485730"
  },
  {
    "text": "the round trip ability tests I think it would be great to move those like we",
    "start": "485730",
    "end": "491070"
  },
  {
    "text": "have this CR D we can kind of have the start of a pipeline that helps you define series and the cube you open API",
    "start": "491070",
    "end": "496980"
  },
  {
    "text": "repo so I think it would be really great if if we could embrace that and extend it and and maybe add something that",
    "start": "496980",
    "end": "504330"
  },
  {
    "text": "generates the round-trip tests for you or at a fixture that helps you run round-trip test to your conversion",
    "start": "504330",
    "end": "510270"
  },
  {
    "text": "functions and this sounds a lot like Q builder and awkward yes PK yeah yeah yeah yeah I think Phil definitely has",
    "start": "510270",
    "end": "516780"
  },
  {
    "text": "some plans there so yeah anyway I just I just thought it was important to mention that we're aware",
    "start": "516780",
    "end": "523560"
  },
  {
    "text": "that like this is this is hard and we'd like to give you help doing it so I put",
    "start": "523560",
    "end": "530130"
  },
  {
    "text": "together this server side apply slide I put everything on one slide how much detail do people want for",
    "start": "530130",
    "end": "537450"
  },
  {
    "text": "server-side apply do you want like a lot of detail here or just a little detail okay I see some yeah okay okay lots of",
    "start": "537450",
    "end": "543270"
  },
  {
    "text": "detail okay all right cool you don't know what you're a signed up",
    "start": "543270",
    "end": "548339"
  },
  {
    "text": "for so okay so what have we been doing we've been working on this since I don't",
    "start": "548339",
    "end": "554310"
  },
  {
    "text": "know into like I put together the original design like q1 this year and then we've been working on it since then",
    "start": "554310",
    "end": "562670"
  },
  {
    "text": "and we did a lot of useful generically useful plumbing refactoring in in API",
    "start": "562670",
    "end": "569670"
  },
  {
    "text": "server like we refactored the patch Handler and and actually as a result of",
    "start": "569670",
    "end": "575490"
  },
  {
    "text": "that were able to like I spend all this time refactoring it and then then like Jordan deleted like a huge chunk of it",
    "start": "575490",
    "end": "581850"
  },
  {
    "text": "because it wasn't actually useful so that was great and this this makes our job easier so but but what are we doing",
    "start": "581850",
    "end": "589140"
  },
  {
    "text": "now well I don't know about maybe a quarter or so ago maybe four months ago",
    "start": "589140",
    "end": "596270"
  },
  {
    "text": "the the folks really working on it which are Antwon police Jenny Buckley and",
    "start": "596270",
    "end": "602760"
  },
  {
    "text": "myself locked ourselves in the room and really tried to make sure that we had a",
    "start": "602760",
    "end": "609830"
  },
  {
    "text": "that we had a shared vision for the design I should say before that like",
    "start": "609830",
    "end": "615900"
  },
  {
    "text": "like Antwon and Jennie implemented dry run because we knew that was going to be",
    "start": "615900",
    "end": "621000"
  },
  {
    "text": "very useful for this and I was I was I had to be out of the office paternity",
    "start": "621000",
    "end": "627209"
  },
  {
    "text": "leave I had to be out of the office so they went and implemented dry run and that is beta and 113 so that's pretty",
    "start": "627209",
    "end": "634200"
  },
  {
    "text": "awesome but then then I came back and we're like okay we've got a we've got to get",
    "start": "634200",
    "end": "639870"
  },
  {
    "text": "everybody on the same page we really got to knock this out of the park now so we hashed out the design Antwon read all",
    "start": "639870",
    "end": "648480"
  },
  {
    "text": "like 50 pages of my original design carefully and so then we we sat down and",
    "start": "648480",
    "end": "653820"
  },
  {
    "text": "we really argued about how to like is that really the best way to do it like there's so the original design like like",
    "start": "653820",
    "end": "659250"
  },
  {
    "text": "the so the current design has this last applied annotation which is like a JSON encoding of the entire object stuffed",
    "start": "659250",
    "end": "666529"
  },
  {
    "text": "- annotation so it's like everything is escaped quoted and if you're in a secret",
    "start": "666529",
    "end": "672860"
  },
  {
    "text": "and you had some secret value well that's on the annotation so it makes it hard to give people read-only or",
    "start": "672860",
    "end": "679220"
  },
  {
    "text": "metadata only access to your secrets when your entire value is in the",
    "start": "679220",
    "end": "684470"
  },
  {
    "text": "metadata so that's not good and and then the the next design was like a formalization of that really explicitly",
    "start": "684470",
    "end": "694759"
  },
  {
    "text": "defining the the concept of what is a schema what is it what is a type what does it mean to diff them what does it",
    "start": "694759",
    "end": "700939"
  },
  {
    "text": "mean to add them together so I like rigorously rigorously defined this three-way merge operation so III mean I",
    "start": "700939",
    "end": "709670"
  },
  {
    "text": "think that would have worked what we came up with a slightly better design [Music]",
    "start": "709670",
    "end": "715240"
  },
  {
    "text": "functionally behaviorally this is almost 100% the same like like we won't be",
    "start": "715240",
    "end": "720470"
  },
  {
    "text": "changing the test cases that we would have written but the new design instead of storing the exact struct or exact",
    "start": "720470",
    "end": "728120"
  },
  {
    "text": "object all the values intact we're now we've developed this data structure which is a set of field owners in the",
    "start": "728120",
    "end": "738319"
  },
  {
    "text": "the soso and we've written this nice library that gives like given a schema",
    "start": "738319",
    "end": "744129"
  },
  {
    "text": "the schema is still the same from the original design given a schema and an object produce the set of fields that",
    "start": "744129",
    "end": "752569"
  },
  {
    "text": "are set in that object and then we are doing set operations on these on these",
    "start": "752569",
    "end": "758980"
  },
  {
    "text": "objects to implement apply so the I'll",
    "start": "758980",
    "end": "766550"
  },
  {
    "text": "zoom in one more level of detail in a second but the upshot of this is that we",
    "start": "766550",
    "end": "772370"
  },
  {
    "text": "can store these in the we can store these in the metadata and since these",
    "start": "772370",
    "end": "777470"
  },
  {
    "text": "are just sets of fields they don't include the values so that lets us be both more compact and in space and we",
    "start": "777470",
    "end": "787759"
  },
  {
    "text": "don't publish your secret details anymore in metadata so the way this sort",
    "start": "787759",
    "end": "796699"
  },
  {
    "text": "of works is well suppose and so there's there's like two entry points into the apply the apply",
    "start": "796699",
    "end": "803550"
  },
  {
    "text": "I'll call it the system alright there is the apply entry point where you're a",
    "start": "803550",
    "end": "808800"
  },
  {
    "text": "user and you've explicitly said apply this manifest and then there is another",
    "start": "808800",
    "end": "814199"
  },
  {
    "text": "entry point which I'll call the update entry point and this one gets triggered when you do a put or patch like an",
    "start": "814199",
    "end": "823350"
  },
  {
    "text": "ordinary patch and so the apply system does slightly different operations on",
    "start": "823350",
    "end": "829260"
  },
  {
    "text": "these two things and this is another improvement in this design like your controllers can continue to put or patch",
    "start": "829260",
    "end": "835350"
  },
  {
    "text": "you don't have to change anything about your controllers so so basically I'll go",
    "start": "835350",
    "end": "841949"
  },
  {
    "text": "through the apply path first so you do not apply the server takes your texture object that you sent basically takes all",
    "start": "841949",
    "end": "850620"
  },
  {
    "text": "the fields you set strips off the values and puts this into the data structure",
    "start": "850620",
    "end": "856110"
  },
  {
    "text": "which is like a try just for efficiency but you could logically imagine it's just a flat list of like you know spec",
    "start": "856110",
    "end": "862529"
  },
  {
    "text": "spec dot replica aspect that the template that containers 0 named foo you",
    "start": "862529",
    "end": "870209"
  },
  {
    "text": "know so all these things in in this set and it stores this in the metadata",
    "start": "870209",
    "end": "877110"
  },
  {
    "text": "saying you own those fields now we allow multiple it's not just a",
    "start": "877110",
    "end": "884610"
  },
  {
    "text": "owner set in a metadata it's also who is the owner of that set so we can look at",
    "start": "884610",
    "end": "890130"
  },
  {
    "text": "what's currently in the metadata and see does somebody else think they own one of the fields that you're trying to set and",
    "start": "890130",
    "end": "895550"
  },
  {
    "text": "if somebody else does own that we tell you you actually need to force this",
    "start": "895550",
    "end": "901620"
  },
  {
    "text": "operation you need to say explicitly say I know some other component or some other actor in the system thinks that",
    "start": "901620",
    "end": "906930"
  },
  {
    "text": "they're managing this field but now I'm managing it and this is a this is a this is to force the user to be cognizant",
    "start": "906930",
    "end": "913560"
  },
  {
    "text": "that they're fighting with some other actor in the system ok so so that's essentially what happens",
    "start": "913560",
    "end": "919910"
  },
  {
    "text": "when the user and of course if the user does force then we take that field away",
    "start": "919910",
    "end": "925199"
  },
  {
    "text": "from the other actor add it to the user to the user set now the other way to",
    "start": "925199",
    "end": "930750"
  },
  {
    "text": "enter into system is through the updater put handlers and for those we assume that",
    "start": "930750",
    "end": "936750"
  },
  {
    "text": "generally these are controllers or if it's a user the user is explicitly doing",
    "start": "936750",
    "end": "942690"
  },
  {
    "text": "something that from which they they kind of know what they're doing so the behavior for put or patches like always force because if you're writing a",
    "start": "942690",
    "end": "951990"
  },
  {
    "text": "controller you're probably not prepared to begin receiving a new class of error message right like a hey you're trying",
    "start": "951990",
    "end": "959430"
  },
  {
    "text": "to take over a field that the user thinks they're setting that's not a useful thing to give to a controller it's just going to be like oh there was",
    "start": "959430",
    "end": "964710"
  },
  {
    "text": "an error I guess I'll try again in a second or millisecond and that's that's not a that's not a useful thing so so we",
    "start": "964710",
    "end": "970890"
  },
  {
    "text": "just always let the controllers win and then the next time the user goes in the user will get the warning and the user",
    "start": "970890",
    "end": "976470"
  },
  {
    "text": "will understand oh I'm fighting with the horizontal pot autoscaler over the value of spectra",
    "start": "976470",
    "end": "982020"
  },
  {
    "text": "Pacha's I should probably go turn that off for this thing or maybe I should remove it from my from my specification",
    "start": "982020",
    "end": "987660"
  },
  {
    "text": "document right because because probably you actually want the controller to keep on doing you don't want to fight with it",
    "start": "987660",
    "end": "993500"
  },
  {
    "text": "and so so that's a those are the two entry entry way points into the system I",
    "start": "993500",
    "end": "1000130"
  },
  {
    "text": "think that's a pretty like like if you want to go the next level down maybe you need to go read our documents so",
    "start": "1000130",
    "end": "1006980"
  },
  {
    "text": "hopefully hopefully that's that's clear so where are we on this project then and",
    "start": "1006980",
    "end": "1012530"
  },
  {
    "text": "we were really hoping that we could get an alpha in this one 13 release unfortunately like we got all the",
    "start": "1012530",
    "end": "1017930"
  },
  {
    "text": "various pieces mostly done like we like I wrote a bunch of code for the the this",
    "start": "1017930",
    "end": "1024140"
  },
  {
    "text": "is called the I want to say the name Ryan wrong so it's the structured merge",
    "start": "1024140",
    "end": "1032000"
  },
  {
    "text": "and diff library so we wrote a bunch of code there it constructs these fieldset",
    "start": "1032000",
    "end": "1039170"
  },
  {
    "text": "objects does all the necessary set operations is pretty nifty it implements",
    "start": "1039170",
    "end": "1044180"
  },
  {
    "text": "the logic behind apply so that's that's done and then we started to glue it all",
    "start": "1044180",
    "end": "1051200"
  },
  {
    "text": "together we realize that we missed a couple pieces like like in the glue so",
    "start": "1051200",
    "end": "1057380"
  },
  {
    "text": "it's actually calling into the system is actually easy it is phrasing this new structure in the",
    "start": "1057380",
    "end": "1063750"
  },
  {
    "text": "metadata that is that is the thing Antoine and Jenny are working on at the moment so our our first draft was",
    "start": "1063750",
    "end": "1071190"
  },
  {
    "text": "actually incredibly verbose so we came up with a new format and Jenny just",
    "start": "1071190",
    "end": "1076830"
  },
  {
    "text": "showed me the proof-of-concept last night looks great it's going to be very concise and yeah",
    "start": "1076830",
    "end": "1084990"
  },
  {
    "text": "it'll be it'll be great so hopefully that'll go in soon when I come back from",
    "start": "1084990",
    "end": "1090930"
  },
  {
    "text": "maternity leave end of January it'll be it'll be it'll be all in so I should say",
    "start": "1090930",
    "end": "1099960"
  },
  {
    "text": "one more thing about this one of the hard things about kubernetes objects is we tend to do this thing with lists",
    "start": "1099960",
    "end": "1105990"
  },
  {
    "text": "where it's not actually useful to index the list by by number right like it's",
    "start": "1105990",
    "end": "1113370"
  },
  {
    "text": "not that you want the first container in the list it's that you want to own a field for the container which has the",
    "start": "1113370",
    "end": "1119070"
  },
  {
    "text": "name my sidecar right so the the schema format and the way in which you name",
    "start": "1119070",
    "end": "1126390"
  },
  {
    "text": "things when you specify a list item it actually understands that the name or",
    "start": "1126390",
    "end": "1136100"
  },
  {
    "text": "some some some lists have them have multiple things like the the port the port list has both the port number and",
    "start": "1136100",
    "end": "1143010"
  },
  {
    "text": "protocol like that those two things identify that entry so it understands that and and it puts that as the",
    "start": "1143010",
    "end": "1149460"
  },
  {
    "text": "indexing function so that you own it you continue to own it even in the face of",
    "start": "1149460",
    "end": "1154920"
  },
  {
    "text": "reorderings or other things so that is that is actually one of the main reasons",
    "start": "1154920",
    "end": "1161250"
  },
  {
    "text": "why we have to do something special here why built-in tools like JSON hatch JSON",
    "start": "1161250",
    "end": "1167790"
  },
  {
    "text": "merge patch are really insufficient for for this for this operation so we're",
    "start": "1167790",
    "end": "1173370"
  },
  {
    "text": "working on the API I think we'll have something that we're happy with very soon so I I really don't",
    "start": "1173370",
    "end": "1181710"
  },
  {
    "text": "see any problem with merging this back and actually I know we made this feature branch and it looks like the amount of",
    "start": "1181710",
    "end": "1187920"
  },
  {
    "text": "actual changes that are going into the future branch will be fairly small for the for the future branch but it's good",
    "start": "1187920",
    "end": "1193770"
  },
  {
    "text": "it's a good to either commit a completely working thing or leave it not committed Mathon",
    "start": "1193770",
    "end": "1204030"
  },
  {
    "text": "1.14 and like alpha then beta then eventually ga hopefully soon I think for",
    "start": "1204030",
    "end": "1212910"
  },
  {
    "text": "for beta will want to make sure that this works for CR DS just as well as other optics we've got some ideas for",
    "start": "1212910",
    "end": "1221250"
  },
  {
    "text": "how how can we make reasonable assumptions about the schema if you are CRD author and you didn't actually add a",
    "start": "1221250",
    "end": "1227940"
  },
  {
    "text": "schema so I'd like to I'd like to continue to support like some some",
    "start": "1227940",
    "end": "1233760"
  },
  {
    "text": "rudimentary amount of apply you know gracefully degrade if you want the full semantics so you can always provide",
    "start": "1233760",
    "end": "1239610"
  },
  {
    "text": "schema so next steps what are we gonna",
    "start": "1239610",
    "end": "1244950"
  },
  {
    "text": "do in the future well I think it's really nifty that we've got that that",
    "start": "1244950",
    "end": "1251160"
  },
  {
    "text": "were in as soon as this merges we're gonna have this great entry point into a into a subsystem that understands the",
    "start": "1251160",
    "end": "1256410"
  },
  {
    "text": "object schema and the the what the users trying to do to it so I think an example",
    "start": "1256410",
    "end": "1262650"
  },
  {
    "text": "of a really useful thing we could do that do here that we really didn't have the ability to do before or at least not",
    "start": "1262650",
    "end": "1268080"
  },
  {
    "text": "in a clean way as we could add something like discriminated unions Brian grant",
    "start": "1268080",
    "end": "1273179"
  },
  {
    "text": "has frequently talked about this idea that that are one of it would be great",
    "start": "1273179",
    "end": "1279510"
  },
  {
    "text": "if we had like a field a discriminator field that told you which of the other",
    "start": "1279510",
    "end": "1285480"
  },
  {
    "text": "fields was the one you intended to use like in the the volume object is a is a",
    "start": "1285480",
    "end": "1292110"
  },
  {
    "text": "great example when there's like this many different volume sources so if we",
    "start": "1292110",
    "end": "1297420"
  },
  {
    "text": "had a discriminator that said what what volume you intended to use like the subsystem could know to like if you send",
    "start": "1297420",
    "end": "1302970"
  },
  {
    "text": "it with this new thing set we know that hey we should clear the others because you didn't intend to set the others",
    "start": "1302970",
    "end": "1309120"
  },
  {
    "text": "right so if you have like like for example a client that didn't understand the others because it's an old client",
    "start": "1309120",
    "end": "1314400"
  },
  {
    "text": "and some of then you set new and and so you couldn't have cleared it because your client didn't understand that field",
    "start": "1314400",
    "end": "1320640"
  },
  {
    "text": "so that's that's that's just an example of the sort of thing that I think we can add here another another next step",
    "start": "1320640",
    "end": "1328260"
  },
  {
    "text": "and I don't know I don't know if Stefan is gonna hate me for this or not but I really think the the schema language",
    "start": "1328260",
    "end": "1334410"
  },
  {
    "text": "that we came up with is more appropriate for defining kubernetes style abdi sources than the open API spec that CRT",
    "start": "1334410",
    "end": "1342840"
  },
  {
    "text": "CRT is take today is maybe maybe this is just me but I I'm very concerned that",
    "start": "1342840",
    "end": "1348690"
  },
  {
    "text": "open API lets you specify literally anything so so I like that the the",
    "start": "1348690",
    "end": "1355320"
  },
  {
    "text": "schema that we are describing these things in is much more more constraining because the kubernetes api does not",
    "start": "1355320",
    "end": "1362250"
  },
  {
    "text": "support literally anything like it's very much built out of the things we don't let you do because that's that's",
    "start": "1362250",
    "end": "1368309"
  },
  {
    "text": "how you get consistency is like you have to the space of possible API objects is enormous like we've got to narrow that",
    "start": "1368309",
    "end": "1374280"
  },
  {
    "text": "down and and and and only permit a certain subset of that to enable interoperability and all the all the",
    "start": "1374280",
    "end": "1380309"
  },
  {
    "text": "things you get with the kubernetes api so yeah that was a lot of talking should",
    "start": "1380309",
    "end": "1385650"
  },
  {
    "text": "we do Q&A yeah here all I'll walk around with a microphone and Stefan can set up",
    "start": "1385650",
    "end": "1392340"
  },
  {
    "text": "here and answer all the questions right",
    "start": "1392340",
    "end": "1399540"
  },
  {
    "text": "from the discriminated unions but we specifically don't allow one of in the",
    "start": "1399540",
    "end": "1405690"
  },
  {
    "text": "validation object currently so what's the justification there I think was a",
    "start": "1405690",
    "end": "1411110"
  },
  {
    "text": "CPU intensive operation to do the validation check with the discriminated",
    "start": "1411110",
    "end": "1418290"
  },
  {
    "text": "Union you're saying that we would have a field that would tell us what to check for to see if it's set you're talking",
    "start": "1418290",
    "end": "1424500"
  },
  {
    "text": "about the open API spec in C or D schema correct yeah yeah yeah",
    "start": "1424500",
    "end": "1430470"
  },
  {
    "text": "open API in particular lets you mix up schema level concerns with value level",
    "start": "1430470",
    "end": "1436650"
  },
  {
    "text": "concerns which are really two different phases and the kubernetes pipeline so",
    "start": "1436650",
    "end": "1441860"
  },
  {
    "text": "yeah Stefan I could probably say yeah there's one office performance reasons",
    "start": "1441860",
    "end": "1447000"
  },
  {
    "text": "so you can easily construct something which is exponentially or something in invalidation because it's open API",
    "start": "1447000",
    "end": "1455309"
  },
  {
    "text": "strange behaviour strange property it embeds logic propositional logic completely so that's why we're",
    "start": "1455309",
    "end": "1462530"
  },
  {
    "text": "that it's not healthy for validation yes so if we did for example switch the",
    "start": "1462530",
    "end": "1468380"
  },
  {
    "text": "schema like I was saying then we could efficiently implement that yeah so with",
    "start": "1468380",
    "end": "1478940"
  },
  {
    "text": "the with the server-side apply and encoding parts of the schema and who",
    "start": "1478940",
    "end": "1484880"
  },
  {
    "text": "they're managed by how does that interoperate with conversion like going",
    "start": "1484880",
    "end": "1491150"
  },
  {
    "text": "between different schemas yeah so that's that's a great question and in fact one of the yeah so thank you for asking",
    "start": "1491150",
    "end": "1499010"
  },
  {
    "text": "about one of the reasons why my original design did not involve the fieldset",
    "start": "1499010",
    "end": "1504200"
  },
  {
    "text": "approach is because I thought we were going to be able to reuse the conversion",
    "start": "1504200",
    "end": "1510410"
  },
  {
    "text": "functions unfortunately the conversion functions the built-in ones all make certain",
    "start": "1510410",
    "end": "1516320"
  },
  {
    "text": "assumptions about the object like the defaults are set which are actually not applicable to things that you run",
    "start": "1516320",
    "end": "1523370"
  },
  {
    "text": "through apply because apply is actually a subset of the object is is not the entire object it's just the fields that",
    "start": "1523370",
    "end": "1528710"
  },
  {
    "text": "you want to manage so we realized that that was going to be difficult and David",
    "start": "1528710",
    "end": "1535910"
  },
  {
    "text": "pointed this out I had I had an approach but after thinking about it carefully",
    "start": "1535910",
    "end": "1542840"
  },
  {
    "text": "and I wrote up a design that actually solved the problem without doing any",
    "start": "1542840",
    "end": "1548150"
  },
  {
    "text": "conversions by doing a fancy like doing extra operations on both sides which I",
    "start": "1548150",
    "end": "1553400"
  },
  {
    "text": "won't be able to reproduce off the top of my head so I got to go back up my document but the fun thing about the the",
    "start": "1553400",
    "end": "1558710"
  },
  {
    "text": "fun thing about the design is that it worked on the fieldset approach too so kind of it's not that we went down the",
    "start": "1558710",
    "end": "1564710"
  },
  {
    "text": "wrong direction it's that we discovered this thing that unblocked the the better design so so yeah we won't have to call",
    "start": "1564710",
    "end": "1571420"
  },
  {
    "text": "conversions and basically we let the user call the conversions for us yeah",
    "start": "1571420",
    "end": "1578390"
  },
  {
    "text": "it's fun I saw yeah",
    "start": "1578390",
    "end": "1583660"
  },
  {
    "text": "yeah I have a question what's the current status of orc the current thinking on custom sub resources for CDs",
    "start": "1586480",
    "end": "1595320"
  },
  {
    "text": "yeah so there was some discussion about allowing that books for them I guess",
    "start": "1595409",
    "end": "1601240"
  },
  {
    "text": "this was for most problems there's no design written down I think that's just missing I'm not sure whether we have",
    "start": "1601240",
    "end": "1608980"
  },
  {
    "text": "consensus that we want that it wouldn't harm that's my opinion",
    "start": "1608980",
    "end": "1615539"
  },
  {
    "text": "I feel like it would be nifty if the aggregator let you register would proxy",
    "start": "1617639",
    "end": "1626950"
  },
  {
    "text": "your sub resources to you that would let us move the existing weird sub resources",
    "start": "1626950",
    "end": "1632200"
  },
  {
    "text": "out to external components which would make me happy so in one of the keynotes",
    "start": "1632200",
    "end": "1643929"
  },
  {
    "text": "yesterday someone declared that kubernetes is boring and all of this",
    "start": "1643929",
    "end": "1649149"
  },
  {
    "text": "stuff looks distinctly not boring and like the playing field is moving at what",
    "start": "1649149",
    "end": "1656980"
  },
  {
    "text": "point do you imagine that some of this will start to get boring and stable to the point where people rather than",
    "start": "1656980",
    "end": "1664419"
  },
  {
    "text": "looking at wrapping cube control to do their management say you know oh hey I",
    "start": "1664419",
    "end": "1669760"
  },
  {
    "text": "can build a client you know use client go and get most of the same functionality wow that's a yeah I think",
    "start": "1669760",
    "end": "1679750"
  },
  {
    "text": "our particular corner of the world is not going to get boring for a little while yet I've got a long list of things to do and I think we're a little",
    "start": "1679750",
    "end": "1688510"
  },
  {
    "text": "bottleneck both and like spelling out the things we want to do and and people taking those things up and doing them",
    "start": "1688510",
    "end": "1694389"
  },
  {
    "text": "and and and reviewing the changes because because there's there's actually not that many high-level reviewers for",
    "start": "1694389",
    "end": "1701500"
  },
  {
    "text": "API machinery so we're a little we've got we've got a number of bottlenecks yeah so yeah it would be I would love",
    "start": "1701500",
    "end": "1709090"
  },
  {
    "text": "for this stuff to be become boring but I I don't see it happening this year",
    "start": "1709090",
    "end": "1715260"
  },
  {
    "text": "maybe not next year I don't know it depends on how far we go sorry yes I",
    "start": "1715650",
    "end": "1722220"
  },
  {
    "text": "it's definitely not gonna get boring this year it's gonna get more interesting this year okay yeah sorry Ida spoken with Stefan about",
    "start": "1722220",
    "end": "1732460"
  },
  {
    "text": "this before but validating and mutating my books are commonly also registered",
    "start": "1732460",
    "end": "1739060"
  },
  {
    "text": "with CR DS and now we have the storage conversion it is actually configured on the C or D is there any possibility of",
    "start": "1739060",
    "end": "1747270"
  },
  {
    "text": "being able to configure yourself as a validating and mutating web book on the",
    "start": "1747270",
    "end": "1753280"
  },
  {
    "text": "CR D and then a follow up would be can we do a health check to see that the web",
    "start": "1753280",
    "end": "1760120"
  },
  {
    "text": "book is available and provide that in the status of the C or D yeah those were",
    "start": "1760120",
    "end": "1766990"
  },
  {
    "text": "both good questions let me tackle the second one first which is like could we",
    "start": "1766990",
    "end": "1773380"
  },
  {
    "text": "have health checks for these things I actually so in my role at Google we",
    "start": "1773380",
    "end": "1780910"
  },
  {
    "text": "operate many clusters and so I have this sort of side a project or idea is the",
    "start": "1780910",
    "end": "1789220"
  },
  {
    "text": "control plane needs to be compartmental I really need some areas of it to be",
    "start": "1789220",
    "end": "1794290"
  },
  {
    "text": "able to fail without bringing down the whole thing so in particular these web",
    "start": "1794290",
    "end": "1799720"
  },
  {
    "text": "hooks are a source of concern but importantly to the extent possible I",
    "start": "1799720",
    "end": "1805630"
  },
  {
    "text": "want the conversion or admission control",
    "start": "1805630",
    "end": "1811870"
  },
  {
    "text": "web hooks I want them to be able to fail without bringing down the whole cluster it may not be possible if you register",
    "start": "1811870",
    "end": "1817120"
  },
  {
    "text": "something that does cover the whole cluster but at the very least I want the cluster administrator to be able to look",
    "start": "1817120",
    "end": "1823900"
  },
  {
    "text": "at it edit at a dashboard and be like these these these are all the web hooks",
    "start": "1823900",
    "end": "1829330"
  },
  {
    "text": "that we're calling this is like I don't know the last hours worth of calls or something this is the successes of",
    "start": "1829330",
    "end": "1835120"
  },
  {
    "text": "failures the like failure to reach it basically I think the cluster administrator needs to be able to",
    "start": "1835120",
    "end": "1841450"
  },
  {
    "text": "quickly route see that hey something is broken I go to the Status page this is",
    "start": "1841450",
    "end": "1847090"
  },
  {
    "text": "the thing that's broken at the very least so a health check could help that in a busy",
    "start": "1847090",
    "end": "1853530"
  },
  {
    "text": "cluster it's gonna be called a lot which is sort of the same thing I guess but",
    "start": "1853530",
    "end": "1859110"
  },
  {
    "text": "yeah and the other question was all those all those webhooks that's a lot of work folks couldn't we configure them all in one place and maybe all at the",
    "start": "1859110",
    "end": "1867900"
  },
  {
    "text": "same time or maybe just say hey I have this component I wanted to handle all aspects of this I think that's like an",
    "start": "1867900",
    "end": "1874620"
  },
  {
    "text": "API design and upgradability thing and also a security security thing because",
    "start": "1874620",
    "end": "1881039"
  },
  {
    "text": "the ability to put a admission webhook on all resources of the system is has",
    "start": "1881039",
    "end": "1886710"
  },
  {
    "text": "security implications but it makes sense to me that a C or D author should be",
    "start": "1886710",
    "end": "1892799"
  },
  {
    "text": "able to register the things just for their C or D and whether that means like an external component like then goes and",
    "start": "1892799",
    "end": "1900330"
  },
  {
    "text": "makes the necessary entries on their behalf that's that's the most obvious way to do it I don't know Stefan do you have I",
    "start": "1900330",
    "end": "1906030"
  },
  {
    "text": "just remember that we discussed exactly the thing yeah we've uh we've definitely discussed this before yeah the ins of proposer for conversion I think there",
    "start": "1906030",
    "end": "1912659"
  },
  {
    "text": "was some chapter where we yeah had long thoughts about that as I should be it this year D or something like that",
    "start": "1912659",
    "end": "1919909"
  },
  {
    "text": "yeah yeah I think actually the the admission control webhooks",
    "start": "1934430",
    "end": "1940670"
  },
  {
    "text": "the design the the objects there may need a some tweaks in their design because right now you register for",
    "start": "1940670",
    "end": "1947000"
  },
  {
    "text": "particular versions of resources which means that like if you actually wanted",
    "start": "1947000",
    "end": "1952460"
  },
  {
    "text": "to to run on a deployment no matter how the user sent the deployment to the system you have to be careful to do that",
    "start": "1952460",
    "end": "1959300"
  },
  {
    "text": "correctly today so I think that we can do better we just haven't had the like",
    "start": "1959300",
    "end": "1964670"
  },
  {
    "text": "this is kind of far down on our list of I've got so much other things to do is",
    "start": "1964670",
    "end": "1976820"
  },
  {
    "text": "there any work being done on control plane fairness between clients yeah that",
    "start": "1976820",
    "end": "1983600"
  },
  {
    "text": "is a great question I think it is actually going to be a priority for us",
    "start": "1983600",
    "end": "1989630"
  },
  {
    "text": "and q1 yeah my team specifically I I was",
    "start": "1989630",
    "end": "1996110"
  },
  {
    "text": "actually wandering around to various other places earlier in the conference",
    "start": "1996110",
    "end": "2003330"
  },
  {
    "text": "asking folks hey why don't you come and help us submit a design there is a there",
    "start": "2003330",
    "end": "2009580"
  },
  {
    "text": "is somebody has a cap out I know I asked for some changes on that I haven't come",
    "start": "2009580",
    "end": "2015670"
  },
  {
    "text": "back and seen the responses yet and I think David and I are mostly on the same page with what we need this basically",
    "start": "2015670",
    "end": "2021760"
  },
  {
    "text": "like we want some sort of bucketing system like like that's very cheap to take a incoming request figure out what",
    "start": "2021760",
    "end": "2028210"
  },
  {
    "text": "buckets it bucket is is in and then some sort of quota system for the for the individual buckets and there's but",
    "start": "2028210",
    "end": "2035530"
  },
  {
    "text": "there's it's not clear like if you have multiple API server replicas we don't want to yeah it's it's a little like we",
    "start": "2035530",
    "end": "2042760"
  },
  {
    "text": "need to be careful to make sure that that works right",
    "start": "2042760",
    "end": "2046950"
  },
  {
    "text": "yeah that's a concern of mine - I don't think quotas are going to do it fairness is different from rate limiting",
    "start": "2049450",
    "end": "2056770"
  },
  {
    "text": "you can't set the rate limits in a good way to get good fairness so there's separate",
    "start": "2056770",
    "end": "2062450"
  },
  {
    "text": "issues yeah maybe I should say the a little bit more like I think we actually",
    "start": "2062450",
    "end": "2068330"
  },
  {
    "text": "need at least two tiers in the system tier one is like guaranteed and the",
    "start": "2068330",
    "end": "2073669"
  },
  {
    "text": "purpose of this is to make sure that your cubelet your scheduler your controllers always can get the the QPS",
    "start": "2073669",
    "end": "2080510"
  },
  {
    "text": "that they need and then unused like the API server needs to have some sort of",
    "start": "2080510",
    "end": "2085520"
  },
  {
    "text": "understanding of how many requests it can handle and so anything not consumed by Tier one can be resold I'll say at",
    "start": "2085520",
    "end": "2092898"
  },
  {
    "text": "tier 2 and that can be allocated more bursty manner but it's not guaranteed so",
    "start": "2092899",
    "end": "2099620"
  },
  {
    "text": "yeah definitely the design needs to be fair have prioritization there's like",
    "start": "2099620",
    "end": "2106820"
  },
  {
    "text": "two other there's two other things that are a complete solution yeah so I think",
    "start": "2106820",
    "end": "2113630"
  },
  {
    "text": "you feel better ok I know we've actually talked about this",
    "start": "2113630",
    "end": "2119990"
  },
  {
    "text": "before so let's make sure you'll see",
    "start": "2119990",
    "end": "2125060"
  },
  {
    "text": "you'll see the design before we do things and you can tell us if we get it wrong",
    "start": "2125060",
    "end": "2131320"
  },
  {
    "text": "what's the plan for initializers Stefan",
    "start": "2138050",
    "end": "2143130"
  },
  {
    "text": "do you want to say that I think I heard this Katherine's about removing them completely yeah",
    "start": "2143130",
    "end": "2148860"
  },
  {
    "text": "not nothing especially not in the other direction nothing about Peter yeah so there's a specific proposal for",
    "start": "2148860",
    "end": "2155520"
  },
  {
    "text": "namespaces to keep initializers for namespaces I personally kind of feel",
    "start": "2155520",
    "end": "2160530"
  },
  {
    "text": "like we should generalize it to all container typed but we only have namespaces at the moment so it doesn't",
    "start": "2160530",
    "end": "2166320"
  },
  {
    "text": "really matter but yeah they're going away web hooks are better experience for people for people I notice on the slide",
    "start": "2166320",
    "end": "2179700"
  },
  {
    "text": "about series that at the very bottom you have a local namespace your DS as an",
    "start": "2179700",
    "end": "2185940"
  },
  {
    "text": "undecided thing yeah I have it here because it's requested so often okay but",
    "start": "2185940",
    "end": "2191190"
  },
  {
    "text": "I've not seen anybody who has no idea how to do that without breaking all the assumptions we have in our machinery so",
    "start": "2191190",
    "end": "2197870"
  },
  {
    "text": "it's the last thing in open I decided topics and it's really undecided and totally hope so right",
    "start": "2197870",
    "end": "2205050"
  },
  {
    "text": "we're over time so maybe one last question [Music] and so like with the operative pattern",
    "start": "2205050",
    "end": "2211830"
  },
  {
    "text": "and everything that is the like new use cases coming up and like third-party",
    "start": "2211830",
    "end": "2217530"
  },
  {
    "text": "resources are being maintained by CR DS for things like history or something",
    "start": "2217530",
    "end": "2222690"
  },
  {
    "text": "then total number of objects may not matter that much but the if the real use",
    "start": "2222690",
    "end": "2228210"
  },
  {
    "text": "cases are for like maintaining thousands of third party or like external",
    "start": "2228210",
    "end": "2234150"
  },
  {
    "text": "resources that scalability becomes a problem as well as kind of like the backing of two objects in ECD and",
    "start": "2234150",
    "end": "2241770"
  },
  {
    "text": "everything is are those concerns concerns of desig or does any other sake",
    "start": "2241770",
    "end": "2248160"
  },
  {
    "text": "or any other group is looking at it yeah scalability is something we're",
    "start": "2248160",
    "end": "2254370"
  },
  {
    "text": "aware of especially if people make tons of objects I know we have a entire",
    "start": "2254370",
    "end": "2263820"
  },
  {
    "text": "scalability sig and we're also going to have to be concerned about this in our",
    "start": "2263820",
    "end": "2270610"
  },
  {
    "text": "so because we at least at the very least we own the API server to storage back in",
    "start": "2270610",
    "end": "2276130"
  },
  {
    "text": "like that pathway some ideas I have are like sharding like make multiple shards",
    "start": "2276130",
    "end": "2285970"
  },
  {
    "text": "so controllers can only watch a shard instead of having to operate over every namespace in the system to get super big",
    "start": "2285970",
    "end": "2293620"
  },
  {
    "text": "we will have to improve vet CD I think",
    "start": "2293620",
    "end": "2298770"
  },
  {
    "text": "or or or do something if we if we do it right you can imagine an Etsy v cluster",
    "start": "2298770",
    "end": "2304450"
  },
  {
    "text": "per shark maybe yeah this yep",
    "start": "2304450",
    "end": "2320290"
  },
  {
    "text": "plugging in your own storage is fraught with difficulty but maybe maybe that's",
    "start": "2320290",
    "end": "2326410"
  },
  {
    "text": "just one thing missing so we have some option I think some flag to redirect certain resources it's unfortunately not",
    "start": "2326410",
    "end": "2332200"
  },
  {
    "text": "used in the CID server so it's just I would call just about to do to use that",
    "start": "2332200",
    "end": "2337570"
  },
  {
    "text": "and you just simply use case of half a second CD cluster all right thank you everybody",
    "start": "2337570",
    "end": "2343500"
  },
  {
    "text": "[Applause]",
    "start": "2343500",
    "end": "2347449"
  }
]