[
  {
    "text": "my name is Tolliver [Music] yeah Oliver from planet-scale I'm in",
    "start": "30",
    "end": "7830"
  },
  {
    "text": "software engineer and this is Japan g10 is the CEO of Planet scale so if you",
    "start": "7830",
    "end": "16529"
  },
  {
    "text": "have all any questions you just asked you I'm here just to look pretty so",
    "start": "16529",
    "end": "29849"
  },
  {
    "text": "today we're talking we're gonna talk about vid tests and which is and this is",
    "start": "29849",
    "end": "34860"
  },
  {
    "text": "called stateful storage on kubernetes [Music]",
    "start": "34860",
    "end": "40879"
  },
  {
    "text": "pinghua the testers think all the Rinne",
    "start": "40879",
    "end": "47180"
  },
  {
    "text": "yep young my sequel my sequel who uses my sequel okay good so maybe this is for",
    "start": "47360",
    "end": "56340"
  },
  {
    "text": "you so anyway okay oh yeah okay plenty",
    "start": "56340",
    "end": "67080"
  },
  {
    "text": "of these alright so what is the tests",
    "start": "67080",
    "end": "74810"
  },
  {
    "text": "the tests Tsushima right it's the sharding middleware or my",
    "start": "74810",
    "end": "82110"
  },
  {
    "text": "sequel starting something peon I think pintia something and it what's beautiful",
    "start": "82110",
    "end": "88350"
  },
  {
    "text": "is this massively scalable and it provides high availability like five",
    "start": "88350",
    "end": "96060"
  },
  {
    "text": "nines availability and it's cloud native",
    "start": "96060",
    "end": "102570"
  },
  {
    "text": "so kubernetes etc how many people use kubernetes how many don't use kubernetes",
    "start": "102570",
    "end": "109820"
  },
  {
    "text": "no Coubertin Oh everyone's good burn eighties Oh even better great so who uses Vitesse Shay the test",
    "start": "109820",
    "end": "121829"
  },
  {
    "text": "you know so this cash app is a square cash that's like we seen the pay but for",
    "start": "121829",
    "end": "131670"
  },
  {
    "text": "us also YouTube the test came from YouTube originally so they use it not Burger",
    "start": "131670",
    "end": "140360"
  },
  {
    "text": "King and not Instagram yes but those like the top apps in the US and so",
    "start": "140360",
    "end": "148159"
  },
  {
    "text": "they're using it so here are some of the",
    "start": "148159",
    "end": "153769"
  },
  {
    "text": "key adopters [Music]",
    "start": "153769",
    "end": "158909"
  },
  {
    "text": "how many heard of JD ding dong yeah so ding dong uses a lot of the tests",
    "start": "160700",
    "end": "166690"
  },
  {
    "text": "they're the one of the biggest users in the world of the test and they have",
    "start": "166690",
    "end": "172450"
  },
  {
    "text": "3,000 or more databases and they have",
    "start": "172450",
    "end": "177730"
  },
  {
    "text": "18,000 or more tablets or my sequel instances so you know more than just one",
    "start": "177730",
    "end": "182900"
  },
  {
    "text": "so many and maybe you guys don't use slack as much but slack even them at",
    "start": "182900",
    "end": "191930"
  },
  {
    "text": "least a 1/4 25% have changed to Vitesse so all the chatting is saved in the",
    "start": "191930",
    "end": "199130"
  },
  {
    "text": "tests again before square cache also in Pinterest I don't know if you know what",
    "start": "199130",
    "end": "205819"
  },
  {
    "text": "Pinterest is so Pinterest also uses it for a lot of their advertising so yeah",
    "start": "205819",
    "end": "213380"
  },
  {
    "text": "so these are some of the many adopters and as there are adopters there's also a",
    "start": "213380",
    "end": "220880"
  },
  {
    "text": "lot of people contributing you know changes Pete pr2 and so includes lots of",
    "start": "220880",
    "end": "230239"
  },
  {
    "text": "these companies and they all of course are using the tests in production",
    "start": "230239",
    "end": "236530"
  },
  {
    "text": "am i speaking too fast too slow okay",
    "start": "236530",
    "end": "242640"
  },
  {
    "text": "me with you back all right so yeah I want you to think from now on if you",
    "start": "242640",
    "end": "248790"
  },
  {
    "text": "think kubernetes and you want to store state stateful storage I want you to",
    "start": "248790",
    "end": "253860"
  },
  {
    "text": "think the tests okay why is that there's actually someone",
    "start": "253860",
    "end": "261079"
  },
  {
    "text": "some famous an Internet person who says if you if you want to run stateful",
    "start": "261080",
    "end": "268850"
  },
  {
    "text": "applications on kubernetes you're pretty stupid it's too hard and and we agree",
    "start": "268850",
    "end": "275790"
  },
  {
    "text": "it's not easy but and the reason is one",
    "start": "275790",
    "end": "281910"
  },
  {
    "text": "does not simply move my sequel to kubernetes because if you just try to do that if you're gonna run into many",
    "start": "281910",
    "end": "288540"
  },
  {
    "text": "problems you know your pods going down you're whatever going down everything goes down right who has a service that's",
    "start": "288540",
    "end": "296040"
  },
  {
    "text": "perfect never goes down anyone go down at all okay people who go down raise",
    "start": "296040",
    "end": "302460"
  },
  {
    "text": "your hand only three people have rungs okay then",
    "start": "302460",
    "end": "307500"
  },
  {
    "text": "you don't need anything so just a few",
    "start": "307500",
    "end": "313680"
  },
  {
    "text": "things about the test the test started in 2010 and that's when YouTube YouTube",
    "start": "313680",
    "end": "323190"
  },
  {
    "text": "who knows what YouTube is it's like you cool or or not China okay so yeah so",
    "start": "323190",
    "end": "333169"
  },
  {
    "text": "YouTube had started running into scaling problems with my sequel like many of you",
    "start": "333169",
    "end": "338850"
  },
  {
    "text": "they had just one super big my sequel instance of course they had some backups and some replicas but you know they",
    "start": "338850",
    "end": "346110"
  },
  {
    "text": "could had too much traffic and probably many of you know web sites in China",
    "start": "346110",
    "end": "351690"
  },
  {
    "text": "Vietnam all you guys have lots of web traffic so YouTube ran into some problem",
    "start": "351690",
    "end": "358380"
  },
  {
    "text": "and then so they needed to deal with it and they have a big apps right they",
    "start": "358380",
    "end": "364680"
  },
  {
    "text": "don't want to rewrite so the test since it in 2010 they're kubernetes kubernetes",
    "start": "364680",
    "end": "371160"
  },
  {
    "text": "was just is five years old now and the test is older than five years old",
    "start": "371160",
    "end": "376570"
  },
  {
    "text": "so but it was designed for Borg so Borg is the precursor the Google precursor to",
    "start": "376570",
    "end": "384690"
  },
  {
    "text": "kubernetes so Vitesse I think oh so the",
    "start": "384690",
    "end": "391150"
  },
  {
    "text": "test was designed really for really for kubernetes as well because it's all the",
    "start": "391150",
    "end": "396550"
  },
  {
    "text": "same ideas so yeah production workloads",
    "start": "396550",
    "end": "401610"
  },
  {
    "text": "so besides YouTube of course stitch labs is the oldest one",
    "start": "401610",
    "end": "407260"
  },
  {
    "text": "so they started using in 2016 a few years ago and then HubSpot has many key",
    "start": "407260",
    "end": "412690"
  },
  {
    "text": "spaces or it may be databases as you may call them and JD has 3000 databases with",
    "start": "412690",
    "end": "421810"
  },
  {
    "text": "as I said before 18,000 Ã«one bhatia tablet whoa right and they have I think",
    "start": "421810",
    "end": "429160"
  },
  {
    "text": "they said 67 shards now the ocean of teeth or something on their largest they",
    "start": "429160",
    "end": "436690"
  },
  {
    "text": "have many databases but that's just their largest one and then there's another company here nozzle and they",
    "start": "436690",
    "end": "444520"
  },
  {
    "text": "migrate even between the clouds so you know here you know hey I'll Union and you have Huawei Union or something and",
    "start": "444520",
    "end": "450550"
  },
  {
    "text": "you and you want to migrate from one to another so they do that so you don't have to be tied to one cloud so and this",
    "start": "450550",
    "end": "463270"
  },
  {
    "text": "was what I thought it was coming after so my sequel before right it's a old",
    "start": "463270",
    "end": "468850"
  },
  {
    "text": "software very good but it was they merely adopted the cloud whereas the",
    "start": "468850",
    "end": "474280"
  },
  {
    "text": "test was born in the cloud right it was made for Borg which is before kubernetes",
    "start": "474280",
    "end": "481210"
  },
  {
    "text": "so so the whole point is it is cloud native like it does not it did not exist",
    "start": "481210",
    "end": "487360"
  },
  {
    "text": "without the cloud so here is the the",
    "start": "487360",
    "end": "494140"
  },
  {
    "text": "concrete architecture of the tests how",
    "start": "494140",
    "end": "500830"
  },
  {
    "text": "many of you guys are running apps that are connecting to my sequel everyone yeah okay",
    "start": "500830",
    "end": "507930"
  },
  {
    "text": "I'm gonna stand over here is that okay yeah okay so the general architecture",
    "start": "508289",
    "end": "517268"
  },
  {
    "text": "the test tries not to break anything you have big apps they're running lots",
    "start": "517269",
    "end": "522459"
  },
  {
    "text": "of traffic you don't want to break anything so before you have your app servers here right and they used to talk",
    "start": "522459",
    "end": "529990"
  },
  {
    "text": "to a big my sequel database right and they use my sequel binary protocol to",
    "start": "529990",
    "end": "536680"
  },
  {
    "text": "connect right but the tests is all of these blue purple color so they're this",
    "start": "536680",
    "end": "545769"
  },
  {
    "text": "part and these parts so it's a proxy to",
    "start": "545769",
    "end": "553570"
  },
  {
    "text": "all of my sequels and under the covers for or saving the data is actually my",
    "start": "553570",
    "end": "561850"
  },
  {
    "text": "sequel so you guys you we can actually migrate your my sequel workloads into",
    "start": "561850",
    "end": "567820"
  },
  {
    "text": "the tests actually pretty easily so what's important here is between the app",
    "start": "567820",
    "end": "574360"
  },
  {
    "text": "server and what is these BT gate these are the proxy they speak my sequel",
    "start": "574360",
    "end": "580480"
  },
  {
    "text": "binary protocol right here okay and there's a custom protocol here",
    "start": "580480",
    "end": "586510"
  },
  {
    "text": "between these blue parts and then all of these this software the tablet connect",
    "start": "586510",
    "end": "593470"
  },
  {
    "text": "to actual my sequel instances under the covers and they only talk this way does",
    "start": "593470",
    "end": "599680"
  },
  {
    "text": "that make sense so far all right",
    "start": "599680",
    "end": "606180"
  },
  {
    "text": "so but why would you want to use the tests I mean some not everyone has you",
    "start": "606890",
    "end": "613200"
  },
  {
    "text": "know dingdong size workloads or YouTube size their yoke yuko or clothes right so",
    "start": "613200",
    "end": "620160"
  },
  {
    "text": "why would you want to use it I mean if you have a small workload like so what",
    "start": "620160",
    "end": "626550"
  },
  {
    "text": "are the benefits of using the tests so this was your DV right now right works",
    "start": "626550",
    "end": "632220"
  },
  {
    "text": "just fine it's all good but you can actually already put the tests in",
    "start": "632220",
    "end": "637649"
  },
  {
    "text": "between your main DB and the app servers and when you do that it provides",
    "start": "637649",
    "end": "644220"
  },
  {
    "text": "automatic connection pooling it does deadlines like if you have very long",
    "start": "644220",
    "end": "650430"
  },
  {
    "text": "running queries you know if you have an analysis it also provides hot row",
    "start": "650430",
    "end": "656339"
  },
  {
    "text": "protection so if you have many apps trying to get exactly one row and it",
    "start": "656339",
    "end": "663360"
  },
  {
    "text": "will stop in and pause that while giving other people quality of service good quality of service and also yeah",
    "start": "663360",
    "end": "671310"
  },
  {
    "text": "enforces row count limits so not too large queries and it can also blacklist",
    "start": "671310",
    "end": "676500"
  },
  {
    "text": "tables like if you don't want certain applications to access certain things",
    "start": "676500",
    "end": "681839"
  },
  {
    "text": "you can in the because it's a proxy it can also say oh I don't want you to access this and you can cut off usage so",
    "start": "681839",
    "end": "690149"
  },
  {
    "text": "even for smaller workloads it's okay to use this because it provides benefits",
    "start": "690149",
    "end": "695730"
  },
  {
    "text": "for your application your application developers sometimes they make mistakes",
    "start": "695730",
    "end": "701930"
  },
  {
    "text": "have bugs and then it won't take down the database for everyone else does that",
    "start": "701930",
    "end": "707850"
  },
  {
    "text": "make sense that's where smaller workloads but then once you've put it in you now have some",
    "start": "707850",
    "end": "714660"
  },
  {
    "text": "bet more benefit well as you start growing your workload so again before",
    "start": "714660",
    "end": "721140"
  },
  {
    "text": "you had only the single database and maybe you had a few backups or replicas",
    "start": "721140",
    "end": "726390"
  },
  {
    "text": "but with your growing workload you can",
    "start": "726390",
    "end": "732089"
  },
  {
    "text": "you had your previous main database the master but but with the tests since it",
    "start": "732089",
    "end": "738810"
  },
  {
    "text": "can it actually can parse all of the my sequel sequel it can actually decide to",
    "start": "738810",
    "end": "745800"
  },
  {
    "text": "be smarter it can do replica routing it can decide oh all you're doing our",
    "start": "745800",
    "end": "750840"
  },
  {
    "text": "select statements and decide oh you don't need to access everything so you",
    "start": "750840",
    "end": "756570"
  },
  {
    "text": "can go straight to our replicas to actually do the selects and thus it can",
    "start": "756570",
    "end": "762060"
  },
  {
    "text": "also do load balancing you know we have more more connections and whatnot and you can then use Orchestrator as well if",
    "start": "762060",
    "end": "768990"
  },
  {
    "text": "you need high availability h8 to do failover or our promotion so you can",
    "start": "768990",
    "end": "776820"
  },
  {
    "text": "choose one replica oh I want this one to become the master and you can swap them",
    "start": "776820",
    "end": "781920"
  },
  {
    "text": "and to the all the apps it's invisible so it's just all natural so remember my",
    "start": "781920",
    "end": "789570"
  },
  {
    "text": "sequel protocol only happens here and then oh this is only management DBA",
    "start": "789570",
    "end": "795030"
  },
  {
    "text": "access that make sense why as you're",
    "start": "795030",
    "end": "800400"
  },
  {
    "text": "growing the workloads if you have a lot of read traffic you can add more replicas no one knows the difference and",
    "start": "800400",
    "end": "809750"
  },
  {
    "text": "now you have even more traffic or too much too much data to fit on one disk or",
    "start": "809750",
    "end": "816480"
  },
  {
    "text": "many disk so you can do a few things and so with here with their growing workload",
    "start": "816480",
    "end": "824010"
  },
  {
    "text": "I can split before I had only main DB will call it DV 1 right and you had all",
    "start": "824010",
    "end": "831270"
  },
  {
    "text": "of the traffic going there and so you had to have a disk that's big enough or",
    "start": "831270",
    "end": "836880"
  },
  {
    "text": "all of your data right but now we want imagine you have two big tables you know",
    "start": "836880",
    "end": "844170"
  },
  {
    "text": "they're growing growing growing big and then they're gonna blow up in one table so why don't we split them into two",
    "start": "844170",
    "end": "849900"
  },
  {
    "text": "different ones right so with this you can split table one like which is big in",
    "start": "849900",
    "end": "857190"
  },
  {
    "text": "to keep it in database one and then you have another big table table to moving",
    "start": "857190",
    "end": "864030"
  },
  {
    "text": "into database to so yes you have now you know table 1 in database 1 in table 2 in",
    "start": "864030",
    "end": "871410"
  },
  {
    "text": "database 2 to your application server because again",
    "start": "871410",
    "end": "877289"
  },
  {
    "text": "it's proxying you can have a unified view you can see both table 1 and table 2 like they were all in one big my",
    "start": "877289",
    "end": "886079"
  },
  {
    "text": "sequel so and again just like before each of the database one you can have",
    "start": "886079",
    "end": "892259"
  },
  {
    "text": "many replicas and database 2 has different numbers of replicas make sense",
    "start": "892259",
    "end": "897949"
  },
  {
    "text": "so also you can with this proxy you can do the space sub setting you can decide",
    "start": "897949",
    "end": "905009"
  },
  {
    "text": "your application can only see table 1 and table 2 and different application",
    "start": "905009",
    "end": "910409"
  },
  {
    "text": "can only see table 3 and table 4 so you can split that way to alright and as you",
    "start": "910409",
    "end": "921689"
  },
  {
    "text": "grow even bigger remember a table 2 was here but table runs growing really really fast right and maybe you're a big",
    "start": "921689",
    "end": "930359"
  },
  {
    "text": "ecommerce website like Jing dome and they decide oh we actually we have too",
    "start": "930359",
    "end": "936599"
  },
  {
    "text": "much right traffic we're we have too many orders happening all the time and so table table 1 it can be horizontally",
    "start": "936599",
    "end": "944639"
  },
  {
    "text": "charted so in this example here we see 3 different shards so just table 1 we can",
    "start": "944639",
    "end": "953249"
  },
  {
    "text": "split into 1/3 1/3 1/3 and and it will go to separate instances so you can have",
    "start": "953249",
    "end": "960869"
  },
  {
    "text": "now three times the right traffic and you can still have many more times also",
    "start": "960869",
    "end": "967049"
  },
  {
    "text": "the read traffic and you can control that quality of service there and whereas table 2 didn't grow very",
    "start": "967049",
    "end": "974129"
  },
  {
    "text": "much it's pretty constant but still big and it will have a different quality of service right here but again to the app",
    "start": "974129",
    "end": "982379"
  },
  {
    "text": "server it will all still look like one super big database make sense so far",
    "start": "982379",
    "end": "989539"
  },
  {
    "text": "good so and then you get really really big right um so this is again a ding",
    "start": "989539",
    "end": "999089"
  },
  {
    "text": "dong style 1 and they have and not just",
    "start": "999089",
    "end": "1004549"
  },
  {
    "text": "you don't but many other company all so have before it was all in one big",
    "start": "1004549",
    "end": "1009899"
  },
  {
    "text": "data center or one availability zone and now when you have the massive workloads",
    "start": "1009899",
    "end": "1016290"
  },
  {
    "text": "you don't want you know one bomb to break the data center you you want to be",
    "start": "1016290",
    "end": "1022470"
  },
  {
    "text": "able to handle the failure right so we can flip even with a single shard in two",
    "start": "1022470",
    "end": "1031650"
  },
  {
    "text": "different availability zones so this gives you other high availability options right before it was only for the",
    "start": "1031650",
    "end": "1039298"
  },
  {
    "text": "reading reason but now in case one goes down we can split and have more high",
    "start": "1039299",
    "end": "1045298"
  },
  {
    "text": "availability you know here one two and three yes the test will handle a sorry yeah",
    "start": "1045299",
    "end": "1057120"
  },
  {
    "text": "yeah my yeah my sequel connects the actual duplicate to the data from which through some icicle binding right yeah",
    "start": "1057120",
    "end": "1066860"
  },
  {
    "text": "other questions is that no answer your question okay cool all right thank you to ten for answering",
    "start": "1066860",
    "end": "1075530"
  },
  {
    "text": "so yeah so even for as you go really really big your go you're going to need",
    "start": "1075530",
    "end": "1080789"
  },
  {
    "text": "extra extra high availability and that's the benefits here okay so uh some demo",
    "start": "1080789",
    "end": "1088980"
  },
  {
    "text": "time this demo is very simple very stupid but everyone can run it on their",
    "start": "1088980",
    "end": "1094620"
  },
  {
    "text": "own laptops and I'm going to demonstrate by running on my laptop so this is a",
    "start": "1094620",
    "end": "1103850"
  },
  {
    "text": "FEMA marketplace schema it doesn't really matter it's got four tables my",
    "start": "1103850",
    "end": "1109350"
  },
  {
    "text": "actual dev only has three tables but whatever same idea this was all one big main DB and we have a product table",
    "start": "1109350",
    "end": "1118559"
  },
  {
    "text": "customer orders and merchants but uh in my demo we only have less okay",
    "start": "1118559",
    "end": "1123630"
  },
  {
    "text": "so I am going to demonstrate this I have already brought up a so this is actually",
    "start": "1123630",
    "end": "1137700"
  },
  {
    "text": "my sequel let me make it bigger can you see who's okay yeah so I just I",
    "start": "1137700",
    "end": "1145650"
  },
  {
    "text": "just brought up a my sequel I actually brought up three instances of my sequel",
    "start": "1145650",
    "end": "1151590"
  },
  {
    "text": "and behind the tests and if you see databases we see only a commerce",
    "start": "1151590",
    "end": "1158309"
  },
  {
    "text": "database and inside commerce database we",
    "start": "1158309",
    "end": "1163530"
  },
  {
    "text": "actually see three tables here something called order called see order but order",
    "start": "1163530",
    "end": "1169820"
  },
  {
    "text": "customer and product okay make sense so far and and I will show you there's some",
    "start": "1169820",
    "end": "1179880"
  },
  {
    "text": "data in this in each of the tables it just selected showed all the tables okay",
    "start": "1179880",
    "end": "1187280"
  },
  {
    "text": "but uh alright so that's just the data the current one in the main dB",
    "start": "1187280",
    "end": "1194190"
  },
  {
    "text": "okay so next you know maybe again I said",
    "start": "1194190",
    "end": "1202190"
  },
  {
    "text": "table 1 and table 2 got too big and maybe want to split into two databases 1",
    "start": "1202190",
    "end": "1209610"
  },
  {
    "text": "DB 1 and db2 so here when we shard we",
    "start": "1209610",
    "end": "1215370"
  },
  {
    "text": "can decide oh all of the products go into one one database and we'll make",
    "start": "1215370",
    "end": "1221010"
  },
  {
    "text": "we'll make another customer database yeah customer and orders so will me with",
    "start": "1221010",
    "end": "1227340"
  },
  {
    "text": "two of the tables from the original main DB into what a new one will call",
    "start": "1227340",
    "end": "1232890"
  },
  {
    "text": "customer DB does that make sense alright so how do we do that",
    "start": "1232890",
    "end": "1240000"
  },
  {
    "text": "good question I have no idea okay so we",
    "start": "1240000",
    "end": "1245670"
  },
  {
    "text": "have some scripts here and these are actually on the Vitesse website tutorial",
    "start": "1245670",
    "end": "1251429"
  },
  {
    "text": "so you guys can get the code from Vitesse and actually just run these",
    "start": "1251429",
    "end": "1257520"
  },
  {
    "text": "tutorials yourself it's exactly the same I'm just showing you okay so let me show",
    "start": "1257520",
    "end": "1267200"
  },
  {
    "text": "you what we're doing so",
    "start": "1267200",
    "end": "1273239"
  },
  {
    "text": "sorry if this is too small or can't read there's these are actual commands from",
    "start": "1273239",
    "end": "1278259"
  },
  {
    "text": "the tests I'm just showing you what's in the script it creates a key space key space is a database like database - and",
    "start": "1278259",
    "end": "1285509"
  },
  {
    "text": "named name Commerce and it says to route",
    "start": "1285509",
    "end": "1291129"
  },
  {
    "text": "all of the traffic for it alright sorry sorry sorry customer I'm",
    "start": "1291129",
    "end": "1298659"
  },
  {
    "text": "making a new customer database and then but all of the traffic for the customer",
    "start": "1298659",
    "end": "1304269"
  },
  {
    "text": "database actually goes to a place called commerce the old database the main DB",
    "start": "1304269",
    "end": "1309779"
  },
  {
    "text": "okay so I'm only just gonna run this command here and it's done and then",
    "start": "1309779",
    "end": "1317489"
  },
  {
    "text": "there's a few other things this would the next the next command I'm running",
    "start": "1317489",
    "end": "1326019"
  },
  {
    "text": "just brings up more instances of my sequel three more instances for the",
    "start": "1326019",
    "end": "1334659"
  },
  {
    "text": "tablets so here we go they're really",
    "start": "1334659",
    "end": "1341739"
  },
  {
    "text": "starting my sequel I will now talk to wait for the time so it's just bringing up more but of course while I'm",
    "start": "1341739",
    "end": "1348690"
  },
  {
    "text": "accessing this again I'm I can still see all of the what's called all of the data",
    "start": "1348690",
    "end": "1356769"
  },
  {
    "text": "from the original main database nothing's changed right as I wait for that and the point",
    "start": "1356769",
    "end": "1367869"
  },
  {
    "text": "is in in these steps we're bringing up new databases and then we're going to",
    "start": "1367869",
    "end": "1373779"
  },
  {
    "text": "slowly move the traffic from seeing all of the data in main database to a",
    "start": "1373779",
    "end": "1381070"
  },
  {
    "text": "different one but all is it's invisible",
    "start": "1381070",
    "end": "1386499"
  },
  {
    "text": "to the app server in this case the my sequel client so as you can see here",
    "start": "1386499",
    "end": "1393849"
  },
  {
    "text": "it's bringing up my sequel and also bringing up the the little tablet that that's unattached to each my sequel and",
    "start": "1393849",
    "end": "1402029"
  },
  {
    "text": "yeah okay great so it also has that a master in the new database - and",
    "start": "1402029",
    "end": "1412250"
  },
  {
    "text": "so we'll see this working hopefully let's see show databases oh",
    "start": "1412250",
    "end": "1419960"
  },
  {
    "text": "look we now have two databases before is commerce only and now we have customer",
    "start": "1419960",
    "end": "1426710"
  },
  {
    "text": "database and so in a second okay before",
    "start": "1426710",
    "end": "1434510"
  },
  {
    "text": "I do that so I'm going to go to the customer databases right and show what",
    "start": "1434510",
    "end": "1442130"
  },
  {
    "text": "tables we have we show we have some tables but so all the traffic for if we",
    "start": "1442130",
    "end": "1451220"
  },
  {
    "text": "wanted to select from the customer database it will look like it came from",
    "start": "1451220",
    "end": "1456920"
  },
  {
    "text": "the other database or it will behave like it'll come from the other database but it looks like it's also available in",
    "start": "1456920",
    "end": "1463940"
  },
  {
    "text": "this up in database to the customer database okay sorry",
    "start": "1463940",
    "end": "1472940"
  },
  {
    "text": "so from there oh and I can still access as before all the data let's see okay so",
    "start": "1472940",
    "end": "1489050"
  },
  {
    "text": "actually now before I was getting all the data from the database one the main",
    "start": "1489050",
    "end": "1495500"
  },
  {
    "text": "database but now my new script just gets",
    "start": "1495500",
    "end": "1501230"
  },
  {
    "text": "the data from the second database and it shows that it's available there as well",
    "start": "1501230",
    "end": "1506980"
  },
  {
    "text": "okay and now one of these scripts here",
    "start": "1506980",
    "end": "1512690"
  },
  {
    "text": "is a vertical split so a vertical split is the moving of tables from database",
    "start": "1512690",
    "end": "1518540"
  },
  {
    "text": "one the database - I can show you the code here it's literally just one",
    "start": "1518540",
    "end": "1524570"
  },
  {
    "text": "command the rest is environment variable that is splitting off the data",
    "start": "1524570",
    "end": "1532510"
  },
  {
    "text": "so it's doing some stuff what did it do who knows",
    "start": "1534230",
    "end": "1539659"
  },
  {
    "text": "let's see so what it actually did there is in again we had new empty databases",
    "start": "1539780",
    "end": "1546660"
  },
  {
    "text": "and it copied all the data from one to another and then from there continuously",
    "start": "1546660",
    "end": "1553309"
  },
  {
    "text": "replicates from even if you write the to table table to in old database it will",
    "start": "1553309",
    "end": "1562500"
  },
  {
    "text": "start you will start seeing it in table two in new database so it sets up it",
    "start": "1562500",
    "end": "1568950"
  },
  {
    "text": "does the copy and then replication from then on as well so that is what this",
    "start": "1568950",
    "end": "1574559"
  },
  {
    "text": "command just did so still nothing different here actually",
    "start": "1574559",
    "end": "1581960"
  },
  {
    "text": "again we haven't moved any pointers for what data were reading we're still",
    "start": "1581960",
    "end": "1588720"
  },
  {
    "text": "reading from the old database even if you now as you change your app go to read from the new database so the next",
    "start": "1588720",
    "end": "1602460"
  },
  {
    "text": "step here is it visible okay we're going to migrate where we read the",
    "start": "1602460",
    "end": "1609419"
  },
  {
    "text": "data so kind of to go back here yeah",
    "start": "1609419",
    "end": "1614669"
  },
  {
    "text": "kind of here right before it was pointing originally all of the queries",
    "start": "1614669",
    "end": "1622470"
  },
  {
    "text": "were going here but now we're going to actually say just for the replicas the read-only or the reading traffic",
    "start": "1622470",
    "end": "1629400"
  },
  {
    "text": "hey let's let's go read from here and not here anymore so we can they're independent pointers to go instead of",
    "start": "1629400",
    "end": "1636450"
  },
  {
    "text": "pointing from here point to that one",
    "start": "1636450",
    "end": "1640100"
  },
  {
    "text": "so the inside the shell script it's just saying move both the read-only and the",
    "start": "1648030",
    "end": "1653850"
  },
  {
    "text": "replicas over say but not the master yet so this is all the read traffic so",
    "start": "1653850",
    "end": "1662910"
  },
  {
    "text": "alright great select customer zero still look the same",
    "start": "1662910",
    "end": "1668160"
  },
  {
    "text": "remember if it all looks the same that's good it's not the same then something's wrong",
    "start": "1668160",
    "end": "1673400"
  },
  {
    "text": "so yeah still selecting no problem and then our",
    "start": "1673400",
    "end": "1678450"
  },
  {
    "text": "last one is migrate the master so my",
    "start": "1678450",
    "end": "1686820"
  },
  {
    "text": "great master same command only instead of saying read only a replica it says master so master is you've decided to",
    "start": "1686820",
    "end": "1694020"
  },
  {
    "text": "change all of your writing traffic over to your new place ok and by the way before we even do this",
    "start": "1694020",
    "end": "1704300"
  },
  {
    "text": "you hear I mean I right now I have moved",
    "start": "1704300",
    "end": "1710820"
  },
  {
    "text": "my read traffic from replicas read-only right I've moved it here but maybe I",
    "start": "1710820",
    "end": "1715830"
  },
  {
    "text": "have a problem actually you can still reverse because this is a pointer so you can decide oh I want to reverse and I",
    "start": "1715830",
    "end": "1721800"
  },
  {
    "text": "can go back to reading this so in case you're worried you can try it and if it has problems just move it back you know",
    "start": "1721800",
    "end": "1729360"
  },
  {
    "text": "and then you could debug try it again no problem so but once you move the",
    "start": "1729360",
    "end": "1736020"
  },
  {
    "text": "master to the new one well now all of your stuff is there so that's what we're",
    "start": "1736020",
    "end": "1741660"
  },
  {
    "text": "about to do right now migrate the master up pretty fast even in production this",
    "start": "1741660",
    "end": "1748650"
  },
  {
    "text": "should be a very fast switchover you know maybe a 1 second or less delay just",
    "start": "1748650",
    "end": "1755910"
  },
  {
    "text": "to propagate all of the configuration information because again all of the",
    "start": "1755910",
    "end": "1762450"
  },
  {
    "text": "replication all the copies have been happening all of this time ok yeah Beppe",
    "start": "1762450",
    "end": "1769850"
  },
  {
    "text": "so i've migrated the master i can still see that everything still looks ok that",
    "start": "1769850",
    "end": "1777600"
  },
  {
    "text": "is the whole demo by the way not very much so so we went from one big database to",
    "start": "1777600",
    "end": "1786440"
  },
  {
    "text": "splitting it in this example of splitting off tables it can do horizontal scaling and split that way to",
    "start": "1786440",
    "end": "1793670"
  },
  {
    "text": "just don't have time to actually show in this example so how does all of this",
    "start": "1793670",
    "end": "1800450"
  },
  {
    "text": "work under the covers this is actually one of the keys of the tests we call the",
    "start": "1800450",
    "end": "1807110"
  },
  {
    "text": "replication or Vitesse replication it is filtering all of the replication so as",
    "start": "1807110",
    "end": "1815740"
  },
  {
    "text": "you see here originally we had some",
    "start": "1815740",
    "end": "1820790"
  },
  {
    "text": "tables here and maybe and you we can set",
    "start": "1820790",
    "end": "1826370"
  },
  {
    "text": "up different types of composable replication whatever and we can have for",
    "start": "1826370",
    "end": "1831680"
  },
  {
    "text": "example the order information propagate over this way we can this is a horizontal chart example right here the",
    "start": "1831680",
    "end": "1840230"
  },
  {
    "text": "this is for what's called the different shard names like half of the traffic go",
    "start": "1840230",
    "end": "1847370"
  },
  {
    "text": "over here or half of the traffic go over here so because this might have two shards split you know shard one some of",
    "start": "1847370",
    "end": "1855980"
  },
  {
    "text": "the raw data and split the other the other half so so it's all doing filtered",
    "start": "1855980",
    "end": "1861590"
  },
  {
    "text": "amounts of replication so it's not doing everything so all of this is composable",
    "start": "1861590",
    "end": "1867290"
  },
  {
    "text": "oh yeah when you have multiple shards",
    "start": "1867290",
    "end": "1874040"
  },
  {
    "text": "how do you handle Joe good question so the question is whether you have",
    "start": "1874040",
    "end": "1879070"
  },
  {
    "text": "actually do you mind if I answer that at the right at the end we're really close if this is going too long this generally",
    "start": "1879070",
    "end": "1889850"
  },
  {
    "text": "make sense so with with this V replication these are the benefits you",
    "start": "1889850",
    "end": "1895400"
  },
  {
    "text": "can have materialized views you can have real-time roll-ups re sharding again",
    "start": "1895400",
    "end": "1900590"
  },
  {
    "text": "this is that before was actual examples of recharging in real time under the covers back up back filling of look of",
    "start": "1900590",
    "end": "1907880"
  },
  {
    "text": "indexes so if index is a the test index it it's how you decide which shard",
    "start": "1907880",
    "end": "1914559"
  },
  {
    "text": "go to when you're looking up data or inserting data and sometimes your primary index it's not what you want",
    "start": "1914559",
    "end": "1920830"
  },
  {
    "text": "like you have authentication table you have a or user ID maybe have user email",
    "start": "1920830",
    "end": "1926110"
  },
  {
    "text": "if you just want to look up where you're given email is you need to also figure out what shard so the secondary lookup",
    "start": "1926110",
    "end": "1933999"
  },
  {
    "text": "index the VIN Dex is what that's for also it allows for different schema",
    "start": "1933999",
    "end": "1941019"
  },
  {
    "text": "deployments and data migration and yeah change notifications in general so the",
    "start": "1941019",
    "end": "1947860"
  },
  {
    "text": "the the beauty of all how all of the tests works especially is with this V",
    "start": "1947860",
    "end": "1953259"
  },
  {
    "text": "replication to do all this charting and to keep everything in sync does that",
    "start": "1953259",
    "end": "1959799"
  },
  {
    "text": "generally make sense all right all right this is the end of the talk I'm just",
    "start": "1959799",
    "end": "1969789"
  },
  {
    "text": "gonna say some things and then we'll open up the questions is that okay all right so yeah we have a flak channel",
    "start": "1969789",
    "end": "1976289"
  },
  {
    "text": "that at Vitesse IO the TCO is where the open source project",
    "start": "1976289",
    "end": "1981369"
  },
  {
    "text": "is hosted we have a wee chat group we you should come to us only because we",
    "start": "1981369",
    "end": "1987850"
  },
  {
    "text": "chat has problems with more than a hundred users at a time or some other limits so come to us we'll we'll add you",
    "start": "1987850",
    "end": "1996519"
  },
  {
    "text": "the we chat groups also this is again was an introduction talk and juh 10 over",
    "start": "1996519",
    "end": "2002490"
  },
  {
    "text": "here will be giving another talk a more advanced one on when we actually bring",
    "start": "2002490",
    "end": "2009269"
  },
  {
    "text": "down for disaster recovery bring down you know shards or bring down masters and etc what happened",
    "start": "2009269",
    "end": "2017749"
  },
  {
    "text": "yeah I can edit this to show you that and then also we're going to have another talk about translation of",
    "start": "2026020",
    "end": "2033590"
  },
  {
    "text": "documents for Vitesse right now unfortunately all the documents are only",
    "start": "2033590",
    "end": "2039890"
  },
  {
    "text": "in English so today June 1 show the boot Ahava so",
    "start": "2039890",
    "end": "2045020"
  },
  {
    "text": "it would be great if we had some translation stuff and so if you would come by with that we can talk about how",
    "start": "2045020",
    "end": "2051230"
  },
  {
    "text": "we were going to be doing that also just like I'm running on my laptop we would",
    "start": "2051230",
    "end": "2056388"
  },
  {
    "text": "love for you to try bringing up a cluster on your own laptops and we can help you out with that read the code and",
    "start": "2056389",
    "end": "2062898"
  },
  {
    "text": "you can read some blog posts from square cache about their deployments of the",
    "start": "2062899",
    "end": "2068898"
  },
  {
    "text": "tests all the problems and actually even Jing don't like they just gave a talk on other problems and how they solve them",
    "start": "2068899",
    "end": "2075648"
  },
  {
    "text": "with the tests so you can and heat this person here can talk about them if",
    "start": "2075649",
    "end": "2081169"
  },
  {
    "text": "you're curious I'm on slack on the Vitesse black channel as at Tolliver and",
    "start": "2081169",
    "end": "2088128"
  },
  {
    "text": "there's I know as Twitter not accessible but if you can access it with VPNs or",
    "start": "2088129",
    "end": "2093470"
  },
  {
    "text": "whatever you can use these I think access does that make sense",
    "start": "2093470",
    "end": "2099350"
  },
  {
    "text": "alright so open to questions now sorry [Music]",
    "start": "2099350",
    "end": "2104920"
  },
  {
    "text": "whoever you are sorry can you repeat your question yep",
    "start": "2104920",
    "end": "2112660"
  },
  {
    "text": "points when you have chartered tables vertical and horizontal right good",
    "start": "2112660",
    "end": "2118790"
  },
  {
    "text": "question so the ideal case is you don't do anything wrong but you have single",
    "start": "2118790",
    "end": "2126350"
  },
  {
    "text": "shard stuff like if you have a user table authentication table you can co-locate like based on user ID like all",
    "start": "2126350",
    "end": "2133700"
  },
  {
    "text": "the user ID data for both tables be in one jar that's the best option but of",
    "start": "2133700",
    "end": "2138710"
  },
  {
    "text": "course once you go across what how do you handle that so we have what's called",
    "start": "2138710",
    "end": "2143840"
  },
  {
    "text": "three modes or two modes here for cross shard was it called cross card",
    "start": "2143840",
    "end": "2151660"
  },
  {
    "text": "transaction modes we have a best-effort where you know you where you can where",
    "start": "2151660",
    "end": "2160100"
  },
  {
    "text": "you can have each one independently transact and of course you have the default are the not default the",
    "start": "2160100",
    "end": "2166070"
  },
  {
    "text": "two-phase commit option so it can two-phase commit across that's for",
    "start": "2166070",
    "end": "2172520"
  },
  {
    "text": "inserts but for joins as well all of the they're only go back to the architecture diagram here here we go yeah",
    "start": "2172520",
    "end": "2180619"
  },
  {
    "text": "so you see actually that VT gate the proxy actually does talk to all of the",
    "start": "2180619",
    "end": "2185840"
  },
  {
    "text": "tablets and remember it does parse all of the sequel and it actually also",
    "start": "2185840",
    "end": "2190930"
  },
  {
    "text": "collects all the results from all of the different places and can and can do all",
    "start": "2190930",
    "end": "2196610"
  },
  {
    "text": "your joins at that place if necessary does that answer your question yeah so",
    "start": "2196610",
    "end": "2203240"
  },
  {
    "text": "yeah cuz each gate goes to all the different tablets so and remember there's not just one tablet here you can",
    "start": "2203240",
    "end": "2210020"
  },
  {
    "text": "scale this I think jingdong you guys have like a thousand VT gates or some yeah something like that",
    "start": "2210020",
    "end": "2215869"
  },
  {
    "text": "so it's not just one you can do many more than one so does that answer your",
    "start": "2215869",
    "end": "2221630"
  },
  {
    "text": "question okay great any other question yes I have",
    "start": "2221630",
    "end": "2229460"
  },
  {
    "text": "a month ink master cluster rabbit cap from Amazon to Alibaba so I want to",
    "start": "2229460",
    "end": "2235700"
  },
  {
    "text": "support I want to use bit ice so can i my cry to this without harm g10 do you",
    "start": "2235700",
    "end": "2243950"
  },
  {
    "text": "want to answer this one you have a",
    "start": "2243950",
    "end": "2253910"
  },
  {
    "text": "master in Alibaba and a replica in AWS",
    "start": "2253910",
    "end": "2262460"
  },
  {
    "text": "and that one is running in is easy to instance okay and what is it that you",
    "start": "2262460",
    "end": "2269150"
  },
  {
    "text": "want to achieve okay so witness does not support multi",
    "start": "2269150",
    "end": "2277240"
  },
  {
    "text": "master because multi master is not a great architecture in our opinion because it can lead to issues when you",
    "start": "2277240",
    "end": "2284980"
  },
  {
    "text": "have rights going to both the Masters and then if there are conflicting rights so for a given child we always send the",
    "start": "2284980",
    "end": "2292930"
  },
  {
    "text": "rights to a single master so even if you have a multi master architecture your",
    "start": "2292930",
    "end": "2298150"
  },
  {
    "text": "rights would go to one or the other and we then we would allow you to failover to start sending right say from AWS to",
    "start": "2298150",
    "end": "2305560"
  },
  {
    "text": "the other one or vice versa yes the guys we use the multi master because we have",
    "start": "2305560",
    "end": "2310720"
  },
  {
    "text": "a user in China and we have a user in our China was you know reply some you",
    "start": "2310720",
    "end": "2317680"
  },
  {
    "text": "your China user a Chinese user so they want to have set our web application",
    "start": "2317680",
    "end": "2323490"
  },
  {
    "text": "sorry I just inserted a data into the by in China something like that but we",
    "start": "2323490",
    "end": "2334330"
  },
  {
    "text": "still for the manager so they have to outside I need to see data above so",
    "start": "2334330",
    "end": "2339460"
  },
  {
    "text": "that's why we have which is that you can run your masters in one cloud replicas",
    "start": "2339460",
    "end": "2346390"
  },
  {
    "text": "in other cloud you need to make sure that you have an IPSec turn out to them so that you're not sending packets",
    "start": "2346390",
    "end": "2351849"
  },
  {
    "text": "unencrypted across public network yeah but you can failover witness will allow you to fail over from us from from one",
    "start": "2351849",
    "end": "2359230"
  },
  {
    "text": "cloud provider to another and will also allow you to spin up clusters across cloud provider yeah understand actually",
    "start": "2359230",
    "end": "2365440"
  },
  {
    "text": "we can actually talk about the sharding right I mean you can actually shard based on your tenant you know you are",
    "start": "2365440",
    "end": "2373089"
  },
  {
    "text": "saying that you know there are some Chinese provide of users right and so",
    "start": "2373089",
    "end": "2379480"
  },
  {
    "text": "you can have them in one shard and others in different shards and remember",
    "start": "2379480",
    "end": "2385089"
  },
  {
    "text": "each of the tablets each of the masters they can you can individually select where they are so again you can have the",
    "start": "2385089",
    "end": "2393760"
  },
  {
    "text": "unified view but again based on this one you can actually have a custom sharding",
    "start": "2393760",
    "end": "2401680"
  },
  {
    "text": "scheme you can write your own charting mechanism so you if you know that user 1 is this China user user",
    "start": "2401680",
    "end": "2410289"
  },
  {
    "text": "- not China user you can shard in that way does that make sense okay yeah I",
    "start": "2410289",
    "end": "2420960"
  },
  {
    "text": "want to ask about because I see that do you moving out moving out table table to",
    "start": "2422640",
    "end": "2432670"
  },
  {
    "text": "the database so I want to understand so what what they need to be chained in the",
    "start": "2432670",
    "end": "2441039"
  },
  {
    "text": "application to the if I say we have the version one collected either by with",
    "start": "2441039",
    "end": "2448420"
  },
  {
    "text": "typos but we have the version two collected attaboy correct the typo asked",
    "start": "2448420",
    "end": "2456130"
  },
  {
    "text": "the beauty of it is right as long as you're in the name of the table he is",
    "start": "2456130",
    "end": "2462069"
  },
  {
    "text": "hiding if the name of the table does not collide between ki spaces your",
    "start": "2462069",
    "end": "2468700"
  },
  {
    "text": "application doesn't need to know your application just can continue to write",
    "start": "2468700",
    "end": "2474190"
  },
  {
    "text": "to VT gates and litigate will send those rights to the correct database where",
    "start": "2474190",
    "end": "2481359"
  },
  {
    "text": "that table exists so long as both ki spaces do not have the same table then if there is the same table name then you",
    "start": "2481359",
    "end": "2488049"
  },
  {
    "text": "have to then you have to specify it in the table so if DB one had table 1 table",
    "start": "2488049",
    "end": "2503890"
  },
  {
    "text": "2 and you moved it to db2 after that split happens your app doesn't need to",
    "start": "2503890",
    "end": "2508900"
  },
  {
    "text": "change at all",
    "start": "2508900",
    "end": "2511440"
  },
  {
    "text": "if I'm very concerned about the load latency so why how we we test can help",
    "start": "2523710",
    "end": "2533590"
  },
  {
    "text": "you I won't comes of the change a key latency so transaction latency at high",
    "start": "2533590",
    "end": "2540160"
  },
  {
    "text": "right map volumes is what you're worried about right yeah so business itself adds",
    "start": "2540160",
    "end": "2545890"
  },
  {
    "text": "a little bit of latency to every query or every transaction because you have to do if you go back to the architecture",
    "start": "2545890",
    "end": "2552490"
  },
  {
    "text": "diagram there are two network hops that it has to do right your application is connecting to VT gate from litigate it's",
    "start": "2552490",
    "end": "2558430"
  },
  {
    "text": "connecting to VT tablet and from way to tablet it's connecting to my C quality so it adds about four five milliseconds",
    "start": "2558430",
    "end": "2564370"
  },
  {
    "text": "of latency to every query but because you can horizontally charge",
    "start": "2564370",
    "end": "2570420"
  },
  {
    "text": "you're right QPS on every master is a",
    "start": "2570420",
    "end": "2575740"
  },
  {
    "text": "lot less and that's why your latency ends up being a lot less than it would",
    "start": "2575740",
    "end": "2580780"
  },
  {
    "text": "be if you were writing on a single master so yeah it it it may add a little",
    "start": "2580780",
    "end": "2593800"
  },
  {
    "text": "bit of latency to any single query but it will increase your throughput by",
    "start": "2593800",
    "end": "2601060"
  },
  {
    "text": "quite a lot is that answer your question okay any other questions all right",
    "start": "2601060",
    "end": "2611040"
  },
  {
    "text": "if not thank you very much for coming again I'm Tolliver and this is g10 and",
    "start": "2611040",
    "end": "2618970"
  },
  {
    "text": "we're from Planet scale we do the tests things we may have a few but not too",
    "start": "2618970",
    "end": "2628600"
  },
  {
    "text": "many unfortunately anyway if you have any other questions you'd like to talk",
    "start": "2628600",
    "end": "2633760"
  },
  {
    "text": "in private feel free to come over probably outside I think the next talk is coming okay",
    "start": "2633760",
    "end": "2639490"
  },
  {
    "text": "thank you very much",
    "start": "2639490",
    "end": "2642570"
  }
]