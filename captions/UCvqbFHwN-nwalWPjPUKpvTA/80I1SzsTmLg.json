[
  {
    "start": "0",
    "end": "18000"
  },
  {
    "text": "hi everyone welcome to our talk on how",
    "start": "80",
    "end": "2240"
  },
  {
    "text": "to validate envoy configs at scale",
    "start": "2240",
    "end": "5200"
  },
  {
    "text": "we'll be going over strategies for",
    "start": "5200",
    "end": "6879"
  },
  {
    "text": "automating the config validation and",
    "start": "6879",
    "end": "8639"
  },
  {
    "text": "testing process",
    "start": "8639",
    "end": "9599"
  },
  {
    "text": "so that your service owners can iterate",
    "start": "9599",
    "end": "11440"
  },
  {
    "text": "quickly and independently",
    "start": "11440",
    "end": "13360"
  },
  {
    "text": "this will also prevent your envoy",
    "start": "13360",
    "end": "14960"
  },
  {
    "text": "operators from being bogged down with",
    "start": "14960",
    "end": "16560"
  },
  {
    "text": "code reviews",
    "start": "16560",
    "end": "19199"
  },
  {
    "start": "18000",
    "end": "40000"
  },
  {
    "text": "my name is lisa and i'm speaking here",
    "start": "19359",
    "end": "21119"
  },
  {
    "text": "today with got",
    "start": "21119",
    "end": "22480"
  },
  {
    "text": "both of us have worked on the router",
    "start": "22480",
    "end": "24640"
  },
  {
    "text": "check tool",
    "start": "24640",
    "end": "25599"
  },
  {
    "text": "which is one of the main tools we'll",
    "start": "25599",
    "end": "26960"
  },
  {
    "text": "discuss here as well as internal tooling",
    "start": "26960",
    "end": "29119"
  },
  {
    "text": "for making",
    "start": "29119",
    "end": "30960"
  },
  {
    "text": "testing and validating of envoy configs",
    "start": "30960",
    "end": "33600"
  },
  {
    "text": "better while at lyft",
    "start": "33600",
    "end": "35120"
  },
  {
    "text": "we're really excited to share our",
    "start": "35120",
    "end": "36640"
  },
  {
    "text": "learnings with you all today",
    "start": "36640",
    "end": "40160"
  },
  {
    "start": "40000",
    "end": "155000"
  },
  {
    "text": "to start off i'll describe lyft's",
    "start": "40399",
    "end": "42559"
  },
  {
    "text": "infrastructure and how we",
    "start": "42559",
    "end": "44079"
  },
  {
    "text": "generate and transport our many envoy",
    "start": "44079",
    "end": "46399"
  },
  {
    "text": "configs",
    "start": "46399",
    "end": "48879"
  },
  {
    "text": "our bootstrap envoy config and our route",
    "start": "48879",
    "end": "51039"
  },
  {
    "text": "and cluster definitions are stored in a",
    "start": "51039",
    "end": "52960"
  },
  {
    "text": "repository as yaml files which we",
    "start": "52960",
    "end": "55199"
  },
  {
    "text": "template with jinja",
    "start": "55199",
    "end": "57199"
  },
  {
    "text": "service teams can add their routes to a",
    "start": "57199",
    "end": "59359"
  },
  {
    "text": "jinja and python based infrastructure",
    "start": "59359",
    "end": "61920"
  },
  {
    "text": "which eventually is wired up with the",
    "start": "61920",
    "end": "63760"
  },
  {
    "text": "control plane to deliver updates to the",
    "start": "63760",
    "end": "66000"
  },
  {
    "text": "front proxy",
    "start": "66000",
    "end": "68799"
  },
  {
    "text": "upon container startup the envoy binary",
    "start": "69600",
    "end": "72400"
  },
  {
    "text": "and bootstrap config get pulled",
    "start": "72400",
    "end": "74400"
  },
  {
    "text": "and the static bootstrap config is",
    "start": "74400",
    "end": "76400"
  },
  {
    "text": "generated with jinja",
    "start": "76400",
    "end": "78479"
  },
  {
    "text": "sidecars in the internal mesh on the",
    "start": "78479",
    "end": "80400"
  },
  {
    "text": "front proxy and the egress proxy are",
    "start": "80400",
    "end": "82720"
  },
  {
    "text": "started with this",
    "start": "82720",
    "end": "86960"
  },
  {
    "text": "to avoid rolling envoy every time there",
    "start": "86960",
    "end": "89200"
  },
  {
    "text": "is a new route that gets added we use",
    "start": "89200",
    "end": "91200"
  },
  {
    "text": "rds or the route discovery service to",
    "start": "91200",
    "end": "93360"
  },
  {
    "text": "serve routes from a go control plane",
    "start": "93360",
    "end": "95439"
  },
  {
    "text": "based control plane",
    "start": "95439",
    "end": "97119"
  },
  {
    "text": "the bootstrap config is configured to",
    "start": "97119",
    "end": "99119"
  },
  {
    "text": "request xts from our control plane",
    "start": "99119",
    "end": "101920"
  },
  {
    "text": "meanwhile the routes and clusters which",
    "start": "101920",
    "end": "103680"
  },
  {
    "text": "are stored in s3",
    "start": "103680",
    "end": "105200"
  },
  {
    "text": "are fetched by the control plane which",
    "start": "105200",
    "end": "106799"
  },
  {
    "text": "creates the respective route",
    "start": "106799",
    "end": "108079"
  },
  {
    "text": "configuration and cluster objects to",
    "start": "108079",
    "end": "109920"
  },
  {
    "text": "send via xds to the sidecars",
    "start": "109920",
    "end": "112640"
  },
  {
    "text": "as such there are two main points at",
    "start": "112640",
    "end": "114399"
  },
  {
    "text": "which we have to validate the format and",
    "start": "114399",
    "end": "116079"
  },
  {
    "text": "content the configs",
    "start": "116079",
    "end": "117920"
  },
  {
    "text": "the first such place is in the bootstrap",
    "start": "117920",
    "end": "120000"
  },
  {
    "text": "config which",
    "start": "120000",
    "end": "120960"
  },
  {
    "text": "ensures that the sidecar is able to run",
    "start": "120960",
    "end": "123200"
  },
  {
    "text": "properly and start up without crashing",
    "start": "123200",
    "end": "125840"
  },
  {
    "text": "the other place we need to validate is",
    "start": "125840",
    "end": "127520"
  },
  {
    "text": "in the route and cluster definitions",
    "start": "127520",
    "end": "129759"
  },
  {
    "text": "we validate these before sending them to",
    "start": "129759",
    "end": "131599"
  },
  {
    "text": "the control plane because we want to",
    "start": "131599",
    "end": "133200"
  },
  {
    "text": "avoid",
    "start": "133200",
    "end": "134080"
  },
  {
    "text": "the control plane needing to do any",
    "start": "134080",
    "end": "135840"
  },
  {
    "text": "validation as it gets the route and",
    "start": "135840",
    "end": "137760"
  },
  {
    "text": "cluster information in real time and",
    "start": "137760",
    "end": "139680"
  },
  {
    "text": "rather frequently",
    "start": "139680",
    "end": "142080"
  },
  {
    "text": "as the number of services and routes",
    "start": "142080",
    "end": "143680"
  },
  {
    "text": "that lift has grown on some side cars we",
    "start": "143680",
    "end": "145840"
  },
  {
    "text": "have configurations that are upwards of",
    "start": "145840",
    "end": "147599"
  },
  {
    "text": "a hundred thousand lines of yaml which",
    "start": "147599",
    "end": "149360"
  },
  {
    "text": "makes",
    "start": "149360",
    "end": "150080"
  },
  {
    "text": "maintenance and modification extremely",
    "start": "150080",
    "end": "152000"
  },
  {
    "text": "complex and risky",
    "start": "152000",
    "end": "156560"
  },
  {
    "start": "155000",
    "end": "371000"
  },
  {
    "text": "i'll describe some of the issues in fact",
    "start": "156560",
    "end": "158640"
  },
  {
    "text": "that we've encountered over the last",
    "start": "158640",
    "end": "160480"
  },
  {
    "text": "year",
    "start": "160480",
    "end": "161599"
  },
  {
    "text": "firstly as a growing company we have new",
    "start": "161599",
    "end": "163680"
  },
  {
    "text": "developers joining every week",
    "start": "163680",
    "end": "165440"
  },
  {
    "text": "and business expansion also means that",
    "start": "165440",
    "end": "167440"
  },
  {
    "text": "new services are being spun up to cater",
    "start": "167440",
    "end": "169599"
  },
  {
    "text": "to new scenarios quite frequently",
    "start": "169599",
    "end": "172080"
  },
  {
    "text": "this means more code review requests",
    "start": "172080",
    "end": "174080"
  },
  {
    "text": "from developers who aren't familiar with",
    "start": "174080",
    "end": "176160"
  },
  {
    "text": "envoy and want to know if their change",
    "start": "176160",
    "end": "178000"
  },
  {
    "text": "will do what they want it to do",
    "start": "178000",
    "end": "180080"
  },
  {
    "text": "while it's great that we're having more",
    "start": "180080",
    "end": "182080"
  },
  {
    "text": "and more development",
    "start": "182080",
    "end": "183120"
  },
  {
    "text": "it's not so great that the on-call",
    "start": "183120",
    "end": "184720"
  },
  {
    "text": "burden has increased",
    "start": "184720",
    "end": "187120"
  },
  {
    "text": "it means the on-call spends more time",
    "start": "187120",
    "end": "188959"
  },
  {
    "text": "triaging these tickets and",
    "start": "188959",
    "end": "191360"
  },
  {
    "text": "having to stare at yaml",
    "start": "191360",
    "end": "194720"
  },
  {
    "text": "another issue is human con human error",
    "start": "195440",
    "end": "198400"
  },
  {
    "text": "in configs",
    "start": "198400",
    "end": "200879"
  },
  {
    "text": "with such large yaml files it isn't",
    "start": "200879",
    "end": "203519"
  },
  {
    "text": "feasible for catching everything",
    "start": "203519",
    "end": "205360"
  },
  {
    "text": "for example one common source of bugs",
    "start": "205360",
    "end": "208720"
  },
  {
    "text": "is how envoy does first order matching",
    "start": "208720",
    "end": "211120"
  },
  {
    "text": "for its routes",
    "start": "211120",
    "end": "212640"
  },
  {
    "text": "which means that in a huge list of",
    "start": "212640",
    "end": "214239"
  },
  {
    "text": "routes it might be easy for a developer",
    "start": "214239",
    "end": "216319"
  },
  {
    "text": "or a viewer to",
    "start": "216319",
    "end": "217920"
  },
  {
    "text": "miss a route that captures all the",
    "start": "217920",
    "end": "219519"
  },
  {
    "text": "traffic that is actually intended for a",
    "start": "219519",
    "end": "221519"
  },
  {
    "text": "new route",
    "start": "221519",
    "end": "222720"
  },
  {
    "text": "these can lead to outages in your",
    "start": "222720",
    "end": "224840"
  },
  {
    "text": "services",
    "start": "224840",
    "end": "226959"
  },
  {
    "text": "in response to such errors we actually",
    "start": "226959",
    "end": "229440"
  },
  {
    "text": "mandated a code review from the",
    "start": "229440",
    "end": "230799"
  },
  {
    "text": "networking team for all routes at one",
    "start": "230799",
    "end": "232799"
  },
  {
    "text": "point",
    "start": "232799",
    "end": "233519"
  },
  {
    "text": "this quickly became the bottleneck for",
    "start": "233519",
    "end": "235360"
  },
  {
    "text": "iteration because",
    "start": "235360",
    "end": "236720"
  },
  {
    "text": "our networking team is about six people",
    "start": "236720",
    "end": "239280"
  },
  {
    "text": "and while we were the guardians of",
    "start": "239280",
    "end": "241680"
  },
  {
    "text": "these route changes for a while and",
    "start": "241680",
    "end": "243280"
  },
  {
    "text": "tried to eyeball every change going in",
    "start": "243280",
    "end": "245120"
  },
  {
    "text": "this",
    "start": "245120",
    "end": "245519"
  },
  {
    "text": "just wasn't proving to be sustainable",
    "start": "245519",
    "end": "247920"
  },
  {
    "text": "and was",
    "start": "247920",
    "end": "248560"
  },
  {
    "text": "slowing iteration and rollouts for the",
    "start": "248560",
    "end": "250480"
  },
  {
    "text": "rest of the company",
    "start": "250480",
    "end": "255519"
  },
  {
    "text": "next we have um",
    "start": "255519",
    "end": "258720"
  },
  {
    "text": "this issue where we just saw a tech debt",
    "start": "258720",
    "end": "260720"
  },
  {
    "text": "piling up um",
    "start": "260720",
    "end": "262400"
  },
  {
    "text": "what dead rats and dead clusters refer",
    "start": "262400",
    "end": "264320"
  },
  {
    "text": "to are unused routes and unused clusters",
    "start": "264320",
    "end": "266960"
  },
  {
    "text": "for example clusters that are",
    "start": "266960",
    "end": "268800"
  },
  {
    "text": "no longer necessary or can't be routed",
    "start": "268800",
    "end": "270720"
  },
  {
    "text": "to or routes that point to services that",
    "start": "270720",
    "end": "273759"
  },
  {
    "text": "no longer exist",
    "start": "273759",
    "end": "276880"
  },
  {
    "text": "this is quite common with deprecation",
    "start": "276880",
    "end": "279280"
  },
  {
    "text": "service owners might delete the cluster",
    "start": "279280",
    "end": "281040"
  },
  {
    "text": "config and forget",
    "start": "281040",
    "end": "282000"
  },
  {
    "text": "to delete the routes or vice versa",
    "start": "282000",
    "end": "284320"
  },
  {
    "text": "leaving in clutter and causing the",
    "start": "284320",
    "end": "285840"
  },
  {
    "text": "control plane to continue creating route",
    "start": "285840",
    "end": "287840"
  },
  {
    "text": "and cluster definitions",
    "start": "287840",
    "end": "289520"
  },
  {
    "text": "that are no longer needed",
    "start": "289520",
    "end": "292720"
  },
  {
    "text": "next reason is that changes are hard to",
    "start": "294720",
    "end": "297360"
  },
  {
    "text": "test",
    "start": "297360",
    "end": "298000"
  },
  {
    "text": "um actually this was a main reason for",
    "start": "298000",
    "end": "300240"
  },
  {
    "text": "the first issue that i highlighted which",
    "start": "300240",
    "end": "301840"
  },
  {
    "text": "is that service owners weren't sure how",
    "start": "301840",
    "end": "303520"
  },
  {
    "text": "to validate their changes which is why",
    "start": "303520",
    "end": "305919"
  },
  {
    "text": "um they wanted to reach out to the",
    "start": "305919",
    "end": "307600"
  },
  {
    "text": "networking team in the first place",
    "start": "307600",
    "end": "309600"
  },
  {
    "text": "um prior to automating our testing it",
    "start": "309600",
    "end": "312160"
  },
  {
    "text": "was really difficult to validate changes",
    "start": "312160",
    "end": "314240"
  },
  {
    "text": "you had to have an end-to-end setup with",
    "start": "314240",
    "end": "316639"
  },
  {
    "text": "setting up an envoy sidecar and sending",
    "start": "316639",
    "end": "318639"
  },
  {
    "text": "requests to see if your config changes",
    "start": "318639",
    "end": "320479"
  },
  {
    "text": "worked",
    "start": "320479",
    "end": "322800"
  },
  {
    "text": "finally lyft recently switched to",
    "start": "322800",
    "end": "324800"
  },
  {
    "text": "pulling in the latest",
    "start": "324800",
    "end": "325919"
  },
  {
    "text": "envoy version on a weekly basis and",
    "start": "325919",
    "end": "328400"
  },
  {
    "text": "while this is great for minimizing tech",
    "start": "328400",
    "end": "330240"
  },
  {
    "text": "de as we are",
    "start": "330240",
    "end": "331120"
  },
  {
    "text": "staying up to date quite frequently um",
    "start": "331120",
    "end": "334400"
  },
  {
    "text": "it runs the risk of always dealing with",
    "start": "334400",
    "end": "336639"
  },
  {
    "text": "incompatible config changes",
    "start": "336639",
    "end": "338560"
  },
  {
    "text": "and internal stability um",
    "start": "338560",
    "end": "342160"
  },
  {
    "text": "when we say config here we mean both the",
    "start": "342160",
    "end": "344240"
  },
  {
    "text": "onboard bootstrap config",
    "start": "344240",
    "end": "345680"
  },
  {
    "text": "and the xps configuration an error in",
    "start": "345680",
    "end": "348479"
  },
  {
    "text": "either of these could cause an envoy",
    "start": "348479",
    "end": "350240"
  },
  {
    "text": "sidecar to reject the config",
    "start": "350240",
    "end": "352000"
  },
  {
    "text": "and fail to start up or fail to apply",
    "start": "352000",
    "end": "354880"
  },
  {
    "text": "updated",
    "start": "354880",
    "end": "355600"
  },
  {
    "text": "xds objects um and in order to maintain",
    "start": "355600",
    "end": "359280"
  },
  {
    "text": "this high speed of iteration we knew we",
    "start": "359280",
    "end": "361280"
  },
  {
    "text": "would have to",
    "start": "361280",
    "end": "362319"
  },
  {
    "text": "automate our testing in order to make",
    "start": "362319",
    "end": "364479"
  },
  {
    "text": "sure that our envoys wouldn't regress",
    "start": "364479",
    "end": "366960"
  },
  {
    "text": "whenever we pulled in the latest version",
    "start": "366960",
    "end": "371280"
  },
  {
    "start": "371000",
    "end": "494000"
  },
  {
    "text": "of all these issues in mind we set out",
    "start": "372479",
    "end": "374400"
  },
  {
    "text": "to invest in tooling and tests that",
    "start": "374400",
    "end": "376160"
  },
  {
    "text": "would make config deployments",
    "start": "376160",
    "end": "377680"
  },
  {
    "text": "safe and self-service",
    "start": "377680",
    "end": "380960"
  },
  {
    "text": "the first strategy i'll talk about here",
    "start": "380960",
    "end": "382960"
  },
  {
    "text": "is how we",
    "start": "382960",
    "end": "384000"
  },
  {
    "text": "addressed tech debt in particular the",
    "start": "384000",
    "end": "386319"
  },
  {
    "text": "dead clusters and routes",
    "start": "386319",
    "end": "388400"
  },
  {
    "text": "we wrote some in-house scripts that were",
    "start": "388400",
    "end": "390319"
  },
  {
    "text": "that parse the route and cluster configs",
    "start": "390319",
    "end": "392560"
  },
  {
    "text": "and remove the ones that were dead um",
    "start": "392560",
    "end": "396240"
  },
  {
    "text": "so in this scenario ideally in the top",
    "start": "396240",
    "end": "398800"
  },
  {
    "text": "row",
    "start": "398800",
    "end": "399280"
  },
  {
    "text": "you would have rats pointing to your",
    "start": "399280",
    "end": "401919"
  },
  {
    "text": "service or cluster",
    "start": "401919",
    "end": "403039"
  },
  {
    "text": "but when it comes to new service",
    "start": "403039",
    "end": "405520"
  },
  {
    "text": "launches or service deprecations",
    "start": "405520",
    "end": "408560"
  },
  {
    "text": "sometimes developers only address the",
    "start": "408560",
    "end": "411599"
  },
  {
    "text": "route definitions",
    "start": "411599",
    "end": "412960"
  },
  {
    "text": "and forget the clusters or vice versa so",
    "start": "412960",
    "end": "415759"
  },
  {
    "text": "for example in the second row",
    "start": "415759",
    "end": "417680"
  },
  {
    "text": "you see that there's no route definition",
    "start": "417680",
    "end": "419919"
  },
  {
    "text": "pointing to",
    "start": "419919",
    "end": "421280"
  },
  {
    "text": "the service and this could mean that um",
    "start": "421280",
    "end": "424400"
  },
  {
    "text": "the developer didn't leave any routes",
    "start": "424400",
    "end": "426400"
  },
  {
    "text": "which means the cluster definition isn't",
    "start": "426400",
    "end": "428160"
  },
  {
    "text": "being used",
    "start": "428160",
    "end": "429440"
  },
  {
    "text": "or they deprecated the routes and forgot",
    "start": "429440",
    "end": "432479"
  },
  {
    "text": "to remove the cluster",
    "start": "432479",
    "end": "435440"
  },
  {
    "text": "while this cluster is not accessible",
    "start": "435440",
    "end": "438479"
  },
  {
    "text": "by outside users um your control plane",
    "start": "438479",
    "end": "441440"
  },
  {
    "text": "is still creating",
    "start": "441440",
    "end": "442560"
  },
  {
    "text": "unnecessary resources here and sending",
    "start": "442560",
    "end": "444560"
  },
  {
    "text": "them to side cars",
    "start": "444560",
    "end": "446000"
  },
  {
    "text": "in addition um it just creates tech da",
    "start": "446000",
    "end": "448560"
  },
  {
    "text": "and can make reading through",
    "start": "448560",
    "end": "450160"
  },
  {
    "text": "configs confusing since the service is",
    "start": "450160",
    "end": "452400"
  },
  {
    "text": "presumably",
    "start": "452400",
    "end": "453280"
  },
  {
    "text": "no longer being used or isn't currently",
    "start": "453280",
    "end": "455599"
  },
  {
    "text": "being used",
    "start": "455599",
    "end": "456880"
  },
  {
    "text": "um and then in the third scenario you",
    "start": "456880",
    "end": "459759"
  },
  {
    "text": "have",
    "start": "459759",
    "end": "460479"
  },
  {
    "text": "accessible routes that are pointing to a",
    "start": "460479",
    "end": "463199"
  },
  {
    "text": "cluster that isn't configured or doesn't",
    "start": "463199",
    "end": "465360"
  },
  {
    "text": "exist",
    "start": "465360",
    "end": "466479"
  },
  {
    "text": "um in this scenario envoy will return",
    "start": "466479",
    "end": "470000"
  },
  {
    "text": "a 503 to request going to these routes",
    "start": "470000",
    "end": "472560"
  },
  {
    "text": "because",
    "start": "472560",
    "end": "473520"
  },
  {
    "text": "it doesn't see any healthy members for",
    "start": "473520",
    "end": "475680"
  },
  {
    "text": "this cluster",
    "start": "475680",
    "end": "476960"
  },
  {
    "text": "um and obviously you don't want your",
    "start": "476960",
    "end": "479360"
  },
  {
    "text": "users to be hitting 503s",
    "start": "479360",
    "end": "481360"
  },
  {
    "text": "for no reason so both checks here can",
    "start": "481360",
    "end": "484319"
  },
  {
    "text": "prevent",
    "start": "484319",
    "end": "484800"
  },
  {
    "text": "human error from derailing a service",
    "start": "484800",
    "end": "486720"
  },
  {
    "text": "launch or deprecation",
    "start": "486720",
    "end": "488319"
  },
  {
    "text": "um which usually happens when someone",
    "start": "488319",
    "end": "490960"
  },
  {
    "text": "forgets one of the configs",
    "start": "490960",
    "end": "494240"
  },
  {
    "start": "494000",
    "end": "576000"
  },
  {
    "text": "next to validate the bootstrap config we",
    "start": "495280",
    "end": "497759"
  },
  {
    "text": "make use of",
    "start": "497759",
    "end": "498879"
  },
  {
    "text": "a couple of open source tools the first",
    "start": "498879",
    "end": "501440"
  },
  {
    "text": "one i'll discuss",
    "start": "501440",
    "end": "502400"
  },
  {
    "text": "is the validation server this refers to",
    "start": "502400",
    "end": "505199"
  },
  {
    "text": "running",
    "start": "505199",
    "end": "505759"
  },
  {
    "text": "the envoy binary in validation mode",
    "start": "505759",
    "end": "507919"
  },
  {
    "text": "which you can set",
    "start": "507919",
    "end": "508800"
  },
  {
    "text": "via the command line flag mode um",
    "start": "508800",
    "end": "512320"
  },
  {
    "text": "and what this does is it takes your",
    "start": "512320",
    "end": "514000"
  },
  {
    "text": "binary and it takes your bootstrap",
    "start": "514000",
    "end": "515599"
  },
  {
    "text": "config",
    "start": "515599",
    "end": "516320"
  },
  {
    "text": "and it tries to boot up envoy without",
    "start": "516320",
    "end": "519599"
  },
  {
    "text": "starting workers but it will",
    "start": "519599",
    "end": "522719"
  },
  {
    "text": "go through the server initialization",
    "start": "522719",
    "end": "524399"
  },
  {
    "text": "process as far as it can and if there",
    "start": "524399",
    "end": "526160"
  },
  {
    "text": "are no errors it will exit",
    "start": "526160",
    "end": "528080"
  },
  {
    "text": "it will exit successfully",
    "start": "528080",
    "end": "531600"
  },
  {
    "text": "the next tool we use is the config load",
    "start": "531760",
    "end": "534240"
  },
  {
    "text": "check tool and you can see the docs on",
    "start": "534240",
    "end": "535839"
  },
  {
    "text": "the left",
    "start": "535839",
    "end": "536800"
  },
  {
    "text": "this is a standalone binary which you",
    "start": "536800",
    "end": "539440"
  },
  {
    "text": "can run",
    "start": "539440",
    "end": "540160"
  },
  {
    "text": "on all of your bootstrap configs and it",
    "start": "540160",
    "end": "543120"
  },
  {
    "text": "basically checks that",
    "start": "543120",
    "end": "545600"
  },
  {
    "text": "all the values in the fields are valid",
    "start": "545600",
    "end": "548560"
  },
  {
    "text": "as defined by the proto",
    "start": "548560",
    "end": "550000"
  },
  {
    "text": "and that the schema is a valid envoy",
    "start": "550000",
    "end": "552800"
  },
  {
    "text": "schema",
    "start": "552800",
    "end": "554720"
  },
  {
    "text": "we run both of these checks on all of",
    "start": "554720",
    "end": "556640"
  },
  {
    "text": "our pull requests",
    "start": "556640",
    "end": "557760"
  },
  {
    "text": "in ci and that just makes reviewing",
    "start": "557760",
    "end": "560640"
  },
  {
    "text": "these changes so much easier",
    "start": "560640",
    "end": "562000"
  },
  {
    "text": "because as the reviewer you already know",
    "start": "562000",
    "end": "563839"
  },
  {
    "text": "that the config",
    "start": "563839",
    "end": "565200"
  },
  {
    "text": "is a valid envoy config and so you only",
    "start": "565200",
    "end": "567519"
  },
  {
    "text": "need to",
    "start": "567519",
    "end": "568720"
  },
  {
    "text": "um ensure that the change",
    "start": "568720",
    "end": "572240"
  },
  {
    "text": "does what it should",
    "start": "572240",
    "end": "576880"
  },
  {
    "start": "576000",
    "end": "937000"
  },
  {
    "text": "i'll now hand it over to jyoti to",
    "start": "576880",
    "end": "578640"
  },
  {
    "text": "discuss the router check tool and its",
    "start": "578640",
    "end": "580320"
  },
  {
    "text": "various functionalities",
    "start": "580320",
    "end": "583279"
  },
  {
    "text": "thank you lisa next i'm going to talk",
    "start": "583279",
    "end": "586399"
  },
  {
    "text": "about",
    "start": "586399",
    "end": "586880"
  },
  {
    "text": "the router check tool the part of",
    "start": "586880",
    "end": "589200"
  },
  {
    "text": "configuration",
    "start": "589200",
    "end": "590000"
  },
  {
    "text": "in most flux over the last few years",
    "start": "590000",
    "end": "592080"
  },
  {
    "text": "have been modifications to the routes",
    "start": "592080",
    "end": "594480"
  },
  {
    "text": "routes work in a very sensitive way the",
    "start": "594480",
    "end": "596640"
  },
  {
    "text": "routing engine runs an incoming request",
    "start": "596640",
    "end": "598959"
  },
  {
    "text": "over a set of routing rules and the",
    "start": "598959",
    "end": "600800"
  },
  {
    "text": "first one to match wins",
    "start": "600800",
    "end": "602640"
  },
  {
    "text": "this becomes risky in a high flux change",
    "start": "602640",
    "end": "604800"
  },
  {
    "text": "scenario",
    "start": "604800",
    "end": "605839"
  },
  {
    "text": "a route mistakenly added at the top of",
    "start": "605839",
    "end": "608000"
  },
  {
    "text": "the list",
    "start": "608000",
    "end": "609360"
  },
  {
    "text": "can black hole all traffic can cause",
    "start": "609360",
    "end": "611360"
  },
  {
    "text": "incidents",
    "start": "611360",
    "end": "613040"
  },
  {
    "text": "envoy has a router check tool executable",
    "start": "613040",
    "end": "616240"
  },
  {
    "text": "this exercises the routing engine and",
    "start": "616240",
    "end": "618880"
  },
  {
    "text": "runs it",
    "start": "618880",
    "end": "619760"
  },
  {
    "text": "over the routing configurations given it",
    "start": "619760",
    "end": "622560"
  },
  {
    "text": "lets us add",
    "start": "622560",
    "end": "623360"
  },
  {
    "text": "unit tests check field applications add",
    "start": "623360",
    "end": "626399"
  },
  {
    "text": "code coverage constraints",
    "start": "626399",
    "end": "628240"
  },
  {
    "text": "test complex routing configurations",
    "start": "628240",
    "end": "630079"
  },
  {
    "text": "based on header match",
    "start": "630079",
    "end": "631600"
  },
  {
    "text": "run time and weight cluster configs",
    "start": "631600",
    "end": "635519"
  },
  {
    "text": "we'll look at how to write the tests",
    "start": "635519",
    "end": "640320"
  },
  {
    "text": "and in test for code is a well-known",
    "start": "640320",
    "end": "642000"
  },
  {
    "text": "pattern there's",
    "start": "642000",
    "end": "643839"
  },
  {
    "text": "a subject under test defined by test",
    "start": "643839",
    "end": "646079"
  },
  {
    "text": "name some setup and assertions",
    "start": "646079",
    "end": "648959"
  },
  {
    "text": "similarly routing tests have it name a",
    "start": "648959",
    "end": "651839"
  },
  {
    "text": "set of input conditions and a set of",
    "start": "651839",
    "end": "653839"
  },
  {
    "text": "assertions",
    "start": "653839",
    "end": "655200"
  },
  {
    "text": "the tests always run the input route",
    "start": "655200",
    "end": "658560"
  },
  {
    "text": "through the routing engine and compares",
    "start": "658560",
    "end": "660640"
  },
  {
    "text": "the assertions with the actual results",
    "start": "660640",
    "end": "663600"
  },
  {
    "text": "let's follow an example imagine we have",
    "start": "663600",
    "end": "666079"
  },
  {
    "text": "a routing table",
    "start": "666079",
    "end": "667040"
  },
  {
    "text": "assured on the left picture imagine",
    "start": "667040",
    "end": "670000"
  },
  {
    "text": "thousands of switch routes",
    "start": "670000",
    "end": "671760"
  },
  {
    "text": "one can imagine the plight of the",
    "start": "671760",
    "end": "673120"
  },
  {
    "text": "developer who is making changes to such",
    "start": "673120",
    "end": "675120"
  },
  {
    "text": "a long conflict",
    "start": "675120",
    "end": "677200"
  },
  {
    "text": "we need a way to prevent regressions and",
    "start": "677200",
    "end": "679120"
  },
  {
    "text": "have the developer make",
    "start": "679120",
    "end": "680480"
  },
  {
    "text": "change and find out any mistake in the",
    "start": "680480",
    "end": "682560"
  },
  {
    "text": "pr",
    "start": "682560",
    "end": "684480"
  },
  {
    "text": "on the right there are a few examples of",
    "start": "684480",
    "end": "686240"
  },
  {
    "text": "how a test looks like",
    "start": "686240",
    "end": "688000"
  },
  {
    "text": "it starts the test name there is an",
    "start": "688000",
    "end": "690160"
  },
  {
    "text": "input section",
    "start": "690160",
    "end": "691200"
  },
  {
    "text": "which works as a test setup it has the",
    "start": "691200",
    "end": "694160"
  },
  {
    "text": "url",
    "start": "694160",
    "end": "694880"
  },
  {
    "text": "the method headers etc the tool has a",
    "start": "694880",
    "end": "698320"
  },
  {
    "text": "strict set of assistants",
    "start": "698320",
    "end": "700320"
  },
  {
    "text": "the tool runs the config through the",
    "start": "700320",
    "end": "701760"
  },
  {
    "text": "routing engine and matches the",
    "start": "701760",
    "end": "704160"
  },
  {
    "text": "resulting cluster name path or host",
    "start": "704160",
    "end": "706240"
  },
  {
    "text": "rewrites and redirects",
    "start": "706240",
    "end": "708560"
  },
  {
    "text": "this was great and we took all our",
    "start": "708560",
    "end": "710480"
  },
  {
    "text": "routes and added tests for all of them",
    "start": "710480",
    "end": "713200"
  },
  {
    "text": "we used our telemetry and automated the",
    "start": "713200",
    "end": "715920"
  },
  {
    "text": "test generation too",
    "start": "715920",
    "end": "717760"
  },
  {
    "text": "this means an existing route can never",
    "start": "717760",
    "end": "720000"
  },
  {
    "text": "regress anymore due to a bad change",
    "start": "720000",
    "end": "722160"
  },
  {
    "text": "and we can detect them right in the pr",
    "start": "722160",
    "end": "726399"
  },
  {
    "text": "let's run the test and see how it looks",
    "start": "727680",
    "end": "729279"
  },
  {
    "text": "like the tool takes a routing",
    "start": "729279",
    "end": "731519"
  },
  {
    "text": "configuration and a test file",
    "start": "731519",
    "end": "735040"
  },
  {
    "text": "it shows a success and failure using",
    "start": "737279",
    "end": "739440"
  },
  {
    "text": "exit code",
    "start": "739440",
    "end": "740880"
  },
  {
    "text": "exit code 0 is success and anything else",
    "start": "740880",
    "end": "743360"
  },
  {
    "text": "is a failure",
    "start": "743360",
    "end": "745519"
  },
  {
    "text": "the tests aren't verbose by default you",
    "start": "745519",
    "end": "748240"
  },
  {
    "text": "could add verbosity by adding",
    "start": "748240",
    "end": "749839"
  },
  {
    "text": "the details flag on the command line and",
    "start": "749839",
    "end": "751920"
  },
  {
    "text": "check the results using",
    "start": "751920",
    "end": "753920"
  },
  {
    "text": "taller question mark which shows the",
    "start": "753920",
    "end": "756079"
  },
  {
    "text": "last exit code",
    "start": "756079",
    "end": "758240"
  },
  {
    "text": "when we have hundreds of routes adding",
    "start": "758240",
    "end": "760399"
  },
  {
    "text": "verbosity cost more friction than we",
    "start": "760399",
    "end": "762240"
  },
  {
    "text": "wanted",
    "start": "762240",
    "end": "763360"
  },
  {
    "text": "the shift was new and developers did not",
    "start": "763360",
    "end": "765920"
  },
  {
    "text": "understand the testing semantics",
    "start": "765920",
    "end": "768000"
  },
  {
    "text": "we added another flag only show failures",
    "start": "768000",
    "end": "770560"
  },
  {
    "text": "and the pr failure",
    "start": "770560",
    "end": "771680"
  },
  {
    "text": "logs would have exactly the tests that",
    "start": "771680",
    "end": "774000"
  },
  {
    "text": "failed",
    "start": "774000",
    "end": "775120"
  },
  {
    "text": "making failures easier to understand it",
    "start": "775120",
    "end": "777440"
  },
  {
    "text": "prints the test names",
    "start": "777440",
    "end": "778720"
  },
  {
    "text": "and all the assertions that failed",
    "start": "778720",
    "end": "782720"
  },
  {
    "text": "all this was exciting but the tool did",
    "start": "784240",
    "end": "786240"
  },
  {
    "text": "not have a way of enforcing adding tests",
    "start": "786240",
    "end": "789040"
  },
  {
    "text": "developers were able to work around the",
    "start": "789040",
    "end": "790880"
  },
  {
    "text": "stop gap phase of test enforcement",
    "start": "790880",
    "end": "793120"
  },
  {
    "text": "we decided we needed a way to add code",
    "start": "793120",
    "end": "795200"
  },
  {
    "text": "coverage to the tool",
    "start": "795200",
    "end": "796959"
  },
  {
    "text": "there are two ways of adding coverage",
    "start": "796959",
    "end": "798959"
  },
  {
    "text": "first one is shallow",
    "start": "798959",
    "end": "800480"
  },
  {
    "text": "and just checks that there is a test for",
    "start": "800480",
    "end": "802720"
  },
  {
    "text": "every routing rule",
    "start": "802720",
    "end": "804639"
  },
  {
    "text": "the second one is more strict and",
    "start": "804639",
    "end": "806320"
  },
  {
    "text": "enforces writing all assertions for each",
    "start": "806320",
    "end": "808800"
  },
  {
    "text": "test",
    "start": "808800",
    "end": "810160"
  },
  {
    "text": "this gives us the comfort that all",
    "start": "810160",
    "end": "811760"
  },
  {
    "text": "ascertains have been tested with a",
    "start": "811760",
    "end": "813279"
  },
  {
    "text": "developer and they know",
    "start": "813279",
    "end": "814560"
  },
  {
    "text": "what they intend to do in the example",
    "start": "814560",
    "end": "818160"
  },
  {
    "text": "the third box shows an example of a",
    "start": "818160",
    "end": "820800"
  },
  {
    "text": "failing test which is complaining about",
    "start": "820800",
    "end": "822880"
  },
  {
    "text": "low code coverage and tells us which",
    "start": "822880",
    "end": "825040"
  },
  {
    "text": "particular accessions are failing",
    "start": "825040",
    "end": "829839"
  },
  {
    "text": "like any production system",
    "start": "832720",
    "end": "835839"
  },
  {
    "text": "our infra is based on runtime configs",
    "start": "835839",
    "end": "837839"
  },
  {
    "text": "for safe rollouts",
    "start": "837839",
    "end": "839680"
  },
  {
    "text": "developers needed a way to flip the",
    "start": "839680",
    "end": "841279"
  },
  {
    "text": "runtime in config and test how the",
    "start": "841279",
    "end": "843600"
  },
  {
    "text": "routes behaved we added new fields in",
    "start": "843600",
    "end": "846160"
  },
  {
    "text": "the input to crank the runtime",
    "start": "846160",
    "end": "847839"
  },
  {
    "text": "using some random values and test the",
    "start": "847839",
    "end": "849680"
  },
  {
    "text": "output we had now",
    "start": "849680",
    "end": "851519"
  },
  {
    "text": "almost 100 question code coverage in our",
    "start": "851519",
    "end": "854839"
  },
  {
    "text": "system",
    "start": "854839",
    "end": "857279"
  },
  {
    "text": "routes behave differently based on",
    "start": "857279",
    "end": "859199"
  },
  {
    "text": "headers if headers if you wish them to",
    "start": "859199",
    "end": "862000"
  },
  {
    "text": "we needed a way to enforce testing on",
    "start": "862000",
    "end": "864079"
  },
  {
    "text": "these routes",
    "start": "864079",
    "end": "865040"
  },
  {
    "text": "we can supply you can supply headers in",
    "start": "865040",
    "end": "867360"
  },
  {
    "text": "the test setup and",
    "start": "867360",
    "end": "868560"
  },
  {
    "text": "test the behavior of the routes",
    "start": "868560",
    "end": "872240"
  },
  {
    "text": "constantly updating the on-way binary",
    "start": "876320",
    "end": "878160"
  },
  {
    "text": "comes at a cost",
    "start": "878160",
    "end": "879839"
  },
  {
    "text": "there are fields getting deprecated all",
    "start": "879839",
    "end": "881519"
  },
  {
    "text": "the time and having them in the system",
    "start": "881519",
    "end": "883279"
  },
  {
    "text": "introduces spectate",
    "start": "883279",
    "end": "884720"
  },
  {
    "text": "and a higher migration time later we",
    "start": "884720",
    "end": "887680"
  },
  {
    "text": "added a deprecated field check in the",
    "start": "887680",
    "end": "889360"
  },
  {
    "text": "tool",
    "start": "889360",
    "end": "889920"
  },
  {
    "text": "so that it fails whenever it observes a",
    "start": "889920",
    "end": "892160"
  },
  {
    "text": "deprecated field",
    "start": "892160",
    "end": "893839"
  },
  {
    "text": "we quickly resolve it since usually it's",
    "start": "893839",
    "end": "895680"
  },
  {
    "text": "one or two fields at a time",
    "start": "895680",
    "end": "897279"
  },
  {
    "text": "and doesn't stay long enough to become",
    "start": "897279",
    "end": "899920"
  },
  {
    "text": "risky",
    "start": "899920",
    "end": "902399"
  },
  {
    "text": "[Music]",
    "start": "903430",
    "end": "904560"
  },
  {
    "text": "adding tests for untested parts in the",
    "start": "904560",
    "end": "906639"
  },
  {
    "text": "system is a culture shift",
    "start": "906639",
    "end": "908560"
  },
  {
    "text": "it needs help from developers to test it",
    "start": "908560",
    "end": "910880"
  },
  {
    "text": "and also",
    "start": "910880",
    "end": "911680"
  },
  {
    "text": "a few curious ones to work around it so",
    "start": "911680",
    "end": "914160"
  },
  {
    "text": "that we can be",
    "start": "914160",
    "end": "915600"
  },
  {
    "text": "uh we can put in better enforcement we",
    "start": "915600",
    "end": "918160"
  },
  {
    "text": "had a bumpy ride while putting it",
    "start": "918160",
    "end": "919680"
  },
  {
    "text": "in our system but in the end it was a",
    "start": "919680",
    "end": "922240"
  },
  {
    "text": "win-win for everyone",
    "start": "922240",
    "end": "923680"
  },
  {
    "text": "the detouring team saved the time spent",
    "start": "923680",
    "end": "925440"
  },
  {
    "text": "by on calls eyeballing routing",
    "start": "925440",
    "end": "927199"
  },
  {
    "text": "configurations",
    "start": "927199",
    "end": "928240"
  },
  {
    "text": "and help developers to ship stuff faster",
    "start": "928240",
    "end": "931680"
  },
  {
    "text": "i'll give it away to lisa to talk about",
    "start": "931680",
    "end": "934000"
  },
  {
    "text": "the future directions",
    "start": "934000",
    "end": "936959"
  },
  {
    "start": "937000",
    "end": "1131000"
  },
  {
    "text": "great thanks jody um so hopefully",
    "start": "937440",
    "end": "940079"
  },
  {
    "text": "through this presentation",
    "start": "940079",
    "end": "941360"
  },
  {
    "text": "you've seen the different ways you can",
    "start": "941360",
    "end": "942959"
  },
  {
    "text": "utilize open source tooling or writing",
    "start": "942959",
    "end": "945279"
  },
  {
    "text": "your own scripts to",
    "start": "945279",
    "end": "946959"
  },
  {
    "text": "automate the testing and validation of",
    "start": "946959",
    "end": "949440"
  },
  {
    "text": "envoy configs",
    "start": "949440",
    "end": "950959"
  },
  {
    "text": "um and while this is really powerful i",
    "start": "950959",
    "end": "952880"
  },
  {
    "text": "mean it certainly helped lift",
    "start": "952880",
    "end": "954880"
  },
  {
    "text": "keep up with our huge ammo configs",
    "start": "954880",
    "end": "957120"
  },
  {
    "text": "there's still a lot of room for",
    "start": "957120",
    "end": "958880"
  },
  {
    "text": "improvement and how we",
    "start": "958880",
    "end": "962160"
  },
  {
    "text": "build the tool and to test these",
    "start": "962160",
    "end": "965519"
  },
  {
    "text": "so first off um envoy has a ton of",
    "start": "967279",
    "end": "970320"
  },
  {
    "text": "different features",
    "start": "970320",
    "end": "971600"
  },
  {
    "text": "but there's still not test support for",
    "start": "971600",
    "end": "973680"
  },
  {
    "text": "all of these features",
    "start": "973680",
    "end": "975120"
  },
  {
    "text": "um at least at lyft our contributions",
    "start": "975120",
    "end": "978560"
  },
  {
    "text": "have mostly been spurred by",
    "start": "978560",
    "end": "980000"
  },
  {
    "text": "demand from our developers so for",
    "start": "980000",
    "end": "982240"
  },
  {
    "text": "example the router check tool didn't",
    "start": "982240",
    "end": "984240"
  },
  {
    "text": "always have the capability to",
    "start": "984240",
    "end": "986240"
  },
  {
    "text": "calculate coverage or have test support",
    "start": "986240",
    "end": "989040"
  },
  {
    "text": "for",
    "start": "989040",
    "end": "989839"
  },
  {
    "text": "runtime values and flags or",
    "start": "989839",
    "end": "993920"
  },
  {
    "text": "header manipulation and checking header",
    "start": "994240",
    "end": "996320"
  },
  {
    "text": "values",
    "start": "996320",
    "end": "997360"
  },
  {
    "text": "uh and while those are supported now",
    "start": "997360",
    "end": "1000399"
  },
  {
    "text": "there's still a bunch of features that",
    "start": "1000399",
    "end": "1002480"
  },
  {
    "text": "users want such as cores or checking",
    "start": "1002480",
    "end": "1005600"
  },
  {
    "text": "that",
    "start": "1005600",
    "end": "1006000"
  },
  {
    "text": "your direct response rate returns the",
    "start": "1006000",
    "end": "1008000"
  },
  {
    "text": "expected",
    "start": "1008000",
    "end": "1009040"
  },
  {
    "text": "status code and so there's definitely",
    "start": "1009040",
    "end": "1012160"
  },
  {
    "text": "plenty of room to",
    "start": "1012160",
    "end": "1013519"
  },
  {
    "text": "increase the kind of behavior that can",
    "start": "1013519",
    "end": "1015279"
  },
  {
    "text": "be tested with the router check tool",
    "start": "1015279",
    "end": "1019120"
  },
  {
    "text": "building off of this one major",
    "start": "1019360",
    "end": "1021680"
  },
  {
    "text": "improvement would be utilizing",
    "start": "1021680",
    "end": "1023040"
  },
  {
    "text": "production code",
    "start": "1023040",
    "end": "1024400"
  },
  {
    "text": "um currently the router check tool uh",
    "start": "1024400",
    "end": "1027438"
  },
  {
    "text": "uses the same routing function as you",
    "start": "1027439",
    "end": "1030240"
  },
  {
    "text": "know on void production itself",
    "start": "1030240",
    "end": "1032160"
  },
  {
    "text": "but when it comes to things like header",
    "start": "1032160",
    "end": "1034720"
  },
  {
    "text": "validation it's more or less a copy of",
    "start": "1034720",
    "end": "1036959"
  },
  {
    "text": "the code that runs in production",
    "start": "1036959",
    "end": "1039520"
  },
  {
    "text": "and this is also one of the main",
    "start": "1039520",
    "end": "1040640"
  },
  {
    "text": "roadblocks to implementing something",
    "start": "1040640",
    "end": "1042400"
  },
  {
    "text": "like cores",
    "start": "1042400",
    "end": "1043520"
  },
  {
    "text": "testing support because ideally you want",
    "start": "1043520",
    "end": "1046240"
  },
  {
    "text": "to be able to use the same code as",
    "start": "1046240",
    "end": "1047918"
  },
  {
    "text": "production so that",
    "start": "1047919",
    "end": "1050799"
  },
  {
    "text": "testing support is consistent and",
    "start": "1050799",
    "end": "1052480"
  },
  {
    "text": "doesn't diverge",
    "start": "1052480",
    "end": "1053919"
  },
  {
    "text": "and also just makes adding test support",
    "start": "1053919",
    "end": "1055760"
  },
  {
    "text": "a lot less brutal because",
    "start": "1055760",
    "end": "1057679"
  },
  {
    "text": "um as you may know envoy open source",
    "start": "1057679",
    "end": "1060160"
  },
  {
    "text": "envoy gets a lot of changes",
    "start": "1060160",
    "end": "1062160"
  },
  {
    "text": "every day and so um",
    "start": "1062160",
    "end": "1065200"
  },
  {
    "text": "just copying the code over from",
    "start": "1065200",
    "end": "1066559"
  },
  {
    "text": "production is not very feasible",
    "start": "1066559",
    "end": "1069919"
  },
  {
    "text": "and then finally i think the ideal state",
    "start": "1069919",
    "end": "1072080"
  },
  {
    "text": "of",
    "start": "1072080",
    "end": "1073039"
  },
  {
    "text": "uh the tooling would be having true",
    "start": "1073039",
    "end": "1074880"
  },
  {
    "text": "black box testing",
    "start": "1074880",
    "end": "1076160"
  },
  {
    "text": "what this would mean is just having to",
    "start": "1076160",
    "end": "1078559"
  },
  {
    "text": "input a full envoy config",
    "start": "1078559",
    "end": "1080640"
  },
  {
    "text": "versus knowing specific route inputs for",
    "start": "1080640",
    "end": "1082880"
  },
  {
    "text": "your unit tests beforehand",
    "start": "1082880",
    "end": "1084720"
  },
  {
    "text": "and this way users could simulate",
    "start": "1084720",
    "end": "1086480"
  },
  {
    "text": "request behavior without having to come",
    "start": "1086480",
    "end": "1088400"
  },
  {
    "text": "up with",
    "start": "1088400",
    "end": "1089360"
  },
  {
    "text": "the certain test cases they want and",
    "start": "1089360",
    "end": "1091760"
  },
  {
    "text": "just inspect the resultant response and",
    "start": "1091760",
    "end": "1094240"
  },
  {
    "text": "you know this could be used hand-in-hand",
    "start": "1094240",
    "end": "1095840"
  },
  {
    "text": "with the existing unit testing flow but",
    "start": "1095840",
    "end": "1098559"
  },
  {
    "text": "i think this particular approach also",
    "start": "1098559",
    "end": "1100240"
  },
  {
    "text": "lends itself well to a ui based way of",
    "start": "1100240",
    "end": "1102400"
  },
  {
    "text": "testing the routing table",
    "start": "1102400",
    "end": "1104000"
  },
  {
    "text": "in which you can just input some",
    "start": "1104000",
    "end": "1105760"
  },
  {
    "text": "parameters and",
    "start": "1105760",
    "end": "1107280"
  },
  {
    "text": "um see what the resultant behavior is",
    "start": "1107280",
    "end": "1110480"
  },
  {
    "text": "and that might be um something that's",
    "start": "1110480",
    "end": "1113280"
  },
  {
    "text": "more intuitive for",
    "start": "1113280",
    "end": "1114640"
  },
  {
    "text": "service owners instead of having to fill",
    "start": "1114640",
    "end": "1116960"
  },
  {
    "text": "out",
    "start": "1116960",
    "end": "1117760"
  },
  {
    "text": "the values for very specific envoy route",
    "start": "1117760",
    "end": "1120799"
  },
  {
    "text": "configuration fields",
    "start": "1120799",
    "end": "1122880"
  },
  {
    "text": "um so yeah definitely a lot of room for",
    "start": "1122880",
    "end": "1125200"
  },
  {
    "text": "improvement in the router check tool",
    "start": "1125200",
    "end": "1126720"
  },
  {
    "text": "and we'd love to chat if you are",
    "start": "1126720",
    "end": "1128720"
  },
  {
    "text": "interested in contributing",
    "start": "1128720",
    "end": "1131679"
  },
  {
    "start": "1131000",
    "end": "1138000"
  },
  {
    "text": "with that um that concludes our talk and",
    "start": "1131679",
    "end": "1135120"
  },
  {
    "text": "please let us know if you have any",
    "start": "1135120",
    "end": "1136240"
  },
  {
    "text": "questions thank you",
    "start": "1136240",
    "end": "1139520"
  },
  {
    "start": "1138000",
    "end": "1217000"
  },
  {
    "text": "hi",
    "start": "1139600",
    "end": "1141760"
  },
  {
    "text": "there questions around uh",
    "start": "1143360",
    "end": "1146480"
  },
  {
    "text": "yaml so yeah we have a lot of camels we",
    "start": "1146480",
    "end": "1150000"
  },
  {
    "text": "are temperatized using jinja",
    "start": "1150000",
    "end": "1152240"
  },
  {
    "text": "and we put together a part of our",
    "start": "1152240",
    "end": "1155600"
  },
  {
    "text": "vr outputs or artifacts and they go land",
    "start": "1155600",
    "end": "1158799"
  },
  {
    "text": "on the side cars",
    "start": "1158799",
    "end": "1160640"
  },
  {
    "text": "yeah a lot of camels",
    "start": "1160640",
    "end": "1165840"
  },
  {
    "text": "and the question about being a",
    "start": "1185120",
    "end": "1187200"
  },
  {
    "text": "standalone tool",
    "start": "1187200",
    "end": "1188640"
  },
  {
    "text": "so it's a part of a different folder",
    "start": "1188640",
    "end": "1191919"
  },
  {
    "text": "test tools and you can use a different",
    "start": "1191919",
    "end": "1195600"
  },
  {
    "text": "build target to build the exe and land",
    "start": "1195600",
    "end": "1198799"
  },
  {
    "text": "in your",
    "start": "1198799",
    "end": "1199600"
  },
  {
    "text": "pr flows and",
    "start": "1199600",
    "end": "1202640"
  },
  {
    "text": "give it the files that will just exist",
    "start": "1202640",
    "end": "1206000"
  },
  {
    "text": "the test bind is not only",
    "start": "1206000",
    "end": "1210400"
  },
  {
    "text": "the deployment takes",
    "start": "1213520",
    "end": "1216559"
  },
  {
    "text": "uh yeah so we do defer deeper ac",
    "start": "1216559",
    "end": "1219679"
  },
  {
    "start": "1217000",
    "end": "1290000"
  },
  {
    "text": "deployments",
    "start": "1219679",
    "end": "1220480"
  },
  {
    "text": "uh and",
    "start": "1220480",
    "end": "1223520"
  },
  {
    "text": "the sidecar the the the gambles and",
    "start": "1223520",
    "end": "1226480"
  },
  {
    "text": "templates are already",
    "start": "1226480",
    "end": "1227600"
  },
  {
    "text": "predefined for production staging and",
    "start": "1227600",
    "end": "1229840"
  },
  {
    "text": "development",
    "start": "1229840",
    "end": "1230880"
  },
  {
    "text": "so that doesn't take our time um",
    "start": "1230880",
    "end": "1234720"
  },
  {
    "text": "but yeah we do",
    "start": "1234720",
    "end": "1237840"
  },
  {
    "text": "safe routes probably in the span of",
    "start": "1237840",
    "end": "1242240"
  },
  {
    "text": "five to ten minutes for easy",
    "start": "1242240",
    "end": "1245919"
  },
  {
    "text": "yeah i think around 10 minutes crazy",
    "start": "1250000",
    "end": "1252000"
  },
  {
    "text": "sounds great",
    "start": "1252000",
    "end": "1254640"
  },
  {
    "text": "do you know why we went with jinja or",
    "start": "1259200",
    "end": "1260960"
  },
  {
    "text": "the historical contract",
    "start": "1260960",
    "end": "1262320"
  },
  {
    "text": "for that it's probably an artifact of",
    "start": "1262320",
    "end": "1265520"
  },
  {
    "text": "how it was written",
    "start": "1265520",
    "end": "1266799"
  },
  {
    "text": "a few years back and we haven't moved it",
    "start": "1266799",
    "end": "1269280"
  },
  {
    "text": "around yet",
    "start": "1269280",
    "end": "1270480"
  },
  {
    "text": "but probably that",
    "start": "1270480",
    "end": "1277840"
  },
  {
    "start": "1290000",
    "end": "1369000"
  },
  {
    "text": "um so our control plane will fetch the",
    "start": "1290960",
    "end": "1293760"
  },
  {
    "text": "envoy routes",
    "start": "1293760",
    "end": "1294799"
  },
  {
    "text": "there's like a file that we write the",
    "start": "1294799",
    "end": "1296559"
  },
  {
    "text": "routes to s3 and i'll sync that",
    "start": "1296559",
    "end": "1299280"
  },
  {
    "text": "um at a given time interval and then it",
    "start": "1299280",
    "end": "1301760"
  },
  {
    "text": "will create the route configuration",
    "start": "1301760",
    "end": "1303520"
  },
  {
    "text": "objects from that",
    "start": "1303520",
    "end": "1305039"
  },
  {
    "text": "information and then send it down to",
    "start": "1305039",
    "end": "1306880"
  },
  {
    "text": "assign cars",
    "start": "1306880",
    "end": "1309600"
  },
  {
    "text": "and we also use a dipping mechanism",
    "start": "1314799",
    "end": "1317360"
  },
  {
    "text": "based on",
    "start": "1317360",
    "end": "1318080"
  },
  {
    "text": "a manifest version so only if there's a",
    "start": "1318080",
    "end": "1320960"
  },
  {
    "text": "diff",
    "start": "1320960",
    "end": "1321360"
  },
  {
    "text": "in the sd file only then",
    "start": "1321360",
    "end": "1324720"
  },
  {
    "text": "it gets applied otherwise",
    "start": "1324720",
    "end": "1333840"
  },
  {
    "text": "yeah it's uh on an interval",
    "start": "1348240",
    "end": "1361840"
  },
  {
    "start": "1369000",
    "end": "1444000"
  },
  {
    "text": "yeah about the",
    "start": "1370240",
    "end": "1373760"
  },
  {
    "text": "so i'm just not using latest vector",
    "start": "1373760",
    "end": "1375760"
  },
  {
    "text": "versions we",
    "start": "1375760",
    "end": "1376880"
  },
  {
    "text": "had trouble there we had to change",
    "start": "1376880",
    "end": "1380000"
  },
  {
    "text": "services",
    "start": "1380000",
    "end": "1380799"
  },
  {
    "text": "which were using an older site",
    "start": "1380799",
    "end": "1382320"
  },
  {
    "text": "conversion",
    "start": "1382320",
    "end": "1383919"
  },
  {
    "text": "um right now there are mechanisms in",
    "start": "1383919",
    "end": "1386240"
  },
  {
    "text": "envoy",
    "start": "1386240",
    "end": "1386960"
  },
  {
    "text": "we could use to serve both v2 and v3",
    "start": "1386960",
    "end": "1392240"
  },
  {
    "text": "fields using a runtime it was landed",
    "start": "1392240",
    "end": "1395360"
  },
  {
    "text": "last",
    "start": "1395360",
    "end": "1396080"
  },
  {
    "text": "month i guess but uh it was not",
    "start": "1396080",
    "end": "1398799"
  },
  {
    "text": "available",
    "start": "1398799",
    "end": "1399360"
  },
  {
    "text": "two few months back so we ended up",
    "start": "1399360",
    "end": "1402159"
  },
  {
    "text": "migrating",
    "start": "1402159",
    "end": "1402880"
  },
  {
    "text": "all of our side cars to use the latest",
    "start": "1402880",
    "end": "1405440"
  },
  {
    "text": "envoy and",
    "start": "1405440",
    "end": "1407440"
  },
  {
    "text": "then it worked out but we make sure",
    "start": "1407440",
    "end": "1409200"
  },
  {
    "text": "using the dedicated field check",
    "start": "1409200",
    "end": "1410799"
  },
  {
    "text": "that there are no debate fields in our",
    "start": "1410799",
    "end": "1413919"
  },
  {
    "text": "conflicts and they don't pass prs if",
    "start": "1413919",
    "end": "1415840"
  },
  {
    "text": "they are",
    "start": "1415840",
    "end": "1431840"
  },
  {
    "text": "uh why are the animals of the files so",
    "start": "1437679",
    "end": "1440480"
  },
  {
    "text": "large lisa do you want to take that",
    "start": "1440480",
    "end": "1444720"
  },
  {
    "text": "yeah so i mean there are some services",
    "start": "1444720",
    "end": "1446720"
  },
  {
    "text": "at lyft that sort of need to",
    "start": "1446720",
    "end": "1448640"
  },
  {
    "text": "communicate with the other services so",
    "start": "1448640",
    "end": "1450720"
  },
  {
    "text": "as a result",
    "start": "1450720",
    "end": "1452000"
  },
  {
    "text": "um like lots of clusters and route",
    "start": "1452000",
    "end": "1455279"
  },
  {
    "text": "information for them",
    "start": "1455279",
    "end": "1456480"
  },
  {
    "text": "but as a number of services has grown we",
    "start": "1456480",
    "end": "1458960"
  },
  {
    "text": "just have a lot of",
    "start": "1458960",
    "end": "1460000"
  },
  {
    "text": "user-defined routes um and a lot of sort",
    "start": "1460000",
    "end": "1463120"
  },
  {
    "text": "of default",
    "start": "1463120",
    "end": "1463919"
  },
  {
    "text": "config content that gets added to every",
    "start": "1463919",
    "end": "1467760"
  },
  {
    "text": "services config so i think over time and",
    "start": "1467760",
    "end": "1470960"
  },
  {
    "text": "it's just grown a lot in size",
    "start": "1470960",
    "end": "1475039"
  },
  {
    "text": "um and i guess to be explicit the",
    "start": "1479919",
    "end": "1482000"
  },
  {
    "text": "deprecation check is a flag that you can",
    "start": "1482000",
    "end": "1484240"
  },
  {
    "text": "pass in for the router check tool",
    "start": "1484240",
    "end": "1487840"
  },
  {
    "text": "yeah we struggle with v2 and v3 quite a",
    "start": "1504000",
    "end": "1507039"
  },
  {
    "text": "bit",
    "start": "1507039",
    "end": "1507440"
  },
  {
    "text": "but we're about the hump i guess the",
    "start": "1507440",
    "end": "1510080"
  },
  {
    "text": "next question is about",
    "start": "1510080",
    "end": "1511440"
  },
  {
    "text": "how are they stored in the guitar we",
    "start": "1511440",
    "end": "1513120"
  },
  {
    "text": "have a different a separate repo",
    "start": "1513120",
    "end": "1515520"
  },
  {
    "text": "just for storing the routes so that",
    "start": "1515520",
    "end": "1517039"
  },
  {
    "text": "people can add and",
    "start": "1517039",
    "end": "1518559"
  },
  {
    "text": "change routes as for their will",
    "start": "1518559",
    "end": "1522400"
  },
  {
    "text": "um we have different mechanisms we",
    "start": "1522400",
    "end": "1526720"
  },
  {
    "text": "have uh json-based conflicts that we",
    "start": "1526720",
    "end": "1530400"
  },
  {
    "text": "parse and create xds requests out of",
    "start": "1530400",
    "end": "1533760"
  },
  {
    "text": "we also have uh",
    "start": "1533760",
    "end": "1537200"
  },
  {
    "text": "conflicts which replicate exactly the",
    "start": "1537200",
    "end": "1539279"
  },
  {
    "text": "routes and we just",
    "start": "1539279",
    "end": "1542080"
  },
  {
    "text": "deserialize them and pass it on to the",
    "start": "1542080",
    "end": "1544400"
  },
  {
    "text": "side cars",
    "start": "1544400",
    "end": "1545200"
  },
  {
    "text": "so we go both ways there sometimes",
    "start": "1545200",
    "end": "1548320"
  },
  {
    "text": "in order to reduce the knobs that we",
    "start": "1548320",
    "end": "1549840"
  },
  {
    "text": "expose to the developers",
    "start": "1549840",
    "end": "1551360"
  },
  {
    "text": "uh we only allow a particular json",
    "start": "1551360",
    "end": "1554240"
  },
  {
    "text": "format",
    "start": "1554240",
    "end": "1554880"
  },
  {
    "text": "so that they can put specific fields",
    "start": "1554880",
    "end": "1557279"
  },
  {
    "text": "they want to override",
    "start": "1557279",
    "end": "1558400"
  },
  {
    "text": "and everything else is uh defaulted um",
    "start": "1558400",
    "end": "1561600"
  },
  {
    "text": "but with routes it's probably not very",
    "start": "1561600",
    "end": "1564080"
  },
  {
    "text": "useful because people can go",
    "start": "1564080",
    "end": "1565840"
  },
  {
    "text": "anywhere and there'll be probably tens",
    "start": "1565840",
    "end": "1568159"
  },
  {
    "text": "of 20s or not so",
    "start": "1568159",
    "end": "1569520"
  },
  {
    "text": "we'll let that be as a round",
    "start": "1569520",
    "end": "1572080"
  },
  {
    "text": "configuration itself",
    "start": "1572080",
    "end": "1584240"
  },
  {
    "text": "yeah front proxy yes so we that",
    "start": "1584240",
    "end": "1588400"
  },
  {
    "text": "covers a lot of our edge traffic so a",
    "start": "1588400",
    "end": "1591520"
  },
  {
    "text": "lot of piano there",
    "start": "1591520",
    "end": "1599840"
  },
  {
    "text": "so",
    "start": "1610840",
    "end": "1613840"
  },
  {
    "text": "so",
    "start": "1638840",
    "end": "1641840"
  },
  {
    "start": "1652000",
    "end": "1724000"
  },
  {
    "text": "so we have uh two ways of doing traffic",
    "start": "1652159",
    "end": "1655760"
  },
  {
    "text": "one is",
    "start": "1655760",
    "end": "1656559"
  },
  {
    "text": "through service manifest people can uh",
    "start": "1656559",
    "end": "1659760"
  },
  {
    "text": "write configs on their own services",
    "start": "1659760",
    "end": "1661600"
  },
  {
    "text": "manifest and the control plane has a way",
    "start": "1661600",
    "end": "1663520"
  },
  {
    "text": "of",
    "start": "1663520",
    "end": "1663840"
  },
  {
    "text": "picking that those from the s3 and when",
    "start": "1663840",
    "end": "1666880"
  },
  {
    "text": "they deployed to development",
    "start": "1666880",
    "end": "1668399"
  },
  {
    "text": "they can change only their services",
    "start": "1668399",
    "end": "1670799"
  },
  {
    "text": "conflicts and the control plane",
    "start": "1670799",
    "end": "1672640"
  },
  {
    "text": "in dev can pick it up",
    "start": "1672640",
    "end": "1682000"
  },
  {
    "text": "like no they don't have to check in",
    "start": "1682000",
    "end": "1683279"
  },
  {
    "text": "countries exclusively",
    "start": "1683279",
    "end": "1685120"
  },
  {
    "text": "they can do a branch and work on top of",
    "start": "1685120",
    "end": "1688159"
  },
  {
    "text": "it in development",
    "start": "1688159",
    "end": "1697840"
  },
  {
    "text": "so",
    "start": "1708840",
    "end": "1710880"
  },
  {
    "text": "i guess we are at time uh almost uh",
    "start": "1710880",
    "end": "1714240"
  },
  {
    "text": "one minute so it was great talking about",
    "start": "1714240",
    "end": "1716880"
  },
  {
    "text": "this",
    "start": "1716880",
    "end": "1717440"
  },
  {
    "text": "uh and thank you guys for listening",
    "start": "1717440",
    "end": "1720880"
  },
  {
    "text": "feel free to reach out to us if you have",
    "start": "1720880",
    "end": "1722840"
  },
  {
    "text": "any",
    "start": "1722840",
    "end": "1725840"
  }
]