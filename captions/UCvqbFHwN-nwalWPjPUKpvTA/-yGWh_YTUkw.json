[
  {
    "text": "hello everybody how you doing today it's",
    "start": "589",
    "end": "7890"
  },
  {
    "text": "quite out there yeah so we're here to talk a little bit about the spiffy",
    "start": "7890",
    "end": "13920"
  },
  {
    "text": "inspire project some security assessment mat myself and a few others did over the",
    "start": "13920",
    "end": "19830"
  },
  {
    "text": "last year so my name is Evan Gilman I'm an engineer at Scytale and I'm working",
    "start": "19830",
    "end": "26099"
  },
  {
    "text": "actively on the spiffy inspired projects pretty much full-time now there's",
    "start": "26099",
    "end": "31769"
  },
  {
    "text": "previously enough sorry a pager duty doing automation traffic management and",
    "start": "31769",
    "end": "36989"
  },
  {
    "text": "things along those lines and was a network engineer in academia previous",
    "start": "36989",
    "end": "42210"
  },
  {
    "text": "life and I'm here with Matt today my name is Matt Moyer at the beginning of",
    "start": "42210",
    "end": "47820"
  },
  {
    "text": "this week I was a security engineer at hep-2 as of yesterday afternoon I'm a security engineer at VMware because our",
    "start": "47820",
    "end": "54390"
  },
  {
    "text": "acquisition went through prior to that I worked at I was a security engineer at a",
    "start": "54390",
    "end": "59579"
  },
  {
    "text": "small bank I'm doing kubernetes migration so what are we what are we",
    "start": "59579",
    "end": "65040"
  },
  {
    "text": "here for what's this all about so before we get started how many people in the room have heard of spiffy it's good how",
    "start": "65040",
    "end": "73110"
  },
  {
    "text": "many people are using spiffy in some capacity cool how many people are using spire have played with spire will say",
    "start": "73110",
    "end": "80729"
  },
  {
    "text": "cool so if you do know about spiffy you know that security is one of the key",
    "start": "80729",
    "end": "86490"
  },
  {
    "text": "components for why you would use Biffy it's not the only one but it's one of the one of the key ones so what we",
    "start": "86490",
    "end": "92159"
  },
  {
    "text": "really want to do is understand what are the expected security properties of a spiffy system and then how close are we",
    "start": "92159",
    "end": "99360"
  },
  {
    "text": "to sort of meeting those expected properties where are there gaps yeah",
    "start": "99360",
    "end": "105299"
  },
  {
    "text": "it's definitely an important thing to get right so in doing so it's really",
    "start": "105299",
    "end": "111240"
  },
  {
    "text": "important to validate these decisions early on before it's too late to correct so we want to make sure we're kind of",
    "start": "111240",
    "end": "117719"
  },
  {
    "text": "just heading in the right direction here in order to do this we embarked on a somewhat lengthy security assessment",
    "start": "117719",
    "end": "124520"
  },
  {
    "text": "where really we were just interested in studying like this with aspire security model trying to describe its properties",
    "start": "124520",
    "end": "132360"
  },
  {
    "text": "and then to analyze the overall design for weaknesses in delivering on those properties this effort was kicked off in",
    "start": "132360",
    "end": "140730"
  },
  {
    "text": "December 2017 I was led by Justin coppice who's here today and was",
    "start": "140730",
    "end": "146940"
  },
  {
    "text": "participation from myself for Matt and from Enrico were community members who raised their hand and volunteered to put",
    "start": "146940",
    "end": "155040"
  },
  {
    "text": "a lot of time I put a lot of time in basically and the goals of this effort were first to understand the expected",
    "start": "155040",
    "end": "162390"
  },
  {
    "text": "security properties of us with the implementation like what properties are important giving given Spivey's mission",
    "start": "162390",
    "end": "169550"
  },
  {
    "text": "in a second we wanted to explore different classes of vulnerabilities like given the properties that we know",
    "start": "169550",
    "end": "176370"
  },
  {
    "text": "are important to spiffy how might an attacker abuse a system like this and",
    "start": "176370",
    "end": "181460"
  },
  {
    "text": "finally we wanted to take this learning and understanding and apply it to the spiffy inspired design where their weak",
    "start": "181460",
    "end": "189000"
  },
  {
    "text": "points and how bad are those weak points and how might we be able to change our design to improve that stance so of",
    "start": "189000",
    "end": "198209"
  },
  {
    "text": "course like any well scope project you had a couple of non goals as well we were really interested in finding like",
    "start": "198209",
    "end": "204120"
  },
  {
    "text": "specific implementation vulnerabilities things like bugs and authorization",
    "start": "204120",
    "end": "209400"
  },
  {
    "text": "checks etcetera or kind of out of scope for this assessment instead we wanted to focus on the overall design and",
    "start": "209400",
    "end": "215280"
  },
  {
    "text": "architecture of the spire system and the specification step we were we also were",
    "start": "215280",
    "end": "223709"
  },
  {
    "text": "not interested in like formally proving anything so this is definitely not a formalized threat model as some people",
    "start": "223709",
    "end": "230190"
  },
  {
    "text": "might be familiar with rather this is a tool that will help us analyze the",
    "start": "230190",
    "end": "235500"
  },
  {
    "text": "security properties and the weaknesses in the system as it evolves over time",
    "start": "235500",
    "end": "241070"
  },
  {
    "text": "sure so we're gonna this is we're gonna go through today what we really hope is",
    "start": "241550",
    "end": "246780"
  },
  {
    "text": "that when you when you leave this talk you're going to feel comfortable talking about what are the expected security",
    "start": "246780",
    "end": "252959"
  },
  {
    "text": "properties of spiffy and whether that means you feel more comfortable with an existing installation that you're doing",
    "start": "252959",
    "end": "258780"
  },
  {
    "text": "or you feel more comfortable proceeding down the path of adopting spiffy in some capacity or maybe understanding this",
    "start": "258780",
    "end": "265500"
  },
  {
    "text": "biffy's expected security properties don't work for your use case any of those is fine so we're gonna start off",
    "start": "265500",
    "end": "270930"
  },
  {
    "text": "with a quick intro to what is spiffy how does spiffy work also what is spire how to spire work I'm",
    "start": "270930",
    "end": "278310"
  },
  {
    "text": "going to talk about what are the expected properties of the system this is sort of the meat of the presentation we're gonna talk about how we came up",
    "start": "278310",
    "end": "285479"
  },
  {
    "text": "with that list what was our methodology and then finally Evans gonna present some findings okay thanks Matt so I",
    "start": "285479",
    "end": "293910"
  },
  {
    "text": "think that most of these presentations start out with a pretty basic question of like what is spiffy for those of you",
    "start": "293910",
    "end": "301020"
  },
  {
    "text": "who don't know that there were a handful of folks spiffy stands for secure",
    "start": "301020",
    "end": "306300"
  },
  {
    "text": "production identity framework for everyone right and what spiffy actually is a specification more accurately it's",
    "start": "306300",
    "end": "314880"
  },
  {
    "text": "a specification set right it's more than one specification and the goal of these",
    "start": "314880",
    "end": "320970"
  },
  {
    "text": "specs is to provide this idea of notion of interoperable and portable worklet",
    "start": "320970",
    "end": "326130"
  },
  {
    "text": "identity which is platform agnostic and in order to do that we define an",
    "start": "326130",
    "end": "332460"
  },
  {
    "text": "identity namespace and we Devine like a set of documents and interfaces and",
    "start": "332460",
    "end": "338070"
  },
  {
    "text": "together those things are used to publish consume and authenticate these these were clearly identities but I",
    "start": "338070",
    "end": "344880"
  },
  {
    "text": "think like the the most important thing to kind of drive home here is our spiffy is not code spiffy is simply a",
    "start": "344880",
    "end": "350849"
  },
  {
    "text": "specification so let's take a look at some of the major components of spiffy",
    "start": "350849",
    "end": "356960"
  },
  {
    "text": "and the first is what we call the spiffy ID that's basically a structured string",
    "start": "356960",
    "end": "362159"
  },
  {
    "text": "you can see is it's a URI and and it can be kind of thought of as like a username",
    "start": "362159",
    "end": "367500"
  },
  {
    "text": "for workloads that's divided into two parts this first part here is called the",
    "start": "367500",
    "end": "373229"
  },
  {
    "text": "trust domain and the second part is is called the path and so in this example",
    "start": "373229",
    "end": "378560"
  },
  {
    "text": "the trust domain is prod example and foo is the path a trust domain nominally",
    "start": "378560",
    "end": "386669"
  },
  {
    "text": "represents an issuing authority so usually what you see is a trusted man is generally tied to a set of signing keys",
    "start": "386669",
    "end": "392659"
  },
  {
    "text": "and any identity issued within this trust domain is signed and authorized by",
    "start": "392659",
    "end": "397760"
  },
  {
    "text": "this issuing authority next we have something called a speck",
    "start": "397760",
    "end": "402889"
  },
  {
    "text": "verifiable identity document this s food for sure and these are each are",
    "start": "402889",
    "end": "409789"
  },
  {
    "text": "basically just digitally signed documents that prove ownership of a particular identity or a spiffy identity",
    "start": "409789",
    "end": "414970"
  },
  {
    "text": "there's already lots of documents out there and in common use and so there's a",
    "start": "414970",
    "end": "420080"
  },
  {
    "text": "really no need for speed to invent new ones so as a result these s vid specs",
    "start": "420080",
    "end": "425449"
  },
  {
    "text": "they they tend to just set restrictions and rules on top of existing document",
    "start": "425449",
    "end": "430580"
  },
  {
    "text": "types so you know as of today we have two supported document types one is X I have a nine certificate and the other is",
    "start": "430580",
    "end": "437030"
  },
  {
    "text": "shot finally we need a way to kind of",
    "start": "437030",
    "end": "442610"
  },
  {
    "text": "standardize the way that these essays are issued and consumed like where do they come from how do I get one should I",
    "start": "442610",
    "end": "449090"
  },
  {
    "text": "find it on disk where where can I locate my identity and identity documents and",
    "start": "449090",
    "end": "455389"
  },
  {
    "text": "so to solve this but he includes a specification called the spiffy workload API the workload API is a node local API",
    "start": "455389",
    "end": "464030"
  },
  {
    "text": "that workloads use to retrieve their identity and their documents and crucially this API is is not",
    "start": "464030",
    "end": "470449"
  },
  {
    "text": "authenticated and this is really really important because it solves this this bootstrap problem some people call it",
    "start": "470449",
    "end": "477289"
  },
  {
    "text": "the secret 0 problem or secure introduction but it allows workloads to",
    "start": "477289",
    "end": "482539"
  },
  {
    "text": "have no a priori knowledge of their identity so you basically deploy a workload the first that comes up the",
    "start": "482539",
    "end": "488090"
  },
  {
    "text": "first thing that does is it talks to this API doesn't have to know anything else the API says I know you here your keys and here's your cert and you're off",
    "start": "488090",
    "end": "494750"
  },
  {
    "text": "to the races so in summary there's three major components in this specification set as",
    "start": "494750",
    "end": "502190"
  },
  {
    "text": "it exists today there's a spiffy ID there's these s bibs these documents and then there's this workload API part and",
    "start": "502190",
    "end": "509449"
  },
  {
    "text": "together these things form this kind of foundational identity layer that can",
    "start": "509449",
    "end": "514550"
  },
  {
    "text": "span heterogeneous software stacks and platforms because they're not fundamentally bound to those things",
    "start": "514550",
    "end": "519620"
  },
  {
    "text": "they're independent so now that we understand a little bit more about what",
    "start": "519620",
    "end": "525230"
  },
  {
    "text": "spiffy is have a quick look at spire spire is also an acronym it is short for",
    "start": "525230",
    "end": "531500"
  },
  {
    "text": "the spiffy runtime environment as fire is an open-source implementation",
    "start": "531500",
    "end": "536629"
  },
  {
    "text": "of the spiffy specification set it's basic mission in life is to light up",
    "start": "536629",
    "end": "542600"
  },
  {
    "text": "that workload API and and also make it manageable and so to do this the spire",
    "start": "542600",
    "end": "549230"
  },
  {
    "text": "spire includes an agent which is capable of being the server component actually actually lighting up and turning on this",
    "start": "549230",
    "end": "554870"
  },
  {
    "text": "workload API on on node by node basis and this workload api is exposed to in",
    "start": "554870",
    "end": "560720"
  },
  {
    "text": "the spire case over a UNIX domain socket of course there can be many workloads on",
    "start": "560720",
    "end": "566240"
  },
  {
    "text": "a single host so and as you may remember I just mentioned that it's unauthenticated so that the agent has to",
    "start": "566240",
    "end": "571939"
  },
  {
    "text": "have a way to kind of understand who is calling it and authorized the issuance based on the caller so the way the spire",
    "start": "571939",
    "end": "580250"
  },
  {
    "text": "agent accomplishes this is through a concept that we call workload attestation this allows the agent to",
    "start": "580250",
    "end": "587600"
  },
  {
    "text": "serve a single endpoint that all identities are issued over on a node by node basis and and it remains secure",
    "start": "587600",
    "end": "593870"
  },
  {
    "text": "even if filesystem ACLs or misconfigured or there's some other fat-finger in a system that it's not necessary to",
    "start": "593870",
    "end": "600139"
  },
  {
    "text": "protect this actual socket because the agent performs all the security checks so basically how that works is that when",
    "start": "600139",
    "end": "608480"
  },
  {
    "text": "a workload starts up as I mentioned it calls this workload ap is basically the first thing and the age and then reads a",
    "start": "608480",
    "end": "613790"
  },
  {
    "text": "special socket option off the kernel that results in the process ID of the caller the agent then uses this process",
    "start": "613790",
    "end": "621230"
  },
  {
    "text": "ID to interrogate the - kernel find out more about that particular workload things like user name Group C group",
    "start": "621230",
    "end": "629990"
  },
  {
    "text": "membership the path on disk things along these lines are all discoverable at that",
    "start": "629990",
    "end": "635480"
  },
  {
    "text": "point in time and this this discovery logic this attestation logic is also a pluggable so for instance the kubernetes",
    "start": "635480",
    "end": "642620"
  },
  {
    "text": "plugin can take this information and then call the Kubla and say hey tell me everything you know about this thing so",
    "start": "642620",
    "end": "648709"
  },
  {
    "text": "this allows the agent to further obtain information things like service account name space labels on the pod spec docker",
    "start": "648709",
    "end": "655550"
  },
  {
    "text": "image ID stuff like that and then using all this information kind of like taking",
    "start": "655550",
    "end": "660980"
  },
  {
    "text": "it all and fanning it in the agent is able to identify the caller and then issue the correct identity to that particular",
    "start": "660980",
    "end": "666950"
  },
  {
    "text": "caller regardless of what permissions have been set or otherwise so there are",
    "start": "666950",
    "end": "674930"
  },
  {
    "text": "still some open questions I think here you know we collect all this information about the process but you still need to",
    "start": "674930",
    "end": "681230"
  },
  {
    "text": "know like what spiffy ID do I give it based on this information you also need someone to sign that s fed",
    "start": "681230",
    "end": "687470"
  },
  {
    "text": "you know something has to authorize the signing and a nun mint it and issue it",
    "start": "687470",
    "end": "692900"
  },
  {
    "text": "and if you do it in the agent then then they're there security issues which we'll talk about in a little bit",
    "start": "692900",
    "end": "699020"
  },
  {
    "text": "so to solve this problem Speier implements a server component so all the",
    "start": "699020",
    "end": "705080"
  },
  {
    "text": "agents connect back to a server or a set of servers and when an S fit is needed an agent submits a request to this",
    "start": "705080",
    "end": "711920"
  },
  {
    "text": "server and the server then authorizes the request and then signs yes fed and returned to so as I mentioned the the",
    "start": "711920",
    "end": "718550"
  },
  {
    "text": "assigning keys are centralized and that's kind of an important property because it prevents a single compromised",
    "start": "718550",
    "end": "723740"
  },
  {
    "text": "agent from being able to mint arbitrary identities and that gives us one of the",
    "start": "723740",
    "end": "729680"
  },
  {
    "text": "really important security properties at least I think that Matt will talk a little bit about later in the assessment",
    "start": "729680",
    "end": "734810"
  },
  {
    "text": "and so in addition to signing these s feds the server also maintains this",
    "start": "734810",
    "end": "740540"
  },
  {
    "text": "identity registry so basically understands how to map these various workload properties that the agents are",
    "start": "740540",
    "end": "747020"
  },
  {
    "text": "discovering to an actual spiffy ID it also is able to map workloads to an",
    "start": "747020",
    "end": "753110"
  },
  {
    "text": "agent or a set of agents and this list lets us like limit the number of agents which are authorized to request a",
    "start": "753110",
    "end": "759440"
  },
  {
    "text": "particular identity which again aids this property of limiting a blast radius of a particular agent is compromised",
    "start": "759440",
    "end": "768190"
  },
  {
    "text": "this mapping if you will is maintained what we call the registration API so",
    "start": "768460",
    "end": "775460"
  },
  {
    "text": "there's like this registry of identity mappings essentially and this API can be accessed by humans the CLI utilities or",
    "start": "775460",
    "end": "781790"
  },
  {
    "text": "it can be maintained by an automated system with scripts or an Orchestrator or something like this and these",
    "start": "781790",
    "end": "788420"
  },
  {
    "text": "workloads these 50 ideas get registered with what we call an entry a registration entry the entry consists of",
    "start": "788420",
    "end": "796270"
  },
  {
    "text": "quite simply just the spiffy ID those properties we discussed what what is this what are the natural properties",
    "start": "796270",
    "end": "802519"
  },
  {
    "text": "of this workload and how do I know when to issue this 50 ID and then also the agents or group of agents that this this",
    "start": "802519",
    "end": "808730"
  },
  {
    "text": "workload can run on so with this information together you can see kind of",
    "start": "808730",
    "end": "814040"
  },
  {
    "text": "how how a third issuance is managed in the spire system of course this system",
    "start": "814040",
    "end": "820310"
  },
  {
    "text": "like this is quite sensitive security wise and as I mentioned it's really important to validate these architectural decisions early on in the",
    "start": "820310",
    "end": "826850"
  },
  {
    "text": "process that's the motivation for undertaking all this stuff we're talking about today so now that we have a little",
    "start": "826850",
    "end": "834860"
  },
  {
    "text": "bit more background about spiffy inspire and I'm this particularly just by our architecture I'm gonna pass it off to Matt he's going to share some of the",
    "start": "834860",
    "end": "841790"
  },
  {
    "text": "security properties we expect from a system like this as well as what kind of properties are really critically",
    "start": "841790",
    "end": "847490"
  },
  {
    "text": "important yeah so hopefully you've got a general kind of picture from evan that",
    "start": "847490",
    "end": "852620"
  },
  {
    "text": "this is the complicated system right it's a distributed system a lot of heterogeneous components you have",
    "start": "852620",
    "end": "858019"
  },
  {
    "text": "different nodes nodes have a concept of kind of a blast radius you have heterogeneous workloads running on nodes",
    "start": "858019",
    "end": "863980"
  },
  {
    "text": "and the security properties are kind of subtle right there's certain certain",
    "start": "863980",
    "end": "869209"
  },
  {
    "text": "cases where we expect the system to fail if you compromise the server the server has the signing keys for the trust",
    "start": "869209",
    "end": "875089"
  },
  {
    "text": "domain we expect that to be kind of game over there's other cases where we really wanted to say that attacker really",
    "start": "875089",
    "end": "881779"
  },
  {
    "text": "shouldn't be able to do anything so an attacker that compromises a single workload on a single node should only be",
    "start": "881779",
    "end": "887959"
  },
  {
    "text": "able to get the identities for that workload and then there's a range of cases in between right so to sort of",
    "start": "887959",
    "end": "897260"
  },
  {
    "text": "explore this space we thought about several different dimensions and the first dimension we thought about is what",
    "start": "897260",
    "end": "903260"
  },
  {
    "text": "is the attackers goal what is it they're trying to get out so for example a kind",
    "start": "903260",
    "end": "909319"
  },
  {
    "text": "of like the most basic attack in a system like this is I want to impersonate another workload another",
    "start": "909319",
    "end": "914990"
  },
  {
    "text": "node agent or the server I am NOT that entity but I want to pretend to be that",
    "start": "914990",
    "end": "920060"
  },
  {
    "text": "entity another one is I might want to just shut down part of the system and maybe that would take down your",
    "start": "920060",
    "end": "926600"
  },
  {
    "text": "production website I know they're kind of a little bit more subtle take on that and the",
    "start": "926600",
    "end": "931920"
  },
  {
    "text": "impersonation is I might want to grab some sort of signing key so I can forge identities out of thin air for any name",
    "start": "931920",
    "end": "939120"
  },
  {
    "text": "I want even if it doesn't exist similarly I might want to have a",
    "start": "939120",
    "end": "945960"
  },
  {
    "text": "legitimate identity so let's say I'm a work load I have a legitimate identity I want to modify the permissions",
    "start": "945960",
    "end": "952190"
  },
  {
    "text": "associated with my identity in some part of the system and this comes into play particularly because the spire server is",
    "start": "952190",
    "end": "958980"
  },
  {
    "text": "doing authorization based on spiffy IDs it's using this authorization that authorization logic to decide sort of",
    "start": "958980",
    "end": "965220"
  },
  {
    "text": "which node agents are allowed to issue which identities so there's sort of an opportunity for that to get out of whack",
    "start": "965220",
    "end": "971750"
  },
  {
    "text": "another kind of a little bit more subtle attack might be I want to trick another piece of software into using the wrong",
    "start": "971750",
    "end": "977640"
  },
  {
    "text": "identity so maybe this would mean that I talked to something like a kubernetes api server it's gonna be making a",
    "start": "977640",
    "end": "983850"
  },
  {
    "text": "request on my behalf it's supposed to be making that request with my identity but I can somehow let's say trick it into",
    "start": "983850",
    "end": "989550"
  },
  {
    "text": "using it's very powerful identity instead and that's great sort of a confused deputy kind of attack and then",
    "start": "989550",
    "end": "997410"
  },
  {
    "text": "there's sort of the the biggest one here which is maybe I just want to get remote code execution and some part of the",
    "start": "997410",
    "end": "1002780"
  },
  {
    "text": "system and then that lets me do some other arbitrary set of things that might be might be fun for me as an attacker so",
    "start": "1002780",
    "end": "1011060"
  },
  {
    "text": "that's one dimension that we looked at another dimension we looked at is kind of like where it's the starting state of this whole system we assume that part of",
    "start": "1011060",
    "end": "1017930"
  },
  {
    "text": "the system starts out compromised so it could be the spire server is compromised",
    "start": "1017930",
    "end": "1023870"
  },
  {
    "text": "it turns out you're gonna have a bad day if your spire server is compromised but it could be that one a single node agent",
    "start": "1023870",
    "end": "1030410"
  },
  {
    "text": "is compromised could be that a single workload is compromised and so we wanted to consider all of those cases in our",
    "start": "1030410",
    "end": "1036500"
  },
  {
    "text": "analysis and then the final dimension that we looked at is what kind of",
    "start": "1036500",
    "end": "1041900"
  },
  {
    "text": "superpowers do you have as an attacker so if every piece of software worked perfectly and had no bugs it would be",
    "start": "1041900",
    "end": "1047959"
  },
  {
    "text": "pretty really pretty easy to reason about the security properties of the system but we know in reality that code",
    "start": "1047959",
    "end": "1054290"
  },
  {
    "text": "is broken and it's broken all kinds of weird interesting ways most of which we can't really predict but what we tried",
    "start": "1054290",
    "end": "1060170"
  },
  {
    "text": "to do was come up with some plausible vulnerability and vulnerability classes based on the type of",
    "start": "1060170",
    "end": "1065809"
  },
  {
    "text": "that we use to build spire how much pieces of code are accessible to different attackers and so for example",
    "start": "1065809",
    "end": "1073489"
  },
  {
    "text": "we the spire server is written in go there's a bunch of go code that deals with attacker supply data one of those",
    "start": "1073489",
    "end": "1080599"
  },
  {
    "text": "is the CSR parser CSR is a certificate signing request it's an ASM dot one format it's kind of",
    "start": "1080599",
    "end": "1086539"
  },
  {
    "text": "a tricky binary format you know the it's this parser and go is written in a memory safe language so it's probably",
    "start": "1086539",
    "end": "1093139"
  },
  {
    "text": "not going to have a certain set of buffer overflow vulnerabilities but maybe either something weird we don't",
    "start": "1093139",
    "end": "1098239"
  },
  {
    "text": "understand or maybe there's a bug that combines you know something wrong in the CSR parser with something wrong in the",
    "start": "1098239",
    "end": "1104419"
  },
  {
    "text": "go runtime for example similarly we we have to use the goes",
    "start": "1104419",
    "end": "1110299"
  },
  {
    "text": "x.509 certificate parser we have to we have to run that on bites that are",
    "start": "1110299",
    "end": "1115849"
  },
  {
    "text": "supplied by an attacker before we know who they are so that can be dangerous and then",
    "start": "1115849",
    "end": "1120950"
  },
  {
    "text": "there's a whole set of other kind of pieces of the protocol stack that end up being involved in servicing requests and",
    "start": "1120950",
    "end": "1126619"
  },
  {
    "text": "this is code that sort of handled that's code that is run before the request is authenticated so this is gos TLS stack",
    "start": "1126619",
    "end": "1133309"
  },
  {
    "text": "the HTTP handlers and then the G RPC runtime so real code execution is kind",
    "start": "1133309",
    "end": "1142940"
  },
  {
    "text": "of the the the big one but there's a whole slew of kind of more subtle",
    "start": "1142940",
    "end": "1147950"
  },
  {
    "text": "vulnerabilities that we wanted to consider so for example the isolation between the workload and the node agent",
    "start": "1147950",
    "end": "1155450"
  },
  {
    "text": "the spy agent relies on some sort of sandbox mechanism usually Linux containers it's reasonable to suppose",
    "start": "1155450",
    "end": "1161809"
  },
  {
    "text": "that there could be vulnerable --'tis in that mechanism and we want to know how those would affect the system assuming",
    "start": "1161809",
    "end": "1167059"
  },
  {
    "text": "an attacker has that that superpower we also want to account for cases obviously where an attacker can manipulate network",
    "start": "1167059",
    "end": "1174529"
  },
  {
    "text": "traffic in kind of arbitrary ways we also considered a class of vulnerabilities where you're able to",
    "start": "1174529",
    "end": "1180409"
  },
  {
    "text": "submit some sort of malformed a certificate signing request or a certificate it might not get you remote",
    "start": "1180409",
    "end": "1186799"
  },
  {
    "text": "code execution but it gets you some sort of weird certificate and and we're just kind of supposing that this is a class",
    "start": "1186799",
    "end": "1192919"
  },
  {
    "text": "of vulnerabilities without understanding anything about really what the properties of this might be we're just saying that hey maybe something weird",
    "start": "1192919",
    "end": "1198799"
  },
  {
    "text": "could have in here let's think about what would happen if there was something weird here and then finally kind of a pretty easy",
    "start": "1198799",
    "end": "1205460"
  },
  {
    "text": "attack for anyone this is an attack you can do by accident is overwhelming part of the system with requests we also",
    "start": "1205460",
    "end": "1213919"
  },
  {
    "text": "considered a class of vulnerabilities where we thought we fixed something and we didn't so we have some sort of",
    "start": "1213919",
    "end": "1220309"
  },
  {
    "text": "security control in spire that should have mitigated a particular problem but",
    "start": "1220309",
    "end": "1225380"
  },
  {
    "text": "something was broken with that control so either it could be bypassed or it didn't work in some case so with these",
    "start": "1225380",
    "end": "1233629"
  },
  {
    "text": "three dimensions we became state space explorers we really like wanted to explore every possible combination of",
    "start": "1233629",
    "end": "1239870"
  },
  {
    "text": "these States say you know as an attacker how could I what could I do with this set of superpowers if I start on this",
    "start": "1239870",
    "end": "1245360"
  },
  {
    "text": "node what kind of states kind of the system into and what do we expect aspire to do in that state and why like which",
    "start": "1245360",
    "end": "1252500"
  },
  {
    "text": "security controls inspire are relevant to that case are they adequate are there",
    "start": "1252500",
    "end": "1258259"
  },
  {
    "text": "any kind of weird bypasses we can think of and this is really an exercise than in discussion like we really spend a lot",
    "start": "1258259",
    "end": "1263539"
  },
  {
    "text": "of time just talking about this so it involved a lot of talking and this is where we kind of gonna drop the curtain",
    "start": "1263539",
    "end": "1270110"
  },
  {
    "text": "after level with you you all came to a talk about a spreadsheet he's really",
    "start": "1270110",
    "end": "1275419"
  },
  {
    "text": "talked about collecting a bunch of data building a giant spreadsheet the contents of the spreadsheet represent",
    "start": "1275419",
    "end": "1280820"
  },
  {
    "text": "sort of six months of you know hundreds of hours of discussion from people who",
    "start": "1280820",
    "end": "1286039"
  },
  {
    "text": "were involved in building the system and security experts and just trying to trying to understand all the kind of",
    "start": "1286039",
    "end": "1292370"
  },
  {
    "text": "nuances of how we expect the system to behave and what we hope is that it serves as documentation moving forward",
    "start": "1292370",
    "end": "1297679"
  },
  {
    "text": "and then we also hope that it could sort of highlight interesting places where we might need to do a little more work or",
    "start": "1297679",
    "end": "1303500"
  },
  {
    "text": "we're kind of falling short and so to kind of do that that ranking we did some",
    "start": "1303500",
    "end": "1310820"
  },
  {
    "text": "estimating so one thing we estimated was how severe is an attack on different",
    "start": "1310820",
    "end": "1315980"
  },
  {
    "text": "parts of the system and different types of attacks so we looked at for example the full compromised attack my goal as",
    "start": "1315980",
    "end": "1323029"
  },
  {
    "text": "an attacker is to run code on this component how bad is that if it happens to your server",
    "start": "1323029",
    "end": "1328250"
  },
  {
    "text": "real bad how about is that if that happens to an individual container not nearly so bad right and these are",
    "start": "1328250",
    "end": "1334159"
  },
  {
    "text": "not supposed to be exact numbers this is like like Evan said at the beginning",
    "start": "1334159",
    "end": "1339409"
  },
  {
    "text": "this is not supposed to be a super formalized kind of model of the system",
    "start": "1339409",
    "end": "1345019"
  },
  {
    "text": "it's more like exercising pooling our brains and trying to understand what we",
    "start": "1345019",
    "end": "1350090"
  },
  {
    "text": "collectively can figure out but you can see this is a log scale and so this is kind of what we hope for which is that",
    "start": "1350090",
    "end": "1356119"
  },
  {
    "text": "some types of attacks are orders of magnitude more important than others so",
    "start": "1356119",
    "end": "1363259"
  },
  {
    "text": "we also looked at all of those different superpowers that had talked about those those vulnerability classes and we",
    "start": "1363259",
    "end": "1368269"
  },
  {
    "text": "looked at how likely do we think those are to happen in the future how are likely our way to get new CSR remote",
    "start": "1368269",
    "end": "1375739"
  },
  {
    "text": "code execution vulnerabilities and goes CSR stack compared to how likely is it for example that someone is has a",
    "start": "1375739",
    "end": "1384230"
  },
  {
    "text": "man-in-the-middle capability on a production network and again we were able to see it collectively we more or less agreed on orders of magnitude for",
    "start": "1384230",
    "end": "1391100"
  },
  {
    "text": "how likely different kind of these these classes are and so taking taking those two scores the impact score if I'm like",
    "start": "1391100",
    "end": "1398960"
  },
  {
    "text": "how how bad is it if you hit a certain cell to make this matrix and how likely is it that you're",
    "start": "1398960",
    "end": "1404659"
  },
  {
    "text": "gonna have the set of vulnerabilities you need to to get to that state we were able to do kind of a joint ranking so",
    "start": "1404659",
    "end": "1411289"
  },
  {
    "text": "this is like every cell in this matrix which ones are the worst so if you're over here on the left hand side of this",
    "start": "1411289",
    "end": "1416960"
  },
  {
    "text": "this chart that means the impact is pretty high so this is pretty bad for",
    "start": "1416960",
    "end": "1422299"
  },
  {
    "text": "you if this happens to your production network and the capabilities an attacker needs to to get to that state are we",
    "start": "1422299",
    "end": "1429499"
  },
  {
    "text": "think relatively likely to happen and likewise if you're over on the on the far right hand side of this scale either",
    "start": "1429499",
    "end": "1435889"
  },
  {
    "text": "the attack doesn't really matter that much because it's it's not gonna really impact the operation of the system or",
    "start": "1435889",
    "end": "1441730"
  },
  {
    "text": "requires a vulnerability that we think is gonna be really rare and again this is just based on our kind of collective",
    "start": "1441730",
    "end": "1448789"
  },
  {
    "text": "wild guess so I'm gonna turn things over to Evan to talk now about our findings",
    "start": "1448789",
    "end": "1457269"
  },
  {
    "text": "okay so six months what was it eight months",
    "start": "1457269",
    "end": "1462940"
  },
  {
    "text": "talking something like that what what did what did all that talking and",
    "start": "1462940",
    "end": "1468990"
  },
  {
    "text": "spreadsheet learning give us I think that there are a couple pieces of things",
    "start": "1468990",
    "end": "1474880"
  },
  {
    "text": "that popped up pretty clearly and immediately after analyzing all this data that we compiled the first thing",
    "start": "1474880",
    "end": "1481870"
  },
  {
    "text": "was rate limiting and and this is not like really a surprise that it was required the surprise actually was more",
    "start": "1481870",
    "end": "1489220"
  },
  {
    "text": "kind of in the magnitude of that final score that was computed you know the impact of a do s attack for instance on",
    "start": "1489220",
    "end": "1496480"
  },
  {
    "text": "the spire server multiplied by how easy it is to mount was like oh my god this is clearly like a big problem so you",
    "start": "1496480",
    "end": "1503920"
  },
  {
    "text": "know as soon as we solve those numbers we went ahead and we passed by our server relatively quickly second thing",
    "start": "1503920",
    "end": "1510400"
  },
  {
    "text": "that we found was that CSR person that Matt was talking about you know",
    "start": "1510400",
    "end": "1515470"
  },
  {
    "text": "CSR's is a relatively standard way for fulfilling a request for a new x.509",
    "start": "1515470",
    "end": "1520840"
  },
  {
    "text": "certificate so when we were designing spire originally we didn't really put much thought into it so that all the",
    "start": "1520840",
    "end": "1526030"
  },
  {
    "text": "agent needs a cert so you know we're gonna use a CSR for that but after some",
    "start": "1526030",
    "end": "1531430"
  },
  {
    "text": "discussion we kind of realized that the CSR processing code is a source of vulnerability vulnerability particularly",
    "start": "1531430",
    "end": "1538030"
  },
  {
    "text": "on that you know the libraries to prostitue parsing process these CSRs are not anywhere close to as well exercised",
    "start": "1538030",
    "end": "1544690"
  },
  {
    "text": "as the x.509 libraries are for instance undergoing we further realize that the",
    "start": "1544690",
    "end": "1550990"
  },
  {
    "text": "semantics of the CSR gives aren't really required for spire security or functionality at all so as a result even",
    "start": "1550990",
    "end": "1558880"
  },
  {
    "text": "though the CSR related vulnerabilities were not not necessarily the very very top of the list they they weren't even",
    "start": "1558880",
    "end": "1565750"
  },
  {
    "text": "significant and reflecting on this and realizing that we don't actually need this thing we're under discussion right",
    "start": "1565750",
    "end": "1572650"
  },
  {
    "text": "now to remove CSR processing altogether from the spire architecture but overall",
    "start": "1572650",
    "end": "1578860"
  },
  {
    "text": "I think there weren't any like giant surprises here we definitely identified a few things that we can improve but we",
    "start": "1578860",
    "end": "1586300"
  },
  {
    "text": "generally achieved the security properties that we were aiming to achieve with this architecture of course that's",
    "start": "1586300",
    "end": "1592820"
  },
  {
    "text": "not to say that there aren't any problems you know there there certainly we might have overlooked things but certainly this kind of first path is",
    "start": "1592820",
    "end": "1599950"
  },
  {
    "text": "first passes a very reassuring one took",
    "start": "1599950",
    "end": "1604970"
  },
  {
    "text": "a long time to do this as you know we mentioned once or twice but now that we have these tools we have these matrices",
    "start": "1604970",
    "end": "1611240"
  },
  {
    "text": "we have this scores we have we understand like how to approach this problem it's really easy to kind of keep",
    "start": "1611240",
    "end": "1616640"
  },
  {
    "text": "this up so as the project evolves over time these spreadsheets can be updated and the scores can be updated and",
    "start": "1616640",
    "end": "1622850"
  },
  {
    "text": "maintained and which will allow us to like measurably track the security posture the spiffy inspired projects",
    "start": "1622850",
    "end": "1629180"
  },
  {
    "text": "over time which i think is ultra ultra cool and if so he aspire is important to",
    "start": "1629180",
    "end": "1635600"
  },
  {
    "text": "you then certainly this data I think would also be of interest and important to you and and hopefully can help you to",
    "start": "1635600",
    "end": "1642050"
  },
  {
    "text": "guide decisions that you make in your deployment and implementation of spiffy or aspire systems I know that we have",
    "start": "1642050",
    "end": "1648680"
  },
  {
    "text": "certainly found it very helpful to have around we're also looking for more volunteers or there was just four of us",
    "start": "1648680",
    "end": "1655460"
  },
  {
    "text": "that worked on this thing and it was a ton of work and you know part of the scoring exercise and everything requires",
    "start": "1655460",
    "end": "1661760"
  },
  {
    "text": "different perspectives to be involved in different opinions to be ejected so if you guys are interested in helping out",
    "start": "1661760",
    "end": "1668390"
  },
  {
    "text": "on this front we would love to have you have some more eyes on this assessment and poke holes or wherever you possibly",
    "start": "1668390",
    "end": "1674960"
  },
  {
    "text": "can and if you're interested in helping out either in this security assessment or or anything else if you just even",
    "start": "1674960",
    "end": "1681620"
  },
  {
    "text": "looking for more information please do join the slack organist if you stock organization any and all questions are",
    "start": "1681620",
    "end": "1688340"
  },
  {
    "text": "welcome about this or anything else really we'd love to see you there you",
    "start": "1688340",
    "end": "1694370"
  },
  {
    "text": "can also find a lot of information on our github repos the the spire repo here",
    "start": "1694370",
    "end": "1699500"
  },
  {
    "text": "in the middle is the one with the spire code base and then the bottom one here spiffy spiffy is the one that has all",
    "start": "1699500",
    "end": "1705110"
  },
  {
    "text": "the spiffy specifications as well as information about the community regular",
    "start": "1705110",
    "end": "1710360"
  },
  {
    "text": "calls things along those lines that's all we've got for you today thank you",
    "start": "1710360",
    "end": "1716540"
  },
  {
    "text": "for coming hope you're enjoying pube con and we have some time for questions maybe",
    "start": "1716540",
    "end": "1722280"
  },
  {
    "text": "[Applause]",
    "start": "1722280",
    "end": "1730500"
  },
  {
    "text": "so they should let justice so the question is we decided not to use formal methods but sort of how would you",
    "start": "1746860",
    "end": "1752860"
  },
  {
    "text": "approach applying formal methods to to the system yeah yes how could you raise",
    "start": "1752860",
    "end": "1762669"
  },
  {
    "text": "your confidence higher about this work all right so the general technique that we used in this the way we did things",
    "start": "1762669",
    "end": "1769120"
  },
  {
    "text": "with threat models and other types of refinement of threat categories is a",
    "start": "1769120",
    "end": "1775929"
  },
  {
    "text": "technique that we invented called ABC that we've used in a couple of other ways and I'm very happy to provide more",
    "start": "1775929",
    "end": "1783190"
  },
  {
    "text": "information about this where you have a publication coming out about it and would be happy to talk more about it so",
    "start": "1783190",
    "end": "1788710"
  },
  {
    "text": "please reach out to to me or to anybody on the team here and they'll get you in touch with me about it a big part of",
    "start": "1788710",
    "end": "1795130"
  },
  {
    "text": "this project who was you know a lot of this knowledge existed like in Evans head and some of the people who had",
    "start": "1795130",
    "end": "1801309"
  },
  {
    "text": "worked really deeply in the code we really wanted to get it out out of Evans head into a spreadsheet so that we can",
    "start": "1801309",
    "end": "1807399"
  },
  {
    "text": "bring more people onto the project to my own people who might bring a different skill set with formal methods or other ways of thinking about the problem",
    "start": "1807399",
    "end": "1815220"
  },
  {
    "text": "yeah I would say the specific spreadsheet is very specific to to spire because the the kind of the what I",
    "start": "1827230",
    "end": "1834909"
  },
  {
    "text": "called attacker superpowers that kind of vulnerability classes were really things that specifically applied to spire and",
    "start": "1834909",
    "end": "1840159"
  },
  {
    "text": "the specific code that makes up spire the methodology in general is generally applicable and you can look up some of",
    "start": "1840159",
    "end": "1846880"
  },
  {
    "text": "Justin's papers on other systems yeah you may be able to draw some commonality",
    "start": "1846880",
    "end": "1851919"
  },
  {
    "text": "with like you know attacker starting position different components classes of vulnerabilities I'm like okay like how",
    "start": "1851919",
    "end": "1858370"
  },
  {
    "text": "do you score them which components get scored and how did this course come together all that stuff might be applied generally rather than specific to aspire",
    "start": "1858370",
    "end": "1865299"
  },
  {
    "text": "but the values of those things are pretty spire specific and I know that Justin has been working with CNC F on on",
    "start": "1865299",
    "end": "1870909"
  },
  {
    "text": "trying to kind of come up with a generalized model for this that is a little bit more lightweight than what we",
    "start": "1870909",
    "end": "1877210"
  },
  {
    "text": "did here was spiffy inspire that can be applied to CS we have projects that are coming on board I think it's also good",
    "start": "1877210",
    "end": "1884230"
  },
  {
    "text": "know we could really hit a lot of nuances and actually changed our methodology throughout this project so like something we kind of discovered",
    "start": "1884230",
    "end": "1890399"
  },
  {
    "text": "about a third of the way through was that the way we were thinking about attacker starting positions and and",
    "start": "1890399",
    "end": "1895539"
  },
  {
    "text": "desired attacker States wasn't quite nuanced enough so there's there's this idea and we simplified it a little bit",
    "start": "1895539",
    "end": "1901990"
  },
  {
    "text": "for the slides but the difference between having compromised at workload and attacking a workload on the same",
    "start": "1901990",
    "end": "1907779"
  },
  {
    "text": "node versus attacking a workload on another node and we expect in general that nodes can be sort of isolated into",
    "start": "1907779",
    "end": "1915490"
  },
  {
    "text": "these like sort of blast zones and so it's not as big a deal it should not be as big a deal to compromise another",
    "start": "1915490",
    "end": "1921100"
  },
  {
    "text": "workload in your same zone as it is to compromise something in another zone that's that's a case where like we spent",
    "start": "1921100",
    "end": "1927130"
  },
  {
    "text": "three months talking about this and then realize like oh yeah we actually need like more dimensions in this problem and",
    "start": "1927130",
    "end": "1932980"
  },
  {
    "text": "so that's the case where the matrix ended up pretty specifically applied to just fire in the back here",
    "start": "1932980",
    "end": "1942268"
  },
  {
    "text": "so the question is are there any special considerations for bootstrapping the spire agent is a clearly introduced it",
    "start": "1948530",
    "end": "1954120"
  },
  {
    "text": "to the spire server absolutely I left it out of this talk because I didn't think",
    "start": "1954120",
    "end": "1959309"
  },
  {
    "text": "that it was very important for for the scope of the review that we were doing but the same kind of way that I talked",
    "start": "1959309",
    "end": "1966809"
  },
  {
    "text": "about row code at the station there's also a concept of no data station which leverages platform providers and other",
    "start": "1966809",
    "end": "1972210"
  },
  {
    "text": "things like this in order to validate the identity of the caller when it's not or a local process for example if you",
    "start": "1972210",
    "end": "1978990"
  },
  {
    "text": "are if your note is an ec2 instance it might use the ec2 metadata API to prove",
    "start": "1978990",
    "end": "1984990"
  },
  {
    "text": "this identity to the spire server and we can think similarly like other cloud providers or you might have an",
    "start": "1984990",
    "end": "1990540"
  },
  {
    "text": "on-premises environment where you attest the state of the machine using a TPM things like that like the spire itself",
    "start": "1990540",
    "end": "1996929"
  },
  {
    "text": "is pluggable enough to kind of support all kinds of different mechanisms in different environments",
    "start": "1996929",
    "end": "2002260"
  },
  {
    "text": "no it said the question was we were saying that the CSR is a potential",
    "start": "2021310",
    "end": "2026810"
  },
  {
    "text": "source of vulnerability and that maybe we could remove it and does that mean that we're looking to move away from x.509 entirely and preferred jot instead",
    "start": "2026810",
    "end": "2035590"
  },
  {
    "text": "the answer I think there is definitely no but what we found was that the spot",
    "start": "2035590",
    "end": "2040610"
  },
  {
    "text": "the spire server knows what identity is supposed to be issued and the format of",
    "start": "2040610",
    "end": "2046220"
  },
  {
    "text": "that certificate and if it's authorized or not what we really wanted to prevent was like carte blanche like number one",
    "start": "2046220",
    "end": "2053240"
  },
  {
    "text": "like copy and pasting a CSR into the cert and I'm signing it sending it back like you could put all kinds of subject",
    "start": "2053240",
    "end": "2058940"
  },
  {
    "text": "values and other things in there that the server has no way of validating furthermore you know exercising all that",
    "start": "2058940",
    "end": "2064310"
  },
  {
    "text": "parsing logic as I mentioned before is a risk and so at the end of the day really all the spire server needs to know is",
    "start": "2064310",
    "end": "2070370"
  },
  {
    "text": "the public key public key and and it can create a cert with the race 50 ID with",
    "start": "2070370",
    "end": "2075500"
  },
  {
    "text": "the public key and assign it to send it back and we can kind of sidestep this whole CSR back and forth so definitely exile online I think is",
    "start": "2075500",
    "end": "2082460"
  },
  {
    "text": "still kind of like the main US Fed format and the one that we would recommend above all else when it's",
    "start": "2082460",
    "end": "2088520"
  },
  {
    "text": "possible to use it but we just the the guarantees and properties that the",
    "start": "2088520",
    "end": "2095270"
  },
  {
    "text": "commonly used CSR process follows doesn't really buy us much and so we might as well cut it out",
    "start": "2095270",
    "end": "2101950"
  },
  {
    "text": "all right thanks we'll be in the back for more questions yeah thank you everyone",
    "start": "2105870",
    "end": "2111050"
  }
]