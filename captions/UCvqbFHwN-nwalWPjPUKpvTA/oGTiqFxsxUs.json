[
  {
    "start": "0",
    "end": "22000"
  },
  {
    "text": "hi everyone thanks for coming to our",
    "start": "0",
    "end": "1599"
  },
  {
    "text": "talk today so we'll be talking about the",
    "start": "1599",
    "end": "3439"
  },
  {
    "text": "trials and success of adopting envoy",
    "start": "3439",
    "end": "5600"
  },
  {
    "text": "tinder",
    "start": "5600",
    "end": "6960"
  },
  {
    "text": "so i'm yuki i'm engineering manager at",
    "start": "6960",
    "end": "8720"
  },
  {
    "text": "tinder i'm part of the service mesh",
    "start": "8720",
    "end": "10639"
  },
  {
    "text": "migration team and this is cooper hi so",
    "start": "10639",
    "end": "13280"
  },
  {
    "text": "i'm cooper and i'm a senior site",
    "start": "13280",
    "end": "14719"
  },
  {
    "text": "reliability engineer tinder",
    "start": "14719",
    "end": "16560"
  },
  {
    "text": "and uh we've been working together for",
    "start": "16560",
    "end": "17920"
  },
  {
    "text": "around three years",
    "start": "17920",
    "end": "20720"
  },
  {
    "start": "22000",
    "end": "22000"
  },
  {
    "text": "yeah",
    "start": "22000",
    "end": "23119"
  },
  {
    "text": "um so yeah this is just kind of the",
    "start": "23119",
    "end": "24880"
  },
  {
    "text": "overview what we're going to talk about",
    "start": "24880",
    "end": "26000"
  },
  {
    "text": "today just get started talking about why",
    "start": "26000",
    "end": "28320"
  },
  {
    "text": "envoy some of the migration hurdles or",
    "start": "28320",
    "end": "30480"
  },
  {
    "text": "some of the human costs with the",
    "start": "30480",
    "end": "31679"
  },
  {
    "text": "migration cooper's got some nice before",
    "start": "31679",
    "end": "34160"
  },
  {
    "text": "and after mesh charts for you so some",
    "start": "34160",
    "end": "36000"
  },
  {
    "text": "you know grafana metrics of what our",
    "start": "36000",
    "end": "38480"
  },
  {
    "text": "services look like after the mesh",
    "start": "38480",
    "end": "39920"
  },
  {
    "text": "migration we'll talk about how we did",
    "start": "39920",
    "end": "42079"
  },
  {
    "text": "some of the network tuning like you know",
    "start": "42079",
    "end": "44000"
  },
  {
    "text": "nitty gritty retries and timeout tuning",
    "start": "44000",
    "end": "46640"
  },
  {
    "text": "some of the observability so how we you",
    "start": "46640",
    "end": "48800"
  },
  {
    "text": "know incorporated uh envoy into",
    "start": "48800",
    "end": "51039"
  },
  {
    "text": "prometheus stack some of the the war",
    "start": "51039",
    "end": "53039"
  },
  {
    "text": "stories so you know things we figured",
    "start": "53039",
    "end": "55039"
  },
  {
    "text": "out only after working with envoy for a",
    "start": "55039",
    "end": "57680"
  },
  {
    "text": "pretty long time",
    "start": "57680",
    "end": "59199"
  },
  {
    "text": "we'll talk about how we do our envoy",
    "start": "59199",
    "end": "60800"
  },
  {
    "text": "configuration um a bit about our control",
    "start": "60800",
    "end": "63520"
  },
  {
    "text": "plane and then lastly just talk about",
    "start": "63520",
    "end": "65198"
  },
  {
    "text": "the future work",
    "start": "65199",
    "end": "67600"
  },
  {
    "text": "so you know today we're fully on envoy",
    "start": "67600",
    "end": "69520"
  },
  {
    "text": "and kubernetes",
    "start": "69520",
    "end": "71200"
  },
  {
    "text": "took about like one year for the full",
    "start": "71200",
    "end": "72640"
  },
  {
    "text": "migration started around early 2019",
    "start": "72640",
    "end": "75759"
  },
  {
    "text": "ended early 2020 and right now we have",
    "start": "75759",
    "end": "78640"
  },
  {
    "text": "1.6 million rps meshed",
    "start": "78640",
    "end": "81280"
  },
  {
    "text": "in our infrastructure so that's like",
    "start": "81280",
    "end": "83040"
  },
  {
    "text": "internal and external requests",
    "start": "83040",
    "end": "85200"
  },
  {
    "text": "over 200 000 containers",
    "start": "85200",
    "end": "87520"
  },
  {
    "text": "20 000 pods and 500 services",
    "start": "87520",
    "end": "91280"
  },
  {
    "text": "um and this is just kind of an overview",
    "start": "91280",
    "end": "93119"
  },
  {
    "text": "of how the you know the infra is laid",
    "start": "93119",
    "end": "94880"
  },
  {
    "text": "out",
    "start": "94880",
    "end": "95840"
  },
  {
    "text": "so you have you know the user on one end",
    "start": "95840",
    "end": "97840"
  },
  {
    "text": "using the tinder app and then requests",
    "start": "97840",
    "end": "100079"
  },
  {
    "text": "from the tinder app go to one of three",
    "start": "100079",
    "end": "103280"
  },
  {
    "text": "kubernetes clusters and each cluster is",
    "start": "103280",
    "end": "105680"
  },
  {
    "text": "shorted to an az so you know",
    "start": "105680",
    "end": "108560"
  },
  {
    "text": "you know the cluster at the top cluster",
    "start": "108560",
    "end": "110320"
  },
  {
    "text": "a is entirely in the 1a available",
    "start": "110320",
    "end": "113360"
  },
  {
    "text": "availability zone in aws so it's wholly",
    "start": "113360",
    "end": "115920"
  },
  {
    "text": "self-contained and all the requests get",
    "start": "115920",
    "end": "118159"
  },
  {
    "text": "processed within that cluster so you",
    "start": "118159",
    "end": "120159"
  },
  {
    "text": "know that gives us a lot of savings in",
    "start": "120159",
    "end": "122159"
  },
  {
    "text": "terms of cross az costs as well as",
    "start": "122159",
    "end": "124320"
  },
  {
    "text": "latency",
    "start": "124320",
    "end": "125680"
  },
  {
    "text": "and as you can see you know what you've",
    "start": "125680",
    "end": "126960"
  },
  {
    "text": "amplified pretty much every part of our",
    "start": "126960",
    "end": "129280"
  },
  {
    "text": "stack",
    "start": "129280",
    "end": "130720"
  },
  {
    "text": "at the ingress layer we're using envoy",
    "start": "130720",
    "end": "133040"
  },
  {
    "text": "within the kubernetes cluster we're",
    "start": "133040",
    "end": "134720"
  },
  {
    "text": "using envoy as a sidecar in all the pods",
    "start": "134720",
    "end": "138160"
  },
  {
    "text": "and you know we have we have like some",
    "start": "138160",
    "end": "139280"
  },
  {
    "text": "elbs albs engine x laying around but the",
    "start": "139280",
    "end": "141680"
  },
  {
    "text": "core network logic is implemented within",
    "start": "141680",
    "end": "143920"
  },
  {
    "text": "envoy",
    "start": "143920",
    "end": "146319"
  },
  {
    "start": "146000",
    "end": "146000"
  },
  {
    "text": "so you know why envoy it's got a lot of",
    "start": "146319",
    "end": "148400"
  },
  {
    "text": "great features",
    "start": "148400",
    "end": "150239"
  },
  {
    "text": "so we didn't you know use all these",
    "start": "150239",
    "end": "152000"
  },
  {
    "text": "features",
    "start": "152000",
    "end": "153280"
  },
  {
    "text": "right in the beginning but we we do",
    "start": "153280",
    "end": "155040"
  },
  {
    "text": "today use i think almost all these you",
    "start": "155040",
    "end": "157440"
  },
  {
    "text": "know multiple algorithms for load",
    "start": "157440",
    "end": "158800"
  },
  {
    "text": "balancing we try circuit breakers",
    "start": "158800",
    "end": "160800"
  },
  {
    "text": "timeouts various database filters which",
    "start": "160800",
    "end": "163440"
  },
  {
    "text": "we use for observability",
    "start": "163440",
    "end": "165680"
  },
  {
    "text": "it gives us you know metrics for free",
    "start": "165680",
    "end": "167840"
  },
  {
    "text": "and then some tracing",
    "start": "167840",
    "end": "169599"
  },
  {
    "text": "so cooper's just now going to talk about",
    "start": "169599",
    "end": "171519"
  },
  {
    "start": "170000",
    "end": "170000"
  },
  {
    "text": "where we came from",
    "start": "171519",
    "end": "173360"
  },
  {
    "text": "yeah so before envoy we use really",
    "start": "173360",
    "end": "176000"
  },
  {
    "text": "conventional kubernetes networking so we",
    "start": "176000",
    "end": "177760"
  },
  {
    "text": "did flannel for our potter pod network",
    "start": "177760",
    "end": "180400"
  },
  {
    "text": "and we used uh regular kubernetes",
    "start": "180400",
    "end": "182239"
  },
  {
    "text": "services",
    "start": "182239",
    "end": "183280"
  },
  {
    "text": "you know cluster ip node port with a",
    "start": "183280",
    "end": "184800"
  },
  {
    "text": "couple of headless around",
    "start": "184800",
    "end": "186720"
  },
  {
    "text": "very few elbs but just mostly a standard",
    "start": "186720",
    "end": "189040"
  },
  {
    "text": "cluster rp",
    "start": "189040",
    "end": "190480"
  },
  {
    "text": "this worked really well out of the box",
    "start": "190480",
    "end": "192000"
  },
  {
    "text": "and helped us scale but we really ran",
    "start": "192000",
    "end": "193680"
  },
  {
    "text": "into performance issues so our clusters",
    "start": "193680",
    "end": "195760"
  },
  {
    "text": "were pretty large at the time",
    "start": "195760",
    "end": "197519"
  },
  {
    "text": "around like 4000 nodes per cluster and",
    "start": "197519",
    "end": "199599"
  },
  {
    "text": "flannel started using really really high",
    "start": "199599",
    "end": "201280"
  },
  {
    "text": "cpu usage we also saw stale tcp",
    "start": "201280",
    "end": "204319"
  },
  {
    "text": "connection tunnels with ipvs and we also",
    "start": "204319",
    "end": "206879"
  },
  {
    "text": "had hanging connections which caused",
    "start": "206879",
    "end": "208480"
  },
  {
    "text": "undue load",
    "start": "208480",
    "end": "210159"
  },
  {
    "text": "we ended up with a lot of",
    "start": "210159",
    "end": "212480"
  },
  {
    "text": "uneven load on target pods and target",
    "start": "212480",
    "end": "214400"
  },
  {
    "text": "services which really",
    "start": "214400",
    "end": "216720"
  },
  {
    "text": "really pushed us to go to envoy",
    "start": "216720",
    "end": "219680"
  },
  {
    "text": "next",
    "start": "219680",
    "end": "221040"
  },
  {
    "start": "221000",
    "end": "221000"
  },
  {
    "text": "so we started migration envoy in 2019 so",
    "start": "221040",
    "end": "223920"
  },
  {
    "text": "we had a lot of services still in the",
    "start": "223920",
    "end": "225519"
  },
  {
    "text": "backup you know services clutch rp and",
    "start": "225519",
    "end": "227599"
  },
  {
    "text": "we had all new ones using mesh and so we",
    "start": "227599",
    "end": "229760"
  },
  {
    "text": "ran a hybrid model for quite a while",
    "start": "229760",
    "end": "232720"
  },
  {
    "text": "uh this worked relatively well there are",
    "start": "232720",
    "end": "234480"
  },
  {
    "text": "some teething issues with that which we",
    "start": "234480",
    "end": "235840"
  },
  {
    "text": "can get into later",
    "start": "235840",
    "end": "237200"
  },
  {
    "text": "but once we started going on envoy there",
    "start": "237200",
    "end": "239360"
  },
  {
    "text": "was no turning back it was so much",
    "start": "239360",
    "end": "241040"
  },
  {
    "text": "better our observability increased",
    "start": "241040",
    "end": "242799"
  },
  {
    "text": "massively our traffic the pods was",
    "start": "242799",
    "end": "244799"
  },
  {
    "text": "significantly better we had much easier",
    "start": "244799",
    "end": "247200"
  },
  {
    "text": "sinking of like load balancing types of",
    "start": "247200",
    "end": "249200"
  },
  {
    "text": "you know rod robin maglev etc",
    "start": "249200",
    "end": "251760"
  },
  {
    "text": "and even latency just magically got",
    "start": "251760",
    "end": "253360"
  },
  {
    "text": "better",
    "start": "253360",
    "end": "255840"
  },
  {
    "start": "256000",
    "end": "256000"
  },
  {
    "text": "yeah so some of the migration hurdles we",
    "start": "258560",
    "end": "260479"
  },
  {
    "text": "went through right so we started really",
    "start": "260479",
    "end": "262000"
  },
  {
    "text": "with zero envoy knowledge across the",
    "start": "262000",
    "end": "263759"
  },
  {
    "text": "entire org you know you know we just",
    "start": "263759",
    "end": "265600"
  },
  {
    "text": "knew kind of what was out there in the",
    "start": "265600",
    "end": "267199"
  },
  {
    "text": "docs and the blogs you know which is",
    "start": "267199",
    "end": "269040"
  },
  {
    "text": "kind of sparse because it's new",
    "start": "269040",
    "end": "270160"
  },
  {
    "text": "technology right but we did eventually",
    "start": "270160",
    "end": "272720"
  },
  {
    "text": "you know end up learning it pretty well",
    "start": "272720",
    "end": "274400"
  },
  {
    "text": "over the last two years",
    "start": "274400",
    "end": "276160"
  },
  {
    "text": "um and we migrated over 300 services",
    "start": "276160",
    "end": "279040"
  },
  {
    "text": "over a year just started with like one",
    "start": "279040",
    "end": "281120"
  },
  {
    "text": "person working on it but had like six to",
    "start": "281120",
    "end": "282800"
  },
  {
    "text": "ten people working on it by the end",
    "start": "282800",
    "end": "284639"
  },
  {
    "text": "full-time was definitely a team effort",
    "start": "284639",
    "end": "287040"
  },
  {
    "text": "um you know there's multiple people",
    "start": "287040",
    "end": "289120"
  },
  {
    "text": "involved uh people working on",
    "start": "289120",
    "end": "290960"
  },
  {
    "text": "integrating it into kubernetes",
    "start": "290960",
    "end": "292960"
  },
  {
    "text": "uh there's a team working on the",
    "start": "292960",
    "end": "294320"
  },
  {
    "text": "observability the prometheus stack",
    "start": "294320",
    "end": "296720"
  },
  {
    "text": "a team working on the you know",
    "start": "296720",
    "end": "298720"
  },
  {
    "text": "configuration automation integrating it",
    "start": "298720",
    "end": "300720"
  },
  {
    "text": "into the ci cd stack",
    "start": "300720",
    "end": "302560"
  },
  {
    "text": "migration of the services itself",
    "start": "302560",
    "end": "305280"
  },
  {
    "text": "you know people working on the control",
    "start": "305280",
    "end": "307199"
  },
  {
    "text": "plane and then you know people working",
    "start": "307199",
    "end": "309360"
  },
  {
    "text": "on the network tuning right",
    "start": "309360",
    "end": "311520"
  },
  {
    "text": "and of course the service owners were",
    "start": "311520",
    "end": "313120"
  },
  {
    "text": "you know initially hesitant with the",
    "start": "313120",
    "end": "314320"
  },
  {
    "text": "migration uh definitely a time sink but",
    "start": "314320",
    "end": "317360"
  },
  {
    "text": "as people saw the benefit right they",
    "start": "317360",
    "end": "318880"
  },
  {
    "text": "just started to volunteer because it was",
    "start": "318880",
    "end": "320479"
  },
  {
    "text": "such a",
    "start": "320479",
    "end": "321600"
  },
  {
    "text": "you know so many things you got for free",
    "start": "321600",
    "end": "324479"
  },
  {
    "text": "and then uh you know the process just",
    "start": "324479",
    "end": "326639"
  },
  {
    "text": "became really streamlined pretty low",
    "start": "326639",
    "end": "328080"
  },
  {
    "text": "effort didn't require someone with high",
    "start": "328080",
    "end": "329520"
  },
  {
    "text": "envelope expertise to the babysit and",
    "start": "329520",
    "end": "331840"
  },
  {
    "text": "all their services today are by default",
    "start": "331840",
    "end": "334240"
  },
  {
    "text": "have service mesh enabled unless there's",
    "start": "334240",
    "end": "337120"
  },
  {
    "text": "a very good reason i don't think we have",
    "start": "337120",
    "end": "339039"
  },
  {
    "text": "a single one that doesn't have",
    "start": "339039",
    "end": "340960"
  },
  {
    "text": "mesh disabled now",
    "start": "340960",
    "end": "343120"
  },
  {
    "text": "um and then of course critical high",
    "start": "343120",
    "end": "344880"
  },
  {
    "text": "traffic services were pretty hard to",
    "start": "344880",
    "end": "346479"
  },
  {
    "text": "migrate uh i think we you know we spent",
    "start": "346479",
    "end": "348720"
  },
  {
    "text": "like a couple weeks just tuning timeouts",
    "start": "348720",
    "end": "350560"
  },
  {
    "text": "and retries for certain services",
    "start": "350560",
    "end": "352639"
  },
  {
    "text": "so there's a lot of babysitting on those",
    "start": "352639",
    "end": "354720"
  },
  {
    "text": "like high rps ones",
    "start": "354720",
    "end": "357120"
  },
  {
    "text": "and then currently we have 500",
    "start": "357120",
    "end": "358479"
  },
  {
    "text": "microservices",
    "start": "358479",
    "end": "359840"
  },
  {
    "text": "in the mesh 20 000 pods migrated and",
    "start": "359840",
    "end": "362319"
  },
  {
    "text": "every request at tinder now goes through",
    "start": "362319",
    "end": "364160"
  },
  {
    "text": "a service mesh",
    "start": "364160",
    "end": "367560"
  },
  {
    "start": "366000",
    "end": "366000"
  },
  {
    "text": "all right let's talk uh some nice little",
    "start": "367600",
    "end": "369360"
  },
  {
    "text": "graphs here okay so before and after",
    "start": "369360",
    "end": "371600"
  },
  {
    "text": "mesh these are some old grass i pulled",
    "start": "371600",
    "end": "373759"
  },
  {
    "text": "from 2019 so bear with me if some aren't",
    "start": "373759",
    "end": "376639"
  },
  {
    "text": "perfectly clear they're kind of old so",
    "start": "376639",
    "end": "378800"
  },
  {
    "text": "our latency was so much better after the",
    "start": "378800",
    "end": "380720"
  },
  {
    "text": "cutover i added a nice little green line",
    "start": "380720",
    "end": "383199"
  },
  {
    "text": "so you can tell boring before and after",
    "start": "383199",
    "end": "384880"
  },
  {
    "text": "if you can't see that closely but you",
    "start": "384880",
    "end": "386560"
  },
  {
    "text": "can see that like our p99 latency",
    "start": "386560",
    "end": "388639"
  },
  {
    "text": "massively took a downturn afterwards",
    "start": "388639",
    "end": "391360"
  },
  {
    "text": "much of this originally was just due to",
    "start": "391360",
    "end": "392960"
  },
  {
    "text": "better pod distribution",
    "start": "392960",
    "end": "394479"
  },
  {
    "text": "so before as i said with ipvs and",
    "start": "394479",
    "end": "396080"
  },
  {
    "text": "flannel we would have one pod be super",
    "start": "396080",
    "end": "397840"
  },
  {
    "text": "hot and super skewing the p99 up but",
    "start": "397840",
    "end": "400400"
  },
  {
    "text": "after envoy really brought the low",
    "start": "400400",
    "end": "402160"
  },
  {
    "text": "distribution uh to be way more even",
    "start": "402160",
    "end": "405840"
  },
  {
    "text": "cpu usage again uh following up the last",
    "start": "405840",
    "end": "408880"
  },
  {
    "text": "thing about load distribution became",
    "start": "408880",
    "end": "410240"
  },
  {
    "text": "significantly better uh for the cold",
    "start": "410240",
    "end": "412639"
  },
  {
    "text": "service this was only after we were",
    "start": "412639",
    "end": "414560"
  },
  {
    "text": "partially meshed so i would say about",
    "start": "414560",
    "end": "416319"
  },
  {
    "text": "this point uh we're about fifty percent",
    "start": "416319",
    "end": "418240"
  },
  {
    "text": "of the callers were meshed and you can",
    "start": "418240",
    "end": "420080"
  },
  {
    "text": "see the per pod cpu distribution become",
    "start": "420080",
    "end": "422639"
  },
  {
    "text": "much tighter and uh much more coherent",
    "start": "422639",
    "end": "425360"
  },
  {
    "text": "as the time went on especially after",
    "start": "425360",
    "end": "426880"
  },
  {
    "text": "that first major cut which i think was",
    "start": "426880",
    "end": "428560"
  },
  {
    "text": "around 30 percent of its calls",
    "start": "428560",
    "end": "432160"
  },
  {
    "start": "432000",
    "end": "432000"
  },
  {
    "text": "so how did we get there and what do we",
    "start": "432880",
    "end": "434880"
  },
  {
    "text": "do to get better so we did uh in",
    "start": "434880",
    "end": "437440"
  },
  {
    "text": "addition to just envoy we started adding",
    "start": "437440",
    "end": "439280"
  },
  {
    "text": "timeouts and retries so we didn't not",
    "start": "439280",
    "end": "442160"
  },
  {
    "text": "have this before but it wasn't very",
    "start": "442160",
    "end": "443919"
  },
  {
    "text": "consistent so we had modules in our",
    "start": "443919",
    "end": "445840"
  },
  {
    "text": "kubernetes cluster whose own code",
    "start": "445840",
    "end": "447840"
  },
  {
    "text": "handled retries",
    "start": "447840",
    "end": "449759"
  },
  {
    "text": "and timeouts per application",
    "start": "449759",
    "end": "452960"
  },
  {
    "text": "we had to remove that because you cannot",
    "start": "452960",
    "end": "454880"
  },
  {
    "text": "have per application retries and",
    "start": "454880",
    "end": "456639"
  },
  {
    "text": "timeouts as well as envoy you get a huge",
    "start": "456639",
    "end": "460160"
  },
  {
    "text": "uncontrollable",
    "start": "460160",
    "end": "461599"
  },
  {
    "text": "potentially bad situation if you do that",
    "start": "461599",
    "end": "463919"
  },
  {
    "text": "if you have improper timeouts you may be",
    "start": "463919",
    "end": "465759"
  },
  {
    "text": "either pre-maturing cancellation calls",
    "start": "465759",
    "end": "467680"
  },
  {
    "text": "or even potentially worse you're doing",
    "start": "467680",
    "end": "469840"
  },
  {
    "text": "like a retry storm or one retry can cost",
    "start": "469840",
    "end": "472240"
  },
  {
    "text": "two more tries and so on and so forth so",
    "start": "472240",
    "end": "474560"
  },
  {
    "text": "we had to do a coordinated effort",
    "start": "474560",
    "end": "475919"
  },
  {
    "text": "between back end code and operations to",
    "start": "475919",
    "end": "478160"
  },
  {
    "text": "clean up timeouts and make sure we",
    "start": "478160",
    "end": "479440"
  },
  {
    "text": "disabled retries",
    "start": "479440",
    "end": "481120"
  },
  {
    "text": "uh due to some even legacy code some",
    "start": "481120",
    "end": "483599"
  },
  {
    "text": "code owners didn't even know they had it",
    "start": "483599",
    "end": "485280"
  },
  {
    "text": "so it really was a",
    "start": "485280",
    "end": "487360"
  },
  {
    "text": "you know drill down through a whole",
    "start": "487360",
    "end": "488560"
  },
  {
    "text": "bunch of code to figure out what exactly",
    "start": "488560",
    "end": "490240"
  },
  {
    "text": "was there and what needed to be disabled",
    "start": "490240",
    "end": "492720"
  },
  {
    "text": "but once we fully got everyone off of",
    "start": "492720",
    "end": "494240"
  },
  {
    "text": "that moving to envoy uh",
    "start": "494240",
    "end": "496400"
  },
  {
    "text": "timeouts and retries was cynically",
    "start": "496400",
    "end": "498000"
  },
  {
    "text": "better it was easy centralized place we",
    "start": "498000",
    "end": "500160"
  },
  {
    "text": "could tweak it significantly better than",
    "start": "500160",
    "end": "502080"
  },
  {
    "text": "having it in code",
    "start": "502080",
    "end": "503440"
  },
  {
    "text": "in addition to timeout retries we also",
    "start": "503440",
    "end": "505280"
  },
  {
    "text": "do egress lists",
    "start": "505280",
    "end": "506800"
  },
  {
    "text": "via envoy which locks it which locks our",
    "start": "506800",
    "end": "509039"
  },
  {
    "text": "mesh network down",
    "start": "509039",
    "end": "510479"
  },
  {
    "text": "securely",
    "start": "510479",
    "end": "513039"
  },
  {
    "text": "cool so in addition to the load",
    "start": "513039",
    "end": "514640"
  },
  {
    "text": "balancing graph i showed you before we",
    "start": "514640",
    "end": "517120"
  },
  {
    "text": "also did a lot of tuning and timeouts",
    "start": "517120",
    "end": "518719"
  },
  {
    "text": "and retries we didn't get to quite to do",
    "start": "518719",
    "end": "521120"
  },
  {
    "text": "hedging retries but just cutting off the",
    "start": "521120",
    "end": "523200"
  },
  {
    "text": "top of the p99s and making them retry at",
    "start": "523200",
    "end": "526080"
  },
  {
    "text": "a faster rate really helped p99 overall",
    "start": "526080",
    "end": "530240"
  },
  {
    "text": "from what i mean is let's say we know",
    "start": "530240",
    "end": "532800"
  },
  {
    "text": "that service is going to get back in 500",
    "start": "532800",
    "end": "534480"
  },
  {
    "text": "milliseconds and we have errant pods uh",
    "start": "534480",
    "end": "536959"
  },
  {
    "text": "you know maybe doing two seconds we just",
    "start": "536959",
    "end": "539120"
  },
  {
    "text": "cut it at 500 milliseconds or 600",
    "start": "539120",
    "end": "541279"
  },
  {
    "text": "milliseconds and make him retry and that",
    "start": "541279",
    "end": "543200"
  },
  {
    "text": "retry will be faster than just you know",
    "start": "543200",
    "end": "545440"
  },
  {
    "text": "waiting for that bad bod to come back",
    "start": "545440",
    "end": "547200"
  },
  {
    "text": "and it really sliced down the top uh p99",
    "start": "547200",
    "end": "551839"
  },
  {
    "start": "552000",
    "end": "552000"
  },
  {
    "text": "so one of the things that i love about",
    "start": "553440",
    "end": "555600"
  },
  {
    "text": "match besides just the resiliency and",
    "start": "555600",
    "end": "557839"
  },
  {
    "text": "i'm kind of an observability nerd is",
    "start": "557839",
    "end": "559839"
  },
  {
    "text": "that it gave us so many metrics so on",
    "start": "559839",
    "end": "562320"
  },
  {
    "text": "the old old uh",
    "start": "562320",
    "end": "564399"
  },
  {
    "text": "i can't read that sign",
    "start": "564399",
    "end": "567200"
  },
  {
    "text": "it's pretty dark in here",
    "start": "568240",
    "end": "571360"
  },
  {
    "text": "okay",
    "start": "571360",
    "end": "572240"
  },
  {
    "text": "thank you",
    "start": "572240",
    "end": "573120"
  },
  {
    "text": "so on the old side of our network we had",
    "start": "573120",
    "end": "575360"
  },
  {
    "text": "some metrics given us by modules about",
    "start": "575360",
    "end": "577839"
  },
  {
    "text": "http",
    "start": "577839",
    "end": "579120"
  },
  {
    "text": "that again was not consistent or unified",
    "start": "579120",
    "end": "582480"
  },
  {
    "text": "across everything between node between",
    "start": "582480",
    "end": "584080"
  },
  {
    "text": "go between java between teams even we",
    "start": "584080",
    "end": "586320"
  },
  {
    "text": "did not have centralized metrics of http",
    "start": "586320",
    "end": "589600"
  },
  {
    "text": "let's say we had about 30 percent",
    "start": "589600",
    "end": "591120"
  },
  {
    "text": "coverage in our kubernetes cluster which",
    "start": "591120",
    "end": "593279"
  },
  {
    "text": "is a massive monitoring gap",
    "start": "593279",
    "end": "595519"
  },
  {
    "text": "envoy immediately i mean as soon as we",
    "start": "595519",
    "end": "597680"
  },
  {
    "text": "onboard even onboard even a couple into",
    "start": "597680",
    "end": "599760"
  },
  {
    "text": "envoy we got great metrics we had http",
    "start": "599760",
    "end": "602640"
  },
  {
    "text": "codes per route we had latency",
    "start": "602640",
    "end": "605680"
  },
  {
    "text": "we had retries we had adapter",
    "start": "605680",
    "end": "607600"
  },
  {
    "text": "consistency metrics we had everything we",
    "start": "607600",
    "end": "609440"
  },
  {
    "text": "ever want even per pod",
    "start": "609440",
    "end": "612000"
  },
  {
    "text": "it was great like there was no",
    "start": "612000",
    "end": "614160"
  },
  {
    "text": "no longer wondering oh the service is",
    "start": "614160",
    "end": "615920"
  },
  {
    "text": "getting some 503s and finding out that",
    "start": "615920",
    "end": "617920"
  },
  {
    "text": "oh it's one pod we know exactly which",
    "start": "617920",
    "end": "620000"
  },
  {
    "text": "part it is now",
    "start": "620000",
    "end": "621680"
  },
  {
    "text": "over a standardized method",
    "start": "621680",
    "end": "624880"
  },
  {
    "text": "we use grafana heavily we're a very",
    "start": "625120",
    "end": "626560"
  },
  {
    "text": "prometheus focused organization",
    "start": "626560",
    "end": "628800"
  },
  {
    "text": "and we pipe all these metrics into our",
    "start": "628800",
    "end": "630399"
  },
  {
    "text": "prometheus and thanos setup",
    "start": "630399",
    "end": "632480"
  },
  {
    "text": "we do really cool things like we have",
    "start": "632480",
    "end": "634240"
  },
  {
    "text": "canary dashboards and canary deploys",
    "start": "634240",
    "end": "635920"
  },
  {
    "text": "that use prometrics using onboard",
    "start": "635920",
    "end": "637279"
  },
  {
    "text": "metrics they can say instantly that pod",
    "start": "637279",
    "end": "639760"
  },
  {
    "text": "that just went out is worse than the",
    "start": "639760",
    "end": "641200"
  },
  {
    "text": "deploy that was already running",
    "start": "641200",
    "end": "643839"
  },
  {
    "text": "this one is very hard to see but if you",
    "start": "643839",
    "end": "645200"
  },
  {
    "text": "look at the top right we can see that",
    "start": "645200",
    "end": "646880"
  },
  {
    "text": "the canary is doing like 30 better than",
    "start": "646880",
    "end": "649200"
  },
  {
    "text": "the last one so we have all these really",
    "start": "649200",
    "end": "651360"
  },
  {
    "text": "great mesh metrics that allow us to do",
    "start": "651360",
    "end": "653519"
  },
  {
    "text": "good deploys and good observability",
    "start": "653519",
    "end": "657440"
  },
  {
    "text": "another fun thing we do with mesh",
    "start": "657760",
    "end": "658959"
  },
  {
    "text": "metrics and standard case metrics like c",
    "start": "658959",
    "end": "661200"
  },
  {
    "text": "advisor and coop state is like",
    "start": "661200",
    "end": "663519"
  },
  {
    "text": "standardized dashboards dashboards per",
    "start": "663519",
    "end": "665920"
  },
  {
    "text": "team",
    "start": "665920",
    "end": "667120"
  },
  {
    "text": "what i mean is there's no longer does a",
    "start": "667120",
    "end": "669519"
  },
  {
    "text": "team have to immediately just make their",
    "start": "669519",
    "end": "671040"
  },
  {
    "text": "own dashboard to track their metrics",
    "start": "671040",
    "end": "674079"
  },
  {
    "text": "we go through an automated process that",
    "start": "674079",
    "end": "676240"
  },
  {
    "text": "if you make a new module you get",
    "start": "676240",
    "end": "678079"
  },
  {
    "text": "pagerduty alerts you get slack alerts",
    "start": "678079",
    "end": "679680"
  },
  {
    "text": "you get everything you want and it's",
    "start": "679680",
    "end": "680800"
  },
  {
    "text": "fully based off mesh metrics",
    "start": "680800",
    "end": "684000"
  },
  {
    "text": "and uh case metrics they can have their",
    "start": "684000",
    "end": "686079"
  },
  {
    "text": "own if they want to and we encourage it",
    "start": "686079",
    "end": "687920"
  },
  {
    "text": "but everyone gets these base dashboards",
    "start": "687920",
    "end": "691839"
  },
  {
    "text": "we also do uh filters",
    "start": "693360",
    "end": "695519"
  },
  {
    "text": "for",
    "start": "695519",
    "end": "696720"
  },
  {
    "text": "dynamodb redis and elasticsearch which",
    "start": "696720",
    "end": "698720"
  },
  {
    "text": "is the tweak http filter so we get",
    "start": "698720",
    "end": "701040"
  },
  {
    "text": "really good insights and metrics on",
    "start": "701040",
    "end": "702640"
  },
  {
    "text": "those services as well being called for",
    "start": "702640",
    "end": "704480"
  },
  {
    "text": "mesh services",
    "start": "704480",
    "end": "707199"
  },
  {
    "text": "yep",
    "start": "707600",
    "end": "709360"
  },
  {
    "start": "708000",
    "end": "708000"
  },
  {
    "text": "okay so what didn't go well as i",
    "start": "709360",
    "end": "711200"
  },
  {
    "text": "mentioned earlier the timeouts and",
    "start": "711200",
    "end": "712560"
  },
  {
    "text": "retries needed to be locked in",
    "start": "712560",
    "end": "715040"
  },
  {
    "text": "and when they weren't it was kind of",
    "start": "715040",
    "end": "716959"
  },
  {
    "text": "rough",
    "start": "716959",
    "end": "718000"
  },
  {
    "text": "uh",
    "start": "718000",
    "end": "718800"
  },
  {
    "text": "since we do a microservice organization",
    "start": "718800",
    "end": "720720"
  },
  {
    "text": "we do many calls to go from you know",
    "start": "720720",
    "end": "722720"
  },
  {
    "text": "microsoft's a to b to c to d",
    "start": "722720",
    "end": "725040"
  },
  {
    "text": "and if your timeouts aren't scheduled",
    "start": "725040",
    "end": "726560"
  },
  {
    "text": "correctly and especially if you don't",
    "start": "726560",
    "end": "728320"
  },
  {
    "text": "have cancellation propagation in your",
    "start": "728320",
    "end": "730079"
  },
  {
    "text": "code",
    "start": "730079",
    "end": "731200"
  },
  {
    "text": "you could potentially have like 13 tries",
    "start": "731200",
    "end": "733680"
  },
  {
    "text": "for every try you start at the beginning",
    "start": "733680",
    "end": "736720"
  },
  {
    "text": "so you need to make sure that you always",
    "start": "736720",
    "end": "738320"
  },
  {
    "text": "go down that each chain is can be",
    "start": "738320",
    "end": "740800"
  },
  {
    "text": "encapsulated by the one before it",
    "start": "740800",
    "end": "742959"
  },
  {
    "text": "otherwise you can do way more retries",
    "start": "742959",
    "end": "745200"
  },
  {
    "text": "than you could ever think possible",
    "start": "745200",
    "end": "748480"
  },
  {
    "start": "750000",
    "end": "750000"
  },
  {
    "text": "so",
    "start": "751360",
    "end": "753519"
  },
  {
    "text": "we did filters we know this what else",
    "start": "753519",
    "end": "755600"
  },
  {
    "text": "did we learn on this so",
    "start": "755600",
    "end": "757519"
  },
  {
    "text": "we learned that if you best make sure",
    "start": "757519",
    "end": "759920"
  },
  {
    "text": "that envoy is",
    "start": "759920",
    "end": "761680"
  },
  {
    "text": "the first to start and the last to stay",
    "start": "761680",
    "end": "763600"
  },
  {
    "text": "alive",
    "start": "763600",
    "end": "764560"
  },
  {
    "text": "uh since we are doing egress and ingress",
    "start": "764560",
    "end": "766480"
  },
  {
    "text": "through all of them if envoy is not up",
    "start": "766480",
    "end": "768720"
  },
  {
    "text": "when you start and not not still up when",
    "start": "768720",
    "end": "771120"
  },
  {
    "text": "everything goes down you will drop",
    "start": "771120",
    "end": "772639"
  },
  {
    "text": "connections you will drop requests",
    "start": "772639",
    "end": "774800"
  },
  {
    "text": "uh if envoy goes down first when it both",
    "start": "774800",
    "end": "777200"
  },
  {
    "text": "get the sig term when pod gets",
    "start": "777200",
    "end": "778800"
  },
  {
    "text": "terminated their in-flight requests on",
    "start": "778800",
    "end": "781519"
  },
  {
    "text": "the uh",
    "start": "781519",
    "end": "783040"
  },
  {
    "text": "on the module will get dropped",
    "start": "783040",
    "end": "786240"
  },
  {
    "text": "not only do we find out that we need to",
    "start": "786240",
    "end": "787760"
  },
  {
    "text": "do that but we also found out that on",
    "start": "787760",
    "end": "789760"
  },
  {
    "text": "the cluster in general it was nice to",
    "start": "789760",
    "end": "792720"
  },
  {
    "text": "catch the sig term and let's say if a",
    "start": "792720",
    "end": "794880"
  },
  {
    "text": "pod gets terminated for at least 10 to",
    "start": "794880",
    "end": "796720"
  },
  {
    "text": "15 seconds before you even pass it",
    "start": "796720",
    "end": "798399"
  },
  {
    "text": "through",
    "start": "798399",
    "end": "799440"
  },
  {
    "text": "no matter if you're using like old",
    "start": "799440",
    "end": "801279"
  },
  {
    "text": "school ipvs or ip table services with",
    "start": "801279",
    "end": "803600"
  },
  {
    "text": "coop proxy or you're using the new eds",
    "start": "803600",
    "end": "806079"
  },
  {
    "text": "or xds api servers",
    "start": "806079",
    "end": "808240"
  },
  {
    "text": "there isn't they're not always",
    "start": "808240",
    "end": "810079"
  },
  {
    "text": "instantaneous so",
    "start": "810079",
    "end": "812320"
  },
  {
    "text": "just stay alive a little bit longer to",
    "start": "812320",
    "end": "813680"
  },
  {
    "text": "catch up with a couple that are kind of",
    "start": "813680",
    "end": "815279"
  },
  {
    "text": "slow to update",
    "start": "815279",
    "end": "818000"
  },
  {
    "text": "so we originally didn't do this and it",
    "start": "818720",
    "end": "820720"
  },
  {
    "text": "caused a whole bunch of issues with",
    "start": "820720",
    "end": "822160"
  },
  {
    "text": "deploys so what i'm talking about is on",
    "start": "822160",
    "end": "824720"
  },
  {
    "text": "kubernetes if you do a you know pod",
    "start": "824720",
    "end": "826480"
  },
  {
    "text": "terminator pod roll uh once it gets sent",
    "start": "826480",
    "end": "829600"
  },
  {
    "text": "the termination call they send a sync",
    "start": "829600",
    "end": "830959"
  },
  {
    "text": "term down to all the all the containers",
    "start": "830959",
    "end": "832720"
  },
  {
    "text": "in the pod",
    "start": "832720",
    "end": "834079"
  },
  {
    "text": "if you start shutting down immediately",
    "start": "834079",
    "end": "836160"
  },
  {
    "text": "assuming even that your code is handling",
    "start": "836160",
    "end": "838000"
  },
  {
    "text": "grace will shut down properly",
    "start": "838000",
    "end": "839839"
  },
  {
    "text": "uh you're probably gonna die in about a",
    "start": "839839",
    "end": "842000"
  },
  {
    "text": "second or so even if you",
    "start": "842000",
    "end": "845040"
  },
  {
    "text": "do a pretty good diligent job",
    "start": "845040",
    "end": "847279"
  },
  {
    "text": "uh we learned that even after that",
    "start": "847279",
    "end": "848800"
  },
  {
    "text": "second that there were still extraneous",
    "start": "848800",
    "end": "850959"
  },
  {
    "text": "callers that took a little bit to update",
    "start": "850959",
    "end": "852880"
  },
  {
    "text": "from",
    "start": "852880",
    "end": "853600"
  },
  {
    "text": "various sources so that dead pod would",
    "start": "853600",
    "end": "856079"
  },
  {
    "text": "still be getting calls",
    "start": "856079",
    "end": "857680"
  },
  {
    "text": "uh",
    "start": "857680",
    "end": "858880"
  },
  {
    "text": "to combat that as i said we did a 10 to",
    "start": "858880",
    "end": "861440"
  },
  {
    "text": "15 second wait on that sig term so even",
    "start": "861440",
    "end": "863680"
  },
  {
    "text": "though all those pods were",
    "start": "863680",
    "end": "865440"
  },
  {
    "text": "determined to be you know terminating",
    "start": "865440",
    "end": "867519"
  },
  {
    "text": "they were still well enough to handle",
    "start": "867519",
    "end": "868880"
  },
  {
    "text": "traffic for another 10 15 seconds to",
    "start": "868880",
    "end": "870560"
  },
  {
    "text": "really just mop up the last few requests",
    "start": "870560",
    "end": "873519"
  },
  {
    "text": "that brought down our 500 class codes by",
    "start": "873519",
    "end": "876000"
  },
  {
    "text": "almost 100 during deploys",
    "start": "876000",
    "end": "879279"
  },
  {
    "text": "so we have a truly really easily fun",
    "start": "879279",
    "end": "881680"
  },
  {
    "text": "deploy",
    "start": "881680",
    "end": "884680"
  },
  {
    "start": "885000",
    "end": "885000"
  },
  {
    "text": "hey um so i'm just going to talk about",
    "start": "887120",
    "end": "889199"
  },
  {
    "text": "global rate limiting since it's i think",
    "start": "889199",
    "end": "891360"
  },
  {
    "text": "a fairly unique envoy feature since it",
    "start": "891360",
    "end": "893440"
  },
  {
    "text": "requires it's like an external service",
    "start": "893440",
    "end": "895440"
  },
  {
    "text": "as well as like a redis back end",
    "start": "895440",
    "end": "897360"
  },
  {
    "text": "a little different from the other envoy",
    "start": "897360",
    "end": "898959"
  },
  {
    "text": "features and this was also like a pretty",
    "start": "898959",
    "end": "900480"
  },
  {
    "text": "big win for a pretty big win for us um",
    "start": "900480",
    "end": "903040"
  },
  {
    "text": "because previously you know",
    "start": "903040",
    "end": "904639"
  },
  {
    "text": "various back-end teams they would write",
    "start": "904639",
    "end": "906079"
  },
  {
    "text": "their own rate limiting logic right with",
    "start": "906079",
    "end": "908480"
  },
  {
    "text": "their own server and their own you know",
    "start": "908480",
    "end": "910000"
  },
  {
    "text": "database to track the rate limiting",
    "start": "910000",
    "end": "912480"
  },
  {
    "text": "state",
    "start": "912480",
    "end": "913519"
  },
  {
    "text": "but with envoy we're able to just",
    "start": "913519",
    "end": "915680"
  },
  {
    "text": "you know consolidate that all into the",
    "start": "915680",
    "end": "917760"
  },
  {
    "text": "envoy network layer so we have global",
    "start": "917760",
    "end": "919760"
  },
  {
    "text": "rate limiting right not per server or",
    "start": "919760",
    "end": "921839"
  },
  {
    "text": "like per service",
    "start": "921839",
    "end": "923760"
  },
  {
    "text": "we have granular configuration we can",
    "start": "923760",
    "end": "925680"
  },
  {
    "text": "rate limit on one or more headers and",
    "start": "925680",
    "end": "927360"
  },
  {
    "text": "then of course we gave",
    "start": "927360",
    "end": "929440"
  },
  {
    "text": "we got monitoring alerting and",
    "start": "929440",
    "end": "930880"
  },
  {
    "text": "visibility into the rate limiting which",
    "start": "930880",
    "end": "933040"
  },
  {
    "text": "was you know often an afterthought when",
    "start": "933040",
    "end": "935680"
  },
  {
    "text": "people you know hand rolled their own",
    "start": "935680",
    "end": "937360"
  },
  {
    "text": "rate limiting services so that was great",
    "start": "937360",
    "end": "939680"
  },
  {
    "text": "so today at tinder it prevents system",
    "start": "939680",
    "end": "941600"
  },
  {
    "text": "failure you know stops fraud and a lot",
    "start": "941600",
    "end": "943680"
  },
  {
    "text": "of cost savings from not having to",
    "start": "943680",
    "end": "945920"
  },
  {
    "text": "process those fraudulent requests and it",
    "start": "945920",
    "end": "948160"
  },
  {
    "text": "polices about 200 000 rps at tinder",
    "start": "948160",
    "end": "951279"
  },
  {
    "text": "you can base it on you know user id ip",
    "start": "951279",
    "end": "953839"
  },
  {
    "text": "any kind of headers so very useful",
    "start": "953839",
    "end": "956959"
  },
  {
    "text": "i mean we have two rate limiting",
    "start": "956959",
    "end": "958320"
  },
  {
    "text": "clusters we have an internal one for",
    "start": "958320",
    "end": "959759"
  },
  {
    "text": "internal requests and external for",
    "start": "959759",
    "end": "961279"
  },
  {
    "text": "external requests",
    "start": "961279",
    "end": "962880"
  },
  {
    "text": "each with their own redis backend and",
    "start": "962880",
    "end": "964720"
  },
  {
    "text": "rate limit service and then the redis",
    "start": "964720",
    "end": "966639"
  },
  {
    "text": "request or even proxy through envoy",
    "start": "966639",
    "end": "969680"
  },
  {
    "text": "um so this is like a cool little chart i",
    "start": "969680",
    "end": "971440"
  },
  {
    "start": "970000",
    "end": "970000"
  },
  {
    "text": "was able to you know make with the",
    "start": "971440",
    "end": "973519"
  },
  {
    "text": "observability um that envelope gives us",
    "start": "973519",
    "end": "975920"
  },
  {
    "text": "right so we we can see where all the",
    "start": "975920",
    "end": "977680"
  },
  {
    "text": "rate limiting is happening like you can",
    "start": "977680",
    "end": "979920"
  },
  {
    "text": "see in the middle east there's some",
    "start": "979920",
    "end": "981600"
  },
  {
    "text": "pretty big dots",
    "start": "981600",
    "end": "982959"
  },
  {
    "text": "i think in europe a lot of the attackers",
    "start": "982959",
    "end": "984959"
  },
  {
    "text": "come from europe because i think that",
    "start": "984959",
    "end": "986160"
  },
  {
    "text": "the ip",
    "start": "986160",
    "end": "987279"
  },
  {
    "text": "laws are a little looser than the u.s",
    "start": "987279",
    "end": "988959"
  },
  {
    "text": "and you can also see some pretty big",
    "start": "988959",
    "end": "990240"
  },
  {
    "text": "dots around where the aws data centers",
    "start": "990240",
    "end": "992480"
  },
  {
    "text": "like virginia and the west coast are",
    "start": "992480",
    "end": "996720"
  },
  {
    "start": "996000",
    "end": "996000"
  },
  {
    "text": "so envoy configuration um you know i'm",
    "start": "996720",
    "end": "999440"
  },
  {
    "text": "just going to talk a little about that",
    "start": "999440",
    "end": "1000639"
  },
  {
    "text": "because it can be pretty complex long",
    "start": "1000639",
    "end": "1002320"
  },
  {
    "text": "right you have like you could have like",
    "start": "1002320",
    "end": "1003839"
  },
  {
    "text": "a thousand line long gamma and we needed",
    "start": "1003839",
    "end": "1005920"
  },
  {
    "text": "a way to just surface the minimum number",
    "start": "1005920",
    "end": "1007600"
  },
  {
    "text": "of knobs to the service owners that",
    "start": "1007600",
    "end": "1009680"
  },
  {
    "text": "weren't really knowledgeable about envoy",
    "start": "1009680",
    "end": "1011519"
  },
  {
    "text": "but they still wanted to like timeout to",
    "start": "1011519",
    "end": "1013600"
  },
  {
    "text": "retries themselves right so we created",
    "start": "1013600",
    "end": "1015920"
  },
  {
    "text": "an in-house dsl so the service owners",
    "start": "1015920",
    "end": "1018320"
  },
  {
    "text": "just write a short yaml snippet",
    "start": "1018320",
    "end": "1020800"
  },
  {
    "text": "and then it gets translated into an",
    "start": "1020800",
    "end": "1022320"
  },
  {
    "text": "envoy config and how it basically works",
    "start": "1022320",
    "end": "1024558"
  },
  {
    "text": "is right there's like a ginger template",
    "start": "1024559",
    "end": "1026160"
  },
  {
    "text": "that gets converted into an envoy config",
    "start": "1026160",
    "end": "1028160"
  },
  {
    "text": "yaml gets baked into a config map that's",
    "start": "1028160",
    "end": "1030640"
  },
  {
    "text": "rolled into our kubernetes cluster",
    "start": "1030640",
    "end": "1033038"
  },
  {
    "text": "and you know we're able to just empower",
    "start": "1033039",
    "end": "1034640"
  },
  {
    "text": "the owners and they can do self-service",
    "start": "1034640",
    "end": "1036798"
  },
  {
    "text": "smash tuning this way",
    "start": "1036799",
    "end": "1039280"
  },
  {
    "text": "so the dsl supports retries timeouts",
    "start": "1039280",
    "end": "1042160"
  },
  {
    "text": "rate limits tracing outlier detection ip",
    "start": "1042160",
    "end": "1045280"
  },
  {
    "text": "restriction direct response data filters",
    "start": "1045280",
    "end": "1048400"
  },
  {
    "text": "and you know we're adding more and more",
    "start": "1048400",
    "end": "1050160"
  },
  {
    "text": "as envoy features come out the only",
    "start": "1050160",
    "end": "1052559"
  },
  {
    "text": "thing not in this dsl was the endpoints",
    "start": "1052559",
    "end": "1054880"
  },
  {
    "text": "because that's supplied via the eds",
    "start": "1054880",
    "end": "1056880"
  },
  {
    "text": "control plane which i'll be talking",
    "start": "1056880",
    "end": "1058320"
  },
  {
    "text": "about in the next slide and we just have",
    "start": "1058320",
    "end": "1060480"
  },
  {
    "text": "a regular kind of git ops flow of a pr",
    "start": "1060480",
    "end": "1063440"
  },
  {
    "text": "it gets approved merged and then",
    "start": "1063440",
    "end": "1064960"
  },
  {
    "text": "deployed via something like jenkins into",
    "start": "1064960",
    "end": "1067039"
  },
  {
    "text": "kubernetes",
    "start": "1067039",
    "end": "1069520"
  },
  {
    "start": "1069000",
    "end": "1069000"
  },
  {
    "text": "so the um you know the control plane we",
    "start": "1069520",
    "end": "1071360"
  },
  {
    "text": "have right now we just implemented the",
    "start": "1071360",
    "end": "1073440"
  },
  {
    "text": "minimum api and point discovery service",
    "start": "1073440",
    "end": "1076640"
  },
  {
    "text": "um we didn't you know implement the",
    "start": "1076640",
    "end": "1078640"
  },
  {
    "text": "whole xds future set the endpoint",
    "start": "1078640",
    "end": "1080799"
  },
  {
    "text": "discovery service was actually you know",
    "start": "1080799",
    "end": "1082640"
  },
  {
    "text": "sufficient for us it's built on go",
    "start": "1082640",
    "end": "1084320"
  },
  {
    "text": "control plane",
    "start": "1084320",
    "end": "1085840"
  },
  {
    "text": "and how it works",
    "start": "1085840",
    "end": "1087679"
  },
  {
    "text": "overall just",
    "start": "1087679",
    "end": "1089360"
  },
  {
    "text": "relatively simple i think just",
    "start": "1089360",
    "end": "1090480"
  },
  {
    "text": "kubernetes watch on pods on any new pods",
    "start": "1090480",
    "end": "1093039"
  },
  {
    "text": "any deleted pods change pods the pod ips",
    "start": "1093039",
    "end": "1095919"
  },
  {
    "text": "for each namespace are stored in memory",
    "start": "1095919",
    "end": "1098160"
  },
  {
    "text": "on any deltas we're sending out these",
    "start": "1098160",
    "end": "1100720"
  },
  {
    "text": "new pods pod ips to the subscribed",
    "start": "1100720",
    "end": "1103200"
  },
  {
    "text": "envoys and then the egress clusters are",
    "start": "1103200",
    "end": "1105760"
  },
  {
    "text": "defined in the config map",
    "start": "1105760",
    "end": "1108880"
  },
  {
    "text": "and then you know some some of the",
    "start": "1108880",
    "end": "1110080"
  },
  {
    "text": "custom",
    "start": "1110080",
    "end": "1111120"
  },
  {
    "text": "functionality we added in there was uh",
    "start": "1111120",
    "end": "1113360"
  },
  {
    "text": "you know say if an envoy and 1a az",
    "start": "1113360",
    "end": "1117280"
  },
  {
    "text": "request endpoints then it only received",
    "start": "1117280",
    "end": "1119679"
  },
  {
    "text": "endpoints for 1a so we were able to",
    "start": "1119679",
    "end": "1121679"
  },
  {
    "text": "implement locality-based routing",
    "start": "1121679",
    "end": "1123760"
  },
  {
    "text": "you know again just for saving on like",
    "start": "1123760",
    "end": "1125280"
  },
  {
    "text": "cross az cost and latency",
    "start": "1125280",
    "end": "1128720"
  },
  {
    "start": "1128000",
    "end": "1128000"
  },
  {
    "text": "um yeah and then what we're working on",
    "start": "1128960",
    "end": "1130960"
  },
  {
    "text": "this year is something called fire mesh",
    "start": "1130960",
    "end": "1132880"
  },
  {
    "text": "so we just you know like to go hard on",
    "start": "1132880",
    "end": "1134480"
  },
  {
    "text": "the fire project names at tinder",
    "start": "1134480",
    "end": "1136960"
  },
  {
    "text": "and we're implementing a full xts",
    "start": "1136960",
    "end": "1139600"
  },
  {
    "text": "control plane with all discovery",
    "start": "1139600",
    "end": "1140960"
  },
  {
    "text": "services implemented",
    "start": "1140960",
    "end": "1142799"
  },
  {
    "text": "so we're implementing uh on top of",
    "start": "1142799",
    "end": "1145760"
  },
  {
    "text": "endpoint discovery service route",
    "start": "1145760",
    "end": "1147280"
  },
  {
    "text": "discovery service cluster discovery",
    "start": "1147280",
    "end": "1148960"
  },
  {
    "text": "service secret discovery service and the",
    "start": "1148960",
    "end": "1150640"
  },
  {
    "text": "listener discovery service trying to",
    "start": "1150640",
    "end": "1152559"
  },
  {
    "text": "roll it out by end of year",
    "start": "1152559",
    "end": "1154320"
  },
  {
    "text": "so if tinder goes down in december you",
    "start": "1154320",
    "end": "1156320"
  },
  {
    "text": "know what happened",
    "start": "1156320",
    "end": "1158960"
  },
  {
    "text": "and then of course we'll be piping it",
    "start": "1159039",
    "end": "1160400"
  },
  {
    "text": "all through ads the aggregated discovery",
    "start": "1160400",
    "end": "1162480"
  },
  {
    "text": "service or using s3 for storage and",
    "start": "1162480",
    "end": "1165360"
  },
  {
    "text": "kafka for messaging",
    "start": "1165360",
    "end": "1167280"
  },
  {
    "text": "and this unlocks like header based",
    "start": "1167280",
    "end": "1168960"
  },
  {
    "text": "routing percentage based traffic routing",
    "start": "1168960",
    "end": "1170960"
  },
  {
    "text": "which you can do without all these xds",
    "start": "1170960",
    "end": "1173919"
  },
  {
    "text": "apis but you know it's a lot more",
    "start": "1173919",
    "end": "1175919"
  },
  {
    "text": "cumbersome because you need to redeploy",
    "start": "1175919",
    "end": "1177840"
  },
  {
    "text": "the pods or the cms",
    "start": "1177840",
    "end": "1180160"
  },
  {
    "text": "and you know wait for those to propagate",
    "start": "1180160",
    "end": "1182559"
  },
  {
    "text": "but with the you know xds it's obviously",
    "start": "1182559",
    "end": "1185039"
  },
  {
    "text": "very low touch instant rollbacks and",
    "start": "1185039",
    "end": "1186880"
  },
  {
    "text": "config changes",
    "start": "1186880",
    "end": "1189600"
  },
  {
    "start": "1189000",
    "end": "1189000"
  },
  {
    "text": "um yeah so just in summary service owner",
    "start": "1189600",
    "end": "1191360"
  },
  {
    "text": "is very happy everyone at tinder is very",
    "start": "1191360",
    "end": "1193039"
  },
  {
    "text": "happy we have this implemented we have a",
    "start": "1193039",
    "end": "1195039"
  },
  {
    "text": "holistic platform that integrates with",
    "start": "1195039",
    "end": "1196880"
  },
  {
    "text": "the monitoring stack the kubernetes",
    "start": "1196880",
    "end": "1198400"
  },
  {
    "text": "stack the ci cd stack",
    "start": "1198400",
    "end": "1200880"
  },
  {
    "text": "i think the biggest win right is just",
    "start": "1200880",
    "end": "1202320"
  },
  {
    "text": "immensely less code to maintain across",
    "start": "1202320",
    "end": "1204159"
  },
  {
    "text": "the org from the network automation",
    "start": "1204159",
    "end": "1206880"
  },
  {
    "text": "observability et cetera we moved that",
    "start": "1206880",
    "end": "1209360"
  },
  {
    "text": "all from the application layer to the",
    "start": "1209360",
    "end": "1211280"
  },
  {
    "text": "envoy layer i mean just some of the",
    "start": "1211280",
    "end": "1213039"
  },
  {
    "text": "future work we're going to be doing is",
    "start": "1213039",
    "end": "1214960"
  },
  {
    "text": "ads as i just talked about the delta xds",
    "start": "1214960",
    "end": "1218320"
  },
  {
    "text": "onboard mobile for ios android",
    "start": "1218320",
    "end": "1220960"
  },
  {
    "text": "uh you know investigate some custom lua",
    "start": "1220960",
    "end": "1223039"
  },
  {
    "text": "awesome filters and then do some request",
    "start": "1223039",
    "end": "1224799"
  },
  {
    "text": "hedging",
    "start": "1224799",
    "end": "1227200"
  },
  {
    "text": "and that's it uh thanks for uh watching",
    "start": "1227280",
    "end": "1230720"
  },
  {
    "text": "yeah do we have time for questions",
    "start": "1230720",
    "end": "1233600"
  },
  {
    "text": "yes",
    "start": "1233600",
    "end": "1234480"
  },
  {
    "text": "any questions",
    "start": "1234480",
    "end": "1237280"
  },
  {
    "text": "[Music]",
    "start": "1242520",
    "end": "1245779"
  },
  {
    "text": "uh so he asked us why we did our own",
    "start": "1250880",
    "end": "1252720"
  },
  {
    "text": "control plane versus sdo um the answer",
    "start": "1252720",
    "end": "1254960"
  },
  {
    "text": "with that is",
    "start": "1254960",
    "end": "1256400"
  },
  {
    "text": "uh we started building this before istio",
    "start": "1256400",
    "end": "1258000"
  },
  {
    "text": "went 1.0",
    "start": "1258000",
    "end": "1259360"
  },
  {
    "text": "um that was the real",
    "start": "1259360",
    "end": "1261360"
  },
  {
    "text": "main uh thing of it and once we got",
    "start": "1261360",
    "end": "1263919"
  },
  {
    "text": "enough velocity it was just",
    "start": "1263919",
    "end": "1265919"
  },
  {
    "text": "too painful to switch over once we got",
    "start": "1265919",
    "end": "1268080"
  },
  {
    "text": "our system fully",
    "start": "1268080",
    "end": "1269520"
  },
  {
    "text": "pretty much where we wanted it",
    "start": "1269520",
    "end": "1272000"
  },
  {
    "text": "but yeah istio was great you guys are",
    "start": "1272000",
    "end": "1273679"
  },
  {
    "text": "just starting out i fully recommend it",
    "start": "1273679",
    "end": "1277840"
  },
  {
    "text": "anyone else",
    "start": "1281520",
    "end": "1285000"
  },
  {
    "text": "okay",
    "start": "1290000",
    "end": "1291919"
  },
  {
    "text": "cool we will be on the slack if anyone",
    "start": "1291919",
    "end": "1294720"
  },
  {
    "text": "has any questions for us there",
    "start": "1294720",
    "end": "1297840"
  },
  {
    "text": "thank you",
    "start": "1298320",
    "end": "1301360"
  }
]