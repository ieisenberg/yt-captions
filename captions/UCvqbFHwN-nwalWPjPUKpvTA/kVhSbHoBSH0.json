[
  {
    "text": "hi everyone and thanks for coming my",
    "start": "0",
    "end": "2159"
  },
  {
    "text": "name is jack i'm here to talk about",
    "start": "2159",
    "end": "3760"
  },
  {
    "text": "network isolation for 1500 microservices",
    "start": "3760",
    "end": "8799"
  },
  {
    "text": "so i'm talking about some work that i",
    "start": "9040",
    "end": "11360"
  },
  {
    "text": "actually did at my last company",
    "start": "11360",
    "end": "13040"
  },
  {
    "text": "which is a large banking startup in the",
    "start": "13040",
    "end": "14559"
  },
  {
    "text": "uk and i'm just going to try and refer",
    "start": "14559",
    "end": "16080"
  },
  {
    "text": "to them by the word bank",
    "start": "16080",
    "end": "17440"
  },
  {
    "text": "from now on so this company they were",
    "start": "17440",
    "end": "20000"
  },
  {
    "text": "cloud native from",
    "start": "20000",
    "end": "20960"
  },
  {
    "text": "pretty much straight away very early in",
    "start": "20960",
    "end": "23680"
  },
  {
    "text": "the container wars",
    "start": "23680",
    "end": "25760"
  },
  {
    "text": "and they actually are now running a",
    "start": "25760",
    "end": "28080"
  },
  {
    "text": "kubernetes cluster that is about four",
    "start": "28080",
    "end": "29760"
  },
  {
    "text": "years",
    "start": "29760",
    "end": "30000"
  },
  {
    "text": "old which i think is pretty mad um you",
    "start": "30000",
    "end": "32880"
  },
  {
    "text": "know one continuous cost of that entire",
    "start": "32880",
    "end": "34399"
  },
  {
    "text": "time",
    "start": "34399",
    "end": "34880"
  },
  {
    "text": "even persisted across the cni migration",
    "start": "34880",
    "end": "36800"
  },
  {
    "text": "which is pretty cool",
    "start": "36800",
    "end": "37920"
  },
  {
    "text": "and they're running 1500 micro services",
    "start": "37920",
    "end": "39520"
  },
  {
    "text": "that are almost all written in go",
    "start": "39520",
    "end": "41200"
  },
  {
    "text": "uh so it's a very homogenous platform",
    "start": "41200",
    "end": "43040"
  },
  {
    "text": "which made my life a lot easier",
    "start": "43040",
    "end": "45360"
  },
  {
    "text": "and i work primarily on security but",
    "start": "45360",
    "end": "47200"
  },
  {
    "text": "also a lot of core platform stuff",
    "start": "47200",
    "end": "49680"
  },
  {
    "text": "so it's self-hosted kubernetes uh",
    "start": "49680",
    "end": "51760"
  },
  {
    "text": "running on aws",
    "start": "51760",
    "end": "52800"
  },
  {
    "text": "so by self-hosted i mean that we are",
    "start": "52800",
    "end": "54879"
  },
  {
    "text": "doing all of the management of it we're",
    "start": "54879",
    "end": "56079"
  },
  {
    "text": "using ec2",
    "start": "56079",
    "end": "56960"
  },
  {
    "text": "didn't use cube admin we didn't use any",
    "start": "56960",
    "end": "58719"
  },
  {
    "text": "of the distributions and we didn't use",
    "start": "58719",
    "end": "60480"
  },
  {
    "text": "any managed services because essentially",
    "start": "60480",
    "end": "62000"
  },
  {
    "text": "the platform",
    "start": "62000",
    "end": "62640"
  },
  {
    "text": "predated a lot of that stuff um we also",
    "start": "62640",
    "end": "65920"
  },
  {
    "text": "had a homegrown",
    "start": "65920",
    "end": "66960"
  },
  {
    "text": "envoy sidecar service mesh uh in the",
    "start": "66960",
    "end": "69119"
  },
  {
    "text": "early days we were using linkedin as a",
    "start": "69119",
    "end": "70560"
  },
  {
    "text": "demonstration we ended up using envoy as",
    "start": "70560",
    "end": "72080"
  },
  {
    "text": "a demon set and then eventually went to",
    "start": "72080",
    "end": "73680"
  },
  {
    "text": "envoy containers in every single pod",
    "start": "73680",
    "end": "75439"
  },
  {
    "text": "and that was really awesome and we ran",
    "start": "75439",
    "end": "76720"
  },
  {
    "text": "our own control plane for that",
    "start": "76720",
    "end": "78720"
  },
  {
    "text": "and for networking we basically were",
    "start": "78720",
    "end": "80400"
  },
  {
    "text": "using calico at the cni",
    "start": "80400",
    "end": "82240"
  },
  {
    "text": "uh which worked fine we didn't do",
    "start": "82240",
    "end": "83840"
  },
  {
    "text": "anything too magical with that",
    "start": "83840",
    "end": "87280"
  },
  {
    "text": "so you might have seen this picture",
    "start": "87280",
    "end": "88880"
  },
  {
    "text": "before i tweeted it a few months ago and",
    "start": "88880",
    "end": "90720"
  },
  {
    "text": "it got a lot of attention",
    "start": "90720",
    "end": "92000"
  },
  {
    "text": "uh what is this picture of well this is",
    "start": "92000",
    "end": "94240"
  },
  {
    "text": "actually what a bank looks like",
    "start": "94240",
    "end": "96960"
  },
  {
    "text": "the dots are services basically",
    "start": "96960",
    "end": "99040"
  },
  {
    "text": "microservices",
    "start": "99040",
    "end": "100400"
  },
  {
    "text": "and the lines are enforced networking",
    "start": "100400",
    "end": "102399"
  },
  {
    "text": "rules between those services",
    "start": "102399",
    "end": "103759"
  },
  {
    "text": "so if you're interested in network",
    "start": "103759",
    "end": "105040"
  },
  {
    "text": "isolation this is a pretty good case",
    "start": "105040",
    "end": "106880"
  },
  {
    "text": "study for",
    "start": "106880",
    "end": "107840"
  },
  {
    "text": "um how that can look like a scale but it",
    "start": "107840",
    "end": "110320"
  },
  {
    "text": "i know it looks really really chaotic",
    "start": "110320",
    "end": "111920"
  },
  {
    "text": "and that's partly just because this",
    "start": "111920",
    "end": "112960"
  },
  {
    "text": "isn't really a good representation of",
    "start": "112960",
    "end": "114560"
  },
  {
    "text": "anything meaningful",
    "start": "114560",
    "end": "115680"
  },
  {
    "text": "it's just a fun diagram that i like to",
    "start": "115680",
    "end": "117920"
  },
  {
    "text": "show people i guess",
    "start": "117920",
    "end": "118960"
  },
  {
    "text": "um and with good tools we create",
    "start": "118960",
    "end": "121040"
  },
  {
    "text": "ordering the chaos right so",
    "start": "121040",
    "end": "122880"
  },
  {
    "text": "um while this might look really complex",
    "start": "122880",
    "end": "124880"
  },
  {
    "text": "this isn't necessarily something that",
    "start": "124880",
    "end": "126159"
  },
  {
    "text": "needs to be in anyone's brain um",
    "start": "126159",
    "end": "127920"
  },
  {
    "text": "unfortunately it's not in my brain",
    "start": "127920",
    "end": "130239"
  },
  {
    "text": "and i'm not here to justify the whole",
    "start": "130239",
    "end": "131840"
  },
  {
    "text": "concept of our micro service is good",
    "start": "131840",
    "end": "133920"
  },
  {
    "text": "is this too many um what i will say is",
    "start": "133920",
    "end": "136160"
  },
  {
    "text": "banks are complicated",
    "start": "136160",
    "end": "137599"
  },
  {
    "text": "uh and computers are fast so by banks",
    "start": "137599",
    "end": "140080"
  },
  {
    "text": "are complicated i mean you're not just",
    "start": "140080",
    "end": "141360"
  },
  {
    "text": "looking at a database that describes",
    "start": "141360",
    "end": "143680"
  },
  {
    "text": "the bank balance of everyone's account",
    "start": "143680",
    "end": "145840"
  },
  {
    "text": "you're also looking at employee",
    "start": "145840",
    "end": "147120"
  },
  {
    "text": "management system",
    "start": "147120",
    "end": "148160"
  },
  {
    "text": "you're also looking at a lending",
    "start": "148160",
    "end": "149280"
  },
  {
    "text": "decisioning system you're looking at a",
    "start": "149280",
    "end": "150959"
  },
  {
    "text": "full support chat system that we built",
    "start": "150959",
    "end": "152800"
  },
  {
    "text": "completely ourselves",
    "start": "152800",
    "end": "153680"
  },
  {
    "text": "and we weren't using a lot of third",
    "start": "153680",
    "end": "154640"
  },
  {
    "text": "parties and stuff like that you're",
    "start": "154640",
    "end": "156000"
  },
  {
    "text": "seeing a diagram that has a lot of",
    "start": "156000",
    "end": "157280"
  },
  {
    "text": "different stuff and they're tightly",
    "start": "157280",
    "end": "158720"
  },
  {
    "text": "interlinked which is actually powerful",
    "start": "158720",
    "end": "161360"
  },
  {
    "text": "and",
    "start": "161360",
    "end": "161920"
  },
  {
    "text": "by computers are fast i mean uh the",
    "start": "161920",
    "end": "164160"
  },
  {
    "text": "latency is still",
    "start": "164160",
    "end": "165519"
  },
  {
    "text": "fine it's acceptable especially for a",
    "start": "165519",
    "end": "166879"
  },
  {
    "text": "banking product people don't expect to",
    "start": "166879",
    "end": "168239"
  },
  {
    "text": "get their balance in five milliseconds",
    "start": "168239",
    "end": "169760"
  },
  {
    "text": "we're not a high frequency trading",
    "start": "169760",
    "end": "171120"
  },
  {
    "text": "company",
    "start": "171120",
    "end": "171760"
  },
  {
    "text": "um but instead people expect us to build",
    "start": "171760",
    "end": "174160"
  },
  {
    "text": "features really really quickly",
    "start": "174160",
    "end": "175440"
  },
  {
    "text": "and feature velocity is really important",
    "start": "175440",
    "end": "178080"
  },
  {
    "text": "and",
    "start": "178080",
    "end": "178480"
  },
  {
    "text": "an architecture like this actually",
    "start": "178480",
    "end": "179599"
  },
  {
    "text": "allows us to deploy hundreds of times a",
    "start": "179599",
    "end": "181280"
  },
  {
    "text": "day",
    "start": "181280",
    "end": "181760"
  },
  {
    "text": "to never bump into other people's code",
    "start": "181760",
    "end": "184000"
  },
  {
    "text": "and i think that was really awesome so",
    "start": "184000",
    "end": "185599"
  },
  {
    "text": "so i think this worked great for us",
    "start": "185599",
    "end": "188159"
  },
  {
    "text": "so yeah the lines are network rules and",
    "start": "188159",
    "end": "189760"
  },
  {
    "text": "then four-speed network policies",
    "start": "189760",
    "end": "191200"
  },
  {
    "text": "um just standard kubernetes network",
    "start": "191200",
    "end": "192560"
  },
  {
    "text": "policies and obviously the dots are",
    "start": "192560",
    "end": "194159"
  },
  {
    "text": "services",
    "start": "194159",
    "end": "196239"
  },
  {
    "text": "and managing these rules is actually",
    "start": "196239",
    "end": "197680"
  },
  {
    "text": "really easy um surprisingly easy",
    "start": "197680",
    "end": "199760"
  },
  {
    "text": "and that's kind of what i'm here to talk",
    "start": "199760",
    "end": "200800"
  },
  {
    "text": "about is how do we design a system",
    "start": "200800",
    "end": "203120"
  },
  {
    "text": "that manages rules like this so that",
    "start": "203120",
    "end": "204720"
  },
  {
    "text": "it's safe but also doesn't require that",
    "start": "204720",
    "end": "206400"
  },
  {
    "text": "toil",
    "start": "206400",
    "end": "207360"
  },
  {
    "text": "and if you start your cluster off with",
    "start": "207360",
    "end": "209040"
  },
  {
    "text": "default deny rules and you tightly scope",
    "start": "209040",
    "end": "211200"
  },
  {
    "text": "every single service every single policy",
    "start": "211200",
    "end": "212879"
  },
  {
    "text": "from day one",
    "start": "212879",
    "end": "213680"
  },
  {
    "text": "that's amazing and over time we'll have",
    "start": "213680",
    "end": "215440"
  },
  {
    "text": "to refactor it into something",
    "start": "215440",
    "end": "216959"
  },
  {
    "text": "that is more generic but that would work",
    "start": "216959",
    "end": "219200"
  },
  {
    "text": "great but we actually started off with",
    "start": "219200",
    "end": "220640"
  },
  {
    "text": "flannel",
    "start": "220640",
    "end": "221200"
  },
  {
    "text": "and we didn't even have network policies",
    "start": "221200",
    "end": "222799"
  },
  {
    "text": "so you kind of have to come to a system",
    "start": "222799",
    "end": "224560"
  },
  {
    "text": "that",
    "start": "224560",
    "end": "224879"
  },
  {
    "text": "already looks like this you just don't",
    "start": "224879",
    "end": "226959"
  },
  {
    "text": "know it yet and then you need to tightly",
    "start": "226959",
    "end": "229040"
  },
  {
    "text": "specify the whole thing with network",
    "start": "229040",
    "end": "230239"
  },
  {
    "text": "policies",
    "start": "230239",
    "end": "230959"
  },
  {
    "text": "and that was really hard and keeping",
    "start": "230959",
    "end": "233120"
  },
  {
    "text": "that up to date is also really hard",
    "start": "233120",
    "end": "236640"
  },
  {
    "text": "so how do we get going on this well to",
    "start": "237760",
    "end": "240720"
  },
  {
    "text": "start with just to play around with the",
    "start": "240720",
    "end": "242000"
  },
  {
    "text": "idea of network policies and what the",
    "start": "242000",
    "end": "243599"
  },
  {
    "text": "power might be for us",
    "start": "243599",
    "end": "244879"
  },
  {
    "text": "uh we did some really basic things so",
    "start": "244879",
    "end": "246560"
  },
  {
    "text": "for new services we did name space",
    "start": "246560",
    "end": "248879"
  },
  {
    "text": "isolation essentially only allowing",
    "start": "248879",
    "end": "250400"
  },
  {
    "text": "traffic from the same name space",
    "start": "250400",
    "end": "252959"
  },
  {
    "text": "the reason we needed this for new",
    "start": "252959",
    "end": "254080"
  },
  {
    "text": "services is that we didn't have a way of",
    "start": "254080",
    "end": "255439"
  },
  {
    "text": "proving that it was safe for old",
    "start": "255439",
    "end": "256639"
  },
  {
    "text": "services so we just thought we'd do it",
    "start": "256639",
    "end": "258160"
  },
  {
    "text": "from now on",
    "start": "258160",
    "end": "259040"
  },
  {
    "text": "and then fix issues to their eyes but if",
    "start": "259040",
    "end": "260959"
  },
  {
    "text": "an issue occurs on a new service",
    "start": "260959",
    "end": "262639"
  },
  {
    "text": "then it's usually called before it",
    "start": "262639",
    "end": "263840"
  },
  {
    "text": "affects customers",
    "start": "263840",
    "end": "266400"
  },
  {
    "text": "so the problem with this is that most of",
    "start": "266400",
    "end": "268000"
  },
  {
    "text": "our compete was actually in the same",
    "start": "268000",
    "end": "269280"
  },
  {
    "text": "name space we didn't have team name",
    "start": "269280",
    "end": "270960"
  },
  {
    "text": "space separation for various reasons",
    "start": "270960",
    "end": "272960"
  },
  {
    "text": "um so it doesn't really give a lot of",
    "start": "272960",
    "end": "274560"
  },
  {
    "text": "security value this was kind of a test",
    "start": "274560",
    "end": "276080"
  },
  {
    "text": "run",
    "start": "276080",
    "end": "276720"
  },
  {
    "text": "and this isn't just a security problem",
    "start": "276720",
    "end": "279040"
  },
  {
    "text": "it's also a monitoring problem you don't",
    "start": "279040",
    "end": "280639"
  },
  {
    "text": "actually know",
    "start": "280639",
    "end": "281440"
  },
  {
    "text": "what connections are happening",
    "start": "281440",
    "end": "282400"
  },
  {
    "text": "internally you're not able to secure it",
    "start": "282400",
    "end": "283919"
  },
  {
    "text": "because you don't know what they are",
    "start": "283919",
    "end": "285520"
  },
  {
    "text": "and as you saw in the diagram before",
    "start": "285520",
    "end": "288000"
  },
  {
    "text": "it's clearly complex it's clearly",
    "start": "288000",
    "end": "289440"
  },
  {
    "text": "something that's going to be difficult",
    "start": "289440",
    "end": "290479"
  },
  {
    "text": "to determine",
    "start": "290479",
    "end": "291520"
  },
  {
    "text": "accurately but from a security and",
    "start": "291520",
    "end": "294800"
  },
  {
    "text": "regulation perspective the primary",
    "start": "294800",
    "end": "296240"
  },
  {
    "text": "problem is",
    "start": "296240",
    "end": "296960"
  },
  {
    "text": "there's a lot of services that can move",
    "start": "296960",
    "end": "298240"
  },
  {
    "text": "money you know we're a bank there's a",
    "start": "298240",
    "end": "299520"
  },
  {
    "text": "lot of different ways that money can be",
    "start": "299520",
    "end": "300720"
  },
  {
    "text": "moved",
    "start": "300720",
    "end": "301440"
  },
  {
    "text": "and um lots of services could talk to",
    "start": "301440",
    "end": "304000"
  },
  {
    "text": "those services even though they're not",
    "start": "304000",
    "end": "304960"
  },
  {
    "text": "supposed to and that's a huge concern",
    "start": "304960",
    "end": "306160"
  },
  {
    "text": "for us as a security team it's also a",
    "start": "306160",
    "end": "307759"
  },
  {
    "text": "huge primary concern for regulators",
    "start": "307759",
    "end": "309759"
  },
  {
    "text": "you know you want to be showing some",
    "start": "309759",
    "end": "310880"
  },
  {
    "text": "isolation between things that handle",
    "start": "310880",
    "end": "313520"
  },
  {
    "text": "uh employee management and things that",
    "start": "313520",
    "end": "315520"
  },
  {
    "text": "handle money interviews",
    "start": "315520",
    "end": "316880"
  },
  {
    "text": "so that was a big concern and solving it",
    "start": "316880",
    "end": "318479"
  },
  {
    "text": "was kind of the top priority at the time",
    "start": "318479",
    "end": "320960"
  },
  {
    "text": "and instead of just identifying a list",
    "start": "320960",
    "end": "322560"
  },
  {
    "text": "of services that needed",
    "start": "322560",
    "end": "324000"
  },
  {
    "text": "high security that's a list that becomes",
    "start": "324000",
    "end": "326000"
  },
  {
    "text": "stale we kind of wanted to think",
    "start": "326000",
    "end": "328560"
  },
  {
    "text": "what's the security that we want to",
    "start": "328560",
    "end": "330639"
  },
  {
    "text": "attain what's the strict controls that",
    "start": "330639",
    "end": "332240"
  },
  {
    "text": "we want",
    "start": "332240",
    "end": "332880"
  },
  {
    "text": "and then can we make it generic and",
    "start": "332880",
    "end": "334720"
  },
  {
    "text": "automatic and manageable enough that we",
    "start": "334720",
    "end": "336639"
  },
  {
    "text": "can just apply to all services you know",
    "start": "336639",
    "end": "338080"
  },
  {
    "text": "why",
    "start": "338080",
    "end": "338720"
  },
  {
    "text": "why only have a few high security",
    "start": "338720",
    "end": "340720"
  },
  {
    "text": "services why not just treat",
    "start": "340720",
    "end": "341919"
  },
  {
    "text": "all your services like they are really",
    "start": "341919",
    "end": "344000"
  },
  {
    "text": "dangerous and that actually means that",
    "start": "344000",
    "end": "345520"
  },
  {
    "text": "we don't have to maintain really",
    "start": "345520",
    "end": "347039"
  },
  {
    "text": "accurate lists of you know which",
    "start": "347039",
    "end": "348479"
  },
  {
    "text": "services do scary stuff and which don't",
    "start": "348479",
    "end": "350240"
  },
  {
    "text": "and",
    "start": "350240",
    "end": "350720"
  },
  {
    "text": "that's where vulnerabilities could",
    "start": "350720",
    "end": "351759"
  },
  {
    "text": "really arise from if we got that wrong",
    "start": "351759",
    "end": "355199"
  },
  {
    "text": "so we wanted total peace of mind with a",
    "start": "355280",
    "end": "357120"
  },
  {
    "text": "generic solution that applies to all",
    "start": "357120",
    "end": "358479"
  },
  {
    "text": "services",
    "start": "358479",
    "end": "360960"
  },
  {
    "text": "so we started to think about how this",
    "start": "361360",
    "end": "364160"
  },
  {
    "text": "might look like by doing a single really",
    "start": "364160",
    "end": "365840"
  },
  {
    "text": "strict network policy and that applied",
    "start": "365840",
    "end": "367360"
  },
  {
    "text": "to our banking ledger which is kind of",
    "start": "367360",
    "end": "368880"
  },
  {
    "text": "the core",
    "start": "368880",
    "end": "369600"
  },
  {
    "text": "description of all transactions that",
    "start": "369600",
    "end": "371280"
  },
  {
    "text": "fundamentally occurred across the whole",
    "start": "371280",
    "end": "372960"
  },
  {
    "text": "business so",
    "start": "372960",
    "end": "373840"
  },
  {
    "text": "that's a really important service and",
    "start": "373840",
    "end": "375520"
  },
  {
    "text": "it's the kind of service that can",
    "start": "375520",
    "end": "376560"
  },
  {
    "text": "literally invent money out of min air by",
    "start": "376560",
    "end": "378319"
  },
  {
    "text": "out of thin air if you can get it wrong",
    "start": "378319",
    "end": "380000"
  },
  {
    "text": "so um we obviously wanted to restrict",
    "start": "380000",
    "end": "382479"
  },
  {
    "text": "that as much as possible and it actually",
    "start": "382479",
    "end": "383919"
  },
  {
    "text": "worked fine um",
    "start": "383919",
    "end": "384880"
  },
  {
    "text": "it's rolled out safely and it worked",
    "start": "384880",
    "end": "386560"
  },
  {
    "text": "fine for a long time but we didn't have",
    "start": "386560",
    "end": "388400"
  },
  {
    "text": "any illusions that we could scale this",
    "start": "388400",
    "end": "389759"
  },
  {
    "text": "to",
    "start": "389759",
    "end": "390000"
  },
  {
    "text": "another thousand services uh first of",
    "start": "390000",
    "end": "392240"
  },
  {
    "text": "all one of the problems is that the",
    "start": "392240",
    "end": "393360"
  },
  {
    "text": "owning team has to review every new",
    "start": "393360",
    "end": "394880"
  },
  {
    "text": "client",
    "start": "394880",
    "end": "395600"
  },
  {
    "text": "so this is another policy that literally",
    "start": "395600",
    "end": "397120"
  },
  {
    "text": "has a list of every label of the",
    "start": "397120",
    "end": "398639"
  },
  {
    "text": "services that i'll have to call it",
    "start": "398639",
    "end": "400400"
  },
  {
    "text": "um and that list lives with the other",
    "start": "400400",
    "end": "403039"
  },
  {
    "text": "manifests for the service which means",
    "start": "403039",
    "end": "404400"
  },
  {
    "text": "it's owned by the owning team",
    "start": "404400",
    "end": "405759"
  },
  {
    "text": "and they have to review everything and",
    "start": "405759",
    "end": "406880"
  },
  {
    "text": "they actually wanted to better review",
    "start": "406880",
    "end": "408160"
  },
  {
    "text": "everything so this was helpful",
    "start": "408160",
    "end": "409520"
  },
  {
    "text": "but most of the time teams don't care",
    "start": "409520",
    "end": "411759"
  },
  {
    "text": "about new callers their services",
    "start": "411759",
    "end": "413599"
  },
  {
    "text": "um you know they would be spending a lot",
    "start": "413599",
    "end": "414880"
  },
  {
    "text": "of time reviewing that in some cases so",
    "start": "414880",
    "end": "416720"
  },
  {
    "text": "that's that's not very helpful in all",
    "start": "416720",
    "end": "418000"
  },
  {
    "text": "cases we're not to be optional",
    "start": "418000",
    "end": "420080"
  },
  {
    "text": "another problem is that um this policy",
    "start": "420080",
    "end": "423280"
  },
  {
    "text": "also has to allow things like prometheus",
    "start": "423280",
    "end": "424880"
  },
  {
    "text": "and upstreams that have to call",
    "start": "424880",
    "end": "426000"
  },
  {
    "text": "everything",
    "start": "426000",
    "end": "426800"
  },
  {
    "text": "uh and that's not today we want to",
    "start": "426800",
    "end": "428160"
  },
  {
    "text": "duplicate everywhere and also we were",
    "start": "428160",
    "end": "430080"
  },
  {
    "text": "just maintaining this manually",
    "start": "430080",
    "end": "431520"
  },
  {
    "text": "uh we had some pretty basic static",
    "start": "431520",
    "end": "432960"
  },
  {
    "text": "analysis to remind engineers to update",
    "start": "432960",
    "end": "434800"
  },
  {
    "text": "it",
    "start": "434800",
    "end": "435280"
  },
  {
    "text": "but like fundamentally this was a pretty",
    "start": "435280",
    "end": "437759"
  },
  {
    "text": "scary manual operation",
    "start": "437759",
    "end": "440000"
  },
  {
    "text": "we needed to move to a declarative model",
    "start": "440000",
    "end": "441759"
  },
  {
    "text": "for rules by which i mean",
    "start": "441759",
    "end": "443440"
  },
  {
    "text": "the fact that a service calls the ledger",
    "start": "443440",
    "end": "445039"
  },
  {
    "text": "is not really a property of the ledger",
    "start": "445039",
    "end": "446720"
  },
  {
    "text": "it's a property of the of the calling",
    "start": "446720",
    "end": "448319"
  },
  {
    "text": "service we want to identify that",
    "start": "448319",
    "end": "449919"
  },
  {
    "text": "securely and we want to be able to",
    "start": "449919",
    "end": "451199"
  },
  {
    "text": "review it in some cases but it still",
    "start": "451199",
    "end": "452960"
  },
  {
    "text": "should live",
    "start": "452960",
    "end": "453680"
  },
  {
    "text": "with the calling service in the monavie",
    "start": "453680",
    "end": "455360"
  },
  {
    "text": "code and if you maintain it as a",
    "start": "455360",
    "end": "457199"
  },
  {
    "text": "property of the ledger you lead to all",
    "start": "457199",
    "end": "458639"
  },
  {
    "text": "kinds of educations",
    "start": "458639",
    "end": "459680"
  },
  {
    "text": "the primary one being rollbacks so if",
    "start": "459680",
    "end": "462240"
  },
  {
    "text": "you roll back the ledger to before",
    "start": "462240",
    "end": "464400"
  },
  {
    "text": "one of the clients is allowed to access",
    "start": "464400",
    "end": "465840"
  },
  {
    "text": "it but you don't roll back the client",
    "start": "465840",
    "end": "467759"
  },
  {
    "text": "you have an instant and that's very",
    "start": "467759",
    "end": "469360"
  },
  {
    "text": "scary and that didn't even happen",
    "start": "469360",
    "end": "471199"
  },
  {
    "text": "um so it makes this very very difficult",
    "start": "471199",
    "end": "474080"
  },
  {
    "text": "to deal with",
    "start": "474080",
    "end": "475360"
  },
  {
    "text": "we also just want to shield our",
    "start": "475360",
    "end": "476639"
  },
  {
    "text": "engineers from working with these kinds",
    "start": "476639",
    "end": "477840"
  },
  {
    "text": "of policies",
    "start": "477840",
    "end": "478960"
  },
  {
    "text": "we want to give them very thin keyholes",
    "start": "478960",
    "end": "480560"
  },
  {
    "text": "with which to interact with kubernetes",
    "start": "480560",
    "end": "482319"
  },
  {
    "text": "not writing arbitrary policy ammo files",
    "start": "482319",
    "end": "485039"
  },
  {
    "text": "the information we need from an engineer",
    "start": "485039",
    "end": "486479"
  },
  {
    "text": "is",
    "start": "486479",
    "end": "486800"
  },
  {
    "text": "a b we don't even editing a manifest to",
    "start": "486800",
    "end": "489039"
  },
  {
    "text": "assert something as simple as that",
    "start": "489039",
    "end": "491199"
  },
  {
    "text": "and lastly we didn't really have a way",
    "start": "491199",
    "end": "492400"
  },
  {
    "text": "to test policies like this so when we",
    "start": "492400",
    "end": "494319"
  },
  {
    "text": "rolled out this",
    "start": "494319",
    "end": "495120"
  },
  {
    "text": "policy we checked it manually countless",
    "start": "495120",
    "end": "497520"
  },
  {
    "text": "different ways thinking about every",
    "start": "497520",
    "end": "498800"
  },
  {
    "text": "different way that's something we could",
    "start": "498800",
    "end": "499599"
  },
  {
    "text": "call the ledger",
    "start": "499599",
    "end": "500319"
  },
  {
    "text": "i would check it against metrics and uh",
    "start": "500319",
    "end": "502960"
  },
  {
    "text": "and then we basically just roll it out",
    "start": "502960",
    "end": "504400"
  },
  {
    "text": "to one pod",
    "start": "504400",
    "end": "505199"
  },
  {
    "text": "and check the connection errors now",
    "start": "505199",
    "end": "506479"
  },
  {
    "text": "those errors would have been retried so",
    "start": "506479",
    "end": "508240"
  },
  {
    "text": "we knew that was essentially safe but we",
    "start": "508240",
    "end": "510160"
  },
  {
    "text": "can't do that for a thousand more",
    "start": "510160",
    "end": "511280"
  },
  {
    "text": "services and that wouldn't always be",
    "start": "511280",
    "end": "512640"
  },
  {
    "text": "safe in all instances",
    "start": "512640",
    "end": "515760"
  },
  {
    "text": "so the first step towards moving towards",
    "start": "516320",
    "end": "518640"
  },
  {
    "text": "a generic solution is to take the basic",
    "start": "518640",
    "end": "520800"
  },
  {
    "text": "static analysis that we had built",
    "start": "520800",
    "end": "522479"
  },
  {
    "text": "and make it really generic and as",
    "start": "522479",
    "end": "525120"
  },
  {
    "text": "accurate as possible",
    "start": "525120",
    "end": "526000"
  },
  {
    "text": "and we turned this into a tool called",
    "start": "526000",
    "end": "527040"
  },
  {
    "text": "rbc map um sadly it's kind of very",
    "start": "527040",
    "end": "529680"
  },
  {
    "text": "specific to the way that",
    "start": "529680",
    "end": "531279"
  },
  {
    "text": "our rpcs look like in our platform but",
    "start": "531279",
    "end": "533040"
  },
  {
    "text": "i'm sure that you could write the same",
    "start": "533040",
    "end": "534000"
  },
  {
    "text": "thing for grpc",
    "start": "534000",
    "end": "535120"
  },
  {
    "text": "obviously mac would scan all of the",
    "start": "535120",
    "end": "536800"
  },
  {
    "text": "imported packages for a service",
    "start": "536800",
    "end": "538320"
  },
  {
    "text": "and look for things that look like rpcs",
    "start": "538320",
    "end": "539920"
  },
  {
    "text": "it would have a list of exclusions for",
    "start": "539920",
    "end": "541279"
  },
  {
    "text": "certain edge cases",
    "start": "541279",
    "end": "542880"
  },
  {
    "text": "and then it will turn them into files",
    "start": "542880",
    "end": "544160"
  },
  {
    "text": "called rule files",
    "start": "544160",
    "end": "546160"
  },
  {
    "text": "and the reason that files are really",
    "start": "546160",
    "end": "547680"
  },
  {
    "text": "awesome way of describing these links",
    "start": "547680",
    "end": "549040"
  },
  {
    "text": "between services instead of like a list",
    "start": "549040",
    "end": "550880"
  },
  {
    "text": "of services in a yaml file or whatever",
    "start": "550880",
    "end": "552480"
  },
  {
    "text": "else",
    "start": "552480",
    "end": "553040"
  },
  {
    "text": "is first of all that you can use code",
    "start": "553040",
    "end": "554480"
  },
  {
    "text": "owners so a service like uh the ledger",
    "start": "554480",
    "end": "557279"
  },
  {
    "text": "you can essentially write a code owner",
    "start": "557279",
    "end": "558959"
  },
  {
    "text": "on all uh the rules that allow something",
    "start": "558959",
    "end": "561760"
  },
  {
    "text": "to call the ledger and they would have",
    "start": "561760",
    "end": "562800"
  },
  {
    "text": "the ability to then review new callers",
    "start": "562800",
    "end": "564320"
  },
  {
    "text": "but that's now optional",
    "start": "564320",
    "end": "566240"
  },
  {
    "text": "um second of all you can use tools like",
    "start": "566240",
    "end": "568480"
  },
  {
    "text": "find and grep to look through your whole",
    "start": "568480",
    "end": "570480"
  },
  {
    "text": "code base",
    "start": "570480",
    "end": "571200"
  },
  {
    "text": "and determine what's allowed what",
    "start": "571200",
    "end": "572800"
  },
  {
    "text": "connections are occurring that's really",
    "start": "572800",
    "end": "574320"
  },
  {
    "text": "useful",
    "start": "574320",
    "end": "575279"
  },
  {
    "text": "um so i really like this approach of",
    "start": "575279",
    "end": "576800"
  },
  {
    "text": "using files just empty files",
    "start": "576800",
    "end": "578480"
  },
  {
    "text": "and down the line we can even decide to",
    "start": "578480",
    "end": "580160"
  },
  {
    "text": "add metadata to these files so the files",
    "start": "580160",
    "end": "581839"
  },
  {
    "text": "could actually have",
    "start": "581839",
    "end": "582640"
  },
  {
    "text": "some kind of text format inside them",
    "start": "582640",
    "end": "584080"
  },
  {
    "text": "that would do things like allow",
    "start": "584080",
    "end": "585120"
  },
  {
    "text": "endpoints",
    "start": "585120",
    "end": "585920"
  },
  {
    "text": "and specific endpoints to be used so",
    "start": "585920",
    "end": "587279"
  },
  {
    "text": "that is really powerful i really like it",
    "start": "587279",
    "end": "589279"
  },
  {
    "text": "um what does this actually mean in",
    "start": "589279",
    "end": "590800"
  },
  {
    "text": "kubernetes land uh well",
    "start": "590800",
    "end": "592959"
  },
  {
    "text": "we have a deployment pipeline at this",
    "start": "592959",
    "end": "594480"
  },
  {
    "text": "company which allows us to take",
    "start": "594480",
    "end": "596800"
  },
  {
    "text": "the code in the monorepo and manifest in",
    "start": "596800",
    "end": "598640"
  },
  {
    "text": "the monorepo package them up into a",
    "start": "598640",
    "end": "600240"
  },
  {
    "text": "docker image and package them into the",
    "start": "600240",
    "end": "601680"
  },
  {
    "text": "kubernetes manifest and then deploy them",
    "start": "601680",
    "end": "603360"
  },
  {
    "text": "right so",
    "start": "603360",
    "end": "604079"
  },
  {
    "text": "we decided that we wanted to compile",
    "start": "604079",
    "end": "605680"
  },
  {
    "text": "these rule files into kubernetes pod",
    "start": "605680",
    "end": "608160"
  },
  {
    "text": "labels so something like service dot led",
    "start": "608160",
    "end": "609920"
  },
  {
    "text": "to the rule",
    "start": "609920",
    "end": "610560"
  },
  {
    "text": "becomes bank.com egress s ledger equals",
    "start": "610560",
    "end": "613680"
  },
  {
    "text": "true",
    "start": "613680",
    "end": "614880"
  },
  {
    "text": "and having labels to determine all the",
    "start": "614880",
    "end": "616959"
  },
  {
    "text": "dependencies of a service",
    "start": "616959",
    "end": "618399"
  },
  {
    "text": "is super useful first of all you can",
    "start": "618399",
    "end": "620000"
  },
  {
    "text": "just list all pods that call the ledger",
    "start": "620000",
    "end": "622000"
  },
  {
    "text": "in kubernetes which is really useful",
    "start": "622000",
    "end": "624240"
  },
  {
    "text": "very fun to do",
    "start": "624240",
    "end": "626480"
  },
  {
    "text": "you can also read a pod label and",
    "start": "626480",
    "end": "628320"
  },
  {
    "text": "determine all of its dependencies which",
    "start": "628320",
    "end": "629760"
  },
  {
    "text": "is helpful",
    "start": "629760",
    "end": "630800"
  },
  {
    "text": "and you can use it programmatically so",
    "start": "630800",
    "end": "632240"
  },
  {
    "text": "for example our envoy control plane",
    "start": "632240",
    "end": "634000"
  },
  {
    "text": "uh instead of giving you access or",
    "start": "634000",
    "end": "636399"
  },
  {
    "text": "giving you configuration for all",
    "start": "636399",
    "end": "637839"
  },
  {
    "text": "services and giving you a lot of",
    "start": "637839",
    "end": "639120"
  },
  {
    "text": "expensive endpoint updates for that",
    "start": "639120",
    "end": "640880"
  },
  {
    "text": "instead we just give you the ones that",
    "start": "640880",
    "end": "642480"
  },
  {
    "text": "the labels say you're allowed to call",
    "start": "642480",
    "end": "644480"
  },
  {
    "text": "and that's a massive performance",
    "start": "644480",
    "end": "645760"
  },
  {
    "text": "optimization you reduce the amount of",
    "start": "645760",
    "end": "647440"
  },
  {
    "text": "envoy endpoints that you're sending or",
    "start": "647440",
    "end": "648880"
  },
  {
    "text": "like a thousand times",
    "start": "648880",
    "end": "650240"
  },
  {
    "text": "um and that massively improves latency",
    "start": "650240",
    "end": "652640"
  },
  {
    "text": "it's not security control necessarily",
    "start": "652640",
    "end": "654480"
  },
  {
    "text": "but it is very effective performance",
    "start": "654480",
    "end": "656240"
  },
  {
    "text": "control",
    "start": "656240",
    "end": "658079"
  },
  {
    "text": "but when things get interesting is",
    "start": "658079",
    "end": "660000"
  },
  {
    "text": "obviously now that we have these labels",
    "start": "660000",
    "end": "661440"
  },
  {
    "text": "we can use them in selectors in network",
    "start": "661440",
    "end": "663120"
  },
  {
    "text": "policies",
    "start": "663120",
    "end": "663760"
  },
  {
    "text": "and these network policies are now so",
    "start": "663760",
    "end": "665600"
  },
  {
    "text": "simple they're almost identical for",
    "start": "665600",
    "end": "667360"
  },
  {
    "text": "every single service",
    "start": "667360",
    "end": "668800"
  },
  {
    "text": "instead of listing labels that are",
    "start": "668800",
    "end": "670959"
  },
  {
    "text": "allowed to call a given service",
    "start": "670959",
    "end": "672399"
  },
  {
    "text": "instead just select on all the pods that",
    "start": "672399",
    "end": "674320"
  },
  {
    "text": "have a label saying yep",
    "start": "674320",
    "end": "675760"
  },
  {
    "text": "i can call the ledger and it makes the",
    "start": "675760",
    "end": "678079"
  },
  {
    "text": "policy",
    "start": "678079",
    "end": "678800"
  },
  {
    "text": "really simple and",
    "start": "678800",
    "end": "682000"
  },
  {
    "text": "the other trick that we used is every",
    "start": "682000",
    "end": "684000"
  },
  {
    "text": "part that gets one of these network",
    "start": "684000",
    "end": "685200"
  },
  {
    "text": "policies which obviously at first is",
    "start": "685200",
    "end": "686560"
  },
  {
    "text": "none of them and eventually becomes all",
    "start": "686560",
    "end": "687839"
  },
  {
    "text": "of them",
    "start": "687839",
    "end": "688399"
  },
  {
    "text": "we also give it a label just network",
    "start": "688399",
    "end": "690160"
  },
  {
    "text": "policy true um and now we have a label",
    "start": "690160",
    "end": "692720"
  },
  {
    "text": "for everything that already has a",
    "start": "692720",
    "end": "694160"
  },
  {
    "text": "network policy and that's",
    "start": "694160",
    "end": "695279"
  },
  {
    "text": "super powerful because the first little",
    "start": "695279",
    "end": "697839"
  },
  {
    "text": "policy for a pod is dangerous it",
    "start": "697839",
    "end": "699440"
  },
  {
    "text": "restricts its inbound traffic",
    "start": "699440",
    "end": "701120"
  },
  {
    "text": "but the second network policy for a pod",
    "start": "701120",
    "end": "703360"
  },
  {
    "text": "can only increase its traffic",
    "start": "703360",
    "end": "705040"
  },
  {
    "text": "so it's always safe to write policies on",
    "start": "705040",
    "end": "707040"
  },
  {
    "text": "things that already have policies that's",
    "start": "707040",
    "end": "708480"
  },
  {
    "text": "a guaranteed safe operation",
    "start": "708480",
    "end": "710480"
  },
  {
    "text": "and that means we can write global",
    "start": "710480",
    "end": "711760"
  },
  {
    "text": "policies so we can select on every pod",
    "start": "711760",
    "end": "713920"
  },
  {
    "text": "that already has a network policy",
    "start": "713920",
    "end": "715360"
  },
  {
    "text": "and do things like allow prometheus um",
    "start": "715360",
    "end": "717519"
  },
  {
    "text": "and that's always going to work",
    "start": "717519",
    "end": "719200"
  },
  {
    "text": "the other advantages is every policy is",
    "start": "719200",
    "end": "721600"
  },
  {
    "text": "going to select on that label",
    "start": "721600",
    "end": "722959"
  },
  {
    "text": "which means that if you remove the label",
    "start": "722959",
    "end": "725200"
  },
  {
    "text": "you're going to drop your port out of",
    "start": "725200",
    "end": "726639"
  },
  {
    "text": "every policy it's like removing all the",
    "start": "726639",
    "end": "728240"
  },
  {
    "text": "policies in the entire platform but just",
    "start": "728240",
    "end": "729760"
  },
  {
    "text": "for that pod",
    "start": "729760",
    "end": "730800"
  },
  {
    "text": "and deleting metal products in general",
    "start": "730800",
    "end": "732240"
  },
  {
    "text": "is very dangerous but deleting this",
    "start": "732240",
    "end": "733920"
  },
  {
    "text": "label is always safe",
    "start": "733920",
    "end": "735120"
  },
  {
    "text": "this is really useful for debugging uh",
    "start": "735120",
    "end": "737920"
  },
  {
    "text": "obviously some",
    "start": "737920",
    "end": "738639"
  },
  {
    "text": "services do unusual things um they have",
    "start": "738639",
    "end": "741920"
  },
  {
    "text": "weird inbounds they have weird ports",
    "start": "741920",
    "end": "743279"
  },
  {
    "text": "they have node ports maybe",
    "start": "743279",
    "end": "744800"
  },
  {
    "text": "um and in those cases we actually had",
    "start": "744800",
    "end": "746880"
  },
  {
    "text": "customized patches so the policy that",
    "start": "746880",
    "end": "748320"
  },
  {
    "text": "you're seeing here",
    "start": "748320",
    "end": "749200"
  },
  {
    "text": "would almost never actually be written",
    "start": "749200",
    "end": "751040"
  },
  {
    "text": "down there'd be a base manifest and it",
    "start": "751040",
    "end": "752720"
  },
  {
    "text": "would apply to all other services",
    "start": "752720",
    "end": "754160"
  },
  {
    "text": "but some services would have patches on",
    "start": "754160",
    "end": "755760"
  },
  {
    "text": "top of that allowing extra ports or",
    "start": "755760",
    "end": "757360"
  },
  {
    "text": "allowing extra",
    "start": "757360",
    "end": "758240"
  },
  {
    "text": "labels or whatever else um and what's so",
    "start": "758240",
    "end": "760480"
  },
  {
    "text": "cool about that",
    "start": "760480",
    "end": "761360"
  },
  {
    "text": "is that you now have a programmatically",
    "start": "761360",
    "end": "763360"
  },
  {
    "text": "describable",
    "start": "763360",
    "end": "764480"
  },
  {
    "text": "um list of all the services that are",
    "start": "764480",
    "end": "766320"
  },
  {
    "text": "weird and anyone who like me has had to",
    "start": "766320",
    "end": "768720"
  },
  {
    "text": "manage a lot of microservices can attest",
    "start": "768720",
    "end": "770399"
  },
  {
    "text": "to the fact",
    "start": "770399",
    "end": "771279"
  },
  {
    "text": "that it's not really about the the",
    "start": "771279",
    "end": "773360"
  },
  {
    "text": "thousand services that all look the same",
    "start": "773360",
    "end": "775120"
  },
  {
    "text": "it's about the 300 services that do",
    "start": "775120",
    "end": "776720"
  },
  {
    "text": "weird stuff in this project i spent 95",
    "start": "776720",
    "end": "779440"
  },
  {
    "text": "of my time worrying about the weird",
    "start": "779440",
    "end": "780639"
  },
  {
    "text": "services um so having those written down",
    "start": "780639",
    "end": "783760"
  },
  {
    "text": "in a programmatic format is so powerful",
    "start": "783760",
    "end": "786079"
  },
  {
    "text": "and i would really recommend that 21.",
    "start": "786079",
    "end": "789440"
  },
  {
    "text": "so we were now ready to write these for",
    "start": "789680",
    "end": "791440"
  },
  {
    "text": "every service and the question was how",
    "start": "791440",
    "end": "793519"
  },
  {
    "text": "do we roll that out safely",
    "start": "793519",
    "end": "800160"
  },
  {
    "text": "so the model works the source of",
    "start": "800160",
    "end": "802079"
  },
  {
    "text": "information the rule files is",
    "start": "802079",
    "end": "803680"
  },
  {
    "text": "relatively reliable um but not all",
    "start": "803680",
    "end": "805839"
  },
  {
    "text": "inbound connections look like rbcs not",
    "start": "805839",
    "end": "807600"
  },
  {
    "text": "all of them are even in the code base",
    "start": "807600",
    "end": "809279"
  },
  {
    "text": "and even within the code base they're",
    "start": "809279",
    "end": "810800"
  },
  {
    "text": "going to be exceptions that rpc map",
    "start": "810800",
    "end": "813040"
  },
  {
    "text": "can't",
    "start": "813040",
    "end": "813440"
  },
  {
    "text": "determine things like if i build the",
    "start": "813440",
    "end": "815920"
  },
  {
    "text": "service name",
    "start": "815920",
    "end": "816800"
  },
  {
    "text": "programmatically in some way something",
    "start": "816800",
    "end": "818560"
  },
  {
    "text": "weird like that um",
    "start": "818560",
    "end": "820399"
  },
  {
    "text": "using metrics from envoy get us some of",
    "start": "820399",
    "end": "822240"
  },
  {
    "text": "the way there uh but not everything goes",
    "start": "822240",
    "end": "824320"
  },
  {
    "text": "through envoy",
    "start": "824320",
    "end": "825120"
  },
  {
    "text": "our staging environment gets some of the",
    "start": "825120",
    "end": "826560"
  },
  {
    "text": "way there but not everything's going to",
    "start": "826560",
    "end": "827600"
  },
  {
    "text": "get caught in staging",
    "start": "827600",
    "end": "828720"
  },
  {
    "text": "it's not acceptable to um just hope that",
    "start": "828720",
    "end": "831440"
  },
  {
    "text": "the instance that",
    "start": "831440",
    "end": "832320"
  },
  {
    "text": "these problems cause uh won't be that",
    "start": "832320",
    "end": "834320"
  },
  {
    "text": "bad you have to plan for them and you",
    "start": "834320",
    "end": "835839"
  },
  {
    "text": "have to explicitly say no we're going to",
    "start": "835839",
    "end": "837360"
  },
  {
    "text": "catch all issues we're going to prove",
    "start": "837360",
    "end": "838480"
  },
  {
    "text": "this to ourselves",
    "start": "838480",
    "end": "839760"
  },
  {
    "text": "um what we wanted was a war mode and it",
    "start": "839760",
    "end": "842320"
  },
  {
    "text": "would be awesome if metal prices have",
    "start": "842320",
    "end": "843600"
  },
  {
    "text": "this kind of feature by default but",
    "start": "843600",
    "end": "845120"
  },
  {
    "text": "you can kind of hack it together and by",
    "start": "845120",
    "end": "847199"
  },
  {
    "text": "one mode i mean",
    "start": "847199",
    "end": "848240"
  },
  {
    "text": "you want to know what a policy would",
    "start": "848240",
    "end": "850079"
  },
  {
    "text": "drop or what",
    "start": "850079",
    "end": "851440"
  },
  {
    "text": "packets would be getting dropped with",
    "start": "851440",
    "end": "852720"
  },
  {
    "text": "your current set of policies but without",
    "start": "852720",
    "end": "854560"
  },
  {
    "text": "actually being dropped this is actually",
    "start": "854560",
    "end": "856240"
  },
  {
    "text": "really easy to do with calico",
    "start": "856240",
    "end": "857760"
  },
  {
    "text": "um you essentially want a policy that",
    "start": "857760",
    "end": "859760"
  },
  {
    "text": "runs last",
    "start": "859760",
    "end": "860800"
  },
  {
    "text": "after all other policies and therefore",
    "start": "860800",
    "end": "862800"
  },
  {
    "text": "packets will only reach it",
    "start": "862800",
    "end": "864240"
  },
  {
    "text": "if they are not already accepted and",
    "start": "864240",
    "end": "865839"
  },
  {
    "text": "they're going to be dropped and then in",
    "start": "865839",
    "end": "867279"
  },
  {
    "text": "that policy you want to",
    "start": "867279",
    "end": "868880"
  },
  {
    "text": "log which means it'll essentially go to",
    "start": "868880",
    "end": "870959"
  },
  {
    "text": "the kernel log a full description of the",
    "start": "870959",
    "end": "872399"
  },
  {
    "text": "packet that's been dropped",
    "start": "872399",
    "end": "873680"
  },
  {
    "text": "and you then want to allow the traffic",
    "start": "873680",
    "end": "875279"
  },
  {
    "text": "so what that means is all packets will",
    "start": "875279",
    "end": "877040"
  },
  {
    "text": "never be dropped but they'll always be",
    "start": "877040",
    "end": "878320"
  },
  {
    "text": "logged if they're going to be dropped",
    "start": "878320",
    "end": "880480"
  },
  {
    "text": "so we call that a dry run policy and in",
    "start": "880480",
    "end": "882800"
  },
  {
    "text": "calico that's very easy to write",
    "start": "882800",
    "end": "884880"
  },
  {
    "text": "we run this tool called cube ip tables",
    "start": "884880",
    "end": "886639"
  },
  {
    "text": "taylor it turns",
    "start": "886639",
    "end": "888399"
  },
  {
    "text": "it runs on every node it tails the",
    "start": "888399",
    "end": "890399"
  },
  {
    "text": "kernel logs and it turns these log lines",
    "start": "890399",
    "end": "892639"
  },
  {
    "text": "into",
    "start": "892639",
    "end": "893120"
  },
  {
    "text": "kubernetes events it turns them also",
    "start": "893120",
    "end": "894560"
  },
  {
    "text": "into metrics and that makes it really",
    "start": "894560",
    "end": "896720"
  },
  {
    "text": "easy to track",
    "start": "896720",
    "end": "898160"
  },
  {
    "text": "what packets weren't being allowed you",
    "start": "898160",
    "end": "900079"
  },
  {
    "text": "can basically get the slack message for",
    "start": "900079",
    "end": "901600"
  },
  {
    "text": "every single packet that gets dropped",
    "start": "901600",
    "end": "902800"
  },
  {
    "text": "which is really awesome",
    "start": "902800",
    "end": "904079"
  },
  {
    "text": "uh but where this goes wrong and where",
    "start": "904079",
    "end": "905600"
  },
  {
    "text": "this did go wrong is",
    "start": "905600",
    "end": "907279"
  },
  {
    "text": "if you log a lot of packets because you",
    "start": "907279",
    "end": "909600"
  },
  {
    "text": "roll out a really bad policy maybe",
    "start": "909600",
    "end": "911199"
  },
  {
    "text": "accidentally i did do this",
    "start": "911199",
    "end": "913199"
  },
  {
    "text": "um the kernel will be logging so much",
    "start": "913199",
    "end": "915760"
  },
  {
    "text": "that you can essentially take down",
    "start": "915760",
    "end": "916800"
  },
  {
    "text": "networking on that host",
    "start": "916800",
    "end": "918240"
  },
  {
    "text": "that is not a lot of fun and it's not",
    "start": "918240",
    "end": "920000"
  },
  {
    "text": "very easy to debug um we spent a long",
    "start": "920000",
    "end": "921920"
  },
  {
    "text": "time thinking this must be aws's fault",
    "start": "921920",
    "end": "923519"
  },
  {
    "text": "no it was not it was kind of my fault in",
    "start": "923519",
    "end": "925199"
  },
  {
    "text": "some sense um",
    "start": "925199",
    "end": "927360"
  },
  {
    "text": "so we started to think is logging",
    "start": "927360",
    "end": "929199"
  },
  {
    "text": "overkill like we don't need a log line",
    "start": "929199",
    "end": "931120"
  },
  {
    "text": "for every packet",
    "start": "931120",
    "end": "932240"
  },
  {
    "text": "we kind of just need to know the packets",
    "start": "932240",
    "end": "933839"
  },
  {
    "text": "are being dropped as long as you know",
    "start": "933839",
    "end": "936079"
  },
  {
    "text": "that a service is receiving traffic that",
    "start": "936079",
    "end": "938399"
  },
  {
    "text": "we haven't specified",
    "start": "938399",
    "end": "939680"
  },
  {
    "text": "you can usually figure out what the",
    "start": "939680",
    "end": "940720"
  },
  {
    "text": "reason is you can go and look at the",
    "start": "940720",
    "end": "941839"
  },
  {
    "text": "service what's weird about the service",
    "start": "941839",
    "end": "943279"
  },
  {
    "text": "where might ever be receiving traffic",
    "start": "943279",
    "end": "944639"
  },
  {
    "text": "from",
    "start": "944639",
    "end": "945040"
  },
  {
    "text": "that's unusual the rpc map wouldn't",
    "start": "945040",
    "end": "946800"
  },
  {
    "text": "notice and you could almost always",
    "start": "946800",
    "end": "948160"
  },
  {
    "text": "figure it out",
    "start": "948160",
    "end": "949199"
  },
  {
    "text": "um we didn't really need to know this",
    "start": "949199",
    "end": "951120"
  },
  {
    "text": "amount of information it's very helpful",
    "start": "951120",
    "end": "952800"
  },
  {
    "text": "to get things like source ip",
    "start": "952800",
    "end": "954240"
  },
  {
    "text": "and reports and stuff like that from the",
    "start": "954240",
    "end": "955680"
  },
  {
    "text": "packet information but most of the time",
    "start": "955680",
    "end": "957440"
  },
  {
    "text": "it's just",
    "start": "957440",
    "end": "958079"
  },
  {
    "text": "we need it only if you can't figure out",
    "start": "958079",
    "end": "959839"
  },
  {
    "text": "what's going on and that's rare",
    "start": "959839",
    "end": "962240"
  },
  {
    "text": "so we wanted to know how many packets",
    "start": "962240",
    "end": "963920"
  },
  {
    "text": "are hitting this policy being accepted",
    "start": "963920",
    "end": "965600"
  },
  {
    "text": "by this policy",
    "start": "965600",
    "end": "966639"
  },
  {
    "text": "and for what parts fortunately",
    "start": "966639",
    "end": "969759"
  },
  {
    "text": "this is possible with calico as well",
    "start": "969759",
    "end": "971279"
  },
  {
    "text": "because calico policies are just",
    "start": "971279",
    "end": "973440"
  },
  {
    "text": "ib tables rules right and ibtable's",
    "start": "973440",
    "end": "975519"
  },
  {
    "text": "rules have counters",
    "start": "975519",
    "end": "977120"
  },
  {
    "text": "and those counters can be scraped using",
    "start": "977120",
    "end": "979519"
  },
  {
    "text": "a prometheus exporter and we wrote one",
    "start": "979519",
    "end": "981120"
  },
  {
    "text": "of these it's called caloric accountant",
    "start": "981120",
    "end": "982720"
  },
  {
    "text": "it's going to essentially every time you",
    "start": "982720",
    "end": "984000"
  },
  {
    "text": "scrape it it'll do iptable save",
    "start": "984000",
    "end": "986000"
  },
  {
    "text": "it'll pass out the pack accounts and",
    "start": "986000",
    "end": "987759"
  },
  {
    "text": "it'll determine um",
    "start": "987759",
    "end": "989279"
  },
  {
    "text": "which chains and those correspond to",
    "start": "989279",
    "end": "990880"
  },
  {
    "text": "pods and which policies",
    "start": "990880",
    "end": "992959"
  },
  {
    "text": "um how many packets have they accepted",
    "start": "992959",
    "end": "995440"
  },
  {
    "text": "and then if you plot those as rates it's",
    "start": "995440",
    "end": "997040"
  },
  {
    "text": "very straightforward",
    "start": "997040",
    "end": "998720"
  },
  {
    "text": "um so you have to actually use the",
    "start": "998720",
    "end": "1000639"
  },
  {
    "text": "calico api a little bit",
    "start": "1000639",
    "end": "1002320"
  },
  {
    "text": "to sort of turn these uh names that you",
    "start": "1002320",
    "end": "1004720"
  },
  {
    "text": "see on the on the slide",
    "start": "1004720",
    "end": "1006079"
  },
  {
    "text": "back into pod names and back into policy",
    "start": "1006079",
    "end": "1007759"
  },
  {
    "text": "names that's pretty easy to do um",
    "start": "1007759",
    "end": "1010880"
  },
  {
    "text": "and then after that you essentially have",
    "start": "1010880",
    "end": "1013040"
  },
  {
    "text": "the rates for every policy",
    "start": "1013040",
    "end": "1014639"
  },
  {
    "text": "for every pod in your entire platform",
    "start": "1014639",
    "end": "1016240"
  },
  {
    "text": "and you also have the rates of package",
    "start": "1016240",
    "end": "1017519"
  },
  {
    "text": "that are actually being dropped that",
    "start": "1017519",
    "end": "1018639"
  },
  {
    "text": "haven't been accepted by any policy",
    "start": "1018639",
    "end": "1020720"
  },
  {
    "text": "and that is a very useful metrics to",
    "start": "1020720",
    "end": "1022480"
  },
  {
    "text": "have and i would basically recommend",
    "start": "1022480",
    "end": "1023600"
  },
  {
    "text": "that anyone running calico",
    "start": "1023600",
    "end": "1024880"
  },
  {
    "text": "considers running this tool because uh",
    "start": "1024880",
    "end": "1027120"
  },
  {
    "text": "it's incredibly powerful and it's",
    "start": "1027120",
    "end": "1028240"
  },
  {
    "text": "incredibly easy to set up",
    "start": "1028240",
    "end": "1029839"
  },
  {
    "text": "uh once we had that tool in conjunction",
    "start": "1029839",
    "end": "1032959"
  },
  {
    "text": "with the logging for instances where we",
    "start": "1032959",
    "end": "1034319"
  },
  {
    "text": "couldn't quite figure out what's going",
    "start": "1034319",
    "end": "1035600"
  },
  {
    "text": "on",
    "start": "1035600",
    "end": "1035918"
  },
  {
    "text": "we basically fully specify the whole",
    "start": "1035919",
    "end": "1037360"
  },
  {
    "text": "system it took about a month and by the",
    "start": "1037360",
    "end": "1039280"
  },
  {
    "text": "end of the month we were seeing",
    "start": "1039280",
    "end": "1040480"
  },
  {
    "text": "zero drop packets every day every single",
    "start": "1040480",
    "end": "1042319"
  },
  {
    "text": "one was going into a swag channel",
    "start": "1042319",
    "end": "1044000"
  },
  {
    "text": "and um there basically just weren't very",
    "start": "1044000",
    "end": "1046079"
  },
  {
    "text": "many and we investigated every single",
    "start": "1046079",
    "end": "1047600"
  },
  {
    "text": "one",
    "start": "1047600",
    "end": "1048319"
  },
  {
    "text": "um so at that point you can turn on",
    "start": "1048319",
    "end": "1049760"
  },
  {
    "text": "enforcement and the way you do that is",
    "start": "1049760",
    "end": "1052080"
  },
  {
    "text": "you just",
    "start": "1052080",
    "end": "1052720"
  },
  {
    "text": "take a dry run policy which is currently",
    "start": "1052720",
    "end": "1054559"
  },
  {
    "text": "logging and allowing",
    "start": "1054559",
    "end": "1055760"
  },
  {
    "text": "and instead you just lock so we're still",
    "start": "1055760",
    "end": "1057520"
  },
  {
    "text": "getting the slack messages when packets",
    "start": "1057520",
    "end": "1059440"
  },
  {
    "text": "are going to be dropped",
    "start": "1059440",
    "end": "1060640"
  },
  {
    "text": "but you don't actually allow them",
    "start": "1060640",
    "end": "1062480"
  },
  {
    "text": "anymore so they do actually get dropped",
    "start": "1062480",
    "end": "1065600"
  },
  {
    "text": "and this was boring by the time we did",
    "start": "1065600",
    "end": "1067440"
  },
  {
    "text": "it i mean it was meant to be boring",
    "start": "1067440",
    "end": "1068480"
  },
  {
    "text": "right",
    "start": "1068480",
    "end": "1068799"
  },
  {
    "text": "it's such a straightforward change and",
    "start": "1068799",
    "end": "1070400"
  },
  {
    "text": "it doesn't really change anything",
    "start": "1070400",
    "end": "1072320"
  },
  {
    "text": "um because it was affecting we knew",
    "start": "1072320",
    "end": "1073760"
  },
  {
    "text": "there was effect of no packets",
    "start": "1073760",
    "end": "1075440"
  },
  {
    "text": "but it's probably one of the biggest",
    "start": "1075440",
    "end": "1076960"
  },
  {
    "text": "step changes in the security of the",
    "start": "1076960",
    "end": "1078080"
  },
  {
    "text": "platform that's ever happened because",
    "start": "1078080",
    "end": "1079280"
  },
  {
    "text": "suddenly you're now in a scenario",
    "start": "1079280",
    "end": "1080640"
  },
  {
    "text": "where um an attacker that's somehow in a",
    "start": "1080640",
    "end": "1083039"
  },
  {
    "text": "pod on our network",
    "start": "1083039",
    "end": "1084080"
  },
  {
    "text": "except for a few other pods that it's",
    "start": "1084080",
    "end": "1086320"
  },
  {
    "text": "supposed to be allowed to call",
    "start": "1086320",
    "end": "1087600"
  },
  {
    "text": "if they do any kind of basic internal",
    "start": "1087600",
    "end": "1089280"
  },
  {
    "text": "exploration you know send out some curls",
    "start": "1089280",
    "end": "1091039"
  },
  {
    "text": "or whatever else",
    "start": "1091039",
    "end": "1092000"
  },
  {
    "text": "we're going to get a slack message for",
    "start": "1092000",
    "end": "1093440"
  },
  {
    "text": "every packet that they send",
    "start": "1093440",
    "end": "1095280"
  },
  {
    "text": "um which is a difficult position for",
    "start": "1095280",
    "end": "1097679"
  },
  {
    "text": "them to be in i suspect",
    "start": "1097679",
    "end": "1100080"
  },
  {
    "text": "uh so that was really awesome",
    "start": "1100080",
    "end": "1103519"
  },
  {
    "text": "so it's about a year later now i don't",
    "start": "1104720",
    "end": "1106400"
  },
  {
    "text": "work there anymore but i have a good",
    "start": "1106400",
    "end": "1107840"
  },
  {
    "text": "authority that things are running pretty",
    "start": "1107840",
    "end": "1109120"
  },
  {
    "text": "smoothly",
    "start": "1109120",
    "end": "1109760"
  },
  {
    "text": "um engineers maintain their raw files",
    "start": "1109760",
    "end": "1111600"
  },
  {
    "text": "using rpc map obviously map usually",
    "start": "1111600",
    "end": "1113440"
  },
  {
    "text": "means they don't think about it",
    "start": "1113440",
    "end": "1114559"
  },
  {
    "text": "very much and it gets reviewed um in the",
    "start": "1114559",
    "end": "1117280"
  },
  {
    "text": "pull request",
    "start": "1117280",
    "end": "1118480"
  },
  {
    "text": "and quite a few teams actually ended up",
    "start": "1118480",
    "end": "1119919"
  },
  {
    "text": "taking advantage of the fact that you",
    "start": "1119919",
    "end": "1121600"
  },
  {
    "text": "can set",
    "start": "1121600",
    "end": "1122000"
  },
  {
    "text": "code owners on all the rules for a",
    "start": "1122000",
    "end": "1124480"
  },
  {
    "text": "service",
    "start": "1124480",
    "end": "1125039"
  },
  {
    "text": "and then review all new callers a lot of",
    "start": "1125039",
    "end": "1127120"
  },
  {
    "text": "like payments teams",
    "start": "1127120",
    "end": "1128240"
  },
  {
    "text": "started to do that against the standard",
    "start": "1128240",
    "end": "1129679"
  },
  {
    "text": "practice when they're writing a new sort",
    "start": "1129679",
    "end": "1131039"
  },
  {
    "text": "of dangerous service",
    "start": "1131039",
    "end": "1133200"
  },
  {
    "text": "and that's really awesome i'm glad we",
    "start": "1133200",
    "end": "1134320"
  },
  {
    "text": "supported that we don't really see very",
    "start": "1134320",
    "end": "1136799"
  },
  {
    "text": "many issues related to",
    "start": "1136799",
    "end": "1138160"
  },
  {
    "text": "bad rules rbc map catches most things",
    "start": "1138160",
    "end": "1140640"
  },
  {
    "text": "staging",
    "start": "1140640",
    "end": "1141440"
  },
  {
    "text": "catches a lot of things metrics as well",
    "start": "1141440",
    "end": "1144480"
  },
  {
    "text": "and the system is incredibly tightly",
    "start": "1144480",
    "end": "1145679"
  },
  {
    "text": "specified we've got 13 000 rules or rule",
    "start": "1145679",
    "end": "1147919"
  },
  {
    "text": "files",
    "start": "1147919",
    "end": "1148400"
  },
  {
    "text": "in the monorepo we've got 1500 services",
    "start": "1148400",
    "end": "1151520"
  },
  {
    "text": "so that's eight services on average that",
    "start": "1151520",
    "end": "1153120"
  },
  {
    "text": "you can reach out to",
    "start": "1153120",
    "end": "1154240"
  },
  {
    "text": "and previously that number was 1500 so",
    "start": "1154240",
    "end": "1156799"
  },
  {
    "text": "that's a pretty incredible change",
    "start": "1156799",
    "end": "1160080"
  },
  {
    "text": "so what's next well having spent a few",
    "start": "1160559",
    "end": "1162799"
  },
  {
    "text": "months thinking about internal network",
    "start": "1162799",
    "end": "1164880"
  },
  {
    "text": "traffic and network isolation",
    "start": "1164880",
    "end": "1166640"
  },
  {
    "text": "uh the obvious extension to that is what",
    "start": "1166640",
    "end": "1168480"
  },
  {
    "text": "about traffic leaving the platform",
    "start": "1168480",
    "end": "1170240"
  },
  {
    "text": "and obviously uh the first thing that an",
    "start": "1170240",
    "end": "1173039"
  },
  {
    "text": "attacker will do a lot of the time",
    "start": "1173039",
    "end": "1174480"
  },
  {
    "text": "is pull down a payload from elsewhere i",
    "start": "1174480",
    "end": "1176720"
  },
  {
    "text": "mean github or whoever else some hosting",
    "start": "1176720",
    "end": "1178559"
  },
  {
    "text": "provider",
    "start": "1178559",
    "end": "1179440"
  },
  {
    "text": "uh so we essentially want as many pods",
    "start": "1179440",
    "end": "1182240"
  },
  {
    "text": "as possible to have no public internet",
    "start": "1182240",
    "end": "1183840"
  },
  {
    "text": "access whatsoever we want to give them",
    "start": "1183840",
    "end": "1185200"
  },
  {
    "text": "s3 and maybe",
    "start": "1185200",
    "end": "1186480"
  },
  {
    "text": "you know internal s3 buckets maybe you",
    "start": "1186480",
    "end": "1188080"
  },
  {
    "text": "want to give them some amazon apis",
    "start": "1188080",
    "end": "1189600"
  },
  {
    "text": "but we probably don't want to give them",
    "start": "1189600",
    "end": "1190640"
  },
  {
    "text": "the whole internet we want to restrict",
    "start": "1190640",
    "end": "1192240"
  },
  {
    "text": "that as much as possible and then the",
    "start": "1192240",
    "end": "1193520"
  },
  {
    "text": "services that can have public internet",
    "start": "1193520",
    "end": "1195120"
  },
  {
    "text": "access",
    "start": "1195120",
    "end": "1195600"
  },
  {
    "text": "we don't just want to give them the",
    "start": "1195600",
    "end": "1196720"
  },
  {
    "text": "whole internet we want to give them the",
    "start": "1196720",
    "end": "1198559"
  },
  {
    "text": "websites they actually need and",
    "start": "1198559",
    "end": "1199679"
  },
  {
    "text": "particularly the dns names that they",
    "start": "1199679",
    "end": "1200880"
  },
  {
    "text": "actually need",
    "start": "1200880",
    "end": "1201760"
  },
  {
    "text": "and there's a few cni's that can provide",
    "start": "1201760",
    "end": "1204000"
  },
  {
    "text": "this functionality",
    "start": "1204000",
    "end": "1205280"
  },
  {
    "text": "and you can also do it with this j but",
    "start": "1205280",
    "end": "1206640"
  },
  {
    "text": "we actually wanted something that",
    "start": "1206640",
    "end": "1207679"
  },
  {
    "text": "tightly integrated with our existing",
    "start": "1207679",
    "end": "1209120"
  },
  {
    "text": "network policy setup",
    "start": "1209120",
    "end": "1210159"
  },
  {
    "text": "so we wanted to use the same rule files",
    "start": "1210159",
    "end": "1212320"
  },
  {
    "text": "essentially and the same",
    "start": "1212320",
    "end": "1214000"
  },
  {
    "text": "pod labels and then have the effect of",
    "start": "1214000",
    "end": "1216240"
  },
  {
    "text": "instead of restricting services we",
    "start": "1216240",
    "end": "1217600"
  },
  {
    "text": "restrict to",
    "start": "1217600",
    "end": "1218880"
  },
  {
    "text": "external services and we created an",
    "start": "1218880",
    "end": "1220720"
  },
  {
    "text": "operator for this it's called equals",
    "start": "1220720",
    "end": "1222320"
  },
  {
    "text": "operator you can look it up tiny dot cc",
    "start": "1222320",
    "end": "1224159"
  },
  {
    "text": "slash equals operator and i hope to talk",
    "start": "1224159",
    "end": "1226720"
  },
  {
    "text": "about this with another coupon someday",
    "start": "1226720",
    "end": "1228400"
  },
  {
    "text": "but you might be interested in looking",
    "start": "1228400",
    "end": "1229440"
  },
  {
    "text": "into it it's really awesome",
    "start": "1229440",
    "end": "1232240"
  },
  {
    "text": "and i'm sure that some people looking at",
    "start": "1232240",
    "end": "1234240"
  },
  {
    "text": "this talk or hearing this talk will be",
    "start": "1234240",
    "end": "1235600"
  },
  {
    "text": "thinking and will want to ask me about",
    "start": "1235600",
    "end": "1237280"
  },
  {
    "text": "you know why don't we use istio why",
    "start": "1237280",
    "end": "1238480"
  },
  {
    "text": "don't we use htls certificates",
    "start": "1238480",
    "end": "1240000"
  },
  {
    "text": "declarative etc",
    "start": "1240000",
    "end": "1241440"
  },
  {
    "text": "um calico uh network isolation is really",
    "start": "1241440",
    "end": "1244480"
  },
  {
    "text": "the first step",
    "start": "1244480",
    "end": "1245440"
  },
  {
    "text": "of a longer-term strategy which will",
    "start": "1245440",
    "end": "1247280"
  },
  {
    "text": "involve uh isolation on a per endpoint",
    "start": "1247280",
    "end": "1249440"
  },
  {
    "text": "basis we definitely want to be able to",
    "start": "1249440",
    "end": "1250799"
  },
  {
    "text": "say things like",
    "start": "1250799",
    "end": "1251760"
  },
  {
    "text": "um you can use the read endpoint but not",
    "start": "1251760",
    "end": "1253520"
  },
  {
    "text": "the right endpoint for this service and",
    "start": "1253520",
    "end": "1254880"
  },
  {
    "text": "stuff like that and there's loads of",
    "start": "1254880",
    "end": "1255840"
  },
  {
    "text": "instances where",
    "start": "1255840",
    "end": "1256799"
  },
  {
    "text": "um the security network isolation is",
    "start": "1256799",
    "end": "1258720"
  },
  {
    "text": "really compromised by the fact that",
    "start": "1258720",
    "end": "1260159"
  },
  {
    "text": "a service has dangerous endpoints and",
    "start": "1260159",
    "end": "1261840"
  },
  {
    "text": "safe endpoints um",
    "start": "1261840",
    "end": "1264240"
  },
  {
    "text": "this hasn't been decided yet but we were",
    "start": "1264240",
    "end": "1266000"
  },
  {
    "text": "thinking pretty closely about using sto",
    "start": "1266000",
    "end": "1268240"
  },
  {
    "text": "uh it's very easy to translate our",
    "start": "1268240",
    "end": "1270080"
  },
  {
    "text": "existing network party model into sort",
    "start": "1270080",
    "end": "1272080"
  },
  {
    "text": "of sda language",
    "start": "1272080",
    "end": "1273760"
  },
  {
    "text": "and obviously we already have an invoice",
    "start": "1273760",
    "end": "1275200"
  },
  {
    "text": "sidecast service mesh so",
    "start": "1275200",
    "end": "1277039"
  },
  {
    "text": "it wouldn't be a very difficult",
    "start": "1277039",
    "end": "1278000"
  },
  {
    "text": "migration to move to another invoice",
    "start": "1278000",
    "end": "1279440"
  },
  {
    "text": "sidecar service mesh",
    "start": "1279440",
    "end": "1280640"
  },
  {
    "text": "um which obviously has a lot more",
    "start": "1280640",
    "end": "1281840"
  },
  {
    "text": "features on the service mesh and it's",
    "start": "1281840",
    "end": "1283840"
  },
  {
    "text": "also very helpful for us to have",
    "start": "1283840",
    "end": "1285360"
  },
  {
    "text": "mutual tls for us to have encryption um",
    "start": "1285360",
    "end": "1288240"
  },
  {
    "text": "and",
    "start": "1288240",
    "end": "1288640"
  },
  {
    "text": "we don't just want to rely on network",
    "start": "1288640",
    "end": "1290000"
  },
  {
    "text": "segmentation but it is true that network",
    "start": "1290000",
    "end": "1291919"
  },
  {
    "text": "segmentation is very meaningful to",
    "start": "1291919",
    "end": "1293600"
  },
  {
    "text": "auditors and regulators and it is",
    "start": "1293600",
    "end": "1295280"
  },
  {
    "text": "therefore valuable for us to have that",
    "start": "1295280",
    "end": "1296720"
  },
  {
    "text": "control as a base",
    "start": "1296720",
    "end": "1298240"
  },
  {
    "text": "um and then it additionally would be",
    "start": "1298240",
    "end": "1300080"
  },
  {
    "text": "even more viable to also have encryption",
    "start": "1300080",
    "end": "1301679"
  },
  {
    "text": "and certificates and",
    "start": "1301679",
    "end": "1302880"
  },
  {
    "text": "genuine authentication so that's",
    "start": "1302880",
    "end": "1305039"
  },
  {
    "text": "something that hopefully we can do",
    "start": "1305039",
    "end": "1306320"
  },
  {
    "text": "in the future and",
    "start": "1306320",
    "end": "1309360"
  },
  {
    "text": "that's everything that we have time for",
    "start": "1309360",
    "end": "1311120"
  },
  {
    "text": "thanks so much for listening",
    "start": "1311120",
    "end": "1312640"
  },
  {
    "text": "uh this whole talk is basically adapted",
    "start": "1312640",
    "end": "1314320"
  },
  {
    "text": "from our blog post um",
    "start": "1314320",
    "end": "1316080"
  },
  {
    "text": "and you can read about that tiny dot cc",
    "start": "1316080",
    "end": "1318240"
  },
  {
    "text": "network hyphen isolation",
    "start": "1318240",
    "end": "1320080"
  },
  {
    "text": "uh you can also follow me on twitter",
    "start": "1320080",
    "end": "1321679"
  },
  {
    "text": "jackkleeman and you can email me about",
    "start": "1321679",
    "end": "1323360"
  },
  {
    "text": "this or",
    "start": "1323360",
    "end": "1324000"
  },
  {
    "text": "um my future self in the q a i'm sure",
    "start": "1324000",
    "end": "1326080"
  },
  {
    "text": "can answer any of your questions",
    "start": "1326080",
    "end": "1327919"
  },
  {
    "text": "and thanks very much that's all",
    "start": "1327919",
    "end": "1332640"
  },
  {
    "text": "hi everyone thanks for coming um i hope",
    "start": "1332640",
    "end": "1335039"
  },
  {
    "text": "everyone can hear me okay etc",
    "start": "1335039",
    "end": "1336960"
  },
  {
    "text": "uh i think most of the questions i've",
    "start": "1336960",
    "end": "1338799"
  },
  {
    "text": "already answered",
    "start": "1338799",
    "end": "1340720"
  },
  {
    "text": "but there's one left and there's",
    "start": "1340720",
    "end": "1342960"
  },
  {
    "text": "probably some more that will come in",
    "start": "1342960",
    "end": "1343919"
  },
  {
    "text": "while i answer",
    "start": "1343919",
    "end": "1345200"
  },
  {
    "text": "so one from kevin saying uh one of my",
    "start": "1345200",
    "end": "1347280"
  },
  {
    "text": "thoughts on using network policies for",
    "start": "1347280",
    "end": "1349200"
  },
  {
    "text": "uh traffic flow in and out of the",
    "start": "1349200",
    "end": "1350640"
  },
  {
    "text": "cluster so i touched on this a little",
    "start": "1350640",
    "end": "1352000"
  },
  {
    "text": "bit with the",
    "start": "1352000",
    "end": "1352799"
  },
  {
    "text": "um egress operator that we worked on",
    "start": "1352799",
    "end": "1356000"
  },
  {
    "text": "um i think we started to realize that",
    "start": "1356000",
    "end": "1358720"
  },
  {
    "text": "most attacks would involve",
    "start": "1358720",
    "end": "1360880"
  },
  {
    "text": "some kind of egress or some kind of",
    "start": "1360880",
    "end": "1363440"
  },
  {
    "text": "traffic leaving the platform to reach an",
    "start": "1363440",
    "end": "1365039"
  },
  {
    "text": "attacker's platform or",
    "start": "1365039",
    "end": "1366240"
  },
  {
    "text": "obviously yeah if you're running um like",
    "start": "1366240",
    "end": "1367760"
  },
  {
    "text": "hybrid crowd or hybrid cloud or on-prem",
    "start": "1367760",
    "end": "1370240"
  },
  {
    "text": "it might be reaching other things so i",
    "start": "1370240",
    "end": "1373120"
  },
  {
    "text": "think you know my basic stance on this",
    "start": "1373120",
    "end": "1374640"
  },
  {
    "text": "is that",
    "start": "1374640",
    "end": "1375039"
  },
  {
    "text": "all traffic should be specified i mean",
    "start": "1375039",
    "end": "1377039"
  },
  {
    "text": "in practice you should have network",
    "start": "1377039",
    "end": "1378640"
  },
  {
    "text": "policies for everything and you could",
    "start": "1378640",
    "end": "1379840"
  },
  {
    "text": "start off with very",
    "start": "1379840",
    "end": "1380720"
  },
  {
    "text": "generic ones that allow a lot of things",
    "start": "1380720",
    "end": "1382240"
  },
  {
    "text": "and try and scope them down over time",
    "start": "1382240",
    "end": "1384000"
  },
  {
    "text": "um and that should include yeah things",
    "start": "1384000",
    "end": "1385600"
  },
  {
    "text": "getting out of kubernetes and",
    "start": "1385600",
    "end": "1387039"
  },
  {
    "text": "basically try and have as much",
    "start": "1387039",
    "end": "1389360"
  },
  {
    "text": "restriction as possible",
    "start": "1389360",
    "end": "1390960"
  },
  {
    "text": "even if it's not necessarily a security",
    "start": "1390960",
    "end": "1392400"
  },
  {
    "text": "priority i think it is so valuable",
    "start": "1392400",
    "end": "1394799"
  },
  {
    "text": "and i touched on this a little bit to",
    "start": "1394799",
    "end": "1396159"
  },
  {
    "text": "have a programmatically queryable",
    "start": "1396159",
    "end": "1398720"
  },
  {
    "text": "list of of things that are happening in",
    "start": "1398720",
    "end": "1400559"
  },
  {
    "text": "your in your cluster that's provably",
    "start": "1400559",
    "end": "1402080"
  },
  {
    "text": "true",
    "start": "1402080",
    "end": "1402480"
  },
  {
    "text": "like you know that this set of policies",
    "start": "1402480",
    "end": "1404720"
  },
  {
    "text": "is a superset of the traffic that's",
    "start": "1404720",
    "end": "1406080"
  },
  {
    "text": "actually happening i think that's",
    "start": "1406080",
    "end": "1407039"
  },
  {
    "text": "amazing",
    "start": "1407039",
    "end": "1407840"
  },
  {
    "text": "and just for the kind of monitoring and",
    "start": "1407840",
    "end": "1410320"
  },
  {
    "text": "um",
    "start": "1410320",
    "end": "1410880"
  },
  {
    "text": "kind of headspace benefit of that i",
    "start": "1410880",
    "end": "1413200"
  },
  {
    "text": "would advise it even if security",
    "start": "1413200",
    "end": "1414880"
  },
  {
    "text": "isn't the top priority um but yeah i",
    "start": "1414880",
    "end": "1417280"
  },
  {
    "text": "would definitely be keen on using their",
    "start": "1417280",
    "end": "1418559"
  },
  {
    "text": "policies for as much as possible",
    "start": "1418559",
    "end": "1420880"
  },
  {
    "text": "um another question from gaston uh",
    "start": "1420880",
    "end": "1425279"
  },
  {
    "text": "when using sjo the network policies uh",
    "start": "1425279",
    "end": "1428640"
  },
  {
    "text": "for cube system and other namespaces",
    "start": "1428640",
    "end": "1430159"
  },
  {
    "text": "aren't protected yeah i think",
    "start": "1430159",
    "end": "1432400"
  },
  {
    "text": "we would never have planned to",
    "start": "1432400",
    "end": "1434720"
  },
  {
    "text": "exclusively move everything over to it's",
    "start": "1434720",
    "end": "1436240"
  },
  {
    "text": "job and just dump all this work that",
    "start": "1436240",
    "end": "1437600"
  },
  {
    "text": "we've done i think",
    "start": "1437600",
    "end": "1438720"
  },
  {
    "text": "we would see it as and i think sg to",
    "start": "1438720",
    "end": "1440640"
  },
  {
    "text": "some extent recommends",
    "start": "1440640",
    "end": "1441840"
  },
  {
    "text": "like some usage of number policies in",
    "start": "1441840",
    "end": "1444000"
  },
  {
    "text": "some areas",
    "start": "1444000",
    "end": "1444960"
  },
  {
    "text": "um defense in depth is the name of the",
    "start": "1444960",
    "end": "1447200"
  },
  {
    "text": "game and",
    "start": "1447200",
    "end": "1448240"
  },
  {
    "text": "it's never acceptable to have just one",
    "start": "1448240",
    "end": "1450000"
  },
  {
    "text": "control and actually when you're dealing",
    "start": "1450000",
    "end": "1451200"
  },
  {
    "text": "with regulators in particular",
    "start": "1451200",
    "end": "1452480"
  },
  {
    "text": "it's never acceptable to just have one",
    "start": "1452480",
    "end": "1453760"
  },
  {
    "text": "control so we would have layered hd on",
    "start": "1453760",
    "end": "1456240"
  },
  {
    "text": "top of this to add",
    "start": "1456240",
    "end": "1457440"
  },
  {
    "text": "endpoint level security and encryption",
    "start": "1457440",
    "end": "1459200"
  },
  {
    "text": "and more authentication power",
    "start": "1459200",
    "end": "1461200"
  },
  {
    "text": "we wouldn't have removed what we already",
    "start": "1461200",
    "end": "1462960"
  },
  {
    "text": "have i think network policies",
    "start": "1462960",
    "end": "1464640"
  },
  {
    "text": "like they're my favorite resource in the",
    "start": "1464640",
    "end": "1465919"
  },
  {
    "text": "whole kubernetes they're so powerful i'm",
    "start": "1465919",
    "end": "1467760"
  },
  {
    "text": "excited for v2 but i think that they",
    "start": "1467760",
    "end": "1469200"
  },
  {
    "text": "have a lot of power already and um",
    "start": "1469200",
    "end": "1471600"
  },
  {
    "text": "yeah i would really advise that um",
    "start": "1471600",
    "end": "1475120"
  },
  {
    "text": "yeah next question for ralph have i",
    "start": "1475120",
    "end": "1476320"
  },
  {
    "text": "thought about an english operator i",
    "start": "1476320",
    "end": "1478000"
  },
  {
    "text": "don't really know what that would look",
    "start": "1478000",
    "end": "1479039"
  },
  {
    "text": "like because",
    "start": "1479039",
    "end": "1479840"
  },
  {
    "text": "it's already possible to have a lot of",
    "start": "1479840",
    "end": "1481120"
  },
  {
    "text": "control over ingress",
    "start": "1481120",
    "end": "1483279"
  },
  {
    "text": "you can essentially not allow pods to",
    "start": "1483279",
    "end": "1485679"
  },
  {
    "text": "receive traffic",
    "start": "1485679",
    "end": "1486480"
  },
  {
    "text": "on host network you can only allow it to",
    "start": "1486480",
    "end": "1488640"
  },
  {
    "text": "happen through like certain network",
    "start": "1488640",
    "end": "1490080"
  },
  {
    "text": "increases to your",
    "start": "1490080",
    "end": "1491120"
  },
  {
    "text": "cni and then you can you know have api",
    "start": "1491120",
    "end": "1493760"
  },
  {
    "text": "get ways for those things",
    "start": "1493760",
    "end": "1495120"
  },
  {
    "text": "so that's probably what i would",
    "start": "1495120",
    "end": "1497200"
  },
  {
    "text": "recommend um",
    "start": "1497200",
    "end": "1498240"
  },
  {
    "text": "i don't know if it's quite this same",
    "start": "1498240",
    "end": "1500159"
  },
  {
    "text": "solution um",
    "start": "1500159",
    "end": "1501440"
  },
  {
    "text": "the same thing just does not apply for",
    "start": "1501440",
    "end": "1502720"
  },
  {
    "text": "egress generally all pods have total",
    "start": "1502720",
    "end": "1504559"
  },
  {
    "text": "access to like the internet",
    "start": "1504559",
    "end": "1506159"
  },
  {
    "text": "and that was the thing we were concerned",
    "start": "1506159",
    "end": "1507440"
  },
  {
    "text": "about but um certainly at this company",
    "start": "1507440",
    "end": "1510000"
  },
  {
    "text": "it was not possible to reach a pod from",
    "start": "1510000",
    "end": "1512320"
  },
  {
    "text": "an external",
    "start": "1512320",
    "end": "1513200"
  },
  {
    "text": "like place you would have to go through",
    "start": "1513200",
    "end": "1514720"
  },
  {
    "text": "some kind of software-defined network",
    "start": "1514720",
    "end": "1516640"
  },
  {
    "text": "ingress",
    "start": "1516640",
    "end": "1517120"
  },
  {
    "text": "and that had all the power that we",
    "start": "1517120",
    "end": "1518480"
  },
  {
    "text": "needed um",
    "start": "1518480",
    "end": "1520400"
  },
  {
    "text": "question from i don't know if i'm saying",
    "start": "1520400",
    "end": "1521919"
  },
  {
    "text": "this right nick uh how did you create",
    "start": "1521919",
    "end": "1524000"
  },
  {
    "text": "the diagram in the beginning",
    "start": "1524000",
    "end": "1525200"
  },
  {
    "text": "uh really simple actually so it's take",
    "start": "1525200",
    "end": "1528240"
  },
  {
    "text": "the rule files you run find to get a",
    "start": "1528240",
    "end": "1530159"
  },
  {
    "text": "list of them",
    "start": "1530159",
    "end": "1531200"
  },
  {
    "text": "you said to turn the list of file names",
    "start": "1531200",
    "end": "1534320"
  },
  {
    "text": "into dot file syntax so you take the",
    "start": "1534320",
    "end": "1537520"
  },
  {
    "text": "first part which is the name of the",
    "start": "1537520",
    "end": "1538720"
  },
  {
    "text": "calling service and the last part which",
    "start": "1538720",
    "end": "1540240"
  },
  {
    "text": "is the name of the recipient service",
    "start": "1540240",
    "end": "1541679"
  },
  {
    "text": "and you put an arrow in between them and",
    "start": "1541679",
    "end": "1543039"
  },
  {
    "text": "that's now dot syntax now you have a dot",
    "start": "1543039",
    "end": "1545279"
  },
  {
    "text": "file",
    "start": "1545279",
    "end": "1546320"
  },
  {
    "text": "and you use a piece of software called",
    "start": "1546320",
    "end": "1547760"
  },
  {
    "text": "gefi which",
    "start": "1547760",
    "end": "1549360"
  },
  {
    "text": "turns dot files into beautiful graphs",
    "start": "1549360",
    "end": "1550960"
  },
  {
    "text": "and then you do some sort of",
    "start": "1550960",
    "end": "1553039"
  },
  {
    "text": "graph positioning algorithm that sort of",
    "start": "1553039",
    "end": "1555039"
  },
  {
    "text": "doesn't work very well but it'll work",
    "start": "1555039",
    "end": "1556320"
  },
  {
    "text": "okay and that's how you do it it's super",
    "start": "1556320",
    "end": "1557919"
  },
  {
    "text": "easy so this is the awesome thing about",
    "start": "1557919",
    "end": "1559120"
  },
  {
    "text": "having these",
    "start": "1559120",
    "end": "1559600"
  },
  {
    "text": "files um next up",
    "start": "1559600",
    "end": "1563120"
  },
  {
    "text": "how i thought about nsx micro",
    "start": "1563120",
    "end": "1565039"
  },
  {
    "text": "segmentations i don't know what that is",
    "start": "1565039",
    "end": "1566960"
  },
  {
    "text": "so um clearly i haven't thought about it",
    "start": "1566960",
    "end": "1569039"
  },
  {
    "text": "but i would love to hear more if you can",
    "start": "1569039",
    "end": "1570640"
  },
  {
    "text": "elaborate on that",
    "start": "1570640",
    "end": "1572159"
  },
  {
    "text": "and finally is there a possibility to",
    "start": "1572159",
    "end": "1575679"
  },
  {
    "text": "use cubby tables taylor",
    "start": "1575679",
    "end": "1577600"
  },
  {
    "text": "without switching from cake network",
    "start": "1577600",
    "end": "1579520"
  },
  {
    "text": "policy to calico network policies",
    "start": "1579520",
    "end": "1581440"
  },
  {
    "text": "so first of all you don't need to switch",
    "start": "1581440",
    "end": "1584080"
  },
  {
    "text": "to calico network policies you just need",
    "start": "1584080",
    "end": "1585520"
  },
  {
    "text": "to have a single policy",
    "start": "1585520",
    "end": "1586960"
  },
  {
    "text": "that logs everything and then allows",
    "start": "1586960",
    "end": "1588960"
  },
  {
    "text": "everything that runs late",
    "start": "1588960",
    "end": "1590559"
  },
  {
    "text": "and there's not currently possible to",
    "start": "1590559",
    "end": "1592640"
  },
  {
    "text": "log using just kubernetes policies if",
    "start": "1592640",
    "end": "1594880"
  },
  {
    "text": "you're already on calico it wouldn't be",
    "start": "1594880",
    "end": "1596480"
  },
  {
    "text": "very difficult to create a pr against",
    "start": "1596480",
    "end": "1598000"
  },
  {
    "text": "calico or to fork it",
    "start": "1598000",
    "end": "1599360"
  },
  {
    "text": "specifically against their calico coupe",
    "start": "1599360",
    "end": "1600880"
  },
  {
    "text": "controllers which is a pretty simple",
    "start": "1600880",
    "end": "1602240"
  },
  {
    "text": "controller",
    "start": "1602240",
    "end": "1603120"
  },
  {
    "text": "you that would allow you to label a",
    "start": "1603120",
    "end": "1604720"
  },
  {
    "text": "policy such that a it runs last",
    "start": "1604720",
    "end": "1607360"
  },
  {
    "text": "and b it logs um that seems possible to",
    "start": "1607360",
    "end": "1610559"
  },
  {
    "text": "do because you can definitely write a",
    "start": "1610559",
    "end": "1611679"
  },
  {
    "text": "policy that allows everything",
    "start": "1611679",
    "end": "1612880"
  },
  {
    "text": "the things you're missing are ordering",
    "start": "1612880",
    "end": "1614240"
  },
  {
    "text": "and logging you can trick the ordering",
    "start": "1614240",
    "end": "1616240"
  },
  {
    "text": "thing",
    "start": "1616240",
    "end": "1616720"
  },
  {
    "text": "with alphabetical naming",
    "start": "1616720",
    "end": "1627840"
  },
  {
    "text": "i recommend that uh but yeah it probably",
    "start": "1631600",
    "end": "1634400"
  },
  {
    "text": "is possible with other cni's as well",
    "start": "1634400",
    "end": "1637600"
  },
  {
    "text": "um cool",
    "start": "1637600",
    "end": "1641840"
  },
  {
    "text": "apparently my sound's gone is my sound",
    "start": "1642080",
    "end": "1645520"
  },
  {
    "text": "back",
    "start": "1645520",
    "end": "1647279"
  },
  {
    "text": "oh yeah sounds like it is okay great um",
    "start": "1647279",
    "end": "1650159"
  },
  {
    "text": "i was just",
    "start": "1650159",
    "end": "1650799"
  },
  {
    "text": "saying about yeah you you do need a few",
    "start": "1650799",
    "end": "1654240"
  },
  {
    "text": "features of calico other cni's might",
    "start": "1654240",
    "end": "1655840"
  },
  {
    "text": "need it you need it to run last you need",
    "start": "1655840",
    "end": "1657840"
  },
  {
    "text": "it to",
    "start": "1657840",
    "end": "1658559"
  },
  {
    "text": "be able to log and you need it to affect",
    "start": "1658559",
    "end": "1661520"
  },
  {
    "text": "all name spaces",
    "start": "1661520",
    "end": "1662559"
  },
  {
    "text": "or you can create a policy per name",
    "start": "1662559",
    "end": "1663919"
  },
  {
    "text": "space if you need to or you can write a",
    "start": "1663919",
    "end": "1665039"
  },
  {
    "text": "controller that does that for you",
    "start": "1665039",
    "end": "1666640"
  },
  {
    "text": "um but running last is often possible if",
    "start": "1666640",
    "end": "1668799"
  },
  {
    "text": "you name the policy in a certain way",
    "start": "1668799",
    "end": "1670559"
  },
  {
    "text": "and logging that's the tricky one and we",
    "start": "1670559",
    "end": "1672799"
  },
  {
    "text": "at one point even fought calico to have",
    "start": "1672799",
    "end": "1674399"
  },
  {
    "text": "this functionality but we decided in the",
    "start": "1674399",
    "end": "1675840"
  },
  {
    "text": "end to use color code",
    "start": "1675840",
    "end": "1676880"
  },
  {
    "text": "global policies um",
    "start": "1676880",
    "end": "1680399"
  },
  {
    "text": "from bart is rpc map required to set up",
    "start": "1680399",
    "end": "1682640"
  },
  {
    "text": "the dot rules",
    "start": "1682640",
    "end": "1684240"
  },
  {
    "text": "uh yes it is that that was a very much a",
    "start": "1684240",
    "end": "1686799"
  },
  {
    "text": "homegrown thing it was passing",
    "start": "1686799",
    "end": "1688399"
  },
  {
    "text": "our code to look for things that look",
    "start": "1688399",
    "end": "1690000"
  },
  {
    "text": "like rrpcs they're not grpc",
    "start": "1690000",
    "end": "1692399"
  },
  {
    "text": "and um they create rule files for you",
    "start": "1692399",
    "end": "1695120"
  },
  {
    "text": "you would have to build something",
    "start": "1695120",
    "end": "1695919"
  },
  {
    "text": "similar and if someone builds that for",
    "start": "1695919",
    "end": "1697120"
  },
  {
    "text": "grpc",
    "start": "1697120",
    "end": "1698159"
  },
  {
    "text": "then that would be incredible but i i",
    "start": "1698159",
    "end": "1699840"
  },
  {
    "text": "don't know what that would look like",
    "start": "1699840",
    "end": "1701440"
  },
  {
    "text": "it's not required for calorie accountant",
    "start": "1701440",
    "end": "1702880"
  },
  {
    "text": "caloric accountant is incredibly generic",
    "start": "1702880",
    "end": "1704480"
  },
  {
    "text": "tool",
    "start": "1704480",
    "end": "1705120"
  },
  {
    "text": "it just looks at your color code rules",
    "start": "1705120",
    "end": "1707120"
  },
  {
    "text": "turns them back into policy names",
    "start": "1707120",
    "end": "1708880"
  },
  {
    "text": "and tells you what's going on it's",
    "start": "1708880",
    "end": "1710399"
  },
  {
    "text": "really awesome and it will work for",
    "start": "1710399",
    "end": "1711919"
  },
  {
    "text": "everyone using calico so i really advise",
    "start": "1711919",
    "end": "1713600"
  },
  {
    "text": "that",
    "start": "1713600",
    "end": "1714480"
  },
  {
    "text": "um and i think that's everything",
    "start": "1714480",
    "end": "1717679"
  },
  {
    "text": "unless there any other questions uh that",
    "start": "1717679",
    "end": "1720159"
  },
  {
    "text": "was really fun thank you everyone",
    "start": "1720159",
    "end": "1724480"
  }
]