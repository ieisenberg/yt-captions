[
  {
    "text": "okay uh hey everyone Welcome to our talk",
    "start": "680",
    "end": "3959"
  },
  {
    "text": "Rogue no more securing kubernetes with",
    "start": "3959",
    "end": "6359"
  },
  {
    "text": "not specific",
    "start": "6359",
    "end": "8840"
  },
  {
    "text": "restrictions",
    "start": "8840",
    "end": "10480"
  },
  {
    "text": "um yeah um yeah thanks for coming I'm",
    "start": "10480",
    "end": "13280"
  },
  {
    "text": "James monley I'm a software engineer in",
    "start": "13280",
    "end": "15519"
  },
  {
    "text": "the open engineering um department at",
    "start": "15519",
    "end": "17720"
  },
  {
    "text": "Apple and I'm Anish I'm a software",
    "start": "17720",
    "end": "20600"
  },
  {
    "text": "engineer at Microsoft working on",
    "start": "20600",
    "end": "22240"
  },
  {
    "text": "security I am a member of kuber seot and",
    "start": "22240",
    "end": "25199"
  },
  {
    "text": "maintainer for Secret store CSI",
    "start": "25199",
    "end": "28480"
  },
  {
    "text": "driver yeah so so I guess bit of",
    "start": "28480",
    "end": "30840"
  },
  {
    "text": "background on um kind of this whole",
    "start": "30840",
    "end": "32840"
  },
  {
    "text": "problem space so in kubernetes uh like",
    "start": "32840",
    "end": "36640"
  },
  {
    "text": "you probably already aware nodes have a",
    "start": "36640",
    "end": "38719"
  },
  {
    "text": "required set of permissions they need to",
    "start": "38719",
    "end": "40160"
  },
  {
    "text": "interact with different resources they",
    "start": "40160",
    "end": "41800"
  },
  {
    "text": "need to um you know take actions and",
    "start": "41800",
    "end": "44039"
  },
  {
    "text": "they go and create make changes on the",
    "start": "44039",
    "end": "46320"
  },
  {
    "text": "Node that they're running um accordingly",
    "start": "46320",
    "end": "49760"
  },
  {
    "text": "so the one thing we haven't really got a",
    "start": "49760",
    "end": "51480"
  },
  {
    "text": "good solution for or we haven't um",
    "start": "51480",
    "end": "53440"
  },
  {
    "text": "really thought much about is you know",
    "start": "53440",
    "end": "55120"
  },
  {
    "text": "what stops one node modifying another",
    "start": "55120",
    "end": "56840"
  },
  {
    "text": "node's objects so the kubernetes project",
    "start": "56840",
    "end": "59519"
  },
  {
    "text": "did Rec this um a few years back well",
    "start": "59519",
    "end": "63280"
  },
  {
    "text": "sorry I should jump in the Cubit um has",
    "start": "63280",
    "end": "66280"
  },
  {
    "text": "got to manage all these different",
    "start": "66280",
    "end": "67280"
  },
  {
    "text": "objects so you've got pods nodes",
    "start": "67280",
    "end": "69200"
  },
  {
    "text": "persistent volume claims and this is",
    "start": "69200",
    "end": "70640"
  },
  {
    "text": "kind of all through the life cycle of",
    "start": "70640",
    "end": "71920"
  },
  {
    "text": "starting up your workload so um included",
    "start": "71920",
    "end": "75280"
  },
  {
    "text": "in there although not listed on here is",
    "start": "75280",
    "end": "77680"
  },
  {
    "text": "things like Secrets config Maps very",
    "start": "77680",
    "end": "79520"
  },
  {
    "text": "sensitive information um additionally",
    "start": "79520",
    "end": "82439"
  },
  {
    "text": "like if you think about it if one node",
    "start": "82439",
    "end": "83840"
  },
  {
    "text": "could go and modify another this is a",
    "start": "83840",
    "end": "85360"
  },
  {
    "text": "really good attack Vector for one um for",
    "start": "85360",
    "end": "88320"
  },
  {
    "text": "one uh for for attacker to kind of get",
    "start": "88320",
    "end": "90920"
  },
  {
    "text": "from a node that they've managed to",
    "start": "90920",
    "end": "92920"
  },
  {
    "text": "break into into a more secure place you",
    "start": "92920",
    "end": "95119"
  },
  {
    "text": "might have different like taints",
    "start": "95119",
    "end": "96960"
  },
  {
    "text": "tolerations and things to only run your",
    "start": "96960",
    "end": "98920"
  },
  {
    "text": "really super sensitive uh workloads only",
    "start": "98920",
    "end": "101560"
  },
  {
    "text": "on your specific node pool but via the",
    "start": "101560",
    "end": "103840"
  },
  {
    "text": "API server you could Traverse get onto",
    "start": "103840",
    "end": "106399"
  },
  {
    "text": "the next node onto the next node until",
    "start": "106399",
    "end": "108680"
  },
  {
    "text": "you're kind of getting yourself a",
    "start": "108680",
    "end": "110040"
  },
  {
    "text": "cluster admin super privileged uh token",
    "start": "110040",
    "end": "112880"
  },
  {
    "text": "which is not great so this was",
    "start": "112880",
    "end": "114880"
  },
  {
    "text": "recognized a while back um and the cubet",
    "start": "114880",
    "end": "117119"
  },
  {
    "text": "has actually already got a solution for",
    "start": "117119",
    "end": "119039"
  },
  {
    "text": "parts of this um and that's in the node",
    "start": "119039",
    "end": "120920"
  },
  {
    "text": "restriction admission plug-in has anyone",
    "start": "120920",
    "end": "123039"
  },
  {
    "text": "heard of that",
    "start": "123039",
    "end": "124360"
  },
  {
    "text": "before yeah a few okay um so yeah this",
    "start": "124360",
    "end": "129479"
  },
  {
    "text": "this uh admission plugin actually",
    "start": "129479",
    "end": "131039"
  },
  {
    "text": "restricts nodes so that they can only",
    "start": "131039",
    "end": "133160"
  },
  {
    "text": "modify or access uh resources that are",
    "start": "133160",
    "end": "135720"
  },
  {
    "text": "relevant to them so by relevant here I",
    "start": "135720",
    "end": "138360"
  },
  {
    "text": "mean um like if the Pod that well if",
    "start": "138360",
    "end": "142239"
  },
  {
    "text": "you're trying to access a secret then",
    "start": "142239",
    "end": "144080"
  },
  {
    "text": "must be a pod scheduled to that node",
    "start": "144080",
    "end": "146720"
  },
  {
    "text": "that uh that actually references that",
    "start": "146720",
    "end": "149519"
  },
  {
    "text": "secret",
    "start": "149519",
    "end": "150440"
  },
  {
    "text": "and that stopped you just being able to",
    "start": "150440",
    "end": "151680"
  },
  {
    "text": "kind of go off and grab a random thing",
    "start": "151680",
    "end": "153599"
  },
  {
    "text": "this wasn't always the case for a while",
    "start": "153599",
    "end": "155160"
  },
  {
    "text": "you know cubet could just go and grab",
    "start": "155160",
    "end": "157200"
  },
  {
    "text": "any odse from the thing and then",
    "start": "157200",
    "end": "158720"
  },
  {
    "text": "suddenly you think about it unless",
    "start": "158720",
    "end": "160519"
  },
  {
    "text": "you've got really hardened Security on",
    "start": "160519",
    "end": "161760"
  },
  {
    "text": "your node it's a bit of a scary thing",
    "start": "161760",
    "end": "164040"
  },
  {
    "text": "and even if you do have hardened",
    "start": "164040",
    "end": "165080"
  },
  {
    "text": "security you probably want to be careful",
    "start": "165080",
    "end": "167360"
  },
  {
    "text": "Beyond just Basics so um this works by",
    "start": "167360",
    "end": "171159"
  },
  {
    "text": "inspecting the username the groups um on",
    "start": "171159",
    "end": "174720"
  },
  {
    "text": "the nod's identity and cross referencing",
    "start": "174720",
    "end": "177959"
  },
  {
    "text": "that to then go and look up uh like",
    "start": "177959",
    "end": "180280"
  },
  {
    "text": "maintaining a map of the pods and things",
    "start": "180280",
    "end": "182440"
  },
  {
    "text": "like that to know what's relevant um and",
    "start": "182440",
    "end": "186000"
  },
  {
    "text": "if it's not it rejects the",
    "start": "186000",
    "end": "189200"
  },
  {
    "text": "request but what about Damon sets like",
    "start": "189200",
    "end": "191799"
  },
  {
    "text": "cubet is one thing but you probably all",
    "start": "191799",
    "end": "193799"
  },
  {
    "text": "run a cni that may well run as a Damon",
    "start": "193799",
    "end": "195920"
  },
  {
    "text": "set you might run CSI drivers you might",
    "start": "195920",
    "end": "198480"
  },
  {
    "text": "run whatever else you run and these also",
    "start": "198480",
    "end": "201159"
  },
  {
    "text": "all have permissions and they may need",
    "start": "201159",
    "end": "202799"
  },
  {
    "text": "to interact with uh the API server store",
    "start": "202799",
    "end": "205879"
  },
  {
    "text": "some State grab configuration grab",
    "start": "205879",
    "end": "208599"
  },
  {
    "text": "credentials uh all of these you know",
    "start": "208599",
    "end": "210720"
  },
  {
    "text": "this is a risk um you're running this",
    "start": "210720",
    "end": "212720"
  },
  {
    "text": "across your whole Fleet um and you can",
    "start": "212720",
    "end": "215239"
  },
  {
    "text": "kind of Traverse around if you're not",
    "start": "215239",
    "end": "218480"
  },
  {
    "text": "careful um yeah so we don't well there",
    "start": "218480",
    "end": "222720"
  },
  {
    "text": "hasn't been a solution for doing this",
    "start": "222720",
    "end": "223840"
  },
  {
    "text": "with Damon sets up until now the node",
    "start": "223840",
    "end": "225480"
  },
  {
    "text": "restriction plugin is not generalized uh",
    "start": "225480",
    "end": "227879"
  },
  {
    "text": "it specifically looks for node objects",
    "start": "227879",
    "end": "230439"
  },
  {
    "text": "and it works with node identities so",
    "start": "230439",
    "end": "232120"
  },
  {
    "text": "system colon node colon Something um as",
    "start": "232120",
    "end": "236640"
  },
  {
    "text": "I say that means you can move well with",
    "start": "236640",
    "end": "238840"
  },
  {
    "text": "a suitable",
    "start": "238840",
    "end": "240319"
  },
  {
    "text": "a suitable set of chain attacks you can",
    "start": "240319",
    "end": "242560"
  },
  {
    "text": "actually go and move between different",
    "start": "242560",
    "end": "244680"
  },
  {
    "text": "nodes on the cluster uh and start to",
    "start": "244680",
    "end": "247200"
  },
  {
    "text": "escalate your",
    "start": "247200",
    "end": "249840"
  },
  {
    "text": "privileges and there are examples of",
    "start": "250360",
    "end": "252400"
  },
  {
    "text": "this so we talked about the problems",
    "start": "252400",
    "end": "255280"
  },
  {
    "text": "with damet right and then this",
    "start": "255280",
    "end": "256959"
  },
  {
    "text": "particular slide is uh covers a critical",
    "start": "256959",
    "end": "259880"
  },
  {
    "text": "issue that was in CU word um and CUO B",
    "start": "259880",
    "end": "263360"
  },
  {
    "text": "on a high level has four components one",
    "start": "263360",
    "end": "266040"
  },
  {
    "text": "is the Handler uh then a controller and",
    "start": "266040",
    "end": "269039"
  },
  {
    "text": "then API and an operator each of these",
    "start": "269039",
    "end": "272080"
  },
  {
    "text": "components has specific permissions that",
    "start": "272080",
    "end": "274840"
  },
  {
    "text": "function but also create security risks",
    "start": "274840",
    "end": "277240"
  },
  {
    "text": "if a single node is compromised so the",
    "start": "277240",
    "end": "279800"
  },
  {
    "text": "Cub Handler is a Damon set on every",
    "start": "279800",
    "end": "281919"
  },
  {
    "text": "single node which has rback permissions",
    "start": "281919",
    "end": "284039"
  },
  {
    "text": "to patch any node and then the Cub",
    "start": "284039",
    "end": "287520"
  },
  {
    "text": "controller has permissions to evict",
    "start": "287520",
    "end": "290000"
  },
  {
    "text": "workloads and then the cubd API pod has",
    "start": "290000",
    "end": "293400"
  },
  {
    "text": "delete permissions on pods and then",
    "start": "293400",
    "end": "295960"
  },
  {
    "text": "finally the cubert operator um has",
    "start": "295960",
    "end": "298560"
  },
  {
    "text": "permissions to get list and create",
    "start": "298560",
    "end": "301600"
  },
  {
    "text": "Secrets um and then so if you carefully",
    "start": "301600",
    "end": "304199"
  },
  {
    "text": "orchestrate uh attack from a compromise",
    "start": "304199",
    "end": "307000"
  },
  {
    "text": "node you can basically make all the",
    "start": "307000",
    "end": "309240"
  },
  {
    "text": "nodes unschedulable except the",
    "start": "309240",
    "end": "311320"
  },
  {
    "text": "compromise node and then you could use",
    "start": "311320",
    "end": "313320"
  },
  {
    "text": "the rback permissions from the Pod that",
    "start": "313320",
    "end": "315520"
  },
  {
    "text": "has permissions to delete pods and then",
    "start": "315520",
    "end": "318319"
  },
  {
    "text": "Force the operator pod to land on the",
    "start": "318319",
    "end": "321000"
  },
  {
    "text": "compromise node then using that operator",
    "start": "321000",
    "end": "323840"
  },
  {
    "text": "pod you can actually do privilege",
    "start": "323840",
    "end": "326600"
  },
  {
    "text": "escalation so you can actually become a",
    "start": "326600",
    "end": "328240"
  },
  {
    "text": "cluster admin and that is something that",
    "start": "328240",
    "end": "330039"
  },
  {
    "text": "we'll also show as part of the",
    "start": "330039",
    "end": "331919"
  },
  {
    "text": "demo um this is another cve with a",
    "start": "331919",
    "end": "335160"
  },
  {
    "text": "different project um fluid uh which",
    "start": "335160",
    "end": "337880"
  },
  {
    "text": "basically has a CSI driver so it has a",
    "start": "337880",
    "end": "340360"
  },
  {
    "text": "CSI node plugin fluid pod uh that can",
    "start": "340360",
    "end": "343759"
  },
  {
    "text": "exploit service account to modify node",
    "start": "343759",
    "end": "345800"
  },
  {
    "text": "specs for other nodes um this basically",
    "start": "345800",
    "end": "350240"
  },
  {
    "text": "can do the same thing it can set other",
    "start": "350240",
    "end": "352199"
  },
  {
    "text": "ports to non- schedulable and then try",
    "start": "352199",
    "end": "354360"
  },
  {
    "text": "and move privilege PS from the other",
    "start": "354360",
    "end": "356759"
  },
  {
    "text": "nodes to the compromise node and then",
    "start": "356759",
    "end": "358919"
  },
  {
    "text": "once it does that that basically it can",
    "start": "358919",
    "end": "360560"
  },
  {
    "text": "use the permissions of that compromise",
    "start": "360560",
    "end": "362479"
  },
  {
    "text": "pod and then escalate all the way to",
    "start": "362479",
    "end": "364400"
  },
  {
    "text": "become a cluster",
    "start": "364400",
    "end": "366599"
  },
  {
    "text": "admin so yeah um well we wanted to",
    "start": "366599",
    "end": "370319"
  },
  {
    "text": "extend kind of the permissions and the",
    "start": "370319",
    "end": "372199"
  },
  {
    "text": "restrictions that we have from the cuet",
    "start": "372199",
    "end": "374120"
  },
  {
    "text": "to be able to make this more General um",
    "start": "374120",
    "end": "375919"
  },
  {
    "text": "and so we we looked into well kep with",
    "start": "375919",
    "end": "377919"
  },
  {
    "text": "put together kept 4193 uh to improve",
    "start": "377919",
    "end": "380720"
  },
  {
    "text": "service account tokens uh to allow us to",
    "start": "380720",
    "end": "383800"
  },
  {
    "text": "start doing this kind of matching so um",
    "start": "383800",
    "end": "386800"
  },
  {
    "text": "service count tokens is how majority of",
    "start": "386800",
    "end": "388759"
  },
  {
    "text": "your workloads like these Damon sets are",
    "start": "388759",
    "end": "390520"
  },
  {
    "text": "going to authenticate to your API server",
    "start": "390520",
    "end": "393080"
  },
  {
    "text": "um and they yeah in kep 4193 we",
    "start": "393080",
    "end": "398360"
  },
  {
    "text": "basically instead of just binding pods",
    "start": "398360",
    "end": "400639"
  },
  {
    "text": "uh sorry binding your uh token to the",
    "start": "400639",
    "end": "403400"
  },
  {
    "text": "pod which embeds then the pod's name um",
    "start": "403400",
    "end": "406120"
  },
  {
    "text": "we're also going to bind uh sorry we",
    "start": "406120",
    "end": "408319"
  },
  {
    "text": "also now embed the node that the Pod is",
    "start": "408319",
    "end": "410919"
  },
  {
    "text": "scheduled to into that service count",
    "start": "410919",
    "end": "413080"
  },
  {
    "text": "token additionally in this cap it had a",
    "start": "413080",
    "end": "415440"
  },
  {
    "text": "few different angles to it uh we also",
    "start": "415440",
    "end": "417639"
  },
  {
    "text": "extending like The Binding capabilities",
    "start": "417639",
    "end": "419680"
  },
  {
    "text": "you can bind directly to nodes and",
    "start": "419680",
    "end": "421240"
  },
  {
    "text": "that's not something we're going to",
    "start": "421240",
    "end": "422000"
  },
  {
    "text": "demonstrate here today but um you know",
    "start": "422000",
    "end": "424360"
  },
  {
    "text": "this this also allows us to bind the",
    "start": "424360",
    "end": "426240"
  },
  {
    "text": "lifetime of a token to the lifetime of a",
    "start": "426240",
    "end": "429000"
  },
  {
    "text": "node so if the node object goes away the",
    "start": "429000",
    "end": "431000"
  },
  {
    "text": "token's invalidated similar to how if a",
    "start": "431000",
    "end": "433160"
  },
  {
    "text": "pod is deleted when you're bound to it",
    "start": "433160",
    "end": "435360"
  },
  {
    "text": "uh the tokens invalidated in the API",
    "start": "435360",
    "end": "437000"
  },
  {
    "text": "server will no longer accept it um",
    "start": "437000",
    "end": "439520"
  },
  {
    "text": "additionally we also added the extra jti",
    "start": "439520",
    "end": "442039"
  },
  {
    "text": "which is like a unique identifier for",
    "start": "442039",
    "end": "443680"
  },
  {
    "text": "each individual instance of a JWT",
    "start": "443680",
    "end": "446199"
  },
  {
    "text": "assigned token uh we embed a new jti",
    "start": "446199",
    "end": "449039"
  },
  {
    "text": "into each token to and that's actually",
    "start": "449039",
    "end": "450879"
  },
  {
    "text": "then recorded into the kubernetes audit",
    "start": "450879",
    "end": "453479"
  },
  {
    "text": "log as a credential",
    "start": "453479",
    "end": "455039"
  },
  {
    "text": "identifier um not all authentication",
    "start": "455039",
    "end": "457479"
  },
  {
    "text": "plugins support credential identifiers",
    "start": "457479",
    "end": "459479"
  },
  {
    "text": "just yet you know we need to have a",
    "start": "459479",
    "end": "460720"
  },
  {
    "text": "think about how we model this in um like",
    "start": "460720",
    "end": "464759"
  },
  {
    "text": "mtls or whatever else whatever other",
    "start": "464759",
    "end": "466639"
  },
  {
    "text": "plugin you've got uh so it's effectively",
    "start": "466639",
    "end": "468720"
  },
  {
    "text": "optional for now um but service account",
    "start": "468720",
    "end": "470639"
  },
  {
    "text": "tokens and jwt's uh do have this concept",
    "start": "470639",
    "end": "474000"
  },
  {
    "text": "A jti which we map to the new credential",
    "start": "474000",
    "end": "476440"
  },
  {
    "text": "identifier",
    "start": "476440",
    "end": "477680"
  },
  {
    "text": "concept so digging into that first one",
    "start": "477680",
    "end": "480520"
  },
  {
    "text": "this is kind of what it looks like so on",
    "start": "480520",
    "end": "482560"
  },
  {
    "text": "the left here you can see we've got um I",
    "start": "482560",
    "end": "485440"
  },
  {
    "text": "don't know how many people have decoded",
    "start": "485440",
    "end": "487080"
  },
  {
    "text": "a servers account token and looked at",
    "start": "487080",
    "end": "488680"
  },
  {
    "text": "this before um but you can see we've",
    "start": "488680",
    "end": "491280"
  },
  {
    "text": "actually got our private claim section",
    "start": "491280",
    "end": "493639"
  },
  {
    "text": "here uh kubernetes doio private claims",
    "start": "493639",
    "end": "496280"
  },
  {
    "text": "so the actual uh pod that we're bound to",
    "start": "496280",
    "end": "499159"
  },
  {
    "text": "is normally embedded here as just a pod",
    "start": "499159",
    "end": "501840"
  },
  {
    "text": "and the service account as well and the",
    "start": "501840",
    "end": "503639"
  },
  {
    "text": "API server uses that to understand like",
    "start": "503639",
    "end": "506280"
  },
  {
    "text": "when a request comes in it checks to",
    "start": "506280",
    "end": "507960"
  },
  {
    "text": "make sure this particular pod's still",
    "start": "507960",
    "end": "509599"
  },
  {
    "text": "exist with this particular uid because",
    "start": "509599",
    "end": "512680"
  },
  {
    "text": "like objects can be deleted and",
    "start": "512680",
    "end": "513839"
  },
  {
    "text": "recreated with the same name um and",
    "start": "513839",
    "end": "516560"
  },
  {
    "text": "that's you know worked up until now but",
    "start": "516560",
    "end": "518399"
  },
  {
    "text": "so that we can actually do matching to",
    "start": "518399",
    "end": "520240"
  },
  {
    "text": "understand where this pod runs so that",
    "start": "520240",
    "end": "522399"
  },
  {
    "text": "we can then later use that information",
    "start": "522399",
    "end": "524000"
  },
  {
    "text": "during admission to actually perform",
    "start": "524000",
    "end": "526000"
  },
  {
    "text": "additional validation um the API server",
    "start": "526000",
    "end": "530200"
  },
  {
    "text": "when it's minting these tokens now also",
    "start": "530200",
    "end": "532279"
  },
  {
    "text": "embeds the node name that the Pod",
    "start": "532279",
    "end": "534600"
  },
  {
    "text": "scheduled to so that's taken from kind",
    "start": "534600",
    "end": "536480"
  },
  {
    "text": "of the spec. node name on the Pod but",
    "start": "536480",
    "end": "538760"
  },
  {
    "text": "because it's actually embedded in the",
    "start": "538760",
    "end": "539959"
  },
  {
    "text": "JWT cryptographically signed then passed",
    "start": "539959",
    "end": "542399"
  },
  {
    "text": "along to the API server we can actually",
    "start": "542399",
    "end": "544240"
  },
  {
    "text": "use this and rely on it for like further",
    "start": "544240",
    "end": "546800"
  },
  {
    "text": "authorization decisions and that allows",
    "start": "546800",
    "end": "549000"
  },
  {
    "text": "us to kind of help mitigate some of",
    "start": "549000",
    "end": "550959"
  },
  {
    "text": "these cves that we've seen because it",
    "start": "550959",
    "end": "552920"
  },
  {
    "text": "prevents one token being valid for use",
    "start": "552920",
    "end": "554920"
  },
  {
    "text": "against any the objects related to other",
    "start": "554920",
    "end": "557279"
  },
  {
    "text": "nodes in a similar manner to the node",
    "start": "557279",
    "end": "558880"
  },
  {
    "text": "restriction plugin in fact we're even",
    "start": "558880",
    "end": "560920"
  },
  {
    "text": "using this change here to generalize how",
    "start": "560920",
    "end": "563560"
  },
  {
    "text": "the node restriction plugin is",
    "start": "563560",
    "end": "564760"
  },
  {
    "text": "implemented too so it's kind of",
    "start": "564760",
    "end": "566720"
  },
  {
    "text": "standardizing on some of these patterns",
    "start": "566720",
    "end": "568680"
  },
  {
    "text": "instead of special show casing certain",
    "start": "568680",
    "end": "570279"
  },
  {
    "text": "types of",
    "start": "570279",
    "end": "572680"
  },
  {
    "text": "identities um yeah if you want to read",
    "start": "573000",
    "end": "575480"
  },
  {
    "text": "up more on the full cap um it's 4193 got",
    "start": "575480",
    "end": "578800"
  },
  {
    "text": "link here um and yeah we're now going to",
    "start": "578800",
    "end": "582120"
  },
  {
    "text": "show you how you can kind of chain this",
    "start": "582120",
    "end": "583399"
  },
  {
    "text": "together well okay so we looked at the",
    "start": "583399",
    "end": "586320"
  },
  {
    "text": "cap uh which is a good first step for us",
    "start": "586320",
    "end": "588760"
  },
  {
    "text": "to impose restrictions on what a",
    "start": "588760",
    "end": "590760"
  },
  {
    "text": "particular node can do um that combined",
    "start": "590760",
    "end": "593720"
  },
  {
    "text": "with validating admission policies so",
    "start": "593720",
    "end": "596920"
  },
  {
    "text": "what is validating admission policies um",
    "start": "596920",
    "end": "599360"
  },
  {
    "text": "validating admission policies are",
    "start": "599360",
    "end": "601240"
  },
  {
    "text": "designed to be good alternatives for",
    "start": "601240",
    "end": "603880"
  },
  {
    "text": "validating web hooks for most common use",
    "start": "603880",
    "end": "605839"
  },
  {
    "text": "cases um unlike web hooks which require",
    "start": "605839",
    "end": "608360"
  },
  {
    "text": "you to run an external service um these",
    "start": "608360",
    "end": "611000"
  },
  {
    "text": "policies are actually handled within the",
    "start": "611000",
    "end": "613279"
  },
  {
    "text": "community's API server making them more",
    "start": "613279",
    "end": "615320"
  },
  {
    "text": "efficient and easier to manage since",
    "start": "615320",
    "end": "618079"
  },
  {
    "text": "they run in the cube API server they",
    "start": "618079",
    "end": "620279"
  },
  {
    "text": "avoid the need for external network",
    "start": "620279",
    "end": "622839"
  },
  {
    "text": "calls which means lower latency and more",
    "start": "622839",
    "end": "625600"
  },
  {
    "text": "reliable policy enforcement as they are",
    "start": "625600",
    "end": "627600"
  },
  {
    "text": "evaluated natively and then validating",
    "start": "627600",
    "end": "630839"
  },
  {
    "text": "uh admission policies uh use cell to",
    "start": "630839",
    "end": "633440"
  },
  {
    "text": "declare the validation rules for a",
    "start": "633440",
    "end": "636760"
  },
  {
    "text": "policy so this is a example of a",
    "start": "636760",
    "end": "640800"
  },
  {
    "text": "validation admission policy that we'll",
    "start": "640800",
    "end": "642720"
  },
  {
    "text": "be using in the demo uh this is",
    "start": "642720",
    "end": "645399"
  },
  {
    "text": "basically designed to restrict update",
    "start": "645399",
    "end": "647560"
  },
  {
    "text": "operations on nodes to a specific",
    "start": "647560",
    "end": "649839"
  },
  {
    "text": "service account uh and ensure those",
    "start": "649839",
    "end": "652720"
  },
  {
    "text": "updates are not specific um so let's",
    "start": "652720",
    "end": "655959"
  },
  {
    "text": "break it down uh the failure policy is",
    "start": "655959",
    "end": "658040"
  },
  {
    "text": "set to fail that means it's fail close",
    "start": "658040",
    "end": "660120"
  },
  {
    "text": "meaning any policy violations will block",
    "start": "660120",
    "end": "661880"
  },
  {
    "text": "the operation and then it applies to",
    "start": "661880",
    "end": "665120"
  },
  {
    "text": "within the match constraints you can see",
    "start": "665120",
    "end": "666760"
  },
  {
    "text": "it's applying to a subset of operations",
    "start": "666760",
    "end": "669600"
  },
  {
    "text": "so any operation that's trying to update",
    "start": "669600",
    "end": "672120"
  },
  {
    "text": "nodes basically says okay this matches",
    "start": "672120",
    "end": "674560"
  },
  {
    "text": "this policy we will go down the route",
    "start": "674560",
    "end": "676720"
  },
  {
    "text": "right but in addition to match",
    "start": "676720",
    "end": "678560"
  },
  {
    "text": "constraints there is also another thing",
    "start": "678560",
    "end": "680680"
  },
  {
    "text": "match conditions which checks if the",
    "start": "680680",
    "end": "684360"
  },
  {
    "text": "user that we're trying to restrict is",
    "start": "684360",
    "end": "686720"
  },
  {
    "text": "the one that's making this request only",
    "start": "686720",
    "end": "688480"
  },
  {
    "text": "then we want to go and evaluate the",
    "start": "688480",
    "end": "690560"
  },
  {
    "text": "policy so the is restricted user is",
    "start": "690560",
    "end": "692760"
  },
  {
    "text": "basically checking the username which is",
    "start": "692760",
    "end": "695279"
  },
  {
    "text": "part of the user info and it's checking",
    "start": "695279",
    "end": "697880"
  },
  {
    "text": "for this particular service account",
    "start": "697880",
    "end": "700440"
  },
  {
    "text": "which is what we're using in the demo so",
    "start": "700440",
    "end": "702200"
  },
  {
    "text": "it's running in default namespace and",
    "start": "702200",
    "end": "704200"
  },
  {
    "text": "it's called not Patcher essay and once",
    "start": "704200",
    "end": "707000"
  },
  {
    "text": "the match constraints and match",
    "start": "707000",
    "end": "708519"
  },
  {
    "text": "conditions are satisfied basically it",
    "start": "708519",
    "end": "710519"
  },
  {
    "text": "says okay this policy needs to be",
    "start": "710519",
    "end": "711920"
  },
  {
    "text": "evaluated for this particular operation",
    "start": "711920",
    "end": "714680"
  },
  {
    "text": "and then we Define a bunch of variables",
    "start": "714680",
    "end": "717040"
  },
  {
    "text": "uh the first thing is we get the user",
    "start": "717040",
    "end": "719360"
  },
  {
    "text": "node name so variables are defined so",
    "start": "719360",
    "end": "721279"
  },
  {
    "text": "that you can easily reuse them in your",
    "start": "721279",
    "end": "723040"
  },
  {
    "text": "validation Expressions uh so the user",
    "start": "723040",
    "end": "725320"
  },
  {
    "text": "node name extracts the node name from",
    "start": "725320",
    "end": "727360"
  },
  {
    "text": "the service accounts user info and this",
    "start": "727360",
    "end": "730600"
  },
  {
    "text": "is possible because of the cap that",
    "start": "730600",
    "end": "732560"
  },
  {
    "text": "James talked about and then the next",
    "start": "732560",
    "end": "734800"
  },
  {
    "text": "thing is we have the object node name",
    "start": "734800",
    "end": "737079"
  },
  {
    "text": "that we get from the object that is",
    "start": "737079",
    "end": "740079"
  },
  {
    "text": "being updated so that's the node that's",
    "start": "740079",
    "end": "742519"
  },
  {
    "text": "being updated so we can see what the",
    "start": "742519",
    "end": "744079"
  },
  {
    "text": "name of the object that's being updated",
    "start": "744079",
    "end": "745519"
  },
  {
    "text": "is and then the next step is we have a",
    "start": "745519",
    "end": "748440"
  },
  {
    "text": "bunch of validation that we want to do",
    "start": "748440",
    "end": "750120"
  },
  {
    "text": "the first thing is we want to reject",
    "start": "750120",
    "end": "752480"
  },
  {
    "text": "requests that do not have a usern node",
    "start": "752480",
    "end": "754399"
  },
  {
    "text": "name U this is possible if someone is",
    "start": "754399",
    "end": "756399"
  },
  {
    "text": "making a request outside of the node and",
    "start": "756399",
    "end": "758600"
  },
  {
    "text": "we don't want to allow those requests to",
    "start": "758600",
    "end": "760320"
  },
  {
    "text": "modify the set of PODS so that's the",
    "start": "760320",
    "end": "762480"
  },
  {
    "text": "first expression and then the second",
    "start": "762480",
    "end": "764199"
  },
  {
    "text": "expression basically checks the person",
    "start": "764199",
    "end": "767000"
  },
  {
    "text": "who is modifying so the node object",
    "start": "767000",
    "end": "769079"
  },
  {
    "text": "that's trying to modify another node",
    "start": "769079",
    "end": "771040"
  },
  {
    "text": "object both the node objects are the",
    "start": "771040",
    "end": "773279"
  },
  {
    "text": "same so basically you're imposing that",
    "start": "773279",
    "end": "776160"
  },
  {
    "text": "you are only allowed to modify yourself",
    "start": "776160",
    "end": "778320"
  },
  {
    "text": "and no one else",
    "start": "778320",
    "end": "781120"
  },
  {
    "text": "so this is what the user info looks like",
    "start": "782720",
    "end": "785720"
  },
  {
    "text": "uh basically this gets populated as part",
    "start": "785720",
    "end": "787480"
  },
  {
    "text": "of authenticating and after that this",
    "start": "787480",
    "end": "789880"
  },
  {
    "text": "user info and the extra fields are",
    "start": "789880",
    "end": "792079"
  },
  {
    "text": "available for authorization as well as",
    "start": "792079",
    "end": "794680"
  },
  {
    "text": "for admission um so I've gotten this",
    "start": "794680",
    "end": "797480"
  },
  {
    "text": "output using Cub City aot who am I um",
    "start": "797480",
    "end": "800639"
  },
  {
    "text": "and if you see there the user the",
    "start": "800639",
    "end": "802360"
  },
  {
    "text": "username is the name of the service",
    "start": "802360",
    "end": "804000"
  },
  {
    "text": "account that's trying to make the",
    "start": "804000",
    "end": "805160"
  },
  {
    "text": "request um and then in the extra you can",
    "start": "805160",
    "end": "809160"
  },
  {
    "text": "see that there is a new credential ID so",
    "start": "809160",
    "end": "810959"
  },
  {
    "text": "that's the jti that James talked about",
    "start": "810959",
    "end": "813600"
  },
  {
    "text": "and then we also have the node name and",
    "start": "813600",
    "end": "815760"
  },
  {
    "text": "the node uid as additional info which",
    "start": "815760",
    "end": "818440"
  },
  {
    "text": "was previously not present uh previously",
    "start": "818440",
    "end": "820720"
  },
  {
    "text": "we only had like the Pod name and the",
    "start": "820720",
    "end": "822560"
  },
  {
    "text": "Pod",
    "start": "822560",
    "end": "824800"
  },
  {
    "text": "uid okay so let's switch to demo um so",
    "start": "825000",
    "end": "830279"
  },
  {
    "text": "it's a simple setup I have a kind",
    "start": "830279",
    "end": "832079"
  },
  {
    "text": "cluster that's running two worker nodes",
    "start": "832079",
    "end": "834360"
  },
  {
    "text": "and I have three components um all",
    "start": "834360",
    "end": "836600"
  },
  {
    "text": "fictitious components not using it from",
    "start": "836600",
    "end": "838680"
  },
  {
    "text": "any pro",
    "start": "838680",
    "end": "839759"
  },
  {
    "text": "but basically I have a Damon set that",
    "start": "839759",
    "end": "841800"
  },
  {
    "text": "has permissions to patch a node which is",
    "start": "841800",
    "end": "843839"
  },
  {
    "text": "running on every single node uh then I",
    "start": "843839",
    "end": "846399"
  },
  {
    "text": "have a API pod that has permissions to",
    "start": "846399",
    "end": "849639"
  },
  {
    "text": "delete pods across the cluster and then",
    "start": "849639",
    "end": "852639"
  },
  {
    "text": "I have one secret operator which has",
    "start": "852639",
    "end": "855680"
  },
  {
    "text": "permissions to get list and create",
    "start": "855680",
    "end": "858800"
  },
  {
    "text": "secrets and these are all rback",
    "start": "858800",
    "end": "860759"
  },
  {
    "text": "permissions those components need for a",
    "start": "860759",
    "end": "862880"
  },
  {
    "text": "specific use case right um so I'm am",
    "start": "862880",
    "end": "865920"
  },
  {
    "text": "going to say the kind worker to node is",
    "start": "865920",
    "end": "869480"
  },
  {
    "text": "the compromise node so what we're going",
    "start": "869480",
    "end": "871079"
  },
  {
    "text": "to do is exec into that particular",
    "start": "871079",
    "end": "875600"
  },
  {
    "text": "node so once we are on that node",
    "start": "876399",
    "end": "878920"
  },
  {
    "text": "basically what we're going to do is exec",
    "start": "878920",
    "end": "882120"
  },
  {
    "text": "into",
    "start": "882120",
    "end": "883519"
  },
  {
    "text": "the so basically these are the list of",
    "start": "883519",
    "end": "885800"
  },
  {
    "text": "containers that's running in that",
    "start": "885800",
    "end": "887519"
  },
  {
    "text": "particular node and as you can see there",
    "start": "887519",
    "end": "890240"
  },
  {
    "text": "is a Damon set Port that's running in",
    "start": "890240",
    "end": "892079"
  },
  {
    "text": "that right so I am going to exit into",
    "start": "892079",
    "end": "895199"
  },
  {
    "text": "that Damon set",
    "start": "895199",
    "end": "898759"
  },
  {
    "text": "so okay so I'm inside the Damon set and",
    "start": "908079",
    "end": "911079"
  },
  {
    "text": "then this Damon set has permissions to",
    "start": "911079",
    "end": "913000"
  },
  {
    "text": "patch any nodes so what I'm going to do",
    "start": "913000",
    "end": "915360"
  },
  {
    "text": "is run a cube CDL command and say I'm",
    "start": "915360",
    "end": "919120"
  },
  {
    "text": "running on kind worker to I'm just going",
    "start": "919120",
    "end": "921040"
  },
  {
    "text": "to patch kind worker and make it",
    "start": "921040",
    "end": "922639"
  },
  {
    "text": "unschedulable as a first",
    "start": "922639",
    "end": "924959"
  },
  {
    "text": "St so the operation succeeds because I",
    "start": "924959",
    "end": "928199"
  },
  {
    "text": "just have patch Miss across the entire",
    "start": "928199",
    "end": "930440"
  },
  {
    "text": "cluster and then if I do c c get nodes",
    "start": "930440",
    "end": "933600"
  },
  {
    "text": "you can see that kind worker scheduling",
    "start": "933600",
    "end": "936199"
  },
  {
    "text": "is been uh disabled for that particular",
    "start": "936199",
    "end": "940199"
  },
  {
    "text": "node uh and then the next thing that",
    "start": "940199",
    "end": "942319"
  },
  {
    "text": "we're going to do is I have a API pod",
    "start": "942319",
    "end": "946120"
  },
  {
    "text": "that has delete permissions also running",
    "start": "946120",
    "end": "948160"
  },
  {
    "text": "on this node so I'm going to get into",
    "start": "948160",
    "end": "951839"
  },
  {
    "text": "that",
    "start": "951839",
    "end": "954839"
  },
  {
    "text": "okay so I'm inside that pod which can",
    "start": "961040",
    "end": "963319"
  },
  {
    "text": "delete any pod so what I'm going to do",
    "start": "963319",
    "end": "965920"
  },
  {
    "text": "is using that permission I'm going to",
    "start": "965920",
    "end": "968560"
  },
  {
    "text": "delete the secret operator pod that is",
    "start": "968560",
    "end": "971519"
  },
  {
    "text": "running on the other node which is not",
    "start": "971519",
    "end": "974440"
  },
  {
    "text": "compromised because I want to force it",
    "start": "974440",
    "end": "976199"
  },
  {
    "text": "to land on my compromise",
    "start": "976199",
    "end": "978600"
  },
  {
    "text": "node damn",
    "start": "978600",
    "end": "981839"
  },
  {
    "text": "it okay so I'm going want to delete that",
    "start": "986720",
    "end": "989720"
  },
  {
    "text": "pwn and then if we now go",
    "start": "989720",
    "end": "994800"
  },
  {
    "text": "look uh okay so if you see now the",
    "start": "995720",
    "end": "998480"
  },
  {
    "text": "secret operator was initially running in",
    "start": "998480",
    "end": "1000079"
  },
  {
    "text": "kind worker now it's been moved to my",
    "start": "1000079",
    "end": "1002680"
  },
  {
    "text": "compromise node the Rogue node so I",
    "start": "1002680",
    "end": "1005360"
  },
  {
    "text": "basically have all the pods that I want",
    "start": "1005360",
    "end": "1007199"
  },
  {
    "text": "right so the next thing I'm going to do",
    "start": "1007199",
    "end": "1009560"
  },
  {
    "text": "is get into my operator",
    "start": "1009560",
    "end": "1013480"
  },
  {
    "text": "node let's",
    "start": "1013480",
    "end": "1016959"
  },
  {
    "text": "quickly get those one so the secret",
    "start": "1016959",
    "end": "1020880"
  },
  {
    "text": "operator is here so I'm going to exit",
    "start": "1020880",
    "end": "1022920"
  },
  {
    "text": "into",
    "start": "1022920",
    "end": "1025199"
  },
  {
    "text": "that okay so this secret operator pod",
    "start": "1033000",
    "end": "1035760"
  },
  {
    "text": "has permissions to get list and create",
    "start": "1035760",
    "end": "1038558"
  },
  {
    "text": "Secrets um so what I'm going to do with",
    "start": "1038559",
    "end": "1041079"
  },
  {
    "text": "that is before I do anything I'm going",
    "start": "1041079",
    "end": "1043798"
  },
  {
    "text": "to check what the permissions are right",
    "start": "1043799",
    "end": "1045880"
  },
  {
    "text": "so I'm going to see hey I am a secret",
    "start": "1045880",
    "end": "1048400"
  },
  {
    "text": "operator",
    "start": "1048400",
    "end": "1049520"
  },
  {
    "text": "can I create pods no so that means we",
    "start": "1049520",
    "end": "1052600"
  },
  {
    "text": "know that right now the rback",
    "start": "1052600",
    "end": "1053960"
  },
  {
    "text": "permissions is it can only get list and",
    "start": "1053960",
    "end": "1055840"
  },
  {
    "text": "create secrets and can do nothing more",
    "start": "1055840",
    "end": "1057720"
  },
  {
    "text": "right the next thing I'm going to do is",
    "start": "1057720",
    "end": "1060039"
  },
  {
    "text": "I'm going to create this special",
    "start": "1060039",
    "end": "1063000"
  },
  {
    "text": "kubernetes secret uh so I'm creating the",
    "start": "1063000",
    "end": "1065440"
  },
  {
    "text": "secret which is of type service account",
    "start": "1065440",
    "end": "1068080"
  },
  {
    "text": "token and I'm creating this in the cube",
    "start": "1068080",
    "end": "1070320"
  },
  {
    "text": "system namespace and if you look at it",
    "start": "1070320",
    "end": "1072679"
  },
  {
    "text": "I'm using a specific service account for",
    "start": "1072679",
    "end": "1075360"
  },
  {
    "text": "this one which is the cluster role",
    "start": "1075360",
    "end": "1077640"
  },
  {
    "text": "aggregation controller",
    "start": "1077640",
    "end": "1079400"
  },
  {
    "text": "uh the reason I'm using this is this",
    "start": "1079400",
    "end": "1081280"
  },
  {
    "text": "service account in the cube system",
    "start": "1081280",
    "end": "1082559"
  },
  {
    "text": "namespace actually has permissions to",
    "start": "1082559",
    "end": "1086440"
  },
  {
    "text": "escalate which means I can use those",
    "start": "1086440",
    "end": "1089039"
  },
  {
    "text": "permissions to modify the cluster role",
    "start": "1089039",
    "end": "1092000"
  },
  {
    "text": "for any uh I can modify any cluster role",
    "start": "1092000",
    "end": "1096440"
  },
  {
    "text": "and basically I can elevate my cluster",
    "start": "1096440",
    "end": "1099000"
  },
  {
    "text": "role to become cluster admin so once I",
    "start": "1099000",
    "end": "1102240"
  },
  {
    "text": "do this basically what happens is the",
    "start": "1102240",
    "end": "1104520"
  },
  {
    "text": "controller is going to populate that",
    "start": "1104520",
    "end": "1107720"
  },
  {
    "text": "kubernetes secret that just created with",
    "start": "1107720",
    "end": "1110600"
  },
  {
    "text": "a token",
    "start": "1110600",
    "end": "1112559"
  },
  {
    "text": "so so if you look at this basically",
    "start": "1112559",
    "end": "1115360"
  },
  {
    "text": "there is a token field there is caert",
    "start": "1115360",
    "end": "1117520"
  },
  {
    "text": "and everything that we need but the",
    "start": "1117520",
    "end": "1119440"
  },
  {
    "text": "token is the only thing that I really",
    "start": "1119440",
    "end": "1120880"
  },
  {
    "text": "care about because I'm going to use that",
    "start": "1120880",
    "end": "1122760"
  },
  {
    "text": "for modifying the cluster role so let's",
    "start": "1122760",
    "end": "1126320"
  },
  {
    "text": "put the token in a",
    "start": "1126320",
    "end": "1130320"
  },
  {
    "text": "variable okay and then let's check it's",
    "start": "1130320",
    "end": "1133880"
  },
  {
    "text": "there okay so I have a token and the",
    "start": "1133880",
    "end": "1136840"
  },
  {
    "text": "next thing I'm going to do is within my",
    "start": "1136840",
    "end": "1139720"
  },
  {
    "text": "pod within my secret manager pod I'm",
    "start": "1139720",
    "end": "1142080"
  },
  {
    "text": "going to go and edit my own cluster",
    "start": "1142080",
    "end": "1145280"
  },
  {
    "text": "role so this edit should wouldn't have",
    "start": "1145280",
    "end": "1148280"
  },
  {
    "text": "worked normally but because I was able",
    "start": "1148280",
    "end": "1150840"
  },
  {
    "text": "to get a token for the cluster roll",
    "start": "1150840",
    "end": "1152360"
  },
  {
    "text": "aggregator controller I can actually now",
    "start": "1152360",
    "end": "1154440"
  },
  {
    "text": "edit it and all I have to do is go in",
    "start": "1154440",
    "end": "1158880"
  },
  {
    "text": "basically say any API",
    "start": "1158880",
    "end": "1162720"
  },
  {
    "text": "groups any resource",
    "start": "1164159",
    "end": "1168520"
  },
  {
    "text": "[Music]",
    "start": "1168820",
    "end": "1170840"
  },
  {
    "text": "and any word so that's it I can be a",
    "start": "1170840",
    "end": "1174600"
  },
  {
    "text": "cluster admin so I've edited that and",
    "start": "1174600",
    "end": "1178120"
  },
  {
    "text": "then now basically we can run the same O",
    "start": "1178120",
    "end": "1181480"
  },
  {
    "text": "command now to check if I can still",
    "start": "1181480",
    "end": "1185840"
  },
  {
    "text": "let's",
    "start": "1185840",
    "end": "1186960"
  },
  {
    "text": "see okay so if I now do Cube CDL o can I",
    "start": "1186960",
    "end": "1191200"
  },
  {
    "text": "create pods yes I can do",
    "start": "1191200",
    "end": "1194240"
  },
  {
    "text": "it delete pods yeah I can do that too",
    "start": "1194240",
    "end": "1198039"
  },
  {
    "text": "and then",
    "start": "1198039",
    "end": "1199960"
  },
  {
    "text": "if I want to create cluster Ro yeah I",
    "start": "1199960",
    "end": "1203080"
  },
  {
    "text": "can do that as well so that means",
    "start": "1203080",
    "end": "1205080"
  },
  {
    "text": "basically I started off with a",
    "start": "1205080",
    "end": "1207000"
  },
  {
    "text": "compromise node moved all the way moved",
    "start": "1207000",
    "end": "1209039"
  },
  {
    "text": "all the pods to my node and then I was",
    "start": "1209039",
    "end": "1210840"
  },
  {
    "text": "able to become a cluster admin",
    "start": "1210840",
    "end": "1214840"
  },
  {
    "text": "right so now that we've seen the",
    "start": "1215200",
    "end": "1217799"
  },
  {
    "text": "vulnerability in action it's clear that",
    "start": "1217799",
    "end": "1219760"
  },
  {
    "text": "the issue started because a node was",
    "start": "1219760",
    "end": "1221840"
  },
  {
    "text": "able to update other nodes while there",
    "start": "1221840",
    "end": "1223960"
  },
  {
    "text": "are other components that are part of",
    "start": "1223960",
    "end": "1225720"
  },
  {
    "text": "the demo that can be constrained more I",
    "start": "1225720",
    "end": "1228360"
  },
  {
    "text": "think in this demo we'll focus",
    "start": "1228360",
    "end": "1230200"
  },
  {
    "text": "specifically on limiting the operations",
    "start": "1230200",
    "end": "1233159"
  },
  {
    "text": "that a not can do right and I already",
    "start": "1233159",
    "end": "1236159"
  },
  {
    "text": "have the feature flags and everything",
    "start": "1236159",
    "end": "1237600"
  },
  {
    "text": "enabled for um the feature gate that",
    "start": "1237600",
    "end": "1241039"
  },
  {
    "text": "James was talking about also it's in",
    "start": "1241039",
    "end": "1242640"
  },
  {
    "text": "beta so it's enabled by default so the",
    "start": "1242640",
    "end": "1244760"
  },
  {
    "text": "next thing I'm going to do is deploy a",
    "start": "1244760",
    "end": "1246960"
  },
  {
    "text": "validating admission policy so this is",
    "start": "1246960",
    "end": "1248760"
  },
  {
    "text": "the same policy that we looked at before",
    "start": "1248760",
    "end": "1251039"
  },
  {
    "text": "which has which is going to try and",
    "start": "1251039",
    "end": "1253559"
  },
  {
    "text": "restrict that a node can only update",
    "start": "1253559",
    "end": "1256159"
  },
  {
    "text": "objects that belong to the same node",
    "start": "1256159",
    "end": "1260320"
  },
  {
    "text": "so I'm going to apply the",
    "start": "1260640",
    "end": "1262360"
  },
  {
    "text": "WAP so that we've done that and then the",
    "start": "1262360",
    "end": "1265840"
  },
  {
    "text": "next thing we have to do is for a",
    "start": "1265840",
    "end": "1267400"
  },
  {
    "text": "validating admission policy to take take",
    "start": "1267400",
    "end": "1269320"
  },
  {
    "text": "effect you also have to apply a binding",
    "start": "1269320",
    "end": "1271600"
  },
  {
    "text": "and in The Binding in validation actions",
    "start": "1271600",
    "end": "1273760"
  },
  {
    "text": "you can actually choose if you want to",
    "start": "1273760",
    "end": "1275240"
  },
  {
    "text": "deny the request you want to one or you",
    "start": "1275240",
    "end": "1277360"
  },
  {
    "text": "want to audit so in this case I've set",
    "start": "1277360",
    "end": "1279799"
  },
  {
    "text": "it to one just so we can see if the",
    "start": "1279799",
    "end": "1283039"
  },
  {
    "text": "validating admission policy is working",
    "start": "1283039",
    "end": "1284720"
  },
  {
    "text": "as expected before we actually start",
    "start": "1284720",
    "end": "1286880"
  },
  {
    "text": "imposing the restriction",
    "start": "1286880",
    "end": "1289440"
  },
  {
    "text": "so I am going to apply The Binding okay",
    "start": "1289440",
    "end": "1294960"
  },
  {
    "text": "so we still on the Rogue node um and I'm",
    "start": "1294960",
    "end": "1298200"
  },
  {
    "text": "still inside the Damon set pod here",
    "start": "1298200",
    "end": "1300880"
  },
  {
    "text": "let's try to patch so this time when I",
    "start": "1300880",
    "end": "1303039"
  },
  {
    "text": "try to patch I get a warning saying",
    "start": "1303039",
    "end": "1306240"
  },
  {
    "text": "validation failed for this validating",
    "start": "1306240",
    "end": "1307679"
  },
  {
    "text": "admission policy you are trying to",
    "start": "1307679",
    "end": "1309960"
  },
  {
    "text": "update a node that doesn't belong to you",
    "start": "1309960",
    "end": "1312400"
  },
  {
    "text": "so this is a warning so let's change it",
    "start": "1312400",
    "end": "1316159"
  },
  {
    "text": "to deny",
    "start": "1316159",
    "end": "1318640"
  },
  {
    "text": "and then let me now update The Binding",
    "start": "1318640",
    "end": "1322840"
  },
  {
    "text": "okay so now we still on the Rogue node",
    "start": "1322840",
    "end": "1324640"
  },
  {
    "text": "we still on the Damon set and now if I",
    "start": "1324640",
    "end": "1326760"
  },
  {
    "text": "try to patch my um request doesn't go",
    "start": "1326760",
    "end": "1330120"
  },
  {
    "text": "through because the validating admission",
    "start": "1330120",
    "end": "1331679"
  },
  {
    "text": "policy says hey you are kind worker too",
    "start": "1331679",
    "end": "1334720"
  },
  {
    "text": "you are not allowed to modify kind",
    "start": "1334720",
    "end": "1336480"
  },
  {
    "text": "worker and your request is",
    "start": "1336480",
    "end": "1339840"
  },
  {
    "text": "denied uh okay so that was a demo",
    "start": "1342000",
    "end": "1346240"
  },
  {
    "text": "showcasing everything that we talked",
    "start": "1346240",
    "end": "1348039"
  },
  {
    "text": "about all the Caps uh that have gone in",
    "start": "1348039",
    "end": "1350840"
  },
  {
    "text": "the validating admission policy which is",
    "start": "1350840",
    "end": "1352520"
  },
  {
    "text": "available how you can basically",
    "start": "1352520",
    "end": "1354240"
  },
  {
    "text": "compromise a single node and get all the",
    "start": "1354240",
    "end": "1356000"
  },
  {
    "text": "way to a clust rment and what are ways",
    "start": "1356000",
    "end": "1358240"
  },
  {
    "text": "to prevent that for Damon sets um so in",
    "start": "1358240",
    "end": "1360960"
  },
  {
    "text": "terms of follow-ups uh we are working on",
    "start": "1360960",
    "end": "1364520"
  },
  {
    "text": "enhancing uh adding more restrictions in",
    "start": "1364520",
    "end": "1367200"
  },
  {
    "text": "cuit maybe this will also be relevant",
    "start": "1367200",
    "end": "1369120"
  },
  {
    "text": "for Damon s in the future but the first",
    "start": "1369120",
    "end": "1371120"
  },
  {
    "text": "thing that we're doing is we in this 132",
    "start": "1371120",
    "end": "1374360"
  },
  {
    "text": "release we added restriction for what",
    "start": "1374360",
    "end": "1377799"
  },
  {
    "text": "audiences cuet can request a token for",
    "start": "1377799",
    "end": "1381000"
  },
  {
    "text": "um previously cuet could just arbitr",
    "start": "1381000",
    "end": "1383559"
  },
  {
    "text": "request for any audience saying Hey I",
    "start": "1383559",
    "end": "1385760"
  },
  {
    "text": "want for a particular pod but now the",
    "start": "1385760",
    "end": "1388400"
  },
  {
    "text": "node restriction admission plug-in will",
    "start": "1388400",
    "end": "1390440"
  },
  {
    "text": "actually check that the audience that",
    "start": "1390440",
    "end": "1392320"
  },
  {
    "text": "cuet is requesting a token for belongs",
    "start": "1392320",
    "end": "1394240"
  },
  {
    "text": "in the pods API spec so this could be in",
    "start": "1394240",
    "end": "1396840"
  },
  {
    "text": "CSI driver tokens or like projected",
    "start": "1396840",
    "end": "1399559"
  },
  {
    "text": "volume sources uh and then in the future",
    "start": "1399559",
    "end": "1402320"
  },
  {
    "text": "we can even expand it to have like",
    "start": "1402320",
    "end": "1404279"
  },
  {
    "text": "additional audiences that the user can",
    "start": "1404279",
    "end": "1406279"
  },
  {
    "text": "configure on the cube API server and and",
    "start": "1406279",
    "end": "1409080"
  },
  {
    "text": "in addition to that we are also working",
    "start": "1409080",
    "end": "1410720"
  },
  {
    "text": "on a cap to basically send service",
    "start": "1410720",
    "end": "1414039"
  },
  {
    "text": "projected service account tokens to cuet",
    "start": "1414039",
    "end": "1416600"
  },
  {
    "text": "image credential providers so we're",
    "start": "1416600",
    "end": "1418720"
  },
  {
    "text": "trying to introduce that so that the",
    "start": "1418720",
    "end": "1422200"
  },
  {
    "text": "credential providers can use service",
    "start": "1422200",
    "end": "1423840"
  },
  {
    "text": "accounts for worklad identity flows and",
    "start": "1423840",
    "end": "1426919"
  },
  {
    "text": "basically pull images using the identity",
    "start": "1426919",
    "end": "1429960"
  },
  {
    "text": "that's associated with the Pod for which",
    "start": "1429960",
    "end": "1431679"
  },
  {
    "text": "the image is being pulled rather than",
    "start": "1431679",
    "end": "1433520"
  },
  {
    "text": "just doing it for like an entire",
    "start": "1433520",
    "end": "1435039"
  },
  {
    "text": "registry or for like a particular image",
    "start": "1435039",
    "end": "1439919"
  },
  {
    "text": "um but other than that um a similar talk",
    "start": "1439919",
    "end": "1442960"
  },
  {
    "text": "was given so David EES and Joe bets uh",
    "start": "1442960",
    "end": "1445799"
  },
  {
    "text": "gave a maintainer update and for the Sig",
    "start": "1445799",
    "end": "1447919"
  },
  {
    "text": "API machinery for all the work that has",
    "start": "1447919",
    "end": "1449559"
  },
  {
    "text": "gone in uh in this talk we focused",
    "start": "1449559",
    "end": "1452120"
  },
  {
    "text": "specifically on the right aspect of it",
    "start": "1452120",
    "end": "1454039"
  },
  {
    "text": "but in the API machinary talk they also",
    "start": "1454039",
    "end": "1456880"
  },
  {
    "text": "talked about how you can prevent",
    "start": "1456880",
    "end": "1458559"
  },
  {
    "text": "trampoline",
    "start": "1458559",
    "end": "1461120"
  },
  {
    "text": "reads but uh yeah that's it",
    "start": "1461520",
    "end": "1466760"
  },
  {
    "text": "have we got any questions I think we got",
    "start": "1472039",
    "end": "1473520"
  },
  {
    "text": "a bit of time uh there's a couple of",
    "start": "1473520",
    "end": "1476039"
  },
  {
    "text": "mics here as",
    "start": "1476039",
    "end": "1478679"
  },
  {
    "text": "well looks like we got all the",
    "start": "1481399",
    "end": "1483360"
  },
  {
    "text": "information we needed in",
    "start": "1483360",
    "end": "1486278"
  },
  {
    "text": "that so quite often the kuet will",
    "start": "1490000",
    "end": "1493360"
  },
  {
    "text": "integrate with cloud provider resources",
    "start": "1493360",
    "end": "1495720"
  },
  {
    "text": "like say Enis and any plans to extend",
    "start": "1495720",
    "end": "1500840"
  },
  {
    "text": "this ta control policy to nonc",
    "start": "1500840",
    "end": "1504880"
  },
  {
    "text": "resources to to what sorry non",
    "start": "1504880",
    "end": "1507360"
  },
  {
    "text": "kubernetes like cloud provider",
    "start": "1507360",
    "end": "1510520"
  },
  {
    "text": "resources so I think like these",
    "start": "1510520",
    "end": "1513000"
  },
  {
    "text": "projected service count tokens um you",
    "start": "1513000",
    "end": "1514960"
  },
  {
    "text": "can choose like your uh audience on",
    "start": "1514960",
    "end": "1517360"
  },
  {
    "text": "there so I think it's you could you can",
    "start": "1517360",
    "end": "1520679"
  },
  {
    "text": "pass these along to external systems",
    "start": "1520679",
    "end": "1523080"
  },
  {
    "text": "then because they've got a different",
    "start": "1523080",
    "end": "1523960"
  },
  {
    "text": "audience scope and you can certainly",
    "start": "1523960",
    "end": "1525760"
  },
  {
    "text": "then use that node name information and",
    "start": "1525760",
    "end": "1527440"
  },
  {
    "text": "cross reference that with anything else",
    "start": "1527440",
    "end": "1529039"
  },
  {
    "text": "yeah I think like",
    "start": "1529039",
    "end": "1531880"
  },
  {
    "text": "um yeah so you can make authorization",
    "start": "1531880",
    "end": "1534120"
  },
  {
    "text": "decisions based on this absolutely and",
    "start": "1534120",
    "end": "1535840"
  },
  {
    "text": "that that's certainly is another use",
    "start": "1535840",
    "end": "1537240"
  },
  {
    "text": "case for it is cross referencing with",
    "start": "1537240",
    "end": "1539279"
  },
  {
    "text": "you know other credentials Network you",
    "start": "1539279",
    "end": "1541240"
  },
  {
    "text": "know properties and things like that to",
    "start": "1541240",
    "end": "1543320"
  },
  {
    "text": "make sure that that is correct like you",
    "start": "1543320",
    "end": "1547600"
  },
  {
    "text": "can't we don't have a way to bind to",
    "start": "1547600",
    "end": "1549880"
  },
  {
    "text": "arbitrary random things you can bind",
    "start": "1549880",
    "end": "1551679"
  },
  {
    "text": "right now to like pods or nodes and it's",
    "start": "1551679",
    "end": "1553159"
  },
  {
    "text": "only pods that would actually get this",
    "start": "1553159",
    "end": "1554360"
  },
  {
    "text": "node information so I think yes for",
    "start": "1554360",
    "end": "1556840"
  },
  {
    "text": "making further authorization decisions",
    "start": "1556840",
    "end": "1558880"
  },
  {
    "text": "um certainly um yeah thank",
    "start": "1558880",
    "end": "1563399"
  },
  {
    "text": "you so like uh trampoline pods are like",
    "start": "1563399",
    "end": "1567279"
  },
  {
    "text": "obviously the flashiest like example but",
    "start": "1567279",
    "end": "1570760"
  },
  {
    "text": "um you're there's always a chance that",
    "start": "1570760",
    "end": "1572960"
  },
  {
    "text": "the um node that an attacker gets is",
    "start": "1572960",
    "end": "1576600"
  },
  {
    "text": "already has a trampoline node on it so",
    "start": "1576600",
    "end": "1579120"
  },
  {
    "text": "like Beyond like scheduling I mean",
    "start": "1579120",
    "end": "1581440"
  },
  {
    "text": "disable scheduling to force every no uh",
    "start": "1581440",
    "end": "1583799"
  },
  {
    "text": "every pod to be on you like is what are",
    "start": "1583799",
    "end": "1586880"
  },
  {
    "text": "the other like security Improv ments we",
    "start": "1586880",
    "end": "1588760"
  },
  {
    "text": "can realize with something like",
    "start": "1588760",
    "end": "1592159"
  },
  {
    "text": "this I so I think for the trampolino",
    "start": "1592159",
    "end": "1595399"
  },
  {
    "text": "thing there I would probably say you",
    "start": "1595399",
    "end": "1597799"
  },
  {
    "text": "know using things like uh taints",
    "start": "1597799",
    "end": "1599760"
  },
  {
    "text": "tolerations and restricting who can use",
    "start": "1599760",
    "end": "1601880"
  },
  {
    "text": "those is probably the first step I'd go",
    "start": "1601880",
    "end": "1603760"
  },
  {
    "text": "for like further avoiding like any",
    "start": "1603760",
    "end": "1605799"
  },
  {
    "text": "chance that you might just happen to be",
    "start": "1605799",
    "end": "1607120"
  },
  {
    "text": "on that node already um obviously",
    "start": "1607120",
    "end": "1610039"
  },
  {
    "text": "previously in this example I think you",
    "start": "1610039",
    "end": "1612559"
  },
  {
    "text": "know if you",
    "start": "1612559",
    "end": "1613799"
  },
  {
    "text": "didn't if you didn't have uh sorry if",
    "start": "1613799",
    "end": "1617200"
  },
  {
    "text": "you didn't have taints and toleration",
    "start": "1617200",
    "end": "1618520"
  },
  {
    "text": "yet you could totally land on there and",
    "start": "1618520",
    "end": "1619799"
  },
  {
    "text": "do it with that though because you can",
    "start": "1619799",
    "end": "1621600"
  },
  {
    "text": "now no longer laterally move to the next",
    "start": "1621600",
    "end": "1623919"
  },
  {
    "text": "node um you kind of gain gain that",
    "start": "1623919",
    "end": "1627399"
  },
  {
    "text": "already there um yeah so I I think this",
    "start": "1627399",
    "end": "1630679"
  },
  {
    "text": "complements things like node pools and",
    "start": "1630679",
    "end": "1632760"
  },
  {
    "text": "whatever else and like high secure nodes",
    "start": "1632760",
    "end": "1635480"
  },
  {
    "text": "um quite well thank",
    "start": "1635480",
    "end": "1638880"
  },
  {
    "text": "you hi thank you for the talk um you may",
    "start": "1638880",
    "end": "1641919"
  },
  {
    "text": "have already suggested this but is there",
    "start": "1641919",
    "end": "1644320"
  },
  {
    "text": "any plan to have any of this kind of",
    "start": "1644320",
    "end": "1646080"
  },
  {
    "text": "default into a sort of uh admission like",
    "start": "1646080",
    "end": "1649120"
  },
  {
    "text": "the with the node authorizer is there",
    "start": "1649120",
    "end": "1651440"
  },
  {
    "text": "something where it could be packaged up",
    "start": "1651440",
    "end": "1652919"
  },
  {
    "text": "do you expect that this will break",
    "start": "1652919",
    "end": "1655399"
  },
  {
    "text": "certain uh abuse and and providers that",
    "start": "1655399",
    "end": "1658480"
  },
  {
    "text": "may have misused the API or or I I guess",
    "start": "1658480",
    "end": "1661799"
  },
  {
    "text": "the end question is is this possible to",
    "start": "1661799",
    "end": "1663640"
  },
  {
    "text": "get into be default in the end uh so",
    "start": "1663640",
    "end": "1666799"
  },
  {
    "text": "they actually had a good answer for that",
    "start": "1666799",
    "end": "1668279"
  },
  {
    "text": "in the API machinary one uh there is",
    "start": "1668279",
    "end": "1670399"
  },
  {
    "text": "going to be future work um around this",
    "start": "1670399",
    "end": "1672840"
  },
  {
    "text": "not specifically in the node authorizer",
    "start": "1672840",
    "end": "1674399"
  },
  {
    "text": "because it's very specific to cuid but",
    "start": "1674399",
    "end": "1677080"
  },
  {
    "text": "again with this there are a bunch of",
    "start": "1677080",
    "end": "1678880"
  },
  {
    "text": "steps that like someone has to configure",
    "start": "1678880",
    "end": "1680760"
  },
  {
    "text": "right and they have to get everything",
    "start": "1680760",
    "end": "1681960"
  },
  {
    "text": "right and for each component which is",
    "start": "1681960",
    "end": "1685399"
  },
  {
    "text": "not easy at all so there is some work",
    "start": "1685399",
    "end": "1688000"
  },
  {
    "text": "going to happen in the future around",
    "start": "1688000",
    "end": "1689840"
  },
  {
    "text": "this uh there are a couple of other caps",
    "start": "1689840",
    "end": "1692240"
  },
  {
    "text": "that are inlight uh so yeah I mean I",
    "start": "1692240",
    "end": "1695679"
  },
  {
    "text": "would say watch out for that space and",
    "start": "1695679",
    "end": "1697279"
  },
  {
    "text": "awesome thank you guys I think the",
    "start": "1697279",
    "end": "1699720"
  },
  {
    "text": "validating Mission policy there is like",
    "start": "1699720",
    "end": "1701559"
  },
  {
    "text": "quite quite D and hard to read um and I",
    "start": "1701559",
    "end": "1704039"
  },
  {
    "text": "I I think this is kind of like the",
    "start": "1704039",
    "end": "1705480"
  },
  {
    "text": "lowest common denominator uh way to do",
    "start": "1705480",
    "end": "1707960"
  },
  {
    "text": "it whilst we're still working out these",
    "start": "1707960",
    "end": "1712120"
  },
  {
    "text": "patterns thanks very much everyone thank",
    "start": "1714799",
    "end": "1717240"
  },
  {
    "text": "you",
    "start": "1717240",
    "end": "1720240"
  }
]