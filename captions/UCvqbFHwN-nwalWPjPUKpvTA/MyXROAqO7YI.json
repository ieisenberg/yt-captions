[
  {
    "start": "0",
    "end": "40000"
  },
  {
    "text": "cool so yeah I'm Anne Wallace global practice lead for Google cloud",
    "start": "0",
    "end": "5190"
  },
  {
    "text": "professional services Stephen just said I'm Micah Trotsky my product manager and",
    "start": "5190",
    "end": "10980"
  },
  {
    "text": "security at Google so what we're going to be talking about today is how to get started with container forensics when it",
    "start": "10980",
    "end": "16410"
  },
  {
    "text": "turns out that your cluster is a cluster we'll cover why you should care because the tactic containers are real what",
    "start": "16410",
    "end": "22109"
  },
  {
    "text": "forensics are and how to prepare ahead of time data sources that you can use for investigations for containers",
    "start": "22109",
    "end": "27840"
  },
  {
    "text": "specifically common mitigation options and then finally what you can do today so talking about why are we even talking",
    "start": "27840",
    "end": "35070"
  },
  {
    "text": "about container forensics do containers actually get attacked at all and so what",
    "start": "35070",
    "end": "40290"
  },
  {
    "start": "40000",
    "end": "40000"
  },
  {
    "text": "we're looking back at last year what are the attacks that we've seen in the wild in February 2018 Tesla made the news for",
    "start": "40290",
    "end": "46140"
  },
  {
    "text": "attackers finding credentials that they had gained to mind cryptocurrency in May Shopify had a researcher report of ulnar",
    "start": "46140",
    "end": "52289"
  },
  {
    "text": "ability in their cluster configuration thankfully this was not exploited in June weight watchers face the exact same",
    "start": "52289",
    "end": "57930"
  },
  {
    "text": "issue as Tesla with an unsecured dashboard and the same month several container images were found on docker hub that had embedded malware for mining",
    "start": "57930",
    "end": "64830"
  },
  {
    "text": "cryptocurrency more recently in late April 20 1980 a hub database which held",
    "start": "64830",
    "end": "71700"
  },
  {
    "text": "user data including docker hub usernames hash passwords and github and bucket",
    "start": "71700",
    "end": "76979"
  },
  {
    "text": "tokens used for auto building docker container images now this affected more than 190,000 accounts but an unknown",
    "start": "76979",
    "end": "84000"
  },
  {
    "text": "number of images and if any of the midges that were affected how many times those were pulled and some of you might",
    "start": "84000",
    "end": "89729"
  },
  {
    "text": "have seen the slide before and being unkind of you know think I'm being kind of lazy too updating this but I'm not there actually haven't been that many",
    "start": "89729",
    "end": "95729"
  },
  {
    "text": "attacks in the wild being reported on we've had lots of vulnerabilities in this space in kubernetes and CPUs and",
    "start": "95729",
    "end": "102420"
  },
  {
    "text": "related you know projects and whatnot but no significant report of these being exploited live an interesting thing to",
    "start": "102420",
    "end": "108720"
  },
  {
    "text": "note about these attacks is that none of them explicitly attack containers or container eyes workloads and that's",
    "start": "108720",
    "end": "114540"
  },
  {
    "text": "because the end goal isn't your application right an attacker is not gonna make money by going and exploiting applications running on kubernetes",
    "start": "114540",
    "end": "120149"
  },
  {
    "text": "they're gonna make money by stealing your compute cryptocurrency mining creating a botnet whatever it happens to",
    "start": "120149",
    "end": "126060"
  },
  {
    "text": "be so let's jump into some forensics",
    "start": "126060",
    "end": "131780"
  },
  {
    "text": "yeah cool so yes let's first talk about security forensics and then we'll get",
    "start": "132049",
    "end": "137190"
  },
  {
    "text": "into how this applies to containers so what we really want to do here is put",
    "start": "137190",
    "end": "142440"
  },
  {
    "start": "140000",
    "end": "140000"
  },
  {
    "text": "ourselves in the best possible position to deal with an incident I will spend some time today on all of these but the",
    "start": "142440",
    "end": "149790"
  },
  {
    "text": "takeaway for today is really on collection and more specifically how this pertains to containers so you've",
    "start": "149790",
    "end": "157709"
  },
  {
    "text": "probably listened to all of Maya's past container security presentations you've applied security container kubernetes",
    "start": "157709",
    "end": "164700"
  },
  {
    "text": "security best practices to your cluster your cluster is about as secure as it can get yet something or somebody still",
    "start": "164700",
    "end": "171540"
  },
  {
    "text": "infiltrated your environment now what well don't panic don't terminate all",
    "start": "171540",
    "end": "176849"
  },
  {
    "start": "174000",
    "end": "174000"
  },
  {
    "text": "your nodes containers disks this is where some of the evidence lie resides that we need to collect to tell the",
    "start": "176849",
    "end": "183060"
  },
  {
    "text": "story of what happened now in extreme cases this might be necessary but Maya will talk about this in a later section",
    "start": "183060",
    "end": "188909"
  },
  {
    "text": "and don't be a hero don't log into your server or container there's multiple reasons you don't want to do this one",
    "start": "188909",
    "end": "195630"
  },
  {
    "text": "you don't want to let the attacker know that you know what's going on and two it could potentially compromised your",
    "start": "195630",
    "end": "201810"
  },
  {
    "text": "credentials okay so you're not panicking but what are you going to look at let's",
    "start": "201810",
    "end": "207660"
  },
  {
    "text": "start to gather some evidence but what are you going to look at this is you know we've we find that the evidence",
    "start": "207660",
    "end": "215069"
  },
  {
    "text": "lies in three different areas your one your logs to your disks and three live",
    "start": "215069",
    "end": "220319"
  },
  {
    "text": "and potentially historical information so we're gonna spend some time focusing on this area and again how it pertains",
    "start": "220319",
    "end": "226680"
  },
  {
    "text": "to containers and kubernetes so logs I doubt anyone would really question the",
    "start": "226680",
    "end": "233489"
  },
  {
    "text": "value of logs been tracking down an event so what we want to do here is identify several sources of the",
    "start": "233489",
    "end": "238650"
  },
  {
    "text": "meaningful logs and decide on what to do with them you want to make sure that all your logs are going to a central",
    "start": "238650",
    "end": "244620"
  },
  {
    "text": "location doing this you're able to search for events across multiple sources it helps guarantee that your logs",
    "start": "244620",
    "end": "251549"
  },
  {
    "text": "haven't been tampered with even if the hosts are coming from has been and then depending on where you're",
    "start": "251549",
    "end": "256560"
  },
  {
    "text": "sending your logs some of the places you can send your logs you can do some",
    "start": "256560",
    "end": "262480"
  },
  {
    "text": "can do anomaly detection which can help notify you of a possible event in the",
    "start": "262480",
    "end": "267490"
  },
  {
    "text": "next section Maya will talk more about the different types logs and the information you might gather from these",
    "start": "267490",
    "end": "273210"
  },
  {
    "text": "so traditionally in a data center if after event you would have to shut down the server remove the disk bring that",
    "start": "273210",
    "end": "279670"
  },
  {
    "text": "back up in some point in a quarantine environment luckily with cloud we have api's where we can take dis nap shots",
    "start": "279670",
    "end": "284850"
  },
  {
    "text": "container there is no snapshot mechanism but we'll talk about some possible solutions in this area the main point",
    "start": "284850",
    "end": "290950"
  },
  {
    "text": "here is you can start doing analysis without the attacker being clued in and what it and so they don't erase their",
    "start": "290950",
    "end": "297130"
  },
  {
    "text": "tracks cool so this is really where the magic comes in so how do you get",
    "start": "297130",
    "end": "304240"
  },
  {
    "text": "information from a system without logging in how do you get information from multiple systems without logging in",
    "start": "304240",
    "end": "310800"
  },
  {
    "text": "how do you get information from containers that might have died so this is a what we call live and recorded",
    "start": "310800",
    "end": "317140"
  },
  {
    "text": "information the SRE team at Google has this motto that's we hope for the best",
    "start": "317140",
    "end": "323440"
  },
  {
    "text": "but plan for the worst I really think this applies to security and more specifically incident response plans",
    "start": "323440",
    "end": "328810"
  },
  {
    "text": "it's it's really easy for me to stand up here and tell you not to panic when an incident happens but any of us that have",
    "start": "328810",
    "end": "334360"
  },
  {
    "text": "ever been involved of an incident you're gonna panic you feel that in the gut of your stomach you just you know",
    "start": "334360",
    "end": "339850"
  },
  {
    "text": "but having an incident response plan in place helps you know or the other folks know what steps to take in case of",
    "start": "339850",
    "end": "346000"
  },
  {
    "text": "incident it lets you know who to notify your communication plan the systems that you need to keep up and running so your",
    "start": "346000",
    "end": "351910"
  },
  {
    "text": "business is still up and running and then what actions to take and how to start diagnosing what happened so cool",
    "start": "351910",
    "end": "359800"
  },
  {
    "text": "so I mean that was a quick overview of security forensics and really focusing on collections so let's really dive into",
    "start": "359800",
    "end": "365260"
  },
  {
    "text": "more in that area and how it applies to containers sounds good so let's look at logs first as Ann mentioned that one of",
    "start": "365260",
    "end": "372760"
  },
  {
    "text": "the first places to look when you're conducting forensics are logs many logs don't significantly change for",
    "start": "372760",
    "end": "378220"
  },
  {
    "text": "containerize environments for example like never logs aren't really different as long as you can map back an IP address to a single pod rather than just",
    "start": "378220",
    "end": "384940"
  },
  {
    "text": "the node that it's running on so we're gonna look at four different kinds of logs infrastructure logs these are changes to your infrastructure",
    "start": "384940",
    "end": "390490"
  },
  {
    "text": "it's what the infra does and what a human does to the infra if you're using a cloud provider this ink",
    "start": "390490",
    "end": "396009"
  },
  {
    "text": "it's changes to cloudy ap is that you're accessing and to your services kubernetes logs these are what the",
    "start": "396009",
    "end": "401589"
  },
  {
    "text": "control plane does what a container does to the control plane and what a user does to the control plane think of this is anything that needs coop control or",
    "start": "401589",
    "end": "407830"
  },
  {
    "text": "anything that kubernetes handles for you operating system logs these are calls to the OS on the node that the container",
    "start": "407830",
    "end": "413680"
  },
  {
    "text": "runs on it's about what actions your containers are taking in the node and application logs these are logs for",
    "start": "413680",
    "end": "420520"
  },
  {
    "text": "what's happening inside of your application they're actually generally the same for containerized and non containerized apps but how you collect",
    "start": "420520",
    "end": "426939"
  },
  {
    "text": "them is gonna be a little bit different all of these also have the concept of audit logs so if you're looking to",
    "start": "426939",
    "end": "432099"
  },
  {
    "text": "figure out why something is the way that it is in your environment and who made it that way poof audit logs is the place to go it",
    "start": "432099",
    "end": "438129"
  },
  {
    "text": "it's or what you're gonna mostly use to figure out what another human like an attacker did in your environment so",
    "start": "438129",
    "end": "444370"
  },
  {
    "text": "let's look at each of these so first infrastructure logs let's say you're running in a cloud infrastructure these",
    "start": "444370",
    "end": "450039"
  },
  {
    "start": "446000",
    "end": "446000"
  },
  {
    "text": "logs should include information about what underlying services you're using and what operations the user made to",
    "start": "450039",
    "end": "455169"
  },
  {
    "text": "those resources typical logs that you'd expect to see here are things like error logs quota warnings debug information as",
    "start": "455169",
    "end": "461589"
  },
  {
    "text": "well as audit logs so this here is a sample cloud audit log for creating a cluster in gke you'll notice lis contain",
    "start": "461589",
    "end": "467770"
  },
  {
    "text": "some information specifically about the request like the type of operation how it was authenticated author author eyes",
    "start": "467770",
    "end": "473529"
  },
  {
    "text": "as well as information about the content of the request like the version type chosen for the gke cluster what's gonna",
    "start": "473529",
    "end": "480039"
  },
  {
    "text": "be logged it's gonna be based on your cloud audit logging policy or logging policy as long as can get expensive",
    "start": "480039",
    "end": "485439"
  },
  {
    "text": "quickly you probably want some minimum set of operations logged everywhere in your environment but only much more",
    "start": "485439",
    "end": "491349"
  },
  {
    "text": "detailed logs for higher risk areas example of high risk areas where you want might want more logs are gonna be",
    "start": "491349",
    "end": "496870"
  },
  {
    "text": "your PCI compliant cluster your secret storage bucket and your firewall rules",
    "start": "496870",
    "end": "502409"
  },
  {
    "text": "next up kubernetes logs if your organization has a team that manages the infrastructure for you including",
    "start": "502409",
    "end": "508539"
  },
  {
    "start": "503000",
    "end": "503000"
  },
  {
    "text": "kubernetes then you might not even have realized that these were different if however you are the infrastructure team though",
    "start": "508539",
    "end": "513789"
  },
  {
    "text": "then criminai these logs is the exact same concept as the audit of the infrastructure logs but for kubernetes",
    "start": "513789",
    "end": "519250"
  },
  {
    "text": "after all kubernetes is part of your infrastructure right so kubernetes audit",
    "start": "519250",
    "end": "524470"
  },
  {
    "text": "logs are actions taken in kubernetes a given request will generate events at multiple points in its lifecycle first to when",
    "start": "524470",
    "end": "531370"
  },
  {
    "text": "the request is received then when a response has started and finally when a response is completed the cube API",
    "start": "531370",
    "end": "537670"
  },
  {
    "text": "server will process these events and according to your audit logging policy will log them so just like for your",
    "start": "537670",
    "end": "543250"
  },
  {
    "text": "infrastructure logs kubernetes can log events at different depths of detail based on the information that's included",
    "start": "543250",
    "end": "549010"
  },
  {
    "text": "ranae's has four different audit levels that are on the left-hand side of the page here none which doesn't log events",
    "start": "549010",
    "end": "554500"
  },
  {
    "text": "at all metadata which logs request metadata only this includes requesting",
    "start": "554500",
    "end": "559840"
  },
  {
    "text": "user timestamp a resource and verb this is a good choice for operations where the verb is enough to tell you what",
    "start": "559840",
    "end": "565030"
  },
  {
    "text": "happened the next level request which logs metadata plus the request body this",
    "start": "565030",
    "end": "570970"
  },
  {
    "text": "is a good choice for operations where you're changing configurations and you want to be able to capture what that changes and then request response which",
    "start": "570970",
    "end": "577690"
  },
  {
    "text": "logs event metadata and the request body plus the request response body if you're",
    "start": "577690",
    "end": "583390"
  },
  {
    "text": "getting started crafting your own audit policy you can check out the one that GK uses online there's some excerpts here",
    "start": "583390",
    "end": "589150"
  },
  {
    "text": "it's in the in the open source repo basically get requests because they can be very large to log or at the request",
    "start": "589150",
    "end": "595090"
  },
  {
    "text": "level known api's are at the request response level and any calls not",
    "start": "595090",
    "end": "600160"
  },
  {
    "text": "explicitly covered by the policy or at the metadata level again meeting that kind of base level of logging that you'd expect to have everywhere operating",
    "start": "600160",
    "end": "608920"
  },
  {
    "text": "system logs cover events happening inside your node operating system right when you remember containers have two",
    "start": "608920",
    "end": "613990"
  },
  {
    "text": "sets of OSS this is the one on the node that you're running your containers on top of so this for example will include",
    "start": "613990",
    "end": "619270"
  },
  {
    "text": "network connections user logins and SSH sessions and certain executions like exec ve when you collect these logs on",
    "start": "619270",
    "end": "626230"
  },
  {
    "text": "kubernetes you do so by deploying a logging agent as a daemon set for example flow and D to collect the logs",
    "start": "626230",
    "end": "631930"
  },
  {
    "text": "which then writes them to a logging infrastructure like stackdriver or elasticsearch and Cabana fluid e has",
    "start": "631930",
    "end": "638110"
  },
  {
    "text": "really good documentation on how to do this so I'm not going to go into too much detail but basically you need to provide the fluent e demon sent with the",
    "start": "638110",
    "end": "644320"
  },
  {
    "text": "log storage pods host and port and then give fluent e the right permissions and it'll take care of the rest for you to",
    "start": "644320",
    "end": "651970"
  },
  {
    "text": "make this slightly easier for cost logs on gke we've actually recently published a recommended flip flow and D configuration and how to to get these",
    "start": "651970",
    "end": "658450"
  },
  {
    "text": "logs if you check out the GK documentation you can you can take a look at that be careful if you're gonna tune any of",
    "start": "658450",
    "end": "664370"
  },
  {
    "text": "these os Auto logs yourself because you could end up with a lot of logs and I mentioned earlier logs are expensive and",
    "start": "664370",
    "end": "670370"
  },
  {
    "text": "storing logs are expensive so make sure you actually know what you're what you're capturing or test it out first before you kind of dive dive all in note",
    "start": "670370",
    "end": "678200"
  },
  {
    "text": "also that logs can only be generated for events occurring after the demon set is deployed when you're using a model like this right so it's recommended to create",
    "start": "678200",
    "end": "684980"
  },
  {
    "text": "the demon set right after cluster creation then every time that you add new nodes to the cluster they'll have the configuration apply automatically",
    "start": "684980",
    "end": "690740"
  },
  {
    "text": "and then lastly application logs application logs are logs from your",
    "start": "690740",
    "end": "696170"
  },
  {
    "start": "693000",
    "end": "693000"
  },
  {
    "text": "application that you wrote including errors warnings for example of like low memory or disk space they actually",
    "start": "696170",
    "end": "702380"
  },
  {
    "text": "aren't that different for containerized applications as I mentioned earlier but how you collect them is gonna be a little bit different actually how you",
    "start": "702380",
    "end": "708560"
  },
  {
    "text": "collect them is really easy because we just talked about it you're gonna use a logging agent as a daemon set and then",
    "start": "708560",
    "end": "713900"
  },
  {
    "text": "write it to a logging infrastructure in the exact same way that we just talked about with OS audit logs so it's it's",
    "start": "713900",
    "end": "720590"
  },
  {
    "text": "the same the same concept that you can apply for your own application logs so pulling all of that together where do",
    "start": "720590",
    "end": "725960"
  },
  {
    "start": "724000",
    "end": "724000"
  },
  {
    "text": "the logs come from and where do they go in your infra infrastructure locks including audit logs come from your",
    "start": "725960",
    "end": "732080"
  },
  {
    "text": "infrastructure surprise and somehow end up in your logging system kubernetes logs and audit logs that you collect",
    "start": "732080",
    "end": "737930"
  },
  {
    "text": "from kubernetes for example using a logging agent like fluent e if you're using a managed kubernetes service this",
    "start": "737930",
    "end": "743270"
  },
  {
    "text": "is usually ingested for you OS logs including audit logs and",
    "start": "743270",
    "end": "748600"
  },
  {
    "text": "application logs you can collect yourself using your own logging agent now recall if you're running a logging",
    "start": "748600",
    "end": "754640"
  },
  {
    "text": "agent yourself you're gonna probably want to send them to a logging infrastructure like I mentioned and what Ann said at the beginning I talked is",
    "start": "754640",
    "end": "760430"
  },
  {
    "text": "you probably want to get all of your logs in one single place that makes it easier for you to filter over all the",
    "start": "760430",
    "end": "766850"
  },
  {
    "text": "possible events that occurred in infrastructure and also don't be able to you know pivot on any particular resource and see and see what actually",
    "start": "766850",
    "end": "772430"
  },
  {
    "text": "happened to that thing that also means that you need to be really careful about having consistent identifiers for the",
    "start": "772430",
    "end": "778160"
  },
  {
    "text": "same resource so when you try to do that pivot you're not kind of losing information and having to jumble stuff together afterwards right cleaning data",
    "start": "778160",
    "end": "784370"
  },
  {
    "text": "is really annoying lastly you'll want to set up a backup for these logs or some subset of them likely based on your own",
    "start": "784370",
    "end": "791060"
  },
  {
    "text": "retention requirements cool so this is an example the in this",
    "start": "791060",
    "end": "798950"
  },
  {
    "start": "796000",
    "end": "796000"
  },
  {
    "text": "example we're using API to create distaff shot and then of the affected",
    "start": "798950",
    "end": "803960"
  },
  {
    "text": "node and sending a copy over to an isolated location so this isolated location if you're an AWS could be a",
    "start": "803960",
    "end": "809240"
  },
  {
    "text": "different AWS account TCP maybe a different GCP project or it could just be an isolated Network you know lockdown",
    "start": "809240",
    "end": "816440"
  },
  {
    "text": "VPC and then you can start doing analysis of it but the thing here is once you bring this disk image up on a",
    "start": "816440",
    "end": "823220"
  },
  {
    "text": "different node your containers are no longer running so it's really hard to tell what was going on at the time the",
    "start": "823220",
    "end": "829399"
  },
  {
    "text": "snapshot was taken at you know when the containers were running so at Google we",
    "start": "829399",
    "end": "836180"
  },
  {
    "start": "834000",
    "end": "834000"
  },
  {
    "text": "have a open source project called docker Explorer which is helps you do forensic",
    "start": "836180",
    "end": "842209"
  },
  {
    "text": "analysis of offline docker file systems from a distaff shot so for example if you take this snapshot of a GCE image",
    "start": "842209",
    "end": "850520"
  },
  {
    "text": "you get a copy of our lib docker so docker Explorer is just Python that does",
    "start": "850520",
    "end": "855980"
  },
  {
    "text": "some JSON parsing so running the Dhokla Explorer on the mounted VAR Lib docker",
    "start": "855980",
    "end": "862100"
  },
  {
    "text": "and doing list running containers will get container IDs that were running at that point in time the snapshot was",
    "start": "862100",
    "end": "868250"
  },
  {
    "text": "taken that you're then able to mount those file systems and see what was going on in the container again at that",
    "start": "868250",
    "end": "875060"
  },
  {
    "text": "point in time when the snapshot was taken so isolating one node and",
    "start": "875060",
    "end": "881390"
  },
  {
    "text": "container is easy but again you know if you have hundreds of those thousands of containers how do you start analyzing",
    "start": "881390",
    "end": "887630"
  },
  {
    "text": "what's going on in those quickly again without having to log in what do you do",
    "start": "887630",
    "end": "892640"
  },
  {
    "text": "if your container has died how do you get that information there's a lot of security container security vendors that",
    "start": "892640",
    "end": "899630"
  },
  {
    "text": "have applications in this area and they're here I would encourage you to speak to them but for this presentation",
    "start": "899630",
    "end": "904790"
  },
  {
    "text": "I really want to focus on some open source projects so the first one is",
    "start": "904790",
    "end": "909860"
  },
  {
    "text": "called Gurr it's an open source project from Google it stands for gue Rapid Response it's an Incident Response framework for VM so",
    "start": "909860",
    "end": "918200"
  },
  {
    "text": "the TLDR on this slide is secure it before you unleash it so again with Girt",
    "start": "918200",
    "end": "924620"
  },
  {
    "text": "you can remotely get detailed monitoring of your client or node CPUs memory i/o",
    "start": "924620",
    "end": "930399"
  },
  {
    "text": "usage and memory dumps so Gura has two main activities flows and hunts so a",
    "start": "930399",
    "end": "937639"
  },
  {
    "text": "flow is when you've asked ger to go find out something on one of your nodes so maybe you want the memory on a running",
    "start": "937639",
    "end": "943670"
  },
  {
    "text": "process maybe you want information about a certain file like the contents of a file that's when you would do a flow a",
    "start": "943670",
    "end": "950089"
  },
  {
    "text": "hunt is always running it's looking for something bad so maybe it's looking for a key file that changed maybe it's",
    "start": "950089",
    "end": "956420"
  },
  {
    "text": "looking for a malware signature or something like a jar file and again ger",
    "start": "956420",
    "end": "961579"
  },
  {
    "text": "it's really focused on VM so you know one of the things that doesn't do is map docker processes to OS pins so this is",
    "start": "961579",
    "end": "968600"
  },
  {
    "text": "where some assisted open-source projects come in so cystic cube see tail capture",
    "start": "968600",
    "end": "975829"
  },
  {
    "start": "973000",
    "end": "973000"
  },
  {
    "text": "record sis calls in a capture file which can help you diagnose what was going on during your during an attack even if the",
    "start": "975829",
    "end": "983959"
  },
  {
    "text": "container has died and then Cystic inspect is an interface that displays the contents of a capture file so the",
    "start": "983959",
    "end": "990259"
  },
  {
    "text": "content is organized and these different tiles each would show a value in relevant metrics and its trends the",
    "start": "990259",
    "end": "996980"
  },
  {
    "text": "tiles are organized in different categories to help surface information more clearly you're able to then drill",
    "start": "996980",
    "end": "1003279"
  },
  {
    "text": "down into these different tiles and get the data behind it and really start investigating what was going on you're",
    "start": "1003279",
    "end": "1009160"
  },
  {
    "text": "also able to narrow your search based on a time window and then similar to gir but you know with four containers you",
    "start": "1009160",
    "end": "1016149"
  },
  {
    "text": "can get information on your CPU CPU memory i/o system calls and even the",
    "start": "1016149",
    "end": "1021910"
  },
  {
    "text": "contents of files cool so now that",
    "start": "1021910",
    "end": "1027250"
  },
  {
    "text": "you've detected something you know using your logs using agur using snapshots whatever happens to be what should you",
    "start": "1027250",
    "end": "1033159"
  },
  {
    "text": "actually do in your environment so let's go through the most common mitigation options that you have at your disposal you could send an alert isolate a",
    "start": "1033159",
    "end": "1041048"
  },
  {
    "text": "container posit container restart a container or kill a container these",
    "start": "1041049",
    "end": "1046209"
  },
  {
    "text": "options are increasing an order of certainty but also an order of severity right killing a container is your last",
    "start": "1046209",
    "end": "1051370"
  },
  {
    "text": "possible mitigation and even for the most severe of incidents might not actually be the best option as an",
    "start": "1051370",
    "end": "1056980"
  },
  {
    "text": "explained there isn't a great way of snapshot in containers so live forensics is often your but if you kill the container you've",
    "start": "1056980",
    "end": "1062410"
  },
  {
    "text": "lost that opportunity for analysis so for each of these options we're gonna quickly go over what it is when you do",
    "start": "1062410",
    "end": "1068590"
  },
  {
    "text": "that option and how you might do it so first alerting alerting notifies your",
    "start": "1068590",
    "end": "1074260"
  },
  {
    "text": "Security Response Team that something is going on in your infrastructure it's it's about sending potential events to",
    "start": "1074260",
    "end": "1079270"
  },
  {
    "text": "your security team for triage and further analysis this is typically the first step before your team takes one of",
    "start": "1079270",
    "end": "1084730"
  },
  {
    "text": "the more severe actions if you're getting all of your logs in one place like you should be then you're alerting",
    "start": "1084730",
    "end": "1090820"
  },
  {
    "text": "should just leverage that use the same alerting tools that your ops team is already using whether that's you know feeding alerts to email JIRA slack pager",
    "start": "1090820",
    "end": "1097960"
  },
  {
    "text": "duty whatever works for you alerts should be based on specific metrics or on specific actions so for example CPU",
    "start": "1097960",
    "end": "1105340"
  },
  {
    "text": "usage in your container or a new network connection the hard part here is actually figuring out what you want to",
    "start": "1105340",
    "end": "1110830"
  },
  {
    "text": "alert on it's not you know commonly agreed-upon what those metrics should be it's gonna end up being very specific on your particular info the next option is",
    "start": "1110830",
    "end": "1119020"
  },
  {
    "text": "isolation now I don't mean isolation in the sense of workload isolation like running untrusted code in a multi-tenant",
    "start": "1119020",
    "end": "1124420"
  },
  {
    "text": "cluster I mean more like quarantine you want to move the container to somewhere that you can examine it better without",
    "start": "1124420",
    "end": "1130930"
  },
  {
    "text": "it necessarily knowing that anything is up that you're actually looking at it you probably want to do this when your",
    "start": "1130930",
    "end": "1135970"
  },
  {
    "text": "container is doing something odd but the workload that's affected isn't necessarily critical to your business so",
    "start": "1135970",
    "end": "1141340"
  },
  {
    "text": "this should help limit damage in your environment for example by preventing an attacker from moving laterally and",
    "start": "1141340",
    "end": "1146620"
  },
  {
    "text": "getting access to further systems or by preventing one application from dossing another application this is actually",
    "start": "1146620",
    "end": "1152380"
  },
  {
    "text": "pretty hard to do well basically what you need to do is move your container to a new network so the easiest way to do",
    "start": "1152380",
    "end": "1158020"
  },
  {
    "text": "this is actually to reschedule the workload on a new node that's a preferred option than keeping the",
    "start": "1158020",
    "end": "1163450"
  },
  {
    "text": "workload on the existing node and then removing all the other workloads the reason being that in case those workloads are also affected you're",
    "start": "1163450",
    "end": "1169270"
  },
  {
    "text": "losing potentially important information so when you reschedule your workload to make sure that nothing else is ends up",
    "start": "1169270",
    "end": "1174640"
  },
  {
    "text": "on the same know to use queue control coordinate and then you can create a restricted Network policy to limit the containers connectivity and then you can",
    "start": "1174640",
    "end": "1181810"
  },
  {
    "text": "set up other tools that you want for investigation like like live forensics on node agents or network filter ranked and actually figure out what's going on",
    "start": "1181810",
    "end": "1189630"
  },
  {
    "text": "the next step the next option is pausing a container pausing a container suspends running processes in the container this",
    "start": "1189630",
    "end": "1196330"
  },
  {
    "text": "is a really good choice when you have a decent idea of what the issue is and you just need to get some a quick data for",
    "start": "1196330",
    "end": "1201940"
  },
  {
    "text": "record-keeping or to confirm what it is or determine what action to take next this is particularly useful for",
    "start": "1201940",
    "end": "1207250"
  },
  {
    "text": "connecting further forensics one good example here is cryptocurrency mining it's not necessarily harmful to your",
    "start": "1207250",
    "end": "1213130"
  },
  {
    "text": "workload but it could be costing you quite a bit of money so by pausing your container you're not incurring additional costs but you also have the",
    "start": "1213130",
    "end": "1219520"
  },
  {
    "text": "opportunity to take a backup and figure out the source of the issue before you actually restart the container pausing a",
    "start": "1219520",
    "end": "1225220"
  },
  {
    "text": "container is actually pretty easy because it's built-in in docker you can use docker pause to pause containers using the cgroups freezer with the",
    "start": "1225220",
    "end": "1231730"
  },
  {
    "text": "cgroups freezer the process is unaware and unable to capture that it's being suspended and then subsequently resumed this is exactly doing what it says it's",
    "start": "1231730",
    "end": "1238180"
  },
  {
    "text": "on the box which is great restarting a container restoring a container kills and restarts a running",
    "start": "1238180",
    "end": "1244720"
  },
  {
    "text": "container and resets the current state of the application restarting a container makes sense when you already",
    "start": "1244720",
    "end": "1250540"
  },
  {
    "text": "have a fix that you're working on rolling out so you have to be really careful with restarts they don't make",
    "start": "1250540",
    "end": "1256090"
  },
  {
    "text": "sense when you sorry they don't make sense unless you already know where the issue is coming from so say an attacker",
    "start": "1256090",
    "end": "1262210"
  },
  {
    "text": "has compromised your container and if you restart it you're kicking them off of that foothold again unless they've also compromised your note or something",
    "start": "1262210",
    "end": "1268300"
  },
  {
    "text": "like that but you're not actually fixing the problem because they can get right back onto your container the same way they got there in the first place in",
    "start": "1268300",
    "end": "1274750"
  },
  {
    "text": "fact you might have just made it worse because now you told them that you know that they're there right and you probably have multiple instances of the",
    "start": "1274750",
    "end": "1280480"
  },
  {
    "text": "same container running in multiple places they can get into all of those as well so you're not actually fixing the",
    "start": "1280480",
    "end": "1285700"
  },
  {
    "text": "problem you're just kind of temporarily telling them come at me harder like it's not it's not gonna help you so you can",
    "start": "1285700",
    "end": "1292120"
  },
  {
    "text": "restart a container with docker restarts using this command you can also specify the seconds to wait for processes to",
    "start": "1292120",
    "end": "1297520"
  },
  {
    "text": "stop before the container is actually killed and restarted in kubernetes you can also delete the pod and it'll just",
    "start": "1297520",
    "end": "1302860"
  },
  {
    "text": "get rescheduled I want to repeat this though you're supposed to do this when you already have a fix so if you already",
    "start": "1302860",
    "end": "1308890"
  },
  {
    "text": "have a fix the easiest way to do this is to roll out your fix you don't actually have to kill the container and do all",
    "start": "1308890",
    "end": "1314410"
  },
  {
    "text": "this other stuff just roll out a new fix kill the old work load and magic things of your attacker is no longer in that",
    "start": "1314410",
    "end": "1320050"
  },
  {
    "text": "workload lastly killing a container this is the last resort that you have as it",
    "start": "1320050",
    "end": "1325870"
  },
  {
    "text": "halts all running processes in the container like a restart this will let the attacker know that you know and doesn't",
    "start": "1325870",
    "end": "1331480"
  },
  {
    "text": "fix the underlying problem plus it takes your workload offline now you might do this in a worst case scenario for",
    "start": "1331480",
    "end": "1338140"
  },
  {
    "text": "example you an application that's actively exfiltrating sensitive user data in this case stopping the leak",
    "start": "1338140",
    "end": "1344260"
  },
  {
    "text": "might actually be more important to you in your organization than figuring out how it happened or getting forensics again very specific on your situation to",
    "start": "1344260",
    "end": "1352090"
  },
  {
    "text": "kill a container you can use docker stop or cry control stop and docker kill",
    "start": "1352090",
    "end": "1358020"
  },
  {
    "text": "Dockers stop stops the container by sending a signal to the root process k-- asks nicely and gives it ten seconds to",
    "start": "1358020",
    "end": "1364750"
  },
  {
    "text": "stop before sending ass and if the process hasn't exited in that time period it then sends a signal signal",
    "start": "1364750",
    "end": "1370179"
  },
  {
    "text": "docker kill is less graceful it doesn't wait around it doesn't mess around it just sends the signal signal directly if",
    "start": "1370179",
    "end": "1376539"
  },
  {
    "text": "you're at this point where you're killing a container you probably want docker kill you're not gonna give it an extra ten seconds to wait around you can",
    "start": "1376539",
    "end": "1383649"
  },
  {
    "text": "also remove a container forcefully with docker RM dash F or cry control RMF",
    "start": "1383649",
    "end": "1389320"
  },
  {
    "text": "though docker remove is an for an already stopped container using the dash F flag forces it to terminate using a",
    "start": "1389320",
    "end": "1394840"
  },
  {
    "text": "cig kill SiC signal first awesome alright let's apply all this knowledge",
    "start": "1394840",
    "end": "1400929"
  },
  {
    "text": "to a real-world scenario so let's look at a common container attack privilege",
    "start": "1400929",
    "end": "1406779"
  },
  {
    "start": "1404000",
    "end": "1404000"
  },
  {
    "text": "escalation or container escape so privilege escalation attacks allows containers to break out of their",
    "start": "1406779",
    "end": "1412929"
  },
  {
    "text": "isolated contexts and essentially become route on the server and effectively having access to all the other",
    "start": "1412929",
    "end": "1418570"
  },
  {
    "text": "containers running on that node so maybe you've been contacted by your cloud",
    "start": "1418570",
    "end": "1424210"
  },
  {
    "start": "1422000",
    "end": "1422000"
  },
  {
    "text": "provider and been notified that some they've noticed some suspicious network",
    "start": "1424210",
    "end": "1429340"
  },
  {
    "text": "traffic coming from when your nodes or multiple nodes or maybe you've seen a spike in CPU usage on your monitoring",
    "start": "1429340",
    "end": "1434799"
  },
  {
    "text": "system neither one of these events actually indicates a security incident let alone privilege escalation but what",
    "start": "1434799",
    "end": "1442120"
  },
  {
    "text": "they do give you some information they give you the nodes or set of nodes that might the event might be happening on in",
    "start": "1442120",
    "end": "1449169"
  },
  {
    "text": "a time range date and time so what do you have in place well since you've",
    "start": "1449169",
    "end": "1454899"
  },
  {
    "text": "listened to our presentation you know that you owe your logs should be going to a central location you know to isolate and quarantine you're just",
    "start": "1454899",
    "end": "1462549"
  },
  {
    "text": "snapshot and then you have invested some time and container security specific tools so let's first look at logs so",
    "start": "1462549",
    "end": "1470799"
  },
  {
    "text": "since you have that time range and hoes you know start focusing on the logs there maybe you see something suspicious",
    "start": "1470799",
    "end": "1476230"
  },
  {
    "text": "there and you can take that pattern and search across other logs and to see if ever other nodes or hosts had been",
    "start": "1476230",
    "end": "1482200"
  },
  {
    "text": "affected so maybe maybe you've narrowed this down to a set of nodes or a nose so",
    "start": "1482200",
    "end": "1487480"
  },
  {
    "text": "let's start looking at the OS logs or deployment logs for that particular node so you want to maybe start looking at",
    "start": "1487480",
    "end": "1493269"
  },
  {
    "text": "where your containers launched in such a way that they shouldn't be maybe they're being ran as root or - - privilege or",
    "start": "1493269",
    "end": "1499539"
  },
  {
    "text": "mounting filesystem cessation these could indicate privilege escalation so",
    "start": "1499539",
    "end": "1504880"
  },
  {
    "text": "maybe you've you've narrowed it down now at this point to a specific container that's still running so you should have",
    "start": "1504880",
    "end": "1511630"
  },
  {
    "text": "a pretty good idea of what your container image is the processes that are running in those so looking at the container logs you know are there some",
    "start": "1511630",
    "end": "1517830"
  },
  {
    "text": "suspicious processes that are running you know maybe the W get or a curl that's downloading malware maybe",
    "start": "1517830",
    "end": "1523330"
  },
  {
    "text": "something's been on tart or some sign shell script that's running note those file names because using your other you",
    "start": "1523330",
    "end": "1531610"
  },
  {
    "text": "know something like girl or the Cystic products you can get the contents of those files and you know with Network",
    "start": "1531610",
    "end": "1537820"
  },
  {
    "text": "log you know are you seeing increased unexpected outbound traffic from your nodes this could indicate that your data",
    "start": "1537820",
    "end": "1544179"
  },
  {
    "text": "is being sent out places it shouldn't be so you have a point in time snapshot of",
    "start": "1544179",
    "end": "1550269"
  },
  {
    "text": "what was going on potentially during an attack in the case of privilege escalation the malware within the can",
    "start": "1550269",
    "end": "1556960"
  },
  {
    "text": "get access to the underlying OS possibly changing files on the OS so you have",
    "start": "1556960",
    "end": "1563320"
  },
  {
    "text": "this distaff shot but what you also have is the VM image that you create your nodes from so you could effectively do a",
    "start": "1563320",
    "end": "1570010"
  },
  {
    "text": "diff of these file systems and look for binaries that have changed so things in like user bin that shouldn't have changed or in the case of the run C",
    "start": "1570010",
    "end": "1577299"
  },
  {
    "text": "vulnerability that was announced in February the malware might have changed a run C binary so you would be able to",
    "start": "1577299",
    "end": "1584470"
  },
  {
    "text": "detect that and if that's the case more likely the privilege escalation has happened",
    "start": "1584470",
    "end": "1590850"
  },
  {
    "text": "so similar to what you might find in your container logs you could find in the capture files but with more",
    "start": "1590930",
    "end": "1596180"
  },
  {
    "text": "information and correlation of things that are going on so you can find information about what user was running",
    "start": "1596180",
    "end": "1601760"
  },
  {
    "text": "the process files the process was touching IO unusual system calls and",
    "start": "1601760",
    "end": "1608210"
  },
  {
    "text": "then again the contents of a file and then again you're able to correlate events that you might not be able to",
    "start": "1608210",
    "end": "1614690"
  },
  {
    "text": "correlate with your log files and again in the case of the Runcie binary getting overwritten you might actually be able",
    "start": "1614690",
    "end": "1620810"
  },
  {
    "text": "to detect the event that caused that to happen so going back to the mitigation",
    "start": "1620810",
    "end": "1627800"
  },
  {
    "start": "1625000",
    "end": "1625000"
  },
  {
    "text": "options at miles Maya talked about in the last section the ones that we want to focus on for privilege escalation are",
    "start": "1627800",
    "end": "1633950"
  },
  {
    "text": "alert and isolate so in the case privilege escalation you could possibly get alerted again you know if your",
    "start": "1633950",
    "end": "1640510"
  },
  {
    "text": "containers are being run as root or - just privilege you can also get alerted",
    "start": "1640510",
    "end": "1646070"
  },
  {
    "text": "on specific CVEs so after identifying the container and",
    "start": "1646070",
    "end": "1651320"
  },
  {
    "text": "node that have been affected you want to quarantine these if there really was a",
    "start": "1651320",
    "end": "1656420"
  },
  {
    "text": "container escaped you may need to remove all the nodes that your container had",
    "start": "1656420",
    "end": "1661730"
  },
  {
    "text": "touched which possibly means creating a new node pool in migraine in to clean pods over and then once you've",
    "start": "1661730",
    "end": "1668180"
  },
  {
    "text": "identified a fix for that container image you'll want to roll out a fix or",
    "start": "1668180",
    "end": "1673250"
  },
  {
    "text": "update to the new node pool and then just last week Cystic released a blog",
    "start": "1673250",
    "end": "1678290"
  },
  {
    "text": "post on how you can automate alerting isolating with Falco GCP pub/sub and cloud functions won't have a link to",
    "start": "1678290",
    "end": "1684260"
  },
  {
    "text": "that the end of this presentation so what what can you do today so first",
    "start": "1684260",
    "end": "1691760"
  },
  {
    "text": "create that incident response plan I mean again you know when an incident happens you need to know the steps to",
    "start": "1691760",
    "end": "1696830"
  },
  {
    "text": "take so we're not all in panic mode secondly follow container security best practices when you're creating your",
    "start": "1696830",
    "end": "1702620"
  },
  {
    "text": "clusters have all your logs syncing to a central location and then vesting",
    "start": "1702620",
    "end": "1708940"
  },
  {
    "text": "container security specific tools open source or not and again I encourage you to speak to some of the vendors that are",
    "start": "1708940",
    "end": "1714290"
  },
  {
    "text": "here and then rehearse the process with a fake event you don't want to be the first time you run through this when an",
    "start": "1714290",
    "end": "1719570"
  },
  {
    "text": "incident happens you want to rehearse this so you can find where all the pointy edges are fix them and you know don't panic",
    "start": "1719570",
    "end": "1726440"
  },
  {
    "text": "you've got this so here are some resources of some of the things that we",
    "start": "1726440",
    "end": "1732200"
  },
  {
    "text": "mentioned throughout the presentation I think these slides are also available",
    "start": "1732200",
    "end": "1738970"
  },
  {
    "text": "yeah online cool",
    "start": "1738970",
    "end": "1744610"
  },
  {
    "text": "so Maya can take questions so just",
    "start": "1744610",
    "end": "1752870"
  },
  {
    "text": "before we start the question and answer reminder to fill out the sked review of",
    "start": "1752870",
    "end": "1758180"
  },
  {
    "text": "this talk so that said anybody questions we've got about five minutes yeah great",
    "start": "1758180",
    "end": "1774800"
  },
  {
    "text": "presentation I'm I'm strictly relating at the third mitigation option the polls",
    "start": "1774800",
    "end": "1781150"
  },
  {
    "text": "is there such an option in communities to pause a pod or to take it all from",
    "start": "1781150",
    "end": "1787520"
  },
  {
    "text": "the service because I can do it with docker but I want I want to introspect it I want to look at it but I don't want",
    "start": "1787520",
    "end": "1793970"
  },
  {
    "text": "my pot to keep incoming having incoming requests yeah not that I know of so I",
    "start": "1793970",
    "end": "1799160"
  },
  {
    "text": "think you need to go to the runtime to actually pause the container okay thank",
    "start": "1799160",
    "end": "1804680"
  },
  {
    "text": "you questions",
    "start": "1804680",
    "end": "1809950"
  },
  {
    "text": "hi are there any resources out there for what I'm looking for in my",
    "start": "1819020",
    "end": "1824370"
  },
  {
    "text": "infrastructure locks or key ke locks so that I cannot identify possible",
    "start": "1824370",
    "end": "1830430"
  },
  {
    "text": "incidents there's a couple like open",
    "start": "1830430",
    "end": "1835590"
  },
  {
    "text": "source references and things like that so Falco has a bunch of open source rules for 4gk specifically on GCP we",
    "start": "1835590",
    "end": "1841740"
  },
  {
    "text": "also announced a product tip made a few months ago called event threat detection which looks specifically at logs for",
    "start": "1841740",
    "end": "1846840"
  },
  {
    "text": "things that look bad it's not container specific it's for general issues but there's a bunch of also partner",
    "start": "1846840",
    "end": "1852120"
  },
  {
    "text": "solutions in this space I think if you're asking though like is there a generic enough set of like rules and",
    "start": "1852120",
    "end": "1858540"
  },
  {
    "text": "open source for things that look bad in kubernetes clusters not that I have seen you maybe you should create one so I",
    "start": "1858540",
    "end": "1867480"
  },
  {
    "text": "actually have a question what happens if you're monitoring or logging infrastructure is running on a containerized it's a containerized",
    "start": "1867480",
    "end": "1874140"
  },
  {
    "text": "workload so like can you still trust the logs that are coming out of it if you",
    "start": "1874140",
    "end": "1879990"
  },
  {
    "text": "manage to compromise a node and you manage to compromise the demon set on that node you can't really trust anything that it's writing so the way",
    "start": "1879990",
    "end": "1886290"
  },
  {
    "text": "that I typically see security people do this is I mean assuming the demon set will be okay well I'm really trying hard",
    "start": "1886290",
    "end": "1893700"
  },
  {
    "text": "to two things that can become here two things that can be compromised you can",
    "start": "1893700",
    "end": "1899490"
  },
  {
    "text": "either compromise that demon set that's running on the node itself in that case you've compromised the node and you have bigger problems than just the container",
    "start": "1899490",
    "end": "1904650"
  },
  {
    "text": "being compromised because now your attacker has the no level either they escape the container which is highly unlikely in a while in the wild but you",
    "start": "1904650",
    "end": "1911460"
  },
  {
    "text": "know something that is worth investigating or they have some other type of access on your node and that therefore there another parts of your",
    "start": "1911460",
    "end": "1917220"
  },
  {
    "text": "infra the second thing they can try to compromise is where your logs get written to so that's so remember we have a logging agent and then we gets written",
    "start": "1917220",
    "end": "1923850"
  },
  {
    "text": "to logging infrastructure so you know protect the logging agent by it's typically a daemon set again at the nuit",
    "start": "1923850",
    "end": "1929280"
  },
  {
    "text": "level the logging infrastructure what I typically see people do is actually write the logs to a separate project the",
    "start": "1929280",
    "end": "1934680"
  },
  {
    "text": "idea being if an attacker has gotten into a single project they can probably access those logs even if they can't",
    "start": "1934680",
    "end": "1940020"
  },
  {
    "text": "modify them they can at least see them which tells them that they know that you know so having",
    "start": "1940020",
    "end": "1945120"
  },
  {
    "text": "written to a separate in front makes a lot of sense in that case and we've got time for like maybe one more cricket",
    "start": "1945120",
    "end": "1960120"
  },
  {
    "text": "cricket",
    "start": "1960120",
    "end": "1962390"
  },
  {
    "text": "thank you for the great talk like a real example like a latest a recent incident",
    "start": "1965150",
    "end": "1971130"
  },
  {
    "text": "you have worked on just quick sharing I",
    "start": "1971130",
    "end": "1975860"
  },
  {
    "text": "can't really talk about incidents we do a lot of vulnerability response I think",
    "start": "1977480",
    "end": "1983160"
  },
  {
    "text": "it's actually worth respond oh dang and also vulnerability response and incident response are different things right until the vulnerability is exploited you",
    "start": "1983160",
    "end": "1989490"
  },
  {
    "text": "probably want a different team working on that than the incident response because vulnerability of on to something you can do you can plan for or as",
    "start": "1989490",
    "end": "1995160"
  },
  {
    "text": "incident response is very reactive in terms of instant response the what I'll just basically say is the stuff that we",
    "start": "1995160",
    "end": "2000800"
  },
  {
    "text": "see is what you would expect us to see like please put passwords and Jenkins patch your WordPress please I'll feel",
    "start": "2000800",
    "end": "2008990"
  },
  {
    "text": "better",
    "start": "2008990",
    "end": "2011170"
  },
  {
    "text": "awesome so any follow-ups that you have for Maya or an please ask outside to",
    "start": "2016210",
    "end": "2022130"
  },
  {
    "text": "give the other presenters time to set up thank you [Applause]",
    "start": "2022130",
    "end": "2029289"
  }
]