[
  {
    "text": "hi I'm Andy Keller I'm the principal engineer at observe IQ and a maintainer on the opamp go project within open",
    "start": "160",
    "end": "7679"
  },
  {
    "text": "tretry and I'm Jacob arof from service now I'm a maintainer for the open Telemetry operator project where my",
    "start": "7679",
    "end": "14040"
  },
  {
    "text": "focus is on making the otel experience in kubernetes as simple as",
    "start": "14040",
    "end": "19800"
  },
  {
    "text": "possible let's say you just bought one of these fancy new electric cars this one is perfect for a quick trip to the",
    "start": "20840",
    "end": "27160"
  },
  {
    "text": "beach you get all your stuff together your friends towels everything you need and as you get in your car it says to me",
    "start": "27160",
    "end": "33360"
  },
  {
    "text": "to the nearest dealer update my software you'd be pretty upset pretty angry but",
    "start": "33360",
    "end": "38879"
  },
  {
    "text": "it's okay you know we have the ability to do remote software updates now so no problem you update your car and you're",
    "start": "38879",
    "end": "44399"
  },
  {
    "text": "on the road so you get closer and closer to the beach until your car starts to break down again once again it says Tell",
    "start": "44399",
    "end": "51079"
  },
  {
    "text": "me to the nearest dealer I don't know what to do and now you're extra upset but what if the car could just tell you",
    "start": "51079",
    "end": "57640"
  },
  {
    "text": "what's wrong and walk you through what to do or maybe it could even fix itself it would be so much better or maybe next",
    "start": "57640",
    "end": "64119"
  },
  {
    "text": "time you should just ride your bicycle to the beach it really sucks when cars break down but they keep breaking down",
    "start": "64119",
    "end": "71159"
  },
  {
    "text": "ideally the instruments on your car's dashboard will have some info sometimes you'll need to open the hood and take a",
    "start": "71159",
    "end": "76320"
  },
  {
    "text": "look yourself it would be pretty awful if the access to both of those key functions to your car's operation",
    "start": "76320",
    "end": "81520"
  },
  {
    "text": "weren't available to you software also breaks all the time and we can't always look inside this necessitated the",
    "start": "81520",
    "end": "88280"
  },
  {
    "text": "creation of agents that tell us about about the health of our software through dashboards and instruments back before the cloud this",
    "start": "88280",
    "end": "94880"
  },
  {
    "text": "would mean you would SSH into an instance and run something like top or tail uh to see how things are doing then",
    "start": "94880",
    "end": "101720"
  },
  {
    "text": "the cloud came along and changed it all logs and metrics were the primary ways of understanding your data and for the",
    "start": "101720",
    "end": "107439"
  },
  {
    "text": "most part the collection and sending of that was done by an agent an agent in the observability realm is something",
    "start": "107439",
    "end": "112759"
  },
  {
    "text": "that looks at how your code is running and reports it somewhere and oh boy are there a lot of Agents they're all",
    "start": "112759",
    "end": "118719"
  },
  {
    "text": "configured slightly different and do slightly different things one way of deploying an agent is in its anonomous",
    "start": "118719",
    "end": "124920"
  },
  {
    "text": "agent mode this is close to how most agents have been deployed in the past essentially for every application you",
    "start": "124920",
    "end": "131000"
  },
  {
    "text": "run you also run an agent that receives your Telemetry processes it and exports it to your Telemetry back end one issue",
    "start": "131000",
    "end": "138200"
  },
  {
    "text": "with the agent mode is that it scales one to one with the amount of applications you run a different and potentially more efficient way of",
    "start": "138200",
    "end": "144120"
  },
  {
    "text": "running your collector is a Gateway in the Gateway model you send your Telemetry through a load balancer to a",
    "start": "144120",
    "end": "149239"
  },
  {
    "text": "pool of agents this is possible because agents are inherently stateless but if an agent is your",
    "start": "149239",
    "end": "155640"
  },
  {
    "text": "primary mode of getting Telemetry out of your system how do you know you need to go fix it if you're unsure where your",
    "start": "155640",
    "end": "161200"
  },
  {
    "text": "data is coming from or you don't alert on missing data it's very challenging to know if your agents are alive and",
    "start": "161200",
    "end": "166480"
  },
  {
    "text": "effective how would you drive your car without a speedometer what would you do if you got a flat tire on the highway",
    "start": "166480",
    "end": "172120"
  },
  {
    "text": "and you didn't have a spare or maybe you forgot to replenish your brake fluid before your big trip to Chicago we trust",
    "start": "172120",
    "end": "178000"
  },
  {
    "text": "that our cars are always that we trust that our cars always have these features to allow us to operate",
    "start": "178000",
    "end": "183400"
  },
  {
    "text": "them effectively in the same way that we trust our agents to send data to vendors is reliable but just like the Myriad of",
    "start": "183400",
    "end": "189680"
  },
  {
    "text": "ways a car can break down agents can break down in many ways too the first one is a networking failure if data",
    "start": "189680",
    "end": "196680"
  },
  {
    "text": "can't leave your network it's impossible to debug why it's happening without going into the cluster or doing some analysis on your Cloud networking",
    "start": "196680",
    "end": "203400"
  },
  {
    "text": "configuration when you send data to a backend you usually need some amount of authentication to ensure that only",
    "start": "203400",
    "end": "208959"
  },
  {
    "text": "privilege agents cons send Telemetry otherwise anybody could just junk up your data hopefully the logs from your",
    "start": "208959",
    "end": "214680"
  },
  {
    "text": "agent would give you some hints if you have an authentication failure for the dashboards and alerts you rely on if the",
    "start": "214680",
    "end": "220560"
  },
  {
    "text": "agents sending that data are running out of resources and aren't scaling data could be dropped or lost this could also",
    "start": "220560",
    "end": "226319"
  },
  {
    "text": "happen when your cluster is out of extra instances to scale your Telemetry collection ghost agents exist when",
    "start": "226319",
    "end": "232560"
  },
  {
    "text": "you're running lots of agents that aren't providing any value maybe from a vendor PC that isn't used anymore or",
    "start": "232560",
    "end": "237959"
  },
  {
    "text": "some experiment someone forgot to tear down regardless these agents could be costing you thousands of dollars a day",
    "start": "237959",
    "end": "243480"
  },
  {
    "text": "and you never even realized it because no one was reporting on it the next failure is configuration your agents are",
    "start": "243480",
    "end": "249640"
  },
  {
    "text": "healthy and you see that they're doing some work but for some reason nothing is coming out the other end you look",
    "start": "249640",
    "end": "254799"
  },
  {
    "text": "through your recent commits and saw that Helm translated your 0.01 sample rate to one now you're dropping everything and",
    "start": "254799",
    "end": "262040"
  },
  {
    "text": "no one said anything at all a great way for understanding these failures is to introduce an observer for your",
    "start": "262040",
    "end": "268280"
  },
  {
    "text": "observability this observer's purpose is to help you understand when your agents are misbehaving or unhealthy these",
    "start": "268280",
    "end": "274479"
  },
  {
    "text": "observers can even recommend or automate fixing the bad agents observing The Observer is like having Insurance you",
    "start": "274479",
    "end": "280600"
  },
  {
    "text": "don't always need it but like a good neighbor opamp is there I love",
    "start": "280600",
    "end": "288520"
  },
  {
    "text": "that all right uh in this section I'm going to provide an overview of opamp including the motivation goals and",
    "start": "289120",
    "end": "295000"
  },
  {
    "text": "capabilities of the protocol and uh I will then cover agent status and remote configuration in detail and then I will",
    "start": "295000",
    "end": "302199"
  },
  {
    "text": "describe the implementation of opamp in open Telemetry the opap name stands for open",
    "start": "302199",
    "end": "309360"
  },
  {
    "text": "agent management protocol the specification and the implementation are both open source and while the protocol",
    "start": "309360",
    "end": "316120"
  },
  {
    "text": "is not limited to use bi Telemetry the community working on the protocol and the repositories containing the",
    "start": "316120",
    "end": "321759"
  },
  {
    "text": "implementation reside within the open sary cncf project the repo containing the",
    "start": "321759",
    "end": "327639"
  },
  {
    "text": "specification and protuff definitions is called called opamp spec and was initially contributed by tan of Splunk",
    "start": "327639",
    "end": "333800"
  },
  {
    "text": "in November of 2021 and the opamp go repo uh of which I'm a maintainer uh",
    "start": "333800",
    "end": "340720"
  },
  {
    "text": "contains uh the reference implementation of the opamp protocol for use in agents and",
    "start": "340720",
    "end": "346759"
  },
  {
    "text": "servers opamp is a result of the work of many contributions from many individuals",
    "start": "346759",
    "end": "352319"
  },
  {
    "text": "and organizations as Jacob just explained it's important to be able to remotely",
    "start": "352319",
    "end": "358280"
  },
  {
    "text": "observe and manage your Telemetry agents this requires being able to communicate with running agents",
    "start": "358280",
    "end": "363639"
  },
  {
    "text": "deployed across data centers and in the cloud over the years many observability vendors develop their own custom",
    "start": "363639",
    "end": "369880"
  },
  {
    "text": "protocols for agent observability and Remote Management take our company observe IQ",
    "start": "369880",
    "end": "375560"
  },
  {
    "text": "as an example over the course of 10 years this is maybe slightly embarrassing but but factual we",
    "start": "375560",
    "end": "381440"
  },
  {
    "text": "implemented um custom protocols in three different languages uh using both HTTP and websockets um many other companies have",
    "start": "381440",
    "end": "388680"
  },
  {
    "text": "likely followed us SAR path every protocol was better than the previous one but it was still a custom",
    "start": "388680",
    "end": "393759"
  },
  {
    "text": "proprietary protocol uh a simple Telemetry pipeline looks like this there's an agent that is",
    "start": "393759",
    "end": "400560"
  },
  {
    "text": "collecting data from workloads that is sending signals to a Telemetry back end",
    "start": "400560",
    "end": "406039"
  },
  {
    "text": "once there we can make use of this data to create dashboards alerts Etc it's also useful for the agent to",
    "start": "406039",
    "end": "412880"
  },
  {
    "text": "send its own Telemetry to the back end so that you can observe your observability that's what this this blue",
    "start": "412880",
    "end": "418199"
  },
  {
    "text": "line represents additionally some vendors allow management of the agent showing the",
    "start": "418199",
    "end": "423360"
  },
  {
    "text": "agents connected their status and possibly allowing the configuration to be",
    "start": "423360",
    "end": "428720"
  },
  {
    "text": "modified here we have three vendors with three similar pipeline architectures using their own agents and",
    "start": "428720",
    "end": "436120"
  },
  {
    "text": "protocols there's been a shift toward many of these vendors contributing to the development of Open Source agents",
    "start": "436120",
    "end": "441800"
  },
  {
    "text": "with an open source agent like the open Telemetry collector we have standardized on the protocol for sending Telemetry",
    "start": "441800",
    "end": "447840"
  },
  {
    "text": "this allows us to move toward a bring own agent model where end users are able to build and deploy their own distributions of The Collector and can",
    "start": "447840",
    "end": "454879"
  },
  {
    "text": "send the data to multiple Telemetry backends however to allow these agents to be managed we need to establish a",
    "start": "454879",
    "end": "461000"
  },
  {
    "text": "protocol for communicating between the agents and an agent management platform this is where opamp comes in it",
    "start": "461000",
    "end": "468360"
  },
  {
    "text": "provides a standard protocol for managing agents it can be implemented once in each type of agent and each",
    "start": "468360",
    "end": "473879"
  },
  {
    "text": "vendor can Implement their own agent management capabilities in the server some vendors May focus on providing the",
    "start": "473879",
    "end": "479879"
  },
  {
    "text": "best agent management experience while allowing Telemetry data to be sent to multiple multiple Telemetry",
    "start": "479879",
    "end": "486840"
  },
  {
    "text": "vendors the goal of opamp is to be an open protocol for communicating between agents and agent management",
    "start": "486840",
    "end": "492680"
  },
  {
    "text": "platforms it's vendor neutral without favoring any particular observability platform any agent in any language can",
    "start": "492680",
    "end": "500240"
  },
  {
    "text": "implement the protocol and any management server in any language can manage these agents the protocol is e",
    "start": "500240",
    "end": "505720"
  },
  {
    "text": "easy to implement with a reference implementation and go it is flexible with support for communication via HTTP",
    "start": "505720",
    "end": "512440"
  },
  {
    "text": "or websockets and finally this is important it allows for a partial implementation of the protocol some",
    "start": "512440",
    "end": "518719"
  },
  {
    "text": "agents may only connect and Report their status some management servers may only show connected agents others may allow",
    "start": "518719",
    "end": "525600"
  },
  {
    "text": "for full Remote Management of the agents including remote agent",
    "start": "525600",
    "end": "531360"
  },
  {
    "text": "upgrades let's first look at the way agents connect to the management server using the opamp",
    "start": "531360",
    "end": "538160"
  },
  {
    "text": "protocol as I just mentioned HTTP or websocket",
    "start": "538200",
    "end": "544000"
  },
  {
    "text": "connections can be used for communication to keep things simple there are only two messages defined by",
    "start": "544000",
    "end": "549399"
  },
  {
    "text": "the protocol and their names couldn't be more obvious agents send agent to server messages to the server and serers send",
    "start": "549399",
    "end": "556000"
  },
  {
    "text": "server to agent messages to the agent here are the details of those",
    "start": "556000",
    "end": "563959"
  },
  {
    "text": "messages in these slides I reorganized the fields remove the protuff tag numbers and simp the comments for",
    "start": "563959",
    "end": "570880"
  },
  {
    "text": "readability I will still show many of the Proto structures because I think it's important to see the details but if",
    "start": "570880",
    "end": "576120"
  },
  {
    "text": "it's hard to read these are all available in the opamp spec repo both of these messages contain a",
    "start": "576120",
    "end": "583800"
  },
  {
    "text": "unique ID I'm sorry an instance uid um which identifies the agent that is",
    "start": "583800",
    "end": "589360"
  },
  {
    "text": "either the source or Target of the message capabilities flags on each",
    "start": "589360",
    "end": "594839"
  },
  {
    "text": "message identify the capabilities of the agent and server and this allows for partial implementation of the",
    "start": "594839",
    "end": "601920"
  },
  {
    "text": "protocol each message contains sub messages that serve different capabilities to minimize the amount of",
    "start": "601920",
    "end": "607839"
  },
  {
    "text": "data transmitted with each message sub messages can be emitted if the information sent previously hasn't",
    "start": "607839",
    "end": "613560"
  },
  {
    "text": "changed I'll describe a few of these sub messages in detail later using websockets on Startup the",
    "start": "613560",
    "end": "620920"
  },
  {
    "text": "agent connects to the management server the server can use the connection headers a client certificate or anything",
    "start": "620920",
    "end": "626160"
  },
  {
    "text": "else available on the HTTP request to authenticate the agent after connecting the client sends",
    "start": "626160",
    "end": "632600"
  },
  {
    "text": "an initial agent to server message with its status this includes the set of capabilities by the agent and any status",
    "start": "632600",
    "end": "638959"
  },
  {
    "text": "corresponding to these capabilities this may include for example its current configuration the server then responds",
    "start": "638959",
    "end": "645000"
  },
  {
    "text": "to the agent with a server to agent message including its capabilities and any instructions for the",
    "start": "645000",
    "end": "650120"
  },
  {
    "text": "agent if the response includes change changes that modify the status of the agent it must send another agent to",
    "start": "650120",
    "end": "656600"
  },
  {
    "text": "server message with its new status at any point while the agent is connected the server may send a message",
    "start": "656600",
    "end": "662760"
  },
  {
    "text": "to the agent for example it could instruct it to change its configuration based on a user clicking on a management",
    "start": "662760",
    "end": "668000"
  },
  {
    "text": "dashboard or it could be a get Ops workflow calling an API in point on the server because there is a persistent",
    "start": "668000",
    "end": "673920"
  },
  {
    "text": "connection these messages can be sent to the agent immediately If the message modifies the status of the agent the agent must",
    "start": "673920",
    "end": "680440"
  },
  {
    "text": "respond with its new status using the HTTP protocol the agent",
    "start": "680440",
    "end": "685560"
  },
  {
    "text": "sends us messages in the body of a post request the server responds request with a server to agent message the server can",
    "start": "685560",
    "end": "691959"
  },
  {
    "text": "still send a message to the agent but it must wait to receive the next agent to server message it can then send its",
    "start": "691959",
    "end": "697240"
  },
  {
    "text": "message and response to make this work the agent must periodically send empty messages to the server this allows the",
    "start": "697240",
    "end": "703519"
  },
  {
    "text": "HTTP and websocket transports to be functionally equivalent it increases the latency of messages sent from the server",
    "start": "703519",
    "end": "709519"
  },
  {
    "text": "but it doesn't require a persistent connection to be",
    "start": "709519",
    "end": "713680"
  },
  {
    "text": "maintained now that we know how the messages are sent between the agent and server let's discuss the capabilities enabled by the protocol there are five",
    "start": "714720",
    "end": "722200"
  },
  {
    "text": "core capabilities and an additional capability to extend the protocol with custom",
    "start": "722200",
    "end": "727480"
  },
  {
    "text": "messages status includes the description of the agent and the status of any other capabilities supported by the agent this",
    "start": "727480",
    "end": "734000"
  },
  {
    "text": "is required for all implementations if it's not obvious the big square is the management server and the little circles",
    "start": "734000",
    "end": "740639"
  },
  {
    "text": "are agents in this picture remote configuration reports the",
    "start": "740639",
    "end": "746240"
  },
  {
    "text": "configuration of the agent and can allow the configuration should be remotely Modified by the management",
    "start": "746240",
    "end": "751720"
  },
  {
    "text": "server package management reports the packages of an agent and can allow them to be modified and this may include",
    "start": "751720",
    "end": "757360"
  },
  {
    "text": "upgrading the entire agent binary own Telemetry settings report the",
    "start": "757360",
    "end": "763079"
  },
  {
    "text": "current Telemetry configuration of the agent to send its own logs metrics and traces to the Telemetry back end can Al",
    "start": "763079",
    "end": "770199"
  },
  {
    "text": "also support remote configuration of these settings and this is what enables um visibility of the agent and its uh",
    "start": "770199",
    "end": "777839"
  },
  {
    "text": "collection connection settings allow other connection settings to be reported and",
    "start": "777839",
    "end": "784720"
  },
  {
    "text": "potentially modified during its connection to the opamp server and finally custom messages allow",
    "start": "784720",
    "end": "791639"
  },
  {
    "text": "additional messages to be sent between the agent server and their format and contents are not defined by the protocol",
    "start": "791639",
    "end": "797480"
  },
  {
    "text": "this allows the connection to be reused for vendor specific behavior outside the scope of the",
    "start": "797480",
    "end": "803120"
  },
  {
    "text": "protocol support for individual capabilities of the agent are specified with the capability bit mask in the",
    "start": "803120",
    "end": "809760"
  },
  {
    "text": "agent to server message here I have them Group by capabilities that send information to the server and those that",
    "start": "809760",
    "end": "816639"
  },
  {
    "text": "accept changes from the server similarly server capabilities indicate capabilities supported by the",
    "start": "816639",
    "end": "823800"
  },
  {
    "text": "server here they are grouped by fields that identify what the server will accept and what the server will offer",
    "start": "823800",
    "end": "830639"
  },
  {
    "text": "the combination of agent and server capabilities are what allow the protocol to support partial",
    "start": "830639",
    "end": "836279"
  },
  {
    "text": "implementation let's look at agent status reporting in more detail agents are required to report",
    "start": "836279",
    "end": "842800"
  },
  {
    "text": "status upon connecting to the server they may also report status any time this status changes they must also",
    "start": "842800",
    "end": "849880"
  },
  {
    "text": "excuse me the uh the status represents the current state of the agent for all of its supported",
    "start": "849880",
    "end": "855720"
  },
  {
    "text": "capabilities after connecting all supported sub messages should be reported in subsequent messages only the",
    "start": "855720",
    "end": "861480"
  },
  {
    "text": "sub messages that change need to be reported I'll describe the first three sub messages here in",
    "start": "861480",
    "end": "866880"
  },
  {
    "text": "detail the agent description contains attributes that describe the agent the combination of identifying attributes",
    "start": "866880",
    "end": "873480"
  },
  {
    "text": "should uniquely identify the agent the names of these attributes should match the resource semantic conventions",
    "start": "873480",
    "end": "878759"
  },
  {
    "text": "defined by open Telemetry and these attributes should also be included in Telemetry sent by",
    "start": "878759",
    "end": "883959"
  },
  {
    "text": "the agent so that it can be easily identified in slimmetry back end the non-identifying attributes describe",
    "start": "883959",
    "end": "889639"
  },
  {
    "text": "things like where the agent runs and can include any userdefined attributes that the end user would like to be associated",
    "start": "889639",
    "end": "895720"
  },
  {
    "text": "with the agent the component Health sub message contains detailed information about the",
    "start": "895720",
    "end": "901600"
  },
  {
    "text": "status of the agent and its components the recursive component Health map field allows the health to",
    "start": "901600",
    "end": "907560"
  },
  {
    "text": "Nest as deeply as needed to describe the agent and all of its components and the effective config",
    "start": "907560",
    "end": "913880"
  },
  {
    "text": "message represents the configuration actually being used by the agent contains a config map where the keys are",
    "start": "913880",
    "end": "920079"
  },
  {
    "text": "config file names or config section names as appropriate for the agent each file contains the body and content type",
    "start": "920079",
    "end": "926279"
  },
  {
    "text": "but the content format and encoding of the configuration depends on the type of",
    "start": "926279",
    "end": "932399"
  },
  {
    "text": "agent now let's look at remote configuration the agent can support both",
    "start": "932519",
    "end": "937680"
  },
  {
    "text": "read and write of its configuration looking at the agent and server capabilities we see that there are",
    "start": "937680",
    "end": "943519"
  },
  {
    "text": "separate capabilities for the agent reporting and the server accepting effective configuration there are also",
    "start": "943519",
    "end": "949399"
  },
  {
    "text": "separate capabilities for the server offering configuration and the agent accepting remote configuration enabling",
    "start": "949399",
    "end": "954560"
  },
  {
    "text": "all these flags allows the agent to be remotely configured",
    "start": "954560",
    "end": "960600"
  },
  {
    "text": "as I show the remote configuration process I will simplify the communication to only show the sub messages so on connection the agent",
    "start": "961440",
    "end": "968120"
  },
  {
    "text": "sends the effective config as part of its initial status message if the server determines that it",
    "start": "968120",
    "end": "974319"
  },
  {
    "text": "should be using a different configuration and the agent accepts remote configuration it sends an agent",
    "start": "974319",
    "end": "979560"
  },
  {
    "text": "remote config message to the agent containing the new configuration the agent immediately",
    "start": "979560",
    "end": "985600"
  },
  {
    "text": "updates its remote config status indicating that is applying the new configuration when the new configuration",
    "start": "985600",
    "end": "991639"
  },
  {
    "text": "has been applied it updates its status this includes its new effective config",
    "start": "991639",
    "end": "997240"
  },
  {
    "text": "and remote config status with the applied status this interaction follows a simple rule of the protocol that when",
    "start": "997240",
    "end": "1003199"
  },
  {
    "text": "the agent status changes it must be reported to the server if the new agent if the config",
    "start": "1003199",
    "end": "1011399"
  },
  {
    "text": "could not be applied the remote config status is updated with a failed status and an optional error",
    "start": "1011399",
    "end": "1017480"
  },
  {
    "text": "message here's the remote the agent remote config message that is sent from the",
    "start": "1017480",
    "end": "1024038"
  },
  {
    "text": "server to instruct the agent to use a new config it includes the config in the same format as the effective config",
    "start": "1024039",
    "end": "1029918"
  },
  {
    "text": "message sent by the agent it also includes a config hash that allows the configuration to be easily identified in",
    "start": "1029919",
    "end": "1035918"
  },
  {
    "text": "subsequent messages the remote config status is updated after an agent remote config",
    "start": "1035919",
    "end": "1041640"
  },
  {
    "text": "message is received it includes a last remote config hash that refers to the",
    "start": "1041640",
    "end": "1046798"
  },
  {
    "text": "config hash that was sent by the agent remote config and it also indicates the status of applying applied or failed if",
    "start": "1046799",
    "end": "1054400"
  },
  {
    "text": "the status is failed an optional error message can be included as I mentioned in the beginning",
    "start": "1054400",
    "end": "1060880"
  },
  {
    "text": "there's more to opamp the opamp protocol that we have time to cover and I encourage you to check out the spec for",
    "start": "1060880",
    "end": "1066000"
  },
  {
    "text": "more detail opamp is currently being implemented in open",
    "start": "1066000",
    "end": "1072759"
  },
  {
    "text": "Telemetry and there's two parts or three parts to this I'll cover two of them and Jacob will cover the third so so um",
    "start": "1073280",
    "end": "1079440"
  },
  {
    "text": "there's an opamp extension in The Collector that can be configured to contact an opamp server it reports the",
    "start": "1079440",
    "end": "1085200"
  },
  {
    "text": "agent description and Report the component health and the effective config of the agent as well it provides",
    "start": "1085200",
    "end": "1090960"
  },
  {
    "text": "a readon representation of The Collector to an AG agent management",
    "start": "1090960",
    "end": "1096360"
  },
  {
    "text": "server the supervisor is the second part of this and it is a separate process",
    "start": "1096880",
    "end": "1102799"
  },
  {
    "text": "that can manage the open Telemetry collector that implements both an opamp client and server as you see in the",
    "start": "1102799",
    "end": "1108880"
  },
  {
    "text": "diagram the opamp extension in The Collector reports to the opamp server in the supervisor and the supervisor",
    "start": "1108880",
    "end": "1116000"
  },
  {
    "text": "contains an opamp client that connects to the opamp back end it relays The Collector status to the opamp back end",
    "start": "1116000",
    "end": "1122440"
  },
  {
    "text": "and when it receives a new configuration it can conf configure The Collector by writing a new config and",
    "start": "1122440",
    "end": "1128520"
  },
  {
    "text": "restarting the collector process so now I'm going to give a demo",
    "start": "1128520",
    "end": "1135159"
  },
  {
    "text": "of remote configuration using an opamp server",
    "start": "1135159",
    "end": "1140320"
  },
  {
    "text": "I recorded this because the Wi-Fi has not been great if anybody's [Music]",
    "start": "1143559",
    "end": "1149760"
  },
  {
    "text": "noticed okay so what you see here is an opamp server called bind plane which is capable of remotely configuring agents",
    "start": "1149760",
    "end": "1156960"
  },
  {
    "text": "on the screen is a configuration that is sending engin X logs to grafana and",
    "start": "1156960",
    "end": "1163240"
  },
  {
    "text": "S3 the configuration is deployed to agents we can see them below they're all",
    "start": "1165039",
    "end": "1171120"
  },
  {
    "text": "currently using looks like version 15 of the",
    "start": "1171120",
    "end": "1175679"
  },
  {
    "text": "configuration we can see they are sending logs and there's one processor that is reducing the number of logs going to grafana we're sending all logs",
    "start": "1176280",
    "end": "1183480"
  },
  {
    "text": "to S3 but only air logs are being sent to grafana suppose there's an issue and we decide that collecting info level",
    "start": "1183480",
    "end": "1189720"
  },
  {
    "text": "logs would help us diagnose the",
    "start": "1189720",
    "end": "1193039"
  },
  {
    "text": "issue we can remove this severity",
    "start": "1195400",
    "end": "1201039"
  },
  {
    "text": "filter save it and then start a roll out to the",
    "start": "1201600",
    "end": "1210360"
  },
  {
    "text": "agents what you're seeing is a stage roll out where the opamp server is sending configuration to a few agents at",
    "start": "1212480",
    "end": "1217840"
  },
  {
    "text": "a",
    "start": "1217840",
    "end": "1220039"
  },
  {
    "text": "time you'll see the agents briefly go into configuring status and then go back to connect",
    "start": "1223799",
    "end": "1230159"
  },
  {
    "text": "when it completes after a few seconds we'll see that all flogs all",
    "start": "1233559",
    "end": "1238600"
  },
  {
    "text": "logs are flowing to",
    "start": "1238600",
    "end": "1241760"
  },
  {
    "text": "grafana so after diagnosing the issue I could come back and repeat this process and re add the filter and deploy that",
    "start": "1247720",
    "end": "1254960"
  },
  {
    "text": "again and um it would allow me to remotely manage this",
    "start": "1254960",
    "end": "1261120"
  },
  {
    "text": "configuration all right now Jacob's going to talk about opamp and",
    "start": "1262240",
    "end": "1267400"
  },
  {
    "text": "kubernetes thanks Andy first I'm going to describe uh the",
    "start": "1267400",
    "end": "1272799"
  },
  {
    "text": "open Telemetry operator which we use uh for all of this so the open Telemetry",
    "start": "1272799",
    "end": "1277880"
  },
  {
    "text": "operator was created in August of 2019 the goal of the project is to make using otel in the cube environment just as",
    "start": "1277880",
    "end": "1284240"
  },
  {
    "text": "easy as possible the operator aderes to the standard operator pattern kubernetes this means its main job is to reconcile",
    "start": "1284240",
    "end": "1290679"
  },
  {
    "text": "its custom resources in this case the operator provides three resources collectors and abstraction to simplify",
    "start": "1290679",
    "end": "1297279"
  },
  {
    "text": "the deployment and management of otel collectors instrumentation a resource to simplify automatic instrumentation of",
    "start": "1297279",
    "end": "1303440"
  },
  {
    "text": "your applications and the newest one the opamp bridge which I'll be talking about",
    "start": "1303440",
    "end": "1308720"
  },
  {
    "text": "later there are many modes to deploy The Collector today I'll only focus on the three most common ones this is what",
    "start": "1308720",
    "end": "1315279"
  },
  {
    "text": "running a collector in deployment mode might look like this is especially useful for tracing and logs where you're",
    "start": "1315279",
    "end": "1320360"
  },
  {
    "text": "simply forwarding processing and enriching your Telemetry demon sets are especially",
    "start": "1320360",
    "end": "1325640"
  },
  {
    "text": "useful for things like Prometheus metric scraping or log collection where you collect from each workload that lives on",
    "start": "1325640",
    "end": "1330960"
  },
  {
    "text": "the same node finally you can run collector in a staple set a staple set lets you take",
    "start": "1330960",
    "end": "1336799"
  },
  {
    "text": "advantage of features like the target allocator which allows you to distribute Prometheus scrape targets amongst your",
    "start": "1336799",
    "end": "1342000"
  },
  {
    "text": "pool of collectors this lets you horizontally scale your collectors with the amount of PODS you run the state",
    "start": "1342000",
    "end": "1348320"
  },
  {
    "text": "full set also lets you have consistent IDs for stable naming as well as connecting to volumes for persistent",
    "start": "1348320",
    "end": "1355039"
  },
  {
    "text": "queuing as stated before otel is a huge ecosystem with so many features you can enrich all of your Telemetry with data",
    "start": "1355039",
    "end": "1361679"
  },
  {
    "text": "from the cube API you can scrape all your Prometheus metrics you can even run",
    "start": "1361679",
    "end": "1366760"
  },
  {
    "text": "complex transformations in otel Native transformation language say you have a cluster that",
    "start": "1366760",
    "end": "1372080"
  },
  {
    "text": "runs a collector deployment that does some kubernetes attribute enrichment andfor fors the OTL",
    "start": "1372080",
    "end": "1378679"
  },
  {
    "text": "traces to your back end maybe after that you add an a stateful set collector with the target allocator to scrape all of",
    "start": "1378679",
    "end": "1385039"
  },
  {
    "text": "your metrics and send them viewa Prometheus remote right to a back end and finally you add a demon set to",
    "start": "1385039",
    "end": "1390919"
  },
  {
    "text": "get all of your cluster and application logs foring to an elastic back end trying to pin where a metric Tracer",
    "start": "1390919",
    "end": "1397520"
  },
  {
    "text": "log came from or more importantly where data is being dropped can be a real challenge when you're running so many",
    "start": "1397520",
    "end": "1403480"
  },
  {
    "text": "collectors when one of these collectors is Crash looping it can be hard to debug going back to the introduction how do",
    "start": "1403480",
    "end": "1410000"
  },
  {
    "text": "you debug when the agent you rely on for debugging information is unreliable beyond that managing and",
    "start": "1410000",
    "end": "1416159"
  },
  {
    "text": "wrangling these collector pools becomes a real hassle if you're going through cicd without running any validation on",
    "start": "1416159",
    "end": "1421880"
  },
  {
    "text": "your config you could potentially push out bad configuration and need to run through your whole cicd to stop that",
    "start": "1421880",
    "end": "1428279"
  },
  {
    "text": "crashing or maybe you heard of a new feature in The Collector that you desperately want in all of your collector pools or maybe a new service",
    "start": "1428279",
    "end": "1435200"
  },
  {
    "text": "came online that's sending way too many spans and you need to sample it as soon as possible to not explode your",
    "start": "1435200",
    "end": "1441480"
  },
  {
    "text": "spend at this point your head might be spinning at the possibilities if you're in hundreds of clusters and have many",
    "start": "1441480",
    "end": "1448080"
  },
  {
    "text": "different configurations in each it gets incredibly unwieldy imagine using Argo CD to deploy your collectors and you",
    "start": "1448080",
    "end": "1454640"
  },
  {
    "text": "want to add a new feature to all of your clusters that gets the cluster name and appends it to all of your Telemetry if",
    "start": "1454640",
    "end": "1460320"
  },
  {
    "text": "each configuration is in its own values file you need to update however many clusters you have by how many however",
    "start": "1460320",
    "end": "1465960"
  },
  {
    "text": "many configurations you have and wait for the mall to roll out well today I'm happy to introduce",
    "start": "1465960",
    "end": "1471640"
  },
  {
    "text": "the offand bridge the bridge sits in your kubernetes cluster and acts as a supervisor that reports on the expected",
    "start": "1471640",
    "end": "1477760"
  },
  {
    "text": "configuration and current health of your collector pools the bridge queries the cube API using the otel operators",
    "start": "1477760",
    "end": "1484240"
  },
  {
    "text": "collect your resource to get the status and health of each pool you run in that cluster you can even use an opamp server",
    "start": "1484240",
    "end": "1491440"
  },
  {
    "text": "to remotely configure your collector pools recall that scenario I mentioned where you needed to immediately sample",
    "start": "1491440",
    "end": "1497120"
  },
  {
    "text": "traces from an a noisy application through the bridge you're able to add in that sample configuration in as little",
    "start": "1497120",
    "end": "1503240"
  },
  {
    "text": "as 1 second your operator server sends it to the bridge and then the bridge simply applies it via the cube",
    "start": "1503240",
    "end": "1509360"
  },
  {
    "text": "API the bridge is able to accept configuration for all of your opamp capabilities that Andy talked about",
    "start": "1509360",
    "end": "1514640"
  },
  {
    "text": "earlier the bridge also has an allow list to ensure that you deny any unknown or unverified components in your",
    "start": "1514640",
    "end": "1520720"
  },
  {
    "text": "collector the Bridge's default rbac also limits it to only query the cube API for",
    "start": "1520720",
    "end": "1525960"
  },
  {
    "text": "information about The otel Collector CR s now time for a quick",
    "start": "1525960",
    "end": "1532520"
  },
  {
    "text": "demo as you can see here it looks like we stopped receiving infrastructure metrics about 10 minutes ago I can",
    "start": "1533480",
    "end": "1539640"
  },
  {
    "text": "probably assume that one of our collector pools is unhappy I'm now going to apply the",
    "start": "1539640",
    "end": "1545640"
  },
  {
    "text": "op-amp bridge which should tell me all about the state of my collectors in my cluster here you can see the configuration for the bridge now I just",
    "start": "1545640",
    "end": "1552600"
  },
  {
    "text": "apply the helm chart with the Bridge wait for that to roll out",
    "start": "1552600",
    "end": "1559679"
  },
  {
    "text": "and now I'm going to go over to this little opam server I wrote an Elixir for this demo you can see here the agent is",
    "start": "1562480",
    "end": "1568840"
  },
  {
    "text": "connected and there are four cluster uh four collector pools as well you can see that the cluster stats",
    "start": "1568840",
    "end": "1575840"
  },
  {
    "text": "only has zero out of one replicas available so let me just pop over to logs to see what's up you can see in the",
    "start": "1575840",
    "end": "1581640"
  },
  {
    "text": "logs that there's a configuration problem for BOS set to debug which isn't right I go back into my configuration",
    "start": "1581640",
    "end": "1588840"
  },
  {
    "text": "change it to what I know is correct which is normal and then I submit that change you can see that it's immediately",
    "start": "1588840",
    "end": "1595039"
  },
  {
    "text": "applied via the bridge and if I go back to my metrics I'm just going to wait for it to roll",
    "start": "1595039",
    "end": "1602200"
  },
  {
    "text": "out and there we go metrics are back and I've solved this incident making sure",
    "start": "1609720",
    "end": "1615000"
  },
  {
    "text": "that you know nobody's going to be woken up nobody else I should say now I'm going",
    "start": "1615000",
    "end": "1620840"
  },
  {
    "text": "to show you one more feature uh the bridge is able to only allow reporting for some collector pools here I have a",
    "start": "1620840",
    "end": "1627600"
  },
  {
    "text": "login collector I'm going to try and edit it and you'll see that the bridge denies that",
    "start": "1627600",
    "end": "1633520"
  },
  {
    "text": "change and my metrics are still",
    "start": "1634120",
    "end": "1638120"
  },
  {
    "text": "happy to wrap it up we've shown today that agents are powerful observability tools we've also shown that you probably",
    "start": "1641960",
    "end": "1648720"
  },
  {
    "text": "need some form of insurance in the form of an operate an observer the OPM protocol is a vendor neutral method of",
    "start": "1648720",
    "end": "1655279"
  },
  {
    "text": "expressing agent management The otel Collector and the operator are both implementing OPM and we're looking",
    "start": "1655279",
    "end": "1660840"
  },
  {
    "text": "forward to more contributions finally we really encourage you to join the cncf slack in the otel agent uh agent",
    "start": "1660840",
    "end": "1668360"
  },
  {
    "text": "management working group Channel or the otel operator channel to talk to us more you can find us at D booths um please",
    "start": "1668360",
    "end": "1676840"
  },
  {
    "text": "leave some feedback on the QR code above and I think we do have time for some questions as well so please come up and",
    "start": "1676840",
    "end": "1683120"
  },
  {
    "text": "ask us some questions thank you",
    "start": "1683120",
    "end": "1687799"
  },
  {
    "text": "thanks yeah you want to come up to the mic over",
    "start": "1691240",
    "end": "1695480"
  },
  {
    "text": "there so in some cases uh you've come across back pressure issues with the hotel collector so how would this uh",
    "start": "1698720",
    "end": "1706519"
  },
  {
    "text": "help us double shoot and dissolve that that's a great question do you want",
    "start": "1706519",
    "end": "1712039"
  },
  {
    "text": "to sorry the question was if you see back pressure if it's a um I guess there's a",
    "start": "1712039",
    "end": "1719960"
  },
  {
    "text": "couple things first of all you could be identifying the back pressure via own Telemetry which is you know ideally",
    "start": "1719960",
    "end": "1725799"
  },
  {
    "text": "being sent to the back end so you see this in the Telemetry being sent by The Collector um if it's a configuration",
    "start": "1725799",
    "end": "1732080"
  },
  {
    "text": "issue um you could send down a new config um and hopefully resolve the",
    "start": "1732080",
    "end": "1737679"
  },
  {
    "text": "issue that way and then uh you're also able to just yeah as as Andy said send it up uh with",
    "start": "1737679",
    "end": "1744799"
  },
  {
    "text": "the op ID you're also able to change the amount of replicas or configure uh the HPA for The Collector as",
    "start": "1744799",
    "end": "1752240"
  },
  {
    "text": "well you want to go up to the mic yeah hey thanks for the talk I",
    "start": "1752240",
    "end": "1757519"
  },
  {
    "text": "apologize that this was covered um I know the main use case for this is to manage collectors could this also be",
    "start": "1757519",
    "end": "1763679"
  },
  {
    "text": "used to manage the configuration of your sdks in your application code so it's",
    "start": "1763679",
    "end": "1769559"
  },
  {
    "text": "100% the goal um it's there's a it's it's it's in an issue right now",
    "start": "1769559",
    "end": "1775559"
  },
  {
    "text": "in the in the repo and it's something that we're um still have some work to do in actually designing the architecture",
    "start": "1775559",
    "end": "1781720"
  },
  {
    "text": "and and implementing it and obviously implementing in every language STK but um I I love the idea I would accept",
    "start": "1781720",
    "end": "1788640"
  },
  {
    "text": "contributions I'm it's a it's intentionally um simple and and",
    "start": "1788640",
    "end": "1794480"
  },
  {
    "text": "constrained um but also flexible so that it should be fairly easy to implement um",
    "start": "1794480",
    "end": "1800559"
  },
  {
    "text": "but it'll be different in every SDK so okay cool thank you contributions welcome",
    "start": "1800559",
    "end": "1808760"
  },
  {
    "text": "definitely uh a question I had was about um and maybe maybe this was made clear in the presentation and I missed it but",
    "start": "1808760",
    "end": "1815760"
  },
  {
    "text": "um how flexible the agent status is like for that last back pressure scenario if",
    "start": "1815760",
    "end": "1821559"
  },
  {
    "text": "we have some sort of mechanism of detesting we're in a back pressure mode or that back pressure signals are being sent or maybe we're reading like run",
    "start": "1821559",
    "end": "1827399"
  },
  {
    "text": "memory information for some of that stuff could that be part of an agent status message that a back end is",
    "start": "1827399",
    "end": "1832559"
  },
  {
    "text": "capable of reading and reacting to [Music]",
    "start": "1832559",
    "end": "1838840"
  },
  {
    "text": "um um yeah yeah we've actually been doing a bunch of work uh for this exact",
    "start": "1838840",
    "end": "1844360"
  },
  {
    "text": "scenario um such that the uh agent like the actual collector uh would be able to",
    "start": "1844360",
    "end": "1851039"
  },
  {
    "text": "report its component status which is this uh recursive map and ideally",
    "start": "1851039",
    "end": "1856120"
  },
  {
    "text": "something like the memory limiter could um say you know I'm under back pressure at which point your backend",
    "start": "1856120",
    "end": "1862399"
  },
  {
    "text": "could effectively respond to that so definitely something that we're thinking a lot about makes sense thank you yeah",
    "start": "1862399",
    "end": "1867519"
  },
  {
    "text": "I'm just going to bring this up this was the component Health piece um and this is fairly recent actually in the in the",
    "start": "1867519",
    "end": "1873679"
  },
  {
    "text": "collector and is um the part of the goal of that implementation is to be able to report this um up through opamp so um",
    "start": "1873679",
    "end": "1882519"
  },
  {
    "text": "this allows that nested structure and allows a lot of status information and the status wasn't intentionally left as",
    "start": "1882519",
    "end": "1888120"
  },
  {
    "text": "a string with this recursive map that can be arbitrarily deep um to try to",
    "start": "1888120",
    "end": "1893799"
  },
  {
    "text": "accommodate any agent scenario or any component that might have you know end",
    "start": "1893799",
    "end": "1899120"
  },
  {
    "text": "levels deep of configuration or something so um that's the goal of the",
    "start": "1899120",
    "end": "1904919"
  },
  {
    "text": "structure thank you for great talk uh I might misunderstand something but uh",
    "start": "1905279",
    "end": "1910919"
  },
  {
    "text": "about the remote configurations uh it's updating the like configuration configurations of the open correctors",
    "start": "1910919",
    "end": "1917760"
  },
  {
    "text": "right then how to work with the like uh configurations manage in g style uh or",
    "start": "1917760",
    "end": "1925240"
  },
  {
    "text": "should we stop like managing the configurations inqu um it's a good question I mean I",
    "start": "1925240",
    "end": "1932000"
  },
  {
    "text": "still think that that's a valid way of um of deploying and changing configurations um and not intended to",
    "start": "1932000",
    "end": "1939480"
  },
  {
    "text": "replace that and you know I wouldn't advise against that I guess I would say I would I would just say it's kind of a",
    "start": "1939480",
    "end": "1945919"
  },
  {
    "text": "both end situation um I think there will be situations where people are primarily using the uh",
    "start": "1945919",
    "end": "1952960"
  },
  {
    "text": "remote configuration in sort of a read mode where it's reporting the configuration um for uh to to to a",
    "start": "1952960",
    "end": "1960440"
  },
  {
    "text": "dashboard of your agents that you can see what those agents are actually running and then uh if you notice an",
    "start": "1960440",
    "end": "1965639"
  },
  {
    "text": "issue then you would maybe change it in your in your git repo and all and use G",
    "start": "1965639",
    "end": "1970720"
  },
  {
    "text": "Ops to deploy new configuration so that's a a valid architecture as well",
    "start": "1970720",
    "end": "1978720"
  },
  {
    "text": "hi uh thanks for the talk it's very informative I had a question about bad configs being pushed to agents like I I",
    "start": "1978720",
    "end": "1986360"
  },
  {
    "text": "was wondering like where is like that problem solved where like there's a bad config some error in the configuration",
    "start": "1986360",
    "end": "1992240"
  },
  {
    "text": "and we're pushing to the agent do we expect like the supervisor process to deal with it do we expect that to be",
    "start": "1992240",
    "end": "1997360"
  },
  {
    "text": "done at the server level or do we expect like the health checks somehow to validate that and revert to an old",
    "start": "1997360",
    "end": "2003440"
  },
  {
    "text": "version like how does that work yeah so I can tell you there's there's um the certainly the intention is to do",
    "start": "2003440",
    "end": "2009799"
  },
  {
    "text": "this in a safe Manner and um it's it's kind of up to the implementer but I'll tell you there's the two implementations I'm aware of one is an an our um observe",
    "start": "2009799",
    "end": "2017760"
  },
  {
    "text": "IQ collector which is called bind plane agent it's deployment of open of open Telemetry I'm sorry yeah distribution of",
    "start": "2017760",
    "end": "2024360"
  },
  {
    "text": "open Telemetry and it um will save the old config try the new config if that",
    "start": "2024360",
    "end": "2030320"
  },
  {
    "text": "fails revert um run the old config and report its status of as being an error",
    "start": "2030320",
    "end": "2036679"
  },
  {
    "text": "while still using the old config and continuing to collect Telemetry um",
    "start": "2036679",
    "end": "2042000"
  },
  {
    "text": "similarly the supervisor um will write a new config and if the supervis if the The Collector",
    "start": "2042000",
    "end": "2048878"
  },
  {
    "text": "fails to start it will restore the old config and Report the error status as well so it's it's um and I would",
    "start": "2048879",
    "end": "2056079"
  },
  {
    "text": "encourage any other implementation in any other agent to work the same way um but right now those are the two so yeah",
    "start": "2056079",
    "end": "2062919"
  },
  {
    "text": "and then in the bridge we're working on bridge and operator group we're working on enhance like configuration validation",
    "start": "2062919",
    "end": "2068720"
  },
  {
    "text": "stuff as well thank we have time for one more question I think thank you for the talk I got two",
    "start": "2068720",
    "end": "2076280"
  },
  {
    "text": "quick questions so on the config management wouldn't it be possible for you to have a g lab or ghub URL in the",
    "start": "2076280",
    "end": "2084240"
  },
  {
    "text": "editor instead of the the whole config and just upload that and say use this instead and that's a great idea you know",
    "start": "2084240",
    "end": "2091800"
  },
  {
    "text": "not have to worry about okay you your database keeps the config versus you know GitHub does it anyway um my",
    "start": "2091800",
    "end": "2099000"
  },
  {
    "text": "question really is on the Telemetry that you collect for the pipelines that you're showing in the UI how big of a",
    "start": "2099000",
    "end": "2106800"
  },
  {
    "text": "snapshot are you taking of the logs and the metrics and chases and how much data is that consuming in the environment",
    "start": "2106800",
    "end": "2113960"
  },
  {
    "text": "that so you're talking about in the demo where we showed Telemetry when you go and look at the logs and verify the the",
    "start": "2113960",
    "end": "2120160"
  },
  {
    "text": "metrics or the traces said that you're getting what you're expecting so that's using a a custom processor that we wrote",
    "start": "2120160",
    "end": "2126440"
  },
  {
    "text": "that is just buffering um like the last it's usually about a 100 signals but",
    "start": "2126440",
    "end": "2132760"
  },
  {
    "text": "okay I was hoping you said that um we I say roughly 100 because we",
    "start": "2132760",
    "end": "2138240"
  },
  {
    "text": "don't try to break up Right Packages because that would if we're just going to throw them away anyway so but it's we",
    "start": "2138240",
    "end": "2145160"
  },
  {
    "text": "try to keep keep it small I think we are out of time unfortunately but please come ask us",
    "start": "2145160",
    "end": "2150839"
  },
  {
    "text": "questions uh happy to stay back and chat a little bit more thank you",
    "start": "2150839",
    "end": "2160480"
  }
]