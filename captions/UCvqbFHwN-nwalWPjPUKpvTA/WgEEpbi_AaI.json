[
  {
    "text": "thanks everyone uh thank you for joining me for the last Talk of the day hopefully we still have a little bit of energy um it's kind of funny I mean I'm",
    "start": "40",
    "end": "6759"
  },
  {
    "text": "sure the program committee obviously scheduled things that the way they scheduled it but Andre selfa to follow",
    "start": "6759",
    "end": "12200"
  },
  {
    "text": "let it's going to be interesting because this is a very different take actually on a very similar idea so hopefully if",
    "start": "12200",
    "end": "18560"
  },
  {
    "text": "you were here for the last talk you should be able to take some more away because of that um but anyway so subject",
    "start": "18560",
    "end": "23800"
  },
  {
    "text": "of this talk is net re Bridging the Gap between missum and Nomad uh my name is Dan Norris I am currently the",
    "start": "23800",
    "end": "29240"
  },
  {
    "text": "infrastructure leader a company called Cosmic and so the agenda we'll kind of walk through here is sort of an overall",
    "start": "29240",
    "end": "36000"
  },
  {
    "text": "uh description of the problem like why did we go about doing this in the first place um and I'll talk about uh kind of",
    "start": "36000",
    "end": "42120"
  },
  {
    "text": "why we ended up deciding to use Nomad in the first place for what we're doing um and of course why we chose celium I mean",
    "start": "42120",
    "end": "47399"
  },
  {
    "text": "I think some of that self-evidence since we're all kind of in the same room but we'll get into it um then I'll give an",
    "start": "47399",
    "end": "52920"
  },
  {
    "text": "overview of uh net reap itself um what it is it's actually just a reimplementation of the um celium",
    "start": "52920",
    "end": "59120"
  },
  {
    "text": "operator uh then I'll give a quick demo so you can kind of see what it looks like in action um but the core problem",
    "start": "59120",
    "end": "66280"
  },
  {
    "text": "that I'm trying to solve with this particular technology is um I work at",
    "start": "66280",
    "end": "71600"
  },
  {
    "text": "cosonic we are a platform as a service it's actually web assembly we'll dig into that um but the main problem that I",
    "start": "71600",
    "end": "77880"
  },
  {
    "text": "wanted selum uh to be used in kind of our back end is we want to be able to secure customer traffic running a",
    "start": "77880",
    "end": "84640"
  },
  {
    "text": "platform as a service is a very different and effectively a cloud platform at that um is a very different",
    "start": "84640",
    "end": "91439"
  },
  {
    "text": "set of problems um and requires a very specific set of Technologies and for us celium is one of them um and",
    "start": "91439",
    "end": "98840"
  },
  {
    "text": "specifically what I wanted to be able to do and what my team wanted to be able to do uh was to be able to secure network",
    "start": "98840",
    "end": "104159"
  },
  {
    "text": "traffic um specifically on Nomad uh for those who are not familiar uh Nomad is",
    "start": "104159",
    "end": "109600"
  },
  {
    "text": "basically just another orchestrator it's kind of like kubernetes but Hashi quart flavored uh so a lot of HCL um there are",
    "start": "109600",
    "end": "116479"
  },
  {
    "text": "ways to actually secure workloads on Nomad out of the box it's called console connect it's kind of similar if you",
    "start": "116479",
    "end": "122560"
  },
  {
    "text": "squint hard enough to something like an IO it's a service mesh um you know does a lot of L7 sort of stuff you know mtls",
    "start": "122560",
    "end": "129920"
  },
  {
    "text": "all that sort of thing but it's really more geared towards uh securing microservice to microservice traffic",
    "start": "129920",
    "end": "137080"
  },
  {
    "text": "which works if you're operating on behalf of a single company you know single set of customers doesn't really",
    "start": "137080",
    "end": "142800"
  },
  {
    "text": "work if you're actually running customer workloads and like a ton of them you don't want them to interact in any way",
    "start": "142800",
    "end": "147920"
  },
  {
    "text": "shape form uh so for us it was really came down to how do we restrict traffic",
    "start": "147920",
    "end": "153599"
  },
  {
    "text": "based on attributes or for services that we have no idea what they are um and again like running a platform as a",
    "start": "153599",
    "end": "159840"
  },
  {
    "text": "service just a kind of a very different um set of needs than necessarily what a lot of companies do",
    "start": "159840",
    "end": "166200"
  },
  {
    "text": "have uh and so we specifically chose Nomad just to give a little bit of background um because it is actually",
    "start": "166200",
    "end": "172120"
  },
  {
    "text": "simpler and a lot more lightweight to run you don't need at CD um you actually deploy the whole thing um as single sets",
    "start": "172120",
    "end": "179159"
  },
  {
    "text": "of binaries they'll actually um cluster themselves together if you configure them correctly that's relatively recent",
    "start": "179159",
    "end": "184680"
  },
  {
    "text": "um but the one of the really big things for us is um it's a it's much more flexible in the way that it approaches",
    "start": "184680",
    "end": "193319"
  },
  {
    "text": "um scheduling and understanding what workloads are uh for example out of the box like you can obviously do Docker um",
    "start": "193319",
    "end": "199840"
  },
  {
    "text": "which is what like 90% of people do um but you can also actually schedule like Java jars natively you can do qmu",
    "start": "199840",
    "end": "206480"
  },
  {
    "text": "virtual machines um you can just run arbitrary um binaries that happen to be on the",
    "start": "206480",
    "end": "211680"
  },
  {
    "text": "host system with fork exec um and the really attractive part for us was that it makes it easy to write what they call",
    "start": "211680",
    "end": "218360"
  },
  {
    "text": "a task driver um so in quick bit of nomad parlament um a task is unit of",
    "start": "218360",
    "end": "224480"
  },
  {
    "text": "execution so it happens to be like a container um an attached driver is what actually um tells Nomad how to provide",
    "start": "224480",
    "end": "232040"
  },
  {
    "text": "that isolation that you need for any given workload and to do the setup and tear down for a task so like super",
    "start": "232040",
    "end": "237560"
  },
  {
    "text": "simple if you've ever done that with kubernetes you know like it's not really designed for that in the slightest there are projects that help you do it but",
    "start": "237560",
    "end": "244000"
  },
  {
    "text": "with Nomad it's really easy um as I mentioned a couple times right uh I work",
    "start": "244000",
    "end": "250040"
  },
  {
    "text": "for a company called about cosonic we're a platform as a service for building distributed applications using web assembly um I've actually spent most of",
    "start": "250040",
    "end": "257079"
  },
  {
    "text": "my day at wasm day for that reason which is why I was a little hard to track down um but because we run such a unique",
    "start": "257079",
    "end": "263639"
  },
  {
    "text": "platform which is web assembly on the back end um and almost the entire product that we have actually built and",
    "start": "263639",
    "end": "269919"
  },
  {
    "text": "what we are hosting on behalf of customers um is built using um a cncf project called wasm Cloud which we are",
    "start": "269919",
    "end": "276280"
  },
  {
    "text": "almost incubating it's pretty cool um but we also use firecracker virtual machines to be even more paranoid about",
    "start": "276280",
    "end": "282520"
  },
  {
    "text": "it um this is not a web assembly talk like there are ways to do isolation like that's kind of the whole premise of web",
    "start": "282520",
    "end": "288039"
  },
  {
    "text": "assembly there's a reason we're actually doing that also with firecracker um it's mostly due to paranoia um we want to",
    "start": "288039",
    "end": "294160"
  },
  {
    "text": "make sure our customers are as you know safe as possible and don't end up trampling over each other interfering with us or or with um other customer",
    "start": "294160",
    "end": "301240"
  },
  {
    "text": "code uh but we also want to ensure file system and network isolation completely so give you kind of a diagram of what's",
    "start": "301240",
    "end": "307520"
  },
  {
    "text": "going on here and what kind of our back end looks like we've got Nomad floating around it's the orchestrator um it's",
    "start": "307520",
    "end": "313039"
  },
  {
    "text": "sitting there basically like behaving like a kubernetes cluster would right scheduling jobs and tasks um but they",
    "start": "313039",
    "end": "319400"
  },
  {
    "text": "happen to actually be firecracker virtual machines which are wrapping our customer code that are delivered as um",
    "start": "319400",
    "end": "325880"
  },
  {
    "text": "web assembly or in this case like was and Cloud actors or providers that's the that like we're running on their behalf",
    "start": "325880",
    "end": "332120"
  },
  {
    "text": "and so you know a lot of this is really isolated at least the compute level right there's no real tampering there's",
    "start": "332120",
    "end": "337280"
  },
  {
    "text": "no way that you know in theory and and probably in practice there's it's pretty hard to break out of um a KVM virtual",
    "start": "337280",
    "end": "343440"
  },
  {
    "text": "machine which is what firecracker is it's even harder to propably break out of the web assembly boundary given just",
    "start": "343440",
    "end": "349560"
  },
  {
    "text": "how strict that happens to be and the some of the guarantees we get with wasm Cloud but if you notice there's this big",
    "start": "349560",
    "end": "354800"
  },
  {
    "text": "cloud thing over on the right hand side of this diagram which is like just floating out there in the wind right",
    "start": "354800",
    "end": "360319"
  },
  {
    "text": "uh Nomad does support cni but not really mentioned on this diagram",
    "start": "360319",
    "end": "365880"
  },
  {
    "text": "is any of this inass and erass traffic like how do you actually manage that when you're running customer code that",
    "start": "365880",
    "end": "371479"
  },
  {
    "text": "can make arbitrary Network requests um and obviously the answer to that syum I'm sure you're all real shocked being",
    "start": "371479",
    "end": "377240"
  },
  {
    "text": "in this room uh and um I mean there's a number of reasons like why we decided to",
    "start": "377240",
    "end": "383520"
  },
  {
    "text": "choose celium I'll get into that in a little bit um I mean you've all drink the Kool-Aid so you know probably could guess um but one of the challeng or",
    "start": "383520",
    "end": "391720"
  },
  {
    "text": "there's a number of challenges when you're actually trying to run selum Nomad for one there's not a lot of documentation on how to even use a cni",
    "start": "391720",
    "end": "397599"
  },
  {
    "text": "in the first place there are very few I think almost none that just will work out of the box I mean obviously the",
    "start": "397599",
    "end": "403720"
  },
  {
    "text": "protocol is there but in terms of like guides or like how-tos nothing um the",
    "start": "403720",
    "end": "409479"
  },
  {
    "text": "other problem is actually on the psyllium side so I think psyllium a long time ago made what is probably the",
    "start": "409479",
    "end": "414759"
  },
  {
    "text": "correct choice to pretty much only interoperate with kubernetes for the most part right um and the re I mean you",
    "start": "414759",
    "end": "422560"
  },
  {
    "text": "can run all all the stuff and I'll tell you how we do it in a bit um but there was one thing that we really had a challenge with and we effectively had to",
    "start": "422560",
    "end": "429160"
  },
  {
    "text": "implement our own and that's the cium operator which is actually um what's running your cluster and doing a lot of",
    "start": "429160",
    "end": "434639"
  },
  {
    "text": "sort of the bookkeeping behind the scenes um it's kind of like making sure you don't run out of ips it handles",
    "start": "434639",
    "end": "439960"
  },
  {
    "text": "Distributing your network your uh endpoint labeling um it also distributes your network policies and so if you want",
    "start": "439960",
    "end": "446120"
  },
  {
    "text": "to replicate that and I think we saw a little bit of this in the last talk actually um you have to interact with",
    "start": "446120",
    "end": "451319"
  },
  {
    "text": "the lower level apis for to actually be able to use these features um the other",
    "start": "451319",
    "end": "456440"
  },
  {
    "text": "challenge is actually on the NAD side so typically in kubernetes when you are running a cni plugin um you know it's",
    "start": "456440",
    "end": "463280"
  },
  {
    "text": "nice you can actually like run that as a deployment or a demon set probably a demon set if you're saying um you know",
    "start": "463280",
    "end": "469120"
  },
  {
    "text": "things just run you manage it like you would any other workload in kubernetes that is not the case in Nomad which is",
    "start": "469120",
    "end": "474520"
  },
  {
    "text": "really annoying um what Nomad does when it starts up is it undergos a process called fingerprinting it basically",
    "start": "474520",
    "end": "481000"
  },
  {
    "text": "generates um a static list of all the things it can do so it basically um",
    "start": "481000",
    "end": "486560"
  },
  {
    "text": "Coates all the task drivers it has available it figures out what OS it's running on and in our case it figures",
    "start": "486560",
    "end": "492319"
  },
  {
    "text": "out what cni plugins are available to it and you cannot change that at runtime so",
    "start": "492319",
    "end": "497560"
  },
  {
    "text": "it has to be available you can't manage that um natively in the cluster was huge pain um so we did is just uh effectively",
    "start": "497560",
    "end": "506479"
  },
  {
    "text": "picked apart the um demon set that actually runs the celium agents typically in a kubernetes deploy like",
    "start": "506479",
    "end": "513399"
  },
  {
    "text": "literally just looked at um what was kind of there um there was some also some Clues kind of in the open source",
    "start": "513399",
    "end": "518479"
  },
  {
    "text": "Community is people who were trying to run a nomad and we ended up just implementing a big system G um job that",
    "start": "518479",
    "end": "525120"
  },
  {
    "text": "just runs it as a Docker container just kind of we put that on our V on our uh uh bare metal host and it just works um",
    "start": "525120",
    "end": "532480"
  },
  {
    "text": "I won't go into the details cuz there's a lot of details but I mean it's pretty scary like all sorts of capabilities",
    "start": "532480",
    "end": "537959"
  },
  {
    "text": "being added right a bunch of arguments um if you worked with it at this level it's probably nothing that surprising",
    "start": "537959",
    "end": "544240"
  },
  {
    "text": "but it took a little bit of work to kind of figure that out and it's just kind of this is normally what is taken care of for you which is typically pretty nice",
    "start": "544240",
    "end": "551040"
  },
  {
    "text": "in a kubernets cluster um another thing that we had to do and this is more of just uh something",
    "start": "551040",
    "end": "557040"
  },
  {
    "text": "that affected us because we were running firecracker and I just wanted to bring it up since this is a pretty Network Centric audience is um firecracker",
    "start": "557040",
    "end": "564720"
  },
  {
    "text": "expects I mean it can do cni but at the end of the day it actually wants a tap device so AWS um and that's their open",
    "start": "564720",
    "end": "572079"
  },
  {
    "text": "source project actually is firecracker um they actually have a um cni plugin",
    "start": "572079",
    "end": "578360"
  },
  {
    "text": "you can kind of just Jam at the bottom of your cni config uh that basically redirects everything to a tap device and",
    "start": "578360",
    "end": "584120"
  },
  {
    "text": "surprisingly that all just worked like it I was shocked I had no idea it was going to be that easy uh so just in case",
    "start": "584120",
    "end": "589959"
  },
  {
    "text": "you're wondering you can get celium through a tab device who knew uh so our solution um if you could",
    "start": "589959",
    "end": "597160"
  },
  {
    "text": "figure out from the title is the thing called net re so uh I'll get into what the name is where it came from but it is",
    "start": "597160",
    "end": "603120"
  },
  {
    "text": "open source um we have a project website you can find it on GitHub um and as I",
    "start": "603120",
    "end": "608640"
  },
  {
    "text": "mentioned it is effectively a nomad specific psyllium operator um pretty",
    "start": "608640",
    "end": "613760"
  },
  {
    "text": "lightweight um because you know we aren't going to reimplement completely everything uh and so we originally chose",
    "start": "613760",
    "end": "620000"
  },
  {
    "text": "the name because our primary focus and goal was to make sure that we were uh cleaning up all of our old IP",
    "start": "620000",
    "end": "625399"
  },
  {
    "text": "allocations and we ended up keeping the name cuz like come on did you see how metal that look logo was like why would we change that uh our main so the main",
    "start": "625399",
    "end": "633920"
  },
  {
    "text": "responsibilities of the binary um specifically is a few different things um cleaning up all the old end points so",
    "start": "633920",
    "end": "641040"
  },
  {
    "text": "we make sure that those don't stick around um also cleaning up all the nodes that happen to be removed from the",
    "start": "641040",
    "end": "647240"
  },
  {
    "text": "cluster again typically that's something that the operator does for you but we had to reimplement that behavior um what",
    "start": "647240",
    "end": "653480"
  },
  {
    "text": "it also does which is pretty cool um is that it also syncs all the network policies for all of the host that um",
    "start": "653480",
    "end": "660000"
  },
  {
    "text": "where is running so that way we can update it kind of dynamically and things just work and it's pretty nice uh and it",
    "start": "660000",
    "end": "667720"
  },
  {
    "text": "also applies on the metadata that we would want to all the various end points where the uh workloads happen to be",
    "start": "667720",
    "end": "673320"
  },
  {
    "text": "running um a lot of this is made possible actually through cilium's console support through the KV store",
    "start": "673320",
    "end": "679120"
  },
  {
    "text": "abstraction um we can and as we discovered or actually we thought about this but you can also use that CD um we",
    "start": "679120",
    "end": "686399"
  },
  {
    "text": "chose not to because we didn't want to run yet another state store we're actually already running console um and",
    "start": "686399",
    "end": "692160"
  },
  {
    "text": "many other Nomad deployments typically will use console because that's kind of how it was originally intended to be",
    "start": "692160",
    "end": "698000"
  },
  {
    "text": "used um nowadays actually you can just run it Standalone you don't need that requirement but again since most people",
    "start": "698000",
    "end": "703880"
  },
  {
    "text": "use it we felt that was fine to take the dependency and mostly that is for um",
    "start": "703880",
    "end": "709560"
  },
  {
    "text": "storing selum state but also Distributing the uh policies uh quick refresher on endpoints",
    "start": "709560",
    "end": "717480"
  },
  {
    "text": "so single cluster manages generally a single subnet like I mean there's all the cluster mesh stuff we don't really",
    "start": "717480",
    "end": "722800"
  },
  {
    "text": "mess with that so we're kind of a little bit more stock of ayum deploy um so in",
    "start": "722800",
    "end": "728000"
  },
  {
    "text": "our case for example like we would allocate a subnet in the 17226 range so you know that gives you",
    "start": "728000",
    "end": "734480"
  },
  {
    "text": "65 isk you know is um usable IP addresses which is not a small amount",
    "start": "734480",
    "end": "739720"
  },
  {
    "text": "but it does mean that it's something we want to keep an eye on uh we would have done IPv6 but there's some it works in",
    "start": "739720",
    "end": "745760"
  },
  {
    "text": "firecracker but the SDK doesn't really support it so it's kind of a so we're just like whatever we'll just do I4 it's",
    "start": "745760",
    "end": "751240"
  },
  {
    "text": "fine for now um so net reap will monitor for all of the agents which are effectively the Q blits coming up and",
    "start": "751240",
    "end": "757920"
  },
  {
    "text": "down um and we'll remove any old allocations and um just remove the uh",
    "start": "757920",
    "end": "763160"
  },
  {
    "text": "old uh nodes that need doesn't need to keep track of anymore um and it will in",
    "start": "763160",
    "end": "768600"
  },
  {
    "text": "that way we basically don't need to worry about um any of the health checks you don't need to Ping nodes are never going to exist again right there's no",
    "start": "768600",
    "end": "775000"
  },
  {
    "text": "reason to do it and that aspect of it is actually leader elected um all the endpoint allocation stuff is per um",
    "start": "775000",
    "end": "782839"
  },
  {
    "text": "agent or per server right but only one of them really needs to kind of do the bookkeeping for all the nodes so we just do a quick leader election uh using the",
    "start": "782839",
    "end": "790160"
  },
  {
    "text": "built-in support and console for that uh and I think the last",
    "start": "790160",
    "end": "795760"
  },
  {
    "text": "presentation touched on this a little bit right um but in case you're not 100% aware policies are actually stored",
    "start": "795760",
    "end": "801920"
  },
  {
    "text": "as one big Json blob that continually gets updated um so normally the celum",
    "start": "801920",
    "end": "807199"
  },
  {
    "text": "operator sort of like does all the distribu for you um but we need to replicate that so uh net re effectively",
    "start": "807199",
    "end": "813320"
  },
  {
    "text": "just puts a watch on a single KV file and you just kind of like jam a whole big Json policy file in there and",
    "start": "813320",
    "end": "819160"
  },
  {
    "text": "anytime you want to make a change to that that just gets replicated to all the nodes and then your policies are updated um there's some weird issues",
    "start": "819160",
    "end": "825320"
  },
  {
    "text": "there but it's for the most part it pretty much just works fine um so to demonstrate right so",
    "start": "825320",
    "end": "831440"
  },
  {
    "text": "here's just a really quick example I think I just pulled this off the policy generator by the way um so it's just a",
    "start": "831440",
    "end": "836839"
  },
  {
    "text": "really lightweight Network policy right I3 that's um matching a back end to a",
    "start": "836839",
    "end": "842279"
  },
  {
    "text": "front end that's really all it's doing the Json representation of that is almost the same right the only",
    "start": "842279",
    "end": "848440"
  },
  {
    "text": "difference is that the uh the name basically is just kind of just another label right but everything else sort of",
    "start": "848440",
    "end": "854440"
  },
  {
    "text": "flows from there but imagine on a particular uh server right that happens",
    "start": "854440",
    "end": "860160"
  },
  {
    "text": "to be a cium agent if you have a ton of policies this gets pretty big pretty quickly um it's also very different for",
    "start": "860160",
    "end": "866759"
  },
  {
    "text": "us because we tend to hand or actually you intend to we hand write all the Json for the policies um so it's a little bit",
    "start": "866759",
    "end": "873279"
  },
  {
    "text": "different of an experience than um I imagine most people in this room have with operating",
    "start": "873279",
    "end": "879480"
  },
  {
    "text": "celum uh so to recap like why did we go through all of this like why did we invent all this stuff from scratch and",
    "start": "879480",
    "end": "885519"
  },
  {
    "text": "end up using this whole orchestrator that no one else uses uh so the reason was at least because we were running",
    "start": "885519",
    "end": "891480"
  },
  {
    "text": "this platform um we want to be able to connect customers to individual virtual machines and manage their traffic individually and because cium you know",
    "start": "891480",
    "end": "899240"
  },
  {
    "text": "with Hubble and all the tooling we get all an unparalleled amount of insight into that traffic um obviously EF makes",
    "start": "899240",
    "end": "905920"
  },
  {
    "text": "it efficient that's like half the reason to run it um and also we get the ability to apply individual policies per",
    "start": "905920",
    "end": "912040"
  },
  {
    "text": "endpoint if we want based on tags and labels and so all the advantages of celium we wanted to bring that to Nomad",
    "start": "912040",
    "end": "917959"
  },
  {
    "text": "and our platform in particular uh so now it's demo time you know rock",
    "start": "917959",
    "end": "924160"
  },
  {
    "text": "on uh so what I'm going to do is I have a server that's already set up um",
    "start": "924160",
    "end": "929680"
  },
  {
    "text": "actually aw us that is just running a single node Nomad server and it's actually a joint server um an agent or",
    "start": "929680",
    "end": "937079"
  },
  {
    "text": "effectively a client and so what I'm going to do is just I'm going to turn on net reap which is actually this one um",
    "start": "937079",
    "end": "944079"
  },
  {
    "text": "and then I'm going to just deploy just a very small sample job and show you what the endpoints end up looking like and a",
    "start": "944079",
    "end": "950000"
  },
  {
    "text": "little bit about the config of the machine so I don't has anybody actually used Nomad in here I realized I should",
    "start": "950000",
    "end": "955519"
  },
  {
    "text": "have asked that okay handful of people um so so if you ever use terraform though this should at least like the",
    "start": "955519",
    "end": "961600"
  },
  {
    "text": "language should at least look familiar because this is HCl um all Nomad jobs are defined in HCL technically they're",
    "start": "961600",
    "end": "967360"
  },
  {
    "text": "actually are Json they get converted but this is how normal people end up writing them if you don't love giant piles Json",
    "start": "967360",
    "end": "974480"
  },
  {
    "text": "um so in here the only thing we really have to configure most of this is all boilerplate um the only thing we really",
    "start": "974480",
    "end": "980240"
  },
  {
    "text": "have to configure in here that kind of um is of interest to this audience is the cider that uh net re happens to be",
    "start": "980240",
    "end": "987440"
  },
  {
    "text": "managing so in this case it's just going to be 17266 um then of course the image and um",
    "start": "987440",
    "end": "995959"
  },
  {
    "text": "the other big thing is you have to mount in the psyllium socket so that it's able to communicate with the celium API so uh",
    "start": "995959",
    "end": "1004000"
  },
  {
    "text": "I will go ahead and just apply that on here so I'll do a nomad plan net reap",
    "start": "1004000",
    "end": "1009720"
  },
  {
    "text": "right go ahead and run it what there we go it's just on up and",
    "start": "1009720",
    "end": "1015199"
  },
  {
    "text": "doing its thing um and so the example app we're going to run is actually just a slight modification of um actually",
    "start": "1015199",
    "end": "1021279"
  },
  {
    "text": "what the Nomad one will do out of the box if you just like do Nomad and it um so in here just to demonstrate some of",
    "start": "1021279",
    "end": "1028319"
  },
  {
    "text": "the capabilities um like in kubernetes you can apply arbitrary key value pairs",
    "start": "1028319",
    "end": "1034079"
  },
  {
    "text": "in this meta block this can be repeated so in this case I'm just applying uh effectively a label called",
    "start": "1034079",
    "end": "1042159"
  },
  {
    "text": "cosmiccomics through a lot of this but um of Interest here is the fact that we are actually running it as a cni called",
    "start": "1047400",
    "end": "1054520"
  },
  {
    "text": "celium I've preconfigured the config for that I can show it to you in a second but I mean it's basically the stock um",
    "start": "1054520",
    "end": "1060720"
  },
  {
    "text": "psum like confl that you normally use and that's really it right and the other thing too is also like uh in theory you",
    "start": "1060720",
    "end": "1069280"
  },
  {
    "text": "have if you're depending on how you're keeping track of your IPS you also give it like an address mode of its per allocation that's very um Nomad specific",
    "start": "1069280",
    "end": "1076720"
  },
  {
    "text": "so I'm just going to leave it at that I'm happy to talk about that um outside of the scope of the presentation but I'm",
    "start": "1076720",
    "end": "1082400"
  },
  {
    "text": "going to go ahead and get that started as well so do plan and we'll do example. Nomad get this kicked",
    "start": "1082400",
    "end": "1090760"
  },
  {
    "text": "off takes a little bit because it's got a um actually configure itself get the cni all kind of good usually does take a",
    "start": "1091559",
    "end": "1099240"
  },
  {
    "text": "little bit especially if you don't actually give it a health check kind of sits there and just make sure it's making progress so there we go so now",
    "start": "1099240",
    "end": "1106600"
  },
  {
    "text": "it's healthy um so to do ayum status real quick if I could actually type the",
    "start": "1106600",
    "end": "1111640"
  },
  {
    "text": "word celium which I cannot Auto my history to the rescue um",
    "start": "1111640",
    "end": "1119480"
  },
  {
    "text": "so this particular uh celium cluster right is really just one node it just happens to be the node that it's running",
    "start": "1119480",
    "end": "1125120"
  },
  {
    "text": "on um but it is connected to um a console server which is also actually running in the same node um you know",
    "start": "1125120",
    "end": "1131080"
  },
  {
    "text": "scooper 9s is very much disabled um I'm running a pretty recent version of I",
    "start": "1131080",
    "end": "1136840"
  },
  {
    "text": "was playing around with like bandwidth manager and stuff on here at one point um and then wire guard of course works",
    "start": "1136840",
    "end": "1142080"
  },
  {
    "text": "it's how we run it uh but you can see where is our we have a couple IPS used right so let's go check that out um if I",
    "start": "1142080",
    "end": "1148480"
  },
  {
    "text": "just do endpoint list like what we do normally um it's a little compressed on",
    "start": "1148480",
    "end": "1154320"
  },
  {
    "text": "this view um still readable uh but anyway so we have just you know normal health check and the um what's reserved",
    "start": "1154320",
    "end": "1162120"
  },
  {
    "text": "for the host right but this is our running container right so you can see it pulled an IP address from from the",
    "start": "1162120",
    "end": "1168440"
  },
  {
    "text": "range we preconfigured um and then all the labels are actually set up so net reap itself will set up three specific",
    "start": "1168440",
    "end": "1175120"
  },
  {
    "text": "ones out of the box right they're prefixed with um the net reap Source in this case it's the job ID um the name",
    "start": "1175120",
    "end": "1183080"
  },
  {
    "text": "space that happens to be running in and then the task group um Nomad jobs can be",
    "start": "1183080",
    "end": "1188240"
  },
  {
    "text": "comprised of task groups which can be comprised of tasks so that's all metadata that happens to be useful um",
    "start": "1188240",
    "end": "1194000"
  },
  {
    "text": "kind of in the general case but also you can apply your own so that's prefixed with the Nomad label and that's that",
    "start": "1194000",
    "end": "1200440"
  },
  {
    "text": "same label that I had in the job uh definition before ccon North America",
    "start": "1200440",
    "end": "1206200"
  },
  {
    "text": "2023 um so that that's basically it running and so uh I do have a policy",
    "start": "1206200",
    "end": "1212520"
  },
  {
    "text": "set um I'm just going to go get that so oh no scrolling that doesn't really work",
    "start": "1212520",
    "end": "1218000"
  },
  {
    "text": "well anyway the policy itself is not that important I think we all know that cyan policies work and they do what",
    "start": "1218000",
    "end": "1223400"
  },
  {
    "text": "they're supposed to um but I'm just going to apply a new one and I can show you that if I do",
    "start": "1223400",
    "end": "1228679"
  },
  {
    "text": "um if I actually update the policy that happens to be stored at this particular key uh net re. NRE policy in",
    "start": "1228679",
    "end": "1237000"
  },
  {
    "text": "console oh no it's because I moved",
    "start": "1237000",
    "end": "1241640"
  },
  {
    "text": "it there we go so that did actually update that key and if I do another get",
    "start": "1242360",
    "end": "1248480"
  },
  {
    "text": "right this is revision 9 it was revision 8 before net re because it had a watch",
    "start": "1248480",
    "end": "1253679"
  },
  {
    "text": "on that key automatically red delayed that and if we had more servers actually joined in this cluster it would have",
    "start": "1253679",
    "end": "1259720"
  },
  {
    "text": "just written that all out um to all of them at once so that's pretty neat we basically for the most part",
    "start": "1259720",
    "end": "1265919"
  },
  {
    "text": "reimplemented everything that we needed in order to get net reap to work out of the box or not net reap",
    "start": "1265919",
    "end": "1271159"
  },
  {
    "text": "cyan uh so future work we've got a couple things that we'd like to do um we don't want to be able to document um",
    "start": "1271159",
    "end": "1277679"
  },
  {
    "text": "some more specific Nomad features uh specifically ACL support um we also would like to investigate what it would",
    "start": "1277679",
    "end": "1284039"
  },
  {
    "text": "take to um generally recommend at CD on nomad replace console it is I mean",
    "start": "1284039",
    "end": "1290559"
  },
  {
    "text": "there's a Helm chart right if you squint hard enough you can convert that over into like a nomad spec um but we have",
    "start": "1290559",
    "end": "1296480"
  },
  {
    "text": "had reports from people who are are not just us who are running um net reap and um selum and production on Nomads saying",
    "start": "1296480",
    "end": "1303679"
  },
  {
    "text": "that um at a pretty high scale especially with the way that we're kind of putting watches on a single key but",
    "start": "1303679",
    "end": "1308760"
  },
  {
    "text": "even many keys um that's where console tends to somewhat break down and at CD is much more efficient um I mean",
    "start": "1308760",
    "end": "1315080"
  },
  {
    "text": "anecdotally from what I was told these are people who are running like tens of thousands of containers at once turning",
    "start": "1315080",
    "end": "1321120"
  },
  {
    "text": "like gigabits of traffic like I don't know across like tens or something of machines it's pretty significant right",
    "start": "1321120",
    "end": "1328279"
  },
  {
    "text": "so I think we'd want to be able to actually have some concrete recommendations for people running at that scale um other thing I want to do",
    "start": "1328279",
    "end": "1335360"
  },
  {
    "text": "is also be able to break up policies into multiple keys that way you can be make it behave a little bit more like",
    "start": "1335360",
    "end": "1340440"
  },
  {
    "text": "Network policies are in kubernetes you can just kind of Define the ones that you care about for a particular workload",
    "start": "1340440",
    "end": "1346159"
  },
  {
    "text": "right and let net reap kind of take care Distributing that and making sure they end up where they need to end up um",
    "start": "1346159",
    "end": "1351720"
  },
  {
    "text": "another thing that would be great would be bandwidth management support um that I believe depends on a label in",
    "start": "1351720",
    "end": "1358320"
  },
  {
    "text": "kubernetes that ends up sort of percolating throughout the rest of the system I did some investigating work on",
    "start": "1358320",
    "end": "1364360"
  },
  {
    "text": "that like several months ago um didn't get that far but it's something that we would definitely want be interested in",
    "start": "1364360",
    "end": "1369600"
  },
  {
    "text": "um being able to implement for ourselves and being able to use um and then lastly like we'd love to be able to contribute",
    "start": "1369600",
    "end": "1374880"
  },
  {
    "text": "Upstream um the reason that we went about this in the first place was just it felt like a really big lift for us to",
    "start": "1374880",
    "end": "1380880"
  },
  {
    "text": "write a different version of the operator and kind of have that actually upstreamed in in the project but that's",
    "start": "1380880",
    "end": "1387400"
  },
  {
    "text": "not to say that we wouldn't be willing to do that or find other ways to kind of make this more of like less of a cosonic",
    "start": "1387400",
    "end": "1394440"
  },
  {
    "text": "specific effort and more of a community effort um it is obviously open source so it's not like anybody can't use this and",
    "start": "1394440",
    "end": "1400840"
  },
  {
    "text": "again people are besides us but I think we'd be really interested in seeing how other people who are running Nomad would",
    "start": "1400840",
    "end": "1407520"
  },
  {
    "text": "be in running celum and getting some more uh um like interaction with the",
    "start": "1407520",
    "end": "1413840"
  },
  {
    "text": "community uh I wanted to quickly shout out too to uh Taylor who's still here I see uh for helping me to write this in",
    "start": "1413840",
    "end": "1420480"
  },
  {
    "text": "the first place um also Dan Everton I believe he's at GoDaddy rewrote like half of this to make it more efficient",
    "start": "1420480",
    "end": "1427080"
  },
  {
    "text": "and better um which was pretty cool like we were shocked that we got anybody using this besides us honestly and of",
    "start": "1427080",
    "end": "1433200"
  },
  {
    "text": "course everyone else who's contributed there are a few other people and um certainly internally and externally who",
    "start": "1433200",
    "end": "1438279"
  },
  {
    "text": "have uh helped us out so with that um a couple resources so if you want to talk",
    "start": "1438279",
    "end": "1443640"
  },
  {
    "text": "about this more um we have a Discord that we run specifically for a product but it's also where a net reap discussion happens um if you want to",
    "start": "1443640",
    "end": "1450000"
  },
  {
    "text": "learn more about wasm cloud and sort of like the underlying stuff um there's this QR code which takes you slack uh",
    "start": "1450000",
    "end": "1456039"
  },
  {
    "text": "and of course the project uh website is over on GitHub uh cosonic net so feel",
    "start": "1456039",
    "end": "1462919"
  },
  {
    "text": "free to check it out I mean we're pretty respon we're mostly pretty responsive to issues I try right it's hard when you're",
    "start": "1462919",
    "end": "1468960"
  },
  {
    "text": "a tiny startup but I'd love to hear what other people would be interested in using this for and certainly contributions are more than welcome uh",
    "start": "1468960",
    "end": "1476000"
  },
  {
    "text": "with that any [Applause]",
    "start": "1476000",
    "end": "1487939"
  },
  {
    "text": "questions now right here uh nice talk I than thanks for",
    "start": "1490640",
    "end": "1498080"
  },
  {
    "text": "presenting this this like super cool to see um you know how people can kind of pick up cium and then like recognize",
    "start": "1498080",
    "end": "1504399"
  },
  {
    "text": "what the value is and just be like oh well this little piece like doesn't work so let me just like substitute in I",
    "start": "1504399",
    "end": "1509600"
  },
  {
    "text": "think we saw that in the previous talk as well basically it's like awesome to see um uh yeah when I was listening",
    "start": "1509600",
    "end": "1515520"
  },
  {
    "text": "through I was I was the main question I had in mind was actually like from Ayan Community perspective how can we facilitate this stuff um obviously if",
    "start": "1515520",
    "end": "1522960"
  },
  {
    "text": "there's like you and other members of the community who are all interested in maintaining the stuff together um",
    "start": "1522960",
    "end": "1528039"
  },
  {
    "text": "certainly happy to like facilitate some discussions about where you know where where should that live and and are there",
    "start": "1528039",
    "end": "1533480"
  },
  {
    "text": "better ways to contribute and so on I think one big thing that has changed Upstream in celium probably over the",
    "start": "1533480",
    "end": "1539679"
  },
  {
    "text": "course of while you've been developing this stuff um is we've kicked off like a major modularity effort in terms of the",
    "start": "1539679",
    "end": "1545720"
  },
  {
    "text": "goang structure of things like theum agent and as well as the operator okay so I think some of the early maybe",
    "start": "1545720",
    "end": "1551799"
  },
  {
    "text": "struggles you might have had is like oh everything just says like you know well it doesn't even say if kubernetes it just assumes kubernetes right right um",
    "start": "1551799",
    "end": "1558760"
  },
  {
    "text": "and I think what the operator like the stream operator is doing now is is it's a lot more modular based on this like",
    "start": "1558760",
    "end": "1564760"
  },
  {
    "text": "high cell model which I've documented Doc in the documentation so um in terms of being able to enable some",
    "start": "1564760",
    "end": "1571360"
  },
  {
    "text": "functionality um and then hopefully abstract that there might be ways to share more with n but like I don't know",
    "start": "1571360",
    "end": "1577159"
  },
  {
    "text": "I I haven't looked in detail so you know if it if it's interesting we can certainly talk talk about I'd love to follow up on that um for context I think",
    "start": "1577159",
    "end": "1584200"
  },
  {
    "text": "we wrote this originally against like cium 111 or 12 so it's been a little",
    "start": "1584200",
    "end": "1589240"
  },
  {
    "text": "while and I know there's been a ton of activity going on in the project so it wouldn't surprise me if some of it has",
    "start": "1589240",
    "end": "1594720"
  },
  {
    "text": "kind of changed enough to make it a little bit easier to integrate into but yeah I'd love to talk about that and then potentially I know you tend to get",
    "start": "1594720",
    "end": "1602000"
  },
  {
    "text": "that scary message when you actually start selum with like hey by the way console's deprecated uh so yeah we were",
    "start": "1602000",
    "end": "1609159"
  },
  {
    "text": "about to rip it out when you guys came by all right well let's let's not rip it out cuz people are trying to use it I remember talking to you about that and",
    "start": "1609159",
    "end": "1615559"
  },
  {
    "text": "uh continues to be like hey you know if if the community is happy to like contribute and you know submit patches",
    "start": "1615559",
    "end": "1620760"
  },
  {
    "text": "and if you're hitting issues like you know contribute to that um if you're looking at moving to ND then it",
    "start": "1620760",
    "end": "1626480"
  },
  {
    "text": "certainly re raises that question because it's just code that I think a lot of the San Upstream Community",
    "start": "1626480",
    "end": "1631520"
  },
  {
    "text": "doesn't really exercise yeah so it's always that question of like how far can we kind of go on you know supporting",
    "start": "1631520",
    "end": "1637200"
  },
  {
    "text": "that I think it'd be interesting for us to kind of get involved and see like if it's for us like I think at some point",
    "start": "1637200",
    "end": "1643440"
  },
  {
    "text": "we'll probably have to switch if it is in fact like um or if we replicate sort of that behavior that other people have",
    "start": "1643440",
    "end": "1648919"
  },
  {
    "text": "talked about just like it just isn't performant enough to be using watches and console then yeah um that's probably",
    "start": "1648919",
    "end": "1655200"
  },
  {
    "text": "the way that we'll go and just do at CD and kind of deal with it but it would be interesting to kind of get involved and and kind of help out there and see who",
    "start": "1655200",
    "end": "1661080"
  },
  {
    "text": "else is even trying to use it because I mean I'm sure you don't need to maintain that code if it's just like a handful of",
    "start": "1661080",
    "end": "1666679"
  },
  {
    "text": "people here and there at least you don't want to I I think the unit tests are proba like we have some system tests that like that's one of the main users",
    "start": "1666679",
    "end": "1672799"
  },
  {
    "text": "that actually exercises that I'm I'm aware of okay it's certainly good to good to see uh other examples so",
    "start": "1672799",
    "end": "1680440"
  },
  {
    "text": "yeah anything else hello knock knock uh hi I don't",
    "start": "1680519",
    "end": "1688679"
  },
  {
    "text": "really have a question I have a thank you for using Nomad uh sure I'm a nomad engineer so we should talk we should",
    "start": "1688679",
    "end": "1695240"
  },
  {
    "text": "talk yes yeah um you guys are always after us to open source or firecracker driver I heard that a bunch of a",
    "start": "1695240",
    "end": "1700679"
  },
  {
    "text": "different conference yeah nice well cool we'll talk after anybody else wants to talk about n hit me up",
    "start": "1700679",
    "end": "1709440"
  },
  {
    "text": "want to here so my team and I also to create own operator but based",
    "start": "1711840",
    "end": "1718840"
  },
  {
    "text": "on",
    "start": "1718840",
    "end": "1721840"
  },
  {
    "text": "you yeah sure to repeat um it sounds like he's interested in uh implementing",
    "start": "1724600",
    "end": "1729679"
  },
  {
    "text": "an operator specifically on libert and wanted to know a little bit more about how we um approached it uh so a lot of",
    "start": "1729679",
    "end": "1736360"
  },
  {
    "text": "it was really like we we kind of we took a look at what the existing operator did and tried to figure out like what did we",
    "start": "1736360",
    "end": "1742320"
  },
  {
    "text": "actually need CU we didn't need that much right like we we threw out leader election and then we kind of",
    "start": "1742320",
    "end": "1748080"
  },
  {
    "text": "reimplemented it afterwards once we realized we actually needed it but a lot of our Focus was specifically uh making",
    "start": "1748080",
    "end": "1753960"
  },
  {
    "text": "sure that we had all the endpoint metadata and we were cleaning things up and then making sure all the policies were um distributed those are actually",
    "start": "1753960",
    "end": "1761440"
  },
  {
    "text": "two different um or actually let me step back there's a couple it's written go",
    "start": "1761440",
    "end": "1766720"
  },
  {
    "text": "right so there's like a couple different grow routines and things that are actually happening there um specific like there's a whole thing for endpoints",
    "start": "1766720",
    "end": "1773039"
  },
  {
    "text": "there's a whole thing for nodes and then of course the policies and like that's pretty much how we ended up breaking it apart and deciding like that's how we",
    "start": "1773039",
    "end": "1779480"
  },
  {
    "text": "approached actually writing it um the code itself at least from what I remember was pretty straightforward like",
    "start": "1779480",
    "end": "1785640"
  },
  {
    "text": "if you look at the Upstream operator so I imagine you'd probably be able to figure it out fairly quickly but of",
    "start": "1785640",
    "end": "1791720"
  },
  {
    "text": "course you've got a template so feel free to ask questions or ping Us in Discord or slack too happy to chat about",
    "start": "1791720",
    "end": "1797840"
  },
  {
    "text": "it yeah of course all right something I I wanted to",
    "start": "1797840",
    "end": "1805440"
  },
  {
    "text": "mention and I told Andre before is it's amazing to see celium being extended but",
    "start": "1805440",
    "end": "1811120"
  },
  {
    "text": "in addition to extending celium a large value of what you you shared today is educational because the lowlevel",
    "start": "1811120",
    "end": "1817640"
  },
  {
    "text": "implementation of celium whether in ATD or the low level API of the agent are not well known by users and I think",
    "start": "1817640",
    "end": "1824200"
  },
  {
    "text": "they're actually pretty simple once you get to know them and I think would be very valuable if people KN knew them",
    "start": "1824200",
    "end": "1829559"
  },
  {
    "text": "better and I think this example show that it's it can be done and that it's it's very valuable and and on this thank",
    "start": "1829559",
    "end": "1836200"
  },
  {
    "text": "you very much yeah",
    "start": "1836200",
    "end": "1839080"
  }
]