[
  {
    "text": "this on ah that's better okay hi morning",
    "start": "9920",
    "end": "15200"
  },
  {
    "text": "this uh i expected like six people um so thank you all for coming",
    "start": "15200",
    "end": "22720"
  },
  {
    "text": "do we uh yeah okay so um i got a lot to get through",
    "start": "22720",
    "end": "29279"
  },
  {
    "text": "uh the slides are on the the scad app uh so if if i skip over something you",
    "start": "29279",
    "end": "35120"
  },
  {
    "text": "can download and look things up um okay who uh who who programs in",
    "start": "35120",
    "end": "42840"
  },
  {
    "text": "go oh at least half okay that's pretty good there's going to be there's going to be some go code",
    "start": "42840",
    "end": "49440"
  },
  {
    "text": "who likes yaml wow okay",
    "start": "49440",
    "end": "54878"
  },
  {
    "text": "um so i uh i work at grafana labs for the first year",
    "start": "56840",
    "end": "63600"
  },
  {
    "text": "and uh that's that's not particularly relevant to the talk but they do pay me",
    "start": "63600",
    "end": "71040"
  },
  {
    "text": "more importantly you should follow me on twitter um so i am going to talk about adding a",
    "start": "71040",
    "end": "78240"
  },
  {
    "text": "command to cube cuddle uh the command is called cube cuddle events or",
    "start": "78240",
    "end": "83360"
  },
  {
    "text": "right now cube cattle alpha events um so we'll",
    "start": "83360",
    "end": "89600"
  },
  {
    "text": "start with um how did i get here i i basically have no",
    "start": "89600",
    "end": "95200"
  },
  {
    "text": "idea uh or i had no idea how to add a command to cubekiddle nor did i ever",
    "start": "95200",
    "end": "100560"
  },
  {
    "text": "think i would um but i i was working on this thing uh k-span",
    "start": "100560",
    "end": "106320"
  },
  {
    "text": "uh who who's seen that a couple of people so it's pretty cool i won't talk about it um but uh go go look",
    "start": "106320",
    "end": "113680"
  },
  {
    "text": "it up it it it gives you a graphical view of events out of your kubernetes system",
    "start": "113680",
    "end": "120560"
  },
  {
    "text": "um so let's just clarify what it what do i mean what am i talking about with events",
    "start": "120560",
    "end": "126640"
  },
  {
    "text": "can i do lasers yeah not really i need a like a more powerful laser um",
    "start": "126640",
    "end": "132879"
  },
  {
    "text": "so uh events are little little messages",
    "start": "132879",
    "end": "138640"
  },
  {
    "text": "emitted by different parts of your kubernetes system maybe from your own code or maybe from",
    "start": "138640",
    "end": "145840"
  },
  {
    "text": "part of the system like cubelet or the scheduler or really any part of the system",
    "start": "145840",
    "end": "151519"
  },
  {
    "text": "and they they go into the api server and uh",
    "start": "151519",
    "end": "158879"
  },
  {
    "text": "let's take a look this this is the sort of typical user experience of events",
    "start": "158879",
    "end": "164640"
  },
  {
    "text": "uh you run kubectl get events and you get um you've got some events",
    "start": "164640",
    "end": "171040"
  },
  {
    "text": "out you uh each one has a type which is either normal or warning",
    "start": "171040",
    "end": "177280"
  },
  {
    "text": "h1 has a short form reason um it has an object here that it relates to",
    "start": "177280",
    "end": "183440"
  },
  {
    "text": "and a sort of human readable message um",
    "start": "183440",
    "end": "189120"
  },
  {
    "text": "so okay so far okay we've seen this right okay",
    "start": "189120",
    "end": "195200"
  },
  {
    "text": "so i just want to adjust this slightly there we go um [Music]",
    "start": "195200",
    "end": "202239"
  },
  {
    "text": "so this is what an event looks like if you were to print one out in yaml uh",
    "start": "202239",
    "end": "207840"
  },
  {
    "text": "and it's kind of kind of the same stuff right we got the we got the message we got the reason",
    "start": "207840",
    "end": "213360"
  },
  {
    "text": "uh we got a few more things like where did it come from um",
    "start": "213360",
    "end": "219200"
  },
  {
    "text": "and the events are kubernetes objects uh so in the sense that they are the",
    "start": "219200",
    "end": "224959"
  },
  {
    "text": "same thing to the api server as a pod or a deployment or",
    "start": "224959",
    "end": "230720"
  },
  {
    "text": "pv or you know any any of the other uh objects within the kubernetes system so",
    "start": "230720",
    "end": "236400"
  },
  {
    "text": "they have metadata they have a name they have a namespace a kind and a version",
    "start": "236400",
    "end": "243599"
  },
  {
    "text": "so that's going to be important later",
    "start": "245040",
    "end": "250410"
  },
  {
    "text": "[Music] so i became aware when when working on",
    "start": "250410",
    "end": "257519"
  },
  {
    "text": "caseband that that there are some issues with um with events particularly with cupid'll",
    "start": "257519",
    "end": "263120"
  },
  {
    "text": "get events uh and the the most important one i think",
    "start": "263120",
    "end": "268720"
  },
  {
    "text": "for most people is that they don't come out in the right order so if i just go back to uh",
    "start": "268720",
    "end": "276320"
  },
  {
    "text": "i don't know i don't know if anyone noticed this but they they don't print out in like latest",
    "start": "276320",
    "end": "282240"
  },
  {
    "text": "first would be the obvious way to do this right and they they don't they they don't come",
    "start": "282240",
    "end": "287360"
  },
  {
    "text": "out in the right order um in fact they come out in order by name",
    "start": "287360",
    "end": "292960"
  },
  {
    "text": "which is like who even who even knows the name of an event",
    "start": "292960",
    "end": "298560"
  },
  {
    "text": "so um so there are a few more issues with events which which we'll maybe talk",
    "start": "300000",
    "end": "306240"
  },
  {
    "text": "about in a minute but i also want to note that that uh",
    "start": "306240",
    "end": "311840"
  },
  {
    "text": "that issue was opened uh in 2016. um",
    "start": "311840",
    "end": "318000"
  },
  {
    "text": "so uh so i like a challenge",
    "start": "318000",
    "end": "324080"
  },
  {
    "text": "an issue that has been open for i guess five years at the time i was working on",
    "start": "324080",
    "end": "330720"
  },
  {
    "text": "it um that's you know that should be easy right just uh",
    "start": "330720",
    "end": "336560"
  },
  {
    "text": "knock that off fix it um",
    "start": "336560",
    "end": "341759"
  },
  {
    "text": "yeah there were there were some comments on the uh on the issues as well",
    "start": "342560",
    "end": "349120"
  },
  {
    "text": "that uh lots of other people thought it could be fixed in a in an afternoon probably",
    "start": "349120",
    "end": "355759"
  },
  {
    "text": "um so uh never mind uh yeah well so",
    "start": "355759",
    "end": "362720"
  },
  {
    "text": "why is this why is this a hard problem why is it not just",
    "start": "362720",
    "end": "368000"
  },
  {
    "text": "a question of sorting the events and the answer is",
    "start": "368000",
    "end": "373680"
  },
  {
    "text": "there are two kinds of event who knew that",
    "start": "373680",
    "end": "379759"
  },
  {
    "text": "yeah like nobody i mean you just came to heckle right",
    "start": "379759",
    "end": "386160"
  },
  {
    "text": "uh three if you count the beta for the the second one",
    "start": "387440",
    "end": "392479"
  },
  {
    "text": "um so the uh",
    "start": "392479",
    "end": "398080"
  },
  {
    "text": "they have a kind like like i mentioned an api version so the api version of of",
    "start": "398400",
    "end": "403919"
  },
  {
    "text": "the the first one is is v1 uh and it lives in the core",
    "start": "403919",
    "end": "409599"
  },
  {
    "text": "library um and i've i've linked all the code if you download the pdf uh these are all",
    "start": "409599",
    "end": "415599"
  },
  {
    "text": "clickable links um if you if you wanna kind of look in the details um",
    "start": "415599",
    "end": "422080"
  },
  {
    "text": "and then uh this new one was created and we didn't want such a boring name as v1 so",
    "start": "422080",
    "end": "427440"
  },
  {
    "text": "we called it events.kates.io v1 uh",
    "start": "427440",
    "end": "433599"
  },
  {
    "text": "i guess um and uh so this was done so long ago",
    "start": "433599",
    "end": "440720"
  },
  {
    "text": "um that the the cap for it is is kind of mostly about the cleanup like uh yeah we we're sort of halfway through this we",
    "start": "440720",
    "end": "447039"
  },
  {
    "text": "better finish um so it's a little bit a little bit",
    "start": "447039",
    "end": "453039"
  },
  {
    "text": "kind of half half like 90 done 90 to go",
    "start": "453039",
    "end": "458319"
  },
  {
    "text": "um there almost everything if emits v1.event",
    "start": "458319",
    "end": "465599"
  },
  {
    "text": "uh the scheduler is one component that definitely event emits the other one",
    "start": "465599",
    "end": "471440"
  },
  {
    "text": "um but it will it will not do that in its there's a race condition on startup uh so",
    "start": "471440",
    "end": "477440"
  },
  {
    "text": "i was kind of trying to do a demo for this and if you use kind uh it doesn't",
    "start": "477440",
    "end": "483280"
  },
  {
    "text": "exhibit the problem unless you restart the scheduler so um so i'm not going to demo that",
    "start": "483280",
    "end": "490080"
  },
  {
    "text": "yeah you can read the code take my word for it um let's just dive into the the code a",
    "start": "490080",
    "end": "496560"
  },
  {
    "text": "little bit this this is the code where the events are created",
    "start": "496560",
    "end": "501919"
  },
  {
    "text": "um which i thought made it easier to to see what's going on so",
    "start": "501919",
    "end": "509360"
  },
  {
    "text": "so the first kind has involved object it has a first time stamp and a last time stamp so if events",
    "start": "509360",
    "end": "517200"
  },
  {
    "text": "are coalesced if if you have the same bit of software emitting the same event over and over again",
    "start": "517200",
    "end": "522959"
  },
  {
    "text": "um they they can get coalesced so so the server only stores one of them",
    "start": "522959",
    "end": "528240"
  },
  {
    "text": "so we have a we have a first time stamp a last time stamp and an account um",
    "start": "528240",
    "end": "534480"
  },
  {
    "text": "and then quick change uh so in the new one",
    "start": "534480",
    "end": "540240"
  },
  {
    "text": "we have an event time and if there's more than one we have a we have a series data structure which",
    "start": "540240",
    "end": "546640"
  },
  {
    "text": "which is expresses this concept that it happened several times in a series",
    "start": "546640",
    "end": "551680"
  },
  {
    "text": "um they renamed the involved object to regarding",
    "start": "551680",
    "end": "558800"
  },
  {
    "text": "uh other things like the reason is still called reason the message is now called note",
    "start": "558800",
    "end": "565920"
  },
  {
    "text": "so like it's a rename-a-thon [Music]",
    "start": "566080",
    "end": "572000"
  },
  {
    "text": "now kubernetes is very big on backwards compatibility",
    "start": "572000",
    "end": "578240"
  },
  {
    "text": "um so the good news if you like is is that there is magic inside the api server",
    "start": "578240",
    "end": "583920"
  },
  {
    "text": "that converts one each of these to the other one and either way you can ask for either of these and you'll get them",
    "start": "583920",
    "end": "590640"
  },
  {
    "text": "and even better all of the fields from the new one are also in the old one they",
    "start": "590640",
    "end": "595839"
  },
  {
    "text": "were added so so like all of the fields all of the choices are there you can ask for event time",
    "start": "595839",
    "end": "601839"
  },
  {
    "text": "on on the old kind of event it it is null but you it's there you can ask for it",
    "start": "601839",
    "end": "609600"
  },
  {
    "text": "um and in fact that is that is why they don't sort in the right order",
    "start": "609600",
    "end": "614720"
  },
  {
    "text": "uh because because anything emitting the new kind of event has has a null in in the um",
    "start": "614720",
    "end": "622000"
  },
  {
    "text": "last timestamp uh and this used to crash cubekittle um so that was even more fun",
    "start": "622000",
    "end": "629120"
  },
  {
    "text": "but uh i think they fixed the crashing about a couple of years ago",
    "start": "629120",
    "end": "635120"
  },
  {
    "text": "so the ones with null just sort at the top",
    "start": "635120",
    "end": "638959"
  },
  {
    "text": "okay so how do we fix this um so kubernetes is is obviously very very",
    "start": "640959",
    "end": "648000"
  },
  {
    "text": "big uh project and um you can't just you can't just go",
    "start": "648000",
    "end": "653279"
  },
  {
    "text": "around changing stuff you can fix stuff you can fix bugs without you know asking someone's permission",
    "start": "653279",
    "end": "660560"
  },
  {
    "text": "but fundamentally changing the behavior of something needs the kubernetes enhancement process",
    "start": "660560",
    "end": "667120"
  },
  {
    "text": "it kind of sounds grand but basically someone has to propose something and write a document",
    "start": "668480",
    "end": "673760"
  },
  {
    "text": "and then it gets accepted by a sig the the special interest groups that that's who really governs kubernetes",
    "start": "673760",
    "end": "680640"
  },
  {
    "text": "um so in the case of cube cuttle it's six cli uh you know the other ones are like sig",
    "start": "680640",
    "end": "686560"
  },
  {
    "text": "network sig api machinery also all different sigs you can you can look them up",
    "start": "686560",
    "end": "692880"
  },
  {
    "text": "and yeah so so the happy path it gets implemented",
    "start": "693680",
    "end": "699519"
  },
  {
    "text": "uh it can also get deferred or rejected or whatever but we we won't talk about that",
    "start": "699519",
    "end": "705040"
  },
  {
    "text": "um so i found that there was already a cap approved",
    "start": "705040",
    "end": "712560"
  },
  {
    "text": "to fix cube cattle get events and",
    "start": "712720",
    "end": "719040"
  },
  {
    "text": "so this was extremely lucky because i i don't think i would have had the patience to get a get a new cap approved",
    "start": "719040",
    "end": "726560"
  },
  {
    "text": "so it was started the cap came into existence october 2019",
    "start": "726560",
    "end": "733279"
  },
  {
    "text": "um was marked as implementable that's the kind of approved phase uh three months later",
    "start": "733279",
    "end": "740720"
  },
  {
    "text": "uh and then time passes i opened my pr february 2021",
    "start": "740720",
    "end": "747839"
  },
  {
    "text": "uh it took six months to get the pr merged um and then a couple more months to get",
    "start": "747839",
    "end": "754560"
  },
  {
    "text": "released once it's alpha right now it was released in 1.23 so you can use this now um",
    "start": "754560",
    "end": "762000"
  },
  {
    "text": "uh i didn't bring enough swag for everyone but you you can have a command",
    "start": "762000",
    "end": "768160"
  },
  {
    "text": "um okay so let's talk about the command um",
    "start": "768160",
    "end": "775120"
  },
  {
    "text": "uh so the the the the really cool thing is the uh",
    "start": "775200",
    "end": "780480"
  },
  {
    "text": "timestamps come out in the right order um that's it really",
    "start": "780480",
    "end": "788639"
  },
  {
    "text": "[Applause]",
    "start": "789670",
    "end": "798839"
  },
  {
    "text": "um okay let's let's go into a bit of detail uh okay yeah so so you you have some",
    "start": "798839",
    "end": "804800"
  },
  {
    "text": "options so if you if you just run cubekiddle alpha events it will it'll print them all for um the current the",
    "start": "804800",
    "end": "811680"
  },
  {
    "text": "default namespace so you can ask for all namespaces or a particular namespace",
    "start": "811680",
    "end": "817279"
  },
  {
    "text": "like namespace um i just sorry just i see some people",
    "start": "817279",
    "end": "823600"
  },
  {
    "text": "standing at the door there are some seats right at the front i won't i won't like uh",
    "start": "823600",
    "end": "829120"
  },
  {
    "text": "insult you or anything if you want to sit near the front um",
    "start": "829120",
    "end": "834240"
  },
  {
    "text": "and and then you can do you can do events for one object and you can watch for new",
    "start": "834240",
    "end": "840839"
  },
  {
    "text": "events um so the other thing that people complain a lot about cube cuddle get events is",
    "start": "840839",
    "end": "846639"
  },
  {
    "text": "that if you if you watch if you sort of get them to come out as they happen um they all they all come out as they",
    "start": "846639",
    "end": "853360"
  },
  {
    "text": "happen and then they all print out again one hour one hour later all the same events one hour later",
    "start": "853360",
    "end": "860079"
  },
  {
    "text": "who knows why that is yeah nobody right uh it's because they get deleted events events only live for",
    "start": "860079",
    "end": "867120"
  },
  {
    "text": "one hour and uh cube cuttle get minus watch um",
    "start": "867120",
    "end": "872880"
  },
  {
    "text": "uh prints out things being created and things being deleted",
    "start": "872880",
    "end": "878399"
  },
  {
    "text": "why not um anyway so so my one uh skips the deleted event",
    "start": "878399",
    "end": "884480"
  },
  {
    "text": "so the extra value double double value okay okay so yes right now this this is the",
    "start": "884480",
    "end": "890880"
  },
  {
    "text": "this is the talk we'll start",
    "start": "890880",
    "end": "894399"
  },
  {
    "text": "okay so suppose you want to add a command to cubekittle uh what are you going to do you are",
    "start": "896079",
    "end": "901600"
  },
  {
    "text": "going to um create a command object so so cubecattle",
    "start": "901600",
    "end": "906800"
  },
  {
    "text": "uses the cobra package for cli",
    "start": "906800",
    "end": "912800"
  },
  {
    "text": "applications and um so this is the the kind of uh what i",
    "start": "912800",
    "end": "918959"
  },
  {
    "text": "call step zero like you you're not going to go anywhere unless you create this command object um",
    "start": "918959",
    "end": "925440"
  },
  {
    "text": "so what i did uh is i i looked at the um",
    "start": "925440",
    "end": "931839"
  },
  {
    "text": "existing commands like you like cube color get for instance or keep cuddle describe or whatever you i guess that's",
    "start": "931839",
    "end": "938079"
  },
  {
    "text": "that's kind of the uh booster to get going is to find a command that does",
    "start": "938079",
    "end": "944399"
  },
  {
    "text": "something a little bit similar to what you want to do and copy paste that",
    "start": "944399",
    "end": "949519"
  },
  {
    "text": "um so you're going to need your command object",
    "start": "949519",
    "end": "955040"
  },
  {
    "text": "so the next thing every command there's a kind of a pattern where the the work is split into two phases",
    "start": "955040",
    "end": "962399"
  },
  {
    "text": "so there's a phase of collecting command line arguments",
    "start": "962399",
    "end": "968480"
  },
  {
    "text": "uh and they get put in a struct basically vanilla um and then the next phase we kind of",
    "start": "968480",
    "end": "974480"
  },
  {
    "text": "decode the command line arguments and we figure out what to do with them and the reason it's split into those two",
    "start": "974480",
    "end": "980320"
  },
  {
    "text": "parts is is for testing um so that we can kind of independently test the act of of",
    "start": "980320",
    "end": "987920"
  },
  {
    "text": "receiving cli parameters separate from the act of actually doing",
    "start": "987920",
    "end": "992959"
  },
  {
    "text": "some work on them and and make that easier to test so um",
    "start": "992959",
    "end": "999199"
  },
  {
    "text": "so i kind of highlighted uh so if you have a parameter like namespace",
    "start": "999199",
    "end": "1004880"
  },
  {
    "text": "um well that actually goes into uh this guy gets kind of pre-populated",
    "start": "1004880",
    "end": "1010399"
  },
  {
    "text": "um so that when you talk this the rest rest is like the api",
    "start": "1010399",
    "end": "1015759"
  },
  {
    "text": "client to the api server and and that will be populated by the machinery of",
    "start": "1015759",
    "end": "1020959"
  },
  {
    "text": "cube cuddle uh to give you a client that is talking to the",
    "start": "1020959",
    "end": "1026319"
  },
  {
    "text": "right namespace um and then so this one is one that i",
    "start": "1026319",
    "end": "1031839"
  },
  {
    "text": "added on my command um and it's a string you know that so this",
    "start": "1031839",
    "end": "1037038"
  },
  {
    "text": "that's what i mean that the the first phase is just very very plain we're just fetching the arguments and getting them",
    "start": "1037039",
    "end": "1043520"
  },
  {
    "text": "into a struct",
    "start": "1043520",
    "end": "1046160"
  },
  {
    "text": "so in the in the next phase um",
    "start": "1049679",
    "end": "1055760"
  },
  {
    "text": "uh so same kind of thing well it turns out i need to know the namespace um so i pulled that out from the the rest client",
    "start": "1055919",
    "end": "1062640"
  },
  {
    "text": "getter and then the um so this thing here which object we're trying to fetch events for",
    "start": "1062640",
    "end": "1069919"
  },
  {
    "text": "gets uh decoded into something more complicated um",
    "start": "1069919",
    "end": "1075200"
  },
  {
    "text": "and we'll talk about that in a minute um",
    "start": "1075200",
    "end": "1081280"
  },
  {
    "text": "so and these two things are the pattern is that the first one is called flags and the second one is called options",
    "start": "1081280",
    "end": "1087440"
  },
  {
    "text": "so there's a pattern within cubicle um",
    "start": "1087440",
    "end": "1092799"
  },
  {
    "text": "that all the existing commands follow um",
    "start": "1092799",
    "end": "1099039"
  },
  {
    "text": "so probably the next thing we're going to do is is make a api server request",
    "start": "1099039",
    "end": "1105600"
  },
  {
    "text": "and there is a really cool builder uh",
    "start": "1105600",
    "end": "1111840"
  },
  {
    "text": "library to um to do all kinds of things with uh",
    "start": "1111840",
    "end": "1119200"
  },
  {
    "text": "api server requests so this one is from cube cuddle describe",
    "start": "1119200",
    "end": "1125520"
  },
  {
    "text": "because this is not actually how cubicle events works but i thought you know this is this is the kind of the",
    "start": "1125520",
    "end": "1130960"
  },
  {
    "text": "powerful library that will work for many many cases so it's um",
    "start": "1130960",
    "end": "1137360"
  },
  {
    "text": "it's this kind of pattern where each piece kind of leads on from the next it's called like a fluent api that",
    "start": "1137360",
    "end": "1144480"
  },
  {
    "text": "that's the word that some people use for this kind of thing um so we have a builder and we're going to",
    "start": "1144480",
    "end": "1150720"
  },
  {
    "text": "fetch unstructured data so not go objects just just name value stuff",
    "start": "1150720",
    "end": "1156240"
  },
  {
    "text": "uh and we're in a namespace um maybe all namespaces we're we're selecting on some",
    "start": "1156240",
    "end": "1162160"
  },
  {
    "text": "labels we're going to flatten them so if we get a list of things we don't want the list",
    "start": "1162160",
    "end": "1168320"
  },
  {
    "text": "we want all the objects so this is very very comprehensive",
    "start": "1168320",
    "end": "1174000"
  },
  {
    "text": "very powerful and it also covers things like like chunking so when you",
    "start": "1174000",
    "end": "1180640"
  },
  {
    "text": "uh when you talk to the api server and say give me all the events there might be a million of them",
    "start": "1180640",
    "end": "1186720"
  },
  {
    "text": "um and we we do not want to serialize a million events into one buffer and send",
    "start": "1186720",
    "end": "1192240"
  },
  {
    "text": "that over the network so in fact we fetch them like 500 at a time chunking",
    "start": "1192240",
    "end": "1198000"
  },
  {
    "text": "or paging and all of that is um is covered by the",
    "start": "1198000",
    "end": "1203600"
  },
  {
    "text": "machinery inside cubicle so that's i guess it's one of the most important things i wanted to to mention here that",
    "start": "1203600",
    "end": "1210320"
  },
  {
    "text": "there are these libraries and when i was working on this um",
    "start": "1210320",
    "end": "1216799"
  },
  {
    "text": "i i didn't know anything about them and it's also that i didn't find any kind of tutorials uh i did find the existing",
    "start": "1216799",
    "end": "1223200"
  },
  {
    "text": "code but i had to kind of work backwards and figure out what it did um",
    "start": "1223200",
    "end": "1229280"
  },
  {
    "text": "so this stuff uh really powerful really really useful now why",
    "start": "1229280",
    "end": "1236320"
  },
  {
    "text": "why could i not use it so",
    "start": "1236320",
    "end": "1242480"
  },
  {
    "text": "if you remember the event um and we're going to look we're",
    "start": "1242480",
    "end": "1249360"
  },
  {
    "text": "going to uh look for all events relating to one object",
    "start": "1249360",
    "end": "1256159"
  },
  {
    "text": "so we're going to build a query that is a little bit different to the ones that the builder knows how to do",
    "start": "1256159",
    "end": "1263120"
  },
  {
    "text": "and even worse uh i don't know who who spots the",
    "start": "1263120",
    "end": "1269760"
  },
  {
    "text": "difficulty here it's very very subtle so",
    "start": "1269760",
    "end": "1275440"
  },
  {
    "text": "um yeah",
    "start": "1275440",
    "end": "1280640"
  },
  {
    "text": "so in my um in my example here pod has a small letter",
    "start": "1280640",
    "end": "1286960"
  },
  {
    "text": "because that's how we write pod when we're just typing really fast",
    "start": "1286960",
    "end": "1292320"
  },
  {
    "text": "and the thing in the database has a capital letter",
    "start": "1293679",
    "end": "1299679"
  },
  {
    "text": "okay how are we going to get past this so so now we need to get into the",
    "start": "1302840",
    "end": "1309520"
  },
  {
    "text": "concept of api resources and kind versus resource",
    "start": "1309520",
    "end": "1315039"
  },
  {
    "text": "uh so let's let's try and do that at a high level um so you can get a kind of a hint",
    "start": "1315039",
    "end": "1322000"
  },
  {
    "text": "of this if you run the command cup api resources",
    "start": "1322000",
    "end": "1328400"
  },
  {
    "text": "so this queries the api server brings down a ton of metadata and and prints",
    "start": "1328400",
    "end": "1334080"
  },
  {
    "text": "out this table um let me move my mouse",
    "start": "1334080",
    "end": "1339520"
  },
  {
    "text": "it's not getting in everyone's way um yeah so like so here here's where we say",
    "start": "1339919",
    "end": "1346720"
  },
  {
    "text": "pod uh and in fact it it um it accepts the singular even though the thing that's in",
    "start": "1346720",
    "end": "1352720"
  },
  {
    "text": "its table is the is the plural there's an abbreviation so you can save one more character if you like you can",
    "start": "1352720",
    "end": "1358720"
  },
  {
    "text": "type pull which is a bit more useful for something like config map you can type cm",
    "start": "1358720",
    "end": "1365520"
  },
  {
    "text": "um it knows the version it knows whether it's namespaced and this",
    "start": "1365520",
    "end": "1371280"
  },
  {
    "text": "is the thing that we need to query for in the in the database so this is the kind",
    "start": "1371280",
    "end": "1378559"
  },
  {
    "text": "uh which is the the sort of official thing that it's filed under",
    "start": "1378559",
    "end": "1385760"
  },
  {
    "text": "and this is the name this is what we get to type",
    "start": "1385760",
    "end": "1390480"
  },
  {
    "text": "i don't know i don't make the rules you know this it works right just you know trust me",
    "start": "1391039",
    "end": "1397760"
  },
  {
    "text": "but you do have to go through this um you do have to go through this this uh hoop",
    "start": "1397760",
    "end": "1404000"
  },
  {
    "text": "um so we need to go from a group version resource",
    "start": "1404000",
    "end": "1412320"
  },
  {
    "text": "uh which is the thing with the lowercase to a group version kind um so group is like",
    "start": "1412320",
    "end": "1419679"
  },
  {
    "text": "api or apps or something like that version is like v1 v1 beta1",
    "start": "1419679",
    "end": "1426240"
  },
  {
    "text": "and resource is the one with the lowercase and and kind is the one with the upper case",
    "start": "1426240",
    "end": "1433039"
  },
  {
    "text": "anyway so there is a um [Music] uh",
    "start": "1433039",
    "end": "1438240"
  },
  {
    "text": "yeah so we we indirect through the metadata which is in um",
    "start": "1438240",
    "end": "1444720"
  },
  {
    "text": "the api server and we we end up with the uh the kind",
    "start": "1444720",
    "end": "1450240"
  },
  {
    "text": "um so we have the kind and the name which is like pod slash name uh and then there's this other cool",
    "start": "1450240",
    "end": "1456840"
  },
  {
    "text": "um uh part of the machinery where we we get to just say i'm going to and these",
    "start": "1456840",
    "end": "1463120"
  },
  {
    "text": "two things together um so this equals this and this equals this so i can build up my query",
    "start": "1463120",
    "end": "1470000"
  },
  {
    "text": "on the fields of the event object um",
    "start": "1470000",
    "end": "1475279"
  },
  {
    "text": "and that's what i'm going to send to the events api server",
    "start": "1475279",
    "end": "1481440"
  },
  {
    "text": "uh yeah so so in order to get the kind um",
    "start": "1481440",
    "end": "1487520"
  },
  {
    "text": "so this is this is the way i ask the api server for all the metadata i ask for a",
    "start": "1487520",
    "end": "1493760"
  },
  {
    "text": "thing called a rest mapper",
    "start": "1493760",
    "end": "1497640"
  },
  {
    "text": "um i fill in what i've got so this is a struct that can take a",
    "start": "1501679",
    "end": "1507200"
  },
  {
    "text": "group aversion and a resource but i i only need to fill in the bit i've got which is like the word pod in lower case",
    "start": "1507200",
    "end": "1515679"
  },
  {
    "text": "so i fill in the bit i've got and i ask it to map it so this can be pod or pull",
    "start": "1515679",
    "end": "1521760"
  },
  {
    "text": "or you know configmap or cm or whatever you've got you fill that in here",
    "start": "1521760",
    "end": "1527200"
  },
  {
    "text": "you ask it to map it and then you extract the kind from that",
    "start": "1527200",
    "end": "1534159"
  },
  {
    "text": "so that's how we go from what i type in to uh what i need to query on",
    "start": "1534159",
    "end": "1541039"
  },
  {
    "text": "so this is this is really powerful if if you're doing this stuff um and it just won't work if you don't do",
    "start": "1541039",
    "end": "1546640"
  },
  {
    "text": "this so it's important um i skipped error handling",
    "start": "1546640",
    "end": "1555520"
  },
  {
    "text": "because that's what you do in a talk",
    "start": "1555520",
    "end": "1559120"
  },
  {
    "text": "uh okay and um so last thing we need to do is we",
    "start": "1560880",
    "end": "1567600"
  },
  {
    "text": "need to execute my query um so i mentioned before the idea of of",
    "start": "1567600",
    "end": "1574320"
  },
  {
    "text": "chunking or paging the um things that come back so that that's what this guy does follow continue we'll we'll get 500",
    "start": "1574320",
    "end": "1581279"
  },
  {
    "text": "and then another 500 then another 500",
    "start": "1581279",
    "end": "1585840"
  },
  {
    "text": "and it takes a callback or a",
    "start": "1586320",
    "end": "1591919"
  },
  {
    "text": "continuation or whatever you want to call it and we can extract my objects from here",
    "start": "1591919",
    "end": "1596960"
  },
  {
    "text": "and and deal with them so um so this is kind of the guts or in in",
    "start": "1596960",
    "end": "1603360"
  },
  {
    "text": "cube cuddle events uh uh well it turns out what the main thing we're trying to do is sort them so i",
    "start": "1603360",
    "end": "1608880"
  },
  {
    "text": "actually just add them to a slice in and go i i add them to the end of a big",
    "start": "1608880",
    "end": "1613919"
  },
  {
    "text": "a big array of events and then sort them but um so that's uh",
    "start": "1613919",
    "end": "1620400"
  },
  {
    "text": "that's what you have to do uh you have to build your uh cobra",
    "start": "1620400",
    "end": "1625520"
  },
  {
    "text": "object get the flags from the command line you have to",
    "start": "1625520",
    "end": "1631679"
  },
  {
    "text": "decode them into options and then you have to do your thing",
    "start": "1631679",
    "end": "1638360"
  },
  {
    "text": "okay so uh let's see",
    "start": "1641760",
    "end": "1647120"
  },
  {
    "text": "let's see how we did um so these are the",
    "start": "1647120",
    "end": "1652840"
  },
  {
    "text": "main issues that were",
    "start": "1652840",
    "end": "1657278"
  },
  {
    "text": "listed in the in the cap this is the reason why we need to change it",
    "start": "1658399",
    "end": "1663360"
  },
  {
    "text": "so number one they don't come out in the right order yes",
    "start": "1666159",
    "end": "1671039"
  },
  {
    "text": "um number two they print out one time and then again an hour later",
    "start": "1671360",
    "end": "1679279"
  },
  {
    "text": "fix that um number three uh oh so so cube cattle",
    "start": "1679279",
    "end": "1684960"
  },
  {
    "text": "describe will also print events um but it it prints them out for exactly",
    "start": "1684960",
    "end": "1691120"
  },
  {
    "text": "one object uh so if you wanna if you wanna kind of watch all the events on one deployment or one pod or or something like that um",
    "start": "1691120",
    "end": "1698640"
  },
  {
    "text": "and that changes at all then the events stop well you just can't watch on describe i think anyway",
    "start": "1698640",
    "end": "1704159"
  },
  {
    "text": "uh so my one is less specific so so i'm gonna call that one done",
    "start": "1704159",
    "end": "1709279"
  },
  {
    "text": "um [Music] combining columns well this this was about uh the some of them have last",
    "start": "1709279",
    "end": "1715760"
  },
  {
    "text": "timestamp and some of them have um event time uh so i just do that in gold code",
    "start": "1715760",
    "end": "1722399"
  },
  {
    "text": "uh so we'll call that done um and",
    "start": "1722399",
    "end": "1728080"
  },
  {
    "text": "uh so there's there's one more um which which i'm going to say is not done",
    "start": "1728080",
    "end": "1733440"
  },
  {
    "text": "uh a timeline of events so so if you read the narrative on this issue it's it's",
    "start": "1733440",
    "end": "1739919"
  },
  {
    "text": "kind of saying if i ask for events it it should kind of print out the interesting ones",
    "start": "1739919",
    "end": "1746080"
  },
  {
    "text": "um you know it should tell me cool stuff that happened on my cluster",
    "start": "1746080",
    "end": "1751279"
  },
  {
    "text": "recently and so i haven't implemented that i'm not even sure how to implement it",
    "start": "1751279",
    "end": "1758480"
  },
  {
    "text": "um okay yeah what's next what um",
    "start": "1758480",
    "end": "1765360"
  },
  {
    "text": "what might we do uh for this command it is in alpha so um",
    "start": "1765360",
    "end": "1772000"
  },
  {
    "text": "definitely looking for feedback and looking for um",
    "start": "1772000",
    "end": "1778320"
  },
  {
    "text": "thoughts uh you know bugs in it or um ways to improve it or or whatever so one",
    "start": "1778399",
    "end": "1784399"
  },
  {
    "text": "one idea would would be to add a thing to limit how far back like you know maybe you just want to see events",
    "start": "1784399",
    "end": "1790480"
  },
  {
    "text": "in the last five minutes or or something like that so that would be that that's i think kind of related to",
    "start": "1790480",
    "end": "1797279"
  },
  {
    "text": "the one about the time i want to see a timeline of interesting events so just like the last five minutes or the last",
    "start": "1797279",
    "end": "1802480"
  },
  {
    "text": "one minute or something like that might be might be more useful um",
    "start": "1802480",
    "end": "1809840"
  },
  {
    "text": "this one related objects is is one that i uh",
    "start": "1810480",
    "end": "1816720"
  },
  {
    "text": "that i like um so what i mean by this is um if some if",
    "start": "1816720",
    "end": "1821760"
  },
  {
    "text": "i've got like a deployment and something is going wrong with it uh it could be going wrong in the deployment it could be going wrong on",
    "start": "1821760",
    "end": "1828320"
  },
  {
    "text": "the replica set which the deployment creates it could be going wrong on a pod and they're all kind of related um but",
    "start": "1828320",
    "end": "1836559"
  },
  {
    "text": "you have to be a sort of kubernetes super being to know where to look for this information so um",
    "start": "1836559",
    "end": "1844320"
  },
  {
    "text": "so maybe the maybe the thing could just know that itself and and do that um",
    "start": "1844320",
    "end": "1851840"
  },
  {
    "text": "yeah and lastly you know what what do you want what uh i i put it out there",
    "start": "1851840",
    "end": "1858000"
  },
  {
    "text": "for the world um please uh file issues or i don't know",
    "start": "1858000",
    "end": "1864399"
  },
  {
    "text": "send me tweets send tweet anyway that's the end of my talk",
    "start": "1864399",
    "end": "1869600"
  },
  {
    "text": "i'll take questions in a minute",
    "start": "1869600",
    "end": "1873960"
  },
  {
    "text": "thank you brian um before everyone rush for lunch uh we have q a and for those",
    "start": "1880480",
    "end": "1885919"
  },
  {
    "text": "of you who are going about to leave please be quiet for the rest of the session anyone questions",
    "start": "1885919",
    "end": "1893600"
  },
  {
    "text": "all right",
    "start": "1893600",
    "end": "1896000"
  },
  {
    "text": "thank you very much thank you very much for the talk was awesome uh quick one will the the new events",
    "start": "1898720",
    "end": "1907200"
  },
  {
    "text": "replace the old one at some time is that the idea i think yeah well so there there's a cap uh for",
    "start": "1907200",
    "end": "1914720"
  },
  {
    "text": "new events to replace old ones the the new events are more flexible um",
    "start": "1914720",
    "end": "1920480"
  },
  {
    "text": "so yes that's that's uh yeah maybe i should have researched that um i guess",
    "start": "1920480",
    "end": "1925760"
  },
  {
    "text": "that's one for sig api machinery or or something like that i mean certainly certainly that's",
    "start": "1925760",
    "end": "1932000"
  },
  {
    "text": "the stated intention is that the case dot io",
    "start": "1932000",
    "end": "1937519"
  },
  {
    "text": "events should replace v1.event but in a backwards compatible way right",
    "start": "1937519",
    "end": "1943519"
  },
  {
    "text": "so so you can always query for the for the previous one",
    "start": "1943519",
    "end": "1949360"
  },
  {
    "text": "the same question but on get events so you introduce something",
    "start": "1949360",
    "end": "1954880"
  },
  {
    "text": "new in alpha we don't want again",
    "start": "1954880",
    "end": "1960240"
  },
  {
    "text": "two options right so when is the point in time that the get events is going to deprecated and we",
    "start": "1960240",
    "end": "1966559"
  },
  {
    "text": "will have only coop city events yeah now that's that's a really good question so um",
    "start": "1966559",
    "end": "1972720"
  },
  {
    "text": "so one of the reasons why i couldn't just hack on get events is is it is",
    "start": "1972720",
    "end": "1977919"
  },
  {
    "text": "implemented in a very very generic way um so when you say cube cto get",
    "start": "1977919",
    "end": "1985279"
  },
  {
    "text": "uh i'm kind of switching between cube ctl cube kettle cube cuddle",
    "start": "1985279",
    "end": "1991120"
  },
  {
    "text": "i don't know anyway if when you do get um almost everything happens in the api",
    "start": "1991120",
    "end": "1997039"
  },
  {
    "text": "server uh cube kettle does not know about the thing you're about to to print",
    "start": "1997039",
    "end": "2003679"
  },
  {
    "text": "out uh and and that's really really flexible that means you can use it on things like crds",
    "start": "2003679",
    "end": "2009440"
  },
  {
    "text": "that that were not known about when when cube kettle was written um",
    "start": "2009440",
    "end": "2014640"
  },
  {
    "text": "but it makes it incredibly hard to do something like like",
    "start": "2014640",
    "end": "2020000"
  },
  {
    "text": "pick two one of two different time stamps depending on which type of object it is",
    "start": "2020000",
    "end": "2026080"
  },
  {
    "text": "so my opinion is that the cube kettle get events will always",
    "start": "2026399",
    "end": "2032399"
  },
  {
    "text": "do the dumb thing it does today uh the the cupid'll get events will will",
    "start": "2032399",
    "end": "2039120"
  },
  {
    "text": "never be deprecated will never be enhanced um unfortunately because of a technical",
    "start": "2039120",
    "end": "2046159"
  },
  {
    "text": "detail of the fact that it's implemented in the api server and and it's just it's",
    "start": "2046159",
    "end": "2051280"
  },
  {
    "text": "just a kind of raw it's a breaking of the layers to put that intelligence at that layer",
    "start": "2051280",
    "end": "2058118"
  },
  {
    "text": "hello hello does this command in his current state support wildcards or regex",
    "start": "2061679",
    "end": "2067760"
  },
  {
    "text": "matching uh no um [Music]",
    "start": "2067760",
    "end": "2072960"
  },
  {
    "text": "uh let me think about that uh so some of these things work on a prefix and i",
    "start": "2072960",
    "end": "2078079"
  },
  {
    "text": "actually don't remember whether that works for cube cattle get events but um",
    "start": "2078079",
    "end": "2084240"
  },
  {
    "text": "uh i i mean i showed you the code it says equal so right now it doesn't have a regex",
    "start": "2084240",
    "end": "2089440"
  },
  {
    "text": "matching but file file an enhancement request on github slash kubernetes cubekittle",
    "start": "2089440",
    "end": "2098359"
  },
  {
    "text": "thank you for the talk so you just mentioned that you did not find any tutorial or something to fix",
    "start": "2102320",
    "end": "2108480"
  },
  {
    "text": "that you have to dig the code so what is your advice for our newbies if you want to implement or fix anything",
    "start": "2108480",
    "end": "2115599"
  },
  {
    "text": "oh um well to some extent that's why i did this talk uh i i hope i gave you some pointers and",
    "start": "2115599",
    "end": "2122640"
  },
  {
    "text": "and uh definitely go uh to the the notes for the talk there's a lot of links",
    "start": "2122640",
    "end": "2128240"
  },
  {
    "text": "there um uh so if if you're a total newcomer i would",
    "start": "2128240",
    "end": "2134480"
  },
  {
    "text": "advise a couple of things um uh tests are a great place to start you",
    "start": "2134480",
    "end": "2140880"
  },
  {
    "text": "know you can you can look at some tests and look at the coverage and and expand it a little bit",
    "start": "2140880",
    "end": "2146720"
  },
  {
    "text": "and and people are going to love you for it unit tests particularly um",
    "start": "2146720",
    "end": "2152240"
  },
  {
    "text": "if you're wanting a more of a challenge look at the flaky tests",
    "start": "2152240",
    "end": "2157440"
  },
  {
    "text": "and and stop them flaking or you know pick one and and figure out why it's flaking uh and and fix that",
    "start": "2157440",
    "end": "2164480"
  },
  {
    "text": "um next thing you can listen into the sig meetings or you can use find them on",
    "start": "2164480",
    "end": "2170640"
  },
  {
    "text": "youtube and and like follow along uh visit one or two you don't have to say",
    "start": "2170640",
    "end": "2176240"
  },
  {
    "text": "anything you can just show up and and kind of listen to how it goes and get an idea and then and then you",
    "start": "2176240",
    "end": "2181920"
  },
  {
    "text": "can you can show up you can say hi i you know do you need help with something uh so that's my my top three tips for",
    "start": "2181920",
    "end": "2188320"
  },
  {
    "text": "getting started as a newbie so you had to implement the parsing of",
    "start": "2188320",
    "end": "2195359"
  },
  {
    "text": "the uh kind and the object name in the cube cattle",
    "start": "2195359",
    "end": "2200960"
  },
  {
    "text": "command isn't should that be already implemented in a more generic way because we have cube",
    "start": "2200960",
    "end": "2208240"
  },
  {
    "text": "cattle create delete and uh get it doesn't doesn't exist there",
    "start": "2208240",
    "end": "2214400"
  },
  {
    "text": "yeah yeah so i think i agree with the spirit of what you're saying that the i mean i i tried to demonstrate there's some",
    "start": "2214400",
    "end": "2220560"
  },
  {
    "text": "really powerful libraries in there but still not exactly the thing i wanted and in",
    "start": "2220560",
    "end": "2227040"
  },
  {
    "text": "some cases like the thing that that specific thing that you mentioned about how to decode the name that is in cubecan will describe",
    "start": "2227040",
    "end": "2234800"
  },
  {
    "text": "um but it's not exported and after a little bit of to and fro with the maintainers we agreed that i would",
    "start": "2234800",
    "end": "2242160"
  },
  {
    "text": "um re-implement it so there's a kind of a go proverb a little copying is better than a little dependency",
    "start": "2242160",
    "end": "2249040"
  },
  {
    "text": "um so it's kind of better just to copy-paste it once and then maybe over time we can figure",
    "start": "2249040",
    "end": "2254720"
  },
  {
    "text": "out it should be a reusable library uh anyway i i think i agree with you in",
    "start": "2254720",
    "end": "2259839"
  },
  {
    "text": "in spirit but it is what it is all right thank you everyone thanks",
    "start": "2259839",
    "end": "2266240"
  },
  {
    "text": "brian have a nice lunch thank you",
    "start": "2266240",
    "end": "2271240"
  }
]