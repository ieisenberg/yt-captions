[
  {
    "text": "I think it's a 11 30 so we'll get started uh whoa whoa",
    "start": "120",
    "end": "7560"
  },
  {
    "text": "all right thank you wow uh so uh excited to speak to you today um this is a talk",
    "start": "7560",
    "end": "13080"
  },
  {
    "text": "about Argos TV but it's actually also a talk that involves Argo workflows and so I know if some of you are Argo workflows",
    "start": "13080",
    "end": "19680"
  },
  {
    "text": "refugees who washed up in this room that's okay you'll have something to look at too we're going to talk about",
    "start": "19680",
    "end": "25500"
  },
  {
    "text": "being secure by default with get Ops and this is just kind of taking a different approach to security my name is Dan",
    "start": "25500",
    "end": "32640"
  },
  {
    "text": "Garfield I am the co-founder and chief open source officer of code fresh uh",
    "start": "32640",
    "end": "38160"
  },
  {
    "text": "raise your hand if you know what a chief open source officer is uh and does",
    "start": "38160",
    "end": "43440"
  },
  {
    "text": "okay I'll check with you afterwards I'd like to find out um but uh but yeah I work uh on in code",
    "start": "43440",
    "end": "50700"
  },
  {
    "text": "fresh and I help lead our open source efforts and uh our contributions to the Argo project uh I am an Argo maintainer",
    "start": "50700",
    "end": "57300"
  },
  {
    "text": "uh most of the work that I do is [Music] um it's uh let's just say it's less code I",
    "start": "57300",
    "end": "64440"
  },
  {
    "text": "don't do as much code these days uh I do a little bit here and there I'm also a founder and",
    "start": "64440",
    "end": "70920"
  },
  {
    "text": "um create helped create the open get Ops project in the get Ops working group which created the get Ops principles",
    "start": "70920",
    "end": "77700"
  },
  {
    "text": "which I hope many of you are familiar with because we're going to be applying those principles today if you're not",
    "start": "77700",
    "end": "82799"
  },
  {
    "text": "familiar with code fresh we are a uh a continuous delivery continuous",
    "start": "82799",
    "end": "88259"
  },
  {
    "text": "deployment platform built on Argo we have an Enterprise version of Argo that",
    "start": "88259",
    "end": "93420"
  },
  {
    "text": "I would love to hear have you check out and hear what you think about it um I wanted to start really quick with a",
    "start": "93420",
    "end": "100560"
  },
  {
    "text": "brief story uh when I was a young man when I was a kid I had to skateboard",
    "start": "100560",
    "end": "106920"
  },
  {
    "text": "everywhere to get places and I started a business building and selling computers",
    "start": "106920",
    "end": "112860"
  },
  {
    "text": "and fixing networks and doing networking for people and on one of my jobs somebody actually paid me in an old",
    "start": "112860",
    "end": "121140"
  },
  {
    "text": "laptop and suddenly I had a laptop for the very first time I had portable Computing it had 128 Megs of ram I threw",
    "start": "121140",
    "end": "129479"
  },
  {
    "text": "netbsd on that thing I stuck into my backpack and around two or three in the morning I would skateboard out into the",
    "start": "129479",
    "end": "135720"
  },
  {
    "text": "neighborhood I had about 40 minutes of battery life I'd put on my headphones had to reinstall the audio driver for",
    "start": "135720",
    "end": "141720"
  },
  {
    "text": "netpsd and then I would listen on war driver for networks and then I would",
    "start": "141720",
    "end": "147900"
  },
  {
    "text": "find wdp networks and allegedly allegedly I would try to break into",
    "start": "147900",
    "end": "153120"
  },
  {
    "text": "these networks and and the trick with WEP is that you basically if sponsors",
    "start": "153120",
    "end": "159060"
  },
  {
    "text": "lots of clients going on you can send out a signal that says that they need to re-authenticate and then the wp clients",
    "start": "159060",
    "end": "166019"
  },
  {
    "text": "will all spray their uh their keys back to the server and you can get in the",
    "start": "166019",
    "end": "171300"
  },
  {
    "text": "middle of that and intercept those keys and then you can gain access to the network so I tell you this so that you",
    "start": "171300",
    "end": "177900"
  },
  {
    "text": "know that my security credentials are very outdated and not that useful",
    "start": "177900",
    "end": "184560"
  },
  {
    "text": "for today uh and second because getting in the middle is what we're going to try to stop from people doing with Argos",
    "start": "184560",
    "end": "191640"
  },
  {
    "text": "getting around Argo CD so one of the problems we're going to solve today first do you know where your software",
    "start": "191640",
    "end": "197400"
  },
  {
    "text": "comes from it's 6 PM do you know where your software comes from uh and this is",
    "start": "197400",
    "end": "203280"
  },
  {
    "text": "a real issue in the community is the supply chain how do you know that an image or a binary hasn't been",
    "start": "203280",
    "end": "209220"
  },
  {
    "text": "intercepted how do you know that a tag hasn't been overwritten you know documentaries are supposed to be immutable but when I pointed that tag",
    "start": "209220",
    "end": "216420"
  },
  {
    "text": "you can switch the binary that's behind that tag so how do I know that what I'm getting is what I want how do I know a",
    "start": "216420",
    "end": "223140"
  },
  {
    "text": "programmer's machine wasn't compromised I know of a company where a programmer clicked on a phishing link and suddenly",
    "start": "223140",
    "end": "229319"
  },
  {
    "text": "attackers started deploying to his clients websites so this stuff happens",
    "start": "229319",
    "end": "235920"
  },
  {
    "text": "um the second issue is how do you enforce rules on your clusters you do lots of trainings you do lots of",
    "start": "235920",
    "end": "241319"
  },
  {
    "text": "automation maybe maybe you audit and you check and make sure I know another story",
    "start": "241319",
    "end": "246659"
  },
  {
    "text": "of a big credit card company who went to go debug a service that was failing and they found out that the team that had",
    "start": "246659",
    "end": "252659"
  },
  {
    "text": "been working on it hadn't checked any code in for the last year but they've been pushing",
    "start": "252659",
    "end": "258060"
  },
  {
    "text": "what the heck were they pushing how did we how do we know um and then third git office is really",
    "start": "258060",
    "end": "263520"
  },
  {
    "text": "great so how do we make sure that people are actually using it it's very easy to to get lazy and drop out of the mode of",
    "start": "263520",
    "end": "269759"
  },
  {
    "text": "making git commits to make all of your changes so how do we make sure that people are actually following the process and using the tools we wanted to",
    "start": "269759",
    "end": "275340"
  },
  {
    "text": "do um when it comes to security training is a great first step",
    "start": "275340",
    "end": "281340"
  },
  {
    "text": "it should never be the last if it is the last step then it might be",
    "start": "281340",
    "end": "286560"
  },
  {
    "text": "your last step as a threatening threatening turn of phrase so approaching security what we're going to",
    "start": "286560",
    "end": "291600"
  },
  {
    "text": "do today one we want to verify our software supply chain two we want to enforce security policy and three we",
    "start": "291600",
    "end": "298380"
  },
  {
    "text": "want to do it all with Git Ops and to do this we're gonna be using Argo CD we're going to be using the getoffs principles we're going to be using a project called",
    "start": "298380",
    "end": "304320"
  },
  {
    "text": "Sig store cosine and we're going to be using open policy agent as well as kyverno",
    "start": "304320",
    "end": "309960"
  },
  {
    "text": "uh so starting off with Sig store cosine many of you how many people are already familiar with cosine have heard of this",
    "start": "309960",
    "end": "316740"
  },
  {
    "text": "I'm a pretty good chunk of the audience probably most of you have played with it this is basically a tool for doing",
    "start": "316740",
    "end": "322440"
  },
  {
    "text": "supply chain security so in this presentation here's my first gift I have a free workflow template for you",
    "start": "322440",
    "end": "329400"
  },
  {
    "text": "to use so the first thing if you're going to use this basically the way that cosine works is you can sign images Helm",
    "start": "329400",
    "end": "336720"
  },
  {
    "text": "charts other binaries and you can sign it with a key and then you can verify",
    "start": "336720",
    "end": "342120"
  },
  {
    "text": "that key later and so you can make sure that the artifact that you're looking at was signed using the key that you",
    "start": "342120",
    "end": "348240"
  },
  {
    "text": "expected and this way you can verify the provenance or where an artifact came",
    "start": "348240",
    "end": "353520"
  },
  {
    "text": "from so to do this first you need to generate a key pair you just run cosine generate",
    "start": "353520",
    "end": "360180"
  },
  {
    "text": "key pair and you can specify a kubernetes namespace that you want to put that secret into if you want to put it directly into the cluster two you can",
    "start": "360180",
    "end": "367880"
  },
  {
    "text": "you you need to sign that image and upload it to the registry and three we can actually automate this in a workflow",
    "start": "367880",
    "end": "374520"
  },
  {
    "text": "template so I'll just show you really quickly we if I don't know how many of",
    "start": "374520",
    "end": "379680"
  },
  {
    "text": "you are familiar with a code fresh hub for Argo but this is a collection of",
    "start": "379680",
    "end": "384960"
  },
  {
    "text": "workflow templates that are focused on CI CD devops and basically automating",
    "start": "384960",
    "end": "391740"
  },
  {
    "text": "your software delivery chain and there is a new one in here called cosine you can grab this template throw it in your",
    "start": "391740",
    "end": "397860"
  },
  {
    "text": "workflow and use it to start deploying stuff and don't worry there'll be links to all this stuff at the end",
    "start": "397860",
    "end": "403800"
  },
  {
    "text": "and we're gonna be using that one today as well um so the next part of this equation is going to be Opa now Opa stands for open",
    "start": "403800",
    "end": "411419"
  },
  {
    "text": "policy agent many of you are probably already familiar with open policy agent especially from its use in service",
    "start": "411419",
    "end": "418380"
  },
  {
    "text": "meshes and it allows you to create policies general purpose policies like",
    "start": "418380",
    "end": "423780"
  },
  {
    "text": "this pod can talk to that pod or this thing can't reach outside the network or those kinds of things a newer",
    "start": "423780",
    "end": "429419"
  },
  {
    "text": "implementation of opa is Opa gatekeeper and this is a really interesting tool",
    "start": "429419",
    "end": "435060"
  },
  {
    "text": "that sits on your cluster and it basically sits on injection web Hooks and it inspects elements and make sure",
    "start": "435060",
    "end": "441240"
  },
  {
    "text": "they meet policy um so these policies can do things like",
    "start": "441240",
    "end": "446580"
  },
  {
    "text": "protect namespaces they can prevent privileged containers they can block and allow image repos they can limit",
    "start": "446580",
    "end": "452639"
  },
  {
    "text": "replicas they can do all kinds of things and they have a huge library of these already available called gatekeeper",
    "start": "452639",
    "end": "458880"
  },
  {
    "text": "library and at the end of this I will also show you how to use it to prevent people from deploying things without",
    "start": "458880",
    "end": "464940"
  },
  {
    "text": "using Argo so if they tried to apply things directly we can actually stop them from doing that",
    "start": "464940",
    "end": "469979"
  },
  {
    "text": "so with Opa gatekeeper basically you apply your manifest the admission web hook picks these things up it checks",
    "start": "469979",
    "end": "476099"
  },
  {
    "text": "against a constraint and then it enforces or doesn't enforce or allows",
    "start": "476099",
    "end": "481500"
  },
  {
    "text": "things to be deployed onto the scheduler um if you're using this with Argo CD the",
    "start": "481500",
    "end": "487080"
  },
  {
    "text": "first thing that you'll notice is that the way that Opa gatekeeper works is that for each template policy template",
    "start": "487080",
    "end": "493680"
  },
  {
    "text": "it actually creates a custom resource definition now everybody knows that if you're using Argos CD and you have a",
    "start": "493680",
    "end": "499259"
  },
  {
    "text": "bunch of custom resource definitions you just need to like think through it um because you need to make sure that",
    "start": "499259",
    "end": "505500"
  },
  {
    "text": "your custom resource definitions are applied before your custom resources um",
    "start": "505500",
    "end": "511080"
  },
  {
    "text": "so uh for applying these resources I have a couple of policies that I've",
    "start": "511080",
    "end": "516120"
  },
  {
    "text": "already set and I'll just show you I've got a policy for example that only",
    "start": "516120",
    "end": "522479"
  },
  {
    "text": "allows images from my today was awesome repo this is a policy I've already set up on my cluster and if I were to try to",
    "start": "522479",
    "end": "531060"
  },
  {
    "text": "apply this and let's just do this with [Music] um",
    "start": "531060",
    "end": "537420"
  },
  {
    "text": "let's see samples pod restrict and I'm going to",
    "start": "537420",
    "end": "543720"
  },
  {
    "text": "send this into my secure namespace now you can apply it to all namespaces for the sake of the demo I did it that way and I'm going to do a dry run and on",
    "start": "543720",
    "end": "550920"
  },
  {
    "text": "this one I'm going to do a dry run equals server so this will try to apply my pod that",
    "start": "550920",
    "end": "558000"
  },
  {
    "text": "shouldn't be allowed and you can see that it's been forbidden an admission web hook has picked up and said hey",
    "start": "558000",
    "end": "564360"
  },
  {
    "text": "you're actually using the latest tag that is a git Ops no no do not use",
    "start": "564360",
    "end": "569700"
  },
  {
    "text": "floating tags right so we've detected that we've blocked it and we've detected that it's not from the expected",
    "start": "569700",
    "end": "576240"
  },
  {
    "text": "repository and so you can have you can have these mixed and match and and you can see how it works now with Argo CD",
    "start": "576240",
    "end": "583500"
  },
  {
    "text": "today in 2.4 and lower the way that we actually validate resources is we",
    "start": "583500",
    "end": "590339"
  },
  {
    "text": "actually do a dry run client now what happens if I do a dry run client is it going to pick it up",
    "start": "590339",
    "end": "596040"
  },
  {
    "text": "no there's nothing for it to test against because the constraints are on the",
    "start": "596040",
    "end": "601260"
  },
  {
    "text": "cluster now that means that when we sync these Resources with Argo CD we're going",
    "start": "601260",
    "end": "606839"
  },
  {
    "text": "to have failures and it's going to it's going to flag them as failed it's not going to allow them through but it's going to show up",
    "start": "606839",
    "end": "612720"
  },
  {
    "text": "as essentially if it's a pod it will show up as just progressing it'll be stuck in progressing if a specific",
    "start": "612720",
    "end": "618899"
  },
  {
    "text": "resource failed to apply then it will flag that resource but starting with Argo 2.5 and we should be able to start",
    "start": "618899",
    "end": "625440"
  },
  {
    "text": "cutting the release for 2.5 this week that doesn't mean it's been released this week I mean we're starting the branch the release Branch this week",
    "start": "625440",
    "end": "632000"
  },
  {
    "text": "it will actually do a server side dry runs which means that it will actually",
    "start": "632000",
    "end": "637560"
  },
  {
    "text": "pick up on and throw errors earlier and have better support for using injection web Hooks and things like that anyway",
    "start": "637560",
    "end": "644940"
  },
  {
    "text": "all right so uh we just saw how we can use gatekeeper to prevent things from getting deployed so what about with cicd",
    "start": "644940",
    "end": "652200"
  },
  {
    "text": "I'm going to show you a slide and it's going to be really intimidating I'm so sorry delivering software is complicated",
    "start": "652200",
    "end": "658920"
  },
  {
    "text": "sometimes there's a lot going on here so starting off with number one we've got our application repo this is where my",
    "start": "658920",
    "end": "665820"
  },
  {
    "text": "application Engineers are working they're making changes when they cut a release this is going to trigger CI CD",
    "start": "665820",
    "end": "671279"
  },
  {
    "text": "and in this case I'm using Code fresh as a version of Argo workflows that is hosted that I'm going to be using",
    "start": "671279",
    "end": "677399"
  },
  {
    "text": "because it's sort of optimized for devops and it takes care of my events and stuff for me so it's convenient",
    "start": "677399",
    "end": "682500"
  },
  {
    "text": "we're going to run our build that's going to build our image then we're going to run the cosine template to sign that image which will then be pushed up",
    "start": "682500",
    "end": "689160"
  },
  {
    "text": "to Docker Hub at which point we can trigger three which is to add a new release to our git Ops repo where we've",
    "start": "689160",
    "end": "696240"
  },
  {
    "text": "actually defined what should be deployed at which point Argo will try to deploy",
    "start": "696240",
    "end": "701459"
  },
  {
    "text": "that and gatekeeper will step in and examine the policies that are there so",
    "start": "701459",
    "end": "707100"
  },
  {
    "text": "once that's done it'll deploy the resources or reject them depending on what I'm deploying so I've got a release",
    "start": "707100",
    "end": "714899"
  },
  {
    "text": "here ready to cut and I've marked it as v1.0.1 secure I'll go ahead and publish",
    "start": "714899",
    "end": "722820"
  },
  {
    "text": "this release now once I publish this I should see my",
    "start": "722820",
    "end": "728700"
  },
  {
    "text": "workflow kick off relatively quick here",
    "start": "728700",
    "end": "732380"
  },
  {
    "text": "I said relatively quick here the Wi-Fi is a you know an issue",
    "start": "736200",
    "end": "742620"
  },
  {
    "text": "sometimes all right we can see that this is kicked off and it's building and it's going to build that Docker image and as",
    "start": "742620",
    "end": "748680"
  },
  {
    "text": "soon as it does it's going to kick off the cosine and push it up to my Docker registry now while we're doing that we",
    "start": "748680",
    "end": "755279"
  },
  {
    "text": "can actually prepare the release so I've got my OSS secure repo here with links to everything from this talk as well as",
    "start": "755279",
    "end": "761519"
  },
  {
    "text": "links to the slides so feel free to use that and I'm going to go into my source",
    "start": "761519",
    "end": "768720"
  },
  {
    "text": "repo manifests and in this case I'm using the demo accept app and I'm",
    "start": "768720",
    "end": "776880"
  },
  {
    "text": "deploying it to the OSS secure server and I will edit this customization",
    "start": "776880",
    "end": "783320"
  },
  {
    "text": "and when I do I'm going to specify the new version which is",
    "start": "783480",
    "end": "789600"
  },
  {
    "text": "I think 1.0.1 secure",
    "start": "789600",
    "end": "795680"
  },
  {
    "text": "if it's done baking yes it looks like it's done baking that we can see that it",
    "start": "795779",
    "end": "800880"
  },
  {
    "text": "signed the image here and pushed the signature all right so",
    "start": "800880",
    "end": "805980"
  },
  {
    "text": "um once I've done this I can go and kick off",
    "start": "805980",
    "end": "811680"
  },
  {
    "text": "coin new secure version now actually uh normally I would use like Argo CD image",
    "start": "811680",
    "end": "817620"
  },
  {
    "text": "updater or some other maybe CI CD to automate the creation of the deploy but everybody",
    "start": "817620",
    "end": "823380"
  },
  {
    "text": "likes looking at uh pull requests being merged live so we just did it",
    "start": "823380",
    "end": "830339"
  },
  {
    "text": "um merger and pull request give yourself a high five feel good about yourself and now we're going to go over and look",
    "start": "830339",
    "end": "836700"
  },
  {
    "text": "at our applications and our demo accept app",
    "start": "836700",
    "end": "842240"
  },
  {
    "text": "now we can see this last synced 14 hours ago",
    "start": "842240",
    "end": "848060"
  },
  {
    "text": "and we'll trigger a refresh even though it actually would do it automatically we",
    "start": "848060",
    "end": "853500"
  },
  {
    "text": "would get there wait for a second and this should trigger and kick off now what am I",
    "start": "853500",
    "end": "858660"
  },
  {
    "text": "expecting to see it should just work so this is actually not that fun to look at so what if we",
    "start": "858660",
    "end": "864660"
  },
  {
    "text": "deployed something that wasn't going to work how would that look uh so let's do this one again except now instead of",
    "start": "864660",
    "end": "871800"
  },
  {
    "text": "deploying the new secure version I'm going to I'm going to be deploying an",
    "start": "871800",
    "end": "877079"
  },
  {
    "text": "out of date version right so to do this we'll go back and edit our file again",
    "start": "877079",
    "end": "884399"
  },
  {
    "text": "and instead of doing the secure version I'm going to be doing the Blue version",
    "start": "884399",
    "end": "891540"
  },
  {
    "text": "go Blue it's not secure fun and we'll we'll commit that one directly",
    "start": "891540",
    "end": "897600"
  },
  {
    "text": "because nobody laughed at my joke about merging my own pull requests",
    "start": "897600",
    "end": "902600"
  },
  {
    "text": "uh okay so uh we'll trigger the sync again really quick uh again it would pick up automatically and now it's going",
    "start": "903060",
    "end": "909959"
  },
  {
    "text": "to start going and you can see it's going to be stuck in progressing because guess what",
    "start": "909959",
    "end": "916800"
  },
  {
    "text": "we can't deploy it because it is denied because the check image signature has",
    "start": "916800",
    "end": "924480"
  },
  {
    "text": "failed no matching signatures found so you saw that it worked and then I showed that I could break it",
    "start": "924480",
    "end": "930540"
  },
  {
    "text": "okay so everybody's oh thank you yes yes smooth demos",
    "start": "930540",
    "end": "936120"
  },
  {
    "text": "smooth demos are good so you can see this actually fairly simple to implement and for Mirror developers perspective",
    "start": "936120",
    "end": "942540"
  },
  {
    "text": "once you've implemented it it's basically in the background they don't even know about it it's just getting",
    "start": "942540",
    "end": "948300"
  },
  {
    "text": "verified automatically and you can apply this to a lot of there's a big push to",
    "start": "948300",
    "end": "953639"
  },
  {
    "text": "get more Community images to be signed so you can verify their signatures and of course you could build them and push",
    "start": "953639",
    "end": "959100"
  },
  {
    "text": "them into your own repo and you could push them into your own repo while verifying them you could also make",
    "start": "959100",
    "end": "965459"
  },
  {
    "text": "verification contingent upon Security checks you could use image scanning and all these other things and then say and",
    "start": "965459",
    "end": "971399"
  },
  {
    "text": "uh we didn't we're not really going to go into this but within cosine you can make attestations so attestations would",
    "start": "971399",
    "end": "977399"
  },
  {
    "text": "allow you to say who made it in this case this Secret Lives on my Argo workflows instance that is sitting on my",
    "start": "977399",
    "end": "983940"
  },
  {
    "text": "AWS cluster that I have managed in code fresh and so I've verified its",
    "start": "983940",
    "end": "989639"
  },
  {
    "text": "Providence but I can make attestations and say this has passed these kinds of security scans I can verify that all the",
    "start": "989639",
    "end": "996000"
  },
  {
    "text": "commits were securely done and that they were all signed so you can do all kinds",
    "start": "996000",
    "end": "1001399"
  },
  {
    "text": "of interesting things you could actually take it even farther so um we just did it live oh yeah I was",
    "start": "1001399",
    "end": "1007940"
  },
  {
    "text": "supposed to show that slide before I did it live because it's a cool slide all right so using Opa with Argo CD",
    "start": "1007940",
    "end": "1014300"
  },
  {
    "text": "so uh this is one of those talks where I do the demo in the middle and I explain it so hopefully everybody's feeling oh",
    "start": "1014300",
    "end": "1021259"
  },
  {
    "text": "yeah that made sense everything seems smooth so how do I actually make it work within kubernetes I think of there are",
    "start": "1021259",
    "end": "1028280"
  },
  {
    "text": "essentially two kinds of resources and I made up these terms so you're not going to Google this and be like oh what kind",
    "start": "1028280",
    "end": "1033740"
  },
  {
    "text": "of resource is this but this is the way I think about it there are fragile resources and these are things that are",
    "start": "1033740",
    "end": "1040040"
  },
  {
    "text": "once they are started broken they will stay broken and a good example is an",
    "start": "1040040",
    "end": "1045079"
  },
  {
    "text": "Ingress getting the wrong class because it's been applied out of order this is something that choose actually brought",
    "start": "1045079",
    "end": "1050900"
  },
  {
    "text": "up to me like a month ago as a common issue of making sure these resources applied in order the other kind are what",
    "start": "1050900",
    "end": "1058820"
  },
  {
    "text": "I think of as resilient resources these are resources that if failures occur",
    "start": "1058820",
    "end": "1064580"
  },
  {
    "text": "because things are out of order they will eventually correct themselves and it'll be fine so a good example of this",
    "start": "1064580",
    "end": "1070880"
  },
  {
    "text": "is custom resources custom resources will fail to start but once the definition is found they",
    "start": "1070880",
    "end": "1078020"
  },
  {
    "text": "will work so for resilient resources for your Argo City application policy you",
    "start": "1078020",
    "end": "1084020"
  },
  {
    "text": "can just use a retry you just set a retry policy and eventually it'll work I'm not worried about it failing to",
    "start": "1084020",
    "end": "1089900"
  },
  {
    "text": "start right away it'll get there but for fragile resources you really want to use",
    "start": "1089900",
    "end": "1095000"
  },
  {
    "text": "something some kind of dependency ordering and so this is where sync waves sync Windows uh sorry not sync Windows",
    "start": "1095000",
    "end": "1102200"
  },
  {
    "text": "sync hooks um become really useful and so that's what I actually used in this case",
    "start": "1102200",
    "end": "1108860"
  },
  {
    "text": "because when you rely on admission controllers it actually means that every",
    "start": "1108860",
    "end": "1114320"
  },
  {
    "text": "resource you use becomes a fragile resource meaning that your policies have",
    "start": "1114320",
    "end": "1121340"
  },
  {
    "text": "to be applied before anything else now this is really only an issue at cluster",
    "start": "1121340",
    "end": "1126799"
  },
  {
    "text": "bootstrap right because how often are you going to be applying a new policy",
    "start": "1126799",
    "end": "1132620"
  },
  {
    "text": "along with a new service or new resources that you expect that policy to",
    "start": "1132620",
    "end": "1139220"
  },
  {
    "text": "catch which could potentially create a little bit of a race condition if we didn't apply them in order so",
    "start": "1139220",
    "end": "1144640"
  },
  {
    "text": "bootstrapping was a really critical part of this because in order to be get Ops compliant I want to be ready to",
    "start": "1144640",
    "end": "1150080"
  },
  {
    "text": "bootstrap and tear down or restart all my services at once um so uh we can actually demo that",
    "start": "1150080",
    "end": "1159080"
  },
  {
    "text": "um well let's talk about sync waves for a second so when you're using Argo CD uh with gatekeeper or another security tool",
    "start": "1159080",
    "end": "1166220"
  },
  {
    "text": "like kyverno um you can use retries on things like policies because they rely on custom",
    "start": "1166220",
    "end": "1171380"
  },
  {
    "text": "resource definitions you can apply the policies before other applications so",
    "start": "1171380",
    "end": "1176600"
  },
  {
    "text": "you can make sure that you bootstrap safe we can also monitor application",
    "start": "1176600",
    "end": "1181640"
  },
  {
    "text": "sync status because uh if we are um if if you're applying resources like",
    "start": "1181640",
    "end": "1188179"
  },
  {
    "text": "a service it will fail to apply if it violates policy and that'll show up as a sync error",
    "start": "1188179",
    "end": "1194059"
  },
  {
    "text": "but if you're applying it just to a pod that will show up as progressing and it'll just be stuck in progressing",
    "start": "1194059",
    "end": "1199220"
  },
  {
    "text": "forever this also works with multiple providers so I haven't really touched on kyberna I'll bring that up again in a",
    "start": "1199220",
    "end": "1205400"
  },
  {
    "text": "second but this is a competitor to Opa gatekeeper and you can actually stack",
    "start": "1205400",
    "end": "1210559"
  },
  {
    "text": "these tools because they just add hooks to your admission controllers and they don't fight each other because they",
    "start": "1210559",
    "end": "1216559"
  },
  {
    "text": "basically work off of whichever whichever policy gets blocked that blocks the process and we don't have to",
    "start": "1216559",
    "end": "1222980"
  },
  {
    "text": "go you know farther than that with Opa gatekeeper it is possible to run audits so you can have an audit",
    "start": "1222980",
    "end": "1229880"
  },
  {
    "text": "report that says hey these things are actually exist that are already on your cluster that are violating security",
    "start": "1229880",
    "end": "1235880"
  },
  {
    "text": "policy I would prefer not to have that happen this is security by default not proactive security because I'm really",
    "start": "1235880",
    "end": "1241520"
  },
  {
    "text": "good at paying attention to my emails and then finally this is going to be a lot better in Argo CD 2.5 because we'll",
    "start": "1241520",
    "end": "1247580"
  },
  {
    "text": "actually do server side apply so the behavior for pods failing policy versus",
    "start": "1247580",
    "end": "1252799"
  },
  {
    "text": "other resources will suddenly become the same they'll both show up as synchronization errors",
    "start": "1252799",
    "end": "1259160"
  },
  {
    "text": "uh so let's talk about sync waves for a moment and how we did this many of you are probably familiar with sync waves so",
    "start": "1259160",
    "end": "1264440"
  },
  {
    "text": "I probably don't need to go too deep onto it but if you're not aware of it there's a great blog by Christian Hernandez who's sitting in the front row",
    "start": "1264440",
    "end": "1269780"
  },
  {
    "text": "over here on how to do uh application dependencies using sync waves you can use these you can mix and match these",
    "start": "1269780",
    "end": "1276380"
  },
  {
    "text": "with application sets so you use app of apps with application sets under as child apps you can make it work",
    "start": "1276380",
    "end": "1282679"
  },
  {
    "text": "um it's definitely possible so uh for applying the policies first",
    "start": "1282679",
    "end": "1288080"
  },
  {
    "text": "um because we're short on time I actually pre-recorded this demo because it takes a little bit longer to happen",
    "start": "1288080",
    "end": "1295740"
  },
  {
    "text": "[Music] oh yeah well uh yeah let's do the demo first so I'll",
    "start": "1295740",
    "end": "1302120"
  },
  {
    "text": "just show you what it looks like here I'm using uh Argo CD autopilot if you",
    "start": "1302120",
    "end": "1307400"
  },
  {
    "text": "haven't used Argo CD autopilot it's an opinionated open source implementation of Argo CD that basically bootstraps",
    "start": "1307400",
    "end": "1314000"
  },
  {
    "text": "your Argo CD instance so it's self-managing and it creates a directory structure for you so here I'm using Argo",
    "start": "1314000",
    "end": "1320360"
  },
  {
    "text": "CD autopilot app create source and then I specify the app source and the project",
    "start": "1320360",
    "end": "1326059"
  },
  {
    "text": "and it's going to generate my application for me and this is this is basically what I showed in the diagram a",
    "start": "1326059",
    "end": "1332179"
  },
  {
    "text": "second ago I have an app of apps I have a source",
    "start": "1332179",
    "end": "1337520"
  },
  {
    "text": "app that specifies a system requirements app which contains all the things that I",
    "start": "1337520",
    "end": "1342740"
  },
  {
    "text": "need bootstrapped before I can go into the user space and then I have a user space app which is okay users can all",
    "start": "1342740",
    "end": "1349400"
  },
  {
    "text": "deploy to this they anything they add into this repo that's where they're going to work so I have system",
    "start": "1349400",
    "end": "1354799"
  },
  {
    "text": "requirements they get bootstrapped and everything happens after that so when I do this app create what I'm doing is I'm",
    "start": "1354799",
    "end": "1361340"
  },
  {
    "text": "creating that parent application that references a folder that already contains those two applications once",
    "start": "1361340",
    "end": "1366860"
  },
  {
    "text": "I've done that it will very quickly you'll see all the apps start to show up and if I look in",
    "start": "1366860",
    "end": "1372919"
  },
  {
    "text": "the um my source app here you can see that system requirements is going to con",
    "start": "1372919",
    "end": "1378980"
  },
  {
    "text": "completely finish syncing and deploying all of its elements before the user space",
    "start": "1378980",
    "end": "1384380"
  },
  {
    "text": "and so that means that even if for some reason I'm bootstrapping and there was something in my user space that violated",
    "start": "1384380",
    "end": "1390500"
  },
  {
    "text": "policy it would actually be caught it wouldn't be you could also uh and you",
    "start": "1390500",
    "end": "1395780"
  },
  {
    "text": "could you could make it security only if you wanted to be extra you could just say this is the security layer this gets applied before anything else that's in",
    "start": "1395780",
    "end": "1402140"
  },
  {
    "text": "the system so you could you could go farther with it so to do that is pretty easy you need to",
    "start": "1402140",
    "end": "1409520"
  },
  {
    "text": "enable application sync status to stop progression if apps aren't working so when app of apps was first created in",
    "start": "1409520",
    "end": "1416299"
  },
  {
    "text": "sync waves were created uh by default the behavior was that if a uh if an app",
    "start": "1416299",
    "end": "1424159"
  },
  {
    "text": "was stuck it wouldn't move on to the next app and start deploying it we changed that in Argo 1.8 because for",
    "start": "1424159",
    "end": "1431240"
  },
  {
    "text": "many users that was unexpected behavior and oftentimes you don't want applications to necessarily be blocking",
    "start": "1431240",
    "end": "1437240"
  },
  {
    "text": "other applications so you can re-enable this Behavior with a config map change which then will monitor if an",
    "start": "1437240",
    "end": "1444260"
  },
  {
    "text": "application is progressing and it will count that as part of the sync status that needs to happen as a prerequisite to the next step in the process so this",
    "start": "1444260",
    "end": "1451220"
  },
  {
    "text": "allows us to set the order and make sure that resources are always applied in order um if you're using this with all the",
    "start": "1451220",
    "end": "1456500"
  },
  {
    "text": "Argo CD autopilot you'll need to use a customization it's the same code it's just in a customization in case you you",
    "start": "1456500",
    "end": "1463039"
  },
  {
    "text": "know haven't seen how to how to merge that um and then you just set a sync wave and",
    "start": "1463039",
    "end": "1468620"
  },
  {
    "text": "you can set a sync wave one on your system requirements in a sync Wave 2 on the user space now remember this only",
    "start": "1468620",
    "end": "1475460"
  },
  {
    "text": "applies to the parent applications so if you have within the user space a",
    "start": "1475460",
    "end": "1482480"
  },
  {
    "text": "whole bunch of applications defined that have a sync wave minus one",
    "start": "1482480",
    "end": "1487640"
  },
  {
    "text": "in normal operation those will get deployed before the applications under system requirements",
    "start": "1487640",
    "end": "1493580"
  },
  {
    "text": "so the use case that I was really talking about here is bootstrapping that's why it's useful that race",
    "start": "1493580",
    "end": "1499039"
  },
  {
    "text": "condition that could happen if you're trying to apply a policy and an application change at the same time it's",
    "start": "1499039",
    "end": "1504860"
  },
  {
    "text": "like a it's like a bizarre scenario that like I can't imagine happening um and you'd probably have to take some",
    "start": "1504860",
    "end": "1510620"
  },
  {
    "text": "extra steps to mitigate that if you think that's an issue but it's like it would require an attacker to be pushing",
    "start": "1510620",
    "end": "1516740"
  },
  {
    "text": "a change and adding a policy to restrict itself at the same time so why would anyone ever do that it's like counter to",
    "start": "1516740",
    "end": "1524000"
  },
  {
    "text": "your incentives so um I don't think it would be an issue but like I said I'm just a kid on a",
    "start": "1524000",
    "end": "1529700"
  },
  {
    "text": "skateboard so uh if uh if that if you think that's a bad policy let me know",
    "start": "1529700",
    "end": "1535400"
  },
  {
    "text": "um okay so next there we go uh the next thing is to",
    "start": "1535400",
    "end": "1543260"
  },
  {
    "text": "prevent uh applying resources without Argo CD so I mentioned again at the very",
    "start": "1543260",
    "end": "1548419"
  },
  {
    "text": "beginning of this thing that the whole approach to Security in my mind is how can I get in between things",
    "start": "1548419",
    "end": "1554120"
  },
  {
    "text": "so that I'm passed off as authentic how can I just listen in or how can I inject something so what if uh first of all can",
    "start": "1554120",
    "end": "1562159"
  },
  {
    "text": "I apply if I apply manifest directly to the cluster without Argo CD",
    "start": "1562159",
    "end": "1567799"
  },
  {
    "text": "will Opa gatekeeper not function no it'll function right okay gatekeeper",
    "start": "1567799",
    "end": "1575000"
  },
  {
    "text": "will still apply policies but what if I'm just trying to deploy stuff and in this case it's our is my team actually using",
    "start": "1575000",
    "end": "1582200"
  },
  {
    "text": "gitups what resources are being deployed that aren't tracked uh with within Argo",
    "start": "1582200",
    "end": "1587960"
  },
  {
    "text": "CD so to do this we can create a simple policy and this",
    "start": "1587960",
    "end": "1593120"
  },
  {
    "text": "is what that policy looks like um if you can see it here I have an enforcement action deny this relies on a",
    "start": "1593120",
    "end": "1601159"
  },
  {
    "text": "a live gatekeeper Library can um uh so many were so many buzzwords all at",
    "start": "1601159",
    "end": "1609080"
  },
  {
    "text": "once it's hard to get out um Gatekeepers library has a has a constrained template called KH",
    "start": "1609080",
    "end": "1618559"
  },
  {
    "text": "required annotations so to use this we need to make sure that Argo CD is tracking with annotations and then we",
    "start": "1618559",
    "end": "1624980"
  },
  {
    "text": "can just set our policy in this case I'm restricting services and pods in the secure namespace",
    "start": "1624980",
    "end": "1631039"
  },
  {
    "text": "and I actually don't have that enabled right now so let's enable this",
    "start": "1631039",
    "end": "1637940"
  },
  {
    "text": "and we will push it restrict",
    "start": "1637940",
    "end": "1644320"
  },
  {
    "text": "non-argo managed apps we'll push that",
    "start": "1644320",
    "end": "1650360"
  },
  {
    "text": "oh merge conflicts are fine",
    "start": "1650360",
    "end": "1656120"
  },
  {
    "text": "nobody Minds I already push that okay so now that I'm pushing this policy again all these",
    "start": "1656120",
    "end": "1662659"
  },
  {
    "text": "policies are managed in Argo CD you probably don't care that much about seeing uh constraints managed in here",
    "start": "1662659",
    "end": "1669020"
  },
  {
    "text": "but you can see it just deployed so you can see each of these shows up as a resource in here just like you would",
    "start": "1669020",
    "end": "1674659"
  },
  {
    "text": "expect it to so now if I try to apply",
    "start": "1674659",
    "end": "1680659"
  },
  {
    "text": "um a restricted an application directly and let's do",
    "start": "1680840",
    "end": "1687620"
  },
  {
    "text": "not pod not a lounge let's do",
    "start": "1687620",
    "end": "1693500"
  },
  {
    "text": "um service I think it's service not allowed what do I have in here I have uh reject non",
    "start": "1693500",
    "end": "1701000"
  },
  {
    "text": "-argo CD application and we'll do this in the secure namespace",
    "start": "1701000",
    "end": "1707179"
  },
  {
    "text": "and we'll do it dry running against the server so you can see the policy applies",
    "start": "1707179",
    "end": "1713200"
  },
  {
    "text": "now as you can see it's forbidden you must provide annotations basically it's looking for annotation IDs from that",
    "start": "1715580",
    "end": "1723200"
  },
  {
    "text": "Argo CD sets to make sure that those are set so otherwise you can't deploy it if I were to apply this outside of my",
    "start": "1723200",
    "end": "1729919"
  },
  {
    "text": "secure namespace let's say the default namespace then it should work just fine",
    "start": "1729919",
    "end": "1735260"
  },
  {
    "text": "because I scoped my permissions to yeah see it works just fine because I scoped it to only that namespace so",
    "start": "1735260",
    "end": "1743500"
  },
  {
    "text": "all right so uh last thing bonus tip if you are using kyverno and you're",
    "start": "1743500",
    "end": "1749179"
  },
  {
    "text": "probably thinking why is he talking about Carbono Carbono is the competitor to Opa gatekeeper they're both cncf",
    "start": "1749179",
    "end": "1755059"
  },
  {
    "text": "projects they're both great projects I recommend checking them both out um if you are using kyverno it mutates",
    "start": "1755059",
    "end": "1760279"
  },
  {
    "text": "resources and adds a lot of information uh and uh so you will need to add that",
    "start": "1760279",
    "end": "1766640"
  },
  {
    "text": "to your application uh checking to make sure that you're instead of creating crds it creates these mutations so you",
    "start": "1766640",
    "end": "1774200"
  },
  {
    "text": "just need to remove those there's a link on how to remove that so what do we accomplish we verified our software supply chain we",
    "start": "1774200",
    "end": "1781520"
  },
  {
    "text": "verified that located with the skateboard is going to come get into the middle of my supply chain and deploy something I don't want deployed we",
    "start": "1781520",
    "end": "1787700"
  },
  {
    "text": "enforced a security policy and made sure that people couldn't deploy stuff that wasn't signed and we did it with a",
    "start": "1787700",
    "end": "1795020"
  },
  {
    "text": "hundred percent get offs we made sure that people are using our Argo CD they're not trying to bypass the process for how we deliver process software",
    "start": "1795020",
    "end": "1801980"
  },
  {
    "text": "we're able to verify all these things and ensure it so even if I have failures down Upstream like somebody getting",
    "start": "1801980",
    "end": "1808820"
  },
  {
    "text": "access keys they shouldn't have or somebody somebody having permissions that are looser than they're supposed to",
    "start": "1808820",
    "end": "1814159"
  },
  {
    "text": "be or any of those kinds of things we still can enforce and make sure that this stuff happens and when it works",
    "start": "1814159",
    "end": "1819980"
  },
  {
    "text": "it's transparent to the developer experience they don't notice it because they're not violating the policies and",
    "start": "1819980",
    "end": "1825799"
  },
  {
    "text": "if they are violating the policies it then means they didn't follow the training but remember training was just the first step not the last one so with",
    "start": "1825799",
    "end": "1833179"
  },
  {
    "text": "that there's a link bunch of links in here again this is all in the git repo I'll give you a second to take a picture",
    "start": "1833179",
    "end": "1839840"
  },
  {
    "text": "um and then I want to give a shout out uh if you haven't already registered for",
    "start": "1839840",
    "end": "1844940"
  },
  {
    "text": "it or if you haven't already done it the uh we have amazing get op certification",
    "start": "1844940",
    "end": "1849980"
  },
  {
    "text": "that is the number one in the world we have over 10 000 students it's probably over 11 000 as of today we are doing a",
    "start": "1849980",
    "end": "1856880"
  },
  {
    "text": "live run through tomorrow which is the 101 get offs fundamentals and then we're",
    "start": "1856880",
    "end": "1861980"
  },
  {
    "text": "also doing 202 get opposite scale and all the creators of that are here and with that I'm happy to take any",
    "start": "1861980",
    "end": "1867919"
  },
  {
    "text": "questions so thank you [Applause]",
    "start": "1867919",
    "end": "1874059"
  },
  {
    "text": "have you ever seen a demo run so smooth I mean come on uh so yeah we've got",
    "start": "1874059",
    "end": "1880399"
  },
  {
    "text": "um just a second for questions if anybody has a question feel free to raise your hand",
    "start": "1880399",
    "end": "1888340"
  },
  {
    "text": "I'll keep you after no I won't keep you after oh wow okay threats work go ahead",
    "start": "1890779",
    "end": "1895880"
  },
  {
    "text": "what kind of skateboard do I have uh well it's uh it's just a blank board I'm not that I'm not that interested uh",
    "start": "1895880",
    "end": "1901340"
  },
  {
    "text": "there's one over here yeah yeah yeah is it not trivial to add the",
    "start": "1901340",
    "end": "1907760"
  },
  {
    "text": "annotations that it's expecting yes that's a very sharp observation is it",
    "start": "1907760",
    "end": "1914120"
  },
  {
    "text": "not trivial to add The annotation that it's expecting it is fairly trivial to add The annotation that it's expecting",
    "start": "1914120",
    "end": "1919640"
  },
  {
    "text": "um in this case this works as a pretty soft rule enforcement to say like uh so",
    "start": "1919640",
    "end": "1925520"
  },
  {
    "text": "I imagine a scenario where maybe your hair is on fire everything's exploding around you and you want to go interact",
    "start": "1925520",
    "end": "1931640"
  },
  {
    "text": "directly with the cluster and you've broken all the glass and you've gotten permission to do it you can work your",
    "start": "1931640",
    "end": "1937100"
  },
  {
    "text": "way around it that is not a security enforcement measurement when it comes to making sure that resources are applied",
    "start": "1937100",
    "end": "1942679"
  },
  {
    "text": "with kubernetes with Argo CD in that case it's really about making sure that",
    "start": "1942679",
    "end": "1947840"
  },
  {
    "text": "uh people are following the training and the policy of how things should be deployed if they want to get around it they could but you would be able to also",
    "start": "1947840",
    "end": "1956120"
  },
  {
    "text": "audit it and follow up later and say hey why are you always doing this so it wouldn't be in the dark at least",
    "start": "1956120",
    "end": "1961700"
  },
  {
    "text": "yeah so what kind of policies can you enforce and can you enforce these policies where do you specify and then",
    "start": "1961700",
    "end": "1968659"
  },
  {
    "text": "when do you enforce them and time deploying time you know a build time yeah so you can uh you can enforce",
    "start": "1968659",
    "end": "1976159"
  },
  {
    "text": "gatekeeper Works off of injection web Hooks and so there are lots of policies that are designed around making sure",
    "start": "1976159",
    "end": "1982880"
  },
  {
    "text": "that resources don't get onto your cluster it also has policies around pods and how they function so for example you",
    "start": "1982880",
    "end": "1988820"
  },
  {
    "text": "can have a pot you can have a policy that says Don't deploy any pods that that allow privileged access",
    "start": "1988820",
    "end": "1995419"
  },
  {
    "text": "um and that kind of thing so uh in the screenshots there when we show the",
    "start": "1995419",
    "end": "2001059"
  },
  {
    "text": "constraints you can actually see how those policies are written they're pretty short they're pretty easy to",
    "start": "2001059",
    "end": "2006760"
  },
  {
    "text": "write and they're pretty easy to modify so they're pretty accessible so yeah in general when resources are applied and",
    "start": "2006760",
    "end": "2013840"
  },
  {
    "text": "then also when pods try to start those are kind of the two main areas of policy for gatekeeper and then Opa in general",
    "start": "2013840",
    "end": "2020500"
  },
  {
    "text": "if you're using like engine X sidecars or things can also have policies around",
    "start": "2020500",
    "end": "2025539"
  },
  {
    "text": "how things communicate with each other on the cluster but that's separate from gatekeeper that's just Opa oriented on",
    "start": "2025539",
    "end": "2033220"
  },
  {
    "text": "like a not an nginx proxy an Envoy proxy sorry thank you yeah thank you all right",
    "start": "2033220",
    "end": "2038860"
  },
  {
    "text": "with that if you have any other questions feel free to talk to me after and thank you so much for coming to my talk I appreciate it",
    "start": "2038860",
    "end": "2044430"
  },
  {
    "text": "[Applause]",
    "start": "2044430",
    "end": "2050340"
  }
]