[
  {
    "text": "evening everyone and uh Welcome to our talk on efficient kubernetes end to end testing",
    "start": "80",
    "end": "8480"
  },
  {
    "text": "Unleash the Power of prow who we are I Jason branza I have",
    "start": "8480",
    "end": "14920"
  },
  {
    "text": "been an independent it consultant for the past 20 years um I also served as",
    "start": "14920",
    "end": "21880"
  },
  {
    "text": "the announcement shadow on the 1.25 release I currently serve as the new membership coordinator for the",
    "start": "21880",
    "end": "28960"
  },
  {
    "text": "project hey everyone my name is Priyanka sagu um I work at Souza as a kubernetes",
    "start": "28960",
    "end": "36040"
  },
  {
    "text": "integration engineer I also do a few things in the Upstream communities project currently I'm a technical lead",
    "start": "36040",
    "end": "42520"
  },
  {
    "text": "for special interest group contributor experience a get a adadmin for the kubernetes and sub project ORS I'm also",
    "start": "42520",
    "end": "50600"
  },
  {
    "text": "currently the release lead for kubernetes 129 and we are ready to release it on December 13th this is our",
    "start": "50600",
    "end": "57879"
  },
  {
    "text": "release logo we have some stickers for our release logo if you want uh please",
    "start": "57879",
    "end": "63600"
  },
  {
    "text": "meet us after the talk thank you there are lots of stickers catch",
    "start": "63600",
    "end": "69880"
  },
  {
    "text": "prianka after the talk uh what do we have on our agenda today we look through at the architecture of Cu Test 2 see how",
    "start": "69880",
    "end": "77759"
  },
  {
    "text": "the Upstream kubernetes project integrates with cuest 2 and prow we",
    "start": "77759",
    "end": "82840"
  },
  {
    "text": "understand how all of this fits together with a couple of in-depth demos of the Upstream project uh testing in action so",
    "start": "82840",
    "end": "90759"
  },
  {
    "text": "kubernetes end to end testing we have all our source The kubernetes Source in GitHub repos and",
    "start": "90759",
    "end": "97960"
  },
  {
    "text": "folks obviously want to improve it to add features to find bugs and so they",
    "start": "97960",
    "end": "105000"
  },
  {
    "text": "submit their own code to the project in form of full requests and uh we need to check for",
    "start": "105000",
    "end": "112520"
  },
  {
    "text": "Brokenness we need to check if the cod's all right so that's what we do uh in an",
    "start": "112520",
    "end": "118000"
  },
  {
    "text": "automated fashion so the codes taken uh the pr code along with r code is taken",
    "start": "118000",
    "end": "123320"
  },
  {
    "text": "together at a snapshot and time uh we create binaries uh based on that code and then",
    "start": "123320",
    "end": "131440"
  },
  {
    "text": "we stand up a cluster using the new code uh there testing that happens uh",
    "start": "131440",
    "end": "137280"
  },
  {
    "text": "the the new cluster then runs a series of end to end tests uh and the tests log",
    "start": "137280",
    "end": "144080"
  },
  {
    "text": "a lot of stuff that's what we get at the end result as artifacts the Clusters",
    "start": "144080",
    "end": "149440"
  },
  {
    "text": "don't down and what we have in the end is just the logs containing the test",
    "start": "149440",
    "end": "156160"
  },
  {
    "text": "results so all of this uh process that I",
    "start": "156160",
    "end": "161200"
  },
  {
    "text": "just showed you is basically uh driven by c t 2 so what is cu T 2 it's a",
    "start": "161200",
    "end": "169599"
  },
  {
    "text": "framework for deploying kubernetes clusters and executing ENT test on them",
    "start": "169599",
    "end": "175920"
  },
  {
    "text": "it helps with cluster configuration uh of of various kinds it",
    "start": "175920",
    "end": "181159"
  },
  {
    "text": "helps with endtoend testing and log collection it and then the disposal of",
    "start": "181159",
    "end": "186519"
  },
  {
    "text": "the test environments uh the the workflow uh that I just described basically comes like",
    "start": "186519",
    "end": "193040"
  },
  {
    "text": "this there is a build step uh there's a cluster configuration step like I just showed you where it builds up the",
    "start": "193040",
    "end": "198360"
  },
  {
    "text": "cluster first and then uh brings it up it then uh Cube test then runs the tests",
    "start": "198360",
    "end": "205519"
  },
  {
    "text": "that we specify and does a lot of log collection that's the test step and then disposes off the test environment by",
    "start": "205519",
    "end": "212319"
  },
  {
    "text": "bringing the cluster down cluster configuration n2n testing",
    "start": "212319",
    "end": "217400"
  },
  {
    "text": "test environment disposal that's the whole flow the architecture it's split into three",
    "start": "217400",
    "end": "224159"
  },
  {
    "text": "independent executables like three legs of a stool or a tripod uh the main boundary is q+ two that's the one we use",
    "start": "224159",
    "end": "232439"
  },
  {
    "text": "we use to uh interact with to drive the whole thing but on its own it does nothing if",
    "start": "232439",
    "end": "238640"
  },
  {
    "text": "you see uh run Cube test to and it just like says detected deployers nothing",
    "start": "238640",
    "end": "245480"
  },
  {
    "text": "detected testers nothing so those are the missing legs of the stool the second one is basically the deployer uh CU Test",
    "start": "245480",
    "end": "253640"
  },
  {
    "text": "2 is smart enough to notice if there's a file in the path that says CU test 2- deployer one it recognizes it as a",
    "start": "253640",
    "end": "261079"
  },
  {
    "text": "deployer of sorts and pick it up like over here so since we had that it's now",
    "start": "261079",
    "end": "267520"
  },
  {
    "text": "running cus 2 says there's a deployer uh over there in the highlighted portion",
    "start": "267520",
    "end": "273000"
  },
  {
    "text": "similarly we have testers of various kinds so those two uh have the similar",
    "start": "273000",
    "end": "279120"
  },
  {
    "text": "naming convention with Cube test 2- test/ whatever test the name and then",
    "start": "279120",
    "end": "284560"
  },
  {
    "text": "once all these three legs out there you can see CU test two coming and detecting the deployer and the tester that's the",
    "start": "284560",
    "end": "292400"
  },
  {
    "text": "architecture in sum here's the example you can have multiple deployers and you can have",
    "start": "292400",
    "end": "298560"
  },
  {
    "text": "multiple testers and you can mix and match the syntax of the command then",
    "start": "298560",
    "end": "304600"
  },
  {
    "text": "basically becomes you you run Cube Test 2 with the deployer you want with the tests you want and with instructions to",
    "start": "304600",
    "end": "310800"
  },
  {
    "text": "bring the cluster up and down so Cube Test 2 deployer name uh I've split this",
    "start": "310800",
    "end": "316440"
  },
  {
    "text": "thing into new lines for readability so there's up down tester test followed by the tester name and the arguments you",
    "start": "316440",
    "end": "323000"
  },
  {
    "text": "want to pass to the tester like this example uh it's basically the upen cncf",
    "start": "323000",
    "end": "329560"
  },
  {
    "text": "kubernetes test against a g gke cluster so cus 2 that's the deployer name gke we",
    "start": "329560",
    "end": "336680"
  },
  {
    "text": "bring the uh thing up and down and we are running the jeno tester uh and then",
    "start": "336680",
    "end": "342479"
  },
  {
    "text": "telling it to run conformance test the same so how uh does the Upstream project",
    "start": "342479",
    "end": "350080"
  },
  {
    "text": "uh integrate Cube test with prow take a little uh glimpse of the workflow so",
    "start": "350080",
    "end": "355440"
  },
  {
    "text": "there we have users who if if lots of You Are contrib you've contribute code",
    "start": "355440",
    "end": "361520"
  },
  {
    "text": "to the kubernetes repos and you've seen that we can do commments and so and we have also something like automated",
    "start": "361520",
    "end": "367120"
  },
  {
    "text": "commands right you can do a slash close and you can do a slash test there's a here for example we're doing a test all",
    "start": "367120",
    "end": "373800"
  },
  {
    "text": "to uh run the code uh to run a test against a code dis so all that is",
    "start": "373800",
    "end": "379120"
  },
  {
    "text": "handled by a cicd system called prow uh which mimics the the uh nature of",
    "start": "379120",
    "end": "387840"
  },
  {
    "text": "kubernetes as a whole like we have a control plane that makes all the decision decisions and the scheduling",
    "start": "387840",
    "end": "393440"
  },
  {
    "text": "and stuff and then uh Farms the work out to work on notes similarly with proud there's a service cluster which listens",
    "start": "393440",
    "end": "400919"
  },
  {
    "text": "for events and does the scheduling and uh distributes stuff and there are build clusters which then the work uh the",
    "start": "400919",
    "end": "407720"
  },
  {
    "text": "tests and the work then get carried out on so over here this the prow listening",
    "start": "407720",
    "end": "412759"
  },
  {
    "text": "it takes the event sends it to the kubernetes cluster the prow service cluster and then the then creates a prow",
    "start": "412759",
    "end": "420199"
  },
  {
    "text": "job that's scheduled on a prow build cluster let's take a look at what's happening in the build",
    "start": "420199",
    "end": "427280"
  },
  {
    "text": "cluster uh the jobs come in a pods created it for our test it pulls a",
    "start": "427280",
    "end": "434000"
  },
  {
    "text": "specific image called cubin e2e and then that is the thing that",
    "start": "434000",
    "end": "439319"
  },
  {
    "text": "pulls Cube test down and uh runs it with the arguments we",
    "start": "439319",
    "end": "444400"
  },
  {
    "text": "specify so the primary features of cube test having looked at all this is basically we got a consistent cluster",
    "start": "444400",
    "end": "451199"
  },
  {
    "text": "life cycle we know how to consistently P pull any kind of cluster up and down",
    "start": "451199",
    "end": "456280"
  },
  {
    "text": "there's decoupled implementation of deployers you can have multiple deployers you can have multiple testers",
    "start": "456280",
    "end": "461879"
  },
  {
    "text": "you can mix match them there's reproducible CI and local testing experience where the stuff that you're",
    "start": "461879",
    "end": "467199"
  },
  {
    "text": "running on your cicd system you can also get CEST to down on your system get your",
    "start": "467199",
    "end": "473720"
  },
  {
    "text": "um tester down get your deployer down and then simulate The Experience on your local machine too kind of the same and",
    "start": "473720",
    "end": "481240"
  },
  {
    "text": "it has support for bosos which is a prow plug-in which uh helps with life cycle",
    "start": "481240",
    "end": "487280"
  },
  {
    "text": "management so you don't really have to deal with uh bringing up another cluster itself it will ask for a lease for an",
    "start": "487280",
    "end": "494520"
  },
  {
    "text": "AWS service or a GK service and C course will provide it to",
    "start": "494520",
    "end": "499560"
  },
  {
    "text": "them we have bepoke deployers at present Cube test only supports gcp gke and kind",
    "start": "499560",
    "end": "506919"
  },
  {
    "text": "deployers in tree which then how does something else work like I",
    "start": "506919",
    "end": "512080"
  },
  {
    "text": "just spoke about different kinds of deployers so how does that work those are external it uh Cube test enables",
    "start": "512080",
    "end": "518518"
  },
  {
    "text": "running custom deployers for different cloud cloud platforms out of three that's how we have an AWS or Microsoft",
    "start": "518519",
    "end": "524640"
  },
  {
    "text": "deployer working you can write your own bspoke deployers uh you can learn there",
    "start": "524640",
    "end": "530800"
  },
  {
    "text": "we don't have time for that right now so if you want to learn a lot that my colleague pranka has a whole talk on it",
    "start": "530800",
    "end": "537880"
  },
  {
    "text": "over here so so you can scan this you can always get the slides later and check more out so having spoken spoken",
    "start": "537880",
    "end": "544720"
  },
  {
    "text": "about prow and and looking at looked at looked at its architecture uh let's see",
    "start": "544720",
    "end": "550000"
  },
  {
    "text": "how it works in action let's let's dive into some demos for that I'll hand it over to my colleague",
    "start": "550000",
    "end": "556120"
  },
  {
    "text": "pranka thank you Jason so here we we just learned about what is Cube test2",
    "start": "556120",
    "end": "561440"
  },
  {
    "text": "and how it comes in the picture with kues project um let's see a few jobs",
    "start": "561440",
    "end": "567000"
  },
  {
    "text": "from kubernetes project for example I'm a release lead and what matters for me is I have a green signal when I have to",
    "start": "567000",
    "end": "574000"
  },
  {
    "text": "do the release and we have jobs that gives us that signal whether our Master",
    "start": "574000",
    "end": "579480"
  },
  {
    "text": "kubernetes kubernetes branch is healthy um whatever changes that are sitting inside that Branch um are they okay to",
    "start": "579480",
    "end": "586360"
  },
  {
    "text": "ship in a sudden release so before we do that um I want to introduce you with a",
    "start": "586360",
    "end": "592800"
  },
  {
    "text": "prerequisite topic something called kuet is version markers so every single day",
    "start": "592800",
    "end": "598880"
  },
  {
    "text": "we we are receiving these hundreds of PRS from so many contributors around the",
    "start": "598880",
    "end": "603920"
  },
  {
    "text": "world and every time we receive a new change we have few jobs with few scripts",
    "start": "603920",
    "end": "610000"
  },
  {
    "text": "you can understand that keeps checking out all the code from kuet is/ kuet is",
    "start": "610000",
    "end": "615440"
  },
  {
    "text": "repository with all these changes and build artifacts out of them and when I",
    "start": "615440",
    "end": "620880"
  },
  {
    "text": "say artifacts means kuet is binaries because we want to test whatever changes",
    "start": "620880",
    "end": "626519"
  },
  {
    "text": "whatever new changes that are now added to our is/ kuet is Master Branch are",
    "start": "626519",
    "end": "631959"
  },
  {
    "text": "they actually building binaries that are not breaking any other changes so that's",
    "start": "631959",
    "end": "637920"
  },
  {
    "text": "where kubernetes version markers helps us kubernetes version markers are text",
    "start": "637920",
    "end": "643160"
  },
  {
    "text": "files uh which acts as sort of public API for accessing kubernetes builds so",
    "start": "643160",
    "end": "648279"
  },
  {
    "text": "what does this means for example I I created a PR to add some changes to",
    "start": "648279",
    "end": "654279"
  },
  {
    "text": "kubernetes SL kubernetes repo now a job or a script ran and it created a fast",
    "start": "654279",
    "end": "660680"
  },
  {
    "text": "release of kubernetes which gave me kubernetes binaries and now I'll store those binaries somewhere so that",
    "start": "660680",
    "end": "666600"
  },
  {
    "text": "whenever I want to run some test on a cluster that's built out of this new",
    "start": "666600",
    "end": "671800"
  },
  {
    "text": "binaries I can just get those binaries from some place where I've stored them",
    "start": "671800",
    "end": "677279"
  },
  {
    "text": "and in kuber's case we stored them in GCS buckets so any artifact of any",
    "start": "677279",
    "end": "683399"
  },
  {
    "text": "successful kubernetes build kubernetes fast release W which we store in Google",
    "start": "683399",
    "end": "689160"
  },
  {
    "text": "cloud storage bucket we call them kubernetes version markers here is an example for example",
    "start": "689160",
    "end": "696320"
  },
  {
    "text": "this is a screenshot or a snapshot of um a GCS bucket we use for kubernetes",
    "start": "696320",
    "end": "702839"
  },
  {
    "text": "project uh KS released if and if you see there is a uh path I am marking here K",
    "start": "702839",
    "end": "709480"
  },
  {
    "text": "has released a hyphen C inside that there is a file K stable 1. text that's",
    "start": "709480",
    "end": "715160"
  },
  {
    "text": "the file we are talking about as a is version marker what that file contain is",
    "start": "715160",
    "end": "720240"
  },
  {
    "text": "this big version this is an old example we are looking at a version marker for",
    "start": "720240",
    "end": "726000"
  },
  {
    "text": "um 126 release so how to read this version marker and what do we exactly do",
    "start": "726000",
    "end": "732480"
  },
  {
    "text": "with this version marker for what we are getting what we are seeing here is a file which just contains some version",
    "start": "732480",
    "end": "739199"
  },
  {
    "text": "but how do I get the build uh artifacts the actual kubernetes binaries which I",
    "start": "739199",
    "end": "746000"
  },
  {
    "text": "can use so what whatever version which I got from the SKS table 1.txt file there",
    "start": "746000",
    "end": "754160"
  },
  {
    "text": "is a there will also be a folder inside this SP KS released",
    "start": "754160",
    "end": "759720"
  },
  {
    "text": "/ci and that's exactly that version we got from that stable 1. txc file and",
    "start": "759720",
    "end": "765800"
  },
  {
    "text": "inside that what I see here is all the artifacts that I built from a certain",
    "start": "765800",
    "end": "772320"
  },
  {
    "text": "state of or a snapshot of ku/ kubernetes master um which one we can understand",
    "start": "772320",
    "end": "779920"
  },
  {
    "text": "that from the version marker itself so the first part of the version marker",
    "start": "779920",
    "end": "785120"
  },
  {
    "text": "126. 3 that's the base release tag Whenever there was a release for kubernetes 126. 3 patch release that's",
    "start": "785120",
    "end": "794959"
  },
  {
    "text": "the first part of that version marker on the right hand side that big um kit like number that's",
    "start": "794959",
    "end": "804720"
  },
  {
    "text": "actually the latest commit on a release Branch we are talking about 126 here so the the number the the big pattern on",
    "start": "804720",
    "end": "812120"
  },
  {
    "text": "the right hand side is the latest commit as of uh when that's this screenshot was",
    "start": "812120",
    "end": "818120"
  },
  {
    "text": "taken and the middle number is the number of commits from the current uh latest",
    "start": "818120",
    "end": "825279"
  },
  {
    "text": "commit on release 126 Branch from the time uh 1263 was cut so there are 41",
    "start": "825279",
    "end": "832959"
  },
  {
    "text": "commits between this time duration and that's what this version Market is telling okay uh this version this",
    "start": "832959",
    "end": "840360"
  },
  {
    "text": "particular uh directory in our GCS bucket contains build artifacts from",
    "start": "840360",
    "end": "845959"
  },
  {
    "text": "this particular snapshot of kubernetes / kubernetes uh repo on release 126 Branch",
    "start": "845959",
    "end": "853240"
  },
  {
    "text": "how do we do that there is a job we run so Jason introduced a bit about prow um",
    "start": "853240",
    "end": "861279"
  },
  {
    "text": "prow is a cicd tool built by kuus and it's built mostly for kuus project it's",
    "start": "861279",
    "end": "866839"
  },
  {
    "text": "now adopted by other projects as well which is is great um so we it's it you can understand it as any other CI tool",
    "start": "866839",
    "end": "873720"
  },
  {
    "text": "for example GitHub actions or gitlab we have a tool uh we have a talk from cucon",
    "start": "873720",
    "end": "879240"
  },
  {
    "text": "EU 20 uh 23 that covers entirely about how to read these jobs I'll try to",
    "start": "879240",
    "end": "884880"
  },
  {
    "text": "explain a bit here as well the first highlighted part here line number one",
    "start": "884880",
    "end": "890560"
  },
  {
    "text": "that says periodic so here we are trying to define a job kind of telling it it's",
    "start": "890560",
    "end": "895839"
  },
  {
    "text": "a periodic job it needs to run at a certain period um in line number second and fourth um I",
    "start": "895839",
    "end": "904199"
  },
  {
    "text": "am giving the name a name to this particular job I'm calling it ciet is build 126 and in line number four I'm",
    "start": "904199",
    "end": "912600"
  },
  {
    "text": "saying please run this job at every 1 hour interval line number three I missed",
    "start": "912600",
    "end": "919519"
  },
  {
    "text": "cluster KS infr prow build Jason also introduced prow U follows a model of",
    "start": "919519",
    "end": "925800"
  },
  {
    "text": "kubernetes itself which is control plane and worker plane or uh in case of prow service clusters",
    "start": "925800",
    "end": "933240"
  },
  {
    "text": "and build cluster so here we are telling and and from kuber is we know we could",
    "start": "933240",
    "end": "939120"
  },
  {
    "text": "have multiple worker nodes similarly we could have multiple build clusters in prow we are mentioning basically which",
    "start": "939120",
    "end": "945199"
  },
  {
    "text": "build cluster to use for this particular job we are uh giving it the name for that line number five um helps us to do",
    "start": "945199",
    "end": "954480"
  },
  {
    "text": "that entire thing so it is what we are doing here is we are giving some um",
    "start": "954480",
    "end": "959839"
  },
  {
    "text": "annotation here decorate set to true what this annotation does is it tells",
    "start": "959839",
    "end": "965160"
  },
  {
    "text": "prow now you need to um check out something you need we are calling it we",
    "start": "965160",
    "end": "971360"
  },
  {
    "text": "need to build kubernetes from the kubernetes / kubernetes uh master or a certain release Branch we need to uh",
    "start": "971360",
    "end": "979000"
  },
  {
    "text": "build binaries how to do that all that functionality is initiated by line number five but what needs to really",
    "start": "979000",
    "end": "986519"
  },
  {
    "text": "check out we are giving that in line number 6 to9 we are telling it please look for the GitHub or kubernetes repo",
    "start": "986519",
    "end": "994240"
  },
  {
    "text": "kubernetes and release Branch release 1.2 26 please check out the uh code from",
    "start": "994240",
    "end": "1002440"
  },
  {
    "text": "this particular kuet repo and then do something about it these are some another other set of",
    "start": "1002440",
    "end": "1009880"
  },
  {
    "text": "annotations for whenever uh we also plug in whatever we are going to see for",
    "start": "1009880",
    "end": "1015399"
  },
  {
    "text": "example whenever this job is going to run uh we need to post post the log somewhere we need to see whether the job",
    "start": "1015399",
    "end": "1021399"
  },
  {
    "text": "ran successfully or not and we show some of those statistics on a tool called",
    "start": "1021399",
    "end": "1026760"
  },
  {
    "text": "test grid and we are calling it which uh test grid dashboard and test grid tab name uh we need to that's IR relevant",
    "start": "1026760",
    "end": "1033918"
  },
  {
    "text": "for that this particular talk soil pass um labels we are also passing more",
    "start": "1033919",
    "end": "1039520"
  },
  {
    "text": "information because this job needs to run inside a kuus cluster um it needs certain credentials and when I set stuff",
    "start": "1039520",
    "end": "1047240"
  },
  {
    "text": "like three set DED enabled or preset service account these labels do add",
    "start": "1047240",
    "end": "1054400"
  },
  {
    "text": "provide some more data to our uh prow uh node I'll show that in the example right",
    "start": "1054400",
    "end": "1061360"
  },
  {
    "text": "after this finally we have the spec it is like any kubernetes port spec here we",
    "start": "1061360",
    "end": "1067080"
  },
  {
    "text": "are giving uh a image uh on line number 21 this is the image you have to use to",
    "start": "1067080",
    "end": "1072840"
  },
  {
    "text": "create a p inside container inside a communative cluster uh we are giving it",
    "start": "1072840",
    "end": "1078400"
  },
  {
    "text": "kuus CI Builder that's that's the uh image that is what we use to build",
    "start": "1078400",
    "end": "1085159"
  },
  {
    "text": "uus binaries and everything else is similar to any other kubernetes sport",
    "start": "1085159",
    "end": "1090200"
  },
  {
    "text": "spec we are setting up resources here line number 3031 we are giving it privileged",
    "start": "1090200",
    "end": "1095600"
  },
  {
    "text": "access and finally we are doing something inside that container um what",
    "start": "1095600",
    "end": "1100640"
  },
  {
    "text": "we are doing here is running a command K or KL it's a tool uh created Again by",
    "start": "1100640",
    "end": "1107760"
  },
  {
    "text": "kuus project itself for uh our release process it stands for kuber as release",
    "start": "1107760",
    "end": "1113520"
  },
  {
    "text": "um what we are doing that is exactly the tool that we use to do any releases so",
    "start": "1113520",
    "end": "1120120"
  },
  {
    "text": "even our minor releases patch releases um any other RC beta Alpha cut all those",
    "start": "1120120",
    "end": "1125679"
  },
  {
    "text": "are cut by U using this tool called Kel we also do fast releases and that's what",
    "start": "1125679",
    "end": "1131120"
  },
  {
    "text": "we are doing here um I'm just telling it KL um CI",
    "start": "1131120",
    "end": "1137320"
  },
  {
    "text": "build build the kubernetes from what we",
    "start": "1137320",
    "end": "1143000"
  },
  {
    "text": "um kind of like the code we checked out from kubernetes SL kubernetes release",
    "start": "1143000",
    "end": "1148240"
  },
  {
    "text": "126 Branch build the kubernetes binaries out of that and dump them in a bucket",
    "start": "1148240",
    "end": "1154559"
  },
  {
    "text": "which is we are telling it on line number 38 uh dump all those binaries in kuber hyund release Dev in a registry um",
    "start": "1154559",
    "end": "1162960"
  },
  {
    "text": "all the images that you are creating apart from the binaries put them in that registry and add a version marker so",
    "start": "1162960",
    "end": "1170240"
  },
  {
    "text": "whatever whatever is whatever version is created out of that particular build fast build put that version in a file",
    "start": "1170240",
    "end": "1176679"
  },
  {
    "text": "called KS hyphen stable one how all this process when that job",
    "start": "1176679",
    "end": "1182880"
  },
  {
    "text": "actually runs and inside a kuet cluster how does that look like let's see so",
    "start": "1182880",
    "end": "1188919"
  },
  {
    "text": "whenever um prow gets a trigger for that a p is created we saw the p is created",
    "start": "1188919",
    "end": "1196120"
  },
  {
    "text": "using a container image called K CI Builder we also give it some information",
    "start": "1196120",
    "end": "1202679"
  },
  {
    "text": "from where it has to check out the code so it is checking out the kubernetes / kubernetes which is it's cloning the",
    "start": "1202679",
    "end": "1208600"
  },
  {
    "text": "kubernetes kubernetes repo at release 1.26 Branch I also talked about certain uh",
    "start": "1208600",
    "end": "1215600"
  },
  {
    "text": "labels like which were U prefixed by preset so what does label do uh preset",
    "start": "1215600",
    "end": "1221960"
  },
  {
    "text": "service account when set to true it gives us this information what it's doing is it's setting up to environment",
    "start": "1221960",
    "end": "1227799"
  },
  {
    "text": "variable uh Google application credentials e2e Google application credentials some",
    "start": "1227799",
    "end": "1233080"
  },
  {
    "text": "information that's giving on wherever the cluster is going to be uh uh sorry U",
    "start": "1233080",
    "end": "1238760"
  },
  {
    "text": "it's it's giving us some information to interact to the Google uh GCS bucket",
    "start": "1238760",
    "end": "1244159"
  },
  {
    "text": "where we are going to store our build artificats um the actual Json file",
    "start": "1244159",
    "end": "1249400"
  },
  {
    "text": "service account. Json file is also added to our p as a",
    "start": "1249400",
    "end": "1254760"
  },
  {
    "text": "volume we also had another preset DED enabled that again sets another",
    "start": "1254760",
    "end": "1260240"
  },
  {
    "text": "environment variable Docker and doer enabled set to True again uh creates empty uh directory doer graph to make",
    "start": "1260240",
    "end": "1268720"
  },
  {
    "text": "sure we can um run doer inside this doer image",
    "start": "1268720",
    "end": "1274360"
  },
  {
    "text": "container and finally once our P environment is set up what we do is we",
    "start": "1274360",
    "end": "1279400"
  },
  {
    "text": "run the scr command which again we discuss it's it's going to do a fast release it's going to do um to create",
    "start": "1279400",
    "end": "1287600"
  },
  {
    "text": "it's going to create kuet binaries out of this particular clone and dump them",
    "start": "1287600",
    "end": "1293279"
  },
  {
    "text": "into a bucket KS release Dev and provide the version marker in KS hyphen stable",
    "start": "1293279",
    "end": "1299320"
  },
  {
    "text": "1.x I also talked about those um annotations we had where we were setting",
    "start": "1299320",
    "end": "1304520"
  },
  {
    "text": "test grid name or something that was but this is how uh that UI looks so if I",
    "start": "1304520",
    "end": "1311919"
  },
  {
    "text": "usually incet is cluster where all these jobs run not everyone in the community",
    "start": "1311919",
    "end": "1317039"
  },
  {
    "text": "actually hardly anyone in the community have access have admin access to those",
    "start": "1317039",
    "end": "1322799"
  },
  {
    "text": "clusters to actually go and exit inside the board and look at the logs so uh",
    "start": "1322799",
    "end": "1328679"
  },
  {
    "text": "that's not ideal we need to consume the logs to check if something failed at some point how to fix that so we use the",
    "start": "1328679",
    "end": "1336159"
  },
  {
    "text": "CI uh this user interfaces where we dump all this um logs that are coming out",
    "start": "1336159",
    "end": "1341360"
  },
  {
    "text": "from this ports U so this is one of the user interface we have called browse py class here I can see whatever happened",
    "start": "1341360",
    "end": "1348400"
  },
  {
    "text": "from the beginning of that board creation we ran that K command uh it ALS",
    "start": "1348400",
    "end": "1354919"
  },
  {
    "text": "we we had those D enable uh preset label setup so it doer and doer is also",
    "start": "1354919",
    "end": "1361559"
  },
  {
    "text": "enabled finally we we had also provided it service account label so it can see",
    "start": "1361559",
    "end": "1366880"
  },
  {
    "text": "the service account and once everything is set up it's running the KR command that's where uh we can find that",
    "start": "1366880",
    "end": "1374919"
  },
  {
    "text": "job this is a screenshot from test GR so we now know what are kubernetes",
    "start": "1374919",
    "end": "1381320"
  },
  {
    "text": "version markers how to use them how to uh use the artifacts that we built and",
    "start": "1381320",
    "end": "1386679"
  },
  {
    "text": "stored in GCS buckets to do something useful with them that's where our second examples come in we Deep dive into end",
    "start": "1386679",
    "end": "1394919"
  },
  {
    "text": "toes that's so here is another example from the kues project itself it's a",
    "start": "1394919",
    "end": "1400760"
  },
  {
    "text": "release brocking job uh which means this is going to be one of the jobs that's",
    "start": "1400760",
    "end": "1406679"
  },
  {
    "text": "going to give a CI signal whether to go ahead with any release or not um any as",
    "start": "1406679",
    "end": "1412720"
  },
  {
    "text": "in which releases also we we'll see from this particular example again going from",
    "start": "1412720",
    "end": "1417960"
  },
  {
    "text": "the first line it's a periodic job we are telling it it's going it should run at every 3 hours interval from line",
    "start": "1417960",
    "end": "1424039"
  },
  {
    "text": "number four second third is same we are setting the name of the job giving it which build cluster it needs to be",
    "start": "1424039",
    "end": "1430320"
  },
  {
    "text": "scheduled on setting up few labels for adding all those credentials and",
    "start": "1430320",
    "end": "1436200"
  },
  {
    "text": "volumes dashboard uh test grrip dashboard test scrip tab name description tells us where uh again we",
    "start": "1436200",
    "end": "1443640"
  },
  {
    "text": "can't exec inside our port in these uh kues cluster so we need to show these",
    "start": "1443640",
    "end": "1450120"
  },
  {
    "text": "logs at some place we use test grid for that and we are providing where exactly so this particular job uh data will come",
    "start": "1450120",
    "end": "1459760"
  },
  {
    "text": "on test grid dashboard conformance SW in conformance GC which particular tab would be conformance GC master and we",
    "start": "1459760",
    "end": "1466159"
  },
  {
    "text": "are giving a on line description here um we have two another annotations here",
    "start": "1466159",
    "end": "1471399"
  },
  {
    "text": "Fork per release Fork per release Replacements so kuet is does not maintain just one minor or um yeah minor",
    "start": "1471399",
    "end": "1480440"
  },
  {
    "text": "release we maintain multiple minor releases and multiple patch releases for multiple minor releases so uh this at",
    "start": "1480440",
    "end": "1488320"
  },
  {
    "text": "line number 13 and 14 we are giving that information that for every release do of",
    "start": "1488320",
    "end": "1493480"
  },
  {
    "text": "fork and replace those",
    "start": "1493480",
    "end": "1500640"
  },
  {
    "text": "placeholders again we have the spec section for what's going to be inside",
    "start": "1500640",
    "end": "1506000"
  },
  {
    "text": "this the container of this uh job we are going to build this container this time",
    "start": "1506000",
    "end": "1512120"
  },
  {
    "text": "with a new image called Cube kins e2e it's going to be relevant because this image ships with something that Jason",
    "start": "1512120",
    "end": "1519320"
  },
  {
    "text": "introduced in first part of the St um which actually is Cube test I just so I have written it there so this image",
    "start": "1519320",
    "end": "1526039"
  },
  {
    "text": "comes with Cube test too that's the tool that we use to build um binaries or",
    "start": "1526039",
    "end": "1532559"
  },
  {
    "text": "bring up a cluster then run test and bring down the cluster while collecting all the logs so this is the image uh",
    "start": "1532559",
    "end": "1538799"
  },
  {
    "text": "that ships with those tool along with other tools like gcloud and Cube CDL gcloud to talk to our GCS uh uh or gcp",
    "start": "1538799",
    "end": "1547480"
  },
  {
    "text": "buckets we we can also have these jobs running on AWS so those those other tools also ship as well Cube CTL to",
    "start": "1547480",
    "end": "1554760"
  },
  {
    "text": "interact with the new cluster whenever it comes up um and now these are the arguments so",
    "start": "1554760",
    "end": "1561080"
  },
  {
    "text": "here we are saying we are now going into the details of what kind of test is running here here we are saying um",
    "start": "1561080",
    "end": "1567679"
  },
  {
    "text": "online number 21 use the test scenario kubernetes end to end test so there is a",
    "start": "1567679",
    "end": "1572760"
  },
  {
    "text": "link at the bottom of this page G.K test.io test infra that's the repo where",
    "start": "1572760",
    "end": "1578399"
  },
  {
    "text": "all our test details that run inside this Pro prow jobs or if not all at",
    "start": "1578399",
    "end": "1583480"
  },
  {
    "text": "least some of some major uh uh bulk of those details that",
    "start": "1583480",
    "end": "1589240"
  },
  {
    "text": "actually points to other places um where our tests are stored in commun project",
    "start": "1589240",
    "end": "1594799"
  },
  {
    "text": "so we have those scenarios stored at that path and out of all those scenarios we are telling it just use the",
    "start": "1594799",
    "end": "1600799"
  },
  {
    "text": "communties end to end test and then in whenever you use the scenario",
    "start": "1600799",
    "end": "1608000"
  },
  {
    "text": "use these other different set of arguments as well to tell what uh what",
    "start": "1608000",
    "end": "1614520"
  },
  {
    "text": "you actually where you actually need to run those ENT test scenario so let's see again this in action here",
    "start": "1614520",
    "end": "1620840"
  },
  {
    "text": "we have a port we created the container using Cube test uh Cube kins n2n image",
    "start": "1620840",
    "end": "1626000"
  },
  {
    "text": "we set the uh preset service account true uh that helped us to check out",
    "start": "1626000",
    "end": "1631600"
  },
  {
    "text": "community/ test infra at master um as well as added all those",
    "start": "1631600",
    "end": "1638000"
  },
  {
    "text": "um environment variables uh service account volume similarly we gave it KS",
    "start": "1638000",
    "end": "1644080"
  },
  {
    "text": "SSH so we in this particular test uh we need uh SSH Keys we are adding with this",
    "start": "1644080",
    "end": "1649760"
  },
  {
    "text": "another um preset and that's this is where our Command is coming in the place so we",
    "start": "1649760",
    "end": "1656559"
  },
  {
    "text": "asked it to run this particular test scenario called test infra SL j/",
    "start": "1656559",
    "end": "1662039"
  },
  {
    "text": "scenario commun is N2 test what this particular python file does is it",
    "start": "1662039",
    "end": "1668519"
  },
  {
    "text": "actually creates a cube test command it all all this file does is whatever all the arguments that we provided it in",
    "start": "1668519",
    "end": "1675320"
  },
  {
    "text": "front of it use them and creates a cube test2 command for us so here uh we are",
    "start": "1675320",
    "end": "1681679"
  },
  {
    "text": "telling it use Cube test2 and use all this information that I'm giving for",
    "start": "1681679",
    "end": "1687640"
  },
  {
    "text": "example the gcp service account to interact with the gcp cluster use the provider GC so here we are saying you",
    "start": "1687640",
    "end": "1694360"
  },
  {
    "text": "need to use a deployer uh GCE deployer that means you have to bring up a cluster in Google Cloud platform um we",
    "start": "1694360",
    "end": "1702559"
  },
  {
    "text": "are giving it other settings like gcp Network do do use this configuration uh",
    "start": "1702559",
    "end": "1708880"
  },
  {
    "text": "for master images use those images or zones Etc all those information we are",
    "start": "1708880",
    "end": "1714559"
  },
  {
    "text": "providing and the service account we provided uh we that actually is used to",
    "start": "1714559",
    "end": "1720320"
  },
  {
    "text": "authenticate with gcloud we so that there is not a uh",
    "start": "1720320",
    "end": "1725360"
  },
  {
    "text": "project gcp project flag anywhere here uh when we s so we need to actually tell",
    "start": "1725360",
    "end": "1731960"
  },
  {
    "text": "it which project which GCB project you have to interact to that come that information comes from that boss course",
    "start": "1731960",
    "end": "1737840"
  },
  {
    "text": "piece uh which Jason introduced earlier on that's a lease management tool so",
    "start": "1737840",
    "end": "1743600"
  },
  {
    "text": "whenever we are running these jobs inside prow there is a lease management tool in the picture that dynamically",
    "start": "1743600",
    "end": "1749120"
  },
  {
    "text": "provides access to um these Cloud resources so in this case if gcp project",
    "start": "1749120",
    "end": "1755120"
  },
  {
    "text": "is missing Cube testu will try to get a gcp project from",
    "start": "1755120",
    "end": "1760600"
  },
  {
    "text": "bosos Once all that is done this is where our KU version markers are coming",
    "start": "1760600",
    "end": "1765720"
  },
  {
    "text": "in the picture we are telling please please don't build everything from scratch don't go and uh build whatever",
    "start": "1765720",
    "end": "1772120"
  },
  {
    "text": "uh new artifacts you have to build rather use what's coming from this",
    "start": "1772120",
    "end": "1777320"
  },
  {
    "text": "version marker so we are telling it use this CI bucket KS release Dev which we",
    "start": "1777320",
    "end": "1782559"
  },
  {
    "text": "saw and use this version marker ci/ latest fast so a note we just don't have",
    "start": "1782559",
    "end": "1787799"
  },
  {
    "text": "that stable 1.txt file alone we have more like those which contains different version markers um and uh in turn",
    "start": "1787799",
    "end": "1796519"
  },
  {
    "text": "different um uh binaries attached to them so here we are giving it another one latest",
    "start": "1796519",
    "end": "1802480"
  },
  {
    "text": "fast go and look in Gs released GCS bucket uh latest fast uh tag and then",
    "start": "1802480",
    "end": "1810039"
  },
  {
    "text": "download it from there and then basically use those",
    "start": "1810039",
    "end": "1816039"
  },
  {
    "text": "binaries to Now bring up a cluster run some test which where here we are",
    "start": "1816039",
    "end": "1821679"
  },
  {
    "text": "calling it use the Ginko U tester run conformance test and then bring it down",
    "start": "1821679",
    "end": "1827399"
  },
  {
    "text": "so what's really happening here is this is like a snapshot of kuus cluster for",
    "start": "1827399",
    "end": "1832880"
  },
  {
    "text": "example here we have a cluster here as infra end to end bosos",
    "start": "1832880",
    "end": "1838320"
  },
  {
    "text": "uh we the name of the cluster we provided in our brow job context so our",
    "start": "1838320",
    "end": "1843559"
  },
  {
    "text": "Cube cial config setex Contex is now set to that cluster we ran GCO n toest",
    "start": "1843559",
    "end": "1849440"
  },
  {
    "text": "because we asked it to use Goo provider and we are running using GCO to run some conformance test here whatever law",
    "start": "1849440",
    "end": "1857480"
  },
  {
    "text": "whatever test results are uh generated out of that particular test run we are",
    "start": "1857480",
    "end": "1862639"
  },
  {
    "text": "taking them out dumping them on a certain uh path in our container and",
    "start": "1862639",
    "end": "1868799"
  },
  {
    "text": "then bringing down the cluster because all we needed was to run some test uh and check whether those tests are good",
    "start": "1868799",
    "end": "1874559"
  },
  {
    "text": "or not to make sure these changes are uh working fine with our existing state of",
    "start": "1874559",
    "end": "1880039"
  },
  {
    "text": "communties cluster so that's what's happening and in the end these those if",
    "start": "1880039",
    "end": "1885519"
  },
  {
    "text": "if I as a known admin what is this uh if I as a non",
    "start": "1885519",
    "end": "1891799"
  },
  {
    "text": "admin have to uh check those logs I will look for them in a place like this test the link is down there it's pointing to",
    "start": "1891799",
    "end": "1898600"
  },
  {
    "text": "test grid. gats.io conformance GC conformance GC master and",
    "start": "1898600",
    "end": "1904039"
  },
  {
    "text": "that is the information we provided in annotation somewhere so that's the end of our example two demo kuet project um",
    "start": "1904039",
    "end": "1912679"
  },
  {
    "text": "now recommends using Cube Test 2 but it also had a successor before called Cube",
    "start": "1912679",
    "end": "1917720"
  },
  {
    "text": "test um that is also in use in some part of the CEST project but we are moving",
    "start": "1917720",
    "end": "1922960"
  },
  {
    "text": "towards Cube test to right now so that's just a not there uh if you want to start",
    "start": "1922960",
    "end": "1928760"
  },
  {
    "text": "using Cube Test 2 for any of uh Cube test or cube test two I Cube test to would be the",
    "start": "1928760",
    "end": "1935399"
  },
  {
    "text": "recommendation that we can't do all this testing uh",
    "start": "1935399",
    "end": "1940600"
  },
  {
    "text": "with Cube test or all this prow job testing locally uh like we do not want",
    "start": "1940600",
    "end": "1945639"
  },
  {
    "text": "to just run the test on kubernetes SL kubernetes right away uh before we do",
    "start": "1945639",
    "end": "1950720"
  },
  {
    "text": "that we want to test those changes maybe locally as well or somewhere at least so",
    "start": "1950720",
    "end": "1957760"
  },
  {
    "text": "there are some ways to test these prow jobs um one of the easiest ways pull",
    "start": "1957760",
    "end": "1963639"
  },
  {
    "text": "that Docker uh image that we we provide in our Port spec of prow job pull that",
    "start": "1963639",
    "end": "1969480"
  },
  {
    "text": "down on your local machine and then run all the commands that we provide in the command",
    "start": "1969480",
    "end": "1975279"
  },
  {
    "text": "section or there is a tool called pheno that could do the same for you you can",
    "start": "1975279",
    "end": "1980679"
  },
  {
    "text": "ask pheno uh giving it a URL of the",
    "start": "1980679",
    "end": "1985840"
  },
  {
    "text": "job from test grade like use that job but now run it locally and it will do it",
    "start": "1985840",
    "end": "1992159"
  },
  {
    "text": "for you it will look at the ports spec um it will fetch that image down for you",
    "start": "1992159",
    "end": "1997639"
  },
  {
    "text": "and run keep prompting you to provide um information like gcp project or gcp gcp",
    "start": "1997639",
    "end": "2004240"
  },
  {
    "text": "service account so it will it will do the manual uh handling but that's not always possible because not not everyone",
    "start": "2004240",
    "end": "2012360"
  },
  {
    "text": "of us has access to these um cloud service account the best thing at least",
    "start": "2012360",
    "end": "2018480"
  },
  {
    "text": "um not the best but what we usually do in commun is Project is we actually just",
    "start": "2018480",
    "end": "2025120"
  },
  {
    "text": "PR the submit uh prow jobs on uh this repo called ku/ test Anda which is the",
    "start": "2025120",
    "end": "2031399"
  },
  {
    "text": "home for all our other prow jobs for project you PR it there and it can then",
    "start": "2031399",
    "end": "2036559"
  },
  {
    "text": "run inside the pr and you can check whether this job is running or not and based on that merge",
    "start": "2036559",
    "end": "2044039"
  },
  {
    "text": "it or make changes the conclusion here is um cube",
    "start": "2044039",
    "end": "2050599"
  },
  {
    "text": "test2 is a tool that can allow to qualify your entire kubernetes cluster life cycle from building up the cluster",
    "start": "2050599",
    "end": "2058240"
  },
  {
    "text": "from uh actually building the binaries then using those binaries with all these changes that are coming from different",
    "start": "2058240",
    "end": "2064480"
  },
  {
    "text": "places um uh yeah to bring up a cluster run some",
    "start": "2064480",
    "end": "2070440"
  },
  {
    "text": "test on them uh bring the cluster down because we do not want to keep our course running upwards um use those logs",
    "start": "2070440",
    "end": "2078118"
  },
  {
    "text": "that are generated from the test durations to take a call that could be anything we use those um those test",
    "start": "2078119",
    "end": "2086200"
  },
  {
    "text": "statistics to make a many many sort of decisions for example to uh to create a",
    "start": "2086200",
    "end": "2091760"
  },
  {
    "text": "CI signal whether we should go ahead with a release or not or maybe whether tomorrow a PR or not that was our first",
    "start": "2091760",
    "end": "2098720"
  },
  {
    "text": "example and with that we are at the end of our talk um if you want to try Cube",
    "start": "2098720",
    "end": "2104160"
  },
  {
    "text": "test room that's in s.k. i/c test2 we have a few inry Cloud providers there um",
    "start": "2104160",
    "end": "2111280"
  },
  {
    "text": "kind which would be the easiest one if you want to just get started uh GC GK also comes with that and there are few",
    "start": "2111280",
    "end": "2118040"
  },
  {
    "text": "out uh of three providers for aure and I believe um AWS so if you want to try",
    "start": "2118040",
    "end": "2126400"
  },
  {
    "text": "using those that's also an option and if you want to build a cube test to deployer of your own uh there was",
    "start": "2126400",
    "end": "2132240"
  },
  {
    "text": "another talk in the middle of the slides if you want to talk to people who have built Cube testu the place would be Sig",
    "start": "2132240",
    "end": "2139920"
  },
  {
    "text": "uh testing Sig KES infra on kubernetes slack that is slack. gats.io",
    "start": "2139920",
    "end": "2145680"
  },
  {
    "text": "um we speakers are available at pagu and Jason branza as well uh as on the same",
    "start": "2145680",
    "end": "2151160"
  },
  {
    "text": "slack slack. ks. and that's those are our emails um any questions",
    "start": "2151160",
    "end": "2158040"
  },
  {
    "text": "I need we're at time actually overtime and we're on break no time for questions now uh coffee break and we'll be back in",
    "start": "2158040",
    "end": "2165800"
  },
  {
    "text": "20 minutes thank you",
    "start": "2165800",
    "end": "2172560"
  }
]