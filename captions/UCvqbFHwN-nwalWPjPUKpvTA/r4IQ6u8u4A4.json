[
  {
    "text": "hi everyone I'm Andy I'm a software engineer on mines team and I'm also very excited to be here especially since it's",
    "start": "0",
    "end": "6420"
  },
  {
    "text": "my first ever cubecon together we are going to take you through our journey of improving the",
    "start": "6420",
    "end": "12900"
  },
  {
    "text": "life cycle management and provisioning of add-ons across thousands of eks clusters in hyperforce",
    "start": "12900",
    "end": "19440"
  },
  {
    "text": "using Argo workflows a little about Salesforce we are proud",
    "start": "19440",
    "end": "26279"
  },
  {
    "text": "to be the number one CRM company we are also now the world's largest Enterprise apps company",
    "start": "26279",
    "end": "32940"
  },
  {
    "text": "in addition to being a category leader we are also a leader in philanthropy addition Innovation and culture",
    "start": "32940",
    "end": "40980"
  },
  {
    "text": "we believe that business is the greatest platform for Change and one of the ways we use our platform for change is",
    "start": "40980",
    "end": "47399"
  },
  {
    "text": "through our 111 philanthropy model where we pledge one percent of our time equity and product to giving back to our",
    "start": "47399",
    "end": "55620"
  },
  {
    "text": "communities a little about Salesforce and hyperforce",
    "start": "55620",
    "end": "61199"
  },
  {
    "text": "you'll hear this word a lot in the next in the lot in the rest of the slides",
    "start": "61199",
    "end": "66320"
  },
  {
    "text": "hyperforces are trusted Cloud platform it is the infrastructure built in public",
    "start": "66320",
    "end": "71460"
  },
  {
    "text": "Cloud which is the foundation of everything we do on Salesforce I propose is secure by default",
    "start": "71460",
    "end": "79020"
  },
  {
    "text": "and it provides comprehensive privacy standards that help you get control and",
    "start": "79020",
    "end": "84840"
  },
  {
    "text": "transparency of your customers data a little introduction about our team we",
    "start": "84840",
    "end": "91979"
  },
  {
    "text": "are the hyperforce kubernetes platform team we provide a multi substrate and",
    "start": "91979",
    "end": "97259"
  },
  {
    "text": "completely manage kubernetes platform integrated with the rest of the Salesforce infrastructure",
    "start": "97259",
    "end": "104360"
  },
  {
    "text": "our value propositions are we provide 24 7 support for our clusters and",
    "start": "104460",
    "end": "109500"
  },
  {
    "text": "Integrations we manage all of the Salesforce infrastructure Integrations into kubernetes including certifying a new",
    "start": "109500",
    "end": "116640"
  },
  {
    "text": "release continuous synthetic monitoring and safe rollout",
    "start": "116640",
    "end": "121799"
  },
  {
    "text": "maintaining trust is our number one value at Salesforce we help maintain security and Trust by running the most",
    "start": "121799",
    "end": "129000"
  },
  {
    "text": "up-to-date secure and patched version of kubernetes in hyperforce including",
    "start": "129000",
    "end": "134640"
  },
  {
    "text": "integration versions by solving problems centrally in a",
    "start": "134640",
    "end": "139680"
  },
  {
    "text": "platform we avoid dedicated cluster management head count which based on an internal surveys",
    "start": "139680",
    "end": "146760"
  },
  {
    "text": "around one and a half Engineers per service team on an average",
    "start": "146760",
    "end": "152360"
  },
  {
    "text": "our mission is to allow service owners which are other team members team",
    "start": "152520",
    "end": "157920"
  },
  {
    "text": "at Salesforce to focus on the unique value of their services without having to focus on",
    "start": "157920",
    "end": "163739"
  },
  {
    "text": "infrastructure this increases developer agility while decreasing operational cost and",
    "start": "163739",
    "end": "170160"
  },
  {
    "text": "complexity as a result we need an efficient scalable and resilient system for",
    "start": "170160",
    "end": "176580"
  },
  {
    "text": "managing our clusters and cluster components to achieve our mission so what are add-ons",
    "start": "176580",
    "end": "183540"
  },
  {
    "text": "add-ons or kubernetes Integrations in our internal terminology are the glue",
    "start": "183540",
    "end": "189120"
  },
  {
    "text": "that makes these Integrations possible their sales for specific services that",
    "start": "189120",
    "end": "195720"
  },
  {
    "text": "are running in every hyperforce cluster some examples are mutating web hooks for",
    "start": "195720",
    "end": "201659"
  },
  {
    "text": "injecting sidecars for certificate management and secret rotation demon set",
    "start": "201659",
    "end": "207420"
  },
  {
    "text": "pods for logging and metrics and controllers for patching nodes we have around 19 total Integrations and the",
    "start": "207420",
    "end": "214800"
  },
  {
    "text": "list is increasing we chose the name add-ons for this talk",
    "start": "214800",
    "end": "220080"
  },
  {
    "text": "because it's a more well-known term but this should not be confused with eks add-ons as shown on the right",
    "start": "220080",
    "end": "227340"
  },
  {
    "text": "in the rest of the presentation we are going to continue to use the word add-ons to mean kubernetes Integrations",
    "start": "227340",
    "end": "232799"
  },
  {
    "text": "as defined in this slide",
    "start": "232799",
    "end": "236599"
  },
  {
    "text": "as in Industry we all want clusters as cattles but how many of us have been able to",
    "start": "239700",
    "end": "245940"
  },
  {
    "text": "realize that dream clusters as cattle make sense for certain scenarios",
    "start": "245940",
    "end": "252480"
  },
  {
    "text": "but there are gaps in our tooling in our CNC of landscape",
    "start": "252480",
    "end": "257699"
  },
  {
    "text": "that enables many large organizations to run clusters as pets",
    "start": "257699",
    "end": "263220"
  },
  {
    "text": "not smaller clusters not bigger but average sized and thousands of them",
    "start": "263220",
    "end": "270740"
  },
  {
    "text": "in order to manage these large number of pets we need to improve the life cycle management of these clusters and the",
    "start": "270900",
    "end": "278400"
  },
  {
    "text": "add-ons deployed on these clusters at scale that is the growth phase our team is in to support the next phase of our",
    "start": "278400",
    "end": "285660"
  },
  {
    "text": "business goals we're going to focus on add-ons today which the stock is about",
    "start": "285660",
    "end": "293040"
  },
  {
    "text": "add-ons need to be updated by their service owners and rolled out to thousands of clusters",
    "start": "293040",
    "end": "299520"
  },
  {
    "text": "how do you do that efficiently by making the add-on owners Happy by",
    "start": "299520",
    "end": "305040"
  },
  {
    "text": "improving the developer experience of these add-on owners by giving them a faster Inner Loop and a faster and more",
    "start": "305040",
    "end": "311699"
  },
  {
    "text": "reliable deployment Pipelines in our industry we talk about service",
    "start": "311699",
    "end": "317639"
  },
  {
    "text": "ownership and production workloads but we rarely talk about the CD pipelines that deliver these workloads to",
    "start": "317639",
    "end": "323940"
  },
  {
    "text": "production we need to start treating these CD pipelines as production workloads itself",
    "start": "323940",
    "end": "329580"
  },
  {
    "text": "and the CD pipelines that deliver add-ons to our clusters are no different we need",
    "start": "329580",
    "end": "336600"
  },
  {
    "text": "to measure their slis and optimize and simplify them",
    "start": "336600",
    "end": "341820"
  },
  {
    "text": "so that they meet their slo's we also need to make the task of",
    "start": "341820",
    "end": "347639"
  },
  {
    "text": "measuring the measuring and optimizing the slis of these CD pipelines that deploy these",
    "start": "347639",
    "end": "354120"
  },
  {
    "text": "add-ons Easier by taking advantage of container native workflow systems like",
    "start": "354120",
    "end": "359940"
  },
  {
    "text": "Argo workflow or tecton which are very well integrated with the rest of the cloud native ecosystem",
    "start": "359940",
    "end": "367259"
  },
  {
    "text": "they are natively built to run on kubernetes and can take advantage of all",
    "start": "367259",
    "end": "372360"
  },
  {
    "text": "of its features lastly as the number of clusters keep",
    "start": "372360",
    "end": "379320"
  },
  {
    "text": "increasing with business demand Central CD solution is not easy to scale",
    "start": "379320",
    "end": "385620"
  },
  {
    "text": "so we need to offload the last mile delivery of these per cluster add-ons",
    "start": "385620",
    "end": "390840"
  },
  {
    "text": "to a more scalable model that scales horizontally with the business demands",
    "start": "390840",
    "end": "398880"
  },
  {
    "text": "we'll be looking at our current solution from these angles for deploying add-ons",
    "start": "398880",
    "end": "405360"
  },
  {
    "text": "and then describe the solution we are embarking upon",
    "start": "405360",
    "end": "410120"
  },
  {
    "text": "this is our current system for managing clusters as pets if you took a hundred thousand foot view",
    "start": "410819",
    "end": "417720"
  },
  {
    "text": "of our deployment pipelines it would look something like that",
    "start": "417720",
    "end": "423620"
  },
  {
    "text": "infrastructure in terms of cluster and add-on version is deployed in git repos is sorry",
    "start": "423620",
    "end": "430680"
  },
  {
    "text": "declared in git repos as shown on the left Spinnaker pipelines run across thousands",
    "start": "430680",
    "end": "437819"
  },
  {
    "text": "of eks clusters to deploy these add-ons in a staggered and health mediated way",
    "start": "437819",
    "end": "444479"
  },
  {
    "text": "as shown on the right in practice this has many dimensions",
    "start": "444479",
    "end": "451139"
  },
  {
    "text": "and look something like this this is a visualization of our",
    "start": "451139",
    "end": "457860"
  },
  {
    "text": "Spinnaker pipelines used to deploy an e case clad cluster and the add-ons on top",
    "start": "457860",
    "end": "464099"
  },
  {
    "text": "of it for one environment the rectangle represents a Spinnaker Pipeline and a line represents a call to",
    "start": "464099",
    "end": "471599"
  },
  {
    "text": "another Spinnaker pipeline the nesting is deep if you were to take this picture and",
    "start": "471599",
    "end": "478800"
  },
  {
    "text": "multiply by the number of regions number of instances of those regions and the number of instances of each",
    "start": "478800",
    "end": "485940"
  },
  {
    "text": "business unit in those regions the picture easily becomes unfathomable",
    "start": "485940",
    "end": "491940"
  },
  {
    "text": "the Spinnaker UI starts to show signs of its limits here we'll be focusing on a subset of these",
    "start": "491940",
    "end": "499139"
  },
  {
    "text": "pipelines that are used to deploy add-ons now let's look at our current service",
    "start": "499139",
    "end": "507120"
  },
  {
    "text": "level indicators for these add-on Pipelines",
    "start": "507120",
    "end": "512479"
  },
  {
    "text": "the add-on owner's inner loop velocity can range anywhere from 5 minute to 30",
    "start": "514740",
    "end": "520380"
  },
  {
    "text": "minute depending on the complexity of the change and the performance of the CI CD Pipelines",
    "start": "520380",
    "end": "527100"
  },
  {
    "text": "the number of Spinnaker pipelines used to deploy these 19 add-ons",
    "start": "527100",
    "end": "533519"
  },
  {
    "text": "to a single cluster is today around 90. if you were to run these pipelines",
    "start": "533519",
    "end": "540360"
  },
  {
    "text": "across all eks clusters it would roughly take 300 000 executions",
    "start": "540360",
    "end": "546060"
  },
  {
    "text": "of these pipelines to deploy them across all environments that also gives you a hint of the number",
    "start": "546060",
    "end": "552600"
  },
  {
    "text": "of clusters it takes an hour to finish deploying all",
    "start": "552600",
    "end": "557940"
  },
  {
    "text": "add-ons to a single cluster and up to three weeks to deploy them across all",
    "start": "557940",
    "end": "565680"
  },
  {
    "text": "eks clusters in the positive case this is working so far",
    "start": "565680",
    "end": "572940"
  },
  {
    "text": "but as we continue to add more clusters we really need to improve these slis",
    "start": "572940",
    "end": "580880"
  },
  {
    "text": "let's summarize what are slis and our customers are telling us about the",
    "start": "581399",
    "end": "586680"
  },
  {
    "text": "problems we need to address in deploying these add-ons",
    "start": "586680",
    "end": "591680"
  },
  {
    "text": "the developer experience around managing add-ons is lacking in various areas",
    "start": "591720",
    "end": "597120"
  },
  {
    "text": "like no inner loop hard to learn and maintain templating",
    "start": "597120",
    "end": "604680"
  },
  {
    "text": "complex UI and and slow and complex and debugging is harder due to the sheer",
    "start": "604680",
    "end": "612420"
  },
  {
    "text": "number of pipelines and nesting we saw in the previous slides",
    "start": "612420",
    "end": "617240"
  },
  {
    "text": "we need to make our CD pipelines faster and the UI more responsive",
    "start": "617519",
    "end": "623480"
  },
  {
    "text": "and we also need to make be able to process more number of workflows at the same time to handle more clusters",
    "start": "623580",
    "end": "631700"
  },
  {
    "text": "the extensibility of Spinnaker is limited especially when we are using it to",
    "start": "632220",
    "end": "637920"
  },
  {
    "text": "deploy to a single cluster it is hard to make these pipelines",
    "start": "637920",
    "end": "643980"
  },
  {
    "text": "resilient in the face of failures especially due to the lack of any kind",
    "start": "643980",
    "end": "649019"
  },
  {
    "text": "of native retry capabilities additionally there is not enough",
    "start": "649019",
    "end": "656100"
  },
  {
    "text": "visibility for our add-on owners to debug their failures and optimize their execution times",
    "start": "656100",
    "end": "663240"
  },
  {
    "text": "quickly if we have to scale this centrally",
    "start": "663240",
    "end": "668339"
  },
  {
    "text": "managed kubernetes platform and get closer to our vision of efficiently operating",
    "start": "668339",
    "end": "675540"
  },
  {
    "text": "clusters as pets while continuing to maintain trust for our customers we",
    "start": "675540",
    "end": "682920"
  },
  {
    "text": "really need to do better in all of the above categories in the slide",
    "start": "682920",
    "end": "689660"
  },
  {
    "text": "so what is the solution to all of these problems I am going to hand it over to Andy for",
    "start": "690180",
    "end": "696600"
  },
  {
    "text": "walking us through the solution thanks Mark our solution is to offload the last mile",
    "start": "696600",
    "end": "703440"
  },
  {
    "text": "delivery of our add-on provisioning process to Argo workflows Argo workflows",
    "start": "703440",
    "end": "709079"
  },
  {
    "text": "is a container native cncf incubating workflow engine that you may have heard",
    "start": "709079",
    "end": "714180"
  },
  {
    "text": "of that some of the other talks here at kubecon as a reminder inaugle workflows each workload you're executing where",
    "start": "714180",
    "end": "721800"
  },
  {
    "text": "each execution instance is defined in a crd instance called a workflow and usually you define the reusable",
    "start": "721800",
    "end": "728540"
  },
  {
    "text": "templates or stages as I like to say for use in your workflow in other crd",
    "start": "728540",
    "end": "735240"
  },
  {
    "text": "instances called workflow templates so essentially here are Spinnaker pipelines",
    "start": "735240",
    "end": "740519"
  },
  {
    "text": "for provisioning each add-on become our goal workflows",
    "start": "740519",
    "end": "746160"
  },
  {
    "text": "um as you can see right now Spinnaker will essentially handle the add-on provisioning for each of our add-ons in",
    "start": "746160",
    "end": "754680"
  },
  {
    "text": "each of the environments for the high performance managed clusters on the bottom it'll promote it through the dev",
    "start": "754680",
    "end": "761579"
  },
  {
    "text": "environment and then through tests and then for higher environments uh what we are doing now is we have Argo workflows",
    "start": "761579",
    "end": "768899"
  },
  {
    "text": "in the mix we still use Spinnaker to trigger the provisioning process because",
    "start": "768899",
    "end": "774120"
  },
  {
    "text": "it's integrated with our internal infrastructure registry but Spinnaker",
    "start": "774120",
    "end": "779220"
  },
  {
    "text": "will hand off the workload to a Argo workflows controller running in a",
    "start": "779220",
    "end": "784320"
  },
  {
    "text": "control plane cluster per environment this has several implications the first is that we can scale across our",
    "start": "784320",
    "end": "791220"
  },
  {
    "text": "environments more effectively we even have the option to Shard up the number",
    "start": "791220",
    "end": "796320"
  },
  {
    "text": "of control plane clusters if we need to handle more pods for all the workflows",
    "start": "796320",
    "end": "802380"
  },
  {
    "text": "in the environment in workflows stages are usually run under the hood by pods the next one is that we can make use of",
    "start": "802380",
    "end": "810120"
  },
  {
    "text": "a lot of the features of our workflows to extend or improve",
    "start": "810120",
    "end": "815720"
  },
  {
    "text": "on the provisioning processes and resolving the problems that my information on the Irving slide and it",
    "start": "815720",
    "end": "822720"
  },
  {
    "text": "also helps improve our developer interloop experience as Mike mentioned because they can now use kubernetes",
    "start": "822720",
    "end": "831420"
  },
  {
    "text": "familiar kubernetes tooling to update their provisioning processes like using",
    "start": "831420",
    "end": "836579"
  },
  {
    "text": "Cube CTO to test and apply changes so let's take a closer look at this",
    "start": "836579",
    "end": "844440"
  },
  {
    "text": "slide which shows the setup in the dev environment although it also applies more broadly to our other environments",
    "start": "844440",
    "end": "850860"
  },
  {
    "text": "we have an Argo workflows controller running in a ETS cluster or shards if we",
    "start": "850860",
    "end": "856740"
  },
  {
    "text": "need them and it's tied to a Amazon RDS or Aurora DB database and S3 bucket this",
    "start": "856740",
    "end": "865440"
  },
  {
    "text": "is because our workflow stores the status of each workflow execution in the",
    "start": "865440",
    "end": "871740"
  },
  {
    "text": "status field of the crd instance so when you have a lot of particular stages or",
    "start": "871740",
    "end": "878100"
  },
  {
    "text": "clusters and add-ons they can get rather large and threatened to exceed the SCD",
    "start": "878100",
    "end": "884220"
  },
  {
    "text": "database size limit in the cluster so we use Argos in build functionality to offload",
    "start": "884220",
    "end": "890040"
  },
  {
    "text": "uh workflow statuses and archival workloads in the SQL database and S3",
    "start": "890040",
    "end": "897000"
  },
  {
    "text": "bucket is just there for any artifacts that we may need to store in the process of running a workflow",
    "start": "897000",
    "end": "903300"
  },
  {
    "text": "we have a library of workflow templates installed in the uks cluster each of",
    "start": "903300",
    "end": "908760"
  },
  {
    "text": "these defines the process for provisioning one particular add-on or defines helper functions like for",
    "start": "908760",
    "end": "914579"
  },
  {
    "text": "running Helm and terraform that can be referenced in those add-on provisioning templates",
    "start": "914579",
    "end": "921480"
  },
  {
    "text": "to actually trigger the provisioning for a particular cluster as mentioned before",
    "start": "921480",
    "end": "926639"
  },
  {
    "text": "it's still triggered by Spinnaker but Spinnaker will pass on parameters for which add-on and which cluster you need",
    "start": "926639",
    "end": "933959"
  },
  {
    "text": "to provision and provision in and Argo will construct a workflow from the templates and run terraform and Helm to",
    "start": "933959",
    "end": "942000"
  },
  {
    "text": "provision resources for that add-on in your cluster so on the next slide we see that the use",
    "start": "942000",
    "end": "949800"
  },
  {
    "text": "of workflow templates does help us with versioning our add-on provisioning processes and releases so because",
    "start": "949800",
    "end": "957060"
  },
  {
    "text": "workflow templates are yaml objects in the cluster like any other kubernetes object you can store mobile versions of",
    "start": "957060",
    "end": "964260"
  },
  {
    "text": "them and differentiate them by name for example you can suffix them with release one or release three when you submit a",
    "start": "964260",
    "end": "971880"
  },
  {
    "text": "provisioning request through Spinnaker you can choose which release is being referenced so if we usually use release",
    "start": "971880",
    "end": "977699"
  },
  {
    "text": "three but we find out there's a bug we can roll back to release two very easily by changing the reference",
    "start": "977699",
    "end": "983899"
  },
  {
    "text": "it also allows our add-on owners to more easily make changes to their",
    "start": "983899",
    "end": "990959"
  },
  {
    "text": "provisioning process as defined in their workflow templates we have a git repository where the workflow templates",
    "start": "990959",
    "end": "997500"
  },
  {
    "text": "are stored and add-on owners can check out from that get repository make",
    "start": "997500",
    "end": "1002660"
  },
  {
    "text": "changes to the definition which is just a yaml object as workflow templates are",
    "start": "1002660",
    "end": "1007880"
  },
  {
    "text": "defined and then Cube CTL apply the change name it say test for example to",
    "start": "1007880",
    "end": "1014060"
  },
  {
    "text": "differentiate it from the releases and then create a workflow that references that test template with their changes",
    "start": "1014060",
    "end": "1020120"
  },
  {
    "text": "and execute it to make sure that it passes once they're done they can push their changes back to the git repository",
    "start": "1020120",
    "end": "1027220"
  },
  {
    "text": "and submit the pr to merge it in so this is improved over our previous process",
    "start": "1027220",
    "end": "1033380"
  },
  {
    "text": "because previously add-on owners would need to either update a pipeline",
    "start": "1033380",
    "end": "1039860"
  },
  {
    "text": "template repository for Spinnaker pipelines and then wait for the changes to be generated before testing",
    "start": "1039860",
    "end": "1046100"
  },
  {
    "text": "or they would need to update it in the UI and copy their changes over and make sure nothing goes wrong in the process",
    "start": "1046100",
    "end": "1053240"
  },
  {
    "text": "so now they can just directly edit in this repository and keep detail apply",
    "start": "1053240",
    "end": "1058580"
  },
  {
    "text": "and create and don't worry we have controls in place to make sure that this testing is just in the dev environment",
    "start": "1058580",
    "end": "1064760"
  },
  {
    "text": "for these test clusters it doesn't go past that and have any security issues",
    "start": "1064760",
    "end": "1071120"
  },
  {
    "text": "from that as for why we chose Argo workflow specifically there are a number of",
    "start": "1071120",
    "end": "1077059"
  },
  {
    "text": "features some of which I'll just go over in the slide the first one is that there is overall feature parity with our",
    "start": "1077059",
    "end": "1083480"
  },
  {
    "text": "current implementation of the Spinnaker pipelines which is important for allowing us to migrate over more",
    "start": "1083480",
    "end": "1089539"
  },
  {
    "text": "smoothly and more easily are the workflows for example has support for",
    "start": "1089539",
    "end": "1095720"
  },
  {
    "text": "different stage execution ordering based on your directed acyclic graph trees or",
    "start": "1095720",
    "end": "1101000"
  },
  {
    "text": "step lists it has support for conditionals and expressions based on your input and output parameters it",
    "start": "1101000",
    "end": "1107179"
  },
  {
    "text": "supports something parallelism in case you happen to run two runs of terraform",
    "start": "1107179",
    "end": "1112400"
  },
  {
    "text": "at the same time and they can flip with each other and you don't want that and in fact it's more extensible as well",
    "start": "1112400",
    "end": "1118340"
  },
  {
    "text": "compared to our pipelines you can do things like Define a script that you want to run in the container directly in",
    "start": "1118340",
    "end": "1125840"
  },
  {
    "text": "the workflow which can help us with refactoring anything we need for better reliability and performance",
    "start": "1125840",
    "end": "1132740"
  },
  {
    "text": "and of course Argo workflows is also a kubernetes native which helps with the versioning and the testing as mentioned",
    "start": "1132740",
    "end": "1138559"
  },
  {
    "text": "earlier it's more familiar kubernetes tooling for teams like us and for add-on",
    "start": "1138559",
    "end": "1143660"
  },
  {
    "text": "owners who are familiar with kubernetes but it also means that all the workflows can natively support things like",
    "start": "1143660",
    "end": "1150679"
  },
  {
    "text": "emitting Prometheus metrics so we can get better visibility into workflow execution time or workflow error",
    "start": "1150679",
    "end": "1158240"
  },
  {
    "text": "accounts it can do things like set pod disruption budgets on particular stages",
    "start": "1158240",
    "end": "1163400"
  },
  {
    "text": "to help guard against evictions it can do things like",
    "start": "1163400",
    "end": "1168980"
  },
  {
    "text": "um the next important feature for us retry failed steps in case of transient",
    "start": "1168980",
    "end": "1174140"
  },
  {
    "text": "errors in our Spinnaker pipelines we do have a few of those and you can even extend it even more Argo has native",
    "start": "1174140",
    "end": "1181760"
  },
  {
    "text": "support for things like retrying failed steps based on the exit code of the",
    "start": "1181760",
    "end": "1187280"
  },
  {
    "text": "previous step which means we can better improve our reliability with these",
    "start": "1187280",
    "end": "1193760"
  },
  {
    "text": "extended features are the workflows also has memoization and caching support which we're working",
    "start": "1193760",
    "end": "1199940"
  },
  {
    "text": "on implementing right now to help improve our performance time which as you saw continues a little bit of",
    "start": "1199940",
    "end": "1205400"
  },
  {
    "text": "improving um foreign are the workflows also has been",
    "start": "1205400",
    "end": "1211100"
  },
  {
    "text": "immutable and has simplified nesting of all the nodes in your workflow which as",
    "start": "1211100",
    "end": "1217820"
  },
  {
    "text": "you saw was an issue with our Spinnaker pipelines when you submit a workflow to the cluster Argo will look at the",
    "start": "1217820",
    "end": "1225140"
  },
  {
    "text": "template store inside the cluster and store them in the status field of your",
    "start": "1225140",
    "end": "1230179"
  },
  {
    "text": "workflow so there'll be immutable what you expect to run when you submit the",
    "start": "1230179",
    "end": "1236059"
  },
  {
    "text": "workflow will be what's actually run as opposed to the pipelines where a change in the middle might be reflected in your",
    "start": "1236059",
    "end": "1242360"
  },
  {
    "text": "current execution and the simplified nesting is great for visibility for us by simplifying down all those child",
    "start": "1242360",
    "end": "1249679"
  },
  {
    "text": "pipelines into one easily viewable object this is combined with the UI for",
    "start": "1249679",
    "end": "1255799"
  },
  {
    "text": "us to let us see all the stages and any failures for a particular add-on in one",
    "start": "1255799",
    "end": "1261440"
  },
  {
    "text": "place and the UI also has other features that want to use like filtering out",
    "start": "1261440",
    "end": "1267620"
  },
  {
    "text": "executions by name so you can see all of the executions for one add-on in all",
    "start": "1267620",
    "end": "1275360"
  },
  {
    "text": "clusters for an environment or all add-ons for one cluster or any",
    "start": "1275360",
    "end": "1281059"
  },
  {
    "text": "combination which improves our visibility when we're doing things like releasing a new version of our add-ons",
    "start": "1281059",
    "end": "1287600"
  },
  {
    "text": "across our clusters so we're still in the process of converting all of our add-ons and",
    "start": "1287600",
    "end": "1294200"
  },
  {
    "text": "releasing this change across all of our environments but these are the preliminary results we",
    "start": "1294200",
    "end": "1301580"
  },
  {
    "text": "have so far four of our 19 add-on provisioning pipelines convert to workflows right now",
    "start": "1301580",
    "end": "1308000"
  },
  {
    "text": "and it's resulted in simplifying 35 Spinnaker pipeline executions which are",
    "start": "1308000",
    "end": "1313280"
  },
  {
    "text": "the parents and children into four article workflow executions one for each add-on which helps with performance and",
    "start": "1313280",
    "end": "1320360"
  },
  {
    "text": "with visibility a lot no need to look through child pipelines to see the entire add-on provisioning process",
    "start": "1320360",
    "end": "1326840"
  },
  {
    "text": "there's about a 20 Improvement in add-on provisioning time so far our cluster",
    "start": "1326840",
    "end": "1333320"
  },
  {
    "text": "logging and metrics shipping add-on has gone down from about 20 to 16 minutes to",
    "start": "1333320",
    "end": "1340039"
  },
  {
    "text": "provision it in a new cluster and there's about a 50 Improvement in",
    "start": "1340039",
    "end": "1346460"
  },
  {
    "text": "the Inner Loop velocity for making testing and pushing a change in the dev environment due to the pipeline",
    "start": "1346460",
    "end": "1353120"
  },
  {
    "text": "templating versus Cube CTO and yaml changing flow that I mentioned earlier",
    "start": "1353120",
    "end": "1358940"
  },
  {
    "text": "so we're still converting the rest of our add-ons and promoting across all of our environments and we'll keep",
    "start": "1358940",
    "end": "1363980"
  },
  {
    "text": "measuring and looking for errors to improve as we do that but now I want to hand it back to Mike",
    "start": "1363980",
    "end": "1369740"
  },
  {
    "text": "to describe some of our overall learnings from this process thanks Andy for zooming in into our our Google",
    "start": "1369740",
    "end": "1376940"
  },
  {
    "text": "workflow based add-on pipelines and sharing some early results they definitely look promising",
    "start": "1376940",
    "end": "1384340"
  },
  {
    "text": "as promised in our abstract I wanted to summarize the steps that we are taking",
    "start": "1384380",
    "end": "1390080"
  },
  {
    "text": "to enable offloading of add-on provisioning for each e case cluster to",
    "start": "1390080",
    "end": "1396559"
  },
  {
    "text": "our goal you can consider this as a recipe for enabling similar scenarios in your",
    "start": "1396559",
    "end": "1402799"
  },
  {
    "text": "organization we first enabled Argo workflow",
    "start": "1402799",
    "end": "1407860"
  },
  {
    "text": "controller provisioning in each environment using Spinnaker",
    "start": "1407860",
    "end": "1415960"
  },
  {
    "text": "we also enabled archival and offloading for Argo workflow crd status to Aurora",
    "start": "1416299",
    "end": "1423919"
  },
  {
    "text": "DB for scaling purposes and for hcd's limits as Andy mentioned earlier",
    "start": "1423919",
    "end": "1431059"
  },
  {
    "text": "in order for our control plane clusters to be able to deploy terraform and help",
    "start": "1431059",
    "end": "1436400"
  },
  {
    "text": "to various other clusters in each environment we had to enable trust and permissions",
    "start": "1436400",
    "end": "1442880"
  },
  {
    "text": "for our control plane cluster and we also had to take security approval and fix any bugs that were",
    "start": "1442880",
    "end": "1451700"
  },
  {
    "text": "found in that process we haven't enabled sharding yet because",
    "start": "1451700",
    "end": "1457940"
  },
  {
    "text": "our back of the envelope calculation shows that a single hunt cluster can handle all the workflows for a given",
    "start": "1457940",
    "end": "1465140"
  },
  {
    "text": "environment but we are making sure we are we have Provisions in the architecture to easily",
    "start": "1465140",
    "end": "1471860"
  },
  {
    "text": "enable this as soon as we need it",
    "start": "1471860",
    "end": "1476860"
  },
  {
    "text": "in order to make our make the add-on owner's life easier to write and",
    "start": "1477799",
    "end": "1483799"
  },
  {
    "text": "maintain their Pipelines our platform engineering team wrote a set of workflow templates",
    "start": "1483799",
    "end": "1491360"
  },
  {
    "text": "a reusable workflow templates that we identified for the most common scenarios and made them available to our add-on",
    "start": "1491360",
    "end": "1499220"
  },
  {
    "text": "owners as a library at this point we were ready to start",
    "start": "1499220",
    "end": "1505460"
  },
  {
    "text": "asking our add-on owners to begin converting the Spinnaker pipelines to workflows templates",
    "start": "1505460",
    "end": "1512240"
  },
  {
    "text": "in order to provide an example and a conversion guide we even took the work",
    "start": "1512240",
    "end": "1518780"
  },
  {
    "text": "for one add-on owners on ourselves and finished the conversion and provided",
    "start": "1518780",
    "end": "1524179"
  },
  {
    "text": "that as an example for other add-on owners to follow",
    "start": "1524179",
    "end": "1529000"
  },
  {
    "text": "one key thing that required our Spinnaker team's help was to integrate",
    "start": "1529460",
    "end": "1535039"
  },
  {
    "text": "Argo workflow processing into Spinnaker Spinnaker already knows how to deploy",
    "start": "1535039",
    "end": "1541400"
  },
  {
    "text": "Health charts and Argo workflow templates are just another hand chart but Spinnaker also needs to know when",
    "start": "1541400",
    "end": "1548600"
  },
  {
    "text": "the Argo workflow template processing is complete so that it and whether it failed or succeeded so that it can",
    "start": "1548600",
    "end": "1555320"
  },
  {
    "text": "decide whether to move on to the next Pinnacle stage or or halt",
    "start": "1555320",
    "end": "1561100"
  },
  {
    "text": "this process was completed and we are trying to use now",
    "start": "1561260",
    "end": "1567440"
  },
  {
    "text": "we are also working on creating graphina dashboards for measuring per stage and",
    "start": "1567440",
    "end": "1573380"
  },
  {
    "text": "per workflow metrics so that we can give our add-on owners an",
    "start": "1573380",
    "end": "1578720"
  },
  {
    "text": "easy way to develop iterate and optimize their workflows",
    "start": "1578720",
    "end": "1585460"
  },
  {
    "text": "the last two are very much work in early stages of the project but we",
    "start": "1585679",
    "end": "1592100"
  },
  {
    "text": "we demands opportunity to optimize and scale each workflows",
    "start": "1592100",
    "end": "1597860"
  },
  {
    "text": "since each workplace essentially just a kubernetes powered so for example you",
    "start": "1597860",
    "end": "1603200"
  },
  {
    "text": "can give more resources to a pipeline or a workflow executing an Argo or execute",
    "start": "1603200",
    "end": "1608960"
  },
  {
    "text": "them with higher priority or not execute already evaluated",
    "start": "1608960",
    "end": "1614240"
  },
  {
    "text": "executions or if you have identified there are certain special pipelines that need special",
    "start": "1614240",
    "end": "1621080"
  },
  {
    "text": "processing you can isolate the execution of these workflows to special note pools or instance types",
    "start": "1621080",
    "end": "1630158"
  },
  {
    "text": "the last one is we've already talked about the native",
    "start": "1632600",
    "end": "1638480"
  },
  {
    "text": "scaling due to your resource and priority there are many more steps we have not",
    "start": "1638480",
    "end": "1643700"
  },
  {
    "text": "we have left out but hopefully this gives you a fair idea of what it took us to enable for a scale of R like ours and",
    "start": "1643700",
    "end": "1653120"
  },
  {
    "text": "we are barely getting started also wanted to give a summary of all the",
    "start": "1653120",
    "end": "1660860"
  },
  {
    "text": "key takeaways for us all as a community so that we can all learn from each other and grow",
    "start": "1660860",
    "end": "1667220"
  },
  {
    "text": "stronger together the first one is to focus on your organization's development experience",
    "start": "1667220",
    "end": "1674020"
  },
  {
    "text": "measure and improve your service owners experience in maintaining their service",
    "start": "1674020",
    "end": "1679600"
  },
  {
    "text": "and make it really easy to deploy them to production in a fast and reliable way",
    "start": "1679600",
    "end": "1686900"
  },
  {
    "text": "at the same time make it really hard using tooling to make mistakes for these service",
    "start": "1686900",
    "end": "1693380"
  },
  {
    "text": "owners our service owners in this case are our add-on owners that's what we're doing",
    "start": "1693380",
    "end": "1699320"
  },
  {
    "text": "for them second one is treat your CD pipelines that deliver your services to different",
    "start": "1699320",
    "end": "1705020"
  },
  {
    "text": "environments as Production Services itself measure their slis publish their slos",
    "start": "1705020",
    "end": "1712159"
  },
  {
    "text": "and alert on them when they degrade or go down they're equally important assets",
    "start": "1712159",
    "end": "1717380"
  },
  {
    "text": "of your organization as you saw in our previous slides we focus on the CD pipelines that deploy",
    "start": "1717380",
    "end": "1725000"
  },
  {
    "text": "add-ons and are we are actively working on improving their slis third adopting container native",
    "start": "1725000",
    "end": "1732260"
  },
  {
    "text": "workflows engines like Argo and tecton into your existing developer tool chains",
    "start": "1732260",
    "end": "1738020"
  },
  {
    "text": "will make it easier and faster to deploy your services with confidence",
    "start": "1738020",
    "end": "1744679"
  },
  {
    "text": "you can think of these container native workflow engines as many developer Work Platforms that can",
    "start": "1744679",
    "end": "1752480"
  },
  {
    "text": "help unlock a lot of productivity for your teams as Andy showed in the previous slides we",
    "start": "1752480",
    "end": "1759500"
  },
  {
    "text": "are already seeing better execution times faster Inner Loop and a lot of",
    "start": "1759500",
    "end": "1764539"
  },
  {
    "text": "additional benefits that we could not even imagine reaping from our old system",
    "start": "1764539",
    "end": "1770419"
  },
  {
    "text": "and the last one is the service owners have widely adopted the kubernetes resource model in and",
    "start": "1770419",
    "end": "1777860"
  },
  {
    "text": "various other Cloud native open source tools for managing their workloads in production on kubernetes",
    "start": "1777860",
    "end": "1785360"
  },
  {
    "text": "their existing development tools like cube cutter Opa Helm charts are now",
    "start": "1785360",
    "end": "1792919"
  },
  {
    "text": "being leveraged for various newer scenarios like managing their CD pipelines managing different tasks that",
    "start": "1792919",
    "end": "1800419"
  },
  {
    "text": "are exposed by various kubernetes operators doing inner loop so essentially what you're doing is",
    "start": "1800419",
    "end": "1806980"
  },
  {
    "text": "meeting these developers where they already are instead of giving them new tools and",
    "start": "1806980",
    "end": "1813679"
  },
  {
    "text": "forcing them to move to proprietary Solutions",
    "start": "1813679",
    "end": "1817898"
  },
  {
    "text": "familiar industry standard tooling is easier to learn maintain and hire for",
    "start": "1818899",
    "end": "1826640"
  },
  {
    "text": "and most importantly it also improves the ecosystem",
    "start": "1826640",
    "end": "1831799"
  },
  {
    "text": "we believe that kubernetes resource model is the language that will bind the",
    "start": "1831799",
    "end": "1837020"
  },
  {
    "text": "next generation of Industry standard tooling with that I wanted to say thank we",
    "start": "1837020",
    "end": "1844159"
  },
  {
    "text": "wanted to say thank you for coming to our talk and giving us a chance to share",
    "start": "1844159",
    "end": "1849799"
  },
  {
    "text": "our journey towards a container native CD solution using Argo workflows",
    "start": "1849799",
    "end": "1855980"
  },
  {
    "text": "for where you got something useful from our talk uh we will have a QR code on the next slide where you can provide us",
    "start": "1855980",
    "end": "1861620"
  },
  {
    "text": "quick feedback so please go ahead and do that uh we'll be taking questions now and we hope that you have a great rest",
    "start": "1861620",
    "end": "1868880"
  },
  {
    "text": "of your day and a great weekend thanks everyone foreign",
    "start": "1868880",
    "end": "1874480"
  },
  {
    "text": "[Applause]",
    "start": "1875020",
    "end": "1881000"
  },
  {
    "text": "uh two questions um is there any reason you're not using Argo CD and then uh probably like apps",
    "start": "1915380",
    "end": "1922039"
  },
  {
    "text": "to your the add-ons you're deploying into the Clusters how are you guys doing the validation that they're actually healthy",
    "start": "1922039",
    "end": "1928360"
  },
  {
    "text": "I don't know if I heard the question properly but it was your first part why are we not using rocd Yeah okay or are",
    "start": "1928360",
    "end": "1936140"
  },
  {
    "text": "you just using like uh just a standard container just running Helm directly okay so yeah I think uh a lot of this is",
    "start": "1936140",
    "end": "1944179"
  },
  {
    "text": "related to how our current infrastructure is built it has a lot of",
    "start": "1944179",
    "end": "1951260"
  },
  {
    "text": "Spinnaker that is already very deeply integrated into the rest of the infrastructure",
    "start": "1951260",
    "end": "1957140"
  },
  {
    "text": "and a simpler answer might be that our",
    "start": "1957140",
    "end": "1962320"
  },
  {
    "text": "environments do not have access to git and there is a intermediate step that",
    "start": "1962320",
    "end": "1968299"
  },
  {
    "text": "happens so it is not easy to integrate Argo CD and Argo workflow just fitted",
    "start": "1968299",
    "end": "1974360"
  },
  {
    "text": "the bill in terms of like being a generic pipeline that can model whatever we were doing in Spinnaker",
    "start": "1974360",
    "end": "1981020"
  },
  {
    "text": "that does that help or",
    "start": "1981020",
    "end": "1984340"
  },
  {
    "text": "how long does it take you to migrate from some of the older workflows that the horrendous graph that we saw earlier",
    "start": "1992419",
    "end": "1999200"
  },
  {
    "text": "into the Argo workflows roughly per add-on how long does it take you all the development teams to get to ready for",
    "start": "1999200",
    "end": "2006580"
  },
  {
    "text": "production so I I think for the online ID audiences is the question how long does it take",
    "start": "2006580",
    "end": "2014200"
  },
  {
    "text": "for us to migrate the add-ons from Spinnaker to Argo workflow and reach",
    "start": "2014200",
    "end": "2019480"
  },
  {
    "text": "production yes right so I think we are very early in that stage we",
    "start": "2019480",
    "end": "2025960"
  },
  {
    "text": "haven't made it to production yet we are in Dev environments ah",
    "start": "2025960",
    "end": "2031419"
  },
  {
    "text": "we are like you said like we said we are in the process we are providing tools conversion guides and like how Andy",
    "start": "2031419",
    "end": "2039220"
  },
  {
    "text": "showed we have converted four add-ons to Spinnaker Pipelines I think",
    "start": "2039220",
    "end": "2046059"
  },
  {
    "text": "what would you say is a like after everything has been identified uh the",
    "start": "2046059",
    "end": "2051398"
  },
  {
    "text": "amount of time to just convert would probably not be more than maybe two sprints or one Sprint",
    "start": "2051399",
    "end": "2058179"
  },
  {
    "text": "yeah maybe one to two weeks but I speak as someone who's working with this a lot",
    "start": "2058179",
    "end": "2063460"
  },
  {
    "text": "I think a lot of it would probably be just from getting a bit more used to syntax versus when you've been working",
    "start": "2063460",
    "end": "2068858"
  },
  {
    "text": "with Spinnaker pipelines for however many months or years you're more familiar with that a lot of it does",
    "start": "2068859",
    "end": "2074858"
  },
  {
    "text": "translate over pretty like smoothly though so I wouldn't say",
    "start": "2074859",
    "end": "2080618"
  },
  {
    "text": "it's that much effort to get used to the syntax I think the last part is that yes",
    "start": "2080619",
    "end": "2086260"
  },
  {
    "text": "we also need to integrate this with Spinnaker and transition it while the",
    "start": "2086260",
    "end": "2092500"
  },
  {
    "text": "ship is running right so we need to migrate these add-ons from Spinnaker to Argo while the whole",
    "start": "2092500",
    "end": "2098800"
  },
  {
    "text": "ship is moving so that is going to take a few releases I believe",
    "start": "2098800",
    "end": "2104820"
  },
  {
    "text": "we're out of time feel free to follow up with speakers and",
    "start": "2107760",
    "end": "2113740"
  },
  {
    "text": "any other questions you may have um thank you everybody for coming and thank you for presenting thanks yeah I",
    "start": "2113740",
    "end": "2119680"
  },
  {
    "text": "will be hanging out around the room if you if anybody has more questions",
    "start": "2119680",
    "end": "2125520"
  },
  {
    "text": "[Applause]",
    "start": "2126160",
    "end": "2128739"
  }
]