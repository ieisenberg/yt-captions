[
  {
    "text": "okay thanks for coming who everyone's had a good coupe con when I first",
    "start": "140",
    "end": "8040"
  },
  {
    "text": "proposed this talk this was actually kind of a little bit cynical and based on the description in the schedule I've",
    "start": "8040",
    "end": "17340"
  },
  {
    "text": "changed it a little bit but I've kept the parts that I think are most applicable the people who are coming to keep con so what we're gonna cover our",
    "start": "17340",
    "end": "25830"
  },
  {
    "text": "story I work for a company called lytx and we transition to kubernetes from GCE",
    "start": "25830",
    "end": "32040"
  },
  {
    "text": "and jumped on to the gke system so this is kind of the story of how we went we",
    "start": "32040",
    "end": "37469"
  },
  {
    "text": "transitioned fro from GCE to gke and the",
    "start": "37469",
    "end": "43770"
  },
  {
    "text": "stumbling blocks that we kind of ran into along the way as you can guess from the theme of Oregon Trail",
    "start": "43770",
    "end": "50309"
  },
  {
    "text": "we ran into some issues over came from stuff and kind of ended up an interesting place that not a lot of",
    "start": "50309",
    "end": "56250"
  },
  {
    "text": "companies seem I don't think a lot of companies ended up in our position but I think we actually uncovered some cool",
    "start": "56250",
    "end": "62190"
  },
  {
    "text": "stuff along the way so Who am I my name is Josh rope oh that's actually not on",
    "start": "62190",
    "end": "67710"
  },
  {
    "text": "the slide which is great I've been doing data engineering and platform infrastructure engineering for most of",
    "start": "67710",
    "end": "74760"
  },
  {
    "text": "my short career about six years I room a gopher and I really like kubernetes I'm",
    "start": "74760",
    "end": "81060"
  },
  {
    "text": "definitely a user though I haven't contributed to core and I haven't really had the time to dive like super deep in this stuff but trying to stay up on the",
    "start": "81060",
    "end": "88950"
  },
  {
    "text": "trends and where things are going I like asking why and doing thoughtful design",
    "start": "88950",
    "end": "95340"
  },
  {
    "text": "of systems and trying to do things as good as well as possible and I don't like being woke up at 3:00 in the",
    "start": "95340",
    "end": "101220"
  },
  {
    "text": "morning when elasticsearch goes down and I like stable infrastructure platforms",
    "start": "101220",
    "end": "107880"
  },
  {
    "text": "there's primarily why I was so interested in kubernetes when it started coming on the scene a couple years ago and so stability it's a good thing",
    "start": "107880",
    "end": "117110"
  },
  {
    "text": "so the lytx story we're a customer data platform for marketers and web",
    "start": "117110",
    "end": "122909"
  },
  {
    "text": "developers we enable personalized web interactions so the classical example is",
    "start": "122909",
    "end": "132420"
  },
  {
    "text": "the recommendation engine from Amazon so you look at a page and then you see the other items that you might",
    "start": "132420",
    "end": "139050"
  },
  {
    "text": "be interested in we enable you to based on content recommendation and machine learning we enable you to create a list",
    "start": "139050",
    "end": "145950"
  },
  {
    "text": "of from we we can tailor personalized experiences to your users based on our",
    "start": "145950",
    "end": "152250"
  },
  {
    "text": "generic engine and entity resolution we were standardized on go census 0.9 so",
    "start": "152250",
    "end": "160190"
  },
  {
    "text": "we've been a go shop for a long time we have a little bit of our in Python to support and originally the first one of",
    "start": "160190",
    "end": "166560"
  },
  {
    "text": "the first things I did the company was we were on AWS we moved to Google cloud platform for because of stability and performance we started adopting a lot of",
    "start": "166560",
    "end": "174690"
  },
  {
    "text": "their technologies to replace things like kafka so the coffee was probably pub/sub casandra's place a big table",
    "start": "174690",
    "end": "181130"
  },
  {
    "text": "it's been really nice platform to build on and as far as the spectrum of",
    "start": "181130",
    "end": "186630"
  },
  {
    "text": "monolith versus micro-services we're kind of we're kind of in the middle right now we haven't gone full micro",
    "start": "186630",
    "end": "194280"
  },
  {
    "text": "service adoption but we're not we're not tied down to a single monolith so we",
    "start": "194280",
    "end": "201180"
  },
  {
    "text": "have an API tier we have a workflow management tier which we call a metaphor and then we have an event stream and I",
    "start": "201180",
    "end": "208080"
  },
  {
    "text": "we have a stream processing system that's distributed across a number of group of deployments and that does",
    "start": "208080",
    "end": "214860"
  },
  {
    "text": "energy resolution most gene learning classification in",
    "start": "214860",
    "end": "219900"
  },
  {
    "text": "real time so where we came from we were originally on saltstack and that is both powerful and terrifying",
    "start": "219900",
    "end": "228230"
  },
  {
    "text": "it's a you can take the ammo run it through a jint template and then",
    "start": "228230",
    "end": "234090"
  },
  {
    "text": "generate more gamma based on that so it's a very complex system but it is",
    "start": "234090",
    "end": "240210"
  },
  {
    "text": "pretty powerful so obviously I'm not gonna get into wive kubernetes we're at cube con we all know",
    "start": "240210",
    "end": "246330"
  },
  {
    "text": "all the great points of what kubernetes is good at but for us it was primarily the idea of going into VM management is",
    "start": "246330",
    "end": "252150"
  },
  {
    "text": "not very appealing because you have to build all these heavyweight tools around it and bird deploying a single binary so",
    "start": "252150",
    "end": "258530"
  },
  {
    "text": "building all of these using all these heavy tools to manage things like operating system kernels managing all",
    "start": "258530",
    "end": "264690"
  },
  {
    "text": "those upgrades it just is over for just trying to deploy something very simple so when we kubernetes started",
    "start": "264690",
    "end": "272009"
  },
  {
    "text": "coming on the scene we're like this is this is good because we'd played around with docker but and each one he's tried",
    "start": "272009",
    "end": "277020"
  },
  {
    "text": "to deploy just docker to production knows that that doesn't go very well so",
    "start": "277020",
    "end": "282960"
  },
  {
    "text": "the goals are moving to kubernetes we eventually want to get everything in kubernetes right now we are only about",
    "start": "282960",
    "end": "288830"
  },
  {
    "text": "we only have our own core application services in communities but we're",
    "start": "288830",
    "end": "295919"
  },
  {
    "text": "working on trying to get our other dependencies in there as well we run a few sed clusters and sed is",
    "start": "295919",
    "end": "302939"
  },
  {
    "text": "kind of a core heartbeat for our distributed distributed system mechanisms so so one complication that",
    "start": "302939",
    "end": "318029"
  },
  {
    "text": "you do kind of see and it's kind of visible on the screen is that we have a",
    "start": "318029",
    "end": "323509"
  },
  {
    "text": "deployment system called link grid which",
    "start": "323509",
    "end": "328740"
  },
  {
    "text": "can be scaled from one we we might need to have from anywhere between one to and a number of these deployments and up",
    "start": "328740",
    "end": "336029"
  },
  {
    "text": "front that creates a little bit of an issue because that means you're gonna have to define yamo or template yamo",
    "start": "336029",
    "end": "341690"
  },
  {
    "text": "declarations for these appointments from 1 to n and so I wanted to come up with a I wanted to have a good solution to",
    "start": "341690",
    "end": "347250"
  },
  {
    "text": "manage that going forward so and before we could even get to there we had to do",
    "start": "347250",
    "end": "353069"
  },
  {
    "text": "some application preparation a lot of our services were kind of built in the",
    "start": "353069",
    "end": "358740"
  },
  {
    "text": "older model where local state was available and it would be there with your surface crash and then came back up so we had a few things like both DB",
    "start": "358740",
    "end": "365520"
  },
  {
    "text": "files that were on a server and if something crashed it was checkpointing its last location and but in the",
    "start": "365520",
    "end": "372539"
  },
  {
    "text": "communities world if you kill a pod need to be able to rescheduled somewhere else and won't have that state anymore so you have to build rebuild your application",
    "start": "372539",
    "end": "379909"
  },
  {
    "text": "to accommodate that fact that persistent storage shouldn't be a thing and you should always use distributed stores",
    "start": "379909",
    "end": "385289"
  },
  {
    "text": "like GCS maybe F just something that's over the network we also really utilize",
    "start": "385289",
    "end": "391409"
  },
  {
    "text": "a lot the HTTP pre stop hook which enables us in a few cases we have",
    "start": "391409",
    "end": "396899"
  },
  {
    "text": "long-running workflows with integrations with X through external services that in the case of",
    "start": "396899",
    "end": "404659"
  },
  {
    "text": "shut down they if your we have rate limits on some of the integrations we",
    "start": "404659",
    "end": "410819"
  },
  {
    "text": "work with and if we're just like able only able to trickle data and there's no checkpointing that they allow just",
    "start": "410819",
    "end": "416610"
  },
  {
    "text": "because that our API doesn't afford it we need to be able to let that finish so the HP PT stop hook on a pod is actually",
    "start": "416610",
    "end": "422819"
  },
  {
    "text": "super useful in that case and it's been pretty rock-solid so when you request a pod to terminate it actually does wait",
    "start": "422819",
    "end": "428520"
  },
  {
    "text": "that full time because effectively the way we use it we use it opens a connection and then you just hold that",
    "start": "428520",
    "end": "433770"
  },
  {
    "text": "connection open and until you're ready to shut down you just hold it and then when you release it the pod terminates",
    "start": "433770",
    "end": "439259"
  },
  {
    "text": "and if it gets cleaned up so kubernetes doesn't hard kill it right before it",
    "start": "439259",
    "end": "444860"
  },
  {
    "text": "right when you send the stop command so this took a little while before we",
    "start": "444860",
    "end": "451620"
  },
  {
    "text": "finally got all of our services lined up to work well and the grenades deployment model once we got there though or",
    "start": "451620",
    "end": "458900"
  },
  {
    "text": "another thing we ran into was we have heterogeneous workloads so across some",
    "start": "458900",
    "end": "465960"
  },
  {
    "text": "of our workflow machines and we have like some processes that will consume",
    "start": "465960",
    "end": "471210"
  },
  {
    "text": "way more cpu than others and depending on where they get distributed to in a set of pods like there might be one",
    "start": "471210",
    "end": "479310"
  },
  {
    "text": "workload that uses a hundred percent of the CPU and for a few minutes and then shuts it down and others there might be",
    "start": "479310",
    "end": "487080"
  },
  {
    "text": "five others that don't so you can have one see one there's a there's a few",
    "start": "487080",
    "end": "494669"
  },
  {
    "text": "different vectors of resource allocation on this so",
    "start": "494669",
    "end": "500719"
  },
  {
    "text": "sorry I'm blanking right now and we have some clients which can using this we",
    "start": "505960",
    "end": "512960"
  },
  {
    "text": "have some clients which using the same workflow like an export to Facebook or something might or bigquery is a good",
    "start": "512960",
    "end": "518659"
  },
  {
    "text": "one will consume a lot of resources on that one pod if it's a smaller account it might be burst for only a little bit",
    "start": "518659",
    "end": "524900"
  },
  {
    "text": "but it's a flat distribution across a set of pods so if I mean the VM system",
    "start": "524900",
    "end": "532850"
  },
  {
    "text": "where it's hard to create and allocate VMs just because it's a little bit ops intensive and something you don't want",
    "start": "532850",
    "end": "538520"
  },
  {
    "text": "to do very often you end up having to buy more compute than you actually need so you end up in the situation where",
    "start": "538520",
    "end": "544760"
  },
  {
    "text": "you're just wasting money one of the really cool things about kubernetes is that there's a difference between what",
    "start": "544760",
    "end": "550700"
  },
  {
    "text": "you scheduled pods for and what they actually are limited to so if a pod needs to burst for a single workflow he",
    "start": "550700",
    "end": "556850"
  },
  {
    "text": "can just for simplicity's sake on the vm utilization let's say that there is one",
    "start": "556850",
    "end": "564090"
  },
  {
    "text": "[Music] there's one pod that actually is running hot",
    "start": "564090",
    "end": "569180"
  },
  {
    "text": "most of the time and let's just say hypothetically that these other ones are kind of hanging out not doing a whole lot well with kubernetes scheduler if",
    "start": "569180",
    "end": "577100"
  },
  {
    "text": "you use if you combine all those and to say like a two core machine you could schedule all of these VM all of these",
    "start": "577100",
    "end": "585500"
  },
  {
    "text": "all these pods onto the same VM and the request is the kubernetes scheduler will",
    "start": "585500",
    "end": "592760"
  },
  {
    "text": "assign all of those to one POC one will be able to schedule all of those onto one VM but they'll actually",
    "start": "592760",
    "end": "599330"
  },
  {
    "text": "be limited to there will only be limited to only running on using one core at a",
    "start": "599330",
    "end": "606470"
  },
  {
    "text": "time but if they all buffer up to the point of or if they're all limited by",
    "start": "606470",
    "end": "614480"
  },
  {
    "text": "CPU they won't be killed so they can all fight over CPU but chances are if",
    "start": "614480",
    "end": "620120"
  },
  {
    "text": "they're all running along at this average percentage usage they will",
    "start": "620120",
    "end": "625850"
  },
  {
    "text": "actually be able to fit nicely into that VM",
    "start": "625850",
    "end": "630010"
  },
  {
    "text": "so on the trail of the kubernetes obviously yeah Mille lots and lots of",
    "start": "631160",
    "end": "636740"
  },
  {
    "text": "yeah Mille I'm not the only person who thinks this and it's you know some people love yeah",
    "start": "636740",
    "end": "644180"
  },
  {
    "text": "Mille I'm on the opinion that coming from salt whitespace is difficult to",
    "start": "644180",
    "end": "651699"
  },
  {
    "text": "think about sometimes and the fact that my animal doesn't have any termination",
    "start": "651699",
    "end": "657350"
  },
  {
    "text": "characters means that you can't format it so there's a lot of times when yeah",
    "start": "657350",
    "end": "664250"
  },
  {
    "text": "mole just becomes more confusing than you would like it to be and managing",
    "start": "664250",
    "end": "671000"
  },
  {
    "text": "tons of the mo files it's like unless you have scripts to I getting I think",
    "start": "671000",
    "end": "680600"
  },
  {
    "text": "for static resources and rules like your are back consider it like your are back",
    "start": "680600",
    "end": "686000"
  },
  {
    "text": "settings and services I think it works fine because those things don't change very often but for things that you might",
    "start": "686000",
    "end": "691040"
  },
  {
    "text": "want to manage and update regularly it seems like they're or create that 1",
    "start": "691040",
    "end": "697939"
  },
  {
    "text": "to n number of I think it's a little bit problematic because your have to manage",
    "start": "697939",
    "end": "704089"
  },
  {
    "text": "it somehow so obviously helm is one of the popular",
    "start": "704089",
    "end": "709160"
  },
  {
    "text": "ya mole templating engines and that's not necessarily it like helm is a pretty",
    "start": "709160",
    "end": "714529"
  },
  {
    "text": "cool system but it's still that templating engine I think that the yeah",
    "start": "714529",
    "end": "720800"
  },
  {
    "text": "the tiller design is actually pretty good but I think we can do better than",
    "start": "720800",
    "end": "726230"
  },
  {
    "text": "yeah mo for like our own application stuff I mean now that you know it Scoob",
    "start": "726230",
    "end": "731779"
  },
  {
    "text": "con so there's a bunch of cool announcements like case on it looks pretty interesting and there's other things like compose but again you're",
    "start": "731779",
    "end": "736790"
  },
  {
    "text": "taking like a docker file and you're converting it into another type of Yambol so just as an example we can",
    "start": "736790",
    "end": "744649"
  },
  {
    "text": "actually use go-to that's out of order",
    "start": "744649",
    "end": "752120"
  },
  {
    "text": "so another option client go it's a client library it's extracted from the",
    "start": "752120",
    "end": "758269"
  },
  {
    "text": "actual kubernetes repo so it's not quite as much code that you need to import you've used it before",
    "start": "758269",
    "end": "765370"
  },
  {
    "text": "probably experience some pain it's a little bit tricky to get organized correctly the first time you set it up",
    "start": "765370",
    "end": "771140"
  },
  {
    "text": "because the dependencies are complex but it does afford some pretty cool stuff so",
    "start": "771140",
    "end": "778760"
  },
  {
    "text": "initially I jumped into it because I'm a bit of I like go more than I like gamble so I was like curious to see alright is",
    "start": "778760",
    "end": "785030"
  },
  {
    "text": "this gonna work out well and you're compiling against the kubernetes source code which is really nice because you",
    "start": "785030",
    "end": "791870"
  },
  {
    "text": "know like I would often find myself in the early days of kubernetes like",
    "start": "791870",
    "end": "796940"
  },
  {
    "text": "looking at Yamma files trying to figure out like what went where and there would be mismatched versions and examples so",
    "start": "796940",
    "end": "803150"
  },
  {
    "text": "like sometimes you'd find something that was using a certain structure a certain way and then like you have to match that up and you pretty much end up digging",
    "start": "803150",
    "end": "810320"
  },
  {
    "text": "into the code anyway so at this point it's like well if we're gonna be you have to dig into the code I don't just",
    "start": "810320",
    "end": "815480"
  },
  {
    "text": "use the code itself and one of the cool things about actually writing the",
    "start": "815480",
    "end": "821690"
  },
  {
    "text": "library is that or using client go is that when you run compile everything is",
    "start": "821690",
    "end": "827030"
  },
  {
    "text": "type checked that's really nice like you know at least when you run go build that",
    "start": "827030",
    "end": "832490"
  },
  {
    "text": "everything lines up correctly so this is kind of like an equivalency on the bots",
    "start": "832490",
    "end": "839300"
  },
  {
    "text": "on the top there is a camel definition and on the bottom there is the same thing written in specified in the in go",
    "start": "839300",
    "end": "847460"
  },
  {
    "text": "and as you can see the ml is more a little bit more concise and a little bit more readable but the verbosity of the",
    "start": "847460",
    "end": "856820"
  },
  {
    "text": "go example is very it's nice and clear we have hard typed field like name and",
    "start": "856820",
    "end": "863210"
  },
  {
    "text": "volume source which define how you need to build this structure and at any point",
    "start": "863210",
    "end": "869690"
  },
  {
    "text": "you can actually dig into these types and actually see what the documentation",
    "start": "869690",
    "end": "876350"
  },
  {
    "text": "is and how it's supposed to be used so I'm going to show you a little bit about that envious code so right here this is",
    "start": "876350",
    "end": "889010"
  },
  {
    "text": "an actual example that I've been working on for the past couple days trying to make it an example for people to start",
    "start": "889010",
    "end": "894710"
  },
  {
    "text": "using the client I go and it's just like you can just pick this pick up this library and start playing",
    "start": "894710",
    "end": "900980"
  },
  {
    "text": "around with it because everything's already vendored everything is already defined so like you can just pick this",
    "start": "900980",
    "end": "907250"
  },
  {
    "text": "up and start playing around in this packet in this git repo but in this example down here we're creating a v12",
    "start": "907250",
    "end": "915260"
  },
  {
    "text": "we an API v1 beta to deployment obviously still running into the",
    "start": "915260",
    "end": "922600"
  },
  {
    "text": "numerous number of versions in here with of kubernetes deployments but if we highlight this deployment we can see a",
    "start": "922600",
    "end": "930530"
  },
  {
    "text": "nice little structure definition pop up and then we can dive into what the type actually is so now we're actually diving",
    "start": "930530",
    "end": "937100"
  },
  {
    "text": "into the go definite or the client - go library so we've jumped into the vendor",
    "start": "937100",
    "end": "942980"
  },
  {
    "text": "folder and now we're in the type of deployment so now we can see that",
    "start": "942980",
    "end": "948410"
  },
  {
    "text": "there's four fields on this type and these are the specs so this is the deployment spec hit control dive into it",
    "start": "948410",
    "end": "956180"
  },
  {
    "text": "now we can see all of the fields on this and we get nice I mean it's code so it's",
    "start": "956180",
    "end": "963440"
  },
  {
    "text": "not like a nice HTML file it's not a nice HTML page but this is the documentation for what kubernetes is",
    "start": "963440",
    "end": "968990"
  },
  {
    "text": "actually using under the hood",
    "start": "968990",
    "end": "972850"
  },
  {
    "text": "okay so the first thing I kind of did after digging into the client - go library was I built a CLI tool just to",
    "start": "979040",
    "end": "985710"
  },
  {
    "text": "like kind of see like does this work and initially it was just like list the pods from some coop contacts so the cool",
    "start": "985710",
    "end": "993480"
  },
  {
    "text": "thing about building a CLI tool is that you use the same cube config file and you just specify at parameter and",
    "start": "993480",
    "end": "1001790"
  },
  {
    "text": "parameters to the client creation function which cube context you want to",
    "start": "1001790",
    "end": "1008660"
  },
  {
    "text": "use so if you're running a mini cube you would pass mini cube and I have an example of that later so lytx we actually started using this",
    "start": "1008660",
    "end": "1016820"
  },
  {
    "text": "to define some of our deployment objects and I actually created a superset object",
    "start": "1016820",
    "end": "1023450"
  },
  {
    "text": "on top of that called a deployment set which is effectively a specified set of deployments that all share roughly the",
    "start": "1023450",
    "end": "1029630"
  },
  {
    "text": "same type but are just like name has a separate names and separate a few",
    "start": "1029630",
    "end": "1034730"
  },
  {
    "text": "different field like metadata tags to define their role so in prod we have about ten and in",
    "start": "1034730",
    "end": "1043938"
  },
  {
    "text": "staging we have three yeah but those are very clean to create because effectively you just create a nice static function",
    "start": "1043939",
    "end": "1050059"
  },
  {
    "text": "which defines all of them so we still",
    "start": "1050059",
    "end": "1055760"
  },
  {
    "text": "use cube CTL in our deployments which is unfortunate and we'd like to live in the world where Kelsey Hightower's demos are",
    "start": "1055760",
    "end": "1061280"
  },
  {
    "text": "because those are great but we're not quite there yet rigging is a pretty limited scope it just does creation the",
    "start": "1061280",
    "end": "1072370"
  },
  {
    "text": "there are flags to mutate the types at runtime so at runtime but at creation so",
    "start": "1072370",
    "end": "1080900"
  },
  {
    "text": "we can update the number of CPUs that we want to we want all of the pods to have",
    "start": "1080900",
    "end": "1085929"
  },
  {
    "text": "reallocated to them just a few things",
    "start": "1085929",
    "end": "1092660"
  },
  {
    "text": "about if you are building a CLI make sure you specify and make sure that the",
    "start": "1092660",
    "end": "1098240"
  },
  {
    "text": "user is defining which cube context they're actually trying to use coop CTL is actually kind of loose on that which",
    "start": "1098240",
    "end": "1104120"
  },
  {
    "text": "I find surprising like you don't actually buy the context it will just use whatever you have configured and your cube config which is a little",
    "start": "1104120",
    "end": "1109340"
  },
  {
    "text": "little risky because kubernetes has never made it - I accidentally the whole cluster but",
    "start": "1109340",
    "end": "1117430"
  },
  {
    "text": "and then also December all of your all of your deployments obviously kubernetes",
    "start": "1117430",
    "end": "1127400"
  },
  {
    "text": "is moving really fast and that's great but it also means from users perspective stuff is moving really fast the things",
    "start": "1127400",
    "end": "1133580"
  },
  {
    "text": "are changing out from underneath eat regularly on the right there is a list of SIG's of special interest groups and",
    "start": "1133580",
    "end": "1139820"
  },
  {
    "text": "this only goes to see there's a lot of SIG's out there and it's hard to pay",
    "start": "1139820",
    "end": "1144860"
  },
  {
    "text": "attention to all of them things like replication controllers third-party resources those were already dead at",
    "start": "1144860",
    "end": "1150110"
  },
  {
    "text": "this point you shouldn't be using them and I know that talking to people here at coop con everyone is kind of DL des users of",
    "start": "1150110",
    "end": "1157340"
  },
  {
    "text": "kubernetes are kind of dealing with this but everyone on the everyone who's",
    "start": "1157340",
    "end": "1163430"
  },
  {
    "text": "actually building kubernetes wants to go faster like they want releases every month not every - not every few months so",
    "start": "1163430",
    "end": "1170330"
  },
  {
    "text": "we're in this like weird kind of it's described as I heard Tim Hawkins ascribe it as a u-shape we're like we're in the bottom and everybody like users want it",
    "start": "1170330",
    "end": "1177110"
  },
  {
    "text": "to go slower and the developers want to go faster and back when intrapreneurs",
    "start": "1177110",
    "end": "1182150"
  },
  {
    "text": "was on versions it was kind of the Wild West you were always in the code trying to figure out what stuff was actually doing so surviving all of these changes",
    "start": "1182150",
    "end": "1190760"
  },
  {
    "text": "the client - go library has had a rough history I started using it at the client",
    "start": "1190760",
    "end": "1195980"
  },
  {
    "text": "go version 1.4 and it was like this is kind of cool and then 1.5 come out and they created",
    "start": "1195980",
    "end": "1203270"
  },
  {
    "text": "another path for the one - five client they just shoved everything in there and then they kind of realized oh this was a",
    "start": "1203270",
    "end": "1209180"
  },
  {
    "text": "bad idea because we're just appending tons of code to the same git repo so they ripped that out in version two and",
    "start": "1209180",
    "end": "1215650"
  },
  {
    "text": "then from then on things got a little",
    "start": "1215650",
    "end": "1221390"
  },
  {
    "text": "weird you can see this matrix on the bottom right and the checkmarks are where things all just line up well so we",
    "start": "1221390",
    "end": "1229490"
  },
  {
    "text": "finally have reached a solid point with a client got the client go version 5 and",
    "start": "1229490",
    "end": "1235850"
  },
  {
    "text": "kubernetes one o date so things are actually lined up at this point which is a really nice thing and if you need to",
    "start": "1235850",
    "end": "1242630"
  },
  {
    "text": "update from 1.5 to 5 I actually have a document which I need to burn a",
    "start": "1242630",
    "end": "1247800"
  },
  {
    "text": "blog post about which is about how things change and where your things shifted around too because it definitely got weird but things are improving a lot",
    "start": "1247800",
    "end": "1255030"
  },
  {
    "text": "so from going forward I would I hope that things are stable now and it'll be them a lot simpler to upgrade so again",
    "start": "1255030",
    "end": "1265410"
  },
  {
    "text": "when you're if you decide to use client - go think a bit about your design look at how the interface is use your look at",
    "start": "1265410",
    "end": "1271920"
  },
  {
    "text": "the interfaces of the types you're going to be interacting with and think about it a little bit there's some chaining",
    "start": "1271920",
    "end": "1277140"
  },
  {
    "text": "that goes on that makes some of the client - go functions a little bit hard to use so think about it before you jump",
    "start": "1277140",
    "end": "1282540"
  },
  {
    "text": "into it vendor everything if like make sure there's no code that is coming out of",
    "start": "1282540",
    "end": "1288180"
  },
  {
    "text": "your go path and there are some issues with depth right now on Lily's talk",
    "start": "1288180",
    "end": "1294390"
  },
  {
    "text": "yesterday she mentioned that our back has a little few issues so if you try to",
    "start": "1294390",
    "end": "1300360"
  },
  {
    "text": "use our back in client in the latest version of client go there you might run",
    "start": "1300360",
    "end": "1306270"
  },
  {
    "text": "into some issues with some API versioning and that's kind of that's a bug and depth actually right now they're",
    "start": "1306270",
    "end": "1311610"
  },
  {
    "text": "trying to sort that out but be wary but also I don't again if your yam yam will",
    "start": "1311610",
    "end": "1318330"
  },
  {
    "text": "seems like the appropriate place to define our back rules don't ever mix any",
    "start": "1318330",
    "end": "1325920"
  },
  {
    "text": "other projects with the project that you're trying to build your client - go",
    "start": "1325920",
    "end": "1330960"
  },
  {
    "text": "code with because kubernetes moves so much faster so like we have like our I",
    "start": "1330960",
    "end": "1337110"
  },
  {
    "text": "tried moving client and - go into or the dependencies into our main repo and we",
    "start": "1337110",
    "end": "1344880"
  },
  {
    "text": "use a lot of Google libraries and use a lot of G RPC libraries and we also have Etsy D and all those three together just",
    "start": "1344880",
    "end": "1350610"
  },
  {
    "text": "create this massive storm justic you cannot find the resolution of libraries to make all those things work and unless",
    "start": "1350610",
    "end": "1357240"
  },
  {
    "text": "you can match the velocity of kubernetes project you're probably gonna end up caught in a difficult place and it just",
    "start": "1357240",
    "end": "1364860"
  },
  {
    "text": "you won't be able to resolve the different the dependency trees so build",
    "start": "1364860",
    "end": "1370560"
  },
  {
    "text": "your client - go library on its own project don't try and merge it in with any other projects a few things that we",
    "start": "1370560",
    "end": "1377970"
  },
  {
    "text": "used just kind of get us over the fence on to kubernetes we have a kebab we use Kabana",
    "start": "1377970",
    "end": "1386440"
  },
  {
    "text": "there we you they used to be our only source of our only log storage but there",
    "start": "1386440",
    "end": "1392889"
  },
  {
    "text": "are things like google lager to our stack driver logging technically and that is one option but the search",
    "start": "1392889",
    "end": "1399219"
  },
  {
    "text": "functionality is a little bit underwhelming and there are some nice features that people really like about",
    "start": "1399219",
    "end": "1404739"
  },
  {
    "text": "Cabana and I wanted to keep those so we actually use something that glider Labs created and I forked it and made a few",
    "start": "1404739",
    "end": "1411969"
  },
  {
    "text": "minor modifications if you are interested I would be happy to show you how to make those changes as well but",
    "start": "1411969",
    "end": "1417579"
  },
  {
    "text": "effectively it let it create a daemon set runs on every single node in your cluster reads the logs from docker and",
    "start": "1417579",
    "end": "1423489"
  },
  {
    "text": "then ships them straight to your elk that your elk cluster but you don't need",
    "start": "1423489",
    "end": "1428739"
  },
  {
    "text": "a log stash in any of this it just writes the log files directly to elasticsearch and it just requires a",
    "start": "1428739",
    "end": "1435639"
  },
  {
    "text": "simple mapping to make all that work or less urgently and I've deployed that six",
    "start": "1435639",
    "end": "1441789"
  },
  {
    "text": "months ago and I haven't had to touch it ever since so as far as software goes I'm pretty happy with that one event",
    "start": "1441789",
    "end": "1447399"
  },
  {
    "text": "logger originally logs weren't bubbled up from like the useful kubernetes events so if you do cube CTL get events",
    "start": "1447399",
    "end": "1454690"
  },
  {
    "text": "that's actually a useful stream of information to know about what your cluster is actually doing created a little tool just to read that out and",
    "start": "1454690",
    "end": "1460859"
  },
  {
    "text": "write it to logs it's actually super useful you can create metrics off of that so when pods are dying and you",
    "start": "1460859",
    "end": "1466149"
  },
  {
    "text": "don't know why or if pods are dying it's a good way to create a metric on it and then notify yes you can alert from",
    "start": "1466149",
    "end": "1475239"
  },
  {
    "text": "failures that show up in the event stream and then some simple user I we",
    "start": "1475239",
    "end": "1480519"
  },
  {
    "text": "use logger astrays on logging and then modify some simple things so that it worked well with gke logging which",
    "start": "1480519",
    "end": "1486009"
  },
  {
    "text": "virtually means you add a field and force a very first severity this is kind",
    "start": "1486009",
    "end": "1492279"
  },
  {
    "text": "of a unique one but if you use something like stats D for metrics and graphite or",
    "start": "1492279",
    "end": "1497499"
  },
  {
    "text": "carbon Prometheus is well designed in that you can take you can give it a list",
    "start": "1497499",
    "end": "1503079"
  },
  {
    "text": "of pod names as like part of the part of the path for metrics and it handles that",
    "start": "1503079",
    "end": "1509889"
  },
  {
    "text": "fine like it's it writes it correctly but if you're using an older system like carbon it writes every single metrics",
    "start": "1509889",
    "end": "1516160"
  },
  {
    "text": "path as a filesystem directory so if you use pods that will just if so if it's",
    "start": "1516160",
    "end": "1521890"
  },
  {
    "text": "using pod IDs that's just gonna explode so created a distributed effectively a",
    "start": "1521890",
    "end": "1530200"
  },
  {
    "text": "naming flattener so you can effectively share different names so something that",
    "start": "1530200",
    "end": "1540970"
  },
  {
    "text": "has a very something that as a normal pod name it has a replica set and then a",
    "start": "1540970",
    "end": "1546000"
  },
  {
    "text": "unique identifier you can squash that down to just like one and then one two three but the one pods exit then they",
    "start": "1546000",
    "end": "1552580"
  },
  {
    "text": "will release that and then someone else can claim it when then another pod starts up so you effectively recycle the",
    "start": "1552580",
    "end": "1559720"
  },
  {
    "text": "name set so the and then the advancement",
    "start": "1559720",
    "end": "1565660"
  },
  {
    "text": "of our CLI tool was something we called Ceph it's not the end goal but it's a",
    "start": "1565660",
    "end": "1572440"
  },
  {
    "text": "really useful tool for our staging environment because we do a lot of integration tests that run over like",
    "start": "1572440",
    "end": "1577570"
  },
  {
    "text": "terabytes of data and then we look at the results and make sure that things are looking correct so to facilitate",
    "start": "1577570",
    "end": "1586150"
  },
  {
    "text": "that staff actually runs that deployment set and it's a simple integration with",
    "start": "1586150",
    "end": "1591580"
  },
  {
    "text": "slack you send it an update command and then you give it the tag and it will update in this case three different",
    "start": "1591580",
    "end": "1597310"
  },
  {
    "text": "deployments with that tag and those deployments roll out all the pods and you're up and running so this was pretty",
    "start": "1597310",
    "end": "1604510"
  },
  {
    "text": "useful it provides nice visibility to our staging environment so people don't like stomp on each other and it's a nice",
    "start": "1604510",
    "end": "1610960"
  },
  {
    "text": "tool but it is again you're issuing commands it's not as clean as like something that is just reactive based on",
    "start": "1610960",
    "end": "1616750"
  },
  {
    "text": "your github like it's not something you something it is still a manual tool",
    "start": "1616750",
    "end": "1621760"
  },
  {
    "text": "effectively at this point so we want to get to the point where we're using like an operator pattern but we're not quite there yet but all the types are defined",
    "start": "1621760",
    "end": "1628720"
  },
  {
    "text": "so we are in a good position to actually move that way and this is a nice step in that direction we used slack that's a thing",
    "start": "1628720",
    "end": "1637210"
  },
  {
    "text": "slack is a difficult API to work with I would consciously",
    "start": "1637210",
    "end": "1642840"
  },
  {
    "text": "[Music] recommend putting very strong interfaces around every interaction with slack",
    "start": "1642840",
    "end": "1648710"
  },
  {
    "text": "because who knows where that API is gonna go but and it operates in its",
    "start": "1648710",
    "end": "1655840"
  },
  {
    "text": "design is very similar to helm tiller so it sits in the cluster and communicates with the master and then it we issue",
    "start": "1655840",
    "end": "1662930"
  },
  {
    "text": "commands to it so and one thing it one",
    "start": "1662930",
    "end": "1668570"
  },
  {
    "text": "nice thing about operators like that is you can apply guardrails so you can do checks on like the current",
    "start": "1668570",
    "end": "1674660"
  },
  {
    "text": "state of your application or you can do checks to the command that you just issued so validate that the image is in",
    "start": "1674660",
    "end": "1680990"
  },
  {
    "text": "has been built correctly by CI and is in the repository before you try and apply",
    "start": "1680990",
    "end": "1686030"
  },
  {
    "text": "it and then potentially take down a pod and for no good reason so with that I'm",
    "start": "1686030",
    "end": "1698660"
  },
  {
    "text": "gonna try and give a you a short demo of actually using the client - code library",
    "start": "1698660",
    "end": "1704420"
  },
  {
    "text": "to the do end and testing without having",
    "start": "1704420",
    "end": "1711080"
  },
  {
    "text": "to pass yam will file it around and cat scripts so like typically whenever I see",
    "start": "1711080",
    "end": "1717110"
  },
  {
    "text": "like some project there's like alright to do end-to-end testing you runs bash script which evals his other bash script",
    "start": "1717110",
    "end": "1723020"
  },
  {
    "text": "and then the output of that and you know that runs a bunch of coop CDL commands and applies them so one of them i what",
    "start": "1723020",
    "end": "1730160"
  },
  {
    "text": "i've been working on and committed to i think less than 40 minutes ago was this project that I'm trying to build as a",
    "start": "1730160",
    "end": "1738320"
  },
  {
    "text": "showcase for using client - go so",
    "start": "1738320",
    "end": "1742779"
  },
  {
    "text": "alright so",
    "start": "1745000",
    "end": "1748600"
  },
  {
    "text": "actually let's go to the actual test so what this test is gonna do it's going to",
    "start": "1762779",
    "end": "1769629"
  },
  {
    "text": "communicate with my local mini cube it's going to use that deployment that I",
    "start": "1769629",
    "end": "1775299"
  },
  {
    "text": "showed you earlier it's gonna call this function create the deployment structure we're going to create a connection to",
    "start": "1775299",
    "end": "1783940"
  },
  {
    "text": "mini cube and then we're going like actually this is creating the connection",
    "start": "1783940",
    "end": "1789969"
  },
  {
    "text": "we're going to create that deployment we're gonna validate that it exists",
    "start": "1789969",
    "end": "1796889"
  },
  {
    "text": "which is not very sophisticated right now but and then we're gonna delete it",
    "start": "1796889",
    "end": "1802029"
  },
  {
    "text": "afterwards so and this is all and go there's no shelling out to do this",
    "start": "1802029",
    "end": "1811019"
  },
  {
    "text": "and then we're gonna watch so there get created the deployment there is the pod and it should go to terminating pretty",
    "start": "1817360",
    "end": "1824320"
  },
  {
    "text": "soon here",
    "start": "1824320",
    "end": "1826679"
  },
  {
    "text": "we're not the demo gods are not being nice to me today oh wait no okay so it",
    "start": "1835640",
    "end": "1847220"
  },
  {
    "text": "did delete it the replica site is still going yes all",
    "start": "1847220",
    "end": "1852350"
  },
  {
    "text": "right so the replica set is still is still available so which is why it's still the pawn is still there so and I",
    "start": "1852350",
    "end": "1858650"
  },
  {
    "text": "also alias coop CDL de ktl so if that's what you're wondering what's going on",
    "start": "1858650",
    "end": "1864190"
  },
  {
    "text": "alright so that was all in go no need to shell out and use a bunch of yamo files",
    "start": "1867160",
    "end": "1873890"
  },
  {
    "text": "in coop CTL the first stuff around and check zero zero codes so using client -",
    "start": "1873890",
    "end": "1882919"
  },
  {
    "text": "co is a bit of an interesting thing because it is a lot stickier and heavier to pick up then yeah Mille because you",
    "start": "1882919",
    "end": "1888530"
  },
  {
    "text": "can just copy a whole directory of VM well and run it against your cluster and see what happens but I think it provides",
    "start": "1888530",
    "end": "1894169"
  },
  {
    "text": "a lot of insight into what is actually going on and it provides sanity for me",
    "start": "1894169",
    "end": "1899450"
  },
  {
    "text": "like when you actually can look at the fields that you're trying to use and dig",
    "start": "1899450",
    "end": "1905419"
  },
  {
    "text": "into them and see what everything is what they see all the specifications for that type I think it's really useful I",
    "start": "1905419",
    "end": "1912830"
  },
  {
    "text": "think other people should explore it and especially now that it's not there's not so much wahkeena swith versioning going",
    "start": "1912830",
    "end": "1919010"
  },
  {
    "text": "on I'm hoping from here on out we will have like complete feature sets for every release so there'll be a new client - go version which doesn't line",
    "start": "1919010",
    "end": "1925040"
  },
  {
    "text": "up numerically assembler wise but hopefully that will tie very nicely to the upcoming kubernetes releases going",
    "start": "1925040",
    "end": "1931220"
  },
  {
    "text": "forward I've been talking to a few - a few of the people working on client ochco and they sounded like hopefully",
    "start": "1931220",
    "end": "1936440"
  },
  {
    "text": "from here on out it'll be solid GK as",
    "start": "1936440",
    "end": "1942830"
  },
  {
    "text": "far as our like actual migration has been rock solid for us like upgrading has been super easy we haven't really",
    "start": "1942830",
    "end": "1951200"
  },
  {
    "text": "run into any issues like occasionally a couplet will die and in the early days I didn't really have to like go kill them",
    "start": "1951200",
    "end": "1956210"
  },
  {
    "text": "every once in a while but it's been rock solid for a long time so if you are considering GK or kubernetes manage",
    "start": "1956210",
    "end": "1964160"
  },
  {
    "text": "systems it's been pretty great for us so we eventually did make it to kubernetes",
    "start": "1964160",
    "end": "1970460"
  },
  {
    "text": "not everything went to plan we didn't if I didn't get all of our stack into kubernetes yet but elasticsearch is a",
    "start": "1970460",
    "end": "1977000"
  },
  {
    "text": "fickle Beast and we haven't quite I don't think anyone has quite figured out how to get classic search and kubernetes",
    "start": "1977000",
    "end": "1983150"
  },
  {
    "text": "in I haven't seen any like significant demos hopefully staple sets will get us there at some point but I know that",
    "start": "1983150",
    "end": "1989330"
  },
  {
    "text": "there are some memory allocation issues that gets to come up but for us",
    "start": "1989330",
    "end": "1996350"
  },
  {
    "text": "like the ability to use deployments and our stack actually fitting in deployments has been super useful alleviates a ton of burdensome operation",
    "start": "1996350",
    "end": "2003040"
  },
  {
    "text": "time to actually get get our app out there and have it resilient and like",
    "start": "2003040",
    "end": "2013330"
  },
  {
    "text": "being able to over bin pack and let kubernetes scheduler kind of handle our own scheduler scheduling issues is",
    "start": "2013330",
    "end": "2021700"
  },
  {
    "text": "really nice so we can over we can over",
    "start": "2021700",
    "end": "2027310"
  },
  {
    "text": "subscribe to our compute resources and the kubernetes scheduler allows us to",
    "start": "2027310",
    "end": "2034380"
  },
  {
    "text": "still have high availability without having to shove everything into vertical",
    "start": "2034380",
    "end": "2040470"
  },
  {
    "text": "vertically scale pods it's really nice when you're using client - go because",
    "start": "2040470",
    "end": "2046570"
  },
  {
    "text": "you only have to interact one API now you don't have to interact with it like the compute API and then the image API",
    "start": "2046570",
    "end": "2052408"
  },
  {
    "text": "[Music] for like typical cloud providers and",
    "start": "2052409",
    "end": "2058980"
  },
  {
    "text": "it's it like plant - screen was really nice so the theme of this conference has",
    "start": "2058980",
    "end": "2064658"
  },
  {
    "text": "been kubernetes is now some percentage more boring as infrastructure and hopefully won't be breaking so much going forward I'm really looking forward",
    "start": "2064659",
    "end": "2072460"
  },
  {
    "text": "to service meshes and what those will provide us because like being able the stos TLS automatic automatic encryption",
    "start": "2072460",
    "end": "2079540"
  },
  {
    "text": "of traffic is gonna be a big game changer and really nice and auto scaling",
    "start": "2079540",
    "end": "2084970"
  },
  {
    "text": "and client and cluster resizing is gonna be really nice going forward so that's",
    "start": "2084970",
    "end": "2091510"
  },
  {
    "text": "all I got thank you [Applause]",
    "start": "2091510",
    "end": "2096449"
  }
]