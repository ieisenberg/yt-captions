[
  {
    "start": "0",
    "end": "0"
  },
  {
    "text": "hi everyone um thank you for attending our talk eating your vegetables",
    "start": "1360",
    "end": "7520"
  },
  {
    "text": "how to manage 2.5 million lines of yaml my name is daniel thompson this is my",
    "start": "7520",
    "end": "12719"
  },
  {
    "text": "colleague jesse suen and we're really excited to get this talk before we dive into it",
    "start": "12719",
    "end": "18160"
  },
  {
    "text": "just a brief intro so like i said earlier i'm danny thompson i'm a software engineer at stitch if you",
    "start": "18160",
    "end": "25199"
  },
  {
    "text": "haven't heard of stitch stitch is a platform for simplifying user authentication through passwordless",
    "start": "25199",
    "end": "33200"
  },
  {
    "text": "lock-ins but before that i was working at intuit on intuit's platform team",
    "start": "33200",
    "end": "42000"
  },
  {
    "text": "and part of my responsibilities were helping developers deploy their applications onto",
    "start": "42000",
    "end": "48399"
  },
  {
    "text": "kubernetes and i'll let jesse now introduce himself hi everyone um my name is jesse suen",
    "start": "48399",
    "end": "55680"
  },
  {
    "text": "thanks for joining our talk i am a principal software engineer at intuit",
    "start": "55680",
    "end": "60800"
  },
  {
    "text": "as part of the intuit platform team and primarily i work on the argo project",
    "start": "60800",
    "end": "67760"
  },
  {
    "text": "which is a suite of kubernetes tools and controllers focused on application delivery great",
    "start": "67760",
    "end": "75759"
  },
  {
    "text": "thanks jessie so why don't you dive into it so let's start with just a single",
    "start": "75759",
    "end": "82640"
  },
  {
    "text": "kubernetes font before we get to uh 25 or sorry 2.5 million",
    "start": "82640",
    "end": "89200"
  },
  {
    "text": "so what we have here is a deployment and this deployment has a anti-affinity",
    "start": "89200",
    "end": "96000"
  },
  {
    "text": "rule that guarantees that the pods within this deployment won't be",
    "start": "96000",
    "end": "102079"
  },
  {
    "text": "scheduled on the same nodes and so what's really great about this",
    "start": "102079",
    "end": "108560"
  },
  {
    "text": "is that there's no code you need to write all of it is configured through yaml",
    "start": "108560",
    "end": "115360"
  },
  {
    "text": "we just need to hand this to kubernetes and the scheduler will figure out that work for us",
    "start": "115360",
    "end": "122640"
  },
  {
    "text": "and so as a developer this is one concern just taken off my plate however",
    "start": "122640",
    "end": "129280"
  },
  {
    "text": "that being said this yaml is also very verbose it'd be very challenging to",
    "start": "129280",
    "end": "136480"
  },
  {
    "text": "write this without uh googling the spec and um the other part is it's pretty",
    "start": "136480",
    "end": "143520"
  },
  {
    "text": "long um this yaml isn't even complete you might notice that",
    "start": "143520",
    "end": "148800"
  },
  {
    "text": "we left out parts of the selector because we couldn't fit the entire yellow on",
    "start": "148800",
    "end": "155440"
  },
  {
    "text": "this slide and so while it is challenging that kubernetes uh yemel is",
    "start": "155440",
    "end": "163440"
  },
  {
    "text": "this verbose it's almost a bit necessary for kubernetes to kind of solve",
    "start": "163440",
    "end": "169040"
  },
  {
    "text": "all the different use cases it's trying to address and so as a result us as developers",
    "start": "169040",
    "end": "177040"
  },
  {
    "text": "have to have a challenging problem of managing kubernetes files",
    "start": "177040",
    "end": "183680"
  },
  {
    "text": "and this is just one kubernetes file it's uh when you run a cluster you're",
    "start": "183680",
    "end": "190000"
  },
  {
    "text": "going to need more than just one deployment you're going to install a bunch of add-ons just as an example of",
    "start": "190000",
    "end": "196959"
  },
  {
    "text": "that here's a slide of a bunch of really popular",
    "start": "196959",
    "end": "202319"
  },
  {
    "text": "open source projects that are installed across a wide variety of clusters",
    "start": "202319",
    "end": "207840"
  },
  {
    "text": "and these add-ons are adding new functionality to uh kubernetes that's not already there",
    "start": "207840",
    "end": "215840"
  },
  {
    "text": "and helps you run a production grid cluster and this list isn't even exhaustive",
    "start": "215840",
    "end": "222159"
  },
  {
    "text": "either and so um which with each of these add-ons uh they generally",
    "start": "222159",
    "end": "228959"
  },
  {
    "text": "require modifications to get them to fit into your cluster and so that is in addition just to the",
    "start": "228959",
    "end": "236080"
  },
  {
    "text": "ammo for these add-ons you need the layer on your own tweaks to it and so",
    "start": "236080",
    "end": "244080"
  },
  {
    "text": "this as a cluster operator makes it challenging to kind of run a production grade cluster",
    "start": "244080",
    "end": "250159"
  },
  {
    "text": "because you have to manage all of these atoms and then if you think about",
    "start": "250159",
    "end": "255920"
  },
  {
    "text": "once you get to a certain scale most companies generally lean towards breaking up their clusters",
    "start": "255920",
    "end": "262720"
  },
  {
    "text": "into multiple clusters and then this problem is compounded because",
    "start": "262720",
    "end": "268080"
  },
  {
    "text": "you need to configure each of these different add-ons for each cluster",
    "start": "268080",
    "end": "276560"
  },
  {
    "text": "and with that the the point i'm trying to highlight here is that editing kubernetes yaml on",
    "start": "276560",
    "end": "283120"
  },
  {
    "text": "a micro scale of one file is challenging or has its challenges but also",
    "start": "283120",
    "end": "289360"
  },
  {
    "text": "then managing uh all of your kubernetes cmls across an entire",
    "start": "289360",
    "end": "295199"
  },
  {
    "text": "cluster and multiple clusters is also challenging and so",
    "start": "295199",
    "end": "301180"
  },
  {
    "text": "[Music] this makes it kind of challenging for",
    "start": "301180",
    "end": "306960"
  },
  {
    "text": "organizations to adopt kubernetes and we're going to talk",
    "start": "306960",
    "end": "312720"
  },
  {
    "text": "about different approaches to kind of help manage this large subset",
    "start": "312720",
    "end": "317759"
  },
  {
    "text": "of yml with that before we dive into this approaches i think it's important to touch on the",
    "start": "317759",
    "end": "325759"
  },
  {
    "start": "324000",
    "end": "324000"
  },
  {
    "text": "different considerations for the different approaches or at least",
    "start": "325759",
    "end": "331120"
  },
  {
    "text": "what you need in a configuration management system uh configuration",
    "start": "331120",
    "end": "337120"
  },
  {
    "text": "management is very much a very much a problem that's",
    "start": "337120",
    "end": "342320"
  },
  {
    "text": "kind of unique to each organization so each approach that you",
    "start": "342320",
    "end": "347680"
  },
  {
    "text": "take uh doesn't necessarily mean it will work in every organization and what you need to think about are the",
    "start": "347680",
    "end": "354400"
  },
  {
    "text": "things that are kind of unique to your org what is your culture what is the responsibility of your",
    "start": "354400",
    "end": "361680"
  },
  {
    "text": "teams and this will help inform what is the appropriate",
    "start": "361680",
    "end": "367280"
  },
  {
    "text": "uh approach to take so a great place to start would be with",
    "start": "367280",
    "end": "372639"
  },
  {
    "text": "the different personas generally we see this as kind of two you have your",
    "start": "372639",
    "end": "379759"
  },
  {
    "start": "374000",
    "end": "374000"
  },
  {
    "text": "operators and your developers so operators are in charge of",
    "start": "379759",
    "end": "387120"
  },
  {
    "text": "running your cluster they generally take off the shelf software and install it into the cluster",
    "start": "387120",
    "end": "396000"
  },
  {
    "text": "they generally want stable and controlled updates and use semantic versioning to",
    "start": "396000",
    "end": "402479"
  },
  {
    "text": "help understand kind of what each change is bringing in",
    "start": "402479",
    "end": "408160"
  },
  {
    "text": "on the other side we have developers who are focused on building bespoke applications",
    "start": "408160",
    "end": "414800"
  },
  {
    "text": "these applications are generally focused on kind of business logic and solving",
    "start": "414800",
    "end": "420800"
  },
  {
    "text": "business needs and don't necessarily have as much of a focus on platform",
    "start": "420800",
    "end": "427360"
  },
  {
    "text": "compared to operators they will deploy as needed and don't necessarily need",
    "start": "427360",
    "end": "435039"
  },
  {
    "text": "semantic versioning to uh version their applications and so with each of these",
    "start": "435039",
    "end": "443440"
  },
  {
    "text": "personas they actually have very different needs",
    "start": "443440",
    "end": "448639"
  },
  {
    "text": "and you might decide that actually it's better to take two different use two different",
    "start": "448639",
    "end": "454319"
  },
  {
    "text": "approaches with configuration management to solve their um",
    "start": "454319",
    "end": "462080"
  },
  {
    "text": "computer their needs and for this talk we're going to focus more on the",
    "start": "462080",
    "end": "467440"
  },
  {
    "text": "developer experience so diving a little bit deeper on the developer",
    "start": "467440",
    "end": "472479"
  },
  {
    "text": "uh persona developers generally have a wide array of",
    "start": "472479",
    "end": "478879"
  },
  {
    "start": "473000",
    "end": "473000"
  },
  {
    "text": "experience and comfort level with kubernetes you might have some power users who",
    "start": "478879",
    "end": "485680"
  },
  {
    "text": "have previously run clusters and know the instant out of kubernetes or you might have users who have no",
    "start": "485680",
    "end": "491759"
  },
  {
    "text": "interest in kubernetes and just want your business application and so",
    "start": "491759",
    "end": "496800"
  },
  {
    "text": "you need to be able to kind of cater to both ends of the spectrum",
    "start": "496800",
    "end": "502479"
  },
  {
    "text": "and the way you do that is totally dependent on how you expose your platform to them",
    "start": "502479",
    "end": "510800"
  },
  {
    "text": "for example if you extract everything away you solve the zero interest use case but",
    "start": "510800",
    "end": "517200"
  },
  {
    "text": "you might alienate some power users who might have a special use case they're trying to solve",
    "start": "517200",
    "end": "522959"
  },
  {
    "text": "on the other end of the spectrum if you just give developers raw emo the zero interest uh developers",
    "start": "522959",
    "end": "530959"
  },
  {
    "text": "or zero interest in kubernetes developers will want",
    "start": "530959",
    "end": "537200"
  },
  {
    "text": "will be confused by the ammo and won't necessarily understand but the highly the power users will run",
    "start": "537200",
    "end": "543200"
  },
  {
    "text": "with it and so you need to kind of take this into",
    "start": "543200",
    "end": "550040"
  },
  {
    "text": "consideration what your organization um",
    "start": "550040",
    "end": "555519"
  },
  {
    "text": "culture is like with your abstraction and kind of to that end another thing",
    "start": "555519",
    "end": "560560"
  },
  {
    "text": "that's important to point out is kind of control of the configuration",
    "start": "560560",
    "end": "566800"
  },
  {
    "text": "you want to find a balance between centralized control and developer control uh",
    "start": "566800",
    "end": "573360"
  },
  {
    "text": "centralized control enables things like standard patterns and best practices which allow you to uh have easier",
    "start": "573360",
    "end": "581440"
  },
  {
    "text": "maintenance of your cluster and also more security concerns but",
    "start": "581440",
    "end": "586959"
  },
  {
    "text": "uh developer control allows you to kind of enable your developers to do what they",
    "start": "586959",
    "end": "593920"
  },
  {
    "text": "need to kind of deploy their application whether that's onboarding a new environment or choosing a different",
    "start": "593920",
    "end": "600080"
  },
  {
    "text": "deploy strategy and so there's a balance between these two where you want developers",
    "start": "600080",
    "end": "606320"
  },
  {
    "text": "to be able to do what they need without having to go to the control team",
    "start": "606320",
    "end": "613600"
  },
  {
    "text": "or the centralized platform team to do to get them to do what they need versus",
    "start": "613600",
    "end": "620160"
  },
  {
    "text": "you also want the centralized control team or to be able to deploy changes out",
    "start": "620160",
    "end": "626640"
  },
  {
    "text": "and not have to go bother hundreds or thousands of developers to kind of go margin of pr",
    "start": "626640",
    "end": "634800"
  },
  {
    "text": "and so with all of these considerations in mind",
    "start": "634800",
    "end": "641600"
  },
  {
    "text": "this is where you need to kind of evaluate what's important to your organization",
    "start": "641600",
    "end": "646720"
  },
  {
    "text": "and so at this point i think we're ready to kind of evaluate what are the different",
    "start": "646720",
    "end": "652399"
  },
  {
    "start": "648000",
    "end": "648000"
  },
  {
    "text": "approaches and how the pros and cons of each of them so let's start with an easy",
    "start": "652399",
    "end": "659600"
  },
  {
    "text": "one raw yellow rye ammo uh this is pretty easy you just give your",
    "start": "659600",
    "end": "666640"
  },
  {
    "start": "660000",
    "end": "660000"
  },
  {
    "text": "use your developers just plain kubernetes ammo uh this is usually a starting point for",
    "start": "666640",
    "end": "673200"
  },
  {
    "text": "more organizations since it's there's nothing to learn it's easy and straightforward and it's",
    "start": "673200",
    "end": "680560"
  },
  {
    "text": "totally flexible but this strategy really doesn't scale because it has no configuration reuse",
    "start": "680560",
    "end": "688800"
  },
  {
    "text": "so it's really easy to make a change of one environment but not have it carry over to another and so",
    "start": "688800",
    "end": "696480"
  },
  {
    "text": "this is generally seen as kind of just a stepping stone and this next approach we're going to",
    "start": "696480",
    "end": "703680"
  },
  {
    "text": "talk to is kind of seen usually as like a next step to raw ammo of",
    "start": "703680",
    "end": "709040"
  },
  {
    "text": "like okay if not raw yaml why don't we use templates so templating is where",
    "start": "709040",
    "end": "715600"
  },
  {
    "start": "711000",
    "end": "711000"
  },
  {
    "text": "you take a list of parameters that you inject into the predefined",
    "start": "715600",
    "end": "721120"
  },
  {
    "text": "template and that output is your configuration an example of this would be helm the n",
    "start": "721120",
    "end": "729040"
  },
  {
    "text": "and jsonnet and the image we have here is a helm chart that we have listed and",
    "start": "729040",
    "end": "734880"
  },
  {
    "text": "what you'll notice is that it allows you to list kind of different values that you can fill in in another file",
    "start": "734880",
    "end": "742639"
  },
  {
    "text": "which the developer would provide so the advantages here is that it's a",
    "start": "742639",
    "end": "748160"
  },
  {
    "text": "simpler configuration and it's very flexible like you might notice we have like an if",
    "start": "748160",
    "end": "753440"
  },
  {
    "text": "statement with within this deployment template but there's some disadvantages here",
    "start": "753440",
    "end": "759839"
  },
  {
    "text": "where uh generally these templates start to grow in complexity",
    "start": "759839",
    "end": "765200"
  },
  {
    "text": "as time goes on and you start to parameterize everything and so",
    "start": "765200",
    "end": "771360"
  },
  {
    "text": "maintaining these templates and understanding what's going on becomes really challenging",
    "start": "771360",
    "end": "776959"
  },
  {
    "text": "so that's templating in a nutshell and the next one i'm going to touch on is kind of a little bit of a",
    "start": "776959",
    "end": "783200"
  },
  {
    "text": "different approach and so that's using overlays you can think of overlays as defining a",
    "start": "783200",
    "end": "790320"
  },
  {
    "start": "784000",
    "end": "784000"
  },
  {
    "text": "common base that you share across environments and then for each environment you define",
    "start": "790320",
    "end": "797760"
  },
  {
    "text": "a file that has the specific changes that you want to make to that",
    "start": "797760",
    "end": "802880"
  },
  {
    "text": "environment so then when you want to deploy you take your base and apply",
    "start": "802880",
    "end": "809600"
  },
  {
    "text": "those environment specific changes on top of that base an example of this would be customize",
    "start": "809600",
    "end": "816639"
  },
  {
    "text": "the image we have here uh the image in the background would be a defined base a define",
    "start": "816639",
    "end": "823519"
  },
  {
    "text": "or which is a deployment and then we have uh environment specific",
    "start": "823519",
    "end": "829199"
  },
  {
    "text": "changes so for the staging environment we only want two replicas and so when you create the",
    "start": "829199",
    "end": "837199"
  },
  {
    "text": "staging configuration uh the two replicas is going to",
    "start": "837199",
    "end": "843519"
  },
  {
    "text": "override the one replica listed there so the advantages of overlays is that",
    "start": "843519",
    "end": "850720"
  },
  {
    "text": "it's very readable it encourages configuration you reuse and it's mostly",
    "start": "850720",
    "end": "857519"
  },
  {
    "text": "flexible that being said um some disadvantages to the overlay",
    "start": "857519",
    "end": "864399"
  },
  {
    "text": "approach is that it's not always immediately intuitive to developers what's kind of going on",
    "start": "864399",
    "end": "870800"
  },
  {
    "text": "it takes a bit for it to click sometimes and the lack of parameterization makes",
    "start": "870800",
    "end": "877440"
  },
  {
    "text": "things that should be easy hard and so that is overlay in a nutshell",
    "start": "877440",
    "end": "884560"
  },
  {
    "text": "and the next approach i'm going to talk about is kind of a little bit more of a pivot and that is",
    "start": "884560",
    "end": "890800"
  },
  {
    "text": "abstractions so an abstraction is where you hide the underlying details of the",
    "start": "890800",
    "end": "897760"
  },
  {
    "text": "configuration with a simply simpler interface",
    "start": "897760",
    "end": "903440"
  },
  {
    "text": "um some examples are pollumi cd8s and also how it kind of checks this box so here",
    "start": "903440",
    "end": "911279"
  },
  {
    "text": "we have or at least the image we have here is like an example of an abstraction where the developer would only kind of",
    "start": "911279",
    "end": "918399"
  },
  {
    "text": "provide the things that they care about like okay i'm running a web service",
    "start": "918399",
    "end": "923760"
  },
  {
    "text": "this is the dns name i want this is how i want to upgrade it and i want it to be on the mesh and so",
    "start": "923760",
    "end": "931600"
  },
  {
    "text": "the user only has to list these fields and then that is translated into",
    "start": "931600",
    "end": "939360"
  },
  {
    "text": "the all the different kubernetes manifests that kind of come along with",
    "start": "939360",
    "end": "944800"
  },
  {
    "text": "that and so you can see this is much simpler configuration and it allows um",
    "start": "944800",
    "end": "952880"
  },
  {
    "text": "organizations to implement standards that can be applied across the org",
    "start": "952880",
    "end": "959440"
  },
  {
    "text": "and the way that's done is by change implementing those standards in the underlying abstraction",
    "start": "959440",
    "end": "966240"
  },
  {
    "text": "however there are some disadvantages where you're giving up flexibility the",
    "start": "966240",
    "end": "972320"
  },
  {
    "text": "developer is giving up flexibility and usually most of these abstractions",
    "start": "972320",
    "end": "977600"
  },
  {
    "text": "tend to kind of start to leak the underlying details",
    "start": "977600",
    "end": "982639"
  },
  {
    "text": "and so kind of as a result we we found that there really hasn't been the right",
    "start": "982639",
    "end": "987839"
  },
  {
    "text": "obstruction found for kubernetes yet and that's kind of just abstraction in a",
    "start": "987839",
    "end": "994839"
  },
  {
    "text": "nutshell the last approach we're going to talk about is codifying your",
    "start": "994839",
    "end": "1001279"
  },
  {
    "text": "configuration management and this one's pretty simple you just use a",
    "start": "1001279",
    "end": "1006720"
  },
  {
    "text": "programming language to generate your configuration and so",
    "start": "1006720",
    "end": "1012800"
  },
  {
    "text": "some examples of that would be cd8 splomy uh jsonnet and this image we have here",
    "start": "1012800",
    "end": "1019600"
  },
  {
    "text": "is from cdhs and what it's doing is it's importing a couple different",
    "start": "1019600",
    "end": "1026640"
  },
  {
    "text": "like well-known structures and passing in kind of like the different",
    "start": "1026640",
    "end": "1032798"
  },
  {
    "text": "configuration that a user would want to apply and so the benefits that we get there is",
    "start": "1032799",
    "end": "1038558"
  },
  {
    "text": "you get everything that comes with a programming language like loops conditionals functions unit",
    "start": "1038559",
    "end": "1044959"
  },
  {
    "text": "testing and it also really gets the same benefits of an abstraction because",
    "start": "1044959",
    "end": "1052160"
  },
  {
    "text": "it's in a sense it is a bit of an instruction that being said you get all the disadvantages of a",
    "start": "1052160",
    "end": "1060480"
  },
  {
    "text": "code base so this is another code base you have to manage and you have to so like you might have",
    "start": "1060480",
    "end": "1067360"
  },
  {
    "text": "bugs and you have to kind of figure out how to debug those and it can be a challenge for your",
    "start": "1067360",
    "end": "1074720"
  },
  {
    "text": "developers to figure out how does this chart that we have listed here translate",
    "start": "1074720",
    "end": "1080160"
  },
  {
    "text": "to our final result so with all of that those are",
    "start": "1080160",
    "end": "1087440"
  },
  {
    "start": "1084000",
    "end": "1084000"
  },
  {
    "text": "all of the common approaches we've seen to configuration management",
    "start": "1087440",
    "end": "1092840"
  },
  {
    "text": "um for kubernetes and so at this point i'm gonna hand it off to jesse and he's gonna give",
    "start": "1092840",
    "end": "1099600"
  },
  {
    "text": "an example of how intuit has done configuration management for all of its developers thanks danny",
    "start": "1099600",
    "end": "1108000"
  },
  {
    "text": "so now we'll get into a bit of a case study of intuits approach to configuration",
    "start": "1108000",
    "end": "1113840"
  },
  {
    "text": "management and for this section we'll focus actually on the developer experience that we provided",
    "start": "1113840",
    "end": "1120160"
  },
  {
    "text": "um as a platform team so a little bit of a background um our use cases that we",
    "start": "1120160",
    "end": "1127520"
  },
  {
    "text": "have 4 000 developers deploying mostly sas applications these developers",
    "start": "1127520",
    "end": "1134160"
  },
  {
    "text": "are managing multiple environments and for us uh environment equates to a kubernetes",
    "start": "1134160",
    "end": "1140320"
  },
  {
    "text": "namespace and these environments are mostly identical and they have slight variations in the in their",
    "start": "1140320",
    "end": "1147840"
  },
  {
    "text": "config so maybe the differences are that they have different dns names they use",
    "start": "1147840",
    "end": "1154559"
  },
  {
    "text": "different advanced resources and they have maybe different im roles and privileges",
    "start": "1154559",
    "end": "1161520"
  },
  {
    "text": "intuit promotes a devops culture of you build it you run it so those",
    "start": "1161520",
    "end": "1167200"
  },
  {
    "text": "developers who are building the application are the same ones who operate it and are responsible for",
    "start": "1167200",
    "end": "1173200"
  },
  {
    "text": "the uptime and maintainability and so with that we came up with a set",
    "start": "1173200",
    "end": "1180320"
  },
  {
    "text": "of requirements and as a platform team we wanted to provide a standard set of patterns and best",
    "start": "1180320",
    "end": "1187679"
  },
  {
    "text": "practices what we refer to as the paved road but at the same time we also want to",
    "start": "1187679",
    "end": "1194400"
  },
  {
    "text": "empower developers and provide them the flexibility so that they would be unblocked in the",
    "start": "1194400",
    "end": "1200720"
  },
  {
    "text": "event they need more capabilities that aren't provided by a default",
    "start": "1200720",
    "end": "1206159"
  },
  {
    "text": "even if this came at the cost of simplicity and so we made the conscious decision to",
    "start": "1206159",
    "end": "1212480"
  },
  {
    "text": "actually uh expose our developers to kubernetes ymo and and so they can leverage all the",
    "start": "1212480",
    "end": "1219360"
  },
  {
    "text": "power and benefits of kubernetes and finally any approach that",
    "start": "1219360",
    "end": "1225360"
  },
  {
    "text": "we took it needed to be git ops friendly git ops is extremely important to intuit because of a lot of",
    "start": "1225360",
    "end": "1232000"
  },
  {
    "text": "compliance and security requirements and so whatever solution we took had to",
    "start": "1232000",
    "end": "1237120"
  },
  {
    "text": "fit into our strategy and so the solution we came up with",
    "start": "1237120",
    "end": "1244320"
  },
  {
    "text": "actually after years was actually to use customize and with customize since you're exposing",
    "start": "1244320",
    "end": "1252480"
  },
  {
    "text": "your users to actually kubernetes resource and manifest you're preserving all the full power and",
    "start": "1252480",
    "end": "1259360"
  },
  {
    "text": "capabilities of of kubernetes and because customize is",
    "start": "1259360",
    "end": "1264400"
  },
  {
    "text": "um kubernetes native it's well supported and documented our users or developers",
    "start": "1264400",
    "end": "1271039"
  },
  {
    "text": "are often able to uh get help from open source documentation",
    "start": "1271039",
    "end": "1276080"
  },
  {
    "text": "and and not always rely on the the platform team because it's it's just kubernetes yamaha",
    "start": "1276080",
    "end": "1283280"
  },
  {
    "text": "at the end of the day readability is very clear there's you just again looking at",
    "start": "1283280",
    "end": "1291280"
  },
  {
    "text": "manifest and this is actually both important for the developers but the platform team who",
    "start": "1291280",
    "end": "1298000"
  },
  {
    "text": "is supporting that service so if say there's some problem with the bug in",
    "start": "1298000",
    "end": "1303919"
  },
  {
    "text": "the yaml it's it's very clear where the problem is rather than some abstraction",
    "start": "1303919",
    "end": "1310159"
  },
  {
    "text": "possibly hiding that away and customize overlay pattern",
    "start": "1310159",
    "end": "1315280"
  },
  {
    "text": "really fits in with our use case of mostly identical environments with with",
    "start": "1315280",
    "end": "1321919"
  },
  {
    "text": "slight variations and so that promoted a lot of configuration reuse and maintainability",
    "start": "1321919",
    "end": "1328240"
  },
  {
    "text": "and finally what i think is probably customizes best feature is its ability to reference a central or",
    "start": "1328240",
    "end": "1335200"
  },
  {
    "text": "remote base of git repository and that allows us to",
    "start": "1335200",
    "end": "1340400"
  },
  {
    "text": "do that distribution of standard patterns across our organization",
    "start": "1340400",
    "end": "1346320"
  },
  {
    "text": "um so yeah it's a central uh remote base is how we leverage customize basically as a",
    "start": "1346320",
    "end": "1353200"
  },
  {
    "text": "platform team we provide what i call a a catalog of generic starter yaml",
    "start": "1353200",
    "end": "1358880"
  },
  {
    "text": "and so in a simple example the developer will get something like a web service which is",
    "start": "1358880",
    "end": "1364320"
  },
  {
    "text": "comprised of a deployment a service and an ingress and later if the developer wants",
    "start": "1364320",
    "end": "1372320"
  },
  {
    "text": "some to leverage some of the more advanced capabilities of kubernetes they can then include say like a hpa",
    "start": "1372320",
    "end": "1378720"
  },
  {
    "text": "base or a canary analysis base as part of their service and we cementally version this remote",
    "start": "1378720",
    "end": "1385919"
  },
  {
    "text": "base so that developers they can upgrade to newer future",
    "start": "1385919",
    "end": "1391919"
  },
  {
    "text": "at their own pace and so all of this is to kind of gives us this standard distribution of",
    "start": "1391919",
    "end": "1398080"
  },
  {
    "text": "patterns but best practices and things like uh you know setting",
    "start": "1398080",
    "end": "1403280"
  },
  {
    "text": "pod readiness gates and resource limits and ingress annotations uh what the",
    "start": "1403280",
    "end": "1409120"
  },
  {
    "text": "developer gets is they actually get their own git repository that derives from the",
    "start": "1409120",
    "end": "1414320"
  },
  {
    "text": "central remote base and the developers own this repository they're free to make the changes",
    "start": "1414320",
    "end": "1420000"
  },
  {
    "text": "in this repository to suit the needs of their service",
    "start": "1420000",
    "end": "1424799"
  },
  {
    "text": "so what we have here is is actually a ingress that we as a platform team came up with",
    "start": "1425840",
    "end": "1431520"
  },
  {
    "text": "that suits our um use case as you can see we use the lb ingress controller and if",
    "start": "1431520",
    "end": "1438799"
  },
  {
    "text": "you use alb english controller you'll know that it just has a ton of different",
    "start": "1438799",
    "end": "1443840"
  },
  {
    "text": "annotations to control the underlying load bouncer and most of these details are things that",
    "start": "1443840",
    "end": "1450400"
  },
  {
    "text": "you don't want to expose to your developers they don't need to know or care about",
    "start": "1450400",
    "end": "1457200"
  },
  {
    "text": "how these things affect the load bouncer but a couple of things they do need to know such as in this case the external dns",
    "start": "1457200",
    "end": "1464559"
  },
  {
    "text": "name that they want to use and also the certain arn for their",
    "start": "1464559",
    "end": "1470840"
  },
  {
    "text": "service and so what the developer gets is this git repository",
    "start": "1470840",
    "end": "1477039"
  },
  {
    "text": "and it's structured like this at the top level they have the application based directly",
    "start": "1477039",
    "end": "1483120"
  },
  {
    "text": "that it serves as the common definitions that they want to apply to all of their environments",
    "start": "1483120",
    "end": "1489840"
  },
  {
    "text": "and then they get a list of environment directories and each of these",
    "start": "1489840",
    "end": "1495520"
  },
  {
    "text": "environment directories correspond to a kubernetes namespace and it only includes the changes",
    "start": "1495520",
    "end": "1501200"
  },
  {
    "text": "specific for that environment if you look at that top level customization you'll see that",
    "start": "1501200",
    "end": "1509760"
  },
  {
    "text": "here it's referencing that centrally managed a base that i referred to this one's",
    "start": "1509760",
    "end": "1514880"
  },
  {
    "text": "referencing our 4.0 version and then if you look at the",
    "start": "1514880",
    "end": "1520320"
  },
  {
    "text": "customization and environment you'll see that it then derives from",
    "start": "1520320",
    "end": "1526400"
  },
  {
    "text": "the top-level app base of their own git repository and so with this approach developer can",
    "start": "1526400",
    "end": "1532480"
  },
  {
    "text": "leverage that same uh configuration reuse that they get",
    "start": "1532480",
    "end": "1537679"
  },
  {
    "text": "by also inheriting from that central repository uh finally if you look at say the",
    "start": "1537679",
    "end": "1544799"
  },
  {
    "text": "ingress for a specific environment you'll see that it has",
    "start": "1544799",
    "end": "1550159"
  },
  {
    "text": "those two specific annotations that the developer cares about they want to reference a specific certificate",
    "start": "1550159",
    "end": "1556880"
  },
  {
    "text": "as well as a specific dns name for that environment",
    "start": "1556880",
    "end": "1562799"
  },
  {
    "text": "okay so let's see how did this scale and work out for intuit so if you think about",
    "start": "1564240",
    "end": "1571360"
  },
  {
    "text": "a single environment at least in our case um for us this renders out to be about 250",
    "start": "1571360",
    "end": "1579120"
  },
  {
    "text": "lines of yaml and if it's if a service has four",
    "start": "1579120",
    "end": "1584640"
  },
  {
    "text": "environments and we have uh 2500 services then the amount of deployed yaml ends up",
    "start": "1584640",
    "end": "1591360"
  },
  {
    "text": "to be roughly 2.5 million lines of yaml and then when you consider actually how",
    "start": "1591360",
    "end": "1597679"
  },
  {
    "text": "much of that yaml is being managed by humans in in git repositories um",
    "start": "1597679",
    "end": "1605520"
  },
  {
    "text": "it's counted a little bit differently but you have a base of 90 lines of yaml and four overlays one per environment",
    "start": "1605520",
    "end": "1613039"
  },
  {
    "text": "and each of those overlays are about let's say 45 lines that equates to",
    "start": "1613039",
    "end": "1618960"
  },
  {
    "text": "270 lines of ammo per service you multiply that by 2 500 services",
    "start": "1618960",
    "end": "1625679"
  },
  {
    "text": "and you get 675 000 lines of yaml this is roughly about",
    "start": "1625679",
    "end": "1632480"
  },
  {
    "text": "a little over 25 of the deployed ammo",
    "start": "1632480",
    "end": "1637278"
  },
  {
    "start": "1638000",
    "end": "1638000"
  },
  {
    "text": "so um this has been working well for us but it hasn't been without its challenges and so these",
    "start": "1638159",
    "end": "1644240"
  },
  {
    "text": "are some of the challenges that you'll come across should you take a approach like this and the number one is actually user",
    "start": "1644240",
    "end": "1651120"
  },
  {
    "text": "support and as i mentioned we chose to expose our users",
    "start": "1651120",
    "end": "1656480"
  },
  {
    "text": "to uh kubernetes yaml and so by making that decision we also gave our users a lot of loaded",
    "start": "1656480",
    "end": "1664399"
  },
  {
    "text": "foot guns you know people who may not be as familiar with kubernetes can make",
    "start": "1664399",
    "end": "1669679"
  },
  {
    "text": "lots of mistakes similarly you have advanced users who want to leverage a lot of the",
    "start": "1669679",
    "end": "1676320"
  },
  {
    "text": "advanced kubernetes features and they end up falling off the paved road because",
    "start": "1676320",
    "end": "1681840"
  },
  {
    "text": "they're they're doing things unexpected and it becomes harder and harder to support that class of",
    "start": "1681840",
    "end": "1687520"
  },
  {
    "text": "users the second challenge that we had was just the automation necessary to",
    "start": "1687520",
    "end": "1694799"
  },
  {
    "text": "support this you know 2500 services equates to 2500",
    "start": "1694799",
    "end": "1700640"
  },
  {
    "text": "git repositories and so in order to support that we had to build a lot of automation to to do things like",
    "start": "1700640",
    "end": "1708640"
  },
  {
    "text": "automatically send pull requests in the event say we want to deprecate like a certain api",
    "start": "1708640",
    "end": "1717679"
  },
  {
    "text": "and then finally the last challenge is with the tool customize itself you know when we you depend so",
    "start": "1717840",
    "end": "1725440"
  },
  {
    "text": "much on this tool which is responsible for rendering out the yaml that you end up",
    "start": "1725440",
    "end": "1730559"
  },
  {
    "text": "deploying any change to that tool um can impact",
    "start": "1730559",
    "end": "1736159"
  },
  {
    "text": "a lot of your services so if we were to say upgrade customize and it had um it it rendered dml a bit differently",
    "start": "1736159",
    "end": "1744240"
  },
  {
    "text": "which it has then we have potentially are breaking all at once a thousand",
    "start": "1744240",
    "end": "1749679"
  },
  {
    "text": "different applications and another thing you should know about the customize is its support for crds is",
    "start": "1749679",
    "end": "1758000"
  },
  {
    "text": "a bit limited it has great support for native kubernetes kinds but when it comes to crds you",
    "start": "1758000",
    "end": "1764799"
  },
  {
    "text": "aren't able to leverage some of the convenient features like strategically merge patching",
    "start": "1764799",
    "end": "1770559"
  },
  {
    "text": "your resources we actually ended up forking customize in order to run a version of customize",
    "start": "1770559",
    "end": "1777200"
  },
  {
    "text": "that natively understands the crds that we we use at intuit",
    "start": "1777200",
    "end": "1783600"
  },
  {
    "text": "and so with that um danny i have some final thoughts that we have about you know the current state of",
    "start": "1784720",
    "end": "1791120"
  },
  {
    "text": "configuration management but also like where we think it needs to go in the future",
    "start": "1791120",
    "end": "1797840"
  },
  {
    "text": "yeah so hopefully as you could tell that",
    "start": "1799039",
    "end": "1805200"
  },
  {
    "text": "we really think there's no perfect solution with configuration management no matter",
    "start": "1805200",
    "end": "1810799"
  },
  {
    "text": "what you do you're gonna have kind of certain edge cases or",
    "start": "1810799",
    "end": "1816799"
  },
  {
    "text": "road bumps that are gonna be a challenge and it's kind of the nature of",
    "start": "1816799",
    "end": "1823679"
  },
  {
    "text": "the problem and even within that also like with whatever solution you",
    "start": "1823679",
    "end": "1830320"
  },
  {
    "text": "choose it's going to be highly dependent on kind of your organization and how it divvies out",
    "start": "1830320",
    "end": "1838240"
  },
  {
    "text": "different responsibilities and just the general culture and so what we've kind of taken away",
    "start": "1838240",
    "end": "1845919"
  },
  {
    "text": "um is that at a certain scale just act managing ammo files is a lot of",
    "start": "1845919",
    "end": "1852480"
  },
  {
    "text": "work and so it's hard for developers to fully understand it and it's also hard to kind of maintain",
    "start": "1852480",
    "end": "1862240"
  },
  {
    "text": "millions of lines of ammo and so with that what we've been thinking is that there",
    "start": "1862640",
    "end": "1869760"
  },
  {
    "text": "needs to be kind of a better abstraction we think kubernetes gamma is super powerful",
    "start": "1869760",
    "end": "1874880"
  },
  {
    "text": "and it's here to stay but we need a better way of kind of abstracting away a lot of the",
    "start": "1874880",
    "end": "1880960"
  },
  {
    "text": "nitty-gritty details of yaml away from the users because they don't need to know about it necessarily",
    "start": "1880960",
    "end": "1887519"
  },
  {
    "text": "and one way it's we could potentially do this is through a ui assisted uh configuration",
    "start": "1887519",
    "end": "1894320"
  },
  {
    "text": "management tool um that can allow our developers to",
    "start": "1894320",
    "end": "1900159"
  },
  {
    "text": "kind of easily edit their yaml in a way that kind of gives them",
    "start": "1900159",
    "end": "1906240"
  },
  {
    "text": "more insight into what changes they're actually making but also",
    "start": "1906240",
    "end": "1911840"
  },
  {
    "text": "kind of enforce those organizational standards that you want to see and so with that",
    "start": "1911840",
    "end": "1918840"
  },
  {
    "text": "um a good example of that would be spinnaker uh as a project one thing they",
    "start": "1918840",
    "end": "1925440"
  },
  {
    "text": "do really well is they make it really easy to create a ec2 instance",
    "start": "1925440",
    "end": "1931360"
  },
  {
    "text": "so they walk you through all the different fields you need to provide and kind of show you an opinionated way",
    "start": "1931360",
    "end": "1937919"
  },
  {
    "text": "of bringing up any c2 instance and it's uh easy gui to follow",
    "start": "1937919",
    "end": "1943279"
  },
  {
    "text": "and so we're hoping we could find something similar with kubernetes",
    "start": "1943279",
    "end": "1948320"
  },
  {
    "text": "uh with that thank you for attending our talk here is a list of resources",
    "start": "1948320",
    "end": "1954320"
  },
  {
    "text": "that we have and please feel free to reach out we're excited to see what we can kind of do",
    "start": "1954320",
    "end": "1962240"
  },
  {
    "text": "with the configuration management portion of kubernetes have a great day and enjoy",
    "start": "1962240",
    "end": "1967440"
  },
  {
    "text": "the rest of the conference thanks everyone",
    "start": "1967440",
    "end": "1974159"
  }
]