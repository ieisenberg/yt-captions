[
  {
    "text": "okay hi everyone hope you're having a",
    "start": "760",
    "end": "2200"
  },
  {
    "text": "good uh conference so far uh my name is",
    "start": "2200",
    "end": "4799"
  },
  {
    "text": "Golan and I'll be talking to you about",
    "start": "4799",
    "end": "6720"
  },
  {
    "text": "um readon file systems and the execution",
    "start": "6720",
    "end": "8920"
  },
  {
    "text": "of arbitrary code within",
    "start": "8920",
    "end": "12679"
  },
  {
    "text": "them um so for starters my name is Goan",
    "start": "14799",
    "end": "17279"
  },
  {
    "text": "like I said I'm a security consultant",
    "start": "17279",
    "end": "18840"
  },
  {
    "text": "for with secure based out of London uh",
    "start": "18840",
    "end": "21920"
  },
  {
    "text": "mostly I deal with azour and kubernetes",
    "start": "21920",
    "end": "24480"
  },
  {
    "text": "and within sort of the cubern kubernetes",
    "start": "24480",
    "end": "26480"
  },
  {
    "text": "space I focus more on the low-level",
    "start": "26480",
    "end": "28560"
  },
  {
    "text": "aspect of containerization so level",
    "start": "28560",
    "end": "30359"
  },
  {
    "text": "Linux uh as you can see enthusiastic",
    "start": "30359",
    "end": "32758"
  },
  {
    "text": "about anything containers if you see me",
    "start": "32759",
    "end": "34800"
  },
  {
    "text": "down the hall feel free to grab me for a",
    "start": "34800",
    "end": "37760"
  },
  {
    "text": "chat um so yeah quick agenda for what",
    "start": "37760",
    "end": "40280"
  },
  {
    "text": "we'll be talking about today so we start",
    "start": "40280",
    "end": "42719"
  },
  {
    "text": "off with what roning file systems are",
    "start": "42719",
    "end": "45320"
  },
  {
    "text": "why we use them what kind of advantages",
    "start": "45320",
    "end": "47280"
  },
  {
    "text": "they give us um in relation to security",
    "start": "47280",
    "end": "50320"
  },
  {
    "text": "what does kubernetes have to do with",
    "start": "50320",
    "end": "51680"
  },
  {
    "text": "that or rather containers in",
    "start": "51680",
    "end": "53480"
  },
  {
    "text": "general we'll then kind of switch our",
    "start": "53480",
    "end": "55800"
  },
  {
    "text": "hats over to the attacker's perspective",
    "start": "55800",
    "end": "57559"
  },
  {
    "text": "have a look at what an attacker can do",
    "start": "57559",
    "end": "59359"
  },
  {
    "text": "with a read only file system what's the",
    "start": "59359",
    "end": "62120"
  },
  {
    "text": "sort of uh methodology there we'll then",
    "start": "62120",
    "end": "64878"
  },
  {
    "text": "move on to three methods um of bypassing",
    "start": "64879",
    "end": "68119"
  },
  {
    "text": "readon restrictions in order to execute",
    "start": "68119",
    "end": "70080"
  },
  {
    "text": "our arbitrary code and then we'll",
    "start": "70080",
    "end": "72439"
  },
  {
    "text": "briefly touch on remediation a bit of",
    "start": "72439",
    "end": "74400"
  },
  {
    "text": "mitigation and some final thoughts and",
    "start": "74400",
    "end": "77880"
  },
  {
    "text": "conclusions so for starters what is a",
    "start": "77880",
    "end": "80439"
  },
  {
    "text": "readon file system so generically",
    "start": "80439",
    "end": "82720"
  },
  {
    "text": "speaking when we talk about file systems",
    "start": "82720",
    "end": "84920"
  },
  {
    "text": "the construct is built off of three sets",
    "start": "84920",
    "end": "87200"
  },
  {
    "text": "of actions if you will H read write and",
    "start": "87200",
    "end": "90560"
  },
  {
    "text": "execute readon file systems they're not",
    "start": "90560",
    "end": "93280"
  },
  {
    "text": "really readon they also execute",
    "start": "93280",
    "end": "95520"
  },
  {
    "text": "basically we kind of take away that",
    "start": "95520",
    "end": "97200"
  },
  {
    "text": "ability to write now that's not a",
    "start": "97200",
    "end": "99560"
  },
  {
    "text": "substitute to your individual file and",
    "start": "99560",
    "end": "101560"
  },
  {
    "text": "folder permissions so in Linux",
    "start": "101560",
    "end": "103159"
  },
  {
    "text": "discretionary access control that still",
    "start": "103159",
    "end": "106000"
  },
  {
    "text": "applies at the file system level we",
    "start": "106000",
    "end": "109000"
  },
  {
    "text": "can't write so the file system itself is",
    "start": "109000",
    "end": "111079"
  },
  {
    "text": "immutable meaning you might see some",
    "start": "111079",
    "end": "113159"
  },
  {
    "text": "files and folders that still have that",
    "start": "113159",
    "end": "115040"
  },
  {
    "text": "right permission set you won't be able",
    "start": "115040",
    "end": "116640"
  },
  {
    "text": "to write to it doesn't really make a",
    "start": "116640",
    "end": "118840"
  },
  {
    "text": "difference",
    "start": "118840",
    "end": "120479"
  },
  {
    "text": "what we what can we do with read only",
    "start": "120479",
    "end": "122520"
  },
  {
    "text": "file systems why should we use them so",
    "start": "122520",
    "end": "124759"
  },
  {
    "text": "read only file systems uh we're",
    "start": "124759",
    "end": "126320"
  },
  {
    "text": "basically talking about immutability",
    "start": "126320",
    "end": "128000"
  },
  {
    "text": "here they're more predictable they allow",
    "start": "128000",
    "end": "130800"
  },
  {
    "text": "us to control and manage containerized",
    "start": "130800",
    "end": "132840"
  },
  {
    "text": "applications better um threat detection",
    "start": "132840",
    "end": "136239"
  },
  {
    "text": "becomes easier again when you kind of",
    "start": "136239",
    "end": "137800"
  },
  {
    "text": "know what to expect you know what the",
    "start": "137800",
    "end": "139840"
  },
  {
    "text": "construct should look like it's easier",
    "start": "139840",
    "end": "142440"
  },
  {
    "text": "to kind of find an",
    "start": "142440",
    "end": "144280"
  },
  {
    "text": "abnormality and then sort of the final",
    "start": "144280",
    "end": "146280"
  },
  {
    "text": "step which is kind of what we're",
    "start": "146280",
    "end": "147160"
  },
  {
    "text": "touching on today it makes it harder for",
    "start": "147160",
    "end": "149120"
  },
  {
    "text": "attackers as an attacker here anyone",
    "start": "149120",
    "end": "150680"
  },
  {
    "text": "who's ever kind of tried attacking a",
    "start": "150680",
    "end": "152080"
  },
  {
    "text": "readon file system knows that it is not",
    "start": "152080",
    "end": "154280"
  },
  {
    "text": "impossible but definitely a lot harder",
    "start": "154280",
    "end": "156800"
  },
  {
    "text": "when you can't really write your own",
    "start": "156800",
    "end": "158080"
  },
  {
    "text": "code there makes it a bit diff a bit",
    "start": "158080",
    "end": "161040"
  },
  {
    "text": "more difficult um on the bottom here on",
    "start": "161040",
    "end": "163400"
  },
  {
    "text": "on the left we can see how we set uh",
    "start": "163400",
    "end": "165800"
  },
  {
    "text": "containers pods file system to be readon",
    "start": "165800",
    "end": "169040"
  },
  {
    "text": "so just under security context we set",
    "start": "169040",
    "end": "171159"
  },
  {
    "text": "readon root file system as",
    "start": "171159",
    "end": "174080"
  },
  {
    "text": "true so now that we've kind of talked",
    "start": "174080",
    "end": "176280"
  },
  {
    "text": "about what a read only file system is",
    "start": "176280",
    "end": "178319"
  },
  {
    "text": "and sort of the advantages is from the",
    "start": "178319",
    "end": "181080"
  },
  {
    "text": "defensive or Administration side of",
    "start": "181080",
    "end": "183239"
  },
  {
    "text": "things what can an attacker do against a",
    "start": "183239",
    "end": "185799"
  },
  {
    "text": "read only file system so it definitely",
    "start": "185799",
    "end": "188440"
  },
  {
    "text": "does present another layer of",
    "start": "188440",
    "end": "190519"
  },
  {
    "text": "complexity it's again like I said before",
    "start": "190519",
    "end": "192879"
  },
  {
    "text": "when you can't write your own code how",
    "start": "192879",
    "end": "194440"
  },
  {
    "text": "you can execute it it still however",
    "start": "194440",
    "end": "197000"
  },
  {
    "text": "represents a foothold in the environment",
    "start": "197000",
    "end": "199120"
  },
  {
    "text": "we can sort of use living off the land",
    "start": "199120",
    "end": "200680"
  },
  {
    "text": "techniques to enumerate the environment",
    "start": "200680",
    "end": "202159"
  },
  {
    "text": "from internal perspective in some cases",
    "start": "202159",
    "end": "204040"
  },
  {
    "text": "we can even use the file system that pod",
    "start": "204040",
    "end": "206920"
  },
  {
    "text": "as an intermediary to communicate with",
    "start": "206920",
    "end": "208799"
  },
  {
    "text": "other",
    "start": "208799",
    "end": "210319"
  },
  {
    "text": "components within the system within the",
    "start": "210319",
    "end": "213080"
  },
  {
    "text": "environment um and",
    "start": "213080",
    "end": "215640"
  },
  {
    "text": "basically we want to use it to do",
    "start": "215640",
    "end": "217840"
  },
  {
    "text": "anything we do with a normal file system",
    "start": "217840",
    "end": "220640"
  },
  {
    "text": "except we just have that extra",
    "start": "220640",
    "end": "221680"
  },
  {
    "text": "restriction along the",
    "start": "221680",
    "end": "224400"
  },
  {
    "text": "way so touching quickly on the attack",
    "start": "224400",
    "end": "226720"
  },
  {
    "text": "scenario that we'll be kind of looking",
    "start": "226720",
    "end": "228400"
  },
  {
    "text": "at and demonstrating today we'll be",
    "start": "228400",
    "end": "230920"
  },
  {
    "text": "simulating an adversary that has a",
    "start": "230920",
    "end": "233239"
  },
  {
    "text": "foothold on an application pod which has",
    "start": "233239",
    "end": "235079"
  },
  {
    "text": "a readon file system this can be through",
    "start": "235079",
    "end": "236760"
  },
  {
    "text": "rce for example it doesn't really matter",
    "start": "236760",
    "end": "238439"
  },
  {
    "text": "for our use case and the adversary will",
    "start": "238439",
    "end": "240879"
  },
  {
    "text": "have low privileged access so all three",
    "start": "240879",
    "end": "242680"
  },
  {
    "text": "methods we'll be covering today you do",
    "start": "242680",
    "end": "244280"
  },
  {
    "text": "not need to be root within the container",
    "start": "244280",
    "end": "245879"
  },
  {
    "text": "nothing along those lines um for the",
    "start": "245879",
    "end": "248959"
  },
  {
    "text": "sake",
    "start": "248959",
    "end": "249760"
  },
  {
    "text": "of mine and yours mental health and uh",
    "start": "249760",
    "end": "253079"
  },
  {
    "text": "brevity we'll be using just a reverse",
    "start": "253079",
    "end": "254760"
  },
  {
    "text": "shell as a proof of concept these did",
    "start": "254760",
    "end": "258040"
  },
  {
    "text": "work with Cube CTL am I contained all",
    "start": "258040",
    "end": "260239"
  },
  {
    "text": "the sort of bigger tools some of them",
    "start": "260239",
    "end": "261639"
  },
  {
    "text": "need a bit of tweaking some of them a",
    "start": "261639",
    "end": "263320"
  },
  {
    "text": "bit trial and error but eventually they",
    "start": "263320",
    "end": "265280"
  },
  {
    "text": "do work um and yeah our goal is to",
    "start": "265280",
    "end": "268919"
  },
  {
    "text": "execute arbit code so we can further our",
    "start": "268919",
    "end": "272880"
  },
  {
    "text": "attack so looking at our first method",
    "start": "272880",
    "end": "275440"
  },
  {
    "text": "we'll be looking at an engine X pod as",
    "start": "275440",
    "end": "278240"
  },
  {
    "text": "you can see at the top the image is",
    "start": "278240",
    "end": "279720"
  },
  {
    "text": "engine X it's set to have a readon file",
    "start": "279720",
    "end": "282320"
  },
  {
    "text": "system we're running as a low privileged",
    "start": "282320",
    "end": "284479"
  },
  {
    "text": "user H some sort of key points here we",
    "start": "284479",
    "end": "287919"
  },
  {
    "text": "do have bash as standard engine X is",
    "start": "287919",
    "end": "291520"
  },
  {
    "text": "we're working under the assumption we",
    "start": "291520",
    "end": "292919"
  },
  {
    "text": "have no network tooling no standard",
    "start": "292919",
    "end": "294400"
  },
  {
    "text": "Network tooling so no W get no curl no",
    "start": "294400",
    "end": "297520"
  },
  {
    "text": "Shenanigans um and then obviously we",
    "start": "297520",
    "end": "300240"
  },
  {
    "text": "also have the volumes and the volume",
    "start": "300240",
    "end": "301479"
  },
  {
    "text": "mounts here we're going to be ignoring",
    "start": "301479",
    "end": "303440"
  },
  {
    "text": "them for this this part of the",
    "start": "303440",
    "end": "305199"
  },
  {
    "text": "demonstration in a real life scenario",
    "start": "305199",
    "end": "307240"
  },
  {
    "text": "there's a likely to be mounted as no",
    "start": "307240",
    "end": "309120"
  },
  {
    "text": "exec meaning we might be able to write",
    "start": "309120",
    "end": "310680"
  },
  {
    "text": "to them but not execute from them um and",
    "start": "310680",
    "end": "314320"
  },
  {
    "text": "that's that so for our first",
    "start": "314320",
    "end": "319240"
  },
  {
    "text": "demo first thing we want to do is make",
    "start": "319520",
    "end": "321840"
  },
  {
    "text": "sure that I haven't been lying to you",
    "start": "321840",
    "end": "323280"
  },
  {
    "text": "this whole",
    "start": "323280",
    "end": "325280"
  },
  {
    "text": "time and",
    "start": "325280",
    "end": "328240"
  },
  {
    "text": "that it is actually a readon file system",
    "start": "328240",
    "end": "332680"
  },
  {
    "text": "um okay so the way we kind of construct",
    "start": "332680",
    "end": "335039"
  },
  {
    "text": "our attacks we have two stages if you",
    "start": "335039",
    "end": "339319"
  },
  {
    "text": "will the first is how do we get our code",
    "start": "339319",
    "end": "342080"
  },
  {
    "text": "onto the machine second is how do we",
    "start": "342080",
    "end": "343880"
  },
  {
    "text": "execute it um so it's a bit of a spoiler",
    "start": "343880",
    "end": "346560"
  },
  {
    "text": "alert uh you can see the code but",
    "start": "346560",
    "end": "349759"
  },
  {
    "text": "basically the first stage is we need to",
    "start": "349759",
    "end": "352000"
  },
  {
    "text": "find some sort of network utility that",
    "start": "352000",
    "end": "353639"
  },
  {
    "text": "allows us to get our code onto the",
    "start": "353639",
    "end": "354880"
  },
  {
    "text": "machine like we said don't have Cur we",
    "start": "354880",
    "end": "356759"
  },
  {
    "text": "don't have W get nothing sort of",
    "start": "356759",
    "end": "358080"
  },
  {
    "text": "standard what we do have that I",
    "start": "358080",
    "end": "360120"
  },
  {
    "text": "highlighted before if you saw was bash",
    "start": "360120",
    "end": "362520"
  },
  {
    "text": "and Bash has this lovely little utility",
    "start": "362520",
    "end": "364280"
  },
  {
    "text": "called Dev TCP which standard usage is",
    "start": "364280",
    "end": "368240"
  },
  {
    "text": "to open a Remote TCP connection um we're",
    "start": "368240",
    "end": "371720"
  },
  {
    "text": "basically going to use the exact same",
    "start": "371720",
    "end": "373360"
  },
  {
    "text": "thing except we're going to open an HTTP",
    "start": "373360",
    "end": "376120"
  },
  {
    "text": "connection and request a",
    "start": "376120",
    "end": "379440"
  },
  {
    "text": "file",
    "start": "379440",
    "end": "382120"
  },
  {
    "text": "now the reason we can sort of do this is",
    "start": "382120",
    "end": "385919"
  },
  {
    "text": "invoking a function via the terminal",
    "start": "385919",
    "end": "387680"
  },
  {
    "text": "doesn't actually write anything to disk",
    "start": "387680",
    "end": "389599"
  },
  {
    "text": "it lives in the memory of the terminal",
    "start": "389599",
    "end": "390960"
  },
  {
    "text": "it's ephemeral as soon as the terminal",
    "start": "390960",
    "end": "392599"
  },
  {
    "text": "dies this function dies as well so now",
    "start": "392599",
    "end": "395960"
  },
  {
    "text": "we've sort of covered that first stage",
    "start": "395960",
    "end": "397520"
  },
  {
    "text": "how do we get our code onto the machine",
    "start": "397520",
    "end": "399440"
  },
  {
    "text": "in the first",
    "start": "399440",
    "end": "400520"
  },
  {
    "text": "place now the second thing how do we",
    "start": "400520",
    "end": "403440"
  },
  {
    "text": "execute it as we said it's a real only",
    "start": "403440",
    "end": "405479"
  },
  {
    "text": "file system we have nowhere to store it",
    "start": "405479",
    "end": "407360"
  },
  {
    "text": "so I'm s that I'm sure that a lot of you",
    "start": "407360",
    "end": "409280"
  },
  {
    "text": "when you kind of saw the title of the",
    "start": "409280",
    "end": "410520"
  },
  {
    "text": "talk immediately went to oh in memory",
    "start": "410520",
    "end": "413199"
  },
  {
    "text": "execution and I'm a people pleaser so",
    "start": "413199",
    "end": "415960"
  },
  {
    "text": "that is what we're going to do um so",
    "start": "415960",
    "end": "419080"
  },
  {
    "text": "basically basically when I was kind of",
    "start": "419080",
    "end": "420199"
  },
  {
    "text": "going through and looking at ways to do",
    "start": "420199",
    "end": "421560"
  },
  {
    "text": "this I came across a tool by a guy",
    "start": "421560",
    "end": "424319"
  },
  {
    "text": "called dieago Gutierrez tools called DD",
    "start": "424319",
    "end": "427360"
  },
  {
    "text": "exec essentially what it allows us to do",
    "start": "427360",
    "end": "429479"
  },
  {
    "text": "is hijack a process that's running um",
    "start": "429479",
    "end": "432560"
  },
  {
    "text": "and run our own binary on top of",
    "start": "432560",
    "end": "436360"
  },
  {
    "text": "that",
    "start": "436360",
    "end": "438000"
  },
  {
    "text": "simply um now the second thing we kind",
    "start": "438000",
    "end": "440879"
  },
  {
    "text": "of second complexity we encounter when",
    "start": "440879",
    "end": "442680"
  },
  {
    "text": "we're trying to use DD exac is now we're",
    "start": "442680",
    "end": "444759"
  },
  {
    "text": "not looking at one file we're looking at",
    "start": "444759",
    "end": "446400"
  },
  {
    "text": "two files we need DD exac and we need a",
    "start": "446400",
    "end": "449759"
  },
  {
    "text": "binary that we want to run right DD exec",
    "start": "449759",
    "end": "452759"
  },
  {
    "text": "takes in our code as a um as its input",
    "start": "452759",
    "end": "458000"
  },
  {
    "text": "so we're looking at two files that we",
    "start": "458000",
    "end": "459400"
  },
  {
    "text": "need to retrieve and we need to run them",
    "start": "459400",
    "end": "462319"
  },
  {
    "text": "but we don't have a place to store them",
    "start": "462319",
    "end": "464720"
  },
  {
    "text": "this is where a bit of bash magic bash",
    "start": "464720",
    "end": "466280"
  },
  {
    "text": "redirection comes in so basically what",
    "start": "466280",
    "end": "469199"
  },
  {
    "text": "we're going to",
    "start": "469199",
    "end": "471680"
  },
  {
    "text": "do there we go we run our function to",
    "start": "471759",
    "end": "474840"
  },
  {
    "text": "get our base 64 binary which is what uh",
    "start": "474840",
    "end": "477280"
  },
  {
    "text": "DD exac takes in as input we then feed",
    "start": "477280",
    "end": "480280"
  },
  {
    "text": "that into bash which is taking in DD",
    "start": "480280",
    "end": "482400"
  },
  {
    "text": "exec run it all simultaneously and what",
    "start": "482400",
    "end": "484879"
  },
  {
    "text": "we'll see here on the right um on the",
    "start": "484879",
    "end": "487680"
  },
  {
    "text": "top is just a simple HTTP server on the",
    "start": "487680",
    "end": "490479"
  },
  {
    "text": "bottom is a listener and what we're",
    "start": "490479",
    "end": "492879"
  },
  {
    "text": "going to see is two incoming requests",
    "start": "492879",
    "end": "495000"
  },
  {
    "text": "for those two",
    "start": "495000",
    "end": "496280"
  },
  {
    "text": "files and a connection back to our",
    "start": "496280",
    "end": "500280"
  },
  {
    "text": "host and once we check the connection we",
    "start": "500280",
    "end": "502639"
  },
  {
    "text": "can see very imaginative name method one",
    "start": "502639",
    "end": "506199"
  },
  {
    "text": "pod so just sort of a quick recap of",
    "start": "506199",
    "end": "508840"
  },
  {
    "text": "that",
    "start": "508840",
    "end": "509919"
  },
  {
    "text": "we use the dev TCP utility as sort of a",
    "start": "509919",
    "end": "513560"
  },
  {
    "text": "mini very simplistic version of WG or of",
    "start": "513560",
    "end": "516320"
  },
  {
    "text": "curl in order to retrieve the files that",
    "start": "516320",
    "end": "518279"
  },
  {
    "text": "we want we then get those files and",
    "start": "518279",
    "end": "520518"
  },
  {
    "text": "using DD exec and some battery direction",
    "start": "520519",
    "end": "523518"
  },
  {
    "text": "we execute them and we get code",
    "start": "523519",
    "end": "525920"
  },
  {
    "text": "execution now again in this case we used",
    "start": "525920",
    "end": "528040"
  },
  {
    "text": "a reverse shell this has worked with",
    "start": "528040",
    "end": "530000"
  },
  {
    "text": "Amic contained with Cube CTL Cube",
    "start": "530000",
    "end": "531760"
  },
  {
    "text": "control um the issue with the bigger",
    "start": "531760",
    "end": "534080"
  },
  {
    "text": "binaries is because the way that",
    "start": "534080",
    "end": "536120"
  },
  {
    "text": "function was built it won't always",
    "start": "536120",
    "end": "538200"
  },
  {
    "text": "necessarily read all the BS correctly so",
    "start": "538200",
    "end": "540600"
  },
  {
    "text": "you might have to kind of try a few",
    "start": "540600",
    "end": "542320"
  },
  {
    "text": "times eventually it will",
    "start": "542320",
    "end": "544360"
  },
  {
    "text": "run so when I was doing this research",
    "start": "544360",
    "end": "546600"
  },
  {
    "text": "what I wanted to do is kind of start",
    "start": "546600",
    "end": "547959"
  },
  {
    "text": "from the top up and just strip away",
    "start": "547959",
    "end": "549600"
  },
  {
    "text": "dependencies as I go so for the eagley",
    "start": "549600",
    "end": "554440"
  },
  {
    "text": "uh one of the biggest dependencies of",
    "start": "554440",
    "end": "555839"
  },
  {
    "text": "the last one was bash having bash on the",
    "start": "555839",
    "end": "557920"
  },
  {
    "text": "machine now people that deal with",
    "start": "557920",
    "end": "559959"
  },
  {
    "text": "containers a lot know that that's not",
    "start": "559959",
    "end": "562160"
  },
  {
    "text": "even not always the case it's rarely the",
    "start": "562160",
    "end": "563680"
  },
  {
    "text": "case so in the second method we kind of",
    "start": "563680",
    "end": "566160"
  },
  {
    "text": "moved away from that and we're going to",
    "start": "566160",
    "end": "567560"
  },
  {
    "text": "be using an Alpine image which does not",
    "start": "567560",
    "end": "570760"
  },
  {
    "text": "have bash it only has",
    "start": "570760",
    "end": "572320"
  },
  {
    "text": "sh um again no standard Network Tools uh",
    "start": "572320",
    "end": "576320"
  },
  {
    "text": "you may see that there's a little",
    "start": "576320",
    "end": "577480"
  },
  {
    "text": "asteris by the WG we'll get to that in a",
    "start": "577480",
    "end": "580000"
  },
  {
    "text": "just a",
    "start": "580000",
    "end": "580839"
  },
  {
    "text": "second um and what we can see here is",
    "start": "580839",
    "end": "582959"
  },
  {
    "text": "again the security context uh read only",
    "start": "582959",
    "end": "585360"
  },
  {
    "text": "file system set to true and we're",
    "start": "585360",
    "end": "587200"
  },
  {
    "text": "running as a low privileged user also",
    "start": "587200",
    "end": "589560"
  },
  {
    "text": "just uh something to kind of keep in",
    "start": "589560",
    "end": "591120"
  },
  {
    "text": "mind for a second just remember that",
    "start": "591120",
    "end": "593519"
  },
  {
    "text": "second profile thing for later on we'll",
    "start": "593519",
    "end": "595640"
  },
  {
    "text": "get to that",
    "start": "595640",
    "end": "598120"
  },
  {
    "text": "eventually so for our second",
    "start": "598120",
    "end": "601560"
  },
  {
    "text": "demo um so again just first making sure",
    "start": "601560",
    "end": "605760"
  },
  {
    "text": "we do have a readon file system now",
    "start": "605760",
    "end": "607920"
  },
  {
    "text": "again going back to sort of the the",
    "start": "607920",
    "end": "612640"
  },
  {
    "text": "split that we did before we need first a",
    "start": "612640",
    "end": "614640"
  },
  {
    "text": "way to retrieve our files retrieve our",
    "start": "614640",
    "end": "616600"
  },
  {
    "text": "executables and we need to way to run",
    "start": "616600",
    "end": "619640"
  },
  {
    "text": "them now I spent far longer than I care",
    "start": "619640",
    "end": "622839"
  },
  {
    "text": "to admit trying to get my Dev TCP",
    "start": "622839",
    "end": "624600"
  },
  {
    "text": "function to work in sh trying to kind of",
    "start": "624600",
    "end": "627040"
  },
  {
    "text": "move that around uh and it took took me",
    "start": "627040",
    "end": "629959"
  },
  {
    "text": "again far longer than I care to admit to",
    "start": "629959",
    "end": "631399"
  },
  {
    "text": "realize that Dev TCP is a bash utility",
    "start": "631399",
    "end": "633480"
  },
  {
    "text": "and no matter how much I change that",
    "start": "633480",
    "end": "635240"
  },
  {
    "text": "function sh just doesn't know it so",
    "start": "635240",
    "end": "638519"
  },
  {
    "text": "after a lot of trial and error and a lot",
    "start": "638519",
    "end": "640320"
  },
  {
    "text": "of banging my head against the wall I",
    "start": "640320",
    "end": "642839"
  },
  {
    "text": "did what any normal person would do and",
    "start": "642839",
    "end": "644320"
  },
  {
    "text": "check the binaries that are on the host",
    "start": "644320",
    "end": "646120"
  },
  {
    "text": "in the first place um and what you're",
    "start": "646120",
    "end": "648880"
  },
  {
    "text": "going to see here is something else",
    "start": "648880",
    "end": "650200"
  },
  {
    "text": "first but we'll get to that in a",
    "start": "650200",
    "end": "652240"
  },
  {
    "text": "second so when looking at the binaries",
    "start": "652240",
    "end": "655040"
  },
  {
    "text": "what we can see and it's nice and green",
    "start": "655040",
    "end": "656680"
  },
  {
    "text": "as well H is buy box",
    "start": "656680",
    "end": "659600"
  },
  {
    "text": "now byy box is basically sort of a Swiss",
    "start": "659600",
    "end": "661560"
  },
  {
    "text": "army knife of binaries it's a utility",
    "start": "661560",
    "end": "664760"
  },
  {
    "text": "that's really efficient really small it",
    "start": "664760",
    "end": "666720"
  },
  {
    "text": "encompasses a lot of different sort of",
    "start": "666720",
    "end": "668560"
  },
  {
    "text": "binaries within it it's used a lot in",
    "start": "668560",
    "end": "670839"
  },
  {
    "text": "Android it's used a lot in container",
    "start": "670839",
    "end": "672920"
  },
  {
    "text": "images just because of its efficiency",
    "start": "672920",
    "end": "674600"
  },
  {
    "text": "because of its size and one of its",
    "start": "674600",
    "end": "677120"
  },
  {
    "text": "lovely little utilities is busy box W",
    "start": "677120",
    "end": "679279"
  },
  {
    "text": "get hence the asterisk before so that's",
    "start": "679279",
    "end": "682440"
  },
  {
    "text": "sort of the one issue that we had how do",
    "start": "682440",
    "end": "685120"
  },
  {
    "text": "we get files onto the box and that's",
    "start": "685120",
    "end": "686800"
  },
  {
    "text": "solved we can just use busy box W get",
    "start": "686800",
    "end": "690079"
  },
  {
    "text": "now you can see just above that the",
    "start": "690079",
    "end": "692639"
  },
  {
    "text": "mount",
    "start": "692639",
    "end": "693800"
  },
  {
    "text": "command um",
    "start": "693800",
    "end": "695839"
  },
  {
    "text": "basically because we don't have bash and",
    "start": "695839",
    "end": "698000"
  },
  {
    "text": "we don't have that redirection sh is a",
    "start": "698000",
    "end": "699680"
  },
  {
    "text": "bit more trickier with those kind of",
    "start": "699680",
    "end": "701000"
  },
  {
    "text": "things I needed to find a place to store",
    "start": "701000",
    "end": "703120"
  },
  {
    "text": "these",
    "start": "703120",
    "end": "704160"
  },
  {
    "text": "files now for use Mount and here I just",
    "start": "704160",
    "end": "706440"
  },
  {
    "text": "made it simple so it's easier to view",
    "start": "706440",
    "end": "709279"
  },
  {
    "text": "basically gret for shm we can see on the",
    "start": "709279",
    "end": "712000"
  },
  {
    "text": "right uh the First Column after",
    "start": "712000",
    "end": "715399"
  },
  {
    "text": "the brackets uh read WR so it's a right",
    "start": "715399",
    "end": "719079"
  },
  {
    "text": "able Mount and we'll also see on the",
    "start": "719079",
    "end": "721720"
  },
  {
    "text": "fourth column it's marked as no exec now",
    "start": "721720",
    "end": "725279"
  },
  {
    "text": "no exec means that we can't execute",
    "start": "725279",
    "end": "727320"
  },
  {
    "text": "anything from within that mount space",
    "start": "727320",
    "end": "729279"
  },
  {
    "text": "which is a bummer but we can write to it",
    "start": "729279",
    "end": "732800"
  },
  {
    "text": "now why can we write to it devast hm is",
    "start": "732800",
    "end": "735440"
  },
  {
    "text": "basically the shared memory concept",
    "start": "735440",
    "end": "737240"
  },
  {
    "text": "implementation in Unix environments now",
    "start": "737240",
    "end": "740880"
  },
  {
    "text": "what that means is it's used for",
    "start": "740880",
    "end": "742240"
  },
  {
    "text": "interprocess communication it makes our",
    "start": "742240",
    "end": "744480"
  },
  {
    "text": "systems run more",
    "start": "744480",
    "end": "746920"
  },
  {
    "text": "smoother um and realistically you're",
    "start": "746920",
    "end": "750199"
  },
  {
    "text": "never going to see that as readon CU it",
    "start": "750199",
    "end": "752199"
  },
  {
    "text": "will hinder performance quite a lot and",
    "start": "752199",
    "end": "754880"
  },
  {
    "text": "even in read only file systems as this",
    "start": "754880",
    "end": "756519"
  },
  {
    "text": "is you'll still see it as",
    "start": "756519",
    "end": "758880"
  },
  {
    "text": "writable now just keep that no exact in",
    "start": "758880",
    "end": "761360"
  },
  {
    "text": "your mind for just another",
    "start": "761360",
    "end": "763480"
  },
  {
    "text": "moment so basically the next thing we're",
    "start": "763480",
    "end": "766360"
  },
  {
    "text": "going to do and I know this is very",
    "start": "766360",
    "end": "767600"
  },
  {
    "text": "messy uh I just noticed it actually",
    "start": "767600",
    "end": "770040"
  },
  {
    "text": "pasted twice so you'll forgive me for",
    "start": "770040",
    "end": "771760"
  },
  {
    "text": "that one basically what we're going to",
    "start": "771760",
    "end": "773399"
  },
  {
    "text": "do is use um an environment variable",
    "start": "773399",
    "end": "775800"
  },
  {
    "text": "just to create a temporary file in devm",
    "start": "775800",
    "end": "778839"
  },
  {
    "text": "we'll then use busy box W get in order",
    "start": "778839",
    "end": "781000"
  },
  {
    "text": "to get ddsc which again is a tool",
    "start": "781000",
    "end": "783519"
  },
  {
    "text": "developed by Yago Gutierrez it",
    "start": "783519",
    "end": "786120"
  },
  {
    "text": "essentially does the exact same thing",
    "start": "786120",
    "end": "788079"
  },
  {
    "text": "that DD exec does except it takes in raw",
    "start": "788079",
    "end": "790480"
  },
  {
    "text": "Shell Code as an argument um so again it",
    "start": "790480",
    "end": "794120"
  },
  {
    "text": "just allows us to replace an existing",
    "start": "794120",
    "end": "795959"
  },
  {
    "text": "process in memory with our",
    "start": "795959",
    "end": "798399"
  },
  {
    "text": "own and then the second thing you can",
    "start": "798399",
    "end": "800720"
  },
  {
    "text": "see which is the last two lines is",
    "start": "800720",
    "end": "802839"
  },
  {
    "text": "another environment variable just our",
    "start": "802839",
    "end": "804800"
  },
  {
    "text": "code and then we're echoing some Shell",
    "start": "804800",
    "end": "806760"
  },
  {
    "text": "Code into that that shell code is",
    "start": "806760",
    "end": "808800"
  },
  {
    "text": "essentially just again a reverse",
    "start": "808800",
    "end": "811279"
  },
  {
    "text": "shell now once we do those two things we",
    "start": "811279",
    "end": "814000"
  },
  {
    "text": "have one more issue to",
    "start": "814000",
    "end": "816079"
  },
  {
    "text": "tackle the no exec issue now Dev hm like",
    "start": "816079",
    "end": "820360"
  },
  {
    "text": "we said we've written to it we've got",
    "start": "820360",
    "end": "822160"
  },
  {
    "text": "our files in there but we can't execute",
    "start": "822160",
    "end": "824320"
  },
  {
    "text": "anything from within there so what what",
    "start": "824320",
    "end": "826040"
  },
  {
    "text": "can we do to tackle that now this is a",
    "start": "826040",
    "end": "829079"
  },
  {
    "text": "bit of a me banging my head against the",
    "start": "829079",
    "end": "831519"
  },
  {
    "text": "wall for a while and then eventually",
    "start": "831519",
    "end": "832800"
  },
  {
    "text": "realizing oh this is actually quite",
    "start": "832800",
    "end": "834680"
  },
  {
    "text": "simple ddsc is a shell script we can run",
    "start": "834680",
    "end": "838399"
  },
  {
    "text": "it using using SH now it's true that",
    "start": "838399",
    "end": "840720"
  },
  {
    "text": "ddsc is in a no exact Mount but sh is is",
    "start": "840720",
    "end": "845360"
  },
  {
    "text": "in an executable Mount which we can't",
    "start": "845360",
    "end": "847040"
  },
  {
    "text": "write to so if we run it under the",
    "start": "847040",
    "end": "849079"
  },
  {
    "text": "context of",
    "start": "849079",
    "end": "850480"
  },
  {
    "text": "sh which again is in an executable mount",
    "start": "850480",
    "end": "853399"
  },
  {
    "text": "it will actually run and we'll get our",
    "start": "853399",
    "end": "855639"
  },
  {
    "text": "connection back just as",
    "start": "855639",
    "end": "858839"
  },
  {
    "text": "before so again just a quick recap on",
    "start": "858959",
    "end": "861600"
  },
  {
    "text": "that we use buybox W get in order to get",
    "start": "861600",
    "end": "864040"
  },
  {
    "text": "our binaries we then stored them in",
    "start": "864040",
    "end": "866839"
  },
  {
    "text": "devm which is right able but is not",
    "start": "866839",
    "end": "870199"
  },
  {
    "text": "executable and then under the context of",
    "start": "870199",
    "end": "872440"
  },
  {
    "text": "sh which is in an executable",
    "start": "872440",
    "end": "874839"
  },
  {
    "text": "Mount we manag managed to run it and we",
    "start": "874839",
    "end": "877320"
  },
  {
    "text": "get code",
    "start": "877320",
    "end": "878800"
  },
  {
    "text": "execution now very imaginative for the",
    "start": "878800",
    "end": "881199"
  },
  {
    "text": "last method we'll be looking at the",
    "start": "881199",
    "end": "883240"
  },
  {
    "text": "exact same container as before so again",
    "start": "883240",
    "end": "885720"
  },
  {
    "text": "Alpine image it has sh but not bash and",
    "start": "885720",
    "end": "889839"
  },
  {
    "text": "at this point the W get with the",
    "start": "889839",
    "end": "891240"
  },
  {
    "text": "asterisk isn't so mysterious anymore we",
    "start": "891240",
    "end": "893079"
  },
  {
    "text": "have busy box W get um again readon file",
    "start": "893079",
    "end": "897040"
  },
  {
    "text": "system lowle uh um low privileged user",
    "start": "897040",
    "end": "901120"
  },
  {
    "text": "and again just keeping in mind that",
    "start": "901120",
    "end": "902360"
  },
  {
    "text": "second on profile for a",
    "start": "902360",
    "end": "903959"
  },
  {
    "text": "minute so in this sort of final",
    "start": "903959",
    "end": "908639"
  },
  {
    "text": "method",
    "start": "908639",
    "end": "911639"
  },
  {
    "text": "sec in this final method I wanted to",
    "start": "914560",
    "end": "918120"
  },
  {
    "text": "focus or rather take the focus away from",
    "start": "918120",
    "end": "920399"
  },
  {
    "text": "sort of that in memory execution kind of",
    "start": "920399",
    "end": "922199"
  },
  {
    "text": "style of things and I wanted to look",
    "start": "922199",
    "end": "924079"
  },
  {
    "text": "maybe for something a bit more Cube",
    "start": "924079",
    "end": "926279"
  },
  {
    "text": "specific um so again just to kind of",
    "start": "926279",
    "end": "928360"
  },
  {
    "text": "start",
    "start": "928360",
    "end": "929959"
  },
  {
    "text": "off we can see that we've got a read",
    "start": "929959",
    "end": "931920"
  },
  {
    "text": "only file system",
    "start": "931920",
    "end": "934560"
  },
  {
    "text": "now what I was examining in this one was",
    "start": "934560",
    "end": "938240"
  },
  {
    "text": "the ability to use a dynamic Linker in",
    "start": "938240",
    "end": "940600"
  },
  {
    "text": "order to execute my code which isn't",
    "start": "940600",
    "end": "943759"
  },
  {
    "text": "necessarily executable at the file",
    "start": "943759",
    "end": "945880"
  },
  {
    "text": "permission level so at the discretionary",
    "start": "945880",
    "end": "947319"
  },
  {
    "text": "Access Control",
    "start": "947319",
    "end": "948480"
  },
  {
    "text": "level so ldd basically gives us that",
    "start": "948480",
    "end": "951600"
  },
  {
    "text": "output of what our Linker is as you can",
    "start": "951600",
    "end": "954279"
  },
  {
    "text": "see there lield muscle and all that",
    "start": "954279",
    "end": "956680"
  },
  {
    "text": "lovely stuff basically what a dynamic",
    "start": "956680",
    "end": "959079"
  },
  {
    "text": "Dynamic link library is uh it resolves",
    "start": "959079",
    "end": "962120"
  },
  {
    "text": "symbols at runtime it um loads a shared",
    "start": "962120",
    "end": "966720"
  },
  {
    "text": "libraries all those kind of things what",
    "start": "966720",
    "end": "968319"
  },
  {
    "text": "we care about",
    "start": "968319",
    "end": "970720"
  },
  {
    "text": "is basically code that was compiled",
    "start": "970720",
    "end": "973199"
  },
  {
    "text": "using a compiler that",
    "start": "973199",
    "end": "975040"
  },
  {
    "text": "matches um our Dynamic Linker we can use",
    "start": "975040",
    "end": "978519"
  },
  {
    "text": "the dynamic Linker to run directly",
    "start": "978519",
    "end": "980959"
  },
  {
    "text": "regardless of the specific individual",
    "start": "980959",
    "end": "982880"
  },
  {
    "text": "file permissions so now that we know",
    "start": "982880",
    "end": "985519"
  },
  {
    "text": "that that's our our Dynamic Linker we",
    "start": "985519",
    "end": "988680"
  },
  {
    "text": "can go ahead and compile whatever we",
    "start": "988680",
    "end": "991160"
  },
  {
    "text": "want to run so in this case again a",
    "start": "991160",
    "end": "992440"
  },
  {
    "text": "reverse shell using a matching compiler",
    "start": "992440",
    "end": "995120"
  },
  {
    "text": "and we can then run it the one",
    "start": "995120",
    "end": "997720"
  },
  {
    "text": "issue where do we write a file to um the",
    "start": "997720",
    "end": "1001800"
  },
  {
    "text": "initial thought that I had here was",
    "start": "1001800",
    "end": "1003040"
  },
  {
    "text": "again Dev hm but unfortunately the",
    "start": "1003040",
    "end": "1005199"
  },
  {
    "text": "dynamic",
    "start": "1005199",
    "end": "1006199"
  },
  {
    "text": "Linker lacks what sh does and it doesn't",
    "start": "1006199",
    "end": "1010240"
  },
  {
    "text": "um sort of get around the no exact",
    "start": "1010240",
    "end": "1013240"
  },
  {
    "text": "restriction so again we're just going to",
    "start": "1013240",
    "end": "1015079"
  },
  {
    "text": "have to go through our",
    "start": "1015079",
    "end": "1016360"
  },
  {
    "text": "mounts and what we'll do here is",
    "start": "1016360",
    "end": "1019560"
  },
  {
    "text": "grep for any Mount that is read",
    "start": "1019560",
    "end": "1023480"
  },
  {
    "text": "writable and then get rid of all of",
    "start": "1023480",
    "end": "1025640"
  },
  {
    "text": "those that are marked no exec now the",
    "start": "1025640",
    "end": "1027640"
  },
  {
    "text": "bottom three aren't relevant for us as",
    "start": "1027640",
    "end": "1030720"
  },
  {
    "text": "is the top one as well the ones that we",
    "start": "1030720",
    "end": "1032839"
  },
  {
    "text": "care about are the two line starting",
    "start": "1032839",
    "end": "1034640"
  },
  {
    "text": "with Dev",
    "start": "1034640",
    "end": "1035720"
  },
  {
    "text": "SDA uh let's start with ety hosts",
    "start": "1035720",
    "end": "1038600"
  },
  {
    "text": "everything that I show you now will also",
    "start": "1038600",
    "end": "1040839"
  },
  {
    "text": "work using ety hosts the two issues you",
    "start": "1040839",
    "end": "1044120"
  },
  {
    "text": "might find there is one you need to be",
    "start": "1044120",
    "end": "1045760"
  },
  {
    "text": "root two it may screw up a lot of your",
    "start": "1045760",
    "end": "1047959"
  },
  {
    "text": "networking",
    "start": "1047959",
    "end": "1049080"
  },
  {
    "text": "uh definitely not something that I did",
    "start": "1049080",
    "end": "1052280"
  },
  {
    "text": "second file that we have is Dev",
    "start": "1052280",
    "end": "1053840"
  },
  {
    "text": "termination log now just before we get",
    "start": "1053840",
    "end": "1055760"
  },
  {
    "text": "into what that is let's check the",
    "start": "1055760",
    "end": "1057520"
  },
  {
    "text": "individual file",
    "start": "1057520",
    "end": "1060360"
  },
  {
    "text": "permissions and as we can see not only",
    "start": "1060360",
    "end": "1063360"
  },
  {
    "text": "is it writable it's globally",
    "start": "1063360",
    "end": "1066160"
  },
  {
    "text": "writable why is that so Dev termination",
    "start": "1066160",
    "end": "1068799"
  },
  {
    "text": "log is a specific kubernetes thing every",
    "start": "1068799",
    "end": "1071880"
  },
  {
    "text": "pod that gets deployed gets deployed",
    "start": "1071880",
    "end": "1074360"
  },
  {
    "text": "with a field that says a termination",
    "start": "1074360",
    "end": "1076919"
  },
  {
    "text": "message path essentially what this is",
    "start": "1076919",
    "end": "1079360"
  },
  {
    "text": "It's a log if our pod failed why did it",
    "start": "1079360",
    "end": "1082440"
  },
  {
    "text": "fail everything all that information",
    "start": "1082440",
    "end": "1083760"
  },
  {
    "text": "gets written into this termination log",
    "start": "1083760",
    "end": "1086400"
  },
  {
    "text": "so if you think about it it makes sense",
    "start": "1086400",
    "end": "1089120"
  },
  {
    "text": "why it is globally writable any process",
    "start": "1089120",
    "end": "1091240"
  },
  {
    "text": "can cause a pod to crash how do we sort",
    "start": "1091240",
    "end": "1093480"
  },
  {
    "text": "of we those out we can't everything",
    "start": "1093480",
    "end": "1096320"
  },
  {
    "text": "needs to be able to write to it so that",
    "start": "1096320",
    "end": "1097840"
  },
  {
    "text": "that part fair enough and again that",
    "start": "1097840",
    "end": "1100559"
  },
  {
    "text": "amount is writable for the exact same",
    "start": "1100559",
    "end": "1103080"
  },
  {
    "text": "reasons however it's not marked no exec",
    "start": "1103080",
    "end": "1106679"
  },
  {
    "text": "meaning even though that file",
    "start": "1106679",
    "end": "1109080"
  },
  {
    "text": "specifically isn't an executable the",
    "start": "1109080",
    "end": "1111760"
  },
  {
    "text": "amount that it resides in",
    "start": "1111760",
    "end": "1114039"
  },
  {
    "text": "is so once we have all of that what",
    "start": "1114039",
    "end": "1117440"
  },
  {
    "text": "we're going to do is basically a reverse",
    "start": "1117440",
    "end": "1120440"
  },
  {
    "text": "shell and C nothing too",
    "start": "1120440",
    "end": "1122919"
  },
  {
    "text": "snazzy we're then going to compile it",
    "start": "1122919",
    "end": "1125280"
  },
  {
    "text": "and uh I used some environment variables",
    "start": "1125280",
    "end": "1127280"
  },
  {
    "text": "not not really too thingy basically what",
    "start": "1127280",
    "end": "1128960"
  },
  {
    "text": "we're doing here is using muscle GCC",
    "start": "1128960",
    "end": "1131039"
  },
  {
    "text": "which is the equivalent compiler to our",
    "start": "1131039",
    "end": "1132679"
  },
  {
    "text": "Dynamic Linker in order to compile that",
    "start": "1132679",
    "end": "1136200"
  },
  {
    "text": "program once we do that we're going to",
    "start": "1136200",
    "end": "1139200"
  },
  {
    "text": "serve it using just a simple HTTP server",
    "start": "1139200",
    "end": "1141919"
  },
  {
    "text": "and we'll start our listener and once we",
    "start": "1141919",
    "end": "1144480"
  },
  {
    "text": "do that what we're going to do is use",
    "start": "1144480",
    "end": "1146720"
  },
  {
    "text": "busy box W get again in order to get our",
    "start": "1146720",
    "end": "1150600"
  },
  {
    "text": "uh reverse shell or our binary into Dev",
    "start": "1150600",
    "end": "1153520"
  },
  {
    "text": "termination logs that store it into",
    "start": "1153520",
    "end": "1155159"
  },
  {
    "text": "there once we do that we can use a our",
    "start": "1155159",
    "end": "1158000"
  },
  {
    "text": "Dynamic Linker in order to execute that",
    "start": "1158000",
    "end": "1160559"
  },
  {
    "text": "even though the individual file",
    "start": "1160559",
    "end": "1162520"
  },
  {
    "text": "permissions don't specify anything about",
    "start": "1162520",
    "end": "1165720"
  },
  {
    "text": "execution and there we have it",
    "start": "1165720",
    "end": "1169880"
  },
  {
    "text": "so again just a quick recap we use busy",
    "start": "1169880",
    "end": "1172520"
  },
  {
    "text": "box W get in order to get our binary in",
    "start": "1172520",
    "end": "1174840"
  },
  {
    "text": "this case just singular we store it in",
    "start": "1174840",
    "end": "1177080"
  },
  {
    "text": "termination log which again globally",
    "start": "1177080",
    "end": "1180120"
  },
  {
    "text": "writable in a writable Mount and an and",
    "start": "1180120",
    "end": "1183280"
  },
  {
    "text": "in an executable Mount the file itself",
    "start": "1183280",
    "end": "1187120"
  },
  {
    "text": "doesn't have any execute permissions on",
    "start": "1187120",
    "end": "1188640"
  },
  {
    "text": "it but Dynamic Linker doesn't really",
    "start": "1188640",
    "end": "1190280"
  },
  {
    "text": "care it's a binary that it recognizes",
    "start": "1190280",
    "end": "1192120"
  },
  {
    "text": "it's in an executable amount it will",
    "start": "1192120",
    "end": "1194000"
  },
  {
    "text": "execute it and we get code execution now",
    "start": "1194000",
    "end": "1198039"
  },
  {
    "text": "this this one's a bit of an interesting",
    "start": "1198039",
    "end": "1199400"
  },
  {
    "text": "one because basically it's a kubernetes",
    "start": "1199400",
    "end": "1202679"
  },
  {
    "text": "default every pod that you've ever",
    "start": "1202679",
    "end": "1204440"
  },
  {
    "text": "deployed is deployed with a termination",
    "start": "1204440",
    "end": "1206600"
  },
  {
    "text": "loog in this exact same",
    "start": "1206600",
    "end": "1209400"
  },
  {
    "text": "configuration now granted this is a bit",
    "start": "1209400",
    "end": "1211480"
  },
  {
    "text": "more of a limited attack because you can",
    "start": "1211480",
    "end": "1213360"
  },
  {
    "text": "only run the binaries that you can",
    "start": "1213360",
    "end": "1215320"
  },
  {
    "text": "compile to match the compiler still a",
    "start": "1215320",
    "end": "1218080"
  },
  {
    "text": "lot of damage can be",
    "start": "1218080",
    "end": "1219799"
  },
  {
    "text": "done so now that we've kind of talked",
    "start": "1219799",
    "end": "1221799"
  },
  {
    "text": "about all the different methods um I'll",
    "start": "1221799",
    "end": "1223840"
  },
  {
    "text": "ask you to ignore your ADHD here for a",
    "start": "1223840",
    "end": "1226440"
  },
  {
    "text": "second and just ignore the left side of",
    "start": "1226440",
    "end": "1227919"
  },
  {
    "text": "the screen for just a moment now let's",
    "start": "1227919",
    "end": "1230760"
  },
  {
    "text": "start and talk about SEC",
    "start": "1230760",
    "end": "1232280"
  },
  {
    "text": "comp you may be a bit confused because",
    "start": "1232280",
    "end": "1234559"
  },
  {
    "text": "I'm saying here that the default runtime",
    "start": "1234559",
    "end": "1236159"
  },
  {
    "text": "profile will actually block the first",
    "start": "1236159",
    "end": "1238320"
  },
  {
    "text": "two",
    "start": "1238320",
    "end": "1239280"
  },
  {
    "text": "attacks but if you recall back there all",
    "start": "1239280",
    "end": "1242840"
  },
  {
    "text": "of the pods that I deployed had a second",
    "start": "1242840",
    "end": "1244799"
  },
  {
    "text": "profile and it was the default runtime",
    "start": "1244799",
    "end": "1246320"
  },
  {
    "text": "one now why did I leave this in because",
    "start": "1246320",
    "end": "1248799"
  },
  {
    "text": "a I wasn't using Docker as my runtime",
    "start": "1248799",
    "end": "1250520"
  },
  {
    "text": "was using container D and my point here",
    "start": "1250520",
    "end": "1253880"
  },
  {
    "text": "is whenever you think something's",
    "start": "1253880",
    "end": "1256080"
  },
  {
    "text": "happening don't just take the",
    "start": "1256080",
    "end": "1258600"
  },
  {
    "text": "configurations word for it go out and",
    "start": "1258600",
    "end": "1260159"
  },
  {
    "text": "check it properly container D doesn't",
    "start": "1260159",
    "end": "1262200"
  },
  {
    "text": "always deploy with a default runtime",
    "start": "1262200",
    "end": "1263600"
  },
  {
    "text": "profile it won't SP out any errors when",
    "start": "1263600",
    "end": "1265880"
  },
  {
    "text": "you try and deploy something with the",
    "start": "1265880",
    "end": "1267240"
  },
  {
    "text": "default runtime profile and basically",
    "start": "1267240",
    "end": "1270159"
  },
  {
    "text": "this is the situation if you go into one",
    "start": "1270159",
    "end": "1271600"
  },
  {
    "text": "of those pods and run am I contained you",
    "start": "1271600",
    "end": "1273400"
  },
  {
    "text": "won't see any second on profile um so",
    "start": "1273400",
    "end": "1275919"
  },
  {
    "text": "again if it did have a default run on",
    "start": "1275919",
    "end": "1277600"
  },
  {
    "text": "profile the first two would not have",
    "start": "1277600",
    "end": "1280200"
  },
  {
    "text": "worked so that is sort of mitigation",
    "start": "1280200",
    "end": "1282640"
  },
  {
    "text": "number one for the first two",
    "start": "1282640",
    "end": "1286240"
  },
  {
    "text": "attacks",
    "start": "1287039",
    "end": "1290039"
  },
  {
    "text": "a second option and I can already hear",
    "start": "1291760",
    "end": "1294200"
  },
  {
    "text": "the confusion in the room is SC Linux",
    "start": "1294200",
    "end": "1296960"
  },
  {
    "text": "now SC Linux is an amazing tool it's",
    "start": "1296960",
    "end": "1300880"
  },
  {
    "text": "also amazingly complicated and you're",
    "start": "1300880",
    "end": "1304400"
  },
  {
    "text": "more than likely to ruin a lot of your",
    "start": "1304400",
    "end": "1307919"
  },
  {
    "text": "environment more than you are to fix",
    "start": "1307919",
    "end": "1310960"
  },
  {
    "text": "certain things so again if you know how",
    "start": "1310960",
    "end": "1313279"
  },
  {
    "text": "to use it if you know your system is",
    "start": "1313279",
    "end": "1314679"
  },
  {
    "text": "inside out and you're very confident",
    "start": "1314679",
    "end": "1317200"
  },
  {
    "text": "about your ability to to use SE Linux",
    "start": "1317200",
    "end": "1319159"
  },
  {
    "text": "very very good tool but just saying ah",
    "start": "1319159",
    "end": "1321880"
  },
  {
    "text": "I'll try it and it will be all right",
    "start": "1321880",
    "end": "1322919"
  },
  {
    "text": "it's going to end in",
    "start": "1322919",
    "end": "1324520"
  },
  {
    "text": "disaster spoken from experience um so",
    "start": "1324520",
    "end": "1327840"
  },
  {
    "text": "what you do in SE Linux to prevent it is",
    "start": "1327840",
    "end": "1329760"
  },
  {
    "text": "you could either prevent access to the",
    "start": "1329760",
    "end": "1332559"
  },
  {
    "text": "specific um specific processes that",
    "start": "1332559",
    "end": "1335960"
  },
  {
    "text": "you're worried that will be hijacked by",
    "start": "1335960",
    "end": "1337559"
  },
  {
    "text": "preventing access to uh proc PID mem or",
    "start": "1337559",
    "end": "1341400"
  },
  {
    "text": "you can just prevent access to exec M",
    "start": "1341400",
    "end": "1344240"
  },
  {
    "text": "now the third thing and this is a bit",
    "start": "1344240",
    "end": "1346640"
  },
  {
    "text": "less of an individual person kind of",
    "start": "1346640",
    "end": "1348720"
  },
  {
    "text": "thing this is something that I've been",
    "start": "1348720",
    "end": "1350159"
  },
  {
    "text": "meaning to bring up with kubernetes",
    "start": "1350159",
    "end": "1352679"
  },
  {
    "text": "maintainers I don't see why termination",
    "start": "1352679",
    "end": "1355279"
  },
  {
    "text": "log should be an executable Mount",
    "start": "1355279",
    "end": "1357760"
  },
  {
    "text": "there's no reason for it to be it's a",
    "start": "1357760",
    "end": "1358919"
  },
  {
    "text": "log file it's never supposed to be",
    "start": "1358919",
    "end": "1361520"
  },
  {
    "text": "executed um again they're much smarter",
    "start": "1361520",
    "end": "1363799"
  },
  {
    "text": "than me they may have a good answer for",
    "start": "1363799",
    "end": "1365600"
  },
  {
    "text": "this but definitely something worth",
    "start": "1365600",
    "end": "1367640"
  },
  {
    "text": "checking",
    "start": "1367640",
    "end": "1368640"
  },
  {
    "text": "out and then the last kind of thing that",
    "start": "1368640",
    "end": "1370880"
  },
  {
    "text": "we need to look into here is",
    "start": "1370880",
    "end": "1373200"
  },
  {
    "text": "detection if an attacker got to a point",
    "start": "1373200",
    "end": "1375360"
  },
  {
    "text": "where they're executing code on a",
    "start": "1375360",
    "end": "1377400"
  },
  {
    "text": "container",
    "start": "1377400",
    "end": "1378840"
  },
  {
    "text": "you're out it's",
    "start": "1378840",
    "end": "1380840"
  },
  {
    "text": "done if you noticed all of those three",
    "start": "1380840",
    "end": "1383440"
  },
  {
    "text": "methods rely on an outbound network",
    "start": "1383440",
    "end": "1385559"
  },
  {
    "text": "connection which going back to right at",
    "start": "1385559",
    "end": "1387720"
  },
  {
    "text": "the beginning we're looking at a readon",
    "start": "1387720",
    "end": "1390200"
  },
  {
    "text": "file system",
    "start": "1390200",
    "end": "1392240"
  },
  {
    "text": "that's fairly uh fairly easy to predict",
    "start": "1392240",
    "end": "1395720"
  },
  {
    "text": "what should be there what shouldn't be",
    "start": "1395720",
    "end": "1397240"
  },
  {
    "text": "there when we're talking about pods",
    "start": "1397240",
    "end": "1399240"
  },
  {
    "text": "running specific",
    "start": "1399240",
    "end": "1400600"
  },
  {
    "text": "workloads we have predictability when it",
    "start": "1400600",
    "end": "1402880"
  },
  {
    "text": "comes to which network connections we're",
    "start": "1402880",
    "end": "1404520"
  },
  {
    "text": "expecting and which ones we're not and",
    "start": "1404520",
    "end": "1406159"
  },
  {
    "text": "if there's suddenly a weird Network",
    "start": "1406159",
    "end": "1407480"
  },
  {
    "text": "outbound network connection saying give",
    "start": "1407480",
    "end": "1409520"
  },
  {
    "text": "me this file that should be a massive",
    "start": "1409520",
    "end": "1411440"
  },
  {
    "text": "red",
    "start": "1411440",
    "end": "1412320"
  },
  {
    "text": "light now that's regarding all methods",
    "start": "1412320",
    "end": "1416520"
  },
  {
    "text": "if we go back to the left side of the",
    "start": "1416520",
    "end": "1418240"
  },
  {
    "text": "screen here um this is essentially a",
    "start": "1418240",
    "end": "1420600"
  },
  {
    "text": "Falco Falco rule that the only reason I",
    "start": "1420600",
    "end": "1423679"
  },
  {
    "text": "put it up here is sort of give you an",
    "start": "1423679",
    "end": "1425320"
  },
  {
    "text": "idea of how complicated it can be",
    "start": "1425320",
    "end": "1427880"
  },
  {
    "text": "detecting something as simple as an",
    "start": "1427880",
    "end": "1429640"
  },
  {
    "text": "execution of a file from devs hm now",
    "start": "1429640",
    "end": "1433279"
  },
  {
    "text": "everything in blue there is basically",
    "start": "1433279",
    "end": "1435360"
  },
  {
    "text": "what we're looking for so it can be a",
    "start": "1435360",
    "end": "1436840"
  },
  {
    "text": "process that starts with fullpath devm",
    "start": "1436840",
    "end": "1439559"
  },
  {
    "text": "file name it can be a current working",
    "start": "1439559",
    "end": "1441559"
  },
  {
    "text": "directory of devm and a slash we can do",
    "start": "1441559",
    "end": "1444640"
  },
  {
    "text": "it using sh and then pass the our file",
    "start": "1444640",
    "end": "1449080"
  },
  {
    "text": "full part to our file as an argument it",
    "start": "1449080",
    "end": "1451000"
  },
  {
    "text": "can be done in a lot of different",
    "start": "1451000",
    "end": "1453520"
  },
  {
    "text": "ways so that's just a lot of thought",
    "start": "1453520",
    "end": "1455720"
  },
  {
    "text": "needs to go into how you do detection",
    "start": "1455720",
    "end": "1458240"
  },
  {
    "text": "but it definitely needs to be there so",
    "start": "1458240",
    "end": "1461480"
  },
  {
    "text": "just a quick word wrapping up don't",
    "start": "1461480",
    "end": "1463200"
  },
  {
    "text": "worry I'm not going to start",
    "start": "1463200",
    "end": "1464559"
  },
  {
    "text": "beatboxing I'm not saying read only file",
    "start": "1464559",
    "end": "1466559"
  },
  {
    "text": "systems are not a good thing they are",
    "start": "1466559",
    "end": "1469159"
  },
  {
    "text": "all I'm saying is that read only file",
    "start": "1469159",
    "end": "1470600"
  },
  {
    "text": "systems do not equal security they can",
    "start": "1470600",
    "end": "1473760"
  },
  {
    "text": "be another layer sure they should be",
    "start": "1473760",
    "end": "1475880"
  },
  {
    "text": "another layer especially when we're",
    "start": "1475880",
    "end": "1477200"
  },
  {
    "text": "talking about containers when when we're",
    "start": "1477200",
    "end": "1478600"
  },
  {
    "text": "talking about immutable stuff that we",
    "start": "1478600",
    "end": "1480880"
  },
  {
    "text": "know what should be there and what",
    "start": "1480880",
    "end": "1482480"
  },
  {
    "text": "shouldn't anything that's sort of meant",
    "start": "1482480",
    "end": "1485480"
  },
  {
    "text": "to be writable can be mounted as an",
    "start": "1485480",
    "end": "1487679"
  },
  {
    "text": "external Mount doesn't need to be part",
    "start": "1487679",
    "end": "1489039"
  },
  {
    "text": "of the main file",
    "start": "1489039",
    "end": "1490279"
  },
  {
    "text": "system basically all I'm saying here is",
    "start": "1490279",
    "end": "1493039"
  },
  {
    "text": "container security especially in",
    "start": "1493039",
    "end": "1495000"
  },
  {
    "text": "kubernetes is a ridiculously complex",
    "start": "1495000",
    "end": "1498240"
  },
  {
    "text": "idea and it can't just be solved by one",
    "start": "1498240",
    "end": "1500960"
  },
  {
    "text": "step whether it be readon file systems",
    "start": "1500960",
    "end": "1502720"
  },
  {
    "text": "whether it be some sort of uh EDR",
    "start": "1502720",
    "end": "1506039"
  },
  {
    "text": "whatever it's it needs to be layered it",
    "start": "1506039",
    "end": "1508520"
  },
  {
    "text": "needs to be active restrictions alerts",
    "start": "1508520",
    "end": "1510679"
  },
  {
    "text": "monitoring all the fancy things that you",
    "start": "1510679",
    "end": "1512600"
  },
  {
    "text": "see here at the booths basically there",
    "start": "1512600",
    "end": "1514760"
  },
  {
    "text": "is no one size fits",
    "start": "1514760",
    "end": "1517200"
  },
  {
    "text": "all and with that",
    "start": "1517200",
    "end": "1520360"
  },
  {
    "text": "um on the left is a link to a blog post",
    "start": "1520360",
    "end": "1523640"
  },
  {
    "text": "which is basically the same as the link",
    "start": "1523640",
    "end": "1525000"
  },
  {
    "text": "below and on the right is some feedback",
    "start": "1525000",
    "end": "1526799"
  },
  {
    "text": "I promise none of us will take you",
    "start": "1526799",
    "end": "1528399"
  },
  {
    "text": "anywhere malicious and yeah thank you",
    "start": "1528399",
    "end": "1530919"
  },
  {
    "text": "very",
    "start": "1530919",
    "end": "1533120"
  },
  {
    "text": "much yeah I think we've got time for",
    "start": "1538799",
    "end": "1540880"
  },
  {
    "text": "questions if anyone has",
    "start": "1540880",
    "end": "1544360"
  },
  {
    "text": "any so the Falco",
    "start": "1549240",
    "end": "1553080"
  },
  {
    "text": "rule uh the fal Ru is checking for any",
    "start": "1553520",
    "end": "1556000"
  },
  {
    "text": "execution of files from De",
    "start": "1556000",
    "end": "1558399"
  },
  {
    "text": "shm the reason why it's so complex is",
    "start": "1558399",
    "end": "1560720"
  },
  {
    "text": "because you can do that in many ways you",
    "start": "1560720",
    "end": "1562240"
  },
  {
    "text": "can execute it with a DOT slash directly",
    "start": "1562240",
    "end": "1564279"
  },
  {
    "text": "from within that from within devs hm you",
    "start": "1564279",
    "end": "1566559"
  },
  {
    "text": "can use a full path from wherever you",
    "start": "1566559",
    "end": "1569159"
  },
  {
    "text": "can do it using sh or bash and then",
    "start": "1569159",
    "end": "1571840"
  },
  {
    "text": "passing in the files and argument basic",
    "start": "1571840",
    "end": "1574120"
  },
  {
    "text": "it's basically saying there's a lot of",
    "start": "1574120",
    "end": "1575279"
  },
  {
    "text": "different ways to do something quite",
    "start": "1575279",
    "end": "1576559"
  },
  {
    "text": "simple so detection gets a bit",
    "start": "1576559",
    "end": "1580559"
  },
  {
    "text": "complicated yeah",
    "start": "1581600",
    "end": "1585039"
  },
  {
    "text": "basic isation l",
    "start": "1585039",
    "end": "1589600"
  },
  {
    "text": "speet no no",
    "start": "1592080",
    "end": "1595640"
  },
  {
    "text": "kubernetes sorry the question was is Dev",
    "start": "1596640",
    "end": "1599240"
  },
  {
    "text": "termination log specific to a specific",
    "start": "1599240",
    "end": "1601640"
  },
  {
    "text": "runtime or is it just kubernetes as a",
    "start": "1601640",
    "end": "1603520"
  },
  {
    "text": "whole so is",
    "start": "1603520",
    "end": "1606240"
  },
  {
    "text": "kubernetes so I did um realistically",
    "start": "1614799",
    "end": "1618640"
  },
  {
    "text": "this isn't really finalized research",
    "start": "1618640",
    "end": "1621120"
  },
  {
    "text": "it's finalized to this stage it's still",
    "start": "1621120",
    "end": "1624760"
  },
  {
    "text": "going on by both by me and some of my",
    "start": "1624760",
    "end": "1627559"
  },
  {
    "text": "colleagues as well um there's definitely",
    "start": "1627559",
    "end": "1630000"
  },
  {
    "text": "a lot more to look into um there's a few",
    "start": "1630000",
    "end": "1632960"
  },
  {
    "text": "talks I believe there was a talk at I",
    "start": "1632960",
    "end": "1635000"
  },
  {
    "text": "think it was at deathcon Again by Yo",
    "start": "1635000",
    "end": "1637120"
  },
  {
    "text": "guer the guy who um who wrote DD exec um",
    "start": "1637120",
    "end": "1641440"
  },
  {
    "text": "covering a lot of different ways some of",
    "start": "1641440",
    "end": "1643080"
  },
  {
    "text": "them contain a specific kubernetes",
    "start": "1643080",
    "end": "1644399"
  },
  {
    "text": "specific as well um to kind of go",
    "start": "1644399",
    "end": "1646559"
  },
  {
    "text": "through and do this and there's",
    "start": "1646559",
    "end": "1647559"
  },
  {
    "text": "definitely a lot more to learn in this",
    "start": "1647559",
    "end": "1648720"
  },
  {
    "text": "field in this very specific uh field but",
    "start": "1648720",
    "end": "1652559"
  },
  {
    "text": "yeah there I hope that answers your",
    "start": "1652559",
    "end": "1656080"
  },
  {
    "text": "question",
    "start": "1656080",
    "end": "1659080"
  },
  {
    "text": "yeah yeah so uh in regards to the second",
    "start": "1663039",
    "end": "1666159"
  },
  {
    "text": "profile there's sort of two ways you can",
    "start": "1666159",
    "end": "1667919"
  },
  {
    "text": "go about it uh one would be going on the",
    "start": "1667919",
    "end": "1670440"
  },
  {
    "text": "Node specifically checking the",
    "start": "1670440",
    "end": "1671600"
  },
  {
    "text": "configuration for your runtime where you",
    "start": "1671600",
    "end": "1673159"
  },
  {
    "text": "can see if a default profile is loaded",
    "start": "1673159",
    "end": "1674960"
  },
  {
    "text": "at all to see if it actually applies to",
    "start": "1674960",
    "end": "1677000"
  },
  {
    "text": "a specific container exec into that",
    "start": "1677000",
    "end": "1679559"
  },
  {
    "text": "container run am I contained it will",
    "start": "1679559",
    "end": "1681559"
  },
  {
    "text": "give you an output of am I container is",
    "start": "1681559",
    "end": "1683880"
  },
  {
    "text": "basically a tool am I contained uh it's",
    "start": "1683880",
    "end": "1686559"
  },
  {
    "text": "basically a tool it will give you an",
    "start": "1686559",
    "end": "1688080"
  },
  {
    "text": "output it will run tell you all the",
    "start": "1688080",
    "end": "1689559"
  },
  {
    "text": "capabilities that you have within that",
    "start": "1689559",
    "end": "1690760"
  },
  {
    "text": "container uh second comp profile app",
    "start": "1690760",
    "end": "1693120"
  },
  {
    "text": "Armor All Those sorts of things and it's",
    "start": "1693120",
    "end": "1695240"
  },
  {
    "text": "just a nice way to verify if you",
    "start": "1695240",
    "end": "1696960"
  },
  {
    "text": "actually have an app armor profile",
    "start": "1696960",
    "end": "1699760"
  },
  {
    "text": "attached a second profile attached to",
    "start": "1699760",
    "end": "1701960"
  },
  {
    "text": "that specific",
    "start": "1701960",
    "end": "1704518"
  },
  {
    "text": "container no no no Amic contained is a a",
    "start": "1706440",
    "end": "1709159"
  },
  {
    "text": "tool external tool you'd need to get on",
    "start": "1709159",
    "end": "1711399"
  },
  {
    "text": "you can run it using the first two",
    "start": "1711399",
    "end": "1713240"
  },
  {
    "text": "methods here if you ever encounter a r",
    "start": "1713240",
    "end": "1715080"
  },
  {
    "text": "on",
    "start": "1715080",
    "end": "1717278"
  },
  {
    "text": "F okay thank you very much guys and feel",
    "start": "1718480",
    "end": "1721399"
  },
  {
    "text": "free to come chat with me if you see me",
    "start": "1721399",
    "end": "1725840"
  },
  {
    "text": "thank",
    "start": "1725840",
    "end": "1726799"
  },
  {
    "text": "you",
    "start": "1726799",
    "end": "1729799"
  }
]