[
  {
    "text": "This research has been done in",
    "start": "10160",
    "end": "12660"
  },
  {
    "text": "collaboration with Barack however he",
    "start": "12660",
    "end": "14160"
  },
  {
    "text": "couldn't be here today",
    "start": "14160",
    "end": "16020"
  },
  {
    "text": "um so you'll have to bear with me",
    "start": "16020",
    "end": "19080"
  },
  {
    "text": "okay who am I I'm a part of Awesome with",
    "start": "19080",
    "end": "23039"
  },
  {
    "text": "a threat research group before that I",
    "start": "23039",
    "end": "26340"
  },
  {
    "text": "published some Works in runtime",
    "start": "26340",
    "end": "27660"
  },
  {
    "text": "verification of all things",
    "start": "27660",
    "end": "29699"
  },
  {
    "text": "um before I move to security so you",
    "start": "29699",
    "end": "32758"
  },
  {
    "text": "might know me from ubc's Continuum",
    "start": "32759",
    "end": "35640"
  },
  {
    "text": "scanning Falco bypasses",
    "start": "35640",
    "end": "37880"
  },
  {
    "text": "various blocks on kubernetes security",
    "start": "37880",
    "end": "40559"
  },
  {
    "text": "Etc I'm also using X and euros's",
    "start": "40559",
    "end": "42840"
  },
  {
    "text": "artifact evaluation a Committee Member",
    "start": "42840",
    "end": "45360"
  },
  {
    "text": "that's because I'm a firm believer in",
    "start": "45360",
    "end": "48440"
  },
  {
    "text": "Bridging the gaps between academic",
    "start": "48440",
    "end": "51000"
  },
  {
    "text": "research and Industry and I think we're",
    "start": "51000",
    "end": "53399"
  },
  {
    "text": "not doing this enough",
    "start": "53399",
    "end": "54899"
  },
  {
    "text": "all right",
    "start": "54899",
    "end": "56160"
  },
  {
    "text": "what's the talk is about the premise",
    "start": "56160",
    "end": "58620"
  },
  {
    "text": "the core kubernetes cluster components",
    "start": "58620",
    "end": "61140"
  },
  {
    "text": "are a necessity well clearly otherwise",
    "start": "61140",
    "end": "63059"
  },
  {
    "text": "how would you run the cluster without",
    "start": "63059",
    "end": "64378"
  },
  {
    "text": "the API server that's nonsense app users",
    "start": "64379",
    "end": "67740"
  },
  {
    "text": "workloads of course also are necessity",
    "start": "67740",
    "end": "69659"
  },
  {
    "text": "because otherwise why would you stage a",
    "start": "69659",
    "end": "71340"
  },
  {
    "text": "cluster however what about everything",
    "start": "71340",
    "end": "73439"
  },
  {
    "text": "else and by everything else I mean stuff",
    "start": "73439",
    "end": "76320"
  },
  {
    "text": "that comes free in the cluster",
    "start": "76320",
    "end": "78600"
  },
  {
    "text": "in the managed cluster particularly",
    "start": "78600",
    "end": "80460"
  },
  {
    "text": "right like everything around the logs",
    "start": "80460",
    "end": "83100"
  },
  {
    "text": "exporters see side drivers metrics etc",
    "start": "83100",
    "end": "86100"
  },
  {
    "text": "etc",
    "start": "86100",
    "end": "87119"
  },
  {
    "text": "something that's not",
    "start": "87119",
    "end": "88799"
  },
  {
    "text": "uh doesn't is not necessary for for the",
    "start": "88799",
    "end": "91439"
  },
  {
    "text": "existence of the cluster however",
    "start": "91439",
    "end": "92880"
  },
  {
    "text": "something that's very critical to",
    "start": "92880",
    "end": "94920"
  },
  {
    "text": "operate the production level cluster",
    "start": "94920",
    "end": "96780"
  },
  {
    "text": "otherwise",
    "start": "96780",
    "end": "98100"
  },
  {
    "text": "it's got to be really tricky so the",
    "start": "98100",
    "end": "100799"
  },
  {
    "text": "examples are for example container",
    "start": "100799",
    "end": "102360"
  },
  {
    "text": "Watcher on gke osm controller and eks",
    "start": "102360",
    "end": "105420"
  },
  {
    "text": "AWS node on eks but not Q proxy you've",
    "start": "105420",
    "end": "109439"
  },
  {
    "text": "got cube proxy for",
    "start": "109439",
    "end": "111000"
  },
  {
    "text": "where I stand understand this is",
    "start": "111000",
    "end": "113100"
  },
  {
    "text": "integral part of the kubernetes control",
    "start": "113100",
    "end": "114899"
  },
  {
    "text": "plane right and cord DNS for example",
    "start": "114899",
    "end": "117299"
  },
  {
    "text": "also this is like we must have it",
    "start": "117299",
    "end": "120420"
  },
  {
    "text": "okay and the the",
    "start": "120420",
    "end": "123600"
  },
  {
    "text": "there are various lists of those add-ons",
    "start": "123600",
    "end": "126060"
  },
  {
    "text": "slash middleware slash plugins so that's",
    "start": "126060",
    "end": "128280"
  },
  {
    "text": "like there are multiple names for that",
    "start": "128280",
    "end": "130259"
  },
  {
    "text": "however there's no centralized source",
    "start": "130259",
    "end": "132660"
  },
  {
    "text": "for those components so we'll start",
    "start": "132660",
    "end": "134700"
  },
  {
    "text": "we'll we'll try to maximum order in this",
    "start": "134700",
    "end": "137819"
  },
  {
    "text": "in numbers in temporary in terms of",
    "start": "137819",
    "end": "139620"
  },
  {
    "text": "numbers if you stage G key AKs or ETS",
    "start": "139620",
    "end": "142080"
  },
  {
    "text": "cluster V 1.25 you will get by default",
    "start": "142080",
    "end": "145319"
  },
  {
    "text": "25",
    "start": "145319",
    "end": "146459"
  },
  {
    "text": "uh demon sets replica sets or staple",
    "start": "146459",
    "end": "149220"
  },
  {
    "text": "sets in the mostly of them most of them",
    "start": "149220",
    "end": "151920"
  },
  {
    "text": "in the cube system namespace of course",
    "start": "151920",
    "end": "155120"
  },
  {
    "text": "and I'm only considering native",
    "start": "155120",
    "end": "157560"
  },
  {
    "text": "kubernetes components because there are",
    "start": "157560",
    "end": "159300"
  },
  {
    "text": "more host level components as well",
    "start": "159300",
    "end": "163160"
  },
  {
    "text": "um and in addition",
    "start": "164760",
    "end": "167879"
  },
  {
    "text": "Yeah so basically we get we get a batch",
    "start": "167879",
    "end": "170040"
  },
  {
    "text": "of those",
    "start": "170040",
    "end": "171120"
  },
  {
    "text": "um okay so now as we we're clear on the",
    "start": "171120",
    "end": "174000"
  },
  {
    "text": "definition let's let's go over the",
    "start": "174000",
    "end": "175379"
  },
  {
    "text": "premise we have of course this is a",
    "start": "175379",
    "end": "178440"
  },
  {
    "text": "cloud security talk so as every cloud",
    "start": "178440",
    "end": "180420"
  },
  {
    "text": "security token we must start with the",
    "start": "180420",
    "end": "182280"
  },
  {
    "text": "shared responsibility model however",
    "start": "182280",
    "end": "184140"
  },
  {
    "text": "let's take this model from the cloud",
    "start": "184140",
    "end": "185879"
  },
  {
    "text": "from The Wider Cloud to the kubernetes",
    "start": "185879",
    "end": "188099"
  },
  {
    "text": "space and we can see that there's a",
    "start": "188099",
    "end": "190860"
  },
  {
    "text": "horizontal separation between Master",
    "start": "190860",
    "end": "192659"
  },
  {
    "text": "nodes and worker nodes but there is also",
    "start": "192659",
    "end": "194879"
  },
  {
    "text": "vertical separation right we have",
    "start": "194879",
    "end": "196500"
  },
  {
    "text": "control plane",
    "start": "196500",
    "end": "197720"
  },
  {
    "text": "marked level we have green customer",
    "start": "197720",
    "end": "201440"
  },
  {
    "text": "workloads and everything in between",
    "start": "201440",
    "end": "203640"
  },
  {
    "text": "right so virtual machine Hardware this",
    "start": "203640",
    "end": "206819"
  },
  {
    "text": "is clear okay this is CSP",
    "start": "206819",
    "end": "210680"
  },
  {
    "text": "the stuff that's in in the middle and",
    "start": "212040",
    "end": "214140"
  },
  {
    "text": "the problem here is that we see that",
    "start": "214140",
    "end": "215819"
  },
  {
    "text": "middleware is running as part of the",
    "start": "215819",
    "end": "217379"
  },
  {
    "text": "master nodes and worker nodes",
    "start": "217379",
    "end": "220019"
  },
  {
    "text": "so this separation where we think about",
    "start": "220019",
    "end": "222440"
  },
  {
    "text": "us customers as right we are responsible",
    "start": "222440",
    "end": "226080"
  },
  {
    "text": "for worker nodes and CSP responsible",
    "start": "226080",
    "end": "228540"
  },
  {
    "text": "responsible for masternodes this",
    "start": "228540",
    "end": "230459"
  },
  {
    "text": "separation is not clear okay and the",
    "start": "230459",
    "end": "232920"
  },
  {
    "text": "boundaries are blurred here",
    "start": "232920",
    "end": "234900"
  },
  {
    "text": "and the the most obvious problem is",
    "start": "234900",
    "end": "237180"
  },
  {
    "text": "upgrade right because cluster users",
    "start": "237180",
    "end": "239220"
  },
  {
    "text": "focus on workload security",
    "start": "239220",
    "end": "241200"
  },
  {
    "text": "not control plane and not the middleware",
    "start": "241200",
    "end": "243180"
  },
  {
    "text": "however the vulnerability patching",
    "start": "243180",
    "end": "245519"
  },
  {
    "text": "process isn't clear",
    "start": "245519",
    "end": "246959"
  },
  {
    "text": "and like if we if we talk about the",
    "start": "246959",
    "end": "249720"
  },
  {
    "text": "previous research from about plastic",
    "start": "249720",
    "end": "251640"
  },
  {
    "text": "Rays Zone in the cloud right in the",
    "start": "251640",
    "end": "254099"
  },
  {
    "text": "context of the cloud there where our",
    "start": "254099",
    "end": "256019"
  },
  {
    "text": "vulnerability research Group found some",
    "start": "256019",
    "end": "257880"
  },
  {
    "text": "vulnerability indeed or in my agent in",
    "start": "257880",
    "end": "260459"
  },
  {
    "text": "Azure however it wasn't clear who is",
    "start": "260459",
    "end": "263040"
  },
  {
    "text": "supposed to fix that",
    "start": "263040",
    "end": "264900"
  },
  {
    "text": "customer suspensability or CSP and",
    "start": "264900",
    "end": "268440"
  },
  {
    "text": "similar problems we have in our managed",
    "start": "268440",
    "end": "270240"
  },
  {
    "text": "clusters two scenarios first CSP wants",
    "start": "270240",
    "end": "273060"
  },
  {
    "text": "to upgrade but requires user action of",
    "start": "273060",
    "end": "275340"
  },
  {
    "text": "course like if you run in production",
    "start": "275340",
    "end": "276900"
  },
  {
    "text": "cluster you know that upgrades of the",
    "start": "276900",
    "end": "278699"
  },
  {
    "text": "worker nodes is not a trivial action",
    "start": "278699",
    "end": "281580"
  },
  {
    "text": "second scenario user wants to upgrade",
    "start": "281580",
    "end": "283680"
  },
  {
    "text": "but the component but the component is",
    "start": "283680",
    "end": "285479"
  },
  {
    "text": "controlled by CSP so like they can't so",
    "start": "285479",
    "end": "288660"
  },
  {
    "text": "we're we're in a problem here okay",
    "start": "288660",
    "end": "290820"
  },
  {
    "text": "before we go further let's adjust the",
    "start": "290820",
    "end": "293100"
  },
  {
    "text": "expectations now we're going to talk",
    "start": "293100",
    "end": "296160"
  },
  {
    "text": "the serious business this is not a",
    "start": "296160",
    "end": "298800"
  },
  {
    "text": "sculptable liability research this is",
    "start": "298800",
    "end": "300419"
  },
  {
    "text": "not a security audit of kubernetes",
    "start": "300419",
    "end": "302759"
  },
  {
    "text": "components and this talk is not a threat",
    "start": "302759",
    "end": "305160"
  },
  {
    "text": "model okay but it is a bit of everything",
    "start": "305160",
    "end": "307320"
  },
  {
    "text": "about",
    "start": "307320",
    "end": "308340"
  },
  {
    "text": "and more importantly this is a risk",
    "start": "308340",
    "end": "310500"
  },
  {
    "text": "assessment of previously unnoticed",
    "start": "310500",
    "end": "312360"
  },
  {
    "text": "surface",
    "start": "312360",
    "end": "313560"
  },
  {
    "text": "and initial attempt to draw conclusions",
    "start": "313560",
    "end": "316139"
  },
  {
    "text": "called Call to Arms you name it",
    "start": "316139",
    "end": "318240"
  },
  {
    "text": "okay now let's start with the hypothesis",
    "start": "318240",
    "end": "321300"
  },
  {
    "text": "first middleware increases attack",
    "start": "321300",
    "end": "323520"
  },
  {
    "text": "surface",
    "start": "323520",
    "end": "325440"
  },
  {
    "text": "well not good enough because really",
    "start": "325440",
    "end": "327180"
  },
  {
    "text": "every software increases attack software",
    "start": "327180",
    "end": "329460"
  },
  {
    "text": "surface right so this is kind of",
    "start": "329460",
    "end": "331139"
  },
  {
    "text": "triviality let's try this one middleware",
    "start": "331139",
    "end": "333660"
  },
  {
    "text": "increases attack surface significantly",
    "start": "333660",
    "end": "336000"
  },
  {
    "text": "but then you might ask what is",
    "start": "336000",
    "end": "337380"
  },
  {
    "text": "significantly what does this mean how",
    "start": "337380",
    "end": "339600"
  },
  {
    "text": "about this one middleware increases risk",
    "start": "339600",
    "end": "342000"
  },
  {
    "text": "in a non-trivial way",
    "start": "342000",
    "end": "344340"
  },
  {
    "text": "and I think this is a good one because",
    "start": "344340",
    "end": "345900"
  },
  {
    "text": "ultimately we as a cluster operators",
    "start": "345900",
    "end": "349380"
  },
  {
    "text": "were interested to know what's the risk",
    "start": "349380",
    "end": "351900"
  },
  {
    "text": "in the cluster right and non-shivable",
    "start": "351900",
    "end": "354539"
  },
  {
    "text": "way I know it's a bit fluffy but at",
    "start": "354539",
    "end": "356580"
  },
  {
    "text": "least it has the leeway to to interpret",
    "start": "356580",
    "end": "358440"
  },
  {
    "text": "for interpretation",
    "start": "358440",
    "end": "359820"
  },
  {
    "text": "so let's run with this what do we need",
    "start": "359820",
    "end": "362759"
  },
  {
    "text": "to do",
    "start": "362759",
    "end": "363900"
  },
  {
    "text": "to confirm or disprove the hypothesis",
    "start": "363900",
    "end": "366240"
  },
  {
    "text": "well we need a method and perform so",
    "start": "366240",
    "end": "368639"
  },
  {
    "text": "what we did with performance analysis we",
    "start": "368639",
    "end": "370440"
  },
  {
    "text": "did our back and permissions analysis",
    "start": "370440",
    "end": "372180"
  },
  {
    "text": "image analysis security posture config",
    "start": "372180",
    "end": "374479"
  },
  {
    "text": "behavioral runtime unlocks etc etc out",
    "start": "374479",
    "end": "378360"
  },
  {
    "text": "of it we receive security risk",
    "start": "378360",
    "end": "380340"
  },
  {
    "text": "assessment great so let's let's go into",
    "start": "380340",
    "end": "382319"
  },
  {
    "text": "details",
    "start": "382319",
    "end": "384180"
  },
  {
    "text": "first of all basic security question out",
    "start": "384180",
    "end": "387180"
  },
  {
    "text": "of those 25 deployments",
    "start": "387180",
    "end": "389720"
  },
  {
    "text": "about third of them actually run shared",
    "start": "389720",
    "end": "392880"
  },
  {
    "text": "Linux namespaces",
    "start": "392880",
    "end": "395460"
  },
  {
    "text": "it's not ideal right because this is you",
    "start": "395460",
    "end": "398039"
  },
  {
    "text": "know the circling explanations that",
    "start": "398039",
    "end": "400380"
  },
  {
    "text": "means that there's more attack surface",
    "start": "400380",
    "end": "402120"
  },
  {
    "text": "and more connection points between the",
    "start": "402120",
    "end": "404280"
  },
  {
    "text": "container and the kernel not ideal but",
    "start": "404280",
    "end": "406560"
  },
  {
    "text": "hey sometimes we need to do this",
    "start": "406560",
    "end": "409020"
  },
  {
    "text": "third of those have privileged",
    "start": "409020",
    "end": "411300"
  },
  {
    "text": "containers or containers with added",
    "start": "411300",
    "end": "413340"
  },
  {
    "text": "capabilities beyond the default",
    "start": "413340",
    "end": "414720"
  },
  {
    "text": "kubernetes set",
    "start": "414720",
    "end": "416220"
  },
  {
    "text": "okay so that could be netbind betrays",
    "start": "416220",
    "end": "419039"
  },
  {
    "text": "you name it",
    "start": "419039",
    "end": "421020"
  },
  {
    "text": "and an additional third of them have",
    "start": "421020",
    "end": "423000"
  },
  {
    "text": "mounted sensitive host volumes so what",
    "start": "423000",
    "end": "425039"
  },
  {
    "text": "does this mean it's not just slash fire",
    "start": "425039",
    "end": "426660"
  },
  {
    "text": "log whatever something not interesting",
    "start": "426660",
    "end": "428520"
  },
  {
    "text": "it's either host or slash EDC or",
    "start": "428520",
    "end": "430740"
  },
  {
    "text": "something slash C something something",
    "start": "430740",
    "end": "432720"
  },
  {
    "text": "juicy like that",
    "start": "432720",
    "end": "434580"
  },
  {
    "text": "so we can see that the the footprint is",
    "start": "434580",
    "end": "436740"
  },
  {
    "text": "pretty serious like the in terms of",
    "start": "436740",
    "end": "438660"
  },
  {
    "text": "privileges this workflow",
    "start": "438660",
    "end": "440400"
  },
  {
    "text": "the middleware workloads they they were",
    "start": "440400",
    "end": "443039"
  },
  {
    "text": "quite serious privileges here",
    "start": "443039",
    "end": "446000"
  },
  {
    "text": "intuitively",
    "start": "446000",
    "end": "447840"
  },
  {
    "text": "it's kinda okay because they probably",
    "start": "447840",
    "end": "450300"
  },
  {
    "text": "need this to do but it gives a sense of",
    "start": "450300",
    "end": "453720"
  },
  {
    "text": "uneasiness right about their the impact",
    "start": "453720",
    "end": "456419"
  },
  {
    "text": "right because after all risk is",
    "start": "456419",
    "end": "457800"
  },
  {
    "text": "permanent time stream so this is",
    "start": "457800",
    "end": "460139"
  },
  {
    "text": "important",
    "start": "460139",
    "end": "462479"
  },
  {
    "text": "image analytics okay",
    "start": "462479",
    "end": "465300"
  },
  {
    "text": "middle middleware images have lots of",
    "start": "465300",
    "end": "467460"
  },
  {
    "text": "vulnerabilities well what else is",
    "start": "467460",
    "end": "470639"
  },
  {
    "text": "a couple couple examples here here we",
    "start": "470639",
    "end": "473340"
  },
  {
    "text": "see like 182 on the basis okay great",
    "start": "473340",
    "end": "475800"
  },
  {
    "text": "however",
    "start": "475800",
    "end": "477720"
  },
  {
    "text": "so do the core images in control plane",
    "start": "477720",
    "end": "480539"
  },
  {
    "text": "and in addition in general number of",
    "start": "480539",
    "end": "482280"
  },
  {
    "text": "vulnerabilities is proportional to",
    "start": "482280",
    "end": "483840"
  },
  {
    "text": "number of packages and so really we",
    "start": "483840",
    "end": "486780"
  },
  {
    "text": "cannot state that middleware images are",
    "start": "486780",
    "end": "488520"
  },
  {
    "text": "worse offer than core components not for",
    "start": "488520",
    "end": "490620"
  },
  {
    "text": "the good reason just because core",
    "start": "490620",
    "end": "492000"
  },
  {
    "text": "components also set but okay",
    "start": "492000",
    "end": "495300"
  },
  {
    "text": "like we didn't want to go into the",
    "start": "495300",
    "end": "497639"
  },
  {
    "text": "statistical analysis",
    "start": "497639",
    "end": "499860"
  },
  {
    "text": "to claim",
    "start": "499860",
    "end": "502520"
  },
  {
    "text": "have more of a little bit",
    "start": "502800",
    "end": "504840"
  },
  {
    "text": "so we left it at that but instead we",
    "start": "504840",
    "end": "506940"
  },
  {
    "text": "went into the behavioral analysis so",
    "start": "506940",
    "end": "509520"
  },
  {
    "text": "there's a runtime stuff right like",
    "start": "509520",
    "end": "511199"
  },
  {
    "text": "looking at betrays what are they",
    "start": "511199",
    "end": "513180"
  },
  {
    "text": "actually doing and logs and logs are",
    "start": "513180",
    "end": "515700"
  },
  {
    "text": "very interesting source",
    "start": "515700",
    "end": "518099"
  },
  {
    "text": "because it can show stuff like",
    "start": "518099",
    "end": "519779"
  },
  {
    "text": "unexpected principles acting unexpected",
    "start": "519779",
    "end": "522060"
  },
  {
    "text": "permissions or discrepancies between the",
    "start": "522060",
    "end": "524159"
  },
  {
    "text": "csps",
    "start": "524159",
    "end": "525360"
  },
  {
    "text": "if you think about it even the same",
    "start": "525360",
    "end": "527640"
  },
  {
    "text": "component acts in different in between",
    "start": "527640",
    "end": "530100"
  },
  {
    "text": "the csps that evidence of something",
    "start": "530100",
    "end": "532320"
  },
  {
    "text": "either I don't know either differences",
    "start": "532320",
    "end": "534480"
  },
  {
    "text": "in the behavior or in the source code or",
    "start": "534480",
    "end": "536880"
  },
  {
    "text": "something something interesting",
    "start": "536880",
    "end": "538380"
  },
  {
    "text": "basically",
    "start": "538380",
    "end": "540060"
  },
  {
    "text": "so I hope you can see this this is an",
    "start": "540060",
    "end": "542339"
  },
  {
    "text": "example of AKs I think it's log Explorer",
    "start": "542339",
    "end": "546180"
  },
  {
    "text": "um this is an event",
    "start": "546180",
    "end": "548060"
  },
  {
    "text": "execution into the Pod by AKs",
    "start": "548060",
    "end": "552720"
  },
  {
    "text": "problem detector so here's the username",
    "start": "552720",
    "end": "557279"
  },
  {
    "text": "and what it does it exacts into the",
    "start": "557279",
    "end": "559320"
  },
  {
    "text": "connective connectivity agent on AKs",
    "start": "559320",
    "end": "562500"
  },
  {
    "text": "and this was the clue that we have",
    "start": "562500",
    "end": "565200"
  },
  {
    "text": "apparently in AKs node problem detector",
    "start": "565200",
    "end": "567600"
  },
  {
    "text": "before that I didn't know what's this",
    "start": "567600",
    "end": "570060"
  },
  {
    "text": "so if you let's say you run an AKs and",
    "start": "570060",
    "end": "573060"
  },
  {
    "text": "gke",
    "start": "573060",
    "end": "574860"
  },
  {
    "text": "you might have not known this but you",
    "start": "574860",
    "end": "577860"
  },
  {
    "text": "also run node problem detector",
    "start": "577860",
    "end": "580560"
  },
  {
    "text": "and that's going to be the star of our",
    "start": "580560",
    "end": "582240"
  },
  {
    "text": "use case one",
    "start": "582240",
    "end": "584100"
  },
  {
    "text": "so in short note problem detector is",
    "start": "584100",
    "end": "586620"
  },
  {
    "text": "like Health checker on steroids it",
    "start": "586620",
    "end": "588660"
  },
  {
    "text": "basically runs a bunch of checks on the",
    "start": "588660",
    "end": "590220"
  },
  {
    "text": "Node and tells us if everything is good",
    "start": "590220",
    "end": "592380"
  },
  {
    "text": "or bad or not us to the API server",
    "start": "592380",
    "end": "595980"
  },
  {
    "text": "and there is a parent repo but AKs",
    "start": "595980",
    "end": "598380"
  },
  {
    "text": "indicated around their own",
    "start": "598380",
    "end": "600180"
  },
  {
    "text": "okay like they modify the Upstream",
    "start": "600180",
    "end": "602399"
  },
  {
    "text": "report and we don't have access to that",
    "start": "602399",
    "end": "604500"
  },
  {
    "text": "source the interesting part is that",
    "start": "604500",
    "end": "607140"
  },
  {
    "text": "starting at some version",
    "start": "607140",
    "end": "609480"
  },
  {
    "text": "MPG not from detector runs the host",
    "start": "609480",
    "end": "611880"
  },
  {
    "text": "service",
    "start": "611880",
    "end": "613080"
  },
  {
    "text": "and not as a demon set in Ikea eks",
    "start": "613080",
    "end": "616019"
  },
  {
    "text": "according to best practices guide they",
    "start": "616019",
    "end": "617700"
  },
  {
    "text": "still recommend to install the demons at",
    "start": "617700",
    "end": "619320"
  },
  {
    "text": "deployment but on Ikea cgp it runs as a",
    "start": "619320",
    "end": "622320"
  },
  {
    "text": "whole service so I'll let it sink",
    "start": "622320",
    "end": "625620"
  },
  {
    "text": "there is a component in your AKs GK",
    "start": "625620",
    "end": "628080"
  },
  {
    "text": "cluster",
    "start": "628080",
    "end": "629820"
  },
  {
    "text": "that X on the kubernetes level it",
    "start": "629820",
    "end": "633300"
  },
  {
    "text": "executes into pods",
    "start": "633300",
    "end": "636620"
  },
  {
    "text": "and at the same time it runs as a host",
    "start": "637080",
    "end": "639420"
  },
  {
    "text": "Service as a process",
    "start": "639420",
    "end": "641339"
  },
  {
    "text": "root process and a trans periodically",
    "start": "641339",
    "end": "646399"
  },
  {
    "text": "so this is how it looks on the on the",
    "start": "647700",
    "end": "649980"
  },
  {
    "text": "Node",
    "start": "649980",
    "end": "651180"
  },
  {
    "text": "this is uke I think this is AKs you can",
    "start": "651180",
    "end": "654779"
  },
  {
    "text": "see that there is not plugin detective",
    "start": "654779",
    "end": "656700"
  },
  {
    "text": "process and it's picking a bunch of the",
    "start": "656700",
    "end": "659040"
  },
  {
    "text": "fix",
    "start": "659040",
    "end": "659940"
  },
  {
    "text": "and",
    "start": "659940",
    "end": "662399"
  },
  {
    "text": "in terms of version and the latest",
    "start": "662399",
    "end": "664260"
  },
  {
    "text": "version is V 1. sorry 8.12 I think or",
    "start": "664260",
    "end": "668040"
  },
  {
    "text": "8.13 and we can see that AKs and GK V",
    "start": "668040",
    "end": "671700"
  },
  {
    "text": "1.25 they're running",
    "start": "671700",
    "end": "674120"
  },
  {
    "text": "0.0810 which is a bit old kinda old like",
    "start": "674120",
    "end": "677459"
  },
  {
    "text": "one and a half year so not ideal but hey",
    "start": "677459",
    "end": "682100"
  },
  {
    "text": "all right so feature on the scope how",
    "start": "682320",
    "end": "684839"
  },
  {
    "text": "can we exploit this component right",
    "start": "684839",
    "end": "686760"
  },
  {
    "text": "that's that's the point of this",
    "start": "686760",
    "end": "688200"
  },
  {
    "text": "presentation feature on the scope drum",
    "start": "688200",
    "end": "690480"
  },
  {
    "text": "roll custom plugin monitor that's a",
    "start": "690480",
    "end": "693120"
  },
  {
    "text": "feature that extends the core",
    "start": "693120",
    "end": "694500"
  },
  {
    "text": "functionality on the NPD",
    "start": "694500",
    "end": "697320"
  },
  {
    "text": "and",
    "start": "697320",
    "end": "699800"
  },
  {
    "text": "a chain of attack that we will perform",
    "start": "706200",
    "end": "709079"
  },
  {
    "text": "in the next slide so we'll see the demo",
    "start": "709079",
    "end": "711300"
  },
  {
    "text": "and then I'll I'll stop and analyze the",
    "start": "711300",
    "end": "713519"
  },
  {
    "text": "attack right we're going through from",
    "start": "713519",
    "end": "715500"
  },
  {
    "text": "the from the ability to write the script",
    "start": "715500",
    "end": "718320"
  },
  {
    "text": "into the circle folder node problem",
    "start": "718320",
    "end": "721860"
  },
  {
    "text": "detector picks it up and then we're",
    "start": "721860",
    "end": "724380"
  },
  {
    "text": "getting all kind of Bounties in terms in",
    "start": "724380",
    "end": "726600"
  },
  {
    "text": "in the form of persistency",
    "start": "726600",
    "end": "730699"
  },
  {
    "text": "all right so demo number one",
    "start": "732959",
    "end": "736579"
  },
  {
    "text": "you might recognize the guestbook app",
    "start": "736579",
    "end": "739260"
  },
  {
    "text": "PHP app from gkey tutorials so I",
    "start": "739260",
    "end": "742140"
  },
  {
    "text": "modified it a bit we can see the",
    "start": "742140",
    "end": "745019"
  },
  {
    "text": "the front-end red is follower so very",
    "start": "745019",
    "end": "747899"
  },
  {
    "text": "very realistic I hope",
    "start": "747899",
    "end": "751640"
  },
  {
    "text": "and the problem with the front end well",
    "start": "755220",
    "end": "757860"
  },
  {
    "text": "I guess it's a minor problem because it",
    "start": "757860",
    "end": "759959"
  },
  {
    "text": "just it Maps easy like it's it's okay",
    "start": "759959",
    "end": "763139"
  },
  {
    "text": "right because slash it says like it",
    "start": "763139",
    "end": "765360"
  },
  {
    "text": "keeps configuration on the hustle I",
    "start": "765360",
    "end": "767639"
  },
  {
    "text": "guess it needed the configuration so it",
    "start": "767639",
    "end": "769380"
  },
  {
    "text": "mapped the slash hits on the host and",
    "start": "769380",
    "end": "772200"
  },
  {
    "text": "that's what we're going to explore",
    "start": "772200",
    "end": "774240"
  },
  {
    "text": "um so we have to load balancer feeding",
    "start": "774240",
    "end": "775980"
  },
  {
    "text": "the IP outside and this is how we can",
    "start": "775980",
    "end": "778740"
  },
  {
    "text": "access that",
    "start": "778740",
    "end": "780899"
  },
  {
    "text": "application so like just regular",
    "start": "780899",
    "end": "783360"
  },
  {
    "text": "messaging service I guess",
    "start": "783360",
    "end": "785339"
  },
  {
    "text": "but the thing is that there is a",
    "start": "785339",
    "end": "787079"
  },
  {
    "text": "guestbook PHP file as well now",
    "start": "787079",
    "end": "790940"
  },
  {
    "text": "and um there's a like unsanitized",
    "start": "791600",
    "end": "795899"
  },
  {
    "text": "parameter there called store that",
    "start": "795899",
    "end": "798720"
  },
  {
    "text": "actually allows us to perform DRC",
    "start": "798720",
    "end": "803480"
  },
  {
    "text": "there we go so we can run LS",
    "start": "806339",
    "end": "809160"
  },
  {
    "text": "slash and attacker sees this one so I",
    "start": "809160",
    "end": "811860"
  },
  {
    "text": "didn't do ends and stuff but attacker",
    "start": "811860",
    "end": "813720"
  },
  {
    "text": "can easily understand that this is a pod",
    "start": "813720",
    "end": "815700"
  },
  {
    "text": "and this is it's running in AKs so this",
    "start": "815700",
    "end": "818700"
  },
  {
    "text": "looks interesting it's a host config",
    "start": "818700",
    "end": "820560"
  },
  {
    "text": "that's the name of the slash Etsy actual",
    "start": "820560",
    "end": "824700"
  },
  {
    "text": "host config and attacker just goes into",
    "start": "824700",
    "end": "826980"
  },
  {
    "text": "the place where NPD expects to see",
    "start": "826980",
    "end": "829260"
  },
  {
    "text": "plugins list the plugins and see oh this",
    "start": "829260",
    "end": "832860"
  },
  {
    "text": "is really AKs worker node so we can",
    "start": "832860",
    "end": "835800"
  },
  {
    "text": "let's see what we can do with that",
    "start": "835800",
    "end": "839220"
  },
  {
    "text": "and we they can even damp this plugin",
    "start": "839220",
    "end": "842579"
  },
  {
    "text": "this is how plugins the the actual",
    "start": "842579",
    "end": "844560"
  },
  {
    "text": "actual works it's just a dash script",
    "start": "844560",
    "end": "848300"
  },
  {
    "text": "now the problem because the the",
    "start": "849720",
    "end": "851339"
  },
  {
    "text": "container runs is root so of course they",
    "start": "851339",
    "end": "853260"
  },
  {
    "text": "can update these batch threes and that's",
    "start": "853260",
    "end": "855480"
  },
  {
    "text": "what they're going to do so I saved you",
    "start": "855480",
    "end": "857399"
  },
  {
    "text": "the pain uh of watching me updating this",
    "start": "857399",
    "end": "860700"
  },
  {
    "text": "file through echo through the through",
    "start": "860700",
    "end": "863100"
  },
  {
    "text": "the URL line but this is the uh this is",
    "start": "863100",
    "end": "866160"
  },
  {
    "text": "the final result you can see that we are",
    "start": "866160",
    "end": "869459"
  },
  {
    "text": "doing the we're cutting the token and",
    "start": "869459",
    "end": "871740"
  },
  {
    "text": "the namespace certain token from VAR lip",
    "start": "871740",
    "end": "874260"
  },
  {
    "text": "cubelet and sending it to the C2 server",
    "start": "874260",
    "end": "876540"
  },
  {
    "text": "okay that's that's the point here",
    "start": "876540",
    "end": "880220"
  },
  {
    "text": "and on this screen I'm staging my C2",
    "start": "880860",
    "end": "883620"
  },
  {
    "text": "screen server so once I update that",
    "start": "883620",
    "end": "886560"
  },
  {
    "text": "specific check terminate.sh script that",
    "start": "886560",
    "end": "890399"
  },
  {
    "text": "runs every minute so there are there's",
    "start": "890399",
    "end": "892920"
  },
  {
    "text": "additional folder of plugins.json that",
    "start": "892920",
    "end": "896040"
  },
  {
    "text": "Define how those scripts run and they",
    "start": "896040",
    "end": "899760"
  },
  {
    "text": "run periodically with certain",
    "start": "899760",
    "end": "901459"
  },
  {
    "text": "periodicity and there we go this is C2",
    "start": "901459",
    "end": "904860"
  },
  {
    "text": "and we're getting the token and the cube",
    "start": "904860",
    "end": "907620"
  },
  {
    "text": "system",
    "start": "907620",
    "end": "908399"
  },
  {
    "text": "and this one I think actually osm",
    "start": "908399",
    "end": "910320"
  },
  {
    "text": "control is talking which is pretty",
    "start": "910320",
    "end": "912360"
  },
  {
    "text": "powerful so from this pointed on we can",
    "start": "912360",
    "end": "915300"
  },
  {
    "text": "from outside we can go to the API server",
    "start": "915300",
    "end": "918000"
  },
  {
    "text": "and use this token and just uh own the",
    "start": "918000",
    "end": "921060"
  },
  {
    "text": "on the board so this part this bar lip",
    "start": "921060",
    "end": "923699"
  },
  {
    "text": "cubelet",
    "start": "923699",
    "end": "924720"
  },
  {
    "text": "remember that this stuff executed by the",
    "start": "924720",
    "end": "927540"
  },
  {
    "text": "node problem detector not by the Pod it",
    "start": "927540",
    "end": "930360"
  },
  {
    "text": "wasn't executed from the Pod it was",
    "start": "930360",
    "end": "932279"
  },
  {
    "text": "executed from the node by node problem",
    "start": "932279",
    "end": "934620"
  },
  {
    "text": "detector that's how it got the access to",
    "start": "934620",
    "end": "938160"
  },
  {
    "text": "the wireless cubelet",
    "start": "938160",
    "end": "941100"
  },
  {
    "text": "because the Pod itself didn't have that",
    "start": "941100",
    "end": "945500"
  },
  {
    "text": "all right",
    "start": "948180",
    "end": "950959"
  },
  {
    "text": "all right so let's let's see what we had",
    "start": "959399",
    "end": "961860"
  },
  {
    "text": "here we we started with we can start",
    "start": "961860",
    "end": "964320"
  },
  {
    "text": "with the Escape right we can start with",
    "start": "964320",
    "end": "966120"
  },
  {
    "text": "the container Escape but we don't need",
    "start": "966120",
    "end": "967860"
  },
  {
    "text": "to we don't even need compromise manage",
    "start": "967860",
    "end": "969720"
  },
  {
    "text": "because we can we can exploit some kind",
    "start": "969720",
    "end": "971760"
  },
  {
    "text": "of misconfiguration and file writing",
    "start": "971760",
    "end": "973620"
  },
  {
    "text": "ability of the Pod okay and this can",
    "start": "973620",
    "end": "975779"
  },
  {
    "text": "happen in any modern cluster why because",
    "start": "975779",
    "end": "977880"
  },
  {
    "text": "not problem detector is sort of like a",
    "start": "977880",
    "end": "979800"
  },
  {
    "text": "demon set it runs on every work you know",
    "start": "979800",
    "end": "982079"
  },
  {
    "text": "so one mistake in one of the working",
    "start": "982079",
    "end": "984839"
  },
  {
    "text": "notes is enough okay and then we write",
    "start": "984839",
    "end": "987180"
  },
  {
    "text": "in the script we no problem detector",
    "start": "987180",
    "end": "989519"
  },
  {
    "text": "immediately pretty much immediately",
    "start": "989519",
    "end": "990839"
  },
  {
    "text": "picks up like a plugin and then we have",
    "start": "990839",
    "end": "992820"
  },
  {
    "text": "the periodic execution as a root to do",
    "start": "992820",
    "end": "995579"
  },
  {
    "text": "nasty stuff like dot SSH basically",
    "start": "995579",
    "end": "998040"
  },
  {
    "text": "establish persistence",
    "start": "998040",
    "end": "999600"
  },
  {
    "text": "and eventually spread to other nodes",
    "start": "999600",
    "end": "1003160"
  },
  {
    "text": "through usage of the tokens",
    "start": "1003160",
    "end": "1005779"
  },
  {
    "text": "right now the interesting part here is",
    "start": "1005779",
    "end": "1009019"
  },
  {
    "text": "that first this all happens",
    "start": "1009019",
    "end": "1011240"
  },
  {
    "text": "under the radar of API server",
    "start": "1011240",
    "end": "1014720"
  },
  {
    "text": "so what's the consequences",
    "start": "1014720",
    "end": "1017420"
  },
  {
    "text": "there is no audit Trace",
    "start": "1017420",
    "end": "1019399"
  },
  {
    "text": "and admission controller is blind to",
    "start": "1019399",
    "end": "1021860"
  },
  {
    "text": "this attack because it happens",
    "start": "1021860",
    "end": "1023660"
  },
  {
    "text": "underneath the radar of API server",
    "start": "1023660",
    "end": "1026418"
  },
  {
    "text": "and probably we will bypass the EGR",
    "start": "1026419",
    "end": "1029360"
  },
  {
    "text": "because no problem detector is known to",
    "start": "1029360",
    "end": "1031160"
  },
  {
    "text": "all the EGR solution otherwise they",
    "start": "1031160",
    "end": "1033380"
  },
  {
    "text": "would it would generate a bunch of false",
    "start": "1033380",
    "end": "1035480"
  },
  {
    "text": "positives so if you ask me this is",
    "start": "1035480",
    "end": "1037400"
  },
  {
    "text": "pretty cool this is kind of I guess it",
    "start": "1037400",
    "end": "1039500"
  },
  {
    "text": "can be described as a kubernetes",
    "start": "1039500",
    "end": "1041000"
  },
  {
    "text": "privilege escalation from writing into a",
    "start": "1041000",
    "end": "1043520"
  },
  {
    "text": "certain folder in the Pod context to",
    "start": "1043520",
    "end": "1045319"
  },
  {
    "text": "owning all the notes",
    "start": "1045319",
    "end": "1047120"
  },
  {
    "text": "okay that's all on",
    "start": "1047120",
    "end": "1050559"
  },
  {
    "text": "use case to flown bit okay I bet",
    "start": "1052640",
    "end": "1055820"
  },
  {
    "text": "everybody knows this um",
    "start": "1055820",
    "end": "1057980"
  },
  {
    "text": "very popular log management platform and",
    "start": "1057980",
    "end": "1060740"
  },
  {
    "text": "it's taught it's installed on every gke",
    "start": "1060740",
    "end": "1062660"
  },
  {
    "text": "cluster and you can install it according",
    "start": "1062660",
    "end": "1064760"
  },
  {
    "text": "to eks best practices you install it",
    "start": "1064760",
    "end": "1066980"
  },
  {
    "text": "from Upstream",
    "start": "1066980",
    "end": "1068539"
  },
  {
    "text": "latest versions is 1.812 okay this is",
    "start": "1068539",
    "end": "1072380"
  },
  {
    "text": "not very interesting but what's",
    "start": "1072380",
    "end": "1073400"
  },
  {
    "text": "interesting is the feature that we're",
    "start": "1073400",
    "end": "1075020"
  },
  {
    "text": "going to exploit the exact input plugin",
    "start": "1075020",
    "end": "1077840"
  },
  {
    "text": "with such a juicy name of course we",
    "start": "1077840",
    "end": "1079880"
  },
  {
    "text": "couldn't let it stay and so we're going",
    "start": "1079880",
    "end": "1083660"
  },
  {
    "text": "to use this construct so for those of",
    "start": "1083660",
    "end": "1087020"
  },
  {
    "text": "you of you who never use fluid it's",
    "start": "1087020",
    "end": "1089360"
  },
  {
    "text": "basically the config consists of a bunch",
    "start": "1089360",
    "end": "1091160"
  },
  {
    "text": "of sections input sections that Define",
    "start": "1091160",
    "end": "1093740"
  },
  {
    "text": "the source of the logs",
    "start": "1093740",
    "end": "1095840"
  },
  {
    "text": "then or certain filter sections that the",
    "start": "1095840",
    "end": "1099080"
  },
  {
    "text": "functions with the locks and then the",
    "start": "1099080",
    "end": "1101120"
  },
  {
    "text": "output sections that actually say where",
    "start": "1101120",
    "end": "1103039"
  },
  {
    "text": "to send the log",
    "start": "1103039",
    "end": "1104840"
  },
  {
    "text": "and this",
    "start": "1104840",
    "end": "1106179"
  },
  {
    "text": "nasty plugin input basically instead of",
    "start": "1106179",
    "end": "1109340"
  },
  {
    "text": "defining the source of the logs you can",
    "start": "1109340",
    "end": "1111080"
  },
  {
    "text": "just perform command in this case LS",
    "start": "1111080",
    "end": "1114020"
  },
  {
    "text": "slash but of course we're not interested",
    "start": "1114020",
    "end": "1116299"
  },
  {
    "text": "in the logs we're interested in",
    "start": "1116299",
    "end": "1117440"
  },
  {
    "text": "something more serious",
    "start": "1117440",
    "end": "1119360"
  },
  {
    "text": "and that's the attack flow we will",
    "start": "1119360",
    "end": "1121520"
  },
  {
    "text": "update the config map that used by",
    "start": "1121520",
    "end": "1124460"
  },
  {
    "text": "fluent bead fluent bit will pick up this",
    "start": "1124460",
    "end": "1127039"
  },
  {
    "text": "malicious config and because the cluster",
    "start": "1127039",
    "end": "1130580"
  },
  {
    "text": "will shrink and expand eventually the",
    "start": "1130580",
    "end": "1132799"
  },
  {
    "text": "config map the malicious config map will",
    "start": "1132799",
    "end": "1134840"
  },
  {
    "text": "get picked up by all the new affluent",
    "start": "1134840",
    "end": "1138200"
  },
  {
    "text": "bitports okay so let's say the this in",
    "start": "1138200",
    "end": "1140840"
  },
  {
    "text": "action",
    "start": "1140840",
    "end": "1143020"
  },
  {
    "text": "foreign",
    "start": "1145460",
    "end": "1147640"
  },
  {
    "text": "so we find ourselves in ETS cluster",
    "start": "1153740",
    "end": "1158380"
  },
  {
    "text": "we see that we have only one node for",
    "start": "1159140",
    "end": "1161240"
  },
  {
    "text": "now just easier that great and in the",
    "start": "1161240",
    "end": "1164179"
  },
  {
    "text": "pots we can see that we have the phone",
    "start": "1164179",
    "end": "1166039"
  },
  {
    "text": "bit there is and it is",
    "start": "1166039",
    "end": "1168980"
  },
  {
    "text": "now we are dumping the CMS",
    "start": "1168980",
    "end": "1174140"
  },
  {
    "text": "this is the flu and bit config",
    "start": "1176600",
    "end": "1178700"
  },
  {
    "text": "this is the CM that we're going to use",
    "start": "1178700",
    "end": "1180679"
  },
  {
    "text": "and Amazon Cloud watch is the diff",
    "start": "1180679",
    "end": "1182539"
  },
  {
    "text": "default namespace that I just followed",
    "start": "1182539",
    "end": "1184640"
  },
  {
    "text": "the best AKs best practices guide to",
    "start": "1184640",
    "end": "1187880"
  },
  {
    "text": "install this",
    "start": "1187880",
    "end": "1189620"
  },
  {
    "text": "what this demon said",
    "start": "1189620",
    "end": "1191480"
  },
  {
    "text": "now if we're taking the CM and damping",
    "start": "1191480",
    "end": "1195860"
  },
  {
    "text": "it the the pretty print doesn't know how",
    "start": "1195860",
    "end": "1198200"
  },
  {
    "text": "to deal with that it's a known problem",
    "start": "1198200",
    "end": "1200720"
  },
  {
    "text": "um it hasn't been solved however when",
    "start": "1200720",
    "end": "1203539"
  },
  {
    "text": "you added the CM",
    "start": "1203539",
    "end": "1205280"
  },
  {
    "text": "it's actually yeah",
    "start": "1205280",
    "end": "1207799"
  },
  {
    "text": "printed printing so what we're doing",
    "start": "1207799",
    "end": "1209900"
  },
  {
    "text": "here we're adding it and adding that",
    "start": "1209900",
    "end": "1212240"
  },
  {
    "text": "construct input and output and all",
    "start": "1212240",
    "end": "1215539"
  },
  {
    "text": "for the sake of time",
    "start": "1215539",
    "end": "1218740"
  },
  {
    "text": "I'll move up a bit",
    "start": "1218960",
    "end": "1221919"
  },
  {
    "text": "and explain what happens here so as an",
    "start": "1222320",
    "end": "1224840"
  },
  {
    "text": "input we Define two commands first name",
    "start": "1224840",
    "end": "1226760"
  },
  {
    "text": "and ID",
    "start": "1226760",
    "end": "1228020"
  },
  {
    "text": "okay and we can change as many commands",
    "start": "1228020",
    "end": "1230419"
  },
  {
    "text": "as we want and this they will get",
    "start": "1230419",
    "end": "1232100"
  },
  {
    "text": "executed by the flowing bit every 10",
    "start": "1232100",
    "end": "1234260"
  },
  {
    "text": "seconds so you you might not see this",
    "start": "1234260",
    "end": "1236000"
  },
  {
    "text": "but this is 10 you give interval and",
    "start": "1236000",
    "end": "1238820"
  },
  {
    "text": "then you give output what to do with",
    "start": "1238820",
    "end": "1240799"
  },
  {
    "text": "this input",
    "start": "1240799",
    "end": "1242120"
  },
  {
    "text": "so in this case the output of these",
    "start": "1242120",
    "end": "1243860"
  },
  {
    "text": "commands will get sent to our C2 server",
    "start": "1243860",
    "end": "1246080"
  },
  {
    "text": "of course to Port 44444",
    "start": "1246080",
    "end": "1249200"
  },
  {
    "text": "and that's good enough for us",
    "start": "1249200",
    "end": "1253179"
  },
  {
    "text": "okay so we were able to",
    "start": "1263360",
    "end": "1265940"
  },
  {
    "text": "um to update the config map",
    "start": "1265940",
    "end": "1268280"
  },
  {
    "text": "and now we're just waiting what are we",
    "start": "1268280",
    "end": "1270740"
  },
  {
    "text": "waiting for the config map is not real",
    "start": "1270740",
    "end": "1272720"
  },
  {
    "text": "time right the update doesn't work in",
    "start": "1272720",
    "end": "1274580"
  },
  {
    "text": "real time so we waiting for a new node",
    "start": "1274580",
    "end": "1276860"
  },
  {
    "text": "to get created and to pick it up right",
    "start": "1276860",
    "end": "1279320"
  },
  {
    "text": "so in behind the scenes to make it",
    "start": "1279320",
    "end": "1281299"
  },
  {
    "text": "faster I'm just I I'm increasing the",
    "start": "1281299",
    "end": "1284780"
  },
  {
    "text": "number of nodes to two and now I'm",
    "start": "1284780",
    "end": "1286760"
  },
  {
    "text": "waiting for uh for another node to",
    "start": "1286760",
    "end": "1288620"
  },
  {
    "text": "appear",
    "start": "1288620",
    "end": "1290000"
  },
  {
    "text": "and then hopefully the the next fluent",
    "start": "1290000",
    "end": "1293720"
  },
  {
    "text": "bead part because it's a demon set right",
    "start": "1293720",
    "end": "1296539"
  },
  {
    "text": "it will pick up the new config and it",
    "start": "1296539",
    "end": "1299299"
  },
  {
    "text": "will execute whatever we ask from it",
    "start": "1299299",
    "end": "1303100"
  },
  {
    "text": "okay so there we go we we found what and",
    "start": "1315919",
    "end": "1318260"
  },
  {
    "text": "then we see the additional container",
    "start": "1318260",
    "end": "1319940"
  },
  {
    "text": "created but this this new fluent bit pod",
    "start": "1319940",
    "end": "1322460"
  },
  {
    "text": "great and because we defined every 10",
    "start": "1322460",
    "end": "1324799"
  },
  {
    "text": "seconds so this this the command should",
    "start": "1324799",
    "end": "1327500"
  },
  {
    "text": "execute every 10 seconds so in parallel",
    "start": "1327500",
    "end": "1329480"
  },
  {
    "text": "we are starting our C2 python server and",
    "start": "1329480",
    "end": "1333740"
  },
  {
    "text": "there we go there we get in the commands",
    "start": "1333740",
    "end": "1336020"
  },
  {
    "text": "and you see the fluid packs it really",
    "start": "1336020",
    "end": "1337880"
  },
  {
    "text": "nicely it just runs hostname then runs",
    "start": "1337880",
    "end": "1339980"
  },
  {
    "text": "ID backs them as adjacent it we just can",
    "start": "1339980",
    "end": "1343159"
  },
  {
    "text": "we can use the fluid functionality to",
    "start": "1343159",
    "end": "1345799"
  },
  {
    "text": "retrieve to exfiltrate whatever data we",
    "start": "1345799",
    "end": "1347600"
  },
  {
    "text": "want",
    "start": "1347600",
    "end": "1349720"
  },
  {
    "text": "all right so this was the Second Use",
    "start": "1354799",
    "end": "1357260"
  },
  {
    "text": "case",
    "start": "1357260",
    "end": "1358280"
  },
  {
    "text": "what happened here right so our",
    "start": "1358280",
    "end": "1360260"
  },
  {
    "text": "assumption and I want to be very clear",
    "start": "1360260",
    "end": "1361640"
  },
  {
    "text": "about the reception our assumption was",
    "start": "1361640",
    "end": "1363860"
  },
  {
    "text": "that we had misconfiguration some kind",
    "start": "1363860",
    "end": "1365600"
  },
  {
    "text": "of config config Map update right it",
    "start": "1365600",
    "end": "1368419"
  },
  {
    "text": "happens",
    "start": "1368419",
    "end": "1369799"
  },
  {
    "text": "um we like",
    "start": "1369799",
    "end": "1372080"
  },
  {
    "text": "in this case we were able to update the",
    "start": "1372080",
    "end": "1374900"
  },
  {
    "text": "config map that fluentbit is using and",
    "start": "1374900",
    "end": "1378580"
  },
  {
    "text": "eventually all new nodes because the",
    "start": "1378580",
    "end": "1380900"
  },
  {
    "text": "production cluster draws and shrinks",
    "start": "1380900",
    "end": "1382940"
  },
  {
    "text": "right it's it's very Dynamic So",
    "start": "1382940",
    "end": "1385340"
  },
  {
    "text": "eventually if you think about it all the",
    "start": "1385340",
    "end": "1387320"
  },
  {
    "text": "new nodes will have this turnover and",
    "start": "1387320",
    "end": "1390140"
  },
  {
    "text": "they will pick up the new config map",
    "start": "1390140",
    "end": "1392480"
  },
  {
    "text": "and we will achieve the all node",
    "start": "1392480",
    "end": "1394580"
  },
  {
    "text": "persistent execution so this is cool",
    "start": "1394580",
    "end": "1397100"
  },
  {
    "text": "stuff because it's resistant to restart",
    "start": "1397100",
    "end": "1399679"
  },
  {
    "text": "because config map is saved in Etsy",
    "start": "1399679",
    "end": "1402919"
  },
  {
    "text": "CD right so even if the if the nodes",
    "start": "1402919",
    "end": "1406340"
  },
  {
    "text": "will get restarted I've created new one",
    "start": "1406340",
    "end": "1408080"
  },
  {
    "text": "they will pick that malicious config and",
    "start": "1408080",
    "end": "1410600"
  },
  {
    "text": "again we are running underneath the API",
    "start": "1410600",
    "end": "1413900"
  },
  {
    "text": "server admission controller is blind",
    "start": "1413900",
    "end": "1416659"
  },
  {
    "text": "there's no audit trace and we probably",
    "start": "1416659",
    "end": "1419299"
  },
  {
    "text": "bypass CDR because it's all happens as a",
    "start": "1419299",
    "end": "1421400"
  },
  {
    "text": "fluid now the impact is limited by what",
    "start": "1421400",
    "end": "1424700"
  },
  {
    "text": "fluid can do but typically fluent bit",
    "start": "1424700",
    "end": "1426799"
  },
  {
    "text": "nodes can do can assemble collect tons",
    "start": "1426799",
    "end": "1431360"
  },
  {
    "text": "of information because it's a it's a log",
    "start": "1431360",
    "end": "1433520"
  },
  {
    "text": "management platform so there are tons of",
    "start": "1433520",
    "end": "1435200"
  },
  {
    "text": "host paths mapped into the phone bit so",
    "start": "1435200",
    "end": "1438500"
  },
  {
    "text": "attacker can use them",
    "start": "1438500",
    "end": "1441520"
  },
  {
    "text": "all right what can we do to reduce the",
    "start": "1443600",
    "end": "1445700"
  },
  {
    "text": "risk one the first thing of course",
    "start": "1445700",
    "end": "1447980"
  },
  {
    "text": "I don't know use the security vendors",
    "start": "1447980",
    "end": "1450080"
  },
  {
    "text": "however what's the problem with security",
    "start": "1450080",
    "end": "1451760"
  },
  {
    "text": "render vendors and control plan and",
    "start": "1451760",
    "end": "1454039"
  },
  {
    "text": "middleware they typically accept",
    "start": "1454039",
    "end": "1458019"
  },
  {
    "text": "either by the cube system or through the",
    "start": "1459080",
    "end": "1461600"
  },
  {
    "text": "kubernetes users or container image name",
    "start": "1461600",
    "end": "1463640"
  },
  {
    "text": "some examples gatekeeper flow that",
    "start": "1463640",
    "end": "1466460"
  },
  {
    "text": "accept the cube system this is I think",
    "start": "1466460",
    "end": "1469640"
  },
  {
    "text": "Tracy rule right that accepts flannel DK",
    "start": "1469640",
    "end": "1472400"
  },
  {
    "text": "proxy etc etc based on the process name",
    "start": "1472400",
    "end": "1474919"
  },
  {
    "text": "and this is a Falco rule that accepts",
    "start": "1474919",
    "end": "1477080"
  },
  {
    "text": "based on the kubernetes containers that",
    "start": "1477080",
    "end": "1479840"
  },
  {
    "text": "are this is a macro that defines",
    "start": "1479840",
    "end": "1481520"
  },
  {
    "text": "elsewhere before in the file just has a",
    "start": "1481520",
    "end": "1484640"
  },
  {
    "text": "list of white listed containers",
    "start": "1484640",
    "end": "1487940"
  },
  {
    "text": "so that's a problem okay what else can",
    "start": "1487940",
    "end": "1489919"
  },
  {
    "text": "we use well let's use defense PSS right",
    "start": "1489919",
    "end": "1492980"
  },
  {
    "text": "that's the PSP V2",
    "start": "1492980",
    "end": "1496000"
  },
  {
    "text": "well not so fast because you can't apply",
    "start": "1496000",
    "end": "1499039"
  },
  {
    "text": "PSS on the cube system namespace",
    "start": "1499039",
    "end": "1503240"
  },
  {
    "text": "and not just Cube system namespace but",
    "start": "1503240",
    "end": "1505280"
  },
  {
    "text": "couple more namespaces like if you at",
    "start": "1505280",
    "end": "1507919"
  },
  {
    "text": "least public or something like this",
    "start": "1507919",
    "end": "1509960"
  },
  {
    "text": "so this is a problem this is a problem",
    "start": "1509960",
    "end": "1511760"
  },
  {
    "text": "because we know that many many",
    "start": "1511760",
    "end": "1513320"
  },
  {
    "text": "middleware components are being dumped",
    "start": "1513320",
    "end": "1515419"
  },
  {
    "text": "automatically into the cube system",
    "start": "1515419",
    "end": "1516799"
  },
  {
    "text": "namespace on the other hand we can't use",
    "start": "1516799",
    "end": "1519320"
  },
  {
    "text": "our typical security controls kubernetes",
    "start": "1519320",
    "end": "1521900"
  },
  {
    "text": "security controls okay what else can we",
    "start": "1521900",
    "end": "1524720"
  },
  {
    "text": "use well let's try the user in this this",
    "start": "1524720",
    "end": "1526820"
  },
  {
    "text": "is also a new shiny feature in V 1.25",
    "start": "1526820",
    "end": "1530000"
  },
  {
    "text": "the game Alpha",
    "start": "1530000",
    "end": "1532159"
  },
  {
    "text": "um so the it basically limits the impact",
    "start": "1532159",
    "end": "1534919"
  },
  {
    "text": "of the container Escape so that now",
    "start": "1534919",
    "end": "1537020"
  },
  {
    "text": "container route is not a host root so",
    "start": "1537020",
    "end": "1539779"
  },
  {
    "text": "this is pretty cool however",
    "start": "1539779",
    "end": "1542419"
  },
  {
    "text": "you can't use username spaces on more",
    "start": "1542419",
    "end": "1545600"
  },
  {
    "text": "than half of those components from the",
    "start": "1545600",
    "end": "1547279"
  },
  {
    "text": "as well remember from 13 out of 25 you",
    "start": "1547279",
    "end": "1549799"
  },
  {
    "text": "can't use it why because there are",
    "start": "1549799",
    "end": "1552020"
  },
  {
    "text": "certain conditions there's a like we",
    "start": "1552020",
    "end": "1553760"
  },
  {
    "text": "whisk we sketch this in the in our blog",
    "start": "1553760",
    "end": "1556100"
  },
  {
    "text": "there are certain conditions where you",
    "start": "1556100",
    "end": "1558020"
  },
  {
    "text": "just can't use user and Ace and as if",
    "start": "1558020",
    "end": "1560059"
  },
  {
    "text": "you need for example access to resources",
    "start": "1560059",
    "end": "1562400"
  },
  {
    "text": "that managed by the initial one of the",
    "start": "1562400",
    "end": "1564380"
  },
  {
    "text": "initial Linux",
    "start": "1564380",
    "end": "1566200"
  },
  {
    "text": "namespaces because the thing with the",
    "start": "1566200",
    "end": "1569539"
  },
  {
    "text": "username is that it's very like rigid",
    "start": "1569539",
    "end": "1571760"
  },
  {
    "text": "and inflexible so it's everything or",
    "start": "1571760",
    "end": "1574400"
  },
  {
    "text": "nothing",
    "start": "1574400",
    "end": "1575600"
  },
  {
    "text": "so unfortunately we probably won't be",
    "start": "1575600",
    "end": "1577700"
  },
  {
    "text": "able to use it on the middleware",
    "start": "1577700",
    "end": "1580880"
  },
  {
    "text": "what else how about we just remove all",
    "start": "1580880",
    "end": "1583460"
  },
  {
    "text": "the middleware on the host level well",
    "start": "1583460",
    "end": "1585200"
  },
  {
    "text": "but then you can't apply kubernetes",
    "start": "1585200",
    "end": "1586880"
  },
  {
    "text": "level security controls right and then",
    "start": "1586880",
    "end": "1588919"
  },
  {
    "text": "they they will probably get excluded",
    "start": "1588919",
    "end": "1590600"
  },
  {
    "text": "from the edrs as well so this is also",
    "start": "1590600",
    "end": "1592640"
  },
  {
    "text": "not a great solution",
    "start": "1592640",
    "end": "1594200"
  },
  {
    "text": "what is a good solution well it's not",
    "start": "1594200",
    "end": "1596720"
  },
  {
    "text": "here but first of all don't try and",
    "start": "1596720",
    "end": "1598159"
  },
  {
    "text": "contain this as a root right we have we",
    "start": "1598159",
    "end": "1599900"
  },
  {
    "text": "we're keeping this Mantra like multiple",
    "start": "1599900",
    "end": "1602840"
  },
  {
    "text": "years but still most of the containers",
    "start": "1602840",
    "end": "1604820"
  },
  {
    "text": "are running this route because it's",
    "start": "1604820",
    "end": "1606200"
  },
  {
    "text": "handy",
    "start": "1606200",
    "end": "1607279"
  },
  {
    "text": "but that would probably stop the first",
    "start": "1607279",
    "end": "1609799"
  },
  {
    "text": "attack right the user will be able the",
    "start": "1609799",
    "end": "1612620"
  },
  {
    "text": "attacker won't be able to ride into the",
    "start": "1612620",
    "end": "1614480"
  },
  {
    "text": "slash kids",
    "start": "1614480",
    "end": "1615559"
  },
  {
    "text": "if not true right",
    "start": "1615559",
    "end": "1617260"
  },
  {
    "text": "in this case this is a bit different",
    "start": "1617260",
    "end": "1619700"
  },
  {
    "text": "what I want to to show you with the core",
    "start": "1619700",
    "end": "1621679"
  },
  {
    "text": "DNS core DNS has the same problem as a",
    "start": "1621679",
    "end": "1624380"
  },
  {
    "text": "phone beat",
    "start": "1624380",
    "end": "1625640"
  },
  {
    "text": "takes the config map in the config map",
    "start": "1625640",
    "end": "1628460"
  },
  {
    "text": "in the core DNS configment by the way",
    "start": "1628460",
    "end": "1630260"
  },
  {
    "text": "it's installed on all ETS and ATS",
    "start": "1630260",
    "end": "1632419"
  },
  {
    "text": "clusters by default there's a plugin",
    "start": "1632419",
    "end": "1634760"
  },
  {
    "text": "called on",
    "start": "1634760",
    "end": "1636980"
  },
  {
    "text": "does anybody knows about this I didn't",
    "start": "1636980",
    "end": "1639380"
  },
  {
    "text": "know so you can you can write something",
    "start": "1639380",
    "end": "1641960"
  },
  {
    "text": "if if you if you can update the config",
    "start": "1641960",
    "end": "1644299"
  },
  {
    "text": "map",
    "start": "1644299",
    "end": "1645200"
  },
  {
    "text": "you can do something like this one",
    "start": "1645200",
    "end": "1646640"
  },
  {
    "text": "startup and then comment execution",
    "start": "1646640",
    "end": "1651039"
  },
  {
    "text": "so that's a problem however it's not use",
    "start": "1651559",
    "end": "1653600"
  },
  {
    "text": "case number three why because this",
    "start": "1653600",
    "end": "1655100"
  },
  {
    "text": "doesn't work why doesn't it work because",
    "start": "1655100",
    "end": "1656840"
  },
  {
    "text": "execute touch executable file not found",
    "start": "1656840",
    "end": "1660080"
  },
  {
    "text": "who knows what's this this means that",
    "start": "1660080",
    "end": "1662480"
  },
  {
    "text": "coordinates doesn't have bash execution",
    "start": "1662480",
    "end": "1664340"
  },
  {
    "text": "context",
    "start": "1664340",
    "end": "1665299"
  },
  {
    "text": "because it's a sling container maximum",
    "start": "1665299",
    "end": "1667820"
  },
  {
    "text": "images",
    "start": "1667820",
    "end": "1669500"
  },
  {
    "text": "it doesn't have the package manager as",
    "start": "1669500",
    "end": "1671600"
  },
  {
    "text": "well",
    "start": "1671600",
    "end": "1672679"
  },
  {
    "text": "so this works",
    "start": "1672679",
    "end": "1674960"
  },
  {
    "text": "okay two conclusions",
    "start": "1674960",
    "end": "1677960"
  },
  {
    "text": "inclusive controls right we saw that our",
    "start": "1677960",
    "end": "1680120"
  },
  {
    "text": "security controls don't take into",
    "start": "1680120",
    "end": "1682100"
  },
  {
    "text": "account group system and middleware",
    "start": "1682100",
    "end": "1683960"
  },
  {
    "text": "unfortunately",
    "start": "1683960",
    "end": "1685460"
  },
  {
    "text": "threat models a word about threat models",
    "start": "1685460",
    "end": "1688100"
  },
  {
    "text": "if you remember cncf Financial Group",
    "start": "1688100",
    "end": "1690080"
  },
  {
    "text": "created the trust boundaries right and",
    "start": "1690080",
    "end": "1692600"
  },
  {
    "text": "the attack trees for establishing",
    "start": "1692600",
    "end": "1694520"
  },
  {
    "text": "persistence you won't find middleware on",
    "start": "1694520",
    "end": "1697760"
  },
  {
    "text": "those diagrams it's all about proper",
    "start": "1697760",
    "end": "1700220"
  },
  {
    "text": "control plane",
    "start": "1700220",
    "end": "1701960"
  },
  {
    "text": "another prominent example is the Trail",
    "start": "1701960",
    "end": "1704600"
  },
  {
    "text": "of bit security audit right",
    "start": "1704600",
    "end": "1706880"
  },
  {
    "text": "that's the components that they took a",
    "start": "1706880",
    "end": "1708740"
  },
  {
    "text": "look do you see any middleware component",
    "start": "1708740",
    "end": "1710539"
  },
  {
    "text": "I don't see fluently here I don't see no",
    "start": "1710539",
    "end": "1712880"
  },
  {
    "text": "problem detector",
    "start": "1712880",
    "end": "1714740"
  },
  {
    "text": "but it's still running on every AKs",
    "start": "1714740",
    "end": "1717080"
  },
  {
    "text": "engine key no",
    "start": "1717080",
    "end": "1719799"
  },
  {
    "text": "summary thinking to do perhaps we need",
    "start": "1720080",
    "end": "1722240"
  },
  {
    "text": "to rethink our permission so in my book",
    "start": "1722240",
    "end": "1724340"
  },
  {
    "text": "config Maps update it's very powerful",
    "start": "1724340",
    "end": "1726919"
  },
  {
    "text": "it's admin",
    "start": "1726919",
    "end": "1728440"
  },
  {
    "text": "namespace update patch power user",
    "start": "1728440",
    "end": "1731360"
  },
  {
    "text": "because then we just namespace remove an",
    "start": "1731360",
    "end": "1734240"
  },
  {
    "text": "annotation on namespace and labels you",
    "start": "1734240",
    "end": "1736159"
  },
  {
    "text": "can remove the security control on any",
    "start": "1736159",
    "end": "1738020"
  },
  {
    "text": "namespace perhaps we need to think about",
    "start": "1738020",
    "end": "1740480"
  },
  {
    "text": "CSP based method",
    "start": "1740480",
    "end": "1742360"
  },
  {
    "text": "you're thinking kubernetes detection we",
    "start": "1742360",
    "end": "1744679"
  },
  {
    "text": "need a multi-level approach we saw that",
    "start": "1744679",
    "end": "1746240"
  },
  {
    "text": "it's not just it's it's misconfiguration",
    "start": "1746240",
    "end": "1748659"
  },
  {
    "text": "then you need to understand the Arabic",
    "start": "1748659",
    "end": "1751340"
  },
  {
    "text": "impact and then you probably need log",
    "start": "1751340",
    "end": "1754220"
  },
  {
    "text": "base detection as well",
    "start": "1754220",
    "end": "1756140"
  },
  {
    "text": "and on top of that you probably need",
    "start": "1756140",
    "end": "1757580"
  },
  {
    "text": "agent-based detection as well some kind",
    "start": "1757580",
    "end": "1759740"
  },
  {
    "text": "of sensor to to detect that node from",
    "start": "1759740",
    "end": "1761600"
  },
  {
    "text": "the vector somehow right so you need",
    "start": "1761600",
    "end": "1763760"
  },
  {
    "text": "this multi-level approach to the cluster",
    "start": "1763760",
    "end": "1766159"
  },
  {
    "text": "it's not just log it's just one thing",
    "start": "1766159",
    "end": "1768500"
  },
  {
    "text": "just won't work with this complex",
    "start": "1768500",
    "end": "1770299"
  },
  {
    "text": "attacks",
    "start": "1770299",
    "end": "1771740"
  },
  {
    "text": "and eventually everything can see it's",
    "start": "1771740",
    "end": "1773480"
  },
  {
    "text": "be visibility",
    "start": "1773480",
    "end": "1774919"
  },
  {
    "text": "the ultimate question what do we really",
    "start": "1774919",
    "end": "1776720"
  },
  {
    "text": "have in our worker nodes and I hope that",
    "start": "1776720",
    "end": "1778880"
  },
  {
    "text": "this talk was kind of the first step",
    "start": "1778880",
    "end": "1780620"
  },
  {
    "text": "towards answer this question so that's",
    "start": "1780620",
    "end": "1782600"
  },
  {
    "text": "all I had for today thank you so much",
    "start": "1782600",
    "end": "1784700"
  },
  {
    "text": "for coming I'll be happy to take",
    "start": "1784700",
    "end": "1786679"
  },
  {
    "text": "questions if we have",
    "start": "1786679",
    "end": "1788240"
  },
  {
    "text": "if not I'll just hang around here and I",
    "start": "1788240",
    "end": "1791419"
  },
  {
    "text": "will be on Snap thank you",
    "start": "1791419",
    "end": "1793380"
  },
  {
    "text": "[Applause]",
    "start": "1793380",
    "end": "1796859"
  }
]