[
  {
    "text": "they've told me that my time has begun so while we are all still getting settled let me get an idea of who's out",
    "start": "480",
    "end": "8440"
  },
  {
    "text": "there then I'll give you an idea who's up here who here it's your first cubec con oh yeah okay good good that's",
    "start": "8440",
    "end": "17320"
  },
  {
    "text": "actually really good I I was aiming this for a very much a beginner audience and I like to see lots of beginners out",
    "start": "17320",
    "end": "22400"
  },
  {
    "text": "there who here has been to at least three cubec okay we've got a few got a few",
    "start": "22400",
    "end": "28880"
  },
  {
    "text": "veterans who has ever gone through and successfully completed kubernetes the hard",
    "start": "28880",
    "end": "35079"
  },
  {
    "text": "way okay I see a few hands there all right y'all maybe don't need to be here but you're welcome to",
    "start": "35079",
    "end": "41399"
  },
  {
    "text": "stay I love uh you know and if I say something wrong feel free to like jump in and be like",
    "start": "41399",
    "end": "47280"
  },
  {
    "text": "no so uh we are here to grab our can openers and apply them to kubernetes",
    "start": "47280",
    "end": "54600"
  },
  {
    "text": "networking and this is going to be very much a not so much a dive into to the",
    "start": "54600",
    "end": "61079"
  },
  {
    "text": "kubernetes networking API constructs although they will get mentioned of course it's more about when those are in",
    "start": "61079",
    "end": "67880"
  },
  {
    "text": "play what do you actually see outside of kubernetes on your host going across your network that kind of thing so",
    "start": "67880",
    "end": "74880"
  },
  {
    "text": "there's a lot of pointers in here I'm not going to dive terribly deep just because we don't have super a long",
    "start": "74880",
    "end": "80200"
  },
  {
    "text": "amount of time but there should be plenty of pointers for you to dig into things as as you desire after the talk I",
    "start": "80200",
    "end": "86640"
  },
  {
    "text": "will of course be around to answer questions even after the Q&A I'll be hanging around in the hall and such so",
    "start": "86640",
    "end": "92759"
  },
  {
    "text": "with that let me tell you who I am uh I've have been in it depending on how",
    "start": "92759",
    "end": "98520"
  },
  {
    "text": "you count for Going on 30 years now um I have worked for some large companies",
    "start": "98520",
    "end": "104799"
  },
  {
    "text": "some small companies some companies people recognize and uh probably some",
    "start": "104799",
    "end": "109960"
  },
  {
    "text": "that nobody but uh few people have ever heard of I started working with kubernetes in 2015",
    "start": "109960",
    "end": "117920"
  },
  {
    "text": "uh oh okay that's somebody in the back uh I started working with kubernetes in 2015 uh I went to work at coros shortly",
    "start": "118840",
    "end": "126600"
  },
  {
    "text": "thereafter and my first cubec con was Austin in 2017 the time that it snowed",
    "start": "126600",
    "end": "132239"
  },
  {
    "text": "in Austin Texas that was so much fun um I have you know my pronouns there's a",
    "start": "132239",
    "end": "138080"
  },
  {
    "text": "link there that how to get in touch is actually a link to the contact info page on my website and I have a couple of",
    "start": "138080",
    "end": "143879"
  },
  {
    "text": "contact info items just right there as well currently I'm a Staff Solutions",
    "start": "143879",
    "end": "149239"
  },
  {
    "text": "engineer for Hashi Corp so I do although kubernetes isn't like I don't run a",
    "start": "149239",
    "end": "155519"
  },
  {
    "text": "cluster day to day it is actually a big part of the job that I do because what I work in is our customer Design Lab and",
    "start": "155519",
    "end": "161560"
  },
  {
    "text": "so I'm working on implementing reference architectures into live demo and workshop environments to show our",
    "start": "161560",
    "end": "168640"
  },
  {
    "text": "products off to our customers and Prospects so why are we all here",
    "start": "168640",
    "end": "178640"
  },
  {
    "text": "well first and foremost we're here to learn hopefully I hope we're all here",
    "start": "178760",
    "end": "183920"
  },
  {
    "text": "for that uh but also you know learning about the",
    "start": "183920",
    "end": "189120"
  },
  {
    "text": "foundations of kubernetes networking and how we can apply the knowledge that we already have to those foundations",
    "start": "189120",
    "end": "196519"
  },
  {
    "text": "because I'm sure everybody here even if you're a kubernetes newbie you already know a lot about networking on various",
    "start": "196519",
    "end": "202680"
  },
  {
    "text": "platforms and that knowledge doesn't just go away and it doesn't become useless because you're now trying to apply it to kubernetes uh those same",
    "start": "202680",
    "end": "209439"
  },
  {
    "text": "tools tools that you've always been using they are old and well worn and wellmaintained and hopefully well kept",
    "start": "209439",
    "end": "215319"
  },
  {
    "text": "up but just because they're old doesn't mean we throw them away so what is the general situation",
    "start": "215319",
    "end": "223000"
  },
  {
    "text": "that we find ourselves in kubernetes lives on a set of hosts and it enables some very Advanced",
    "start": "223000",
    "end": "229480"
  },
  {
    "text": "networking models I know everybody here has probably run across service mesh at this point even if you're a beginner uh",
    "start": "229480",
    "end": "236760"
  },
  {
    "text": "the various kinds of service mesh we have console of course um but those models those service meshes",
    "start": "236760",
    "end": "244280"
  },
  {
    "text": "those Advanced networking uh utilities and such are all built on the same basic host operating",
    "start": "244280",
    "end": "251319"
  },
  {
    "text": "system and the same basic host networking capabilities that have been around for a really really really long",
    "start": "251319",
    "end": "259160"
  },
  {
    "text": "time uh in some cases I'll actually note some of these things that people think of as being new are actually over 20",
    "start": "259160",
    "end": "265520"
  },
  {
    "text": "years old at this point so and then some of the other tools go back even way further than that way further than I",
    "start": "265520",
    "end": "273639"
  },
  {
    "text": "do so some people would ask well aren't there already kubernetes tools to debug all the stuff in kubernetes well yeah",
    "start": "273639",
    "end": "279520"
  },
  {
    "text": "sure there are and they're great and you should definitely learn them and use a lot of them and the ephemeral debug",
    "start": "279520",
    "end": "286960"
  },
  {
    "text": "containers and such that just went GA fairly recently those are highly useful there's all kinds of nifty add-ons like",
    "start": "286960",
    "end": "292680"
  },
  {
    "text": "weave scope uh but sometimes you have trouble getting those things to work",
    "start": "292680",
    "end": "298000"
  },
  {
    "text": "getting them installed getting them running or they were installed but they were they're failing now and you have to",
    "start": "298000",
    "end": "303120"
  },
  {
    "text": "figure out why they're failing or they're not telling you something that you need to know so you might even be in",
    "start": "303120",
    "end": "308880"
  },
  {
    "text": "a situation where somebody comes to you and this is kind of My Demo later on uh somebody comes to you and says well we",
    "start": "308880",
    "end": "315320"
  },
  {
    "text": "got something broken in our cluster and I can't give you access to the cluster API but I still need you to fix it so",
    "start": "315320",
    "end": "320919"
  },
  {
    "text": "how you going to do that well you actually can do that some of some of the time so we'll go through some scenarios",
    "start": "320919",
    "end": "327360"
  },
  {
    "text": "like that so kubernetes networking in a fairly",
    "start": "327360",
    "end": "336560"
  },
  {
    "text": "large nutshell now we're going to rewind history here for a little bit back in",
    "start": "336560",
    "end": "341639"
  },
  {
    "text": "the 80s some of you may go back that far there was this thing called The OSI 7 layer model now everybody talked about",
    "start": "341639",
    "end": "349080"
  },
  {
    "text": "the OSI 7 layer model and we still kind of reference it today when you hear people talk about a layer four proxy or",
    "start": "349080",
    "end": "354840"
  },
  {
    "text": "a layer 7even load balancer that's OSI 7 layer model terminology",
    "start": "354840",
    "end": "360000"
  },
  {
    "text": "nobody ever really implemented it strictly compliantly but it's still kind of with us so the layers went from the",
    "start": "360000",
    "end": "368199"
  },
  {
    "text": "physical layer which is your actual physical ethernet cables and network interfaces all the way up to the application layer the actual thing the",
    "start": "368199",
    "end": "374520"
  },
  {
    "text": "software that you're running on the host uh kubernetes networking is layered as well and we'll go through some of those",
    "start": "374520",
    "end": "380880"
  },
  {
    "text": "layers and some of them do in fact correspond fairly well to the OSI layers",
    "start": "380880",
    "end": "386039"
  },
  {
    "text": "so we'll see how that plays out at the bottom of course with any",
    "start": "386039",
    "end": "392039"
  },
  {
    "text": "orchestration system you have the host Network itself you've got your regular host addresses that represent things",
    "start": "392039",
    "end": "397840"
  },
  {
    "text": "like physical ethernet cards or virtual machine uh virtual network interfaces",
    "start": "397840",
    "end": "403919"
  },
  {
    "text": "but then also when you add containers into the mix or at least the containers the way that they're done these days you",
    "start": "403919",
    "end": "409680"
  },
  {
    "text": "have interface pairs so you'll have one interface in the container one outside",
    "start": "409680",
    "end": "414880"
  },
  {
    "text": "the container on the host and that's how your containers actually get networking to The Host host so all of that we could",
    "start": "414880",
    "end": "422560"
  },
  {
    "text": "collectively call it the physical layer because it's all physical looking interfaces as far as the host is",
    "start": "422560",
    "end": "427680"
  },
  {
    "text": "concerned and you can treat them as physical interfaces when you're looking at them with various",
    "start": "427680",
    "end": "434120"
  },
  {
    "text": "tools look at my time real quick now above the host networking",
    "start": "434120",
    "end": "439639"
  },
  {
    "text": "layer the relatively new thing is the container networking layer so this is your Docker Bridge your container D",
    "start": "439639",
    "end": "447560"
  },
  {
    "text": "interfaces Etc this is where your container runtime starts this up handles",
    "start": "447560",
    "end": "452639"
  },
  {
    "text": "it attaches your containers to it um in kubernetes terms a lot of this gets",
    "start": "452639",
    "end": "458039"
  },
  {
    "text": "configured by cni plugins that's the container network interface that kubernetes has standardized on uh and",
    "start": "458039",
    "end": "466240"
  },
  {
    "text": "then you often install those oops I see I have a typo there you often install",
    "start": "466240",
    "end": "471319"
  },
  {
    "text": "those with Cube control how do you do that well it turns out that what you're actually doing is you're installing them",
    "start": "471319",
    "end": "479000"
  },
  {
    "text": "with privileged containers running on the host network interface so that's how you bootstrap that container pod Network",
    "start": "479000",
    "end": "485560"
  },
  {
    "text": "layer from the host layer the cni plugins that run also have",
    "start": "485560",
    "end": "491080"
  },
  {
    "text": "to set up some kind of way for traffic to get from host to host now every plugin seems to do this differently and",
    "start": "491080",
    "end": "496520"
  },
  {
    "text": "some of them support different options I remember back in the day when flannel was pretty much it um I think it",
    "start": "496520",
    "end": "502199"
  },
  {
    "text": "supported either three or four different ways to get traffic from host to host and so it would set up the host to Route",
    "start": "502199",
    "end": "509000"
  },
  {
    "text": "any thing that was intending to leave the host from the container Network to itself and then it would take care of",
    "start": "509000",
    "end": "515000"
  },
  {
    "text": "getting that traffic across in whatever way you had",
    "start": "515000",
    "end": "519399"
  },
  {
    "text": "configured so next up on top of the container Network we have the service",
    "start": "521320",
    "end": "526440"
  },
  {
    "text": "network now this one doesn't really show up as interfaces and so it took me a",
    "start": "526440",
    "end": "531920"
  },
  {
    "text": "long time to figure out well how does the service network even work it's not it doesn't have interfaces it doesn't",
    "start": "531920",
    "end": "537760"
  },
  {
    "text": "have routing rules like what is going on well it turns out that what it's doing",
    "start": "537760",
    "end": "544800"
  },
  {
    "text": "is it's running on the host and we'll talk about how in just a minute but it's",
    "start": "544800",
    "end": "551320"
  },
  {
    "text": "an abstraction the service network is kind of a fictitious Network and so even inside of kubernetes it's kind of a",
    "start": "551320",
    "end": "557720"
  },
  {
    "text": "simple it's kind of a fictitious overlay to the realish Pod network uh and if you want to know more",
    "start": "557720",
    "end": "564399"
  },
  {
    "text": "about the service API uh Tim hackin did a really good lightning talk just the other today I have a slide at the end of",
    "start": "564399",
    "end": "570839"
  },
  {
    "text": "this that has a lot of reading material and different presentations that have already gone by that you can watch later",
    "start": "570839",
    "end": "576480"
  },
  {
    "text": "and some of them that are still upcoming his lightning talk on Monday night was",
    "start": "576480",
    "end": "581600"
  },
  {
    "text": "fantastic um the gist of it was that the well the title of it was the service",
    "start": "581600",
    "end": "587000"
  },
  {
    "text": "network the worst API in kubernetes because it is so overloaded",
    "start": "587000",
    "end": "592440"
  },
  {
    "text": "and it's causing so many problems for the project at this point and services in turn have their",
    "start": "592440",
    "end": "598560"
  },
  {
    "text": "own set of L players so you can have a cluster IP service you can have a node Port service you can have a load balancer service and that basically is",
    "start": "598560",
    "end": "606040"
  },
  {
    "text": "whether it's purely internal whether it's host local or whether it's actually exposed outside the host to the rest of",
    "start": "606040",
    "end": "612399"
  },
  {
    "text": "the network then on top of services we have",
    "start": "612399",
    "end": "618720"
  },
  {
    "text": "these other abstractions Ingress Gateway API um some people are saying stop using Ingress and start using Gateway API I",
    "start": "618720",
    "end": "625680"
  },
  {
    "text": "don't know if I go that far but definitely Gateway API is something you should learn about basically every",
    "start": "625680",
    "end": "631480"
  },
  {
    "text": "service mesh you're going to find that it has a service in there probably a load balancer service um a lot of these",
    "start": "631480",
    "end": "637560"
  },
  {
    "text": "things do layer seven stuff in in literal terms a service mesh is just a big complicated application operating at",
    "start": "637560",
    "end": "644800"
  },
  {
    "text": "layer",
    "start": "644800",
    "end": "647120"
  },
  {
    "text": "7 so we talked about what we have built now let's talk about how it is built",
    "start": "651160",
    "end": "658560"
  },
  {
    "text": "what is it built on top of oh and I want to go back to this actually because if you notice this this big beautiful house",
    "start": "658560",
    "end": "665120"
  },
  {
    "text": "with this really incredible architectural detail look what it's built on top of this crude found that",
    "start": "665120",
    "end": "671000"
  },
  {
    "text": "that might even have been like a previous building's Foundation that this building was built on so the foundation",
    "start": "671000",
    "end": "676680"
  },
  {
    "text": "could even be older than the house but again just because it's old doesn't mean you don't that you have to stop using",
    "start": "676680",
    "end": "682320"
  },
  {
    "text": "it so host networking interfaces you like I said before you'll see them both",
    "start": "682320",
    "end": "687560"
  },
  {
    "text": "inside and outside of your containers you will also when you're talking about cni plug-in traffic going from host to",
    "start": "687560",
    "end": "693480"
  },
  {
    "text": "host you will often see this kind of thing reflected in the routing tables you'll see routes that will direct",
    "start": "693480",
    "end": "699360"
  },
  {
    "text": "traffic to a particular interface that is an interface managed by your cni",
    "start": "699360",
    "end": "704480"
  },
  {
    "text": "plug-in flannel did that it was the flannel zero interface now IP tables is where you",
    "start": "704480",
    "end": "711320"
  },
  {
    "text": "will see your service network show up so it doesn't have interfaces but what it does have is a whole bunch of Ip tables",
    "start": "711320",
    "end": "718200"
  },
  {
    "text": "rules or if if you set your cluster up this way it'll have a whole bunch of ipbs rules IP virtual",
    "start": "718200",
    "end": "723800"
  },
  {
    "text": "Service uh in you know these are both kernel mechanisms but they are kernel mechanisms that you can see from the",
    "start": "723800",
    "end": "729760"
  },
  {
    "text": "host without ever having to go into a",
    "start": "729760",
    "end": "733360"
  },
  {
    "text": "container now we start talking about name spaces okay remember I said some of this stuff goes back way further than",
    "start": "735880",
    "end": "741920"
  },
  {
    "text": "people think it does kernel namespaces were added to the Linux kernel way back in",
    "start": "741920",
    "end": "747880"
  },
  {
    "text": "2002 and the first Nam space was the mount Nam space they've added several others",
    "start": "747880",
    "end": "753160"
  },
  {
    "text": "since then um for a long time it was seven name spaces and then just like",
    "start": "753160",
    "end": "758480"
  },
  {
    "text": "yesterday when I was looking up the seven name spaces for this talk I saw oh they added an eighth in 2020 there is",
    "start": "758480",
    "end": "765959"
  },
  {
    "text": "now a Time name space but the three that you're mostly going to concern yourself with when you're debugging containers are going to",
    "start": "765959",
    "end": "772199"
  },
  {
    "text": "be the network since that's what we're here to talk about the PID name space that's the process ID and the mount name",
    "start": "772199",
    "end": "778560"
  },
  {
    "text": "space that is the file system that is exposed to the container and the last two you don't",
    "start": "778560",
    "end": "785120"
  },
  {
    "text": "necessarily need all the time but depending on the kind of debugging you're doing they may come in",
    "start": "785120",
    "end": "791440"
  },
  {
    "text": "handy now when we start talking about things above that level there are",
    "start": "791839",
    "end": "797360"
  },
  {
    "text": "some more exotic things coming down the pike these are actually brand new things relatively speaking uh the big one is",
    "start": "797360",
    "end": "804160"
  },
  {
    "text": "probably ebpf so anybody here who has not heard of ebpf",
    "start": "804160",
    "end": "810399"
  },
  {
    "text": "yet okay a couple of people it's all over cubec con there's tons and tons of",
    "start": "810399",
    "end": "815920"
  },
  {
    "text": "sessions about we're adding ebpf to our product we're diagnosing ebpf issues",
    "start": "815920",
    "end": "821040"
  },
  {
    "text": "definitely go to that stuff that is a new tool and it is starting to take over the world um it is going to I assume go",
    "start": "821040",
    "end": "828560"
  },
  {
    "text": "through a phase where initially it's going to be very hard to debug because ebpf is literally an opaque compiled",
    "start": "828560",
    "end": "834800"
  },
  {
    "text": "piece of bite code running in a virtual machine in the kernel so you don't don't necessarily have all the usual",
    "start": "834800",
    "end": "840560"
  },
  {
    "text": "mechanisms that you're used to to poke and prod at it and go what's going on in there but as somebody's going to have to come up with ways to do that",
    "start": "840560",
    "end": "848959"
  },
  {
    "text": "right now let's talk about getting your can opener down into the host so that",
    "start": "851519",
    "end": "857399"
  },
  {
    "text": "you can see what's going on in all these containers I said before your basic host",
    "start": "857399",
    "end": "864000"
  },
  {
    "text": "tools still work they will still tell you useful things and they work the same way interfaces are still interfaces and",
    "start": "864000",
    "end": "870240"
  },
  {
    "text": "you can still use the same interface tools like IP if config you can still",
    "start": "870240",
    "end": "876040"
  },
  {
    "text": "use the route tables the route command for routing you can use like I mentioned the IP tables command to see all the IP",
    "start": "876040",
    "end": "883079"
  },
  {
    "text": "tables rules that are in the natat table for your services um there are other higher level things that you may also be",
    "start": "883079",
    "end": "889399"
  },
  {
    "text": "able to use uh another one that I use frequently when debugging container stuff is op SSL and the op SSL s client",
    "start": "889399",
    "end": "896560"
  },
  {
    "text": "mode is great for debugging TLS issues uh but you may need to use that inside a",
    "start": "896560",
    "end": "902000"
  },
  {
    "text": "container so on the host itself in the regular host name space it may or may not tell you what you need to know and",
    "start": "902000",
    "end": "909000"
  },
  {
    "text": "so that's the big downside of you know sticking to the host name spaces entirely is some things that you need to",
    "start": "909000",
    "end": "915800"
  },
  {
    "text": "talk about live in containers so some of your basic tools may not they'll tell you about the host but you don't need to",
    "start": "915800",
    "end": "922279"
  },
  {
    "text": "know what's on the host you need to know what's going on inside the container Network so how do you get into the",
    "start": "922279",
    "end": "927639"
  },
  {
    "text": "Container well a good old standby you can try and exec into a container and if that container was built with a Dro base",
    "start": "927639",
    "end": "934880"
  },
  {
    "text": "image or somebody included a shell in it then that may succeed uh getting a shell",
    "start": "934880",
    "end": "941199"
  },
  {
    "text": "is only half the battle you have to make sure that you have the tools in that container that you need and depending on",
    "start": "941199",
    "end": "946560"
  },
  {
    "text": "the container and depending on the particular situation there may not be a way to get those tools in there if",
    "start": "946560",
    "end": "951639"
  },
  {
    "text": "they're not already there especially in a minimized container I've seen a lot of minimal",
    "start": "951639",
    "end": "956839"
  },
  {
    "text": "containers where somebody said yeah it's basically just our app binary but we're going to throw bash in there just in case we need to debug what are you going",
    "start": "956839",
    "end": "963279"
  },
  {
    "text": "to debug with there's there's not that much you can debug with bash",
    "start": "963279",
    "end": "969000"
  },
  {
    "text": "alone so how do you debug that kind of thing well you can run a debug container",
    "start": "969480",
    "end": "974759"
  },
  {
    "text": "so what you do is and and every container runtime has its own way of handling this but you have a you spawn a",
    "start": "974759",
    "end": "981240"
  },
  {
    "text": "new container you attach it to the name spaces of an existing",
    "start": "981240",
    "end": "986360"
  },
  {
    "text": "container and kuber does a weird hybrid version of this so when you start up a",
    "start": "986360",
    "end": "992519"
  },
  {
    "text": "pod who knows what the first thing to start up in a pod is pause I heard it over there the pause",
    "start": "992519",
    "end": "1000440"
  },
  {
    "text": "container starts up the pause is a little do nothing container it's just there to set up the network Nam space",
    "start": "1000440",
    "end": "1006199"
  },
  {
    "text": "and it just sits there and idles forever and then the other containers come in and they join that network namespace of",
    "start": "1006199",
    "end": "1012120"
  },
  {
    "text": "the pause container but they don't join all of its name spaces they each have their own independent pit name space",
    "start": "1012120",
    "end": "1019759"
  },
  {
    "text": "so it's kind of halfway like they're not all the same from a namespace perspective but they do share some name",
    "start": "1019759",
    "end": "1026160"
  },
  {
    "text": "spaces in the Pod uh now when you're spawning your own container of course you can pick and choose which name",
    "start": "1026160",
    "end": "1031280"
  },
  {
    "text": "spaces you want to try to share if you're trying to debug something that lives inside of a minimal",
    "start": "1031280",
    "end": "1037520"
  },
  {
    "text": "container this is one of the best ways to do it I'll show you the other one in just a second this is actually something",
    "start": "1037520",
    "end": "1044199"
  },
  {
    "text": "that kubernetes now supports recently I it's 125 it went beta and 126 it went GA",
    "start": "1044199",
    "end": "1049880"
  },
  {
    "text": "I forget the exact timeline but there's actually now a cube Cube control debug command that you can use to spawn an",
    "start": "1049880",
    "end": "1057200"
  },
  {
    "text": "ephemeral container in a pod and you can Target a container because they don't share pit name Spaces by default and",
    "start": "1057200",
    "end": "1063160"
  },
  {
    "text": "then you can do this kind of debugging when you need to but the downside of it",
    "start": "1063160",
    "end": "1068200"
  },
  {
    "text": "is a you need to be able to spawn a container through some mechanism B it's kind of heavyweight you're adding",
    "start": "1068200",
    "end": "1076440"
  },
  {
    "text": "the load of a whole container and if you're if you're doing debugging you're probably running some kind of a Dro container those can get pretty big they",
    "start": "1076440",
    "end": "1082679"
  },
  {
    "text": "can take a lot of memory so you don't always want to do this but if you can do it if it's if you have the room to do it",
    "start": "1082679",
    "end": "1089080"
  },
  {
    "text": "it's often the most convenient way to go when you can't run a debug container",
    "start": "1089080",
    "end": "1094159"
  },
  {
    "text": "but you still need to get into the Nam space there is the classic NS enter command that runs another command",
    "start": "1094159",
    "end": "1101640"
  },
  {
    "text": "joining it to the name space of one or more name spaces of a targeted process",
    "start": "1101640",
    "end": "1107400"
  },
  {
    "text": "ID so you can attach any name spaces you want when you do that now some name",
    "start": "1107400",
    "end": "1114039"
  },
  {
    "text": "spaces when you try to attach them you may not get a result that's particularly useful but you can do this you can pick",
    "start": "1114039",
    "end": "1119799"
  },
  {
    "text": "and choose your name spaces with NS enter you can run a shell that will be attached to that process name space or",
    "start": "1119799",
    "end": "1126559"
  },
  {
    "text": "you can run any other command any other debug command you need to this is going to be commands on your host shells on",
    "start": "1126559",
    "end": "1132720"
  },
  {
    "text": "your host but they're going to be in that container name space now uh it is a little bit harder than just doing a do",
    "start": "1132720",
    "end": "1138559"
  },
  {
    "text": "run or if you have been working with container D doing a like ctrc",
    "start": "1138559",
    "end": "1146279"
  },
  {
    "text": "run so at this point I will if you'll bear with me for a moment I'm going to",
    "start": "1150799",
    "end": "1157320"
  },
  {
    "text": "try and mirror my screen so I can show",
    "start": "1157320",
    "end": "1162559"
  },
  {
    "text": "you this demo of debugging a faulty Ingress and we're going to do this without touching Cube control",
    "start": "1162559",
    "end": "1171120"
  },
  {
    "text": "once oh it's not letting me do it I don't know why but it's",
    "start": "1171320",
    "end": "1178159"
  },
  {
    "text": "not mirror oh I know why I think",
    "start": "1178799",
    "end": "1185200"
  },
  {
    "text": "mirror okay well you know what I'm GNA",
    "start": "1185200",
    "end": "1189600"
  },
  {
    "text": "do what I'm gonna do is bring this over",
    "start": "1193480",
    "end": "1200240"
  },
  {
    "text": "and just bring this up front I can find my pointer there we go",
    "start": "1202200",
    "end": "1210320"
  },
  {
    "text": "okay so if you'll bear with me for a moment this will be slightly tedious because I'm going to be copying and",
    "start": "1210320",
    "end": "1215799"
  },
  {
    "text": "pasting back and forth but we will get there so I am already in a cluster node",
    "start": "1215799",
    "end": "1221480"
  },
  {
    "text": "so the scenario here is there's an Ingress and it has two routes and one of",
    "start": "1221480",
    "end": "1227679"
  },
  {
    "text": "them is working fine it it Returns what it should return the other one gives me a bad gateway error okay now this is",
    "start": "1227679",
    "end": "1234880"
  },
  {
    "text": "running on an eks cluster in AWS so when you have a connectivity issue with",
    "start": "1234880",
    "end": "1240520"
  },
  {
    "text": "anything to do with AWS I know people in here know the answer I want to hear you all say it in unison the first thing I'm",
    "start": "1240520",
    "end": "1246400"
  },
  {
    "text": "going to count down from three the first thing you check for a connectivity problem in AWS is three two",
    "start": "1246400",
    "end": "1254840"
  },
  {
    "text": "one there you go actually I love Li the first thing you do is say hey anybody",
    "start": "1254840",
    "end": "1261039"
  },
  {
    "text": "want to debug these security groups for me okay so we are on the container",
    "start": "1261039",
    "end": "1271440"
  },
  {
    "text": "node and what we can now do this is running container D so a little bit of",
    "start": "1272080",
    "end": "1277240"
  },
  {
    "text": "background here container D is sort of kind of patterned after Docker because that's what it came out of but it's a",
    "start": "1277240",
    "end": "1283960"
  },
  {
    "text": "little bit less friendly it it actually has its own name space of containers and",
    "start": "1283960",
    "end": "1289640"
  },
  {
    "text": "when you set it up as the kubernetes container runtime it puts all the kubernetes containers in a names space of its own not related to kernal",
    "start": "1289640",
    "end": "1296240"
  },
  {
    "text": "namespaces this is just container D's own namespacing called Kates doio so",
    "start": "1296240",
    "end": "1301640"
  },
  {
    "text": "what I'm doing here is I'm saying list all the containers in the Kates doio container Nam space okay so I've got a",
    "start": "1301640",
    "end": "1307559"
  },
  {
    "text": "bunch of containers here now if I scroll up and down um I think I can see it if I",
    "start": "1307559",
    "end": "1314480"
  },
  {
    "text": "scroll back up here okay so I've got this container here that is running httpd now I know that I'm trying to",
    "start": "1314480",
    "end": "1321440"
  },
  {
    "text": "debug httpd and I know that the problem container is on this host and this is",
    "start": "1321440",
    "end": "1326919"
  },
  {
    "text": "the only container that says it has httpd running so let me come back here",
    "start": "1326919",
    "end": "1332279"
  },
  {
    "text": "and what I'm now going to do is get info on that",
    "start": "1332279",
    "end": "1339200"
  },
  {
    "text": "container now this spits out a whole bunch of Json and I'll save you some time",
    "start": "1341720",
    "end": "1348799"
  },
  {
    "text": "it's not super super helpful in terms of what I'm trying to debug so what I'm",
    "start": "1348799",
    "end": "1356080"
  },
  {
    "text": "going to do is I'm going to run a debug container so that I can attach to it now what I'm going to run here is again",
    "start": "1356080",
    "end": "1363400"
  },
  {
    "text": "slightly less friendly than Docker if you do a Docker run and you don't have the image it just goes and pulls it for you container D doesn't do that you have",
    "start": "1363400",
    "end": "1368960"
  },
  {
    "text": "to pull it manually so I pull this Fedora container",
    "start": "1368960",
    "end": "1374880"
  },
  {
    "text": "image now I can run it",
    "start": "1374880",
    "end": "1379960"
  },
  {
    "text": "by and I want to kind of go over this real quick we are attaching to two name",
    "start": "1381039",
    "end": "1387520"
  },
  {
    "text": "spaces we're attaching to the pit name space of the existing container and the network name space we're also going to",
    "start": "1387520",
    "end": "1394080"
  },
  {
    "text": "bind Mount from the host resolve. comom and the reason we're going to do that is because when we get in I didn't know",
    "start": "1394080",
    "end": "1400880"
  },
  {
    "text": "this going in I had to learn this the hard way when we get into the Container we're going to need to install some tools which means we're going to need to",
    "start": "1400880",
    "end": "1406840"
  },
  {
    "text": "download packages over there Network and without resolve. conf we can't do that so that's what's going on in that",
    "start": "1406840",
    "end": "1412679"
  },
  {
    "text": "command we're just attaching to a couple of Nam spaces we're setting up DNS resolution okay now we're in the",
    "start": "1412679",
    "end": "1421320"
  },
  {
    "text": "container and I will save you the time I learned the hard way again that this container does not have IP route",
    "start": "1421720",
    "end": "1429000"
  },
  {
    "text": "pre-installed so we install IP route IP route by the way is the",
    "start": "1429000",
    "end": "1435679"
  },
  {
    "text": "replacement for a lot of the commands people have been using for long a long time like if config netstat there are",
    "start": "1435679",
    "end": "1441400"
  },
  {
    "text": "successory utilities to those that live in the IP route package that you should get used to using learning new tools is",
    "start": "1441400",
    "end": "1448919"
  },
  {
    "text": "good even if you still continue to use the old tools this does take a slight bit of",
    "start": "1448919",
    "end": "1454400"
  },
  {
    "text": "time here it's usually about okay there we go",
    "start": "1454400",
    "end": "1460480"
  },
  {
    "text": "it's just about done we got plenty of",
    "start": "1460480",
    "end": "1466600"
  },
  {
    "text": "time okay so now we have IP Route 2 we",
    "start": "1466799",
    "end": "1473159"
  },
  {
    "text": "can now run the SS command and see what is going",
    "start": "1473159",
    "end": "1478840"
  },
  {
    "text": "on okay so ss- tells me now my httpd process in the",
    "start": "1478840",
    "end": "1489080"
  },
  {
    "text": "container is listening on Local Host there's the problem okay so we",
    "start": "1489080",
    "end": "1495360"
  },
  {
    "text": "found the problem now we we can go on and we can do some additional debugging where we determine how the",
    "start": "1495360",
    "end": "1502080"
  },
  {
    "text": "problem came to be more or less so if we exit out of this container and we then clean it",
    "start": "1502080",
    "end": "1510559"
  },
  {
    "text": "up by deleting it I hope everybody can see this fine by",
    "start": "1510559",
    "end": "1516240"
  },
  {
    "text": "the way okay so now our container has been",
    "start": "1516240",
    "end": "1521600"
  },
  {
    "text": "deleted now let's kind of go at it with stone tools we're just going to do a a",
    "start": "1521600",
    "end": "1529279"
  },
  {
    "text": "plain old Brute Force GP for httpd okay so we got some processes",
    "start": "1529279",
    "end": "1535039"
  },
  {
    "text": "here I'm going to pick because it's the lowest process number so it probably spawned off the others I'm going to pick",
    "start": "1535039",
    "end": "1540440"
  },
  {
    "text": "that 8487 process at the top of the list there so if I",
    "start": "1540440",
    "end": "1547480"
  },
  {
    "text": "now NS enter and attach to now if I don't give it a command to run it will",
    "start": "1547480",
    "end": "1553480"
  },
  {
    "text": "just by default run a shell so I'm attaching that process I'm attaching cing the mount name space and the",
    "start": "1553480",
    "end": "1560000"
  },
  {
    "text": "network name space okay so now I'm in not a container but a",
    "start": "1560000",
    "end": "1566000"
  },
  {
    "text": "shell and just for grins because I suspect I'm going to need to do it let's",
    "start": "1566760",
    "end": "1573360"
  },
  {
    "text": "check what kind of container this is built on it's a Debian container okay so",
    "start": "1573360",
    "end": "1578440"
  },
  {
    "text": "instead of running dnf we're going to run apt commands on",
    "start": "1578440",
    "end": "1584159"
  },
  {
    "text": "this it's going to be real quick here we are almost done with this demo",
    "start": "1584200",
    "end": "1591039"
  },
  {
    "text": "by the way oops copy all right now we install our",
    "start": "1591039",
    "end": "1598039"
  },
  {
    "text": "IP route now on deban it's called IP Route 2 it is actually still the same",
    "start": "1598039",
    "end": "1603159"
  },
  {
    "text": "package okay now just to prove that we can do this we can repeat our cyat",
    "start": "1603159",
    "end": "1609440"
  },
  {
    "text": "Command we can say ss- and we see the same thing we saw",
    "start": "1609440",
    "end": "1616080"
  },
  {
    "text": "before we're listening on Local Host but now what we're going to do is we're going to go beyond that we know this is an Apache",
    "start": "1616080",
    "end": "1623640"
  },
  {
    "text": "container who knows what the default config file for Apache is",
    "start": "1623640",
    "end": "1629000"
  },
  {
    "text": "called I hear it back there http.com I don't know where it is in this container",
    "start": "1630399",
    "end": "1635440"
  },
  {
    "text": "I'm just going to go looking for it okay it's in user local so now let's take a",
    "start": "1635440",
    "end": "1642559"
  },
  {
    "text": "look at that container actually at that file running in that container and let's",
    "start": "1642559",
    "end": "1647919"
  },
  {
    "text": "see if we can figure out what the problem might be now boiler plate",
    "start": "1647919",
    "end": "1656640"
  },
  {
    "text": "there more or less boilerplate there",
    "start": "1656640",
    "end": "1662799"
  },
  {
    "text": "oh that's the problem somebody misconfigured Apache we kind of suspected that right but now we can",
    "start": "1662799",
    "end": "1668399"
  },
  {
    "text": "actually prove it we can say the reason that your Apache is only listening on Local Host is because it's there",
    "start": "1668399",
    "end": "1673960"
  },
  {
    "text": "explicitly in your http.com file now how did that get there it could have gotten",
    "start": "1673960",
    "end": "1679320"
  },
  {
    "text": "there a number of ways that image could have been built with that file already in the image it could be mounted in from",
    "start": "1679320",
    "end": "1684440"
  },
  {
    "text": "some kind of volume which is in fact the case what I did when I was setting this demo up was I actually pulled the HTTP",
    "start": "1684440",
    "end": "1691880"
  },
  {
    "text": "data. comp out of this container well another clone of this container modified",
    "start": "1691880",
    "end": "1697159"
  },
  {
    "text": "it and then created a config map from it and then started this container up with that config map mounted as the config",
    "start": "1697159",
    "end": "1705200"
  },
  {
    "text": "file now",
    "start": "1705200",
    "end": "1709440"
  },
  {
    "text": "uh let's see if we want to actually I will show you one more thing since I have a little bit of time to burn still",
    "start": "1710279",
    "end": "1717159"
  },
  {
    "text": "if I do DT",
    "start": "1717159",
    "end": "1723200"
  },
  {
    "text": "net DL oh I'm still in the I'm still in the",
    "start": "1723200",
    "end": "1728600"
  },
  {
    "text": "Shell never mind okay now if on this host if I",
    "start": "1728600",
    "end": "1734200"
  },
  {
    "text": "do okay I think I got that right ah see all those Cube service things that's where",
    "start": "1736399",
    "end": "1742360"
  },
  {
    "text": "all your services are happening all of that mess up there good you know if you",
    "start": "1742360",
    "end": "1748039"
  },
  {
    "text": "want to go parse through it go to it uh you may have to do that one day so it's",
    "start": "1748039",
    "end": "1753480"
  },
  {
    "text": "useful to know where you can do that uh that concludes the",
    "start": "1753480",
    "end": "1760480"
  },
  {
    "text": "demo so wrapping up I have about five minutes left I'm going to wrap this up",
    "start": "1760480",
    "end": "1766679"
  },
  {
    "text": "real quick so we have some time for Q&A uh if there's one thing I want you to go away from here with it's the idea that",
    "start": "1766679",
    "end": "1773399"
  },
  {
    "text": "just because you're a beginner with kubernetes doesn't mean that you don't know anything useful everything you knew",
    "start": "1773399",
    "end": "1779000"
  },
  {
    "text": "about post networking and Linux networking before continues to be useful you're going to need to learn new tools",
    "start": "1779000",
    "end": "1785360"
  },
  {
    "text": "I'm going to need to learn new tools you're sometimes still going to want to use the same tools that you got and that's fine because the thing I always",
    "start": "1785360",
    "end": "1792320"
  },
  {
    "text": "tell people they go well I don't really know how to use that new tool use the tool you know how to use if if you know",
    "start": "1792320",
    "end": "1797640"
  },
  {
    "text": "how to use it in the way that you need to use it the right tool is the tool that gets the job done most",
    "start": "1797640",
    "end": "1803360"
  },
  {
    "text": "efficiently I'm not going to go through all this I did want to mention specifically there's a link to Tim Hawkins lightning talk right up there on",
    "start": "1803360",
    "end": "1809880"
  },
  {
    "text": "the top right there's a link to kubernetes the Hardway on the top left for the many of you who have never done it I highly recommend it uh there's",
    "start": "1809880",
    "end": "1817240"
  },
  {
    "text": "links to some other videos and this is a list of sessions that are available for the",
    "start": "1817240",
    "end": "1824399"
  },
  {
    "text": "Tuesday sessions of course have already gone by but the Wednesday sessions there's one uh right after the break",
    "start": "1824399",
    "end": "1830240"
  },
  {
    "text": "from this so if you uh head on over to w178 you can kind of start rolling",
    "start": "1830240",
    "end": "1835559"
  },
  {
    "text": "through those that's all I got um the the QR",
    "start": "1835559",
    "end": "1841080"
  },
  {
    "text": "code there goes to the same URL that the tiny URL points too the QR code on the right is for feedback and uh I am open",
    "start": "1841080",
    "end": "1849039"
  },
  {
    "text": "to any questions that you have at this",
    "start": "1849039",
    "end": "1852480"
  },
  {
    "text": "point [Music] [Applause]",
    "start": "1856240",
    "end": "1862980"
  },
  {
    "text": "yeah go ahead do what",
    "start": "1866039",
    "end": "1873840"
  },
  {
    "text": "now oh oh yes oh I have done that yes um many times um and actually that is one",
    "start": "1877880",
    "end": "1883120"
  },
  {
    "text": "of the ways that I verify that hey uh is there anything actually listening in that container because sometimes it's a",
    "start": "1883120",
    "end": "1889480"
  },
  {
    "text": "little hard to navigate the process space in a busy container so it it sometimes is easier just to do a TCP",
    "start": "1889480",
    "end": "1894639"
  },
  {
    "text": "dump the question was have I ever done a TCP dump packet capture or is that useful to do yes it's entirely useful to",
    "start": "1894639",
    "end": "1902559"
  },
  {
    "text": "do anybody else we got a microphone over there um I",
    "start": "1904639",
    "end": "1911240"
  },
  {
    "text": "think that's it I think it's just the one right there yeah so you spoke to a OSI bottle",
    "start": "1911240",
    "end": "1918320"
  },
  {
    "text": "not really being rigidly implemented um has there been any effort in the space",
    "start": "1918320",
    "end": "1924279"
  },
  {
    "text": "of the kubernetes network stack to standardized to ensure long-term",
    "start": "1924279",
    "end": "1930080"
  },
  {
    "text": "interoperability can you say that again I couldn't quite make that out yeah uh has there been any effort to solidify",
    "start": "1930080",
    "end": "1935559"
  },
  {
    "text": "some sort of model in the kubernetes networking stack to ensure there's long-term interoperability instead of uh",
    "start": "1935559",
    "end": "1941679"
  },
  {
    "text": "some of the chaos that happened with OSI where vendors didn't Implement things oh yeah oh there's a lot of stuff going on with interop ability and multicluster",
    "start": "1941679",
    "end": "1948720"
  },
  {
    "text": "Federation and multicluster networking um uh one of the talks that I went to yesterday was about multi",
    "start": "1948720",
    "end": "1955320"
  },
  {
    "text": "networking in kubernetes I think I have it linked from the previous slide there um there are lots of plans to enable",
    "start": "1955320",
    "end": "1961120"
  },
  {
    "text": "multi- networking for containers which is going to be useful",
    "start": "1961120",
    "end": "1966240"
  },
  {
    "text": "for people who are like running Cube",
    "start": "1966240",
    "end": "1969760"
  },
  {
    "text": "vert so that last demo you were on the ec2 instance and then you used NS enter",
    "start": "1976039",
    "end": "1982039"
  },
  {
    "text": "to get into the Container yeah so the second half of",
    "start": "1982039",
    "end": "1988120"
  },
  {
    "text": "that was we started off we exited out of the container that we had spawned then",
    "start": "1988120",
    "end": "1993320"
  },
  {
    "text": "we from the host without spawning a new container we just attached a process to",
    "start": "1993320",
    "end": "1998600"
  },
  {
    "text": "the name space that the container was using so that we could actually observe what was going on in the container",
    "start": "1998600",
    "end": "2004080"
  },
  {
    "text": "without needing to run another container ourselves",
    "start": "2004080",
    "end": "2008960"
  },
  {
    "text": "um first of all great demo thank you very much um last time I had to troubleshoot some network connectivity",
    "start": "2014080",
    "end": "2019600"
  },
  {
    "text": "issues um it actually ended up being ebpf related with some aqua SEC package",
    "start": "2019600",
    "end": "2025440"
  },
  {
    "text": "is there a strategy you could suggest if you had a issue like that and the second",
    "start": "2025440",
    "end": "2031720"
  },
  {
    "text": "part is um those commands that you showed for container D like how does one actually like look them up and learn",
    "start": "2031720",
    "end": "2037600"
  },
  {
    "text": "I had to look all those container D commands up in the container D documentation and or I did a lot of CTR",
    "start": "2037600",
    "end": "2043840"
  },
  {
    "text": "d-el at the command line now as far as the other one um talking about like",
    "start": "2043840",
    "end": "2049599"
  },
  {
    "text": "strategies for dealing with ebpf type of stuff I to be quite Frank don't know a whole lot about that it is still an",
    "start": "2049599",
    "end": "2055560"
  },
  {
    "text": "emerging area um I think at this point your best bet is to do more observational type of things like I can",
    "start": "2055560",
    "end": "2061679"
  },
  {
    "text": "see traffic is or is not flowing and then maybe narrow that down and if you",
    "start": "2061679",
    "end": "2067480"
  },
  {
    "text": "can determine that it is something related to an ebpf module then I guess",
    "start": "2067480",
    "end": "2072599"
  },
  {
    "text": "at that point you have to go back to whoever wrote it and say this is not working why is it not working thank",
    "start": "2072599",
    "end": "2079960"
  },
  {
    "text": "you all right first uh I'm a real newbie to this but when it I can see that in",
    "start": "2079960",
    "end": "2086118"
  },
  {
    "text": "the containers ipv4 is you know entirely sufficient but when it comes to IPv6 on",
    "start": "2086119",
    "end": "2091599"
  },
  {
    "text": "the host uh is there what kind of issues can there be in in publishing you know",
    "start": "2091599",
    "end": "2097880"
  },
  {
    "text": "the kubernetes ib6 it's kind of interesting because until fairly recently kubernetes",
    "start": "2097880",
    "end": "2104440"
  },
  {
    "text": "did not support IPv6 and uh we just ran out of time so I'm going to wrap this up real quick it",
    "start": "2104440",
    "end": "2110040"
  },
  {
    "text": "did not support IPv6 um it does now and as far as any",
    "start": "2110040",
    "end": "2115480"
  },
  {
    "text": "kind of issues you would run into I don't know of anything specific to kubernetes I think it would just be the regular sort of IPv6 issues you would",
    "start": "2115480",
    "end": "2121960"
  },
  {
    "text": "see anywhere like you know when you don't have IPv6 connectivity but something is trying to prefer it and so",
    "start": "2121960",
    "end": "2128359"
  },
  {
    "text": "your your networking suddenly dies and you don't know",
    "start": "2128359",
    "end": "2132800"
  },
  {
    "text": "why I'm going to wrap up here but like I said I'll be hanging out in the hall for a little bit if anybody has any more",
    "start": "2135400",
    "end": "2140480"
  },
  {
    "text": "questions for [Applause]",
    "start": "2140480",
    "end": "2146000"
  },
  {
    "text": "me",
    "start": "2146000",
    "end": "2149000"
  }
]