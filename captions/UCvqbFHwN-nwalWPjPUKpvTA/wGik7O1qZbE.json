[
  {
    "text": "so um we're going to talk to you today about how we scale up um using V cluster",
    "start": "40",
    "end": "5879"
  },
  {
    "text": "and Argo um our use case is pretty Niche um to be honest so what I've tried to do",
    "start": "5879",
    "end": "12120"
  },
  {
    "text": "is give you a few Argo hints and tips which just help you with your general scaling um and you can obviously follow",
    "start": "12120",
    "end": "18119"
  },
  {
    "text": "our journey as well um as we talk through it uh by way of introduction uh my name is Tim I'm the infrastructure",
    "start": "18119",
    "end": "23800"
  },
  {
    "text": "guy at pip kit um I basically live in the cncf slack channel so if you've ever asked a Argo workflows question in the",
    "start": "23800",
    "end": "30519"
  },
  {
    "text": "last 3 years or so I've probably spoken to you um and I do the same as part of",
    "start": "30519",
    "end": "35640"
  },
  {
    "text": "the PIP kit Services team helping our customers just do better stuff uh with",
    "start": "35640",
    "end": "41719"
  },
  {
    "text": "workflows yeah hi everyone uh I'm the co-speaker my name is Lucas I'm the CEO",
    "start": "42120",
    "end": "47360"
  },
  {
    "text": "at Loft Labs um I'm involved with a couple of Open Source projects that my team and I got started um V cluster is",
    "start": "47360",
    "end": "54280"
  },
  {
    "text": "one of them that's the the main piece of this talk uh but there's also two exciting other uh projects uh you may",
    "start": "54280",
    "end": "59960"
  },
  {
    "text": "want to check out one of them is called def pod uh it's for essentially spitting up de environments kind of like",
    "start": "59960",
    "end": "65400"
  },
  {
    "text": "terraform style client only um but deploying pretty much any infra uh it's a really exciting project we launched",
    "start": "65400",
    "end": "71400"
  },
  {
    "text": "about 6 months ago and then def space a developer tool for kubernetes uh we handed it over to the cncf um end of",
    "start": "71400",
    "end": "78920"
  },
  {
    "text": "last year I think uh and that one's a Sandbox project now I'm originally from Germany you can probably spot the funny",
    "start": "78920",
    "end": "85159"
  },
  {
    "text": "accent I do live in San Francisco though uh since about 5 years ago and uh yeah",
    "start": "85159",
    "end": "90680"
  },
  {
    "text": "come to our booth at C15 if you want to chat about anything in detail that we're going to talk about",
    "start": "90680",
    "end": "97079"
  },
  {
    "text": "today s right we've both got funny accents um I guess before I explain the problem",
    "start": "97079",
    "end": "104040"
  },
  {
    "text": "uh it's probably worth explaining just what pip kit is and what we offer um so pikit is a SAS solution um we offer a control plane for Argo workflows um",
    "start": "104040",
    "end": "111280"
  },
  {
    "text": "specializing in things like multicluster fun um easier ARB back that sort of stuff um and quite early on when we were",
    "start": "111280",
    "end": "117840"
  },
  {
    "text": "developing pip kit we realized that our customers don't want us to manage everything they don't want us to host",
    "start": "117840",
    "end": "123039"
  },
  {
    "text": "their workflows and pass on the charges and that sort of stuff our customers in general want to still host the stuff",
    "start": "123039",
    "end": "128520"
  },
  {
    "text": "themselves want to manage that want to keep it all nice and secure um and so the way that we operate is we give you a",
    "start": "128520",
    "end": "134519"
  },
  {
    "text": "small pod to install in your cluster or clusters and that pod is the conduit between our solution and your workflows",
    "start": "134519",
    "end": "140680"
  },
  {
    "text": "so you get full control over your stuff but you still get the nice control plane um to manage everything at a much bigger",
    "start": "140680",
    "end": "146720"
  },
  {
    "text": "scale than kind of Open Source workflows offers the challenge we find is that those those same customers who want that",
    "start": "146720",
    "end": "154040"
  },
  {
    "text": "security also don't happen to have um kubernetes clusters just lying around to try new software",
    "start": "154040",
    "end": "161239"
  },
  {
    "text": "um and they also usually have some form of red tape that prevents people from",
    "start": "161239",
    "end": "166360"
  },
  {
    "text": "you know running up mini Cube or something like that for the same reason so we we struggle to get people to try our software to see if it's suitable for",
    "start": "166360",
    "end": "173200"
  },
  {
    "text": "them um and then obviously go on to hopefully buy our software um so that's",
    "start": "173200",
    "end": "179400"
  },
  {
    "text": "our main problem and our goal is obviously to try and get people using pip kit so we came up some really high",
    "start": "179400",
    "end": "185000"
  },
  {
    "text": "level goals um we would like new trialist of pip kit to be up and running",
    "start": "185000",
    "end": "190440"
  },
  {
    "text": "um with their first workflow within 5 minutes of signing up sounds fair um and we want to reduce the friction um of",
    "start": "190440",
    "end": "197680"
  },
  {
    "text": "getting started with Pip kit by we want to offer them a hosted uh cluster so they can just play around go nuts and",
    "start": "197680",
    "end": "203920"
  },
  {
    "text": "then if they're happy with Pip kit then they can take it away and and set up their own infrastructure with with their",
    "start": "203920",
    "end": "209319"
  },
  {
    "text": "actual you know real workloads so we came up with some solutions um as a AWS shop we offered",
    "start": "209319",
    "end": "217840"
  },
  {
    "text": "eks uh and we decided Well we could just give every potential customer their own eks cluster um that would definitely be",
    "start": "217840",
    "end": "225159"
  },
  {
    "text": "nice and secure um and isolated between uh different trialists um but obviously",
    "start": "225159",
    "end": "231760"
  },
  {
    "text": "that's reasonably expensive and um spinning up an e eks cluster is not",
    "start": "231760",
    "end": "237360"
  },
  {
    "text": "quick it certainly wouldn't take um under 5 minutes we're realistically looking at 20 30 40 minutes maybe um",
    "start": "237360",
    "end": "244959"
  },
  {
    "text": "which is a long time to wait if you're trying a product you don't want to sit there just watching that happen so I",
    "start": "244959",
    "end": "250680"
  },
  {
    "text": "guess another solution is we could offer one eks cluster and just put all of our try lists in there um that's definitely",
    "start": "250680",
    "end": "256880"
  },
  {
    "text": "cheaper um and it would be quicker because the cluster already exists um but then we have this problem of well",
    "start": "256880",
    "end": "262000"
  },
  {
    "text": "what if one trialist you know goes nuts and uses all the CPU um and then all the other trialists are kind of stuck in the",
    "start": "262000",
    "end": "268440"
  },
  {
    "text": "corner with the CPU just been eaten up and they're not getting a great experience of pip kit so hopefully",
    "start": "268440",
    "end": "274240"
  },
  {
    "text": "there's another way and luckily it was in the title and luckily the Loft Labs guy is here so um he's going to explain",
    "start": "274240",
    "end": "281320"
  },
  {
    "text": "it yeah so one alternative to having single tenant clusters and namespace",
    "start": "281960",
    "end": "288039"
  },
  {
    "text": "based multitenancy is having kubernetes virtualization um you know if you're in a company today and you asking for a",
    "start": "288039",
    "end": "294520"
  },
  {
    "text": "server chances are pretty low that someone's going to go into a data Cent and plug in a a server for you they're",
    "start": "294520",
    "end": "301160"
  },
  {
    "text": "going to run a terraform script or something like that to spin up a VM right um they're going to hand you out a",
    "start": "301160",
    "end": "307080"
  },
  {
    "text": "E2 instance or something like that um so why are we doing something super",
    "start": "307080",
    "end": "312240"
  },
  {
    "text": "heavyweight and Legacy sounding for um servers and kind of abandon that towards",
    "start": "312240",
    "end": "318280"
  },
  {
    "text": "virtualization but with kubernetes we're essentially making that same mistake right we're spinning up these",
    "start": "318280",
    "end": "323520"
  },
  {
    "text": "heavyweight clusters um and hand them out to folks um whether for trial or whether for death environment right um",
    "start": "323520",
    "end": "330680"
  },
  {
    "text": "there's a lot of replication here uh so 2 and a half years ago my team and I uh",
    "start": "330680",
    "end": "336360"
  },
  {
    "text": "looked at this problem and thought that's kind of crazy multi- tendency is not really softed in kubernetes these days um Nam spaces are not an isolation",
    "start": "336360",
    "end": "344400"
  },
  {
    "text": "boundary they're merely just like a you know space for names right literally just like prefixing things so now two",
    "start": "344400",
    "end": "351000"
  },
  {
    "text": "objects can be called database but that's about as much isolation as you get from a namespace right um virtual",
    "start": "351000",
    "end": "357680"
  },
  {
    "text": "cluster is a virtualization Tech technology uh for kubernetes that essentially creates um virtual clusters",
    "start": "357680",
    "end": "364680"
  },
  {
    "text": "on top of an existing kubernetes cluster we got this started about 2 and a half years ago there's about two 3,500 people",
    "start": "364680",
    "end": "372400"
  },
  {
    "text": "uh that start the GitHub repository you can check it out here uh vc.com is the kind of you know landing page to get",
    "start": "372400",
    "end": "378840"
  },
  {
    "text": "some uh more details on on this project in the first 12 months after launching this project we had about a million you",
    "start": "378840",
    "end": "385560"
  },
  {
    "text": "know virtual clusters created uh now 2 and 1 half years in we just celebr 40 million virtual clusters created so",
    "start": "385560",
    "end": "392080"
  },
  {
    "text": "there's a huge uptick in usage um regarding number of virtual clusters spun up and that's not even including",
    "start": "392080",
    "end": "399000"
  },
  {
    "text": "you know like we're essentially counting image PS here right so if you pull that image once and then you instantiate it",
    "start": "399000",
    "end": "405720"
  },
  {
    "text": "100 times that's we just count it once right so uh that number is likely underestimated as well I I think you do",
    "start": "405720",
    "end": "412120"
  },
  {
    "text": "very extensive image caching so probably in your case we count one",
    "start": "412120",
    "end": "417240"
  },
  {
    "text": "but but yeah they spin up like hundreds hopefully thousands in the future virtual clusters um so yeah if you're",
    "start": "417240",
    "end": "424400"
  },
  {
    "text": "interested in in Virtual clusters uh here's the uh the GitHub link as well to check it out um the cluster what does it",
    "start": "424400",
    "end": "430879"
  },
  {
    "text": "essentially do it establishes secure multi tendency in kubernetes you know if you're looking at single tenant clusters",
    "start": "430879",
    "end": "437039"
  },
  {
    "text": "today they kind of look like this right we have like three clusters and then we have three times SE manager open policy",
    "start": "437039",
    "end": "442479"
  },
  {
    "text": "agent ISO Vault everything is replicated everything runs idle most of the time right um very lowly utilization a lot of",
    "start": "442479",
    "end": "450520"
  },
  {
    "text": "Fleet Management a lot of things that you have to uh maintain and upgrade individually initially these clusters",
    "start": "450520",
    "end": "455960"
  },
  {
    "text": "look kind of uniform and the same it looks actually way bigger way better in this picture than it looks in reality",
    "start": "455960",
    "end": "461319"
  },
  {
    "text": "cuz if you're like you know 12 months in these clusters look really widely different usually um and one solution is",
    "start": "461319",
    "end": "468080"
  },
  {
    "text": "multi-tenancy uh but namespace based multi tendency as we said earlier is really not secure enough not isolated",
    "start": "468080",
    "end": "474240"
  },
  {
    "text": "enough so instead of um you know hosting your application St down there and then running Nam spaces on top of it you're",
    "start": "474240",
    "end": "481039"
  },
  {
    "text": "essentially putting virtual clusters inside these name spaces they just run as containers it's literally just",
    "start": "481039",
    "end": "486639"
  },
  {
    "text": "starting a pod and then instead of giving tenant access to the namespace you give them access to the virtual",
    "start": "486639",
    "end": "492360"
  },
  {
    "text": "cluster instead that's at its core what V cluster as an open source project does and it has a lot of huge advantages the",
    "start": "492360",
    "end": "498919"
  },
  {
    "text": "first one it's it's a hell a lot faster than spinning up separate clusters um they typically these virtual clusters",
    "start": "498919",
    "end": "505080"
  },
  {
    "text": "unlike you know eks or so that takes like 30 40 minutes to start a v cluster it's just a part it starts in less than",
    "start": "505080",
    "end": "511319"
  },
  {
    "text": "30 seconds if you cat the images really well it's going to go a lot quicker as well he's going to talk about that in a second um it's a lot cheaper typically",
    "start": "511319",
    "end": "518760"
  },
  {
    "text": "we see cost savings coming from single tency um of 40 to 70% sometimes even",
    "start": "518760",
    "end": "525080"
  },
  {
    "text": "even more um but although we run multitenant clusters a fee cluster it's",
    "start": "525080",
    "end": "530600"
  },
  {
    "text": "still very very secure because everybody has their own isolated control plane right um so we're not running with the",
    "start": "530600",
    "end": "537760"
  },
  {
    "text": "same API server here the same controller manager the same data store everything is separate essentially and uh that",
    "start": "537760",
    "end": "543920"
  },
  {
    "text": "makes V cluster a lot more robust for production and they have been a lot of people proving this uh resiliency and",
    "start": "543920",
    "end": "550440"
  },
  {
    "text": "production greatness uh and really battle test of the solution um here are a couple of logos of um you know our",
    "start": "550440",
    "end": "557000"
  },
  {
    "text": "customers and users uh cor weef I actually gave a talk with them uh this morning at the AI and high performance",
    "start": "557000",
    "end": "562360"
  },
  {
    "text": "Computing day they're actually a cloud provider and they hand out you know they're building something like a eks",
    "start": "562360",
    "end": "567680"
  },
  {
    "text": "but for gpus specific specifically and they hand out kubernetes to their customers so if that's safe enough for",
    "start": "567680",
    "end": "574360"
  },
  {
    "text": "them as a cloud provider it's probably safe enough for everybody else to run uh in their internal um use cases there's",
    "start": "574360",
    "end": "581680"
  },
  {
    "text": "also a couple of other really great folks on here like GoFundMe for example uh code fresh last year gave a really",
    "start": "581680",
    "end": "586720"
  },
  {
    "text": "amazing coupon talk about how they're using us and uh you know now pip kid has a really great solution uh out there as",
    "start": "586720",
    "end": "593000"
  },
  {
    "text": "well which has a really impressive startup time which we're going to see in just a couple of minutes um just briefly",
    "start": "593000",
    "end": "599279"
  },
  {
    "text": "touching on the cost savings here and again this is all open source V cluster so there's there's no license fee or",
    "start": "599279",
    "end": "605000"
  },
  {
    "text": "anything attached to this is just a pachy to uh licensed product um if you",
    "start": "605000",
    "end": "610200"
  },
  {
    "text": "have single tenant clusters today and you have 100 of them what you're paying is 100 times the eks GK AKs fee and",
    "start": "610200",
    "end": "618000"
  },
  {
    "text": "that's typically about $900 per year um and then you don't have any notes right",
    "start": "618000",
    "end": "623240"
  },
  {
    "text": "it's just the API server it's just to fire up that eks cluster you pay 900 bucks so if you run a 100 of them that's",
    "start": "623240",
    "end": "629480"
  },
  {
    "text": "going to add up to about $90,000 that's quite some money just to turn it on right nothing's running in there yet um",
    "start": "629480",
    "end": "636079"
  },
  {
    "text": "now we got to deploy our platform St open policy agent ISO all of these components that you deploy to typically every kubernetes cluster um what we",
    "start": "636079",
    "end": "643320"
  },
  {
    "text": "found with in our customer base the cost is actually way higher than $1,600 per",
    "start": "643320",
    "end": "648440"
  },
  {
    "text": "year um but we're going with a very minimal kind of startup example in this case um and that cost really really adds",
    "start": "648440",
    "end": "654880"
  },
  {
    "text": "up quickly if you're switching to multitenancy and using virtual clusters that's the graphic on the right hand",
    "start": "654880",
    "end": "660160"
  },
  {
    "text": "side you essentially just have one kubernetes cluster if you're a really really big organization you may have",
    "start": "660160",
    "end": "665440"
  },
  {
    "text": "like 10 but not a thousand right um and then you run that platform STI on top",
    "start": "665440",
    "end": "670560"
  },
  {
    "text": "instead of 100 platform sticks in 100 clusters you just need one that one is highly utilized which is actually great",
    "start": "670560",
    "end": "677440"
  },
  {
    "text": "right cuz that isio is not running idle all the time it's actually you know busy all the time and that's a good thing um",
    "start": "677440",
    "end": "684680"
  },
  {
    "text": "that means a platform St may be a little bit more resource hungry than each one of these individual idle running ones",
    "start": "684680",
    "end": "690920"
  },
  {
    "text": "but it runs at a much much greater efficiency um and then you got to run the 100 virtual clusters we did our",
    "start": "690920",
    "end": "696560"
  },
  {
    "text": "tests inter internally so virtual clusters uh cost about $90 to run per year each right which is about a tenth",
    "start": "696560",
    "end": "703120"
  },
  {
    "text": "of the cost of a regular e or gke control plane and if you add all of that cost up that's just you know like you",
    "start": "703120",
    "end": "710560"
  },
  {
    "text": "essentially saving 85% of the the cost that you had with a single tency scenario and then obviously you got to",
    "start": "710560",
    "end": "716720"
  },
  {
    "text": "pay for your workloads on top we don't make your application any faster sorry Tim I wish we could but uh you know",
    "start": "716720",
    "end": "722800"
  },
  {
    "text": "hopefully they built their application in a way that actually runs really really smoothly on kubernetes and takes the the benefits of of running it as a",
    "start": "722800",
    "end": "729440"
  },
  {
    "text": "container race application on kubernetes and that runs effectively uh pretty smoothly as",
    "start": "729440",
    "end": "736120"
  },
  {
    "text": "well so let's tempt fate and try a live demo shall",
    "start": "736320",
    "end": "741680"
  },
  {
    "text": "we um so this is PIP kit um I've signed up and it's basically offering me the",
    "start": "741680",
    "end": "746720"
  },
  {
    "text": "the cluster that we're just talking about so I'm going to click the yes Buton but and cross my",
    "start": "746720",
    "end": "751920"
  },
  {
    "text": "fingers so if we look behind the scenes hopefully we can see that a workflow has",
    "start": "752680",
    "end": "758680"
  },
  {
    "text": "started and that workflow has two nodes in it really simple a create node that creates the V cluster and then a",
    "start": "758680",
    "end": "764560"
  },
  {
    "text": "configure node that starts configuring the V cluster installing a software on top of it and I have to talk really fast",
    "start": "764560",
    "end": "770480"
  },
  {
    "text": "because this happens really quick um so V cluster is here it's it's pending and",
    "start": "770480",
    "end": "777000"
  },
  {
    "text": "if I refresh the page quick enough it it will be in here somewhere which I now can't see you can have to believe me",
    "start": "777000",
    "end": "784079"
  },
  {
    "text": "because it's probably ready by now there you go oh no not quite I've got",
    "start": "784079",
    "end": "790560"
  },
  {
    "text": "time yeah it is that's deploying the software into the cluster",
    "start": "790720",
    "end": "796839"
  },
  {
    "text": "there so we look back the workflow is done and hopefully it's ready um now of course I could have",
    "start": "796839",
    "end": "803880"
  },
  {
    "text": "faked all that so let's run something in it um so I've got a a simple flow",
    "start": "803880",
    "end": "809120"
  },
  {
    "text": "written in her just to be a little bit different so um for those who don't know here is a a python SDK for workflows um",
    "start": "809120",
    "end": "816240"
  },
  {
    "text": "and we're going to run this directly against pip kit um so this hero workflow really simple um it's designed to show",
    "start": "816240",
    "end": "821839"
  },
  {
    "text": "you the versions of the software installed inside the cluster so uh the workflow controller pip kit agent uh we",
    "start": "821839",
    "end": "827839"
  },
  {
    "text": "also install Min IO um and it also uh just outputs the c um CTL version just",
    "start": "827839",
    "end": "833440"
  },
  {
    "text": "to prove the version of the cluster that we're running um so I'm just going to run that here this this gives me a nice URL to go",
    "start": "833440",
    "end": "841920"
  },
  {
    "text": "to if I skip all that so we can see that the workflow has started and it's got a",
    "start": "842800",
    "end": "848800"
  },
  {
    "text": "few nodes all to Output that stuff it's finished and if we quickly look at the logs um for example there's the pet",
    "start": "848800",
    "end": "854320"
  },
  {
    "text": "agent version uh there's some CTL versions minio and Argo workflows and that's all come from within that virtual",
    "start": "854320",
    "end": "861000"
  },
  {
    "text": "cluster um that we were just spinning up a second ago our average startup time is 39",
    "start": "861000",
    "end": "868399"
  },
  {
    "text": "seconds so that includes the starting the V cluster installing Argo workflows installing our um pip agent and",
    "start": "868399",
    "end": "875720"
  },
  {
    "text": "installing minio and all of them being ready for use um so as I say 39 seconds",
    "start": "875720",
    "end": "880959"
  },
  {
    "text": "sometimes faster sometimes a little bit slower but um we haven't seen it any slower than a",
    "start": "880959",
    "end": "886360"
  },
  {
    "text": "minute so here's where I try and sort of help you out a little bit um as I say our use case was quite Niche you'll",
    "start": "886360",
    "end": "892560"
  },
  {
    "text": "probably not trying to create V clusters for the purposes of um offering free trials to customers um but I obviously",
    "start": "892560",
    "end": "898160"
  },
  {
    "text": "as you saw I used Argo to do all of that um so I'll try and guide you through some of the steps that were used and hopefully you can gain some nuggets of",
    "start": "898160",
    "end": "904560"
  },
  {
    "text": "information out of that so uh first of all all of O all of those virtual clusters are in their own um eks cluster",
    "start": "904560",
    "end": "912199"
  },
  {
    "text": "they're completely separate from the rest of our infrastructure so if somehow",
    "start": "912199",
    "end": "917279"
  },
  {
    "text": "someone managed to escape from a v cluster into our cluster they couldn't get into the rest of our Network um and we did all that with terraform which",
    "start": "917279",
    "end": "923959"
  },
  {
    "text": "isn't exactly surprising um and we use argocd to manage the cluster and importantly AR CD manages itself um now",
    "start": "923959",
    "end": "931839"
  },
  {
    "text": "most of you are probably going yeah that's pretty standard AR CD manages itself everyone does that um but",
    "start": "931839",
    "end": "936880"
  },
  {
    "text": "actually uh in the slack Channel people ask quite often questions like how do I",
    "start": "936880",
    "end": "942360"
  },
  {
    "text": "back up Argo CD um and the answer is if well basically if you're asking that",
    "start": "942360",
    "end": "947440"
  },
  {
    "text": "question you're doing it wrong um Argo CD is a gitops tool Aro CD should be in git um and everything associated with",
    "start": "947440",
    "end": "954680"
  },
  {
    "text": "should be in git and secret management is the slightly confusing element of that um and there are lots of solutions",
    "start": "954680",
    "end": "960440"
  },
  {
    "text": "for that and unfortunately I don't have time to go through it today but there's a link up there to guide you through sequence management The Last Link at the",
    "start": "960440",
    "end": "966399"
  },
  {
    "text": "top there um is actually an example um designed to show how you could use Argo workflows for CD which is irrelevant",
    "start": "966399",
    "end": "973639"
  },
  {
    "text": "here um but the whole example is Argo CD managed including the Argo CD that comes with it so you can you can take that and",
    "start": "973639",
    "end": "979880"
  },
  {
    "text": "you can play with it and you can hopefully see what I'm trying to go on about basically um and then in terms of",
    "start": "979880",
    "end": "986720"
  },
  {
    "text": "triggering the workflow uh we use the workflow event binding to do that um very simply a workflow event binding is",
    "start": "986720",
    "end": "993639"
  },
  {
    "text": "uh a webbook endpoint on the Argo um server essentially you fire it a curl",
    "start": "993639",
    "end": "999800"
  },
  {
    "text": "message or similar um and it will start up a workflow template and that's exactly what we did here so we we have two we've got one to create the V",
    "start": "999800",
    "end": "1006120"
  },
  {
    "text": "cluster which is what you just saw and we got one to delete the V cluster at the end of a users trial and that's it that's that's the only thing we have",
    "start": "1006120",
    "end": "1012519"
  },
  {
    "text": "they're great for relatively small um workloads I guess um event loads",
    "start": "1012519",
    "end": "1019279"
  },
  {
    "text": "um if you want something big with more scale then you probably need to start looking at Argo events um probably queue",
    "start": "1019279",
    "end": "1025160"
  },
  {
    "text": "management and things like that but the sort of scale that we're running at um this sort of thing is fine and it just",
    "start": "1025160",
    "end": "1030520"
  },
  {
    "text": "means we don't have to add the extra complexity of Arco events then as you saw we had two steps",
    "start": "1030520",
    "end": "1037038"
  },
  {
    "text": "in our workflow the first step created the V cluster and the Second Step um sort of set up everything with inside",
    "start": "1037039",
    "end": "1043600"
  },
  {
    "text": "the V cluster so in terms of creation the way I did it is used the kubernetes resource um element of Argo workflows",
    "start": "1043600",
    "end": "1050600"
  },
  {
    "text": "that allows you to create any kubernetes resource in our case that was an Argo CD application that then creates the V",
    "start": "1050600",
    "end": "1056160"
  },
  {
    "text": "cluster and deploys it into the cluster you shouldn't do the thing I've just said to do because that's not giops what",
    "start": "1056160",
    "end": "1062960"
  },
  {
    "text": "you should be doing is putting something in git and getting git to do that and sorry getting Aro CD to pull it from git",
    "start": "1062960",
    "end": "1068400"
  },
  {
    "text": "to do that because then everything's backed up um you can still use the kubernetes resource though to monitor",
    "start": "1068400",
    "end": "1074360"
  },
  {
    "text": "the deployed Argo CD application even though workflows didn't deploy that application if that makes",
    "start": "1074360",
    "end": "1079600"
  },
  {
    "text": "sense and then finally we used our CD application sets to actually install stuff into the V cluster so what happens",
    "start": "1079600",
    "end": "1086120"
  },
  {
    "text": "is when the V cluster is installed into your cluster uh the the cube CTL secret",
    "start": "1086120",
    "end": "1091360"
  },
  {
    "text": "is installed into your cluster as well and you can take that and you can give that to Aro CD and Argo CD thinks it's a normal cluster like an eks cluster or",
    "start": "1091360",
    "end": "1098200"
  },
  {
    "text": "anything else you can do loads of stuff with application sets but all we did was add a little V cluster label Argo CD",
    "start": "1098200",
    "end": "1105080"
  },
  {
    "text": "knows everything with a V cluster label I should install pip kit agent Argo workflows minio and off it goes and it",
    "start": "1105080",
    "end": "1111000"
  },
  {
    "text": "also means that we can upgrade those things across the board with a click of a button you know a g push",
    "start": "1111000",
    "end": "1117600"
  },
  {
    "text": "basically so does it scale um I'll be honest I wrote the slide before I found",
    "start": "1117600",
    "end": "1123080"
  },
  {
    "text": "this out but yes yes it does um we I essentially wrote a really nauy",
    "start": "1123080",
    "end": "1129480"
  },
  {
    "text": "um test to try and prove this um so what I did was I wrote a workflow that uses",
    "start": "1129480",
    "end": "1135120"
  },
  {
    "text": "the kubernetes resource that I've just mentioned before uses it many many times and uses the kubernetes resource to",
    "start": "1135120",
    "end": "1140720"
  },
  {
    "text": "deploy another workflow saying hello world hence the hence the slide um if",
    "start": "1140720",
    "end": "1146280"
  },
  {
    "text": "you do that on a normal eks cluster I was managing to run hello world about",
    "start": "1146280",
    "end": "1151720"
  },
  {
    "text": "2,000 times in 2 minutes um I then did exactly the same thing in the eks",
    "start": "1151720",
    "end": "1157280"
  },
  {
    "text": "cluster I added 30 eks CL sorry 30 V clusters to the eks cluster ran the same",
    "start": "1157280",
    "end": "1163000"
  },
  {
    "text": "thing again I managed over 5,000 hello worlds in the same time so the test is stupid if you're",
    "start": "1163000",
    "end": "1169360"
  },
  {
    "text": "running hello world this much then you're you're doing something wrong but the point is you can expect something",
    "start": "1169360",
    "end": "1174640"
  },
  {
    "text": "like a 2X Improvement just by putting V cluster in place um and that's because",
    "start": "1174640",
    "end": "1179720"
  },
  {
    "text": "the the the workflow controller is talking to the V cluster API and not the kubernetes API of the host so the cetes",
    "start": "1179720",
    "end": "1186559"
  },
  {
    "text": "API of the host is a lot more relaxed can handle the the request coming from V cluster and you get that extra",
    "start": "1186559",
    "end": "1194120"
  },
  {
    "text": "scale really quickly here's some other tools that we used um just to help things",
    "start": "1194120",
    "end": "1199840"
  },
  {
    "text": "along um the image caching as Lucas mentioned um an open source image cache",
    "start": "1199840",
    "end": "1205520"
  },
  {
    "text": "um if your image has been pulled once in your cluster this image cache will allow you to use it on another node somewhere",
    "start": "1205520",
    "end": "1210919"
  },
  {
    "text": "else without having to go back to the original source and pull the image again it makes stuff a lot",
    "start": "1210919",
    "end": "1216240"
  },
  {
    "text": "quicker um the AR CD lovely plugin is a plugin that I worked on with my colleague Alan it just makes Aro CD",
    "start": "1216240",
    "end": "1221760"
  },
  {
    "text": "lovely um it does a lot of stuff so I'm not going to bore you here but um yeah",
    "start": "1221760",
    "end": "1227200"
  },
  {
    "text": "go check it out it probably be useful and then the last two go hand in hand uh renovate is a bit like dependabot but",
    "start": "1227200",
    "end": "1233440"
  },
  {
    "text": "good um it works for um kubernetes resources so for example if you've got",
    "start": "1233440",
    "end": "1238919"
  },
  {
    "text": "an Argo workflow um and you're pulling an image as part of your workflow and it's got a tag and the tag changes",
    "start": "1238919",
    "end": "1244159"
  },
  {
    "text": "renovate can change that tag for you and give you a PR to update your workflow for the future it also works on Helm",
    "start": "1244159",
    "end": "1250120"
  },
  {
    "text": "charts so renovate can tell you when there's a new version of a Helm chart out what renov can't do is merge in the",
    "start": "1250120",
    "end": "1256039"
  },
  {
    "text": "changes from the Upstream values file into your values file and that's where the last thing comes in again worked on",
    "start": "1256039",
    "end": "1262799"
  },
  {
    "text": "it with my colleague Alan um this is very opinionated and you probably won't want to use it directly but use it as",
    "start": "1262799",
    "end": "1269000"
  },
  {
    "text": "inspiration um this this will update your values file for you and allow you to just have a nice PR where you",
    "start": "1269000",
    "end": "1274480"
  },
  {
    "text": "understand what the Upstream change was before you push it into your",
    "start": "1274480",
    "end": "1279039"
  },
  {
    "text": "cluster and now let's take a look at what actually happens under the hood we've been talking about V cluster and",
    "start": "1280080",
    "end": "1285919"
  },
  {
    "text": "virtual clusters and enabling multi tendency but what does it actually mean how does it work right um so one of the",
    "start": "1285919",
    "end": "1292640"
  },
  {
    "text": "things that Tim was saying is that that eks control plane is actually under a lot of fire if you're spinning up a lot",
    "start": "1292640",
    "end": "1298720"
  },
  {
    "text": "of Hello World applications or other things right um and the way we resolve",
    "start": "1298720",
    "end": "1303760"
  },
  {
    "text": "this is essentially by creating virtual clusters on top so let's take a regular eks cluster it has like a API server an",
    "start": "1303760",
    "end": "1309520"
  },
  {
    "text": "adcd controller manager scheduler right we pay at a to run this for us so we don't have to and then we typically as",
    "start": "1309520",
    "end": "1315440"
  },
  {
    "text": "an admin we talk to this API server it means we got a C context plain cluster nothing in there we can create a",
    "start": "1315440",
    "end": "1322159"
  },
  {
    "text": "namespace in here and as we said earlier we could hand that namespace out and make that a tenant right uh but again",
    "start": "1322159",
    "end": "1328960"
  },
  {
    "text": "it's not really isolated we're talking to the same API server there's going to be a lot of load on there so let's not",
    "start": "1328960",
    "end": "1334640"
  },
  {
    "text": "do that instead what we're doing is we're launching a v cluster and as I mentioned earlier that's just a part that's why it starts up in 30 seconds",
    "start": "1334640",
    "end": "1341279"
  },
  {
    "text": "and that demo on the PIP kit website is ready when you want it to be ready uh in less than a minute um what what's inside",
    "start": "1341279",
    "end": "1348600"
  },
  {
    "text": "this part inside this V cluster pod we have another kubernetes control plane that means we have another API server we",
    "start": "1348600",
    "end": "1354279"
  },
  {
    "text": "have another data store we have another controller manager and we have no scheduler instead we have a Syer and the",
    "start": "1354279",
    "end": "1361000"
  },
  {
    "text": "Syer is what connects things to the underlying cluster I'll get to them a second but the first thing I wanted to",
    "start": "1361000",
    "end": "1366159"
  },
  {
    "text": "mention is if I'm a tenant now whether that's an application or an actual person uh running CP CTL commands we're",
    "start": "1366159",
    "end": "1372799"
  },
  {
    "text": "now talking to this API server on the top right we're talking to the orange API server not the one at the bottom so",
    "start": "1372799",
    "end": "1379480"
  },
  {
    "text": "we're not really talking to eks anymore we're talking to the virtual cluster now whether that it's exposed via load",
    "start": "1379480",
    "end": "1385240"
  },
  {
    "text": "balancer or Ingress or you know cluster internal IP doesn't really matter but you talk to this API server that means",
    "start": "1385240",
    "end": "1392000"
  },
  {
    "text": "there can also be different credentials and authentication right you can also hook it up via your open ID connect to",
    "start": "1392000",
    "end": "1397400"
  },
  {
    "text": "your SSO Etc right but it's separate from the EES um control plan that means",
    "start": "1397400",
    "end": "1403520"
  },
  {
    "text": "we get a new context and in this Cube context we're not seeing that name space or that V cluster part we're also not",
    "start": "1403520",
    "end": "1410039"
  },
  {
    "text": "seeing that Opa or that ISO or anything else at RS now and there but we can use",
    "start": "1410039",
    "end": "1415400"
  },
  {
    "text": "it and that's a really cool part that's where we where it comes in we can share things from the onine cluster but we're",
    "start": "1415400",
    "end": "1421559"
  },
  {
    "text": "not locked into using the same stuff same versions crd upgrades different kubernetes versions right all of that is",
    "start": "1421559",
    "end": "1428240"
  },
  {
    "text": "possible now because the V cluster is isolated and we can only connect it to things in the underlying cluster as we",
    "start": "1428240",
    "end": "1434000"
  },
  {
    "text": "want it to be so let's create a nam space we can run some some crds in there and set them up we can be admin in this",
    "start": "1434000",
    "end": "1440520"
  },
  {
    "text": "cluster if we create a deployment that controller manager in the v cluster is going to say oh I saw there's like you",
    "start": "1440520",
    "end": "1446080"
  },
  {
    "text": "know Replicon number is two right I'm going to create two pods right the big question now is how do these pods",
    "start": "1446080",
    "end": "1451919"
  },
  {
    "text": "actually get launched cuz the V cler doesn't have any nodes right it's just a pod and a kubernetes cluster that's",
    "start": "1451919",
    "end": "1457360"
  },
  {
    "text": "where the Syer comes in the Sinker effectively copies the Pod down but instead of having all the objects",
    "start": "1457360",
    "end": "1463279"
  },
  {
    "text": "replicated and a lot of conflicts and this API server being under a lot of fire we separate API servers we have",
    "start": "1463279",
    "end": "1469360"
  },
  {
    "text": "isolation and the only attack Vector we have is the actual part and while syncing the V cluster and isolated mode",
    "start": "1469360",
    "end": "1476679"
  },
  {
    "text": "does Network isol isolation it can really isolate this workload that it sycs down to the underlying cluster to",
    "start": "1476679",
    "end": "1483520"
  },
  {
    "text": "really isolated from all the other workloads in the cluster and that's pretty much how V cluster Works under the hood and this V cluster on the top",
    "start": "1483520",
    "end": "1490520"
  },
  {
    "text": "is a certified kubernetes distro that means switching from a real cluster to a v cluster just means switching your Cube",
    "start": "1490520",
    "end": "1495880"
  },
  {
    "text": "context and it just works we pass all the cncf conformance tests and uh it's",
    "start": "1495880",
    "end": "1501960"
  },
  {
    "text": "really really easy to switch over sometimes we see customers swap out real clusters or Fe clusters and their",
    "start": "1501960",
    "end": "1507640"
  },
  {
    "text": "tenants don't even realize it think we just head straight to this",
    "start": "1507640",
    "end": "1513120"
  },
  {
    "text": "there's a load of free stuff follow the links uh We've run out of time thank",
    "start": "1513120",
    "end": "1518180"
  },
  {
    "text": "[Applause] you and if you have any questions let us",
    "start": "1518180",
    "end": "1525760"
  },
  {
    "text": "know we're also going to be around after the talk but I think there's a mic over",
    "start": "1525760",
    "end": "1530799"
  },
  {
    "text": "here so you briefly brought up the usage of iso uh I am curious how you would",
    "start": "1530799",
    "end": "1538480"
  },
  {
    "text": "share Isa running on the host cluster inside of a v cluster yeah so that that",
    "start": "1538480",
    "end": "1545000"
  },
  {
    "text": "really comes down to uh syncing more than just a part so by default We sync the part because that needs to be",
    "start": "1545000",
    "end": "1550880"
  },
  {
    "text": "scheduled by the underline cluster but if you're looking at ISO and things like uh Gateway resource or virtual um",
    "start": "1550880",
    "end": "1557760"
  },
  {
    "text": "service resource right what you can do and you can do that in the v cluster configuration V cluster essentially you",
    "start": "1557760",
    "end": "1564360"
  },
  {
    "text": "could just deploy it via hel chart right and in the values you can specify what resources get synced and how so you can",
    "start": "1564360",
    "end": "1571919"
  },
  {
    "text": "enable syncing for virtual servers or for Gateway resources and then these resources will be copied to the",
    "start": "1571919",
    "end": "1577679"
  },
  {
    "text": "underlying cluster you can apply modifications to them we typically do some standard modifications to some of",
    "start": "1577679",
    "end": "1583360"
  },
  {
    "text": "the resources to prevent collisions and to prevent the smooth isolation um and then the underlying controller the",
    "start": "1583360",
    "end": "1589360"
  },
  {
    "text": "underlying ISO um that controller would reconcile these resources um that are",
    "start": "1589360",
    "end": "1595399"
  },
  {
    "text": "now available inside the V cluster but unlike in in a um in the underlying",
    "start": "1595399",
    "end": "1600840"
  },
  {
    "text": "cluster so in the underly cluster you would see all of the resources just like you see all the parts from all the V cluster but inside the V cluster you",
    "start": "1600840",
    "end": "1607640"
  },
  {
    "text": "only see your own and you can have like end name spaces in the v cluster map to a single name space in the underlying",
    "start": "1607640",
    "end": "1613799"
  },
  {
    "text": "cluster it's very flexible on what to configure how that syncing mechanis ISM works that's kind of the the magic sauce",
    "start": "1613799",
    "end": "1619919"
  },
  {
    "text": "in V cluster thank you hello um so question um about um the",
    "start": "1619919",
    "end": "1630520"
  },
  {
    "text": "benefits of virtual clusters so earlier you were saying that one of the big benefits for you know users if you've",
    "start": "1630520",
    "end": "1638080"
  },
  {
    "text": "got um hundreds of clusters virtual cluster is that you save on resources so",
    "start": "1638080",
    "end": "1644000"
  },
  {
    "text": "if you've already got like a large multi-tenant environment what's the big benefit of virtual",
    "start": "1644000",
    "end": "1650520"
  },
  {
    "text": "cluster so I think if you're using name spaces already if that's what we're probably referring to right large",
    "start": "1650520",
    "end": "1656080"
  },
  {
    "text": "clusters multi-tenant clusters with name spaces um you usually don't gain a lot in terms of cost right like you don't",
    "start": "1656080",
    "end": "1662919"
  },
  {
    "text": "gain anything in terms of cost actually you got to run the recluster part additionally right but what you're gaining is uh developer autonomy so if",
    "start": "1662919",
    "end": "1671760"
  },
  {
    "text": "you're in a multi-tenant cluster today and you're using name spaces for isolation and someone in your team wants",
    "start": "1671760",
    "end": "1677559"
  },
  {
    "text": "to you know install Argo right they need to install a crd and they may not be",
    "start": "1677559",
    "end": "1683200"
  },
  {
    "text": "permitted to do that they may have to go to the admins and to the platform team to kind of request this but then the",
    "start": "1683200",
    "end": "1689240"
  },
  {
    "text": "question is like who's now managing it right um versus in the v cluster if you want to install Argo you're going to be",
    "start": "1689240",
    "end": "1695320"
  },
  {
    "text": "admin inside that V cluster right um so if pip kit deploys any crds into these",
    "start": "1695320",
    "end": "1700960"
  },
  {
    "text": "uh virtual clusters right they're independently versionable right like some of your tenants may be on a legacy",
    "start": "1700960",
    "end": "1707480"
  },
  {
    "text": "version of Argo others may be wanting to test the new better version right um all of this is possible versus if you're in",
    "start": "1707480",
    "end": "1713679"
  },
  {
    "text": "a multitenant environment you're kind of stuck with having to agree on the minimal consensus for everybody and that",
    "start": "1713679",
    "end": "1719200"
  },
  {
    "text": "becomes really tricky the bigger that multitenant environment gets so cost savings if you're already using multi-",
    "start": "1719200",
    "end": "1724279"
  },
  {
    "text": "tendency is not the the biggest advantage that's more when you're coming from single tenant environments uh when",
    "start": "1724279",
    "end": "1729640"
  },
  {
    "text": "you're in multi tendency it's more about gaining that admin excess and the velocity and essentially the developer",
    "start": "1729640",
    "end": "1735919"
  },
  {
    "text": "autonomy got you thank",
    "start": "1735919",
    "end": "1739679"
  },
  {
    "text": "you so as your uh customers bring up V clusters uh it runs basically it's like",
    "start": "1743640",
    "end": "1752559"
  },
  {
    "text": "the uh the master are running on a pod sort of without the worker noes",
    "start": "1752559",
    "end": "1759320"
  },
  {
    "text": "right um do they get a list of worker noes or they don't or do they share I",
    "start": "1759320",
    "end": "1766159"
  },
  {
    "text": "mean yeah yeah so by there I would recommend watching the talk I gave this morning",
    "start": "1766159",
    "end": "1772120"
  },
  {
    "text": "with cor weave um on how they build up their GPU Cloud because there's two options you have and then multiple sub",
    "start": "1772120",
    "end": "1779480"
  },
  {
    "text": "variations of those the default option is you're just using all the nodes from the underly cluster but you can also",
    "start": "1779480",
    "end": "1785320"
  },
  {
    "text": "have the V cluster apply automatic node selectors for example to Dev up things",
    "start": "1785320",
    "end": "1790480"
  },
  {
    "text": "um one thing you can also do is you can join dedicated nodes into a specific V cluster and you can say well all of this",
    "start": "1790480",
    "end": "1797000"
  },
  {
    "text": "n pool is shared and this subset with the node selector is available to these three V clusters but this V cluster gets",
    "start": "1797000",
    "end": "1803559"
  },
  {
    "text": "like these five nodes purely dedicated joined in so there's a lot of flexibility on how you can handle these",
    "start": "1803559",
    "end": "1808799"
  },
  {
    "text": "kind of note scenarios and then you're leveraging like anti-affinity rules and everything as such to do those",
    "start": "1808799",
    "end": "1815159"
  },
  {
    "text": "separations between the work okay what",
    "start": "1815159",
    "end": "1819880"
  },
  {
    "text": "did oh yeah yeah yeah so one one interesting thing is if you're using anti- affinity and in those kind of",
    "start": "1820200",
    "end": "1826279"
  },
  {
    "text": "scenarios um you can actually strip these things away during the sync process as well so you can leave it to",
    "start": "1826279",
    "end": "1832200"
  },
  {
    "text": "your tenant to use these you can also validate them in the sync process just like you would do it admission control",
    "start": "1832200",
    "end": "1837880"
  },
  {
    "text": "right um You can actually do it with the underlying host clusters opar or other admission control as well right um but",
    "start": "1837880",
    "end": "1843679"
  },
  {
    "text": "you can also strip it away during the snc process or modify it during the snc",
    "start": "1843679",
    "end": "1849559"
  },
  {
    "text": "process",
    "start": "1856240",
    "end": "1859240"
  },
  {
    "text": "yeah so we what we do in terms of metrics is so in the sync process each",
    "start": "1865679",
    "end": "1870799"
  },
  {
    "text": "of the parts gets labeled with which V cluster it comes from and what the",
    "start": "1870799",
    "end": "1876240"
  },
  {
    "text": "original name space was inside of the V cluster so when you then hook up things like you know data dog and you want to",
    "start": "1876240",
    "end": "1883000"
  },
  {
    "text": "filter you can do that by V cluster right um and that makes a a lot more uh",
    "start": "1883000",
    "end": "1888120"
  },
  {
    "text": "easy to manage in terms of like metrics lock streams",
    "start": "1888120",
    "end": "1892799"
  },
  {
    "text": "Etc yeah as I said it's like very flexible in terms of how you want to configure it I think like if you look at",
    "start": "1901320",
    "end": "1907039"
  },
  {
    "text": "our standard Helm values there's probably like a thousand lines of different options and how you can set",
    "start": "1907039",
    "end": "1912360"
  },
  {
    "text": "that up to that specific need that you have I think we have one last question over here yeah so my question might be a",
    "start": "1912360",
    "end": "1919919"
  },
  {
    "text": "quick one so I'd like to know about the network for the virtual like cluster CU",
    "start": "1919919",
    "end": "1925120"
  },
  {
    "text": "previously the cluster are have like different like physical IP and they are using like flannel something like to to",
    "start": "1925120",
    "end": "1932440"
  },
  {
    "text": "provide virtual IP to solve this issue like to and how about the network in the",
    "start": "1932440",
    "end": "1938080"
  },
  {
    "text": "virtual cluster yeah so since the parts are sync to the underlying cluster the underlying",
    "start": "1938080",
    "end": "1944639"
  },
  {
    "text": "clusters uh Network cni Etc is still being used right so there's no difference the only thing we have to",
    "start": "1944639",
    "end": "1951279"
  },
  {
    "text": "actually look at is cluster internal DNS because uh DNS obviously you want to",
    "start": "1951279",
    "end": "1956880"
  },
  {
    "text": "have addressable names and service names inside the V cluster that are stable that you can talk to right so the IP",
    "start": "1956880",
    "end": "1963159"
  },
  {
    "text": "level layer is going to be handled by the host cluster but for DNS we actually deploy core DNS inside V cluster",
    "start": "1963159",
    "end": "1969000"
  },
  {
    "text": "packaged with v cluster um that means each V cluster has its own cord DNS and",
    "start": "1969000",
    "end": "1974880"
  },
  {
    "text": "in our V cluster Pro distro which pip C is using we even have like a um a",
    "start": "1974880",
    "end": "1980519"
  },
  {
    "text": "built-in cord DNS plugin that we ship as part of the V cluster control plan which allows you to do cross V cluster",
    "start": "1980519",
    "end": "1986720"
  },
  {
    "text": "communication with stable uh service addresses right um but yeah by default",
    "start": "1986720",
    "end": "1992480"
  },
  {
    "text": "you're just using the underlying clusters uh cni networking same for storage as well okay thank you aesome",
    "start": "1992480",
    "end": "2000159"
  },
  {
    "text": "thanks",
    "start": "2000159",
    "end": "2002399"
  },
  {
    "text": "everyone",
    "start": "2005960",
    "end": "2008960"
  }
]