[
  {
    "text": "thanks everyone from uh for coming here um so today we're going to be talking about uh how to keep hackers out of your",
    "start": "560",
    "end": "7799"
  },
  {
    "text": "clusters with five simple tricks and obviously it's not going to be five simple tricks um so before we start I",
    "start": "7799",
    "end": "13160"
  },
  {
    "text": "want to pull the room a little bit who would identify as someone who's doing mostly security security engineering",
    "start": "13160",
    "end": "20439"
  },
  {
    "text": "pester right um more on the S devop devops engineer side system",
    "start": "20439",
    "end": "27960"
  },
  {
    "text": "engineer and more on the application development side software engineer okay",
    "start": "27960",
    "end": "33079"
  },
  {
    "text": "great quite diverse audence cool so thanks for being here today um so the",
    "start": "33079",
    "end": "38920"
  },
  {
    "text": "goal and what we try to do today is to start from this state so you are someone",
    "start": "38920",
    "end": "44399"
  },
  {
    "text": "who has to run applications in cuties and you want to make sure that whenever someone asks you to secure it uh you",
    "start": "44399",
    "end": "50800"
  },
  {
    "text": "don't feel like this but you have instead uh you know that you can feel confident and you know how to prioritize",
    "start": "50800",
    "end": "56800"
  },
  {
    "text": "thing and that instead you can feel like that my name is Kristoff I'm French as",
    "start": "56800",
    "end": "62719"
  },
  {
    "text": "you can hear I live in Switzerland and I work at data dog focusing on cloud security and open source I'm the",
    "start": "62719",
    "end": "68880"
  },
  {
    "text": "maintainer of a few open source projects one is called the stratus Rim another one is called the manage kubernetes",
    "start": "68880",
    "end": "74720"
  },
  {
    "text": "auditing toolkit and this is Fred hi I'm Fred uh I'm senior security researcher",
    "start": "74720",
    "end": "80720"
  },
  {
    "text": "at datadog mainly focusing on threat intelligence manare analysis and yeah threat",
    "start": "80720",
    "end": "86320"
  },
  {
    "text": "activities great so on the agenda we have mostly three things the first one is we're going to do a bit",
    "start": "86320",
    "end": "91920"
  },
  {
    "text": "of fret modeling of kubernetes it sounds like a swear world but it's going to be fine don't worry and then we're going to",
    "start": "91920",
    "end": "98079"
  },
  {
    "text": "look at uh Fred is going to tell us a bit at okay the first one is the theoretical side but then what do we see",
    "start": "98079",
    "end": "104079"
  },
  {
    "text": "in the wild what do we see in the real world how are attackers actually doing things and finally based on that we're",
    "start": "104079",
    "end": "109399"
  },
  {
    "text": "going to say well these are the things that make sense to implement because uh they are actually",
    "start": "109399",
    "end": "114640"
  },
  {
    "text": "valuable we are making two assumptions the first one is that we are using managed kubernetes running in the cloud",
    "start": "114640",
    "end": "121000"
  },
  {
    "text": "so eks AKs or GK uh just because you know it's a different level of",
    "start": "121000",
    "end": "126119"
  },
  {
    "text": "abstraction and it allows us to say for instance that itcd is going to be secure and we don't need to care about that",
    "start": "126119",
    "end": "132040"
  },
  {
    "text": "who's using manage kubernetes in one of the maor clouds okay many people not everyone but it will still be relevant",
    "start": "132040",
    "end": "138560"
  },
  {
    "text": "uh if you are using your own on your Raspberry p so FR modeling um again if we want a bad",
    "start": "138560",
    "end": "147519"
  },
  {
    "text": "user story to start with it's just that someone who defends something I need to be able to understand what are the",
    "start": "147519",
    "end": "153879"
  },
  {
    "text": "attacks right uh because you cannot secure what you can defend and I think the best way to do that is to know how",
    "start": "153879",
    "end": "159159"
  },
  {
    "text": "to attack it um and it's a few things so mostly looking at what are the entry",
    "start": "159159",
    "end": "164440"
  },
  {
    "text": "points you know what are uh where are uh the I mean how is your data flowing through this cluster uh what are you um",
    "start": "164440",
    "end": "172519"
  },
  {
    "text": "where is the network and things like that and there are two challenges I think is how do you choose the right abstraction level so if we are using",
    "start": "172519",
    "end": "178640"
  },
  {
    "text": "manage cuberes we don't want to look at all the control plane and how to secure that uh things like it CNS because they",
    "start": "178640",
    "end": "185920"
  },
  {
    "text": "are handled for us and also how do we prioritize the different attacks that we see so this is let's say the standard",
    "start": "185920",
    "end": "193400"
  },
  {
    "text": "the standard use case way simplified of course so we have the cloud provider on top of it we run worker nodes uh",
    "start": "193400",
    "end": "200040"
  },
  {
    "text": "typically ec2 things like that on top of this we have pods and we have the kubernetes API on the left that is",
    "start": "200040",
    "end": "207000"
  },
  {
    "text": "managed by the cloud provider so in terms of traffic flow we have mostly three things the management traffic on",
    "start": "207000",
    "end": "212640"
  },
  {
    "text": "the left that is um who I mean the traffic that goes to the kubernetes API",
    "start": "212640",
    "end": "218560"
  },
  {
    "text": "on the right we have the data plane traffic so this is more uh traffic that goes to the applications if you have web",
    "start": "218560",
    "end": "224200"
  },
  {
    "text": "services that's the HTTP or grpc traffic and on the top right we have the traffic",
    "start": "224200",
    "end": "229920"
  },
  {
    "text": "that goes to the container image registry when you run a pod it's going to pull the image um I mean the cube",
    "start": "229920",
    "end": "236079"
  },
  {
    "text": "light is going to run uh to pull the image from registry how do we attack that well there are a few ways the first",
    "start": "236079",
    "end": "242439"
  },
  {
    "text": "one is to exploit the vulnerability in one of the application maybe you are going to exploit Java application that",
    "start": "242439",
    "end": "249680"
  },
  {
    "text": "has a vulnerable log 4J version or something like that um and then as the attacker you are inside the Pod right so",
    "start": "249680",
    "end": "256600"
  },
  {
    "text": "you can do a few things from there you can try to escape to the host so typically this is if you have a",
    "start": "256600",
    "end": "261720"
  },
  {
    "text": "vulnerability in uh the Linux canel in the container run time or a P that is",
    "start": "261720",
    "end": "266880"
  },
  {
    "text": "dangerously configured we can also try to steal Cloud credentials and we'll see that in a bit but uh typically in many cases you",
    "start": "266880",
    "end": "275520"
  },
  {
    "text": "can actually steal credentials from the underlying work your node using the instance metadata service from your",
    "start": "275520",
    "end": "281120"
  },
  {
    "text": "Cloud this is applicable to AWS gcp and aure and finally if the Pod had some",
    "start": "281120",
    "end": "287400"
  },
  {
    "text": "permissions if it's running under a service account that has a cluster role or a role bound to it then you can",
    "start": "287400",
    "end": "293479"
  },
  {
    "text": "probably steal the service account token and move to the kubernetes",
    "start": "293479",
    "end": "298639"
  },
  {
    "text": "API if you are able also to compromise someone like the credentials of an admin",
    "start": "298639",
    "end": "303880"
  },
  {
    "text": "that can access the cluster you can also directly hit the Cub API and finally if",
    "start": "303880",
    "end": "310039"
  },
  {
    "text": "you are able to poison one of the images that's used in production well you can also run some code in the cluster so",
    "start": "310039",
    "end": "315840"
  },
  {
    "text": "that's the minimalistic uh threat model that we use today and the goal is really to say okay these are in theory what can",
    "start": "315840",
    "end": "322120"
  },
  {
    "text": "happen and what do we see in reality um when we say threat model I",
    "start": "322120",
    "end": "328479"
  },
  {
    "text": "think it's also interesting to look at what are the um how what are the techniques that the community thinks",
    "start": "328479",
    "end": "335919"
  },
  {
    "text": "exist to attack a cluster um so there is something that's called the kubernetes threat matrix by Microsoft and it",
    "start": "335919",
    "end": "343120"
  },
  {
    "text": "basically tries to split uh the way that you can attack something into multiple steps so the first colum is initial",
    "start": "343120",
    "end": "350000"
  },
  {
    "text": "access which is how can you initially hike basically a cluster then you have things like persistance this is how you",
    "start": "350000",
    "end": "356000"
  },
  {
    "text": "do back door something and privilege escalation Etc and each of the um the",
    "start": "356000",
    "end": "361720"
  },
  {
    "text": "items in this table is uh one attack that is possible to perform and the",
    "start": "361720",
    "end": "367039"
  },
  {
    "text": "question is therefore you know um what is theoretical and what is something that we should actually care about and",
    "start": "367039",
    "end": "373160"
  },
  {
    "text": "there's an image that yeah that we see here um something in the kubernetes threat",
    "start": "373160",
    "end": "378520"
  },
  {
    "text": "Matrix for instance tells you well if an attacker is able to create an malicious admission controller they can back door",
    "start": "378520",
    "end": "385880"
  },
  {
    "text": "all of your Ps and do some malicious things which is true but is is some that we should actually care about or is it",
    "start": "385880",
    "end": "391360"
  },
  {
    "text": "just something that is more theoretical and um and that's it so Fred you are a",
    "start": "391360",
    "end": "397800"
  },
  {
    "text": "researcher can you tell us a little bit what you researched and and what you found as well yes thanks so before deep",
    "start": "397800",
    "end": "404960"
  },
  {
    "text": "diving into uh what we have observed so far uh we will just introduce a small concept about straight ined defense so",
    "start": "404960",
    "end": "412080"
  },
  {
    "text": "the idea here is to uh know your enemy so against who you are fighting and",
    "start": "412080",
    "end": "417400"
  },
  {
    "text": "defending in fact so in order to do that uh you have to gather all the different",
    "start": "417400",
    "end": "422759"
  },
  {
    "text": "information uh which we call the threat intelligence so you you want to know",
    "start": "422759",
    "end": "427800"
  },
  {
    "text": "about the different attacker groups what are their techniques tactics and procedure as shown in the kubernetes",
    "start": "427800",
    "end": "434120"
  },
  {
    "text": "threat Matrix uh but also the different type of threat activities and of course the new vulnerabilities which are",
    "start": "434120",
    "end": "440240"
  },
  {
    "text": "released mostly every day now and then and in know once you have a good definition of uh this uh information",
    "start": "440240",
    "end": "448120"
  },
  {
    "text": "then you can put in place some security mechanism so this is basically what Kate would like to",
    "start": "448120",
    "end": "454199"
  },
  {
    "text": "do uh however there's some limits as well for threat in threat informed",
    "start": "454199",
    "end": "459280"
  },
  {
    "text": "defense especially for cloud and containers so at first threat intelligence should not should drive",
    "start": "459280",
    "end": "465560"
  },
  {
    "text": "prioritization but should not be an end goal by itself and regarding the threat",
    "start": "465560",
    "end": "471000"
  },
  {
    "text": "intelligence information so uh you have some dedicated feeds uh which exist on",
    "start": "471000",
    "end": "476280"
  },
  {
    "text": "the the internet but they are not always curated I would say but there's also",
    "start": "476280",
    "end": "482360"
  },
  {
    "text": "some um initiative from the open source community and there was also a talk this",
    "start": "482360",
    "end": "487919"
  },
  {
    "text": "morning about that so we mention it later in in the slide uh about building",
    "start": "487919",
    "end": "494159"
  },
  {
    "text": "an open source threat intelligence for kubernetes as well and uh yeah so this is also a lack of threat intelligence",
    "start": "494159",
    "end": "502039"
  },
  {
    "text": "for cloud and containers so this is the presentation I was just mentioning so at least yeah you",
    "start": "502039",
    "end": "509240"
  },
  {
    "text": "can get all the the information directly here so here our contribution for the",
    "start": "509240",
    "end": "516200"
  },
  {
    "text": "talk uh so we did some literature review uh reading different security research",
    "start": "516200",
    "end": "521880"
  },
  {
    "text": "blog post uh also uh yeah checking all the non exploited vulnerabilities in the",
    "start": "521880",
    "end": "528560"
  },
  {
    "text": "wild so for example you have the ca which is an American um agencies which public uh",
    "start": "528560",
    "end": "537680"
  },
  {
    "text": "yeah release the different exploited vulnerabilities seen in the wild in real world attacks so this is yeah quite",
    "start": "537680",
    "end": "544720"
  },
  {
    "text": "interesting to to take into account uh but also different research papers and",
    "start": "544720",
    "end": "550360"
  },
  {
    "text": "of course VOR reports that uh you can have pretty yeah every year talking",
    "start": "550360",
    "end": "556839"
  },
  {
    "text": "about the different trends that they have observed in the customer Telemetry the second contribution that",
    "start": "556839",
    "end": "564160"
  },
  {
    "text": "we have uh it's uh based on our own observation thanks to our Hots",
    "start": "564160",
    "end": "570160"
  },
  {
    "text": "yeah thanks uh so at first what is a hyot so hyot is um a voluntary",
    "start": "570160",
    "end": "576880"
  },
  {
    "text": "vulnerable service that you will expose on the internet uh to mimic uh a specific service and yeah to Lear",
    "start": "576880",
    "end": "583920"
  },
  {
    "text": "attacker and try to get lots of information from the yeah the what they will do once they have a foothold on",
    "start": "583920",
    "end": "590680"
  },
  {
    "text": "your hod directly so we deployed several ones uh we have a what we call a honet",
    "start": "590680",
    "end": "598680"
  },
  {
    "text": "so it's a fully automated with the cicd infrastructure ascod and so on we have",
    "start": "598680",
    "end": "605000"
  },
  {
    "text": "deployed our onet directly in for different regions in AWS uh and with all",
    "start": "605000",
    "end": "610760"
  },
  {
    "text": "the monitoring needed to be sure that yeah we don't get compromised as well uh",
    "start": "610760",
    "end": "616600"
  },
  {
    "text": "and then um we get all the different logs information and we uh created our",
    "start": "616600",
    "end": "623360"
  },
  {
    "text": "onot workflow so on the left you have the attacker uh trying to connect to our",
    "start": "623360",
    "end": "628640"
  },
  {
    "text": "fake kubernetes API server we grab all the different plugs thanks to the kubernetes uh audit plugs directly into",
    "start": "628640",
    "end": "637600"
  },
  {
    "text": "datalogs and then uh on the right we have the threat intelligence platform which will grab and gather aggregate all",
    "start": "637600",
    "end": "644519"
  },
  {
    "text": "these type of information uh based on an open source project called ye so your every",
    "start": "644519",
    "end": "650839"
  },
  {
    "text": "intelligence uh and then uh we try to build um some sort of campaign so this",
    "start": "650839",
    "end": "657000"
  },
  {
    "text": "is the notion that are mentioned in the the paper we we discussed earlier with",
    "start": "657000",
    "end": "662399"
  },
  {
    "text": "the sticks format and so on so the idea is to define the campaign based for example here on the docker image uh the",
    "start": "662399",
    "end": "669680"
  },
  {
    "text": "command the command we have seen but we could also take into account the different environment variable and so on",
    "start": "669680",
    "end": "675360"
  },
  {
    "text": "and then we just slack notif about the new companes and we just and we then analyze further the different payload as",
    "start": "675360",
    "end": "682160"
  },
  {
    "text": "you can see here we have some B 64 payloads and so on which resolve to more",
    "start": "682160",
    "end": "688360"
  },
  {
    "text": "payloads that will be downloaded directly onto your workload and so for kubernetes what we",
    "start": "688360",
    "end": "694920"
  },
  {
    "text": "did we created qub so it's based on quo which is a kubernetes without cuet so",
    "start": "694920",
    "end": "701079"
  },
  {
    "text": "the idea is just to provide all the functionalities of the kubernetes API server without the final pad running the",
    "start": "701079",
    "end": "708240"
  },
  {
    "text": "the pods and so on and as you can see we can get lots of different uh information",
    "start": "708240",
    "end": "713760"
  },
  {
    "text": "about what's going on when you expose a voluntary vulnerable CID server",
    "start": "713760",
    "end": "720279"
  },
  {
    "text": "cool so that's the how maybe you can tell us a bit about the you know what you found and also we're going to split",
    "start": "720279",
    "end": "725519"
  },
  {
    "text": "that into multiple categories uh so we're going to split that against sorry between what we saw against the control",
    "start": "725519",
    "end": "732079"
  },
  {
    "text": "plane so what directly tries to hit the kubernetes API server versus what tries to exploit a workload that happens to be",
    "start": "732079",
    "end": "739120"
  },
  {
    "text": "in kuties um so Fred the first thing that you want to tell us is that when you expose something to the internet it",
    "start": "739120",
    "end": "745600"
  },
  {
    "text": "gets scanned and exploited very fast yes exactly so once you deploy something",
    "start": "745600",
    "end": "751880"
  },
  {
    "text": "directly on the internet expose directly on the internet you will be scanned by default from different web services and",
    "start": "751880",
    "end": "759079"
  },
  {
    "text": "companies just to map the internet and get information of of what is exposed",
    "start": "759079",
    "end": "764519"
  },
  {
    "text": "directly so here you have an example for kubernetes our kubernetes onod so as you",
    "start": "764519",
    "end": "770040"
  },
  {
    "text": "can see we have different probs so mainly coming from the US but yeah from all over the world so that's one part",
    "start": "770040",
    "end": "777720"
  },
  {
    "text": "then uh you can also Yeah by default scan be scanned by some specific web",
    "start": "777720",
    "end": "784079"
  },
  {
    "text": "services like sensis shown and so on so what they are doing they are just running scanners uh around yeah around",
    "start": "784079",
    "end": "791680"
  },
  {
    "text": "all the ipv4 address space but IPv6 as well to know about the different threat",
    "start": "791680",
    "end": "798160"
  },
  {
    "text": "we have the different Expos service we have on the internet so on the left this",
    "start": "798160",
    "end": "803959"
  },
  {
    "text": "is the results from our hot so as you can see you have the user agent uh based which is named senses directly so they",
    "start": "803959",
    "end": "811040"
  },
  {
    "text": "are not just trying to know if you just expose open ports but they are more",
    "start": "811040",
    "end": "816440"
  },
  {
    "text": "aggressive and getting more details about uh your cluster itself so as you can see the different uh Services roles",
    "start": "816440",
    "end": "823680"
  },
  {
    "text": "nodes Etc and then in the end on the right this is the sensis web service",
    "start": "823680",
    "end": "829399"
  },
  {
    "text": "where you just query uh something uh that could interest you so for example",
    "start": "829399",
    "end": "835279"
  },
  {
    "text": "how many kubernetes pod names we have Expos directly on the internet and yeah",
    "start": "835279",
    "end": "842240"
  },
  {
    "text": "you have directly the res so basically this is what attackers are also doing for the reconnaissance phases when they",
    "start": "842240",
    "end": "848160"
  },
  {
    "text": "want to uh uh directly attack your company for example then you have also",
    "start": "848160",
    "end": "853920"
  },
  {
    "text": "the uh different uh yeah",
    "start": "853920",
    "end": "859279"
  },
  {
    "text": "so thanks uh then you also have the different common line that you will use",
    "start": "859279",
    "end": "865800"
  },
  {
    "text": "by default when you are on a kubernetes cluster to know what uh your permission what's possible to do",
    "start": "865800",
    "end": "872000"
  },
  {
    "text": "so this is one example here you can see that they are trying to to know if they can create pods create uh different nod",
    "start": "872000",
    "end": "879120"
  },
  {
    "text": "Services deployment and so on we also have the same thing for the listing so the idea here is to uh yeah to know",
    "start": "879120",
    "end": "886360"
  },
  {
    "text": "what's running here and finally uh you can also have some more um yeah",
    "start": "886360",
    "end": "893480"
  },
  {
    "text": "attackers trying to get directly all your secret all your secrets so this bring us to the Cloud credential yeah so",
    "start": "893480",
    "end": "901240"
  },
  {
    "text": "one thing to remember is that we made the assumptions that the cluster runs in the cloud which means that the cluster is only as secure as the cloud um and",
    "start": "901240",
    "end": "908800"
  },
  {
    "text": "typically the way that you can use that is um when you compromise a cloud",
    "start": "908800",
    "end": "914079"
  },
  {
    "text": "identity so typically an I am user or things like that you can access the cluster by Design and we know that I am",
    "start": "914079",
    "end": "920120"
  },
  {
    "text": "user access Keys typically are very easy to leak uh these are a few examples and we did some research actually last year",
    "start": "920120",
    "end": "926120"
  },
  {
    "text": "and we showed that uh most of the cloud incident are caused by some class credentials that leak and this happens",
    "start": "926120",
    "end": "932000"
  },
  {
    "text": "all the time this is an example from vus Buon it's a conference security",
    "start": "932000",
    "end": "937800"
  },
  {
    "text": "conference and this is a presentation from someone that runs an incident response team they showed an incident",
    "start": "937800",
    "end": "944399"
  },
  {
    "text": "where they had user compromised this is the G alert that they had and then uh",
    "start": "944399",
    "end": "950120"
  },
  {
    "text": "you can see in this piece of cloud tril log this is the AWS control plane logs that the attacker tries to use the AWS",
    "start": "950120",
    "end": "956680"
  },
  {
    "text": "CLI U to access the so um that's one thing the second thing",
    "start": "956680",
    "end": "962600"
  },
  {
    "text": "is that once you compromise a pod that runs in the cloud it's actually super easy most of the time to get some",
    "start": "962600",
    "end": "969079"
  },
  {
    "text": "credentials for the underlying worker node um so that's one way but typically",
    "start": "969079",
    "end": "974680"
  },
  {
    "text": "you know when you attack a bud and you and you manage to compromise it you're going to try three things as an attacker",
    "start": "974680",
    "end": "980399"
  },
  {
    "text": "first one is to hit what is called the instance metadata Service uh this is what's going to give you some some Cloud",
    "start": "980399",
    "end": "986759"
  },
  {
    "text": "credentials for the worker n and this is is unfortunately working by default for uh for many cases um you can try to look",
    "start": "986759",
    "end": "993759"
  },
  {
    "text": "at hardcoded credentials on the file system also it happens a lot and look at environment variables that's the theory",
    "start": "993759",
    "end": "1000480"
  },
  {
    "text": "but in practice this is a sample script that uh that we C you can see the first line is a list of files that the",
    "start": "1000480",
    "end": "1007959"
  },
  {
    "text": "attacker is trying to Target and they are basically files that look like they could contain AWS Cen CH the second and",
    "start": "1007959",
    "end": "1015319"
  },
  {
    "text": "and third line in this get AWS info function is the attacker trying to hit the instance metadata service with K to",
    "start": "1015319",
    "end": "1022800"
  },
  {
    "text": "say well give me some security Cen shells uh and these are going to to give",
    "start": "1022800",
    "end": "1028120"
  },
  {
    "text": "you um the the CL for the underlying worker nodes I am roll finally you can",
    "start": "1028120",
    "end": "1034520"
  },
  {
    "text": "see that they are trying to uh to steal these credentials and to send them to basically a back end that they control",
    "start": "1034520",
    "end": "1040798"
  },
  {
    "text": "and in that case funnily enough if you just went to this/ phpd you could actually find all the credentials that",
    "start": "1040799",
    "end": "1047120"
  },
  {
    "text": "they uh stole uh as you can see here so uh we were able to report that to AWS",
    "start": "1047120",
    "end": "1053480"
  },
  {
    "text": "and they just were able to revoke all these keys I want to touch a bit also on coner",
    "start": "1053480",
    "end": "1060120"
  },
  {
    "text": "Escape vulnerabilities so this is really you manage to hike a pod you inside a pod you and you can romand um what do",
    "start": "1060120",
    "end": "1067720"
  },
  {
    "text": "you do to escape outside of this pod if you read the abstract of this presentation we said we were going to",
    "start": "1067720",
    "end": "1073080"
  },
  {
    "text": "talk about this and how they are used in the world uh and the reality is that there is very little doent mation of",
    "start": "1073080",
    "end": "1079600"
  },
  {
    "text": "container Escape being used in the world which to me was very surprising and I",
    "start": "1079600",
    "end": "1085520"
  },
  {
    "text": "think there are a few reasons the first one and this is from a paper from a few years ago uh but it still remains true",
    "start": "1085520",
    "end": "1092280"
  },
  {
    "text": "is that there aren't that many container Escape vulnerabilities in container vun times uh so this is an example for the",
    "start": "1092280",
    "end": "1099360"
  },
  {
    "text": "most popular ones you have only four critical vulnerabilities three of them being pro three of them having proof of",
    "start": "1099360",
    "end": "1105320"
  },
  {
    "text": "concept so the attack surface isn't that that WI and the second reason that these are two",
    "start": "1105320",
    "end": "1112039"
  },
  {
    "text": "pretty wellknown red teamers that are saying do I actually need don't see it",
    "start": "1112039",
    "end": "1117640"
  },
  {
    "text": "uh they are saying do you actually need to do a container Escape if you can do easier things right if you can just Ste",
    "start": "1117640",
    "end": "1123919"
  },
  {
    "text": "cloud cren and go after your EST bucket that have some credit card it's much easier uh and the second reason being",
    "start": "1123919",
    "end": "1130280"
  },
  {
    "text": "that you first need to have access to a Bo for that so you need a vulnerable application and this is harder these",
    "start": "1130280",
    "end": "1136200"
  },
  {
    "text": "days than it was maybe 10 years ago that said if you don't have plans for",
    "start": "1136200",
    "end": "1141640"
  },
  {
    "text": "this weekend um there is the pun to own concept sorry contest happening in Vancouver and they explicitly said for",
    "start": "1141640",
    "end": "1149240"
  },
  {
    "text": "the first time that they will give you $60,000 if you find a container Escape in container D or fire cracker so if you",
    "start": "1149240",
    "end": "1156200"
  },
  {
    "text": "if you don't have plans for the weekend think about it and we might see some new vulnerabilities that come out of this um",
    "start": "1156200",
    "end": "1162159"
  },
  {
    "text": "so that's something to watch out for FR next you want to tell us that",
    "start": "1162159",
    "end": "1167240"
  },
  {
    "text": "attackers are trying to create workload so what does it mean are they like trying to create their own microservices",
    "start": "1167240",
    "end": "1172640"
  },
  {
    "text": "or something yeah so as if basically fail to directly create or escape from",
    "start": "1172640",
    "end": "1177679"
  },
  {
    "text": "host what they are B basically doing is just creating new workloads so there's",
    "start": "1177679",
    "end": "1182760"
  },
  {
    "text": "different ways to uh to create the workload so with the different final objective so for one you can uh create",
    "start": "1182760",
    "end": "1189600"
  },
  {
    "text": "new workload just to escalate privileges by creating the privilege pods and just mounting the host F system directly into",
    "start": "1189600",
    "end": "1195960"
  },
  {
    "text": "your pods and get access to everything you want and so you have some example here about",
    "start": "1195960",
    "end": "1202120"
  },
  {
    "text": "the different execution so just creating different pods but also Diamond set",
    "start": "1202120",
    "end": "1207200"
  },
  {
    "text": "directly in the different namespace so Cube system but also the default as well and they also like to bring their",
    "start": "1207200",
    "end": "1214440"
  },
  {
    "text": "own images so these images are all host on dockerhub so most of them are not",
    "start": "1214440",
    "end": "1220280"
  },
  {
    "text": "deleted because we reported them as malicious but yeah basically they just create their their own uh workload with",
    "start": "1220280",
    "end": "1229120"
  },
  {
    "text": "their own images with their own tool links directly available inside the the workload itself the the image",
    "start": "1229120",
    "end": "1236280"
  },
  {
    "text": "itself uh another thing to know as well is that attacker exploit vulnerable",
    "start": "1236280",
    "end": "1241600"
  },
  {
    "text": "software as well so this is part of the game uh so yeah thanks uh so attackers",
    "start": "1241600",
    "end": "1250080"
  },
  {
    "text": "exploit public facing vulnerabilities most of the time to get an initial foothold into your containers so that's",
    "start": "1250080",
    "end": "1255760"
  },
  {
    "text": "part of the data plane so here you have the top five abilities exploited in the wild based on",
    "start": "1255760",
    "end": "1262080"
  },
  {
    "text": "2023 and B uh yeah based on the report of Aqua uh but yeah they also uh create",
    "start": "1262080",
    "end": "1269880"
  },
  {
    "text": "a new uh yeah they also uh enroll a compromise",
    "start": "1269880",
    "end": "1275600"
  },
  {
    "text": "host to scan the internet itself so what they are doing basically so that's another pad we we C we cut directly in",
    "start": "1275600",
    "end": "1282760"
  },
  {
    "text": "our Hots uh once they have a footle in your workload they will try they will",
    "start": "1282760",
    "end": "1288679"
  },
  {
    "text": "use the workload itself to scan the Internet and try to exploit new host and",
    "start": "1288679",
    "end": "1294159"
  },
  {
    "text": "uh yeah compromise them as well and uh as you can see here so this one is coming from a remote code exploitation",
    "start": "1294159",
    "end": "1301880"
  },
  {
    "text": "vulnerability in Confluence and they are just using open source project like Mass scan zg grab and so on to just yeah",
    "start": "1301880",
    "end": "1309320"
  },
  {
    "text": "scanning the internet in some specific uh IP Ries as well so as you can see uh we covered",
    "start": "1309320",
    "end": "1317679"
  },
  {
    "text": "than to the literature but also our Hots different parts of the kuber Microsoft",
    "start": "1317679",
    "end": "1323880"
  },
  {
    "text": "kubernetes threat Matrix but now we would like to know how can we prevent attackers uh yeah getting a foothold in",
    "start": "1323880",
    "end": "1330720"
  },
  {
    "text": "our kubernetes cluster so Kristoff can you please tell us more on this yes um",
    "start": "1330720",
    "end": "1336640"
  },
  {
    "text": "so again these are all the attacks that we were able to find either publicly documented either from our honeypots",
    "start": "1336640",
    "end": "1343240"
  },
  {
    "text": "mapped to the Microsoft communties threat metrix that we showed before now this is all good and shiny but how do we",
    "start": "1343240",
    "end": "1349640"
  },
  {
    "text": "you know what do we do right um and so my my question is first should we try to",
    "start": "1349640",
    "end": "1355919"
  },
  {
    "text": "secure our control plane so do we make our kubernetes API more secure or our data plane and the answer which is kind",
    "start": "1355919",
    "end": "1361880"
  },
  {
    "text": "of obuse is that you need both uh because if you if you secure your kubernetes API but you run your",
    "start": "1361880",
    "end": "1367039"
  },
  {
    "text": "workloads as admin exposed to the internet with some vulnerabilities your security looks like this and conversely",
    "start": "1367039",
    "end": "1373400"
  },
  {
    "text": "if you are just uh securing your workloads but you have your kubernetes API on the internet without Authentication",
    "start": "1373400",
    "end": "1379039"
  },
  {
    "text": "it's not going to end well either right so um the first thing the first advice",
    "start": "1379039",
    "end": "1384720"
  },
  {
    "text": "would be to get the control plane Basics right and the good news is that you're in the cloud in manage kubernetes server",
    "start": "1384720",
    "end": "1390480"
  },
  {
    "text": "uh service so you don't need to really manage your Cloud control plane um uh",
    "start": "1390480",
    "end": "1396320"
  },
  {
    "text": "you just need to make sure that authentication is enforced on the API server which is the default and it's",
    "start": "1396320",
    "end": "1402039"
  },
  {
    "text": "actually very hard to disable that which is good one advice is to dis is to minimize the network exposure of API",
    "start": "1402039",
    "end": "1408840"
  },
  {
    "text": "server so your API server makes sure that if you can you can either put it on a private Network either had some IP low",
    "start": "1408840",
    "end": "1415240"
  },
  {
    "text": "listing on that on gcp you have something called the um the identity aware proxy which makes this quite easy",
    "start": "1415240",
    "end": "1422520"
  },
  {
    "text": "on AWS most likely you're going to need to put that on an internal network uh or to use a ban host or to use IP allow",
    "start": "1422520",
    "end": "1430760"
  },
  {
    "text": "listing I think one also piece of advice here use as little kubernetes as you",
    "start": "1430760",
    "end": "1436279"
  },
  {
    "text": "need so obviously if we don't need kubernetes we don't we don't use it uh but many times we actually don't even",
    "start": "1436279",
    "end": "1441799"
  },
  {
    "text": "need to manage the n in which case using something like GK autopilot or AWS eks",
    "start": "1441799",
    "end": "1447640"
  },
  {
    "text": "on fargate is great because you have no control over the N so you you don't have to patch the ND you and you are",
    "start": "1447640",
    "end": "1453760"
  },
  {
    "text": "protected against various uh various vulnerabilities and things that are quite bad so that's good and otherwise",
    "start": "1453760",
    "end": "1460360"
  },
  {
    "text": "if you need the full power of kubernetes and to manage the N manage kuties is a good option and obviously if you have a",
    "start": "1460360",
    "end": "1466480"
  },
  {
    "text": "full engineering team which can manage your plane uh that's one option maybe the second piece of advice um is",
    "start": "1466480",
    "end": "1474000"
  },
  {
    "text": "to make sure that you can block the cloud metad data service from the pods so you have pods and the pods they have",
    "start": "1474000",
    "end": "1480240"
  },
  {
    "text": "different ways of accessing Cloud credentials but they shouldn't be able to use the instance metadata Service uh",
    "start": "1480240",
    "end": "1486840"
  },
  {
    "text": "typically the way that this is attacked is you have an attacker that compromises a pod and from this SP they still Cloud",
    "start": "1486840",
    "end": "1493880"
  },
  {
    "text": "credentials that belong to the instance role uh that they run on has a very quick demo it's going to go fast and I I",
    "start": "1493880",
    "end": "1501440"
  },
  {
    "text": "know at it's 5 p.m but uh on the left I have an application that's vable to command injection and you see on the",
    "start": "1501440",
    "end": "1507840"
  },
  {
    "text": "left an attacker that's going to compromise it on the right going to run some malicious commands and they are",
    "start": "1507840",
    "end": "1513760"
  },
  {
    "text": "doing Cur on the instant metadata service and getting back some credentials that belong to the underlying worker note once more time um",
    "start": "1513760",
    "end": "1521919"
  },
  {
    "text": "I'm running a malicious command in this vulnerable application I do Cur 169 2541",
    "start": "1521919",
    "end": "1527480"
  },
  {
    "text": "169 254 and I can basically get some um credentials for the instance and from",
    "start": "1527480",
    "end": "1534120"
  },
  {
    "text": "there I can do various bad things uh if you are interested last year I gave a presentation with de Commerce from SCE",
    "start": "1534120",
    "end": "1540520"
  },
  {
    "text": "graph about specifically Visa vectors so how you can do different kinds of bad stuff in the manage kubernetes",
    "start": "1540520",
    "end": "1547159"
  },
  {
    "text": "environment so if you want to check it out um the slides will be online of course but what you need to do so two",
    "start": "1547159",
    "end": "1554240"
  },
  {
    "text": "things if you using GK you need to enable workload identity and which is enabled by default on GK",
    "start": "1554240",
    "end": "1560960"
  },
  {
    "text": "autopilot and on AWS arure you need to explicitly block the access with a network policy that's the long story",
    "start": "1560960",
    "end": "1569559"
  },
  {
    "text": "short now again we're in the cloud it's not you know it's a normal thing for workloads to access the cloud and",
    "start": "1569559",
    "end": "1575279"
  },
  {
    "text": "typically there are secure ways to do that like eks P identity on AWS or I am",
    "start": "1575279",
    "end": "1580440"
  },
  {
    "text": "rolles for service accounts so these are secure mechanisms through which your Java your go Application can get some",
    "start": "1580440",
    "end": "1586399"
  },
  {
    "text": "access to your Cloud environment uh but I think it's super important to be aware of what kind of access they have and to",
    "start": "1586399",
    "end": "1592799"
  },
  {
    "text": "know you know if you have thousands of PS which ones can basically be used to go after your Cloud so one way to do",
    "start": "1592799",
    "end": "1598960"
  },
  {
    "text": "that uh is an open source project that we released last year which is called the manage kuber auditing toolkit uh",
    "start": "1598960",
    "end": "1606840"
  },
  {
    "text": "MCAT which looks at your kubernetes service accounts it looks at your AWS roles and it's going to uh generate",
    "start": "1606840",
    "end": "1613880"
  },
  {
    "text": "something like this which shows you you have this pod in this namespace that can",
    "start": "1613880",
    "end": "1619320"
  },
  {
    "text": "take this I am roll Again by Design but it's good to be aware of that and you might get some some surprises as",
    "start": "1619320",
    "end": "1627159"
  },
  {
    "text": "well the the fourth piece of advice is just to be intentional about what can run in the cluster uh so if uh if you",
    "start": "1627159",
    "end": "1635799"
  },
  {
    "text": "sit with your team with your s team probably they will tell you things like oh we don't run some images from from",
    "start": "1635799",
    "end": "1642279"
  },
  {
    "text": "the doer Hub because uh we get some rate limit and things like that which is good for security as as well uh what's",
    "start": "1642279",
    "end": "1649279"
  },
  {
    "text": "important is to try to be able to to codify that and to be able to either",
    "start": "1649279",
    "end": "1654360"
  },
  {
    "text": "block either get some alerts when a workload that you don't want in your cluster tries to get created uh so these",
    "start": "1654360",
    "end": "1660559"
  },
  {
    "text": "are things like privilege pods or pods that mount the whole fight system",
    "start": "1660559",
    "end": "1666760"
  },
  {
    "text": "probably you don't want to have a pod that can mount the root fight system of the host in TMP folder uh so you know",
    "start": "1666760",
    "end": "1672880"
  },
  {
    "text": "first step is to try to do some other things second one to block it a few ways to do that uh so there is open policy",
    "start": "1672880",
    "end": "1679399"
  },
  {
    "text": "agent gatekeeper you have kerno there are two kinds of admission controller and you have a relatively new feature in",
    "start": "1679399",
    "end": "1685840"
  },
  {
    "text": "kubernetes which is called po security admission which allows you to do some of that including since recently with some",
    "start": "1685840",
    "end": "1691760"
  },
  {
    "text": "custom rules that you can write as think as custom resource definitions the presentation I I have",
    "start": "1691760",
    "end": "1698039"
  },
  {
    "text": "below here is from a colleague an next colleague uh Toy MMI he showed how at data do in the compute security team",
    "start": "1698039",
    "end": "1704640"
  },
  {
    "text": "they were able to use Opa gatekeeper for this and the fifth piece of advice is that",
    "start": "1704640",
    "end": "1711760"
  },
  {
    "text": "it's actually very boring but application security matters like many of much of the time uh the way an",
    "start": "1711760",
    "end": "1717640"
  },
  {
    "text": "attacker is going to get into your cluster is through an application so all the standard piece of advice applies uh",
    "start": "1717640",
    "end": "1723799"
  },
  {
    "text": "this is a great talk from Clint Gibler he writes the TG newsletter uh so you know things like use a framework don't",
    "start": "1723799",
    "end": "1730600"
  },
  {
    "text": "try to reinvent session management things like that and try to be aware that you know if you use Java 8 it's",
    "start": "1730600",
    "end": "1736080"
  },
  {
    "text": "probably good to update uh but also to look at the libraries the dependencies if you're using a supported version of",
    "start": "1736080",
    "end": "1741960"
  },
  {
    "text": "the framework things like that that tend to align with a good maturity of operations",
    "start": "1741960",
    "end": "1747360"
  },
  {
    "text": "anyway now once you've done all of that you can try to go to the next level uh",
    "start": "1747360",
    "end": "1752399"
  },
  {
    "text": "but personally I think it's confusing because sometimes someone will tell you that what Fred is going to show is going",
    "start": "1752399",
    "end": "1758320"
  },
  {
    "text": "to make you hacked and I don't think that's true so you know these are the kind of Basics that Mak sense to cover",
    "start": "1758320",
    "end": "1763399"
  },
  {
    "text": "first and then you have some more options yes so you're right at first you need to cover the five simple tricks and",
    "start": "1763399",
    "end": "1769480"
  },
  {
    "text": "then you can go to the next level so the first one would be for example to harden new workload so you have different ways",
    "start": "1769480",
    "end": "1776559"
  },
  {
    "text": "to do it so the first one would be for example to uh very carefully choose the",
    "start": "1776559",
    "end": "1782000"
  },
  {
    "text": "image you would like to run into your container so for example uh thiss stuff but also just python images if you just",
    "start": "1782000",
    "end": "1789000"
  },
  {
    "text": "need to run python code why would you install directly fetch um ubun to images",
    "start": "1789000",
    "end": "1795559"
  },
  {
    "text": "for example so that's one first way so that at least you do not integrate what",
    "start": "1795559",
    "end": "1801760"
  },
  {
    "text": "attackers are us usually using once they have the foo hole on the on the container like Cur wet AP they are also",
    "start": "1801760",
    "end": "1809159"
  },
  {
    "text": "doing AP install directly so that's the first step then you can also have add",
    "start": "1809159",
    "end": "1814279"
  },
  {
    "text": "some security context so either directly at the Pod level but also at the container by adding the ronly root five",
    "start": "1814279",
    "end": "1822039"
  },
  {
    "text": "system uh so setting it to True will prevent for example uh the the attacker",
    "start": "1822039",
    "end": "1827600"
  },
  {
    "text": "to be bble to fetch another pill to execute them and so on but also to put",
    "start": "1827600",
    "end": "1832760"
  },
  {
    "text": "in place some persistent mechanism uh you can also disable a privilege",
    "start": "1832760",
    "end": "1838120"
  },
  {
    "text": "escalation so this will prevent the running process to get higher privilege",
    "start": "1838120",
    "end": "1844440"
  },
  {
    "text": "uh inside the container so they won't be able to sudo stuff like that for example",
    "start": "1844440",
    "end": "1850120"
  },
  {
    "text": "and finally uh disable running as route as well uh then you can also Implement",
    "start": "1850120",
    "end": "1856320"
  },
  {
    "text": "runtime threat detection blocking oh yes thanks uh so by using open source",
    "start": "1856320",
    "end": "1862399"
  },
  {
    "text": "project as well so such as Falco tetragon or Tracy so they all rely on ebpf to monitor your workload and then",
    "start": "1862399",
    "end": "1869880"
  },
  {
    "text": "you can be notified as well of what's going on uh on the the different part of",
    "start": "1869880",
    "end": "1875120"
  },
  {
    "text": "your cluster and finally uh you can also proactively uh identify attack pass",
    "start": "1875120",
    "end": "1881159"
  },
  {
    "text": "directly in your cluster so that's another open source project we released a few months ago which is cu bound uh",
    "start": "1881159",
    "end": "1888679"
  },
  {
    "text": "the idea behind the project is to uh uh from a container uh how can I become",
    "start": "1888679",
    "end": "1893720"
  },
  {
    "text": "cluster admin just by by exploiting the different privileges Associated to my my",
    "start": "1893720",
    "end": "1900639"
  },
  {
    "text": "workloads and then the hardcore mode uh so you can also put in place some AP",
    "start": "1900639",
    "end": "1906440"
  },
  {
    "text": "aror AC Linux SE comp profiles as well and also for example take into account",
    "start": "1906440",
    "end": "1912480"
  },
  {
    "text": "signature and also provenance and that bring us to the conclusion yeah that was a lot um so to",
    "start": "1912480",
    "end": "1919360"
  },
  {
    "text": "conclude a bit few key takeaways first one is that whenever we try to secure anything the first thing in my opinion",
    "start": "1919360",
    "end": "1925440"
  },
  {
    "text": "is to try to understand how you can attack it and to do some basic threat modeling that's really helpful uh but",
    "start": "1925440",
    "end": "1931600"
  },
  {
    "text": "knowing what attackers do is great to help to prioritize but if you only rely on that you're going to change your",
    "start": "1931600",
    "end": "1937320"
  },
  {
    "text": "security strategy every week so it's not good either the third thing is that there is not much in terms of threat",
    "start": "1937320",
    "end": "1942840"
  },
  {
    "text": "intelligence for cloud and for containers uh so this is probably going to get better but it's something to",
    "start": "1942840",
    "end": "1948279"
  },
  {
    "text": "aware of and finally that some security mechanisms are worth it and some of them",
    "start": "1948279",
    "end": "1953320"
  },
  {
    "text": "are much harder to implement and the value is a bit more questionable so uh that's all for today",
    "start": "1953320",
    "end": "1959679"
  },
  {
    "text": "this is the QR code that you cannot leave the room without scanning uh if you like the presentation please uh tell",
    "start": "1959679",
    "end": "1965519"
  },
  {
    "text": "us so if you didn't please tell us so and um if you know the TD newsletter",
    "start": "1965519",
    "end": "1970840"
  },
  {
    "text": "there will be a blog post verion of this presentation tomorrow so if you prefer to read it um or to transfer it this is",
    "start": "1970840",
    "end": "1977880"
  },
  {
    "text": "a good way thank you very [Applause] [Music]",
    "start": "1977880",
    "end": "1985399"
  },
  {
    "text": "much",
    "start": "1985399",
    "end": "1988399"
  }
]