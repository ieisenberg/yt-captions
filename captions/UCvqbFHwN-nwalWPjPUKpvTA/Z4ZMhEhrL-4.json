[
  {
    "text": "all right I think it's time for us to get started thanks for all of you that walked all the way here I know it's a",
    "start": "30",
    "end": "7940"
  },
  {
    "text": "pretty significant walk so it's nice that a with all your other options you decide to come here about container d",
    "start": "7940",
    "end": "15529"
  },
  {
    "text": "I'm going to try and keep the slide portion to a minimum if you are really",
    "start": "15529",
    "end": "21869"
  },
  {
    "text": "interested in a lot more detail on container D architecture and design I'm",
    "start": "21869",
    "end": "27720"
  },
  {
    "text": "going to briefly kind of overview that but I'm going to really focus more on",
    "start": "27720",
    "end": "33090"
  },
  {
    "text": "the Kline API and actually we're going to build a very simple client together and then I'm gonna cheat and jump to",
    "start": "33090",
    "end": "40770"
  },
  {
    "text": "like a more complex client that I'm not going to write live because we don't have a lot of time and we'll kind of",
    "start": "40770",
    "end": "47489"
  },
  {
    "text": "demonstrate some of those capabilities so that's gonna be the focus if you again if you want to hear more about",
    "start": "47489",
    "end": "52739"
  },
  {
    "text": "architecture and design Stephen Day who's here and myself have",
    "start": "52739",
    "end": "58050"
  },
  {
    "text": "given two or three talks over the last few months at least the Moby summit talk",
    "start": "58050",
    "end": "64978"
  },
  {
    "text": "is online so you can find that and kind of get a deeper dive into architecture but again I'm one of the maintainer --zz",
    "start": "64979",
    "end": "74130"
  },
  {
    "text": "we have a couple more maintain errs here we've got maintain errs from the CRI container deep project here so if",
    "start": "74130",
    "end": "81799"
  },
  {
    "text": "everything goes horribly bad up here we can just chat around about container D together but hopefully you'll get",
    "start": "81799",
    "end": "89189"
  },
  {
    "text": "something out of kind of how you can actually use container D in your project for your use case so why did container D",
    "start": "89189",
    "end": "98130"
  },
  {
    "text": "come about Michelle covered a very brief highlight on that earlier in the",
    "start": "98130",
    "end": "104220"
  },
  {
    "text": "keynotes again it came out of this desire across the ecosystem for this",
    "start": "104220",
    "end": "110759"
  },
  {
    "text": "this boring stable infrastructure idea the docker engine obviously grew with a",
    "start": "110759",
    "end": "117210"
  },
  {
    "text": "lot of features and capabilities that wasn't as interesting to the entire ecosystem and so you saw lib container",
    "start": "117210",
    "end": "125280"
  },
  {
    "text": "which was originally part of the docker engine got spun out that's what created the OCI run c and and that work and then",
    "start": "125280",
    "end": "133110"
  },
  {
    "text": "container d was a a lightweight management layer above that that that became as of last",
    "start": "133110",
    "end": "141540"
  },
  {
    "text": "December a much more ambitious project so last December it was announced that",
    "start": "141540",
    "end": "147330"
  },
  {
    "text": "docker would be spinning out container D as a separate project contributing that somewhere in March that somewhere was",
    "start": "147330",
    "end": "153450"
  },
  {
    "text": "announced to be the CNC F at the Berlin Kubb con so again that the intent was",
    "start": "153450",
    "end": "160650"
  },
  {
    "text": "here like Craig son and his tweet let's create some boring core infrastructure that everyone can use usable by any",
    "start": "160650",
    "end": "167760"
  },
  {
    "text": "higher layer container native orchestration piece and then more recently along with that year ago",
    "start": "167760",
    "end": "174300"
  },
  {
    "text": "promise was that the governance model would move away from btfl and so as of a",
    "start": "174300",
    "end": "181230"
  },
  {
    "text": "few weeks ago the mobi technical steering committee has been formed I'm part of that if you want again more",
    "start": "181230",
    "end": "188610"
  },
  {
    "text": "information on that I'm in the middle of writing a blog post about that that should be out soon but again these are",
    "start": "188610",
    "end": "194700"
  },
  {
    "text": "all the pieces boring cork and container infrastructure governance that's open",
    "start": "194700",
    "end": "200300"
  },
  {
    "text": "contributed to CN CF since that's really why we have container D today who's",
    "start": "200300",
    "end": "207000"
  },
  {
    "text": "using it today there are a few kind of core use cases already using it actively",
    "start": "207000",
    "end": "213690"
  },
  {
    "text": "we we've talked to a lot of people who are kind of earlier earlier on which I'm not going to talk about here but",
    "start": "213690",
    "end": "219150"
  },
  {
    "text": "hopefully we'll see this list grow obviously a very important use case is CRI container D implementing that",
    "start": "219150",
    "end": "226080"
  },
  {
    "text": "container runtime interface so kubernetes can use container D as its",
    "start": "226080",
    "end": "231440"
  },
  {
    "text": "couplet runtime Linux get the project out of the the mobi project for a",
    "start": "231440",
    "end": "238500"
  },
  {
    "text": "minimal secure OS image assembler uses container D as its core runtime and",
    "start": "238500",
    "end": "244709"
  },
  {
    "text": "again higher layers can use that so if you build Linux kit build a kubernetes assembly it will actually use container",
    "start": "244709",
    "end": "251970"
  },
  {
    "text": "D as the runtime build kit is a new project there's a great blog post from",
    "start": "251970",
    "end": "257669"
  },
  {
    "text": "Thomas one of the docker engineers who assembled build kit again a container",
    "start": "257669",
    "end": "263820"
  },
  {
    "text": "image construction bill that's separate from docker and can use",
    "start": "263820",
    "end": "269390"
  },
  {
    "text": "container D directly and then obviously the docker engine itself as container D",
    "start": "269390",
    "end": "274970"
  },
  {
    "text": "is moved from that that earlier version into the full 100 versions you'll see 17 dot 12 if you're for",
    "start": "274970",
    "end": "282500"
  },
  {
    "text": "talking docker C II versions and above will be using this container 1o codebase so that's really where you see container",
    "start": "282500",
    "end": "290270"
  },
  {
    "text": "D use today as I said I'm not going to try and unpack this whole architecture",
    "start": "290270",
    "end": "295870"
  },
  {
    "text": "there's a couple things that are important to to say here one is the that",
    "start": "295870",
    "end": "301190"
  },
  {
    "text": "the container D architecture really applies a lot of the learnings from the history of the docker engine all the OCI",
    "start": "301190",
    "end": "308510"
  },
  {
    "text": "work so a lot of the the the concepts used in container D are either hey this",
    "start": "308510",
    "end": "315410"
  },
  {
    "text": "didn't work so well and the early versions of the docker engine let's try and do that better so the snapshot er model is very",
    "start": "315410",
    "end": "323360"
  },
  {
    "text": "powerful the graph drivers were very tangled in with the rest of the engine the snapshot or design is much clearer",
    "start": "323360",
    "end": "329930"
  },
  {
    "text": "again if you want more on that we can provide more resources and then using no good technology again using the OCI",
    "start": "329930",
    "end": "338030"
  },
  {
    "text": "runtime underneath using gr pc exporting metrics with Prometheus and not",
    "start": "338030",
    "end": "344240"
  },
  {
    "text": "opinionated toward a specific platform so docker engine can use it and that it's opinionated kind of capabilities on",
    "start": "344240",
    "end": "350720"
  },
  {
    "text": "top kubernetes can use it but again I'm gonna you know skip over you know a lot",
    "start": "350720",
    "end": "357170"
  },
  {
    "text": "of the detail here then we're going to jump into actually using the API which will bring out some more of these",
    "start": "357170",
    "end": "362930"
  },
  {
    "text": "components in a more you know hands-on fashion the API I think has been kind of",
    "start": "362930",
    "end": "370940"
  },
  {
    "text": "one of the shining examples of what container D has done to apply some of",
    "start": "370940",
    "end": "376400"
  },
  {
    "text": "the learnings of of the earlier runtimes one was to have an API that was simple",
    "start": "376400",
    "end": "381980"
  },
  {
    "text": "and clear had stability guarantees again using G RPC and protobuf you know",
    "start": "381980",
    "end": "387440"
  },
  {
    "text": "versioning we can provide that now so container d1o is out so now the API is",
    "start": "387440",
    "end": "393410"
  },
  {
    "text": "versioned you can guarantee to use that API we have CI tests that make sure it doesn't break and it's also the API uses",
    "start": "393410",
    "end": "400790"
  },
  {
    "text": "a past your model so you know we're not trying to abstract the whole OCI json",
    "start": "400790",
    "end": "407090"
  },
  {
    "text": "configuration so that if it changes then we have to change so it gives our api",
    "start": "407090",
    "end": "413419"
  },
  {
    "text": "more of you know just that lightweight metadata and passing through the OCI config to the OCI runtime and then of",
    "start": "413419",
    "end": "420860"
  },
  {
    "text": "course we have the go doc published which gives you you know a nice way to learn about the api and and will provide",
    "start": "420860",
    "end": "428030"
  },
  {
    "text": "those links as well and a couple you know folk early responses were just you know this is a great API love it clean",
    "start": "428030",
    "end": "435580"
  },
  {
    "text": "you know and that's that's important for what we're trying to accomplish so we",
    "start": "435580",
    "end": "444169"
  },
  {
    "text": "are doing fairly well on time what i'm going to do is switch to an editor that",
    "start": "444169",
    "end": "450470"
  },
  {
    "text": "has a skeleton of what i want to do you can go to this github repository example",
    "start": "450470",
    "end": "458419"
  },
  {
    "text": "CTR under my github ID you can see the finished example there but the part",
    "start": "458419",
    "end": "465860"
  },
  {
    "text": "we're going to code is just quite simple we're going to connect to the daemon we're going to pull an image create a",
    "start": "465860",
    "end": "471229"
  },
  {
    "text": "container and start the task I'm also going to set a namespace again one of",
    "start": "471229",
    "end": "476419"
  },
  {
    "text": "the nice features of container D is namespacing similar to the kubernetes model of you know when I set my",
    "start": "476419",
    "end": "483590"
  },
  {
    "text": "namespace now I only see resources associated with that namespace so let's",
    "start": "483590",
    "end": "489889"
  },
  {
    "text": "try this out so here I've is the func",
    "start": "489889",
    "end": "495229"
  },
  {
    "text": "gonna be okay for folks in the back alright if not there are some seats",
    "start": "495229",
    "end": "503210"
  },
  {
    "text": "further forward what I'm going to do first of all is we're gonna have to",
    "start": "503210",
    "end": "508969"
  },
  {
    "text": "connect to the UNIX socket where container D is listening so I'm just going to set that as a a console run",
    "start": "508969",
    "end": "517550"
  },
  {
    "text": "container d container D sock is going to be my default address I'm gonna set a a",
    "start": "517550",
    "end": "525610"
  },
  {
    "text": "default image that I'm going to pull and run again container d is not opinionated",
    "start": "525610",
    "end": "534260"
  },
  {
    "text": "so it's not going to in docker hub or the tag so I have to provide all of that so I'm going to talk",
    "start": "534260",
    "end": "540260"
  },
  {
    "text": "to dr. hub one of the library image images I'm going to run the Redis Alpine",
    "start": "540260",
    "end": "546800"
  },
  {
    "text": "tag so those are just some defaults that'll help me out to connect to the",
    "start": "546800",
    "end": "553550"
  },
  {
    "text": "daemon very simply I provided the address so that's the address I'm going",
    "start": "553550",
    "end": "559010"
  },
  {
    "text": "to connect to that's going to return to me a client and he wants to see me put",
    "start": "559010",
    "end": "570290"
  },
  {
    "text": "in error handling on every single call that'll be fun right yeah I taught you",
    "start": "570290",
    "end": "578870"
  },
  {
    "text": "exactly if you're cutting go it it's painful to skip this so we'll do that I",
    "start": "578870",
    "end": "584480"
  },
  {
    "text": "couldn't connect and here's my error and",
    "start": "584480",
    "end": "593510"
  },
  {
    "text": "will go away so that's all we had to do to connect a container d fairly",
    "start": "593510",
    "end": "599150"
  },
  {
    "text": "straightforward I now want to set a namespace I need another import for that from the",
    "start": "599150",
    "end": "607390"
  },
  {
    "text": "namespaces package and so namespaces",
    "start": "607390",
    "end": "618320"
  },
  {
    "text": "with namespace will do contacts",
    "start": "618320",
    "end": "623600"
  },
  {
    "text": "background and let's just call it example CTR and that will return the",
    "start": "623600",
    "end": "632030"
  },
  {
    "text": "context that I'm now going to use for all the rest of the API calls so at this",
    "start": "632030",
    "end": "638300"
  },
  {
    "text": "point I want to pull this image that I've already talked about one of the things I'll do with my client is I'm",
    "start": "638300",
    "end": "644750"
  },
  {
    "text": "first going to say get image with this context the the name of the image the",
    "start": "644750",
    "end": "651620"
  },
  {
    "text": "reference to it because it's possible in this namespace I've already pulled the",
    "start": "651620",
    "end": "658250"
  },
  {
    "text": "image so this obviously won't talk to doc rub and pull the layers and manifest",
    "start": "658250",
    "end": "664780"
  },
  {
    "text": "I'm going to cheat a little bit and just a assume that if I get an error it means",
    "start": "664780",
    "end": "670420"
  },
  {
    "text": "it's not pulled so I'll actually do pull",
    "start": "670420",
    "end": "676480"
  },
  {
    "text": "image again fairly straightforward I'm going to pull that image and I'm going",
    "start": "676480",
    "end": "684970"
  },
  {
    "text": "to provide a with with pull unpack which",
    "start": "684970",
    "end": "698050"
  },
  {
    "text": "means that container D the snapshot R is going to unpack these layers of my image",
    "start": "698050",
    "end": "705089"
  },
  {
    "text": "if I get an error at this point we're probably enough to just get out of here because that means I couldn't even get",
    "start": "705089",
    "end": "711940"
  },
  {
    "text": "the image couldn't pull image and the",
    "start": "711940",
    "end": "717040"
  },
  {
    "text": "error so at this point I've connected to my client I've set my namespace",
    "start": "717040",
    "end": "722470"
  },
  {
    "text": "I pulled an image the next thing I want to do is create a container and this",
    "start": "722470",
    "end": "729459"
  },
  {
    "text": "again is fairly straightforward context kind of a container ID I'll call it",
    "start": "729459",
    "end": "736089"
  },
  {
    "text": "example CTR now the interesting thing is I am a set of if you look in the go dock",
    "start": "736089",
    "end": "742300"
  },
  {
    "text": "you'll find a bunch of kind of with helpers container D width and one of the",
    "start": "742300",
    "end": "747520"
  },
  {
    "text": "things we're going to want is a snapshot",
    "start": "747520",
    "end": "754470"
  },
  {
    "text": "I'm sorry with new snapshot so that means that now my image is unpacked in",
    "start": "754470",
    "end": "761290"
  },
  {
    "text": "the snapshot driver in this case the overlay so if use docker graph driver the overlay - driver that's your default",
    "start": "761290",
    "end": "767620"
  },
  {
    "text": "in container D so now I'm saying my root filesystem I want that to be based on a",
    "start": "767620",
    "end": "773829"
  },
  {
    "text": "new snapshot that I'm going to call example CTR and the parent will be this",
    "start": "773829",
    "end": "781450"
  },
  {
    "text": "image that I've that I've just pulled",
    "start": "781450",
    "end": "785670"
  },
  {
    "text": "the next thing I need to do so if you've if you've looked at run C or the OCR",
    "start": "786779",
    "end": "792070"
  },
  {
    "text": "runtime spec you know that to run a container I need two pieces of information I've now provided kind of",
    "start": "792070",
    "end": "799270"
  },
  {
    "text": "this root filesystem with a snapshot or I also need a OCR runtime config that's",
    "start": "799270",
    "end": "804550"
  },
  {
    "text": "the JSON file that has you know what what program is gonna be run what namespaces Linux kernel namespaces I'm",
    "start": "804550",
    "end": "811779"
  },
  {
    "text": "gonna isolate in all those settings are within the OCI config that's bound up in",
    "start": "811779",
    "end": "817510"
  },
  {
    "text": "the image so there's a nice helper that I can use to I'm sorry I actually need",
    "start": "817510",
    "end": "824020"
  },
  {
    "text": "the OCI package here because we're going",
    "start": "824020",
    "end": "829390"
  },
  {
    "text": "to basically say OCI with image config and not make any modifications to it and",
    "start": "829390",
    "end": "838089"
  },
  {
    "text": "so we'll just be this Redis Alpine image already says you know it's configuration",
    "start": "838089",
    "end": "844000"
  },
  {
    "text": "is in in its image so let's do with",
    "start": "844000",
    "end": "850529"
  },
  {
    "text": "actually I need to tell container D I want a new spec and here's where I'm",
    "start": "850529",
    "end": "858880"
  },
  {
    "text": "using the OCI in a width image config",
    "start": "858880",
    "end": "867640"
  },
  {
    "text": "and the image who thinks that's right Oh",
    "start": "867640",
    "end": "876029"
  },
  {
    "text": "yep thank you yeah see this is fun isn't",
    "start": "878550",
    "end": "889540"
  },
  {
    "text": "it if you want to see this done well look at any Liz Rice talk on YouTube",
    "start": "889540",
    "end": "894790"
  },
  {
    "text": "this is my Liz Rice impersonation talk [Music]",
    "start": "894790",
    "end": "901500"
  },
  {
    "text": "alright so a new container with new",
    "start": "901500",
    "end": "907720"
  },
  {
    "text": "snapshot with new spec OCI width image",
    "start": "907720",
    "end": "912760"
  },
  {
    "text": "config and what do I still have wrong",
    "start": "912760",
    "end": "919740"
  },
  {
    "text": "yep okay well that was a little more fun",
    "start": "923870",
    "end": "929640"
  },
  {
    "text": "what in the world just happened there I think I did a yeah there we go so we",
    "start": "929640",
    "end": "937920"
  },
  {
    "text": "have a container that was a little more exciting but at this point we do",
    "start": "937920",
    "end": "944460"
  },
  {
    "text": "obviously we don't have a task we don't have a runnings there this is just the the metadata is now set up let's make",
    "start": "944460",
    "end": "955320"
  },
  {
    "text": "sure we have a reasonable container object before we go on alright so at",
    "start": "955320",
    "end": "968400"
  },
  {
    "text": "this point we have the container at this",
    "start": "968400",
    "end": "974070"
  },
  {
    "text": "point we are going to use that container to create a task and this is a fairly",
    "start": "974070",
    "end": "979770"
  },
  {
    "text": "straightforward I'm going to create it so I don't care about the output so",
    "start": "979770",
    "end": "984890"
  },
  {
    "text": "again we need a new package CIO is contain it's not about the the person in",
    "start": "984890",
    "end": "993180"
  },
  {
    "text": "your company the chief information officer it's about container DS i/o and",
    "start": "993180",
    "end": "999210"
  },
  {
    "text": "so when I create this task I'm basically saying I don't care about standard in standard error standard out just get rid",
    "start": "999210",
    "end": "1005690"
  },
  {
    "text": "of it for me pipe it to Devon ole this will create a task object and good in",
    "start": "1005690",
    "end": "1019970"
  },
  {
    "text": "create task so we have one step left we",
    "start": "1019970",
    "end": "1029120"
  },
  {
    "text": "are actually going to start this task and this doesn't require anything other",
    "start": "1029120",
    "end": "1034430"
  },
  {
    "text": "than the context and we're just going to",
    "start": "1034430",
    "end": "1041180"
  },
  {
    "text": "check and make sure that it actually started",
    "start": "1041180",
    "end": "1046449"
  },
  {
    "text": "and couldn't start tasks and actually we",
    "start": "1049630",
    "end": "1062630"
  },
  {
    "text": "should really delete the tasks and we should really delete the container at",
    "start": "1062630",
    "end": "1070549"
  },
  {
    "text": "this point that makes it easier we can obviously go this one I always forget",
    "start": "1070549",
    "end": "1077570"
  },
  {
    "text": "with snapshot cleanup yes so that means",
    "start": "1077570",
    "end": "1083149"
  },
  {
    "text": "that that root file system I assembled will actually get cleaned up and deleted",
    "start": "1083149",
    "end": "1088279"
  },
  {
    "text": "so I don't have to use the snapshot tooling to go do that and I really",
    "start": "1088279",
    "end": "1094399"
  },
  {
    "text": "should have done this as well here just",
    "start": "1094399",
    "end": "1100809"
  },
  {
    "text": "to make it cleaner alright so in you",
    "start": "1100809",
    "end": "1106010"
  },
  {
    "text": "know sixty lines of code we've connected to container D we've set up a namespace",
    "start": "1106010",
    "end": "1111980"
  },
  {
    "text": "pulled an image create a container created a task and started it who",
    "start": "1111980",
    "end": "1118880"
  },
  {
    "text": "believes this will actually run any votes all right all right so I called",
    "start": "1118880",
    "end": "1129380"
  },
  {
    "text": "this file skeleton go I've already vendored in everything into into this project again you can see this",
    "start": "1129380",
    "end": "1136610"
  },
  {
    "text": "on github under examples CTR dot go I didn't want to check in the blank skeleton so I just created that for this",
    "start": "1136610",
    "end": "1144130"
  },
  {
    "text": "alright that's built you can see I already have container D running here",
    "start": "1144130",
    "end": "1149809"
  },
  {
    "text": "this is version one o that we just released a few days ago I'm sooo doing",
    "start": "1149809",
    "end": "1155870"
  },
  {
    "text": "because I need to talk to container DS socket daemon socket which is protected by root alright obviously we didn't",
    "start": "1155870",
    "end": "1165980"
  },
  {
    "text": "output anything because we we know all the information but we should have a started container",
    "start": "1165980",
    "end": "1173500"
  },
  {
    "text": "sure enough example CTR if you wonder why I didn't have to say anything about",
    "start": "1173500",
    "end": "1179450"
  },
  {
    "text": "the namespace I've already put that in a variable in my environment so container",
    "start": "1179450",
    "end": "1184750"
  },
  {
    "text": "D underscore namespace I didn't have to type I could have type - namespace example CTR and seen the same container",
    "start": "1184750",
    "end": "1193480"
  },
  {
    "text": "it's running the Redis Alpine image if we look at tasks we should actually see",
    "start": "1193480",
    "end": "1199330"
  },
  {
    "text": "that there's one running if we PS on this system you'll see that Redis server",
    "start": "1199330",
    "end": "1205900"
  },
  {
    "text": "is actually running ok so we wrote a container D simple client it actually",
    "start": "1205900",
    "end": "1211420"
  },
  {
    "text": "worked it started a container hopefully you see again just the simplicity of the",
    "start": "1211420",
    "end": "1217300"
  },
  {
    "text": "API and how simple it was to assemble that quickly I'm going to stop the task",
    "start": "1217300",
    "end": "1223540"
  },
  {
    "text": "with the seat again CTR is a simple command-line tool it's not really something we officially see as part of",
    "start": "1223540",
    "end": "1230140"
  },
  {
    "text": "the container D promises about stability but obviously for administrative tasks",
    "start": "1230140",
    "end": "1236380"
  },
  {
    "text": "it's quite easy to use so again I can stop my Retta server so I can kill my",
    "start": "1236380",
    "end": "1246550"
  },
  {
    "text": "read a server task and I can remove that",
    "start": "1246550",
    "end": "1251560"
  },
  {
    "text": "container and you can see that it's gone",
    "start": "1251560",
    "end": "1256170"
  },
  {
    "text": "let's go back to the slides for just a second because I have an advanced",
    "start": "1256800",
    "end": "1262720"
  },
  {
    "text": "example that as I mentioned I'm not going to have time to you know add these",
    "start": "1262720",
    "end": "1268120"
  },
  {
    "text": "other API calls so I've I've done it for you we'll look at the code and then we'll then we'll run it but we added",
    "start": "1268120",
    "end": "1274060"
  },
  {
    "text": "some more concepts to the container D client if you know that I've worked on",
    "start": "1274060",
    "end": "1279130"
  },
  {
    "text": "user namespaces and various container runtime contacts you're not going to get",
    "start": "1279130",
    "end": "1284440"
  },
  {
    "text": "out of here without a user name space example so I've added that too to this",
    "start": "1284440",
    "end": "1290250"
  },
  {
    "text": "to this example I've also added a with helper in my own code so again we use",
    "start": "1290250",
    "end": "1295960"
  },
  {
    "text": "some with helpers that container D provided us now I'm going to add my own with helper to do a bind mount for my",
    "start": "1295960",
    "end": "1302260"
  },
  {
    "text": "host and then we can also do things like an optional custom command to override",
    "start": "1302260",
    "end": "1307870"
  },
  {
    "text": "the image config so you know if you do docker run and some image and a command it runs that command instead of",
    "start": "1307870",
    "end": "1315980"
  },
  {
    "text": "the default went in the image so we've added that to this example so let's go",
    "start": "1315980",
    "end": "1322790"
  },
  {
    "text": "back to our editor let's look at advanced I'll try and skip over the this",
    "start": "1322790",
    "end": "1329179"
  },
  {
    "text": "is the ugliness that gets produced when you don't use a flagged parsing library",
    "start": "1329179",
    "end": "1334400"
  },
  {
    "text": "I thought it would be easy and then it got really ugly so don't follow this example use a nice to e library for that",
    "start": "1334400",
    "end": "1344769"
  },
  {
    "text": "what I've done is I've basically said when you call my example CTR now you're",
    "start": "1344860",
    "end": "1350929"
  },
  {
    "text": "going to provide a username I'm going to look up to see if that username has any",
    "start": "1350929",
    "end": "1356630"
  },
  {
    "text": "sub u IDs and G IDs so if you know anything about user name spaces that'll",
    "start": "1356630",
    "end": "1361820"
  },
  {
    "text": "give me some ranges that I can then that I can then apply to the Container config",
    "start": "1361820",
    "end": "1367059"
  },
  {
    "text": "and then obviously I've let you specify an image and a command you can see here",
    "start": "1367059",
    "end": "1375110"
  },
  {
    "text": "I'm using a package that i just copied over from the mobi project that I wrote",
    "start": "1375110",
    "end": "1380960"
  },
  {
    "text": "when I originally did user name spaces so the ID tools new ID mappings just",
    "start": "1380960",
    "end": "1386720"
  },
  {
    "text": "does that look into sub UID and sub GID and gives me those mappings a bunch of",
    "start": "1386720",
    "end": "1393140"
  },
  {
    "text": "this is the same obviously connecting setting my namespace I've created a",
    "start": "1393140",
    "end": "1398179"
  },
  {
    "text": "small object so I can have this run container function and not have to pass",
    "start": "1398179",
    "end": "1403580"
  },
  {
    "text": "around all the client and context but you can see the same things are happening getting an image pulling an",
    "start": "1403580",
    "end": "1410210"
  },
  {
    "text": "image creating a container creating a task creating a task got a little more",
    "start": "1410210",
    "end": "1416290"
  },
  {
    "text": "interesting because now I actually want to modify the OCI config to add in the",
    "start": "1416290",
    "end": "1423080"
  },
  {
    "text": "user name space configuration actually in this case sorry the task I need to",
    "start": "1423080",
    "end": "1428870"
  },
  {
    "text": "tell run see by the way don't don't make the iOS owned by root or else you know",
    "start": "1428870",
    "end": "1435290"
  },
  {
    "text": "my user name space process won't be able to read that we'll look at new container",
    "start": "1435290",
    "end": "1440390"
  },
  {
    "text": "which actually does the other thing I was about to to mention but once we've done that all we're doing is creating",
    "start": "1440390",
    "end": "1446120"
  },
  {
    "text": "the task and checking for exits at us because now if you give me a",
    "start": "1446120",
    "end": "1451560"
  },
  {
    "text": "custom command I want to know that it actually ran and give you the output so again this client is is a little more",
    "start": "1451560",
    "end": "1458150"
  },
  {
    "text": "involved here's the part I meant to talk about so here from line 175 to and below",
    "start": "1458150",
    "end": "1467670"
  },
  {
    "text": "I'm actually saying did I find some ID mappings for this user okay if so let me",
    "start": "1467670",
    "end": "1473820"
  },
  {
    "text": "grab those maps and pass it in to the OCI helper with user name space and so",
    "start": "1473820",
    "end": "1481740"
  },
  {
    "text": "again at this point I'm modifying that images default OCI config to add the",
    "start": "1481740",
    "end": "1487650"
  },
  {
    "text": "user name space options and then again",
    "start": "1487650",
    "end": "1493230"
  },
  {
    "text": "we passed that spec on and actually create the container the same way we did before alright so hopefully that wasn't",
    "start": "1493230",
    "end": "1500610"
  },
  {
    "text": "too too much of a whirlwind tour through that again this is all in that github",
    "start": "1500610",
    "end": "1505800"
  },
  {
    "text": "project so you can look at this at your own leisure I've already built this",
    "start": "1505800",
    "end": "1513260"
  },
  {
    "text": "example ctr2 I've called an example ctr2 here again I need to sudo that estes P",
    "start": "1513260",
    "end": "1526230"
  },
  {
    "text": "is my local user I know I have UID maps already on this system for that I can",
    "start": "1526230",
    "end": "1532910"
  },
  {
    "text": "provide let's just run Alpine latest and",
    "start": "1532910",
    "end": "1538340"
  },
  {
    "text": "we can do actually let's run it like this first because I mean it we you can",
    "start": "1538340",
    "end": "1544800"
  },
  {
    "text": "actually we can verify that it's running in a user name space so let's try this",
    "start": "1544800",
    "end": "1549840"
  },
  {
    "text": "out oh yeah how fun latest isn't pulled so it's",
    "start": "1549840",
    "end": "1556020"
  },
  {
    "text": "actually pulling out pine latest over conference Wi-Fi which shouldn't take too long yes I am a gambler images LS it",
    "start": "1556020",
    "end": "1572370"
  },
  {
    "text": "looks like it's there so whoa",
    "start": "1572370",
    "end": "1579890"
  },
  {
    "text": "oh you know what don't pay attention to",
    "start": "1580230",
    "end": "1586590"
  },
  {
    "text": "any of this yes you'll find out in a",
    "start": "1586590",
    "end": "1594510"
  },
  {
    "text": "minute why well I had to do this but this container D path was modified",
    "start": "1594510",
    "end": "1604640"
  },
  {
    "text": "because in a minute I'm going to run this inside Linux kit hopefully we're going to have time to wrap that up and I",
    "start": "1604640",
    "end": "1613080"
  },
  {
    "text": "had to run a separate container D because we're working on a bug with username spaces inside Linux kit so I",
    "start": "1613080",
    "end": "1618390"
  },
  {
    "text": "had to point it at a different so let's try this again alright so now we have a running",
    "start": "1618390",
    "end": "1626220"
  },
  {
    "text": "container if I look at the task there's it's pid' if I grep three one six nine",
    "start": "1626220",
    "end": "1633450"
  },
  {
    "text": "eight out of ox you can see that UID 100,000 is running the shell in this",
    "start": "1633450",
    "end": "1640530"
  },
  {
    "text": "alpine container okay so simple enough we now ran a container with user name spaces using my",
    "start": "1640530",
    "end": "1647010"
  },
  {
    "text": "advanced quote unquote advance client and that was easy enough let's actually",
    "start": "1647010",
    "end": "1655700"
  },
  {
    "text": "get rid of this task and delete the",
    "start": "1655700",
    "end": "1664650"
  },
  {
    "text": "container as you can see I also added something to the ID so I can run more",
    "start": "1664650",
    "end": "1670380"
  },
  {
    "text": "than one container and not clash on the name that's just the pit of the example",
    "start": "1670380",
    "end": "1675780"
  },
  {
    "text": "CTR so the other thing I talked about let's look back at the editor for a",
    "start": "1675780",
    "end": "1682260"
  },
  {
    "text": "second I have a utils program utils it",
    "start": "1682260",
    "end": "1691260"
  },
  {
    "text": "has a couple more tools you could build out your client a little more with stop delete so again you don't have to use",
    "start": "1691260",
    "end": "1697290"
  },
  {
    "text": "the CTR to low for that but here I've added with mounts and the way I've done",
    "start": "1697290",
    "end": "1703500"
  },
  {
    "text": "this just for demo purposes has actually looked for a file in the local directory called mounts I expect the inside it",
    "start": "1703500",
    "end": "1710970"
  },
  {
    "text": "I'll have a target the type of mount like mind and the destination and then I'll",
    "start": "1710970",
    "end": "1717750"
  },
  {
    "text": "basically modify the OCI spec so you can see at the end here I'm appending a new",
    "start": "1717750",
    "end": "1722880"
  },
  {
    "text": "mount to the specs mount so this is my own with mounts helper that I've created",
    "start": "1722880",
    "end": "1727950"
  },
  {
    "text": "so now my client has the ability to do mounts and let's just actually I think I",
    "start": "1727950",
    "end": "1737040"
  },
  {
    "text": "already had a mounts file here in the local directory I'm gonna mount Etsy",
    "start": "1737040",
    "end": "1742380"
  },
  {
    "text": "host bind mount that lets let's do something more interesting let's just",
    "start": "1742380",
    "end": "1754920"
  },
  {
    "text": "mount that over home in Alpine so you can make sure that it works and so at",
    "start": "1754920",
    "end": "1760620"
  },
  {
    "text": "this point if I do LS home with this mounts file nope yeah so estes p was",
    "start": "1760620",
    "end": "1770850"
  },
  {
    "text": "actually mounted in there let's do home SSP and there's a couple files that are",
    "start": "1770850",
    "end": "1778020"
  },
  {
    "text": "readable to the user namespace so again it's not showing a ton of content in there but our filename fred was located",
    "start": "1778020",
    "end": "1785160"
  },
  {
    "text": "in that folder but the problem is when i'm doing this one of the one of the",
    "start": "1785160",
    "end": "1792120"
  },
  {
    "text": "trickiest problems with user name spaces is that because my process is running as",
    "start": "1792120",
    "end": "1797730"
  },
  {
    "text": "an unprivileged user usually the volume i'm mounting you know doesn't have the",
    "start": "1797730",
    "end": "1803550"
  },
  {
    "text": "right permissions and now if i run multiple containers with different mappings I can't",
    "start": "1803550",
    "end": "1809460"
  },
  {
    "text": "you know actually come up with a with privileges and and permissions that make",
    "start": "1809460",
    "end": "1815430"
  },
  {
    "text": "sense and that's pretty frustrating to a lot of user name space interested parties who want to use it in a broader",
    "start": "1815430",
    "end": "1821490"
  },
  {
    "text": "way and so what I'd like to kind of finish with is that",
    "start": "1821490",
    "end": "1827180"
  },
  {
    "text": "Linna skit is an interesting way to try out new features in the Linux kernel",
    "start": "1827180",
    "end": "1832380"
  },
  {
    "text": "that's one use case of many and so there is a shift FS patch set that is",
    "start": "1832380",
    "end": "1839400"
  },
  {
    "text": "attempting to solve this this problem of mounts inside a user name space and so",
    "start": "1839400",
    "end": "1846750"
  },
  {
    "text": "what I've done is I've already I've already created a",
    "start": "1846750",
    "end": "1852789"
  },
  {
    "text": "Linux kit assembly again if you look in my github project I don't have time at this point to to go through that you'll",
    "start": "1852789",
    "end": "1860019"
  },
  {
    "text": "see you'll see the Linux kid directory",
    "start": "1860019",
    "end": "1866769"
  },
  {
    "text": "and you'll see a yamo file in there called shift FS and that's what that's what's being used to build this Linux",
    "start": "1866769",
    "end": "1873159"
  },
  {
    "text": "image there's also scripts to build that there here you can see I'm running Linux kit",
    "start": "1873159",
    "end": "1878169"
  },
  {
    "text": "as I said I'm already running my my own container container d here that example",
    "start": "1878169",
    "end": "1886360"
  },
  {
    "text": "CTR is using so if I run example CTR 2",
    "start": "1886360",
    "end": "1892360"
  },
  {
    "text": "here if you look in that yamo file I created two users Bob and Alice they have different they have different UID",
    "start": "1892360",
    "end": "1901389"
  },
  {
    "text": "mappings so if I run a container for Bob",
    "start": "1901389",
    "end": "1907470"
  },
  {
    "text": "we should see a container was created and if we look at that one kid 1094 it's",
    "start": "1908279",
    "end": "1919539"
  },
  {
    "text": "running as UID 100,000 if we look at sub UID we can see that's Bob's range if I",
    "start": "1919539",
    "end": "1929919"
  },
  {
    "text": "go over here and run another one with Alice and I now have this other",
    "start": "1929919",
    "end": "1942659"
  },
  {
    "text": "container running with pid' 1170 you can",
    "start": "1942659",
    "end": "1948220"
  },
  {
    "text": "see that's running with UID 200,000 now what if I mount the same volume into",
    "start": "1948220",
    "end": "1953230"
  },
  {
    "text": "each of their containers or bind mount a director from the host they're not going",
    "start": "1953230",
    "end": "1958870"
  },
  {
    "text": "to have permissions to access that I was going to show both modes where I couldn't have access and where I could",
    "start": "1958870",
    "end": "1965889"
  },
  {
    "text": "but we're running out of time pretty quickly so let me kill these these tasks",
    "start": "1965889",
    "end": "1973620"
  },
  {
    "text": "if you'll give me a minute to type",
    "start": "1973620",
    "end": "1977850"
  },
  {
    "text": "and just remove the containers just to make the output clear when we start the",
    "start": "1978880",
    "end": "1984970"
  },
  {
    "text": "other ones linux kid isn't being friendly to my output here but that's",
    "start": "1984970",
    "end": "1991510"
  },
  {
    "text": "fine so at this point I should have no containers running as I said the example",
    "start": "1991510",
    "end": "1997990"
  },
  {
    "text": "ctr2 looks for a mounts file so if I do mounts shift FS and copy that here to",
    "start": "1997990",
    "end": "2006330"
  },
  {
    "text": "where I'm going to run it and we look at this this file you can see it's going to",
    "start": "2006330",
    "end": "2014760"
  },
  {
    "text": "take home from there var external volume again this is inside mail in escape VM",
    "start": "2014760",
    "end": "2021830"
  },
  {
    "text": "use the shift FS driver that I built into Linux kit and mount that on home in",
    "start": "2021830",
    "end": "2027030"
  },
  {
    "text": "the container so now if we start Bob's container and we start Alice's container",
    "start": "2027030",
    "end": "2039450"
  },
  {
    "text": "from here we have both of them running",
    "start": "2039450",
    "end": "2045950"
  },
  {
    "text": "I've got a simple script so I don't have to type the whole command but if I go if",
    "start": "2045950",
    "end": "2052500"
  },
  {
    "text": "I exact into those containers so I'm going to go into I think this is Bob's",
    "start": "2052500",
    "end": "2057600"
  },
  {
    "text": "the first one I started and I look at home it's empty right now but if I touch",
    "start": "2057600",
    "end": "2065790"
  },
  {
    "text": "a file I can actually I can do that and",
    "start": "2065790",
    "end": "2071490"
  },
  {
    "text": "it actually looks like it's owned by root here we'll go obviously we can go out into our external home sorry",
    "start": "2071490",
    "end": "2082260"
  },
  {
    "text": "external volume and we can see that that was actually created with UID 100,000",
    "start": "2082260",
    "end": "2088530"
  },
  {
    "text": "100,000 which is Bob's ID within the container obviously we can do the same",
    "start": "2088530",
    "end": "2094110"
  },
  {
    "text": "thing in Alice's container let's look 1404 as I'm running out of",
    "start": "2094110",
    "end": "2105000"
  },
  {
    "text": "time my typing is getting worse and worse so we can actually see Fred but",
    "start": "2105000",
    "end": "2110370"
  },
  {
    "text": "he's he doesn't match any ID in our can tainer so he's assigned the nobody user I'm gonna touch Allison here was I in",
    "start": "2110370",
    "end": "2123239"
  },
  {
    "text": "home let's do it again and if we go back",
    "start": "2123239",
    "end": "2128549"
  },
  {
    "text": "to our external volume we can see that that was created with two hundred thousand two hundred thousand so again",
    "start": "2128549",
    "end": "2134640"
  },
  {
    "text": "I've had to rush through this part because we're basically out of time but again shift FS is giving us a way to do",
    "start": "2134640",
    "end": "2141239"
  },
  {
    "text": "that without being blocked by the permissions shift FS needs more work upstream but Linda's kit gives us an",
    "start": "2141239",
    "end": "2147869"
  },
  {
    "text": "easy way to play with those features and with my container D client I can actually try out those features so a few",
    "start": "2147869",
    "end": "2156269"
  },
  {
    "text": "final slides there are some resources here I'll post these slides and as soon as we're out of this talk if you want to",
    "start": "2156269",
    "end": "2163920"
  },
  {
    "text": "see more interesting uses of the API beyond kind of what I've just showed you look at CRI container D you can look at",
    "start": "2163920",
    "end": "2171239"
  },
  {
    "text": "my bucket bench project which has the container D driver using the same API you can look at Lib container D in the",
    "start": "2171239",
    "end": "2177900"
  },
  {
    "text": "mobi project these are all users of the API obviously above here the getting",
    "start": "2177900",
    "end": "2184170"
  },
  {
    "text": "started guide and the go doc are also great resources so with that I think I",
    "start": "2184170",
    "end": "2189329"
  },
  {
    "text": "am more than over with time so thank you very much for your attention and time thanks",
    "start": "2189329",
    "end": "2195290"
  },
  {
    "text": "[Applause]",
    "start": "2195290",
    "end": "2200989"
  }
]