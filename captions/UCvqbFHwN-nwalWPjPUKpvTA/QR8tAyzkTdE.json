[
  {
    "start": "0",
    "end": "51000"
  },
  {
    "text": "I think we're about ready to get going here I think we realized while we were sitting here talking that this says go",
    "start": "0",
    "end": "6210"
  },
  {
    "text": "AI but this is not a go language AI so if there's anybody who would like to change their minds this is probably a",
    "start": "6210",
    "end": "12690"
  },
  {
    "text": "good time No all right that's great um well I'm Andrew Jackson and seated here is Josh",
    "start": "12690",
    "end": "19470"
  },
  {
    "text": "I'm Josh hook I'm a software engineer at Google I work on intelligent devices and",
    "start": "19470",
    "end": "24920"
  },
  {
    "text": "I'm also a software engineer at Google I work on gke readies engine I join me up",
    "start": "24920",
    "end": "30420"
  },
  {
    "text": "here spy that's right all right well",
    "start": "30420",
    "end": "37110"
  },
  {
    "text": "thank you for coming to our talk here about mini go which is about making a go AI using tensorflow and kubernetes and",
    "start": "37110",
    "end": "44120"
  },
  {
    "text": "our clicker is no longer clicking that's cool oh no that's okay",
    "start": "44120",
    "end": "51300"
  },
  {
    "start": "51000",
    "end": "147000"
  },
  {
    "text": "all right so for starters what is mini go mini go is an open-source implementation of the alphago zero",
    "start": "51300",
    "end": "58890"
  },
  {
    "text": "algorithm described in a couple of papers by deep mind so if you've heard",
    "start": "58890",
    "end": "64650"
  },
  {
    "text": "quick show of hands how many people have heard of alphago now for those Eero all right this is not alphago this is an",
    "start": "64650",
    "end": "69930"
  },
  {
    "text": "implementation of alphago from their papers a ground-up open-source rewrite that you can find at github under the",
    "start": "69930",
    "end": "76470"
  },
  {
    "text": "tensorflow repository under a min ago and so that's what it is what drove us",
    "start": "76470",
    "end": "84150"
  },
  {
    "text": "to write mini go was because we're go players i've been a go player for most of my adult life I've worked as a",
    "start": "84150",
    "end": "91530"
  },
  {
    "text": "volunteer for the American NGO Association I could go for ten years let me go book that's actually how I started programming was I made Python scripts",
    "start": "91530",
    "end": "98250"
  },
  {
    "text": "the exact books so we're both big go players and after the alphago launched",
    "start": "98250",
    "end": "103740"
  },
  {
    "text": "debut publication whatever you want to call it they we figured there was still a lot to do here and we really wanted to",
    "start": "103740",
    "end": "109320"
  },
  {
    "text": "see some open-source implementation of this algorithm and an open-source",
    "start": "109320",
    "end": "114450"
  },
  {
    "text": "version of this model that we could explore and learn with and there's a lot of stuff there so I'm not a machine",
    "start": "114450",
    "end": "121110"
  },
  {
    "text": "learning expert and neither his job certainly not so Mego has been a good project for us",
    "start": "121110",
    "end": "126210"
  },
  {
    "text": "to sort of learn this stuff and it's also been an excellent way for us to get acquainted with all these things tensorflow",
    "start": "126210",
    "end": "131270"
  },
  {
    "text": "kind of thought that this was a pretty good project as far demonstrating how tensorflow works and the code is pretty small and",
    "start": "131270",
    "end": "137160"
  },
  {
    "text": "approachable so we hope that if you do decide to check this out and learn more about go or learn more about machine",
    "start": "137160",
    "end": "142739"
  },
  {
    "text": "learning intensive flow that you find the code to be clean and easy to work with so let's go back a little bit what",
    "start": "142739",
    "end": "150060"
  },
  {
    "start": "147000",
    "end": "199000"
  },
  {
    "text": "did we build mini go on top of so the first paper the first half ago paper mastering the games go with deep neural",
    "start": "150060",
    "end": "156510"
  },
  {
    "text": "networks and tree search a friend of mine named Brian Lee wrote an implementation of that paper he wrote",
    "start": "156510",
    "end": "162660"
  },
  {
    "text": "sort of a skeleton implementation of it just the policy outputs it was called new go and you can see me go since",
    "start": "162660",
    "end": "168780"
  },
  {
    "text": "writing mugo brian has gone on to work for verily which is another alphabet company melton boston but since he's a",
    "start": "168780",
    "end": "175769"
  },
  {
    "text": "go player you know i knew him as a go player and was able to look at me bill and say well this is a great clean",
    "start": "175769",
    "end": "181380"
  },
  {
    "text": "implementation of the first paper i can probably use that to build on the second paper which describe the alphago zero",
    "start": "181380",
    "end": "188069"
  },
  {
    "text": "algorithm and really sure what the difference between alphago and alphago zero is that alphago zero had no human",
    "start": "188069",
    "end": "193860"
  },
  {
    "text": "input it basically started from random noise and was able to teach itself how to play go so you had those two things",
    "start": "193860",
    "end": "199950"
  },
  {
    "start": "199000",
    "end": "247000"
  },
  {
    "text": "together we have mini go this is if you're like why is that a robot falling off of a ladder don't worry we will",
    "start": "199950",
    "end": "205440"
  },
  {
    "text": "explain it it'll all become clear so your go player if you go player you the ladder is symbolic do we have any good",
    "start": "205440",
    "end": "210510"
  },
  {
    "text": "players out there go players I see a couple ants okay so you're at understand why there's a robot falling off the",
    "start": "210510",
    "end": "216000"
  },
  {
    "text": "ladder will get there though everybody will get that in a second so so this is a great demonstration of using",
    "start": "216000",
    "end": "221220"
  },
  {
    "text": "tensorflow and kubernetes this is a 20% project that we started sort of in our spare time as go players and enthusiasts",
    "start": "221220",
    "end": "228030"
  },
  {
    "text": "and one of the things that we needed to do was we had very few developer resources by which I mean other",
    "start": "228030",
    "end": "234420"
  },
  {
    "text": "enthusiasts go players who wanted to work on this project and we really needed to sort of leverage our time and",
    "start": "234420",
    "end": "240120"
  },
  {
    "text": "be able to you know spend our time writing code and not a lot of our time writing infrastructure doing a lot of",
    "start": "240120",
    "end": "245730"
  },
  {
    "text": "that build-out so that's sort of our motivation here and to get to the point",
    "start": "245730",
    "end": "252420"
  },
  {
    "start": "247000",
    "end": "419000"
  },
  {
    "text": "where we can start talking about how we used kubernetes I need to sort of explain what go is and what machine",
    "start": "252420",
    "end": "257910"
  },
  {
    "text": "learning is because this is Q Khan and not a machine learning talk so I'm gonna try and do a very quick overview of go",
    "start": "257910",
    "end": "262919"
  },
  {
    "text": "and machine learning and then turn it over to Josh to talk about how we use kubernetes to",
    "start": "262919",
    "end": "268170"
  },
  {
    "text": "build this reinforcement learning system so let's go so five slides here's how the game",
    "start": "268170",
    "end": "273840"
  },
  {
    "text": "starts it's totally empty and people take turns putting stones down on the board to sketch out territory there's",
    "start": "273840",
    "end": "281550"
  },
  {
    "text": "one rule one very important rule which is capturing which is that a stone or a set of stones that are surrounded on all",
    "start": "281550",
    "end": "286650"
  },
  {
    "text": "sides is then taken off the board and that's a capture you can capture",
    "start": "286650",
    "end": "292020"
  },
  {
    "text": "multiple sets of stones so you can see on the left those white stones those strings of stones are connected",
    "start": "292020",
    "end": "297540"
  },
  {
    "text": "orthogonal E and the new black stone that you see on the right side takes those stones off the board I mentioned",
    "start": "297540",
    "end": "304260"
  },
  {
    "text": "earlier that the goal is not to capture the goal is to build territory you can see here an example of a game where the",
    "start": "304260",
    "end": "309600"
  },
  {
    "text": "two sides have sort of divided up the territory on the board so unlike a game of chess where it starts with all the",
    "start": "309600",
    "end": "315660"
  },
  {
    "text": "pieces and the pieces all go away go starts with an empty board and things are sort of built up and the OP your",
    "start": "315660",
    "end": "323250"
  },
  {
    "text": "opponent you're sort of trying to divide up the map into different parts of territory and the person who has even",
    "start": "323250",
    "end": "328890"
  },
  {
    "text": "just one more point is the winner so it's a very different sort of game than sort of maximalist games where the wind",
    "start": "328890",
    "end": "336510"
  },
  {
    "text": "conditions are very dire or bleak you have to wipe out the enemy army or something like that no no and go you just need to have a get a slightly",
    "start": "336510",
    "end": "343530"
  },
  {
    "text": "better deal for yourself yeah and that's a good point it's like a points game and that's like there aren't very many games",
    "start": "343530",
    "end": "349260"
  },
  {
    "text": "like this where you're just trying to get points right so it's a combination of territory here and captures in the",
    "start": "349260",
    "end": "354479"
  },
  {
    "text": "previous diagram pretty cool so and here's an example of mini go we actually have I hope that this gift",
    "start": "354479",
    "end": "360060"
  },
  {
    "text": "will reload perfect so here's an example of how a game might unfold play starts",
    "start": "360060",
    "end": "365370"
  },
  {
    "text": "in the corners so this is actually a mini Gogi this is actually mini go right which is yeah so what you're seeing",
    "start": "365370",
    "end": "371070"
  },
  {
    "text": "there so the whole string of stones being taken off the board that is a ladder there's some interesting side",
    "start": "371070",
    "end": "378330"
  },
  {
    "text": "effects of the Alpha go zero algorithm one of which is that this repeating pattern that is kind of obvious to",
    "start": "378330",
    "end": "383610"
  },
  {
    "text": "humans is is very difficult for the Alpha go zero algorithm to learn but it does learn them eventually in the",
    "start": "383610",
    "end": "390450"
  },
  {
    "text": "meantime though it falls for this trick that is fairly easy one for humans to",
    "start": "390450",
    "end": "395669"
  },
  {
    "text": "explain and avoid 4 min ago for whatever reason that's that's beyond it's Ken",
    "start": "395669",
    "end": "401249"
  },
  {
    "text": "this this version of of mini go is actually quite strong this one is that this one is actually probably stronger",
    "start": "401249",
    "end": "407429"
  },
  {
    "text": "than me and I've been playing go for 10 years but it but you can see it's falling for the ladder it has this black spot anyway so so we'll get more into",
    "start": "407429",
    "end": "414149"
  },
  {
    "text": "that but this is what a game ago looks like so that's going five slides if you have more questions please ask us afterward next we're gonna try and cover",
    "start": "414149",
    "end": "420839"
  },
  {
    "text": "machine learning in five slides and that's a little ambitious but I should",
    "start": "420839",
    "end": "426779"
  },
  {
    "text": "also preface it that I'm not a machine learning expert either and this has been a project where I've learned a lot about",
    "start": "426779",
    "end": "432029"
  },
  {
    "text": "it so I hope that that makes this explanation accessible I would also encourage you guys if you think this is",
    "start": "432029",
    "end": "438239"
  },
  {
    "text": "interesting please check out other resources there's a lot that you can find the short version is what is a",
    "start": "438239",
    "end": "446339"
  },
  {
    "text": "neural network or what is a machine learning algorithm what is a model what do we call these things basically we",
    "start": "446339",
    "end": "451529"
  },
  {
    "text": "have a pile of math that gives us an answer when we put in some data that thing in the middle is the model and in",
    "start": "451529",
    "end": "457349"
  },
  {
    "text": "the case of a neural network we make we have based that math on something that",
    "start": "457349",
    "end": "462809"
  },
  {
    "text": "has biological inspiration like this structure in the middle is a bunch of linear combinations which are supposed",
    "start": "462809",
    "end": "468479"
  },
  {
    "text": "to emulate neurons in the brain they don't they're not actually and there's a lot of places where biologists go hey",
    "start": "468479",
    "end": "474569"
  },
  {
    "text": "that's not how brains work but that's what they're sort of supposed to simulate and the important thing is to realize that this is a big pile of math",
    "start": "474569",
    "end": "479899"
  },
  {
    "text": "and the important thing about that math is that it's differentiable kind of and",
    "start": "479899",
    "end": "485279"
  },
  {
    "text": "the other thing that's important to know is that it's really slow so that's why folks are using GPUs and hardware",
    "start": "485279",
    "end": "491069"
  },
  {
    "text": "accelerators to try and make that pile of math pretty fast so that's an inference where we give it some data we",
    "start": "491069",
    "end": "496439"
  },
  {
    "text": "run it through the model and we get out some answers when we want to create that",
    "start": "496439",
    "end": "501449"
  },
  {
    "text": "pile of math and make it any good we want to train it and what that means is that means that we want to quantify how",
    "start": "501449",
    "end": "510179"
  },
  {
    "text": "bad that inference or that forward pass is and we want to express that in a",
    "start": "510179",
    "end": "515219"
  },
  {
    "text": "mathematical function called error or loss and if you've ever done regressions this is basically regression you find",
    "start": "515219",
    "end": "522089"
  },
  {
    "text": "some way to express the error of your prediction and then you'd take the",
    "start": "522089",
    "end": "527250"
  },
  {
    "text": "derivative of that and you try to walk downhill so once you can take the derivative of F then you figure out how",
    "start": "527250",
    "end": "533309"
  },
  {
    "text": "to change the stuff in the middle to make the air smaller so that's training networks in a nutshell and I",
    "start": "533309",
    "end": "539339"
  },
  {
    "text": "should say just with a slight asterisk here you know the thing that the the image is like a perceptron or like a",
    "start": "539339",
    "end": "544350"
  },
  {
    "text": "very simple neural network but of course form in ego we're using a convolutional neural net so what kind of glossing over",
    "start": "544350",
    "end": "550800"
  },
  {
    "text": "the entirety of convolutional neural net all of that stuff so check it out somewhere else um but the the important",
    "start": "550800",
    "end": "557520"
  },
  {
    "text": "thing is that that's a lot of variables that function of your air could be millions of variables and taking the",
    "start": "557520",
    "end": "563160"
  },
  {
    "text": "derivative of that is a real pain so but the important idea is that we want to",
    "start": "563160",
    "end": "568620"
  },
  {
    "text": "essentially use that to revise and adjust all of the weights in our network to get a better model that's better able",
    "start": "568620",
    "end": "574500"
  },
  {
    "text": "to give us the results that we want the next time so how does min ago use these so an inference for min ago means that",
    "start": "574500",
    "end": "581520"
  },
  {
    "text": "we give it a board position and we get two values out we want it to tell us what's the next move that's likely to be",
    "start": "581520",
    "end": "587790"
  },
  {
    "text": "played and who's likely to win the what's the next move that's likely to be",
    "start": "587790",
    "end": "593250"
  },
  {
    "text": "played is called the Policy output it is essentially an array of numbers where one number corresponds to each point",
    "start": "593250",
    "end": "599670"
  },
  {
    "text": "which is the probability of the move being played and the second one the who's ahead who's gonna win that is the",
    "start": "599670",
    "end": "605880"
  },
  {
    "text": "value output and that's just a scaler between negative one and one with a one if black is gonna win and a negative one",
    "start": "605880",
    "end": "612510"
  },
  {
    "text": "is what's gonna win that's all it is so that's what our network spits out what",
    "start": "612510",
    "end": "618600"
  },
  {
    "text": "do we do with these numbers what we do with these policy and value outputs is we do something called research we do",
    "start": "618600",
    "end": "625560"
  },
  {
    "text": "Monte Carlo tree search which is a way of exploring the possible outcomes we",
    "start": "625560",
    "end": "631320"
  },
  {
    "text": "use the policy network not to assume that the most likely move will be played we do at research and we try to figure",
    "start": "631320",
    "end": "638070"
  },
  {
    "text": "out if it works if it's a good move in this situation so we use those policy outputs to sort of peer into the future",
    "start": "638070",
    "end": "643950"
  },
  {
    "text": "and see what will happen if we play those moves and as a result that changes",
    "start": "643950",
    "end": "649200"
  },
  {
    "text": "the policy so the idea is that this tree search is an improvement on what the",
    "start": "649200",
    "end": "655560"
  },
  {
    "text": "original policy outputs would would provide so the process is that playing a",
    "start": "655560",
    "end": "660660"
  },
  {
    "text": "game using tree search produces a better game that we can use as input data to",
    "start": "660660",
    "end": "666000"
  },
  {
    "text": "Train next version of our model and this is kind of a pretty big a big idea we can",
    "start": "666000",
    "end": "672319"
  },
  {
    "text": "take this tree search that we do and we can actually get our error function in this way so we can define the error for",
    "start": "672319",
    "end": "679720"
  },
  {
    "text": "that we will use to train our next version of our model as the difference between what the original policy output",
    "start": "679720",
    "end": "685279"
  },
  {
    "text": "was and with the move that was actually played and the difference between what the value output was and the actual",
    "start": "685279",
    "end": "692120"
  },
  {
    "text": "result of the game and it just just to recap again policy is right what move will be played next and value is who's",
    "start": "692120",
    "end": "699230"
  },
  {
    "text": "gonna win the game so when I say policy and value I kind of say those interchangeable try a voice from the",
    "start": "699230",
    "end": "705019"
  },
  {
    "text": "darkness here you can come into the light totally fine um all right so that's sort of this is our our five",
    "start": "705019",
    "end": "711439"
  },
  {
    "text": "slide machine learning summary which I hope is you know we're just sort of treating it all as a black box there's a",
    "start": "711439",
    "end": "717800"
  },
  {
    "text": "whole lot of other stuff that goes in there that I'm not super clear on myself but when you use great libraries like",
    "start": "717800",
    "end": "723290"
  },
  {
    "text": "tensorflow and abstractions you don't necessarily need to worry exactly about how all of these things happen but a",
    "start": "723290",
    "end": "729439"
  },
  {
    "text": "model is a big pile of math we used to give us answers we measure the air comparing those answers with the answers that we know or think we know we train",
    "start": "729439",
    "end": "737240"
  },
  {
    "text": "the model to minimize that error min egos model outputs these policy and value we use those entry search to play",
    "start": "737240",
    "end": "744560"
  },
  {
    "text": "games and then we use those games to become better in theory if everything is working right and so that is what we",
    "start": "744560",
    "end": "751220"
  },
  {
    "start": "749000",
    "end": "872000"
  },
  {
    "text": "call a reinforcement learning loop where self play produces the next the new data",
    "start": "751220",
    "end": "756949"
  },
  {
    "text": "that we use and then training produces the next model that we use and if that happens then you have this very virtuous",
    "start": "756949",
    "end": "763040"
  },
  {
    "text": "reinforcing cycle there's a whole bunch of other details on why these are sometimes hard to set up and why it was",
    "start": "763040",
    "end": "768829"
  },
  {
    "text": "so hard for folks to arrive at this very clever algorithm but that's all stuff",
    "start": "768829",
    "end": "774980"
  },
  {
    "text": "that I'm sure there are some better qualified people to give those talks in event the important takeaway here is",
    "start": "774980",
    "end": "780529"
  },
  {
    "text": "that that self play that tree search the the process of creating data for the next version of your model is incredibly",
    "start": "780529",
    "end": "787519"
  },
  {
    "text": "computationally expensive we need to produce each each move that we decide to",
    "start": "787519",
    "end": "793970"
  },
  {
    "text": "make in a self play game requires thousands of inferences thousands of forward passes of the model",
    "start": "793970",
    "end": "800029"
  },
  {
    "text": "and we do that hundreds of hundreds of times per game to play a single game and",
    "start": "800029",
    "end": "805579"
  },
  {
    "text": "then we need tens of thousands of games before we can train a new model so as a result this is the huge parallelizable",
    "start": "805579",
    "end": "813109"
  },
  {
    "text": "part of the problem where once I had implemented the algorithm described in the paper once I had some tests to make",
    "start": "813109",
    "end": "819649"
  },
  {
    "text": "sure that was working I said to myself oh my gosh I need to play millions of games and playing a game takes a",
    "start": "819649",
    "end": "825409"
  },
  {
    "text": "surprisingly long amount of time so that kind of Keys up you know the problem and",
    "start": "825409",
    "end": "832220"
  },
  {
    "text": "I'm sure that you guys all kind of know where I'm going with this and what I used to do this is this was me thinking",
    "start": "832220",
    "end": "838459"
  },
  {
    "text": "to myself how am I going to do this I said well I could I could manage a whole bunch of vm's with a soup of bash",
    "start": "838459",
    "end": "844609"
  },
  {
    "text": "scripts I could write you know I had all",
    "start": "844609",
    "end": "850189"
  },
  {
    "text": "of these problems and I want to see my friend who's on the kubernetes team I said how can I do this how am I gonna do this should I use containers for this",
    "start": "850189",
    "end": "857899"
  },
  {
    "text": "what's the problem should I make a giant work queue should I do some big stateful app that would pass out work you know",
    "start": "857899",
    "end": "863869"
  },
  {
    "text": "what's the right way for me to do this and I think so I went to go see Josh and what did you like laugh at me first I",
    "start": "863869",
    "end": "871519"
  },
  {
    "text": "should pick prob rash grips this big pile of bash scripts that's exactly what she said all right so take it away okay",
    "start": "871519",
    "end": "876709"
  },
  {
    "start": "872000",
    "end": "1307000"
  },
  {
    "text": "so so to recap where are we at this point well we've got a Python program",
    "start": "876709",
    "end": "883159"
  },
  {
    "text": "that uses tensorflow and runs locally that's that's where we are right now so what happens next",
    "start": "883159",
    "end": "888409"
  },
  {
    "text": "okay so the first thing we did was okay we got to stop storing our games in the local file system",
    "start": "888409",
    "end": "893629"
  },
  {
    "text": "so we're like okay well how about Google Cloud storage well we're at Google right so we're gonna use GCS so we're gonna",
    "start": "893629",
    "end": "901009"
  },
  {
    "text": "store all our sgf s so s G I'm gonna use s TF sometimes that's a ghost speak for",
    "start": "901009",
    "end": "907819"
  },
  {
    "text": "go file a game file a game files we're gonna store all our game files in Google",
    "start": "907819",
    "end": "913189"
  },
  {
    "text": "Cloud storage and we're gonna store all our models in Google's to cloud storage this is gonna be really simple we're gonna push s jeff's up we're gonna read",
    "start": "913189",
    "end": "920479"
  },
  {
    "text": "them down use them to Train push the new model up and so on and so on this was a this was a pretty contained binary it",
    "start": "920479",
    "end": "926179"
  },
  {
    "text": "would it would do one thing it would like you would call it and it would play a game and would write out the data and",
    "start": "926179",
    "end": "931180"
  },
  {
    "text": "shut down okay well we're still not it's still running locally okay so what what what about next okay well let's let's containerize it",
    "start": "931180",
    "end": "938050"
  },
  {
    "text": "let's put it in a talker image okay so super simple put in a docker image",
    "start": "938050",
    "end": "943540"
  },
  {
    "text": "running on GCE great well I should say this is turns out to be actually where all our trouble comes in so the hardest part for us has",
    "start": "943540",
    "end": "951700"
  },
  {
    "text": "been putting in a docker image I should say tensorflow some of it most some of it to really get",
    "start": "951700",
    "end": "957850"
  },
  {
    "text": "a good performance out of tents at tensorflow for CPUs for example we compile with special Flags - it's a",
    "start": "957850",
    "end": "962860"
  },
  {
    "text": "really good good optimization yeah yeah there's sort of this tension right where containers give you the idea that you don't need to worry about the machine",
    "start": "962860",
    "end": "969040"
  },
  {
    "text": "that they're on really but tensorflow and you know requiring GPUs makes you actually sort of be concerned about the",
    "start": "969040",
    "end": "975820"
  },
  {
    "text": "architecture like the processor architecture that you're running on and we'll talk a little about and video library isn't a little bit oh yeah video",
    "start": "975820",
    "end": "982480"
  },
  {
    "text": "library so so here's where we are so but what are we going to parallel lies and",
    "start": "982480",
    "end": "987550"
  },
  {
    "text": "where discriminate has come in and of course here's where it comes in so we've we've got this self play cycle and to",
    "start": "987550",
    "end": "994150"
  },
  {
    "text": "recall how like how many games are we gonna be producing it's around 20,000",
    "start": "994150",
    "end": "999220"
  },
  {
    "text": "games every time we want to Train so that's that's our our batch batch size",
    "start": "999220",
    "end": "1004520"
  },
  {
    "text": "and again we need millions of games so embarrassingly parallel Aiza ball so so",
    "start": "1004520",
    "end": "1011400"
  },
  {
    "text": "what are we gonna do next and so I asked my team and I was like hey what do you think and one of my team members Jacob",
    "start": "1011400",
    "end": "1016950"
  },
  {
    "text": "Beecham was like hey how about you use a kubernetes job right awesome so created",
    "start": "1016950",
    "end": "1022170"
  },
  {
    "text": "kubernetes job we're gonna crank up the parallelism to 20,000 we're on a bunch of gems VMs go and keeps running and",
    "start": "1022170",
    "end": "1029790"
  },
  {
    "text": "running and running and running and running and running and it turns out it's producing 30,000 40,000 and I'm",
    "start": "1029790",
    "end": "1035100"
  },
  {
    "text": "like oh my gosh this was pretty funny I just specified desired completions I",
    "start": "1035100",
    "end": "1040140"
  },
  {
    "text": "said 20,000 and surely it will reach that number but it doesn't actually after after a thousand it would reach a",
    "start": "1040140",
    "end": "1046140"
  },
  {
    "text": "thousand and it would just stop there and I was very confused turns out this is a funny funny caveat of the way that the batch API currently works is that",
    "start": "1046140",
    "end": "1052920"
  },
  {
    "text": "Daniels is shaking his head and cringing so it currently it's it's it checks the",
    "start": "1052920",
    "end": "1058530"
  },
  {
    "text": "number of finished jobs by looking at EDD to see how many things are an LED have finish",
    "start": "1058530",
    "end": "1063870"
  },
  {
    "text": "but in gke for scalability we set that number pretty low so that we don't have",
    "start": "1063870",
    "end": "1070410"
  },
  {
    "text": "masters that's keeping track of all of the things exactly exactly we don't want to have extra xyg junk this actually",
    "start": "1070410",
    "end": "1076110"
  },
  {
    "text": "this is actually yeah this actually turned out great like this little wrinkle in the API actually was just",
    "start": "1076110",
    "end": "1081180"
  },
  {
    "text": "what we wanted to do because we could basically specify an absurdly high number of desired completion and it runs forever and it would run forever and we",
    "start": "1081180",
    "end": "1087809"
  },
  {
    "text": "just restructured the job that each time it started up it would pull down the latest model so as a result I there was",
    "start": "1087809",
    "end": "1094110"
  },
  {
    "text": "this enormous cluster of self play workers which are essentially waking up playing a game with the latest model",
    "start": "1094110",
    "end": "1099660"
  },
  {
    "text": "writing out the data and shutting back to sleep and as soon as I push a new model to GCSE GCSE you know there's no",
    "start": "1099660",
    "end": "1106710"
  },
  {
    "text": "there's no half-finished files there's no contention if anything goes wrong with any of these jobs they just shut",
    "start": "1106710",
    "end": "1112200"
  },
  {
    "text": "down and start over again so it's great work great so okay but we're still running on CPUs and we got to speed this",
    "start": "1112200",
    "end": "1117929"
  },
  {
    "text": "up right so next we started running it on with GPUs and again there's the",
    "start": "1117929",
    "end": "1124230"
  },
  {
    "text": "docker images right so we started doing this way back in January when they first produced their paper started looking at",
    "start": "1124230",
    "end": "1131429"
  },
  {
    "text": "December I think the paper came out last year in November so something like that anyway but in any case the the the the",
    "start": "1131429",
    "end": "1139950"
  },
  {
    "text": "Alpha API in kubernetes in gke was just getting going around this time and we were like great we're gonna use it we're",
    "start": "1139950",
    "end": "1146400"
  },
  {
    "text": "gonna use NVIDIA GPUs and of course like we were like well how do we stick the CUDA libraries and then video libraries",
    "start": "1146400",
    "end": "1152190"
  },
  {
    "text": "drivers and yeah anyway so it took some work but we got it working and Wow",
    "start": "1152190",
    "end": "1157559"
  },
  {
    "text": "so that way faster so it's long CPUs we were getting seven readouts of seconds so that means every readout is an",
    "start": "1157559",
    "end": "1163500"
  },
  {
    "text": "inference right right so at like one run-through of the neural net we were getting 250 readouts a second using just",
    "start": "1163500",
    "end": "1170670"
  },
  {
    "text": "a ka T which is a few generations back yeah it's not not even the latest NVIDIA",
    "start": "1170670",
    "end": "1176070"
  },
  {
    "text": "GPU is anybody's P 100's and now Z 100 years hundreds that's right there's so this was fantastic so now we were able",
    "start": "1176070",
    "end": "1182760"
  },
  {
    "text": "to train much or self play much much much much faster right so now we're",
    "start": "1182760",
    "end": "1188010"
  },
  {
    "text": "really cranking out games and really training our model that's right so we should go back just a second year which",
    "start": "1188010",
    "end": "1193920"
  },
  {
    "text": "is that you know this this graph about GPUs it's the same graph like the what the",
    "start": "1193920",
    "end": "1199879"
  },
  {
    "text": "huge advantage here was that we didn't have to really change our pipeline we just changed our docker image and we had",
    "start": "1199879",
    "end": "1205159"
  },
  {
    "text": "this huge performance increase right I'm sure that I'm preaching to the choir here you guys all know that this is the great advantage but to me as an",
    "start": "1205159",
    "end": "1211700"
  },
  {
    "text": "application developer who's like do I really want to use containers aren't they gonna make it hard for me to get all the performance out of them no they",
    "start": "1211700",
    "end": "1218869"
  },
  {
    "text": "didn't there wasn't any sort of performance that was hidden by the docker run time or by kubernetes and as",
    "start": "1218869",
    "end": "1226039"
  },
  {
    "text": "a result I didn't have to change any code I just had to change the docker image it was it was a huge huge success",
    "start": "1226039",
    "end": "1232519"
  },
  {
    "text": "for me personally and I was really dreading it and I should also point out that the whole driver situation has",
    "start": "1232519",
    "end": "1237619"
  },
  {
    "text": "gotten a lot better just a lot better so at this point so if you interested more in GPUs Rohit who's on the gke",
    "start": "1237619",
    "end": "1244549"
  },
  {
    "text": "kubernetes team at Google is gonna give a talk tomorrow it's gonna go into more detail but we in gke we have we've now",
    "start": "1244549",
    "end": "1250429"
  },
  {
    "text": "beta API for four GPUs and now nvidia is providing the KU libraries directly and",
    "start": "1250429",
    "end": "1255710"
  },
  {
    "text": "the image rate okay so i'm gonna want to get to the demo because we're gonna have a mini go demo but i just want to",
    "start": "1255710",
    "end": "1263029"
  },
  {
    "text": "mention one more thing so have you ever played factorial and you're like putting together parts of your factory right so this is this is kind of the factorial",
    "start": "1263029",
    "end": "1269809"
  },
  {
    "text": "process we had our ourself play pipeline but now what we wanted was we wanted to",
    "start": "1269809",
    "end": "1275509"
  },
  {
    "text": "know if mini goes getting better how do you test that you have mini go play mini go but not just the same model anymore",
    "start": "1275509",
    "end": "1281869"
  },
  {
    "text": "you have mini go playing different models we went to different mini we had a whole whole set of check points in sort of a zoo of models we wanted to be",
    "start": "1281869",
    "end": "1289129"
  },
  {
    "text": "able to track how much better the new models were getting by having them play against all of the older versions",
    "start": "1289129",
    "end": "1295340"
  },
  {
    "text": "different scenes do this but in theory you could like play against like other other go guys we had that as well",
    "start": "1295340",
    "end": "1302989"
  },
  {
    "text": "there's an open source we haven't done that yeah that's definitely something we'd like to do yeah yeah ok so this is",
    "start": "1302989",
    "end": "1310070"
  },
  {
    "start": "1307000",
    "end": "1579000"
  },
  {
    "text": "the cool part we're gonna demo show mini go so we're gonna show actually mini GUI and I should say you can do this to all",
    "start": "1310070",
    "end": "1318349"
  },
  {
    "text": "all of our data is open source it's on GCS and I'm just gonna basically do",
    "start": "1318349",
    "end": "1323840"
  },
  {
    "text": "exactly what's here so I should say this uses a docker image docker image is",
    "start": "1323840",
    "end": "1329149"
  },
  {
    "text": "about a gig don't all do it because you might kill everything so let's let's go over to terminal",
    "start": "1329149",
    "end": "1334900"
  },
  {
    "text": "you mean like the Wi-Fi yeah like don't get that be really sad okay so bored",
    "start": "1334900",
    "end": "1340840"
  },
  {
    "text": "sighs can we see that it doesn't really matter it'll we're gonna get out of this",
    "start": "1340840",
    "end": "1345940"
  },
  {
    "text": "pretty quick okay so I've set the board size i've set the model and a little",
    "start": "1345940",
    "end": "1350950"
  },
  {
    "text": "bash which kicked off our our docker container for mini GUI right we've",
    "start": "1350950",
    "end": "1356920"
  },
  {
    "text": "pulled down the model i've actually pre pulled it and let's go back to Chrome",
    "start": "1356920",
    "end": "1361960"
  },
  {
    "text": "boom nope nope nope we didn't get chrome back",
    "start": "1361960",
    "end": "1367080"
  },
  {
    "text": "maybe just turn off fullscreen for the terminal come back come back how do i",
    "start": "1367080",
    "end": "1377710"
  },
  {
    "text": "navigate between okay hard problems and computer so guess there we go right all right readouts",
    "start": "1377710",
    "end": "1386940"
  },
  {
    "text": "you might say this looks like a smaller board than the normal go boards that's right this is this is a local version",
    "start": "1389670",
    "end": "1396490"
  },
  {
    "text": "running right off with a laptop here so yeah that's right so this is CPUs so it's gonna be much much slower which is",
    "start": "1396490",
    "end": "1401830"
  },
  {
    "text": "actually good so you can actually like see it do things this is a much smaller model and there it goes",
    "start": "1401830",
    "end": "1407080"
  },
  {
    "text": "so now mini go mini go is playing mini go and I should say something you can't train like a 19 by 19 model and expect",
    "start": "1407080",
    "end": "1413530"
  },
  {
    "text": "it to play nine by nine so this is a previous version where we trained it on nine by nine s a different model a",
    "start": "1413530",
    "end": "1419050"
  },
  {
    "text": "different model and so just just a brief what's what's going on here let's posit",
    "start": "1419050",
    "end": "1424300"
  },
  {
    "text": "alright so on the Left we have what's called the principle variation which is the variation that mini go thinks is the",
    "start": "1424300",
    "end": "1431590"
  },
  {
    "text": "most likely variation right on the top in the sort of top middle column that is",
    "start": "1431590",
    "end": "1437050"
  },
  {
    "text": "the exploration is actually a sample of all the things that mini go is trying right so you can see that after trying a",
    "start": "1437050",
    "end": "1444070"
  },
  {
    "text": "whole bunch of things oh it's discovered better variations but in the first move it's pretty confident",
    "start": "1444070",
    "end": "1449260"
  },
  {
    "text": "about that first move and you can see that actually in the middle diagram which is the heat map that is where does",
    "start": "1449260",
    "end": "1454900"
  },
  {
    "text": "mini go I think it's gonna play next right so that is actually going back to the policy value in that thing that's",
    "start": "1454900",
    "end": "1460360"
  },
  {
    "text": "the output of the policy Network button then you the final thing is is the value network this is if I play",
    "start": "1460360",
    "end": "1466730"
  },
  {
    "text": "here how do I change the score of the game right so basically you can see that",
    "start": "1466730",
    "end": "1471800"
  },
  {
    "text": "like it's so it's flipping white and black and white black so it's from the perspective of the current player am I gonna like make the game worse or better",
    "start": "1471800",
    "end": "1477980"
  },
  {
    "text": "so now like white it's white it's not doing quite as good Oh black is coming back actually looks like it's gonna be",
    "start": "1477980",
    "end": "1483530"
  },
  {
    "text": "the big ko fight you can see in the graph in the upper right hand corner is its graph of who it thinks is winning that's right so as it goes up it thinks",
    "start": "1483530",
    "end": "1490160"
  },
  {
    "text": "black is gonna win as it goes down and thinks White's gonna win so right now it's back to about 50% which means it",
    "start": "1490160",
    "end": "1495200"
  },
  {
    "text": "thinks it could be anyone's game anyone's game this is a pretty fun tool that we use to sort of inspect you know",
    "start": "1495200",
    "end": "1500990"
  },
  {
    "text": "what it's thinking about what's happening it's it's pretty cool to be able to sort of peer inside what it's",
    "start": "1500990",
    "end": "1506630"
  },
  {
    "text": "looking yeah I should say you can do this too it's totally open-source totally available and in theory so this",
    "start": "1506630",
    "end": "1513020"
  },
  {
    "text": "is if you know okay so this is a little more technical if you know how about how to run go a eyes this is using gtp you",
    "start": "1513020",
    "end": "1519440"
  },
  {
    "text": "can plug in any other go AI into this GT re is the go text protocol I think it dates back to the 80s right and good new",
    "start": "1519440",
    "end": "1526460"
  },
  {
    "text": "go and it's basically running all of this over standard out and standard error and if if you guys are like that",
    "start": "1526460",
    "end": "1532670"
  },
  {
    "text": "sounds strange well yeah awesome that's maybe not the first word I'd use we're actually piping standard out in",
    "start": "1532670",
    "end": "1538910"
  },
  {
    "text": "the standard error over WebSockets and then the JavaScript is rendering all this on the front end which is awesome",
    "start": "1538910",
    "end": "1544340"
  },
  {
    "text": "it's a little interesting but it gives us compatibility with all of the other go engines as well so right pretty cool",
    "start": "1544340",
    "end": "1549770"
  },
  {
    "text": "alright so that is I know this is like this is my favorite thing but we're",
    "start": "1549770",
    "end": "1555170"
  },
  {
    "text": "gonna say we can watch wrapping up cool switch over to slides which are slide",
    "start": "1555170",
    "end": "1562760"
  },
  {
    "text": "there we go yes right it would be a great screen saver except it would also like generate a lot of heat because it's",
    "start": "1562760",
    "end": "1569900"
  },
  {
    "text": "doing a lot of work it's a great way to make your battery like where do I present thing there we go and cool so",
    "start": "1569900",
    "end": "1580790"
  },
  {
    "start": "1579000",
    "end": "1699000"
  },
  {
    "text": "that's about it again we've done this all as sort of public domain stuff all",
    "start": "1580790",
    "end": "1586010"
  },
  {
    "text": "of the data all of the models all of our code is all on github well the data and the models are all on our GPS GCS cloud",
    "start": "1586010",
    "end": "1593900"
  },
  {
    "text": "storage yep and that's all available again this is sort of been a labor of love by a number",
    "start": "1593900",
    "end": "1599169"
  },
  {
    "text": "of interested go players Yamini Cooley was written by another volunteer cloudy go was which I didn't",
    "start": "1599169",
    "end": "1605979"
  },
  {
    "text": "show is written by another volunteer this is front-end into all this data that we're producing it's a lot of fun",
    "start": "1605979",
    "end": "1611529"
  },
  {
    "text": "we've had a great time doing it this is also very timely I don't know if you guys know but just last night the",
    "start": "1611529",
    "end": "1616989"
  },
  {
    "text": "Facebook announced their open source go AI which was just released it's really",
    "start": "1616989",
    "end": "1622809"
  },
  {
    "text": "exciting honest and rocky and super exciting we're hoping that that this is sort of the way forward for AI research",
    "start": "1622809",
    "end": "1628869"
  },
  {
    "text": "that these things will happen with code attached with you know with",
    "start": "1628869",
    "end": "1634090"
  },
  {
    "text": "compatibility and so and all the other yeah exactly it's pretty exciting stuff I'm really looking forward to digging",
    "start": "1634090",
    "end": "1639340"
  },
  {
    "text": "into that code once once the talks over is right exactly I just found like trying to like like not like what it was",
    "start": "1639340",
    "end": "1645639"
  },
  {
    "text": "okay so I think that's that's what we had do we have any questions I want to just say what couple more things there",
    "start": "1645639",
    "end": "1651700"
  },
  {
    "text": "right now some things that we didn't make into the talk that we really really want to still do right TP use just came",
    "start": "1651700",
    "end": "1657070"
  },
  {
    "text": "out like right before we were working all this didn't quite making the talk",
    "start": "1657070",
    "end": "1662409"
  },
  {
    "text": "integration with Q flow is still something we really really want words are glow which I don't know how much you",
    "start": "1662409",
    "end": "1667659"
  },
  {
    "text": "know but this is awesome awesome execution workflow engine so definitely things we still want to make for mini go",
    "start": "1667659",
    "end": "1674109"
  },
  {
    "text": "definitely a lot of a lot of work to do for sure yeah it's just a lot of fun so thanks everyone",
    "start": "1674109",
    "end": "1681238"
  },
  {
    "text": "do we have any questions questions question question go for it",
    "start": "1684600",
    "end": "1690630"
  },
  {
    "text": "where was that question I didn't see Oh have to get you the microphone so as you",
    "start": "1690630",
    "end": "1699370"
  },
  {
    "text": "said playing you know 20,000 games of go simultaneously is embarrassingly parallel and I was learning if you have",
    "start": "1699370",
    "end": "1706390"
  },
  {
    "text": "thought about how this might apply to problems that aren't as embarrassing when we parallel where you need some communication between you know the",
    "start": "1706390",
    "end": "1714220"
  },
  {
    "text": "different copies that are running simultaneously yeah there's definitely a",
    "start": "1714220",
    "end": "1721990"
  },
  {
    "text": "lot of ways in which the alphago zero approach is nice and contained in a",
    "start": "1721990",
    "end": "1727510"
  },
  {
    "text": "testbed it's one of the reasons that we built it the way that we did was because the data pipeline had the requirements",
    "start": "1727510",
    "end": "1734860"
  },
  {
    "text": "it did I think that if if we did not have quite as an embarrassingly parallel a problem we might have picked a",
    "start": "1734860",
    "end": "1740590"
  },
  {
    "text": "different way of structuring it like we probably wouldn't have used the batch API and probably would have had to push a lot more that logic into the",
    "start": "1740590",
    "end": "1746230"
  },
  {
    "text": "application layer but because this is a problem with that sort of parallelism we were able to do the simplest thing that",
    "start": "1746230",
    "end": "1752500"
  },
  {
    "text": "could work which was basically using GCS is a big file system so it's a it's a",
    "start": "1752500",
    "end": "1759010"
  },
  {
    "text": "great question but I think the importance is to try and sort of fit fit",
    "start": "1759010",
    "end": "1764350"
  },
  {
    "text": "the solution to the problem domain right and in in my case in particular since there's so very few software developers",
    "start": "1764350",
    "end": "1770410"
  },
  {
    "text": "that were working on this it was really a matter of how can I do the most with the the least amount of developer time",
    "start": "1770410",
    "end": "1775960"
  },
  {
    "text": "the scarce resource was really developer time which is what I was trying to maximize for so what questions they see",
    "start": "1775960",
    "end": "1783490"
  },
  {
    "text": "a hint No and get a good workout hey so two things",
    "start": "1783490",
    "end": "1796330"
  },
  {
    "text": "first if you want to integrate the coop flow that would make a great addition to you for example so if you're game I'm",
    "start": "1796330",
    "end": "1802480"
  },
  {
    "text": "game and be happy to help you with that and the second one have you tried like distributed tensor flow because I assume",
    "start": "1802480",
    "end": "1808929"
  },
  {
    "text": "that your distribution is one job per play but the job itself is not distributed and you know those are those",
    "start": "1808929",
    "end": "1817059"
  },
  {
    "text": "are great questions actually like so I would speak to the second one first go ahead we're always like looking where",
    "start": "1817059",
    "end": "1823210"
  },
  {
    "text": "is our bottleneck where's our bottleneck where's our bottleneck for a long time it was self play but we're starting",
    "start": "1823210",
    "end": "1828309"
  },
  {
    "text": "there we're actually working on a C++ rewrite it's gonna be even faster like it not hugely faster because most of our",
    "start": "1828309",
    "end": "1835029"
  },
  {
    "text": "bottleneck has been three times industry three times faster okay three times faster Wow but because saturate the GPUs",
    "start": "1835029",
    "end": "1842080"
  },
  {
    "text": "better there's mm so it's alright so at that point then yes then we really have",
    "start": "1842080",
    "end": "1847299"
  },
  {
    "text": "to like change the weight training works and then intensive row is fantastic when",
    "start": "1847299",
    "end": "1853509"
  },
  {
    "text": "you need to charge your training job but for us the bottleneck has always been the data creation which is that's gonna",
    "start": "1853509",
    "end": "1859659"
  },
  {
    "text": "change which is gonna change pretty soon so basically as soon as we get back and I'd love to do that let's let's talk",
    "start": "1859659",
    "end": "1865149"
  },
  {
    "text": "okay um another question any other questions I think we might be almost out of time the",
    "start": "1865149",
    "end": "1875279"
  },
  {
    "start": "1874000",
    "end": "2035000"
  },
  {
    "text": "relationship with them tensorflow and the way go affected its popularity as an",
    "start": "1875279",
    "end": "1882279"
  },
  {
    "text": "example which came first the developer interest in tensorflow and that dragged",
    "start": "1882279",
    "end": "1888759"
  },
  {
    "text": "interest in the go challenge or did the go challenge really drive the community of tensorflow that is a great question so first I",
    "start": "1888759",
    "end": "1896860"
  },
  {
    "text": "kinda have to take the easy one which is that go came first because go is several thousand years old so obviously okay",
    "start": "1896860",
    "end": "1902769"
  },
  {
    "text": "first um but the question of tensorflow you know did interest and go drive",
    "start": "1902769",
    "end": "1909399"
  },
  {
    "text": "tensorflow adoption the specifics of the architecture underneath alphago is that",
    "start": "1909399",
    "end": "1915549"
  },
  {
    "text": "it is a convolutional neural network which is very similar to ResNet and the other image classifiers that people have",
    "start": "1915549",
    "end": "1921879"
  },
  {
    "text": "been working we treat go as an image basically like it's a picture no problem yeah the",
    "start": "1921879",
    "end": "1927100"
  },
  {
    "text": "convolutional net basically treats it like a grayscale image and is able to extract features from that in the same",
    "start": "1927100",
    "end": "1932950"
  },
  {
    "text": "way that a lot of the same object recognition algorithms work so it's more",
    "start": "1932950",
    "end": "1938410"
  },
  {
    "text": "of a repurposing of some very effective ways to train image classifiers have",
    "start": "1938410",
    "end": "1944620"
  },
  {
    "text": "been used in the game of go and arriving at that particular architecture has described in the paper is where a lot of",
    "start": "1944620",
    "end": "1951520"
  },
  {
    "text": "the hard research work was done for us now this was about a software engineering challenge and but scaling",
    "start": "1951520",
    "end": "1957700"
  },
  {
    "text": "challenge just tensorflow is like perfectly suited to it it's fantastic for for convolutional neural nets right",
    "start": "1957700",
    "end": "1963150"
  },
  {
    "text": "so it's a great question did that answer kind of where you go with that without",
    "start": "1963150",
    "end": "1976210"
  },
  {
    "text": "the go challenge I think yeah awesome I think that resonate and the the image",
    "start": "1976210",
    "end": "1982300"
  },
  {
    "text": "classifiers used by Google have really been driving a lot of the tezo quo in particular this interest in training",
    "start": "1982300",
    "end": "1988120"
  },
  {
    "text": "these really big models all right I think we're out of time if anybody has any other questions for us we'll be outside well thanks everyone thank you",
    "start": "1988120",
    "end": "1994310"
  },
  {
    "text": "[Applause]",
    "start": "1994310",
    "end": "2001220"
  }
]