[
  {
    "start": "0",
    "end": "0"
  },
  {
    "text": "all right we'll uh we'll give it a go then so um morning everybody my name is Paul mclin and I'm going to talk to you",
    "start": "80",
    "end": "5720"
  },
  {
    "text": "today with my colleague sashin cambos about the Next Generation microservices project at Bloomberg um which is kind of",
    "start": "5720",
    "end": "12160"
  },
  {
    "text": "powered by kubernetes obviously so we're going to spend the next 30 or 40 minutes uh talking about a",
    "start": "12160",
    "end": "18600"
  },
  {
    "text": "few different things we're going to talk about our company explain who we are so you have a bit of context and you can",
    "start": "18600",
    "end": "23800"
  },
  {
    "text": "understand um some of the decisions we've made um we're going to talk to you about this microservice platform that we",
    "start": "23800",
    "end": "29400"
  },
  {
    "text": "built and we give out to various departments within our organization um it's a slight Twist on a on a typical",
    "start": "29400",
    "end": "35320"
  },
  {
    "text": "kind of microservice idea um we're also going to talk about our use of kubernetes and specifically how we went",
    "start": "35320",
    "end": "41480"
  },
  {
    "text": "about evaluating whether uh the hype and the reality uh were matched um some of",
    "start": "41480",
    "end": "48039"
  },
  {
    "text": "the problems we ran into and some of the pain points that that that we had so if nothing else maybe um that kind of lad",
    "start": "48039",
    "end": "54320"
  },
  {
    "text": "half of the presentation we'll get give you some gotchas and some answers to those which maybe will save you some time",
    "start": "54320",
    "end": "60960"
  },
  {
    "start": "60000",
    "end": "60000"
  },
  {
    "text": "so blumberg who are we so if any of you work within the financial services industry you're going to be very",
    "start": "60960",
    "end": "66159"
  },
  {
    "text": "familiar with who we are um it's we're kind of omnipresent within Banks hedge funds uh investment shops anything like",
    "start": "66159",
    "end": "71960"
  },
  {
    "text": "that um if not then maybe you more familiar with the fact that we have a TV channel so if you turn on a hotel if you",
    "start": "71960",
    "end": "78560"
  },
  {
    "text": "turn on TV in a hotel room we're always there um if not even that then maybe you've heard of Mike Bloomberg who is",
    "start": "78560",
    "end": "84720"
  },
  {
    "text": "the mayor of New York so Mike Bloomberg was one of the core founder the four found founders of the company it wasn't",
    "start": "84720",
    "end": "91600"
  },
  {
    "text": "always called Bloomberg um but he founded the company with those three other people 35 years ago uh we're",
    "start": "91600",
    "end": "98280"
  },
  {
    "text": "privately held and one of the nice things I think about working for this company as a software developer is that",
    "start": "98280",
    "end": "103479"
  },
  {
    "text": "all of those Founders were also software developers or systems development people so first and foremost we very much are a",
    "start": "103479",
    "end": "109799"
  },
  {
    "text": "software company uh we have 90,000 employees we have offices everywhere at Sims and we",
    "start": "109799",
    "end": "116240"
  },
  {
    "text": "have around about 5,000 Engineers uh primarily based in New York London but we have offices in various other",
    "start": "116240",
    "end": "122840"
  },
  {
    "text": "places we have um the TV channel we have radio channels we have bl.com which is a",
    "start": "122840",
    "end": "128800"
  },
  {
    "text": "great website these guys over there run it um and it's very helpful if you're",
    "start": "128800",
    "end": "134400"
  },
  {
    "text": "trying to manage your personal finances we also have a magazine which we publish on a weekly basis an oldfashioned hard",
    "start": "134400",
    "end": "139920"
  },
  {
    "text": "copy thing and that has a circulation of almost a million um and it's sent out to 150 different countries um all of those",
    "start": "139920",
    "end": "148120"
  },
  {
    "text": "other bits though are more the sideline they're not core part of our business so if ever ever any of you have heard of",
    "start": "148120",
    "end": "153840"
  },
  {
    "text": "Bloomberg you might have heard something called the Bloomberg terminal and the terminal is basically our subscription service so um what people do is they pay",
    "start": "153840",
    "end": "161599"
  },
  {
    "text": "us to get access to our terminal and that gives them any kind of data they want which should be kind of anything",
    "start": "161599",
    "end": "167680"
  },
  {
    "text": "they could imagine relating to a whole series of different Industries so like a lot of you I guess",
    "start": "167680",
    "end": "174000"
  },
  {
    "text": "we deal with data um if you think about financial data the kind of obvious thing that Springs to mind would be something",
    "start": "174000",
    "end": "179360"
  },
  {
    "text": "like the price of a a tick or a stock on an exchange so something like an IBM or Microsoft or Google what is it currently",
    "start": "179360",
    "end": "185799"
  },
  {
    "text": "trading at um we do do that but that's only a very very small part of what we do that's something that's very easy to",
    "start": "185799",
    "end": "191400"
  },
  {
    "text": "pass very structured and has very clean specification our mandate and what we do",
    "start": "191400",
    "end": "196599"
  },
  {
    "text": "is we aim to Source absolutely anything and everything we can find in the wider World which pertains to the financial",
    "start": "196599",
    "end": "202319"
  },
  {
    "text": "markets the insurance industry legal systems and the US government um so when",
    "start": "202319",
    "end": "209360"
  },
  {
    "text": "we come back and think again about the price of IBM today it's all the many many factors which drive that price it's",
    "start": "209360",
    "end": "215920"
  },
  {
    "text": "the second and third level thinking that people have and we have to try and second guess all the kind of information",
    "start": "215920",
    "end": "221080"
  },
  {
    "text": "they're going to want at their fingertips to be able to make a determination on that stock um",
    "start": "221080",
    "end": "226640"
  },
  {
    "text": "furthermore an important thing to point out it's not just the current value of these pieces of information we want point in time data of all this uh all",
    "start": "226640",
    "end": "234159"
  },
  {
    "text": "this information so what I mean by point in time is we have the current representation or the value of a piece",
    "start": "234159",
    "end": "240560"
  },
  {
    "text": "of data but we want to be able to see historically how that data is evolved uh both in terms of its absolute value but",
    "start": "240560",
    "end": "246560"
  },
  {
    "text": "also its structure so maybe the value of a piece of data is altered structurally and it's obviously altered in absolute",
    "start": "246560",
    "end": "252280"
  },
  {
    "text": "terms um think about a weather forecast we have the weather forecast for Saturday as we get closer to Saturday",
    "start": "252280",
    "end": "259000"
  },
  {
    "text": "we're still interested in what the weather forecast is for Saturday but we can see it the evolution of that",
    "start": "259000",
    "end": "264600"
  },
  {
    "text": "forecast an important thing to point out as well is that the kind of data we deal with has to be very very high Precision",
    "start": "264600",
    "end": "271479"
  },
  {
    "text": "um people make decisions which have a monetary value of hundreds of millions or billions of dollars so we cannot",
    "start": "271479",
    "end": "277840"
  },
  {
    "text": "afford to be incorrect um or wrong with our data so it's very very important the data that comes through our company is",
    "start": "277840",
    "end": "284240"
  },
  {
    "text": "correct and accurate so before we get into specifics",
    "start": "284240",
    "end": "290639"
  },
  {
    "text": "of exactly what our project is just to give you a more concrete example so if you kind of Imagine let's say uh we have",
    "start": "290639",
    "end": "296240"
  },
  {
    "text": "we run a company and our company has something to do with renewable energy maybe we sell wind turbines or solar panels something like that um we're",
    "start": "296240",
    "end": "303800"
  },
  {
    "text": "going to be very interested in weather we're going to be very interested if there is a hurricane or some kind of natural disaster expected uh we're going",
    "start": "303800",
    "end": "310080"
  },
  {
    "text": "to be very interested in weather forecasts and whether for example um",
    "start": "310080",
    "end": "315680"
  },
  {
    "text": "there is enough wind in this particular area for us to to consider selling wind turbines there I'm going to have to",
    "start": "315680",
    "end": "321400"
  },
  {
    "text": "manufacture these things so I'm going to need to a lot of information about the commodity Market what kind of price I should lock in whether I should wait a",
    "start": "321400",
    "end": "327120"
  },
  {
    "text": "little bit whether I should uh just proceed as is I'm going to want to know about government legislation that",
    "start": "327120",
    "end": "332720"
  },
  {
    "text": "potentially could be coming up and affecting me I'm going to want to know about grants and rebates and whatever else the um the the government is doing",
    "start": "332720",
    "end": "341199"
  },
  {
    "text": "I'm going to want to know about the state of the economy maybe people don't actually have money to be able to spend maybe this particular geographic area",
    "start": "341199",
    "end": "348479"
  },
  {
    "text": "people are not particularly keen on renewable energy and there's there's kind of a million other different um",
    "start": "348479",
    "end": "354440"
  },
  {
    "text": "areas or factors which could influence uh and be very very useful to me as that business owner",
    "start": "354440",
    "end": "360039"
  },
  {
    "text": "so we have we have around about 3,000 employees in our data Division and their job is basically to second guess what",
    "start": "360039",
    "end": "365919"
  },
  {
    "text": "our customers might want um and if there is anything missing then the customers can ask a sales rep for it and we will go and acquire for acquire it for them",
    "start": "365919",
    "end": "373720"
  },
  {
    "text": "um so their job is basically to source as much information as possible so you know we deal with a lot of data from a",
    "start": "373720",
    "end": "380520"
  },
  {
    "text": "lot of different sources which updates extremely frequently um this is the development",
    "start": "380520",
    "end": "386319"
  },
  {
    "text": "team so you have Michael and mik over there and sashin down here um please come and talk to us this this",
    "start": "386319",
    "end": "391479"
  },
  {
    "text": "presentation is more about um kues but this is a production system which has been running for a number of months at",
    "start": "391479",
    "end": "397960"
  },
  {
    "text": "scale so we have a lot of experience with Prometheus and Alternatives fluent Dean Alternatives configuration",
    "start": "397960",
    "end": "403199"
  },
  {
    "text": "management tools so please come and pick our brains happy to help this was kind of like our our",
    "start": "403199",
    "end": "410000"
  },
  {
    "text": "mission statement so we wanted to build some kind of infrastructure that would allow non-engineers so this data",
    "start": "410000",
    "end": "415199"
  },
  {
    "text": "division these people who had excellent um domain knowledge as well as Engineers like ourselves to be able to deploy code",
    "start": "415199",
    "end": "421960"
  },
  {
    "text": "effortlessly and if possible we wanted to be able to deploy our code with a higher level of confidence than we currently",
    "start": "421960",
    "end": "428759"
  },
  {
    "text": "do so what we did is we we um came up with this dtp thing data",
    "start": "428759",
    "end": "434759"
  },
  {
    "text": "Technologies Pipeline and this is the platform that we've built which has been in production in Bloomberg for approximately a year um it's can provide",
    "start": "434759",
    "end": "441800"
  },
  {
    "text": "a great benefit to that that data division as well as our own Department",
    "start": "441800",
    "end": "447199"
  },
  {
    "text": "um the aim is obviously this is this is why we all at this conference but kues takes care of an",
    "start": "447199",
    "end": "452879"
  },
  {
    "text": "awful lot of the crosscutting concerns that we would have um and the nonfunctional requirements that are very very common um so it's it's very very",
    "start": "452879",
    "end": "460280"
  },
  {
    "text": "important that or it's very nice that I as a developer can focus more on the problem at hand rather than having to",
    "start": "460280",
    "end": "467159"
  },
  {
    "text": "build a system own servers and all the other kind of operational concerns that go around that which take up an awful",
    "start": "467159",
    "end": "473159"
  },
  {
    "text": "lot of time so the aim with this platform was to kind of minimize that cost make it so that we had uh single",
    "start": "473159",
    "end": "479159"
  },
  {
    "text": "tick click deployment and we could push C down production exceptionally easily so microservices so these These",
    "start": "479159",
    "end": "487240"
  },
  {
    "text": "Days tend to be the answer to all problems um we won't have a debate about what that means but to us it was",
    "start": "487240",
    "end": "492840"
  },
  {
    "text": "basically about the idea that they're small they're focused they do one thing and do one thing well in terms of what",
    "start": "492840",
    "end": "497960"
  },
  {
    "text": "we expected from people who deploy services on our platform we wanted them to",
    "start": "497960",
    "end": "503120"
  },
  {
    "text": "um guarantee that they had a minimal API and a very clearly defined dependencies",
    "start": "503120",
    "end": "508599"
  },
  {
    "text": "an ideally minimal dependencies as well uh we also wanted them to make sure they had good code coverage so good unit",
    "start": "508599",
    "end": "515000"
  },
  {
    "text": "tests good acceptance tests and those tests should pass um and in exchange for that we would we",
    "start": "515000",
    "end": "521039"
  },
  {
    "text": "would build this platform that would Empower them",
    "start": "521039",
    "end": "525440"
  },
  {
    "text": "um we also sorry just to add there we also wanted to make sure that we didn't have any unnecessary restrictions so we",
    "start": "526399",
    "end": "532200"
  },
  {
    "text": "didn't want it to be restricted to a single language this people should be able it should be language agnostic uh",
    "start": "532200",
    "end": "538720"
  },
  {
    "text": "uh we should shouldn't be overly concerned with uh only throughput below a certain number or only latency above a",
    "start": "538720",
    "end": "544240"
  },
  {
    "text": "certain number so the thing that we built was this next Generation microservices so the first point up",
    "start": "544240",
    "end": "550519"
  },
  {
    "start": "545000",
    "end": "545000"
  },
  {
    "text": "there is where we start to differ from the kind of normal example of things the normal way of the world so we we very",
    "start": "550519",
    "end": "555720"
  },
  {
    "text": "clearly and very explicitly wanted people to test in production um and that was a huge thing for us um we wanted to",
    "start": "555720",
    "end": "562600"
  },
  {
    "text": "handle all the plumbing we wanted this single click uh deployment or potentially some kind of push on green deployment scenario um and we wanted all",
    "start": "562600",
    "end": "569560"
  },
  {
    "text": "the kind of the good things that kubernetes would bring to the the table we also wanted the ability to self-host",
    "start": "569560",
    "end": "575519"
  },
  {
    "text": "a lot of the services which Define our platform within our platform and that's something that we've also done in the same way that kubernetes is moving along",
    "start": "575519",
    "end": "581839"
  },
  {
    "text": "those lines testing and production is still up",
    "start": "581839",
    "end": "587600"
  },
  {
    "start": "583000",
    "end": "583000"
  },
  {
    "text": "there and the obvious thing is if you know if you have conversation with a with some people they would you know",
    "start": "587600",
    "end": "593000"
  },
  {
    "text": "look you very strangely and say that must must be a bad thing um this is a famous quote from Fred Brooks the",
    "start": "593000",
    "end": "599040"
  },
  {
    "text": "mythical man month so all programs are Optimist obviously um just to paraphrase",
    "start": "599040",
    "end": "605079"
  },
  {
    "text": "maybe it's the Curious nature um that our profession requires and the kind of uncertainty involved that kind of drives",
    "start": "605079",
    "end": "611600"
  },
  {
    "text": "this and requires this of us um but these these two highlighted sentences of the back of things that I've said many",
    "start": "611600",
    "end": "617839"
  },
  {
    "text": "times and I've heard many many times um this week I'm sure so this time it will surely run and I've just found the last",
    "start": "617839",
    "end": "625720"
  },
  {
    "text": "bug there are no more don't worry it's be fine this time",
    "start": "625720",
    "end": "631240"
  },
  {
    "start": "630000",
    "end": "630000"
  },
  {
    "text": "this is the typical release cycle that I'm guessing a lot of people have we have some kind of a production environment and then we have a series of",
    "start": "631240",
    "end": "637120"
  },
  {
    "text": "pre-production stages we write our code we write a series of tests we run the",
    "start": "637120",
    "end": "642480"
  },
  {
    "text": "tests and hopefully they'll all pass if not we'll fix them at some point in our process we're going to be happy that all the tests are passing and we're going to",
    "start": "642480",
    "end": "649279"
  },
  {
    "text": "iterate through and we're going to deploy that into the next uh environment up so we deploy it in there it's going",
    "start": "649279",
    "end": "654480"
  },
  {
    "text": "to go through some other kind of testing phase at which point again we'll ascertain is this work working or",
    "start": "654480",
    "end": "660399"
  },
  {
    "text": "not now if it's not then we loot back we run some uh fix and code model and we",
    "start": "660399",
    "end": "666000"
  },
  {
    "text": "push it back out again into the staging environment but if everything is still working all our tests are passed and at",
    "start": "666000",
    "end": "672000"
  },
  {
    "text": "that point we should be happy to to proceed to production right so we deploy it into production maybe we onun a",
    "start": "672000",
    "end": "678120"
  },
  {
    "text": "little bit of testing our customer starts using our service or our client does and then we have the fabulous thing",
    "start": "678120",
    "end": "685160"
  },
  {
    "text": "where we find out that something somehow is different and has changed so we're not quite sure the hell's going on because we've done loads of testing",
    "start": "685160",
    "end": "691079"
  },
  {
    "text": "we've been exceptionally well behaved but still it doesn't work so why why is why is this the",
    "start": "691079",
    "end": "697600"
  },
  {
    "start": "695000",
    "end": "695000"
  },
  {
    "text": "case so differences obviously so differences in the environment there are",
    "start": "697600",
    "end": "702880"
  },
  {
    "text": "the kind of disturbing differences which should we should never have but unfortunately do arise so differences",
    "start": "702880",
    "end": "708079"
  },
  {
    "text": "potentially in Hardware in the OS permissions maybe with the user profile any number of things maybe we've",
    "start": "708079",
    "end": "714200"
  },
  {
    "text": "iterated um through too many times and and something's going wrong maybe there are other things running on that box",
    "start": "714200",
    "end": "719639"
  },
  {
    "text": "which is which is um affecting our dependencies and causing us to break in in production",
    "start": "719639",
    "end": "725279"
  },
  {
    "text": "environment and in our particular case we have a lot of data this data is highly complex and highly interdependent",
    "start": "725279",
    "end": "732079"
  },
  {
    "text": "um and that often causes problems it's frequently the case that we have excellent prod uh data in production but",
    "start": "732079",
    "end": "738040"
  },
  {
    "text": "as you you go down through the environments the data degrades quite rapidly and also we have to rely on an",
    "start": "738040",
    "end": "743480"
  },
  {
    "text": "awful lot of third party systems other groups and maybe they just aren't as",
    "start": "743480",
    "end": "749199"
  },
  {
    "text": "well behaved as we are uh maybe they don't even have a de version of their system so what we have is we end up in",
    "start": "749199",
    "end": "756079"
  },
  {
    "text": "this typical kind of release cycle which which is certainly was familiar to us and I guess is pretty common out there",
    "start": "756079",
    "end": "761480"
  },
  {
    "text": "so we code we deploy maybe it works maybe it breaks we roll it back and then",
    "start": "761480",
    "end": "766560"
  },
  {
    "text": "we repeat we repeat and repeat the idea is or the fundamental thing is here",
    "start": "766560",
    "end": "771720"
  },
  {
    "text": "unless we can guarantee that our nonproduction environment is exactly identical to production there's no way",
    "start": "771720",
    "end": "776800"
  },
  {
    "text": "we can be 100% confident that when we push out to uction things will will definitely work um and try as hard as we",
    "start": "776800",
    "end": "783560"
  },
  {
    "text": "can it's it seems to be impossible for us at least to to ensure that we have some kind of a pre-production stage",
    "start": "783560",
    "end": "789199"
  },
  {
    "text": "where production is exactly identical so this is where we come back to our idea of production and testing to",
    "start": "789199",
    "end": "795519"
  },
  {
    "start": "791000",
    "end": "791000"
  },
  {
    "text": "ensure that when we go to production we can be confident that things are going to work so we um there a little tweak to",
    "start": "795519",
    "end": "804800"
  },
  {
    "text": "what what people normally do we're going to describe it now in a second so obviously we're going to write our code we're going to deploy it and we're",
    "start": "804800",
    "end": "810600"
  },
  {
    "text": "deploying a version which is a canary version so you can see it's red and that means that it's not actually handling or",
    "start": "810600",
    "end": "816440"
  },
  {
    "text": "delivering production responses out to clients it's still going to receive the produ the production requests but it's",
    "start": "816440",
    "end": "821800"
  },
  {
    "text": "not going to handle the responses back out um we're going to send in a bunch of",
    "start": "821800",
    "end": "827240"
  },
  {
    "text": "sample inputs we're going to check the output see if we're happy or not if we aren't then we're obviously going to make some changes redeploy and that that",
    "start": "827240",
    "end": "833240"
  },
  {
    "text": "version one is going to kind of iterate at some point we're going to test this we're going to test the inputs",
    "start": "833240",
    "end": "838839"
  },
  {
    "text": "we're test the outputs uh and we're going to be we're going to be confident that the version that we just pushed out is correct and proper and should go out",
    "start": "838839",
    "end": "845480"
  },
  {
    "text": "and be uh handling responses back out to our customers or clients uh and that's",
    "start": "845480",
    "end": "851120"
  },
  {
    "text": "now the publishing version in",
    "start": "851120",
    "end": "854720"
  },
  {
    "text": "production so we have this one version running in production something happens we need to make a change so we write",
    "start": "856160",
    "end": "862680"
  },
  {
    "text": "some more code we deploy it and we deploy a canary release into production now obviously one of the requirements",
    "start": "862680",
    "end": "868680"
  },
  {
    "text": "that we have and one of the the kind of deals we make with the people who use our platform is that if you're going to",
    "start": "868680",
    "end": "874199"
  },
  {
    "text": "have multiple versions of a service running in production then you have to C definitely not do certain things so if",
    "start": "874199",
    "end": "879759"
  },
  {
    "text": "this code for example was placing trades this would be very very bad if we had two Services placing the same trades so",
    "start": "879759",
    "end": "886800"
  },
  {
    "text": "it's important that we have a restriction and the idea is that people should not touch systems which have side",
    "start": "886800",
    "end": "891959"
  },
  {
    "text": "effects um so for example we must not write to a database we must not write to a file system we must not send emails",
    "start": "891959",
    "end": "898079"
  },
  {
    "text": "there are a great many things um this may seem exceptionally restrictive but we don't think it is and",
    "start": "898079",
    "end": "903360"
  },
  {
    "text": "we'll come back to that in a minute or so so we've we pushed Al Canary release",
    "start": "903360",
    "end": "908440"
  },
  {
    "text": "which has some modified business logic in it the and then we look at that and we",
    "start": "908440",
    "end": "914759"
  },
  {
    "text": "again all the the requests are coming into the system and there is a mirroring system which is mirroring all the",
    "start": "914759",
    "end": "919880"
  },
  {
    "text": "requests in reasonable time to all the different versions of this particular service we check we leave it running are",
    "start": "919880",
    "end": "927199"
  },
  {
    "text": "we happy no we decide we're not happy so we make some more changes and we deploy another alternate version of this",
    "start": "927199",
    "end": "932639"
  },
  {
    "text": "service so now we have the publishing version of our service which is handling our production request in which our",
    "start": "932639",
    "end": "937680"
  },
  {
    "text": "users our clients consumers whoever are using um and then we have two Canary releases which uh are running with",
    "start": "937680",
    "end": "943839"
  },
  {
    "text": "modified business logic maybe uh and for some reason we're not happy that they should go",
    "start": "943839",
    "end": "950319"
  },
  {
    "text": "out again we check the input we're checking the output for each of the different versions if we're happy then",
    "start": "950319",
    "end": "956600"
  },
  {
    "text": "we can promote that one to be the publishing version and then the other two revert to being Canary Canary",
    "start": "956600",
    "end": "961759"
  },
  {
    "text": "releases so now release three is the version of uh this particular service which which is handling production",
    "start": "961759",
    "end": "968680"
  },
  {
    "text": "requests so where are we we're in a position now where uh I don't really",
    "start": "969319",
    "end": "976120"
  },
  {
    "text": "need a Dev environment if I'm writing this code so hopefully we can deploy our code within this system the platform is",
    "start": "976120",
    "end": "983000"
  },
  {
    "text": "going to take care of all the operational concerns all the nonfunctional requirements I can focus on the particular um problem at hand and",
    "start": "983000",
    "end": "990079"
  },
  {
    "text": "I can have multiple versions We Do actually still have uh Dev and all the other environments but they're less and",
    "start": "990079",
    "end": "996519"
  },
  {
    "text": "less used the important thing here is our",
    "start": "996519",
    "end": "1002560"
  },
  {
    "start": "998000",
    "end": "998000"
  },
  {
    "text": "idea that microservices must be pure and there must be no alterations to external state so what I mentioned before was uh",
    "start": "1002560",
    "end": "1009000"
  },
  {
    "text": "the the obvious example about a trading system there are obvious examples about updating databases sending emails",
    "start": "1009000",
    "end": "1014920"
  },
  {
    "text": "touching the fast system any number of things um when we thought about this we",
    "start": "1014920",
    "end": "1020040"
  },
  {
    "text": "thought about how we structured our code and you know the common Paradigm within software development is you separate",
    "start": "1020040",
    "end": "1025319"
  },
  {
    "text": "what varies and what stays the same and in terms of and taking that analogy a little bit further we wanted to think",
    "start": "1025319",
    "end": "1030640"
  },
  {
    "text": "about the frequency of updates the frequency of what varies and to us if we think about a service that gives us the",
    "start": "1030640",
    "end": "1036520"
  },
  {
    "text": "capability place to trade interact with uh the file system a male system anything like that our interaction with",
    "start": "1036520",
    "end": "1043760"
  },
  {
    "text": "those services does not change or does not vary typically what varies is the object or the data payLo that we give to",
    "start": "1043760",
    "end": "1049640"
  },
  {
    "text": "those services or those other systems so what we've done here is we've uh",
    "start": "1049640",
    "end": "1055919"
  },
  {
    "text": "enforced uh this requirement on our users to make sure that they separate the business logic from the logic which",
    "start": "1055919",
    "end": "1062120"
  },
  {
    "text": "to which touches these stateful systems which have side effects",
    "start": "1062120",
    "end": "1067320"
  },
  {
    "text": "um because they're not doing this so for example if we have some logic which determines whether or not we should",
    "start": "1067320",
    "end": "1073440"
  },
  {
    "text": "place a trade we have the we have the log we have the logic running in a microservice and we have many different",
    "start": "1073440",
    "end": "1078840"
  },
  {
    "text": "different versions of it and the output of this service is just a tort telling us what kind of trade we should place",
    "start": "1078840",
    "end": "1085000"
  },
  {
    "text": "and then we have created another system which handles interactions with those Services which have um side effects so",
    "start": "1085000",
    "end": "1090919"
  },
  {
    "text": "by doing this we have the ability to run many multiple versions of the service in production and for these people in this",
    "start": "1090919",
    "end": "1097679"
  },
  {
    "text": "data division these 3,000 people to um do the thing they know best which is",
    "start": "1097679",
    "end": "1103440"
  },
  {
    "text": "right simple code which focuses on the area where they're the experts rather than us",
    "start": "1103440",
    "end": "1109720"
  },
  {
    "text": "they're also nice things I mentioned before about the ability uh we have for point in time data stores so we' have a",
    "start": "1109720",
    "end": "1116880"
  },
  {
    "text": "whole Suite of version systems version databases um and this is something",
    "start": "1116880",
    "end": "1122679"
  },
  {
    "text": "that's very very helpful so we can go back and if we push in a new version of a micr service we have all the requests",
    "start": "1122679",
    "end": "1129320"
  },
  {
    "text": "and responses cached from all previous interactions that the publishing version made um and we can go back and have a",
    "start": "1129320",
    "end": "1135600"
  },
  {
    "text": "point in time request on these other systems to say want the record for this particular key but I want it as of this",
    "start": "1135600",
    "end": "1141760"
  },
  {
    "text": "particular date rather than the current date and that means that we can push a new version of our microservice out into",
    "start": "1141760",
    "end": "1147440"
  },
  {
    "text": "production as a canary release and back test it very effectively with actual",
    "start": "1147440",
    "end": "1152520"
  },
  {
    "text": "live uh requests and responses from external systems the last bit here really is you",
    "start": "1152520",
    "end": "1159600"
  },
  {
    "start": "1157000",
    "end": "1157000"
  },
  {
    "text": "know it's pretty standard everybody's doing it um so how do people write their code so we we push our code to GitHub or",
    "start": "1159600",
    "end": "1165120"
  },
  {
    "text": "whoever wants to Rite a micros service pushes their code to GitHub you tag it uh we give people the ability to set",
    "start": "1165120",
    "end": "1170320"
  },
  {
    "text": "enas have secrets um and then it's entirely on a user hands to",
    "start": "1170320",
    "end": "1175559"
  },
  {
    "text": "say uh of those Canary releases maybe we nuke one and it's no longer active maybe",
    "start": "1175559",
    "end": "1180919"
  },
  {
    "text": "we switch which is the publishing version all of that is entirely in their hands so on to the next part which sat",
    "start": "1180919",
    "end": "1188360"
  },
  {
    "text": "will take you through okay thank you Paul hello",
    "start": "1188360",
    "end": "1195799"
  },
  {
    "text": "everyone my name is suin kog and I'm basically going to discuss uh the nuts",
    "start": "1195799",
    "end": "1200880"
  },
  {
    "text": "and bolts of our system how we built the system using kubernetes and some of the lessons we learned along the way some of",
    "start": "1200880",
    "end": "1207159"
  },
  {
    "text": "the pitfalls we encountered and our general approach and hopefully you can learn from that approach and perhaps not",
    "start": "1207159",
    "end": "1212679"
  },
  {
    "text": "make the same mistakes that we made okay so when we set out like building the",
    "start": "1212679",
    "end": "1217919"
  },
  {
    "start": "1216000",
    "end": "1216000"
  },
  {
    "text": "system that could be used by non-engineers and Engineers like Paul mentioned we had a shopping list of",
    "start": "1217919",
    "end": "1223039"
  },
  {
    "text": "things that we really wanted and what was in that shopping list well we wanted isolation um this is is the basic",
    "start": "1223039",
    "end": "1229840"
  },
  {
    "text": "concept that if you have a microservice that might have a bug in it or a flaw or might be malicious we don't want it to",
    "start": "1229840",
    "end": "1236039"
  },
  {
    "text": "affect any other microservice and we specifically don't want it to take down the whole system uh we want rendering of",
    "start": "1236039",
    "end": "1241720"
  },
  {
    "text": "dependencies so this is the concept where we have a microservice um it depends on versions XYZ of libraries a b",
    "start": "1241720",
    "end": "1248120"
  },
  {
    "text": "and c and we have another microservice that depends on uh versions TUV of the",
    "start": "1248120",
    "end": "1253679"
  },
  {
    "text": "exact same uh set of libraries a b and c and we want those two microservices is",
    "start": "1253679",
    "end": "1258799"
  },
  {
    "text": "to be able to coexist with each other and to be able to run simultaneously and not affect each other or we wanted",
    "start": "1258799",
    "end": "1266000"
  },
  {
    "text": "orchestration the basic idea being that we have microservices we want to deploy them across different nodes uh we want",
    "start": "1266000",
    "end": "1272240"
  },
  {
    "text": "to make sure that they're deployed in different availability zones and the idea that we want to be able to autoscale them depending on the amount",
    "start": "1272240",
    "end": "1278400"
  },
  {
    "text": "of traffic that we get depending on the CPU us it depending on various other constraints and like Paul mentioned we",
    "start": "1278400",
    "end": "1284240"
  },
  {
    "text": "wanted ease of deployment typically a single click deployment the ability to run multiple versions of a microservice",
    "start": "1284240",
    "end": "1290159"
  },
  {
    "text": "in parallel and the basic idea of having rolling updates and you know starting a new version up and then taking down",
    "start": "1290159",
    "end": "1296480"
  },
  {
    "text": "another version and finally we wanted self-healing so this is the idea if we",
    "start": "1296480",
    "end": "1301760"
  },
  {
    "text": "have a microservice that's crashing um we should be able to bring it back up and you know go on from there and",
    "start": "1301760",
    "end": "1308600"
  },
  {
    "text": "hopefully try to figure out why the microservice is crashing so in addition to all these things um the last three",
    "start": "1308600",
    "end": "1314760"
  },
  {
    "text": "two points are pretty obvious we want the whole system to be very stable and reliable and to have high availability",
    "start": "1314760",
    "end": "1321080"
  },
  {
    "text": "okay so that's our shopping list uh we're at kubernetes conference and kubernetes is obviously the best things",
    "start": "1321080",
    "end": "1327360"
  },
  {
    "start": "1323000",
    "end": "1323000"
  },
  {
    "text": "in sliced bread so we just deploy our system on kubernetes it all works we all go home everybody is Happy everything",
    "start": "1327360",
    "end": "1333960"
  },
  {
    "text": "works great awesome um unfortunately the real world is never as simple and not exactly the",
    "start": "1333960",
    "end": "1340360"
  },
  {
    "text": "same as an Ideal World so whenever you have a piece of technology that's been touted as the next best thing since",
    "start": "1340360",
    "end": "1346000"
  },
  {
    "text": "sliced bread it's been touted as you know this is the thing to use it's always helpful to take it with a grain",
    "start": "1346000",
    "end": "1351320"
  },
  {
    "text": "of salt to you know show a healthy degree of skepticism towards it and to actually really test it out take it",
    "start": "1351320",
    "end": "1357480"
  },
  {
    "text": "through the paces and try to figure out um it's making these you know awesome claims doesn't live up to them um so",
    "start": "1357480",
    "end": "1364559"
  },
  {
    "text": "what I want to cover in this next couple of slides is how we really tested out the system how we got comfortable with",
    "start": "1364559",
    "end": "1370320"
  },
  {
    "text": "it and what we learned along the way and hopefully you can learn from our experience um it's obviously there's no",
    "start": "1370320",
    "end": "1376360"
  },
  {
    "text": "way this is going to be an exhaustive list of things that we learned because we don't have the time to go through them but you know you should come and",
    "start": "1376360",
    "end": "1382679"
  },
  {
    "text": "talk to all of us okay sorry about that I don't know how",
    "start": "1382679",
    "end": "1388799"
  },
  {
    "text": "we",
    "start": "1388799",
    "end": "1391000"
  },
  {
    "text": "exited okay okay so back to our shopping list I",
    "start": "1398919",
    "end": "1407360"
  },
  {
    "text": "would argue that Docker does a very good job of packaging some great Linux features like you know cgroups name",
    "start": "1407360",
    "end": "1413840"
  },
  {
    "text": "spaces capabilities that gives us excellent isolation and vendoring of dependencies and kubernetes was really",
    "start": "1413840",
    "end": "1420520"
  },
  {
    "text": "designed for the concept of uh having orchestration easy deployment Autos",
    "start": "1420520",
    "end": "1425559"
  },
  {
    "text": "scaling um the things like that but what we really wanted to determine was if we deployed a cluster using kubernetes is",
    "start": "1425559",
    "end": "1433080"
  },
  {
    "text": "it stable is it reliable is it so uh High highly available um and before I continue I",
    "start": "1433080",
    "end": "1440240"
  },
  {
    "text": "just wanted to mention two caveats the first one is that kubernetes is a very fast moving Target so anything that I'm",
    "start": "1440240",
    "end": "1446080"
  },
  {
    "text": "mentioning right now and that's true right now is probably not going to be true a month down the line and it's definitely not going to be true a year",
    "start": "1446080",
    "end": "1452799"
  },
  {
    "text": "down the line um and the second thing is none of this that none of the points",
    "start": "1452799",
    "end": "1458200"
  },
  {
    "text": "that I'm going to mention should be taken as a criticism of kubernetes itself um it's more about how we went",
    "start": "1458200",
    "end": "1465200"
  },
  {
    "text": "about testing the system um deploying it learning from our experiences and hopefully you can take those methods or",
    "start": "1465200",
    "end": "1472360"
  },
  {
    "text": "you can you know take something from our experience and use it in your own Enterprises and your own",
    "start": "1472360",
    "end": "1478559"
  },
  {
    "text": "clusters so with that in mind I just wanted to briefly discuss our um basic",
    "start": "1478559",
    "end": "1483799"
  },
  {
    "start": "1480000",
    "end": "1480000"
  },
  {
    "text": "architecture so that we're all on the same page and we all understand you know how it worked um so we have any number",
    "start": "1483799",
    "end": "1489840"
  },
  {
    "text": "of data centers uh for space restrictions I can only show two on the slide but you know we have multiple data centers and we have multiple kubernetes",
    "start": "1489840",
    "end": "1497840"
  },
  {
    "text": "clusters running on those data centers they're more or less or actually they're supposed to be exactly identical so our",
    "start": "1497840",
    "end": "1503880"
  },
  {
    "text": "kubernetes clusters are supposed to be identical across data centers uh we have uh five Master nodes what this means is",
    "start": "1503880",
    "end": "1511399"
  },
  {
    "text": "that we are able to survive two node failures and then we have any number of worker notes and all our data centers",
    "start": "1511399",
    "end": "1516960"
  },
  {
    "text": "are combined together using a load balancer uh diving in a little bit deeper into what our Master notes look",
    "start": "1516960",
    "end": "1523640"
  },
  {
    "text": "like um at the bottom you can see we have flannel D um that's basically to allow communication between pods running",
    "start": "1523640",
    "end": "1530880"
  },
  {
    "text": "on two different nodes uh like I mentioned we're using Docker for isolation rendering um and then we have",
    "start": "1530880",
    "end": "1537679"
  },
  {
    "text": "cuet and Cube proxy which is running on every single node uh we also have this thing called a k8s API server proxy and",
    "start": "1537679",
    "end": "1544600"
  },
  {
    "text": "I'm going to go into the details of why we need that and what that is in a in a little bit um so keep that in mind that",
    "start": "1544600",
    "end": "1551360"
  },
  {
    "text": "there's some that I haven't explained right now and finally this is a master node so we obviously need the master",
    "start": "1551360",
    "end": "1556720"
  },
  {
    "text": "components which means we have the API server we have the scheduler we have the controller manager we have etcd as our",
    "start": "1556720",
    "end": "1562480"
  },
  {
    "text": "source of Truth and we have qpns going on to a worker node it looks",
    "start": "1562480",
    "end": "1567720"
  },
  {
    "text": "very very similar to uh Master node so obviously we have fald Docker we have the various components like CET and C",
    "start": "1567720",
    "end": "1574440"
  },
  {
    "text": "proxy again we have the API server proxy but instead of the master components which is you know the API server",
    "start": "1574440",
    "end": "1580320"
  },
  {
    "text": "scheduler and controller manager we have pods and even though over here it shows you know microservice pod one",
    "start": "1580320",
    "end": "1586360"
  },
  {
    "text": "microservice part two in some cases in a lot of cases there might be the exact same version of the microservice or as",
    "start": "1586360",
    "end": "1592440"
  },
  {
    "text": "Paul mentioned there might be different versions of the same microservice running and finally we have a reverse",
    "start": "1592440",
    "end": "1597600"
  },
  {
    "text": "proxy to tie it all together and so that we can access the various pods",
    "start": "1597600",
    "end": "1603080"
  },
  {
    "start": "1603000",
    "end": "1603000"
  },
  {
    "text": "okay so now that we have a basic understanding of our architecture and you know a common um set of things to",
    "start": "1603080",
    "end": "1610840"
  },
  {
    "text": "talk about let's discuss about how we evaluated our system we are firm Believers in the maxim that the only",
    "start": "1610840",
    "end": "1616880"
  },
  {
    "text": "real way to know how a system works works is to try to break it so we wrote this piece of tool that's called",
    "start": "1616880",
    "end": "1622440"
  },
  {
    "text": "powerful seal it's our chaos monkey and the idea behind powerful seal is it breaks things so that we can understand",
    "start": "1622440",
    "end": "1628000"
  },
  {
    "text": "how things work um so what can we do with power seal I'm not sure if you can read the",
    "start": "1628000",
    "end": "1634799"
  },
  {
    "text": "slides but just to go through them it allows us to view an inventory of all the notes in our system so we can see",
    "start": "1634799",
    "end": "1640679"
  },
  {
    "text": "what are the notes in the system we can see we can group them by availability zones we can group them by components so",
    "start": "1640679",
    "end": "1645760"
  },
  {
    "text": "we can see which ones are Master nodes which ones are worker noes um and have a good idea of what's in our",
    "start": "1645760",
    "end": "1651720"
  },
  {
    "text": "system um the other thing that allows us to do is look at the status of various components that are running on those",
    "start": "1651720",
    "end": "1657919"
  },
  {
    "text": "particular nodes so if you wanted to look at the status of let's say the cuet node that was running on all the notes",
    "start": "1657919",
    "end": "1664240"
  },
  {
    "text": "on a particular availability Zone we can do that uh we can look at the status of let's say the API server or the master",
    "start": "1664240",
    "end": "1671080"
  },
  {
    "text": "and collect um the status from all the various components and it also allows us",
    "start": "1671080",
    "end": "1676279"
  },
  {
    "text": "to give s the ability to tail or collect logs across nodes so",
    "start": "1676279",
    "end": "1681679"
  },
  {
    "text": "what this means is if you wanted to collect the logs from all the API servers from all the Masters we can do",
    "start": "1681679",
    "end": "1686880"
  },
  {
    "text": "that if you wanted to collect logs from let's say all the cubet components from all the nodes in a particular",
    "start": "1686880",
    "end": "1692039"
  },
  {
    "text": "availability Zone we can do that um and finally it really wouldn't be much of a",
    "start": "1692039",
    "end": "1697960"
  },
  {
    "text": "chaos monkey if it wasn't able to take things down and the part of the reason why we designed the system was mainly to",
    "start": "1697960",
    "end": "1705000"
  },
  {
    "text": "take things down um so what we can do is we can take down a node we can take down an entire availability Zone um and we",
    "start": "1705000",
    "end": "1712039"
  },
  {
    "text": "can also do things like you know watch the things go down in real time see what's happening and once things have",
    "start": "1712039",
    "end": "1718120"
  },
  {
    "text": "gone down we can try and see you know collect logs from them and see what really happened um so this is some great",
    "start": "1718120",
    "end": "1723760"
  },
  {
    "text": "work that mik did um in building this system okay so now we have powerful seal",
    "start": "1723760",
    "end": "1730320"
  },
  {
    "text": "we have the ability to take take down notes we have the ability to take down components we also have the ability to take down things in production you know",
    "start": "1730320",
    "end": "1737399"
  },
  {
    "text": "running in Auto smash mode when it's you know continuously running and what can be learned um so this is the St of you",
    "start": "1737399",
    "end": "1745880"
  },
  {
    "text": "know uh Lessons Learned or how we learned to stop worrying and love kubernetes um I'm not going to go",
    "start": "1745880",
    "end": "1751760"
  },
  {
    "text": "through all the lessons learned all the you know pain points all the things that we experien come talk to us if you want to know more I'm only going to discuss",
    "start": "1751760",
    "end": "1758279"
  },
  {
    "text": "three stories and these three stories are kind of illustrative of the things",
    "start": "1758279",
    "end": "1763320"
  },
  {
    "text": "that we tried the things that we learned and some lessons that you can do okay so",
    "start": "1763320",
    "end": "1768399"
  },
  {
    "text": "the first story this was very early on we started out with you know deploying a",
    "start": "1768399",
    "end": "1774039"
  },
  {
    "text": "kubernetes cluster deploying a couple of PS running microservices and them testing it out and we're like okay great",
    "start": "1774039",
    "end": "1780159"
  },
  {
    "text": "this works let's take things down so we used powerful seal we took down one particular node uh we decided to take",
    "start": "1780159",
    "end": "1786919"
  },
  {
    "text": "down not only one any node we decided to take down a master node and because we were lazy and you know we just decided",
    "start": "1786919",
    "end": "1794279"
  },
  {
    "text": "we pick the first master so we took down the first Master node and and things didn't quite work as expected things",
    "start": "1794279",
    "end": "1800880"
  },
  {
    "text": "broke um so why was this well it turns out that cubet and some various other",
    "start": "1800880",
    "end": "1806960"
  },
  {
    "text": "kubernetes components can't really have deal with multiple API servers which means that even though cuet accepts a",
    "start": "1806960",
    "end": "1812720"
  },
  {
    "text": "command line flag that allows you to specify multiple API servers in actual fact what cuet does is it talks to the",
    "start": "1812720",
    "end": "1819880"
  },
  {
    "start": "1813000",
    "end": "1813000"
  },
  {
    "text": "first API server tries to contacted if it can't reach the first API out server it does not even try to go to the next",
    "start": "1819880",
    "end": "1825919"
  },
  {
    "text": "one and this was very very surprising to us um so there are outstanding issues on",
    "start": "1825919",
    "end": "1832000"
  },
  {
    "text": "GitHub uh and you can read up on that the reason you know if this this is a really big deal um you know but we're",
    "start": "1832000",
    "end": "1838600"
  },
  {
    "text": "surprised that you know other people did not face that and the reason for that is that the way people deployed them they",
    "start": "1838600",
    "end": "1843960"
  },
  {
    "text": "run the API server behind some kind of a load balancer that's provided by the Google Cloud engine or by AWS which does",
    "start": "1843960",
    "end": "1850559"
  },
  {
    "text": "the proxy to multiple API servers um we were running on bare metal or open stack",
    "start": "1850559",
    "end": "1855600"
  },
  {
    "text": "where we didn't have access to that or we didn't know we needed access to that um so we ran into this issue very early",
    "start": "1855600",
    "end": "1862080"
  },
  {
    "text": "on the way we solved this problem was remember when I discussed the architecture stes when I was discussing",
    "start": "1862080",
    "end": "1867519"
  },
  {
    "text": "the various notes and I had a KS API server proxy so we're running a proxy server on every single node and it's",
    "start": "1867519",
    "end": "1873720"
  },
  {
    "text": "only job is to proxy request going to the API server amongst the various Master nodes so that even if the first",
    "start": "1873720",
    "end": "1880639"
  },
  {
    "text": "API server goes down it's able to contact the various other API servers so this is an example of",
    "start": "1880639",
    "end": "1886720"
  },
  {
    "text": "something that we wouldn't have learned learned if we didn't take things down and figure the figure it out okay our",
    "start": "1886720",
    "end": "1893080"
  },
  {
    "text": "second example so we had our you know kubernetes cluster running for a while things were working great and very soon",
    "start": "1893080",
    "end": "1899320"
  },
  {
    "text": "once you know we found out that for some reason there were pods running on a particular note that weren't able to",
    "start": "1899320",
    "end": "1904639"
  },
  {
    "text": "communicate with pods running on another node um so why is that okay so on",
    "start": "1904639",
    "end": "1910960"
  },
  {
    "text": "further investigation we found out flannel D which handles the communication between um parts that is",
    "start": "1910960",
    "end": "1916639"
  },
  {
    "text": "running on One Note with parts that are running on the other note uh crashed on a particular note and was no longer",
    "start": "1916639",
    "end": "1922840"
  },
  {
    "text": "running and specifically it had died because of a sick pipe um so first question well why did it die uh we found",
    "start": "1922840",
    "end": "1930480"
  },
  {
    "text": "out what really happens is we had a microservice that was generating a ton of logs and the microservice were",
    "start": "1930480",
    "end": "1937679"
  },
  {
    "text": "and we were using Docker which was actually um using the journal D log driver and at some point in time Journal",
    "start": "1937679",
    "end": "1943760"
  },
  {
    "text": "D could not handle that number of logs so Journal D crashed Journal was restarted by System D um however what",
    "start": "1943760",
    "end": "1951760"
  },
  {
    "text": "happens when you have a process that's trying to write to an open file descriptor and whatever is listening at",
    "start": "1951760",
    "end": "1956840"
  },
  {
    "text": "the other end of the file descriptor crashes you get a sick pipe um unless you handle sick pipe well in that",
    "start": "1956840",
    "end": "1962880"
  },
  {
    "text": "situation you are going to crash um also uh how many of you have actually written",
    "start": "1962880",
    "end": "1968600"
  },
  {
    "text": "code in which you know you try to handle errors in writing to STD out or STD error I bet you almost no one we don't",
    "start": "1968600",
    "end": "1976000"
  },
  {
    "text": "expect STD out or STD error to crash yet we expect our microservices we the standard idea is oh just write your logs",
    "start": "1976000",
    "end": "1982840"
  },
  {
    "text": "to STD out and STD a and we'll collect them for you and we'll display them for you in a nice way okay so flannel D was",
    "start": "1982840",
    "end": "1990799"
  },
  {
    "text": "crashing now here's the other interesting part of the situation it crashed with a Sig pipe and system D",
    "start": "1990799",
    "end": "1996679"
  },
  {
    "text": "which is responsible for starting these services and restarting them consider Sig pipe to be one of the normal",
    "start": "1996679",
    "end": "2002480"
  },
  {
    "text": "conditions for exit which means that if if a process goes down because of Si pipe it will not be restarted okay so",
    "start": "2002480",
    "end": "2009519"
  },
  {
    "text": "how do we fix this issue well number one we make sure flanel restarts no matter what happens the other way we did it was",
    "start": "2009519",
    "end": "2016080"
  },
  {
    "text": "we developed a tool which we called gold Pinger uh what this real tool does is it basically um runs as a demon set so it's",
    "start": "2016080",
    "end": "2023760"
  },
  {
    "text": "running a pod on every single node and its only job is to communicate with pods",
    "start": "2023760",
    "end": "2028960"
  },
  {
    "text": "on other nodes and try to Ping them using an HTTP ping and if it can reach the other nodes okay things are good",
    "start": "2028960",
    "end": "2034960"
  },
  {
    "text": "great if not uh we'll it will tell us about it so this is the way in which we",
    "start": "2034960",
    "end": "2040120"
  },
  {
    "text": "can graph the problem we can see what notes are read we can dive down and see which notes can't communicate to what",
    "start": "2040120",
    "end": "2045519"
  },
  {
    "text": "other notes and we have uh hooked this up with Prometheus and alerting so that we're able to tie it all together and",
    "start": "2045519",
    "end": "2053079"
  },
  {
    "text": "the moment communication between any two notes fails we're informed about it so that we can look at look at it and try",
    "start": "2053079",
    "end": "2058398"
  },
  {
    "text": "to figure out what's happening so that's our next tool um the lesson learned over",
    "start": "2058399",
    "end": "2063520"
  },
  {
    "text": "here is basically whenever you have a complex system with very uh with a number of moving parts and a number of",
    "start": "2063520",
    "end": "2069638"
  },
  {
    "text": "interdependent components you can have a failure in one component which is like a microservice that's writing too many",
    "start": "2069639",
    "end": "2076000"
  },
  {
    "text": "logs or something like that cost a completely separate system that's not a dependency and you know that has nothing",
    "start": "2076000",
    "end": "2081878"
  },
  {
    "text": "to do with it to fail for example funnel D okay so our final lesson learned so",
    "start": "2081879",
    "end": "2088200"
  },
  {
    "text": "you know right now you have deployed a kubernetes cluster or you've deployed a couple of clusters you have been testing",
    "start": "2088200",
    "end": "2093398"
  },
  {
    "text": "you know it for a while in Dev you've deployed a whole bunch of microservices you've taken things down you've put them",
    "start": "2093399",
    "end": "2099680"
  },
  {
    "text": "back up you've learned a whole bunch of things great now you're ready to deploy to production everything's going to work",
    "start": "2099680",
    "end": "2105320"
  },
  {
    "text": "great awesome um not so fast even if you do all that it really really helps to",
    "start": "2105320",
    "end": "2111680"
  },
  {
    "text": "try to understand how the sausage was made uh what are the various components how they're built how they're put",
    "start": "2111680",
    "end": "2118640"
  },
  {
    "text": "together and what issues or what design decisions they made so I just put the",
    "start": "2118640",
    "end": "2123720"
  },
  {
    "text": "slide up here you know there could be a lot of discussions about this but these are you know security concerns that",
    "start": "2123720",
    "end": "2128760"
  },
  {
    "text": "wouldn't be obvious unless you really understand understood what the various components were how they interact with",
    "start": "2128760",
    "end": "2133960"
  },
  {
    "text": "each other and um how they operate so for example the communication between",
    "start": "2133960",
    "end": "2139760"
  },
  {
    "text": "the API server and coulet is broken it's susceptible to man in the middle attacks this is something that was uh really",
    "start": "2139760",
    "end": "2146560"
  },
  {
    "text": "true uh in the versions 1.1 1.2 and later versions it's gradually being",
    "start": "2146560",
    "end": "2153119"
  },
  {
    "text": "fixed uh right now most of the communication has been secured but this really tells you that security was you",
    "start": "2153119",
    "end": "2159200"
  },
  {
    "text": "know thought of as an add-on as opposed to being designed from the scratch and they're things that have been fixed",
    "start": "2159200",
    "end": "2164359"
  },
  {
    "text": "along the way um but are we're still not there where we have 100% security um the",
    "start": "2164359",
    "end": "2170160"
  },
  {
    "text": "other thing is you couldn't really completely disable the insecure port and the C uh on the API server uh this has",
    "start": "2170160",
    "end": "2176319"
  },
  {
    "text": "now been fixed it's not in the current version of kubernetes so it's not in 1.4 but it is it will be available in 1.5",
    "start": "2176319",
    "end": "2182839"
  },
  {
    "text": "and later versions um but one of the key things that's still outstanding for us from a security perspective is that",
    "start": "2182839",
    "end": "2189079"
  },
  {
    "text": "certificate re revocations is not supported what this really means is that",
    "start": "2189079",
    "end": "2194240"
  },
  {
    "text": "uh if you have a client certificate that's stolen you really don't have any choice but to redeploy all your",
    "start": "2194240",
    "end": "2199560"
  },
  {
    "text": "certificates to rebuild the system and go from there okay so just to summarize uh what",
    "start": "2199560",
    "end": "2206680"
  },
  {
    "text": "our approach and what we hope you learn from this is okay you know try to deploy",
    "start": "2206680",
    "end": "2212359"
  },
  {
    "text": "clusters try to break them try to take down notes try to um you know see how it works",
    "start": "2212359",
    "end": "2218359"
  },
  {
    "text": "secondly um basically when you have a when you have a complex system with a",
    "start": "2218359",
    "end": "2223400"
  },
  {
    "text": "lot of various components a problem in one component that's not directly related to another component can take it",
    "start": "2223400",
    "end": "2228640"
  },
  {
    "text": "down so be aware of that um and finally uh and this is where I I really want to",
    "start": "2228640",
    "end": "2235599"
  },
  {
    "text": "shout out to the kubernetes community and to the open source Community uh try to understand how the system is built",
    "start": "2235599",
    "end": "2241880"
  },
  {
    "text": "and since kubernetes everything is transparent everything is in GitHub you can read all the issues you can try to",
    "start": "2241880",
    "end": "2247200"
  },
  {
    "text": "understand how how it works and you can really try to get a feel of you know what things have or what design decisions were made and what things",
    "start": "2247200",
    "end": "2254599"
  },
  {
    "text": "work okay so with that um we're hiring in various different locations London",
    "start": "2254599",
    "end": "2260400"
  },
  {
    "start": "2255000",
    "end": "2255000"
  },
  {
    "text": "New York Princeton please contact Paul if you're interested uh as we hope you will will be um I'd like to give a shout",
    "start": "2260400",
    "end": "2267560"
  },
  {
    "text": "out to Mike and Miko who did much of the work that I presented over here um and",
    "start": "2267560",
    "end": "2272599"
  },
  {
    "text": "with that I'd like to open it up to questions thank you",
    "start": "2272599",
    "end": "2278400"
  },
  {
    "text": "[Applause]",
    "start": "2278400",
    "end": "2284679"
  },
  {
    "text": "questions so Paul you mentioned that testing the",
    "start": "2286599",
    "end": "2292560"
  },
  {
    "text": "micr services they couldn't leave any external Footprints could change any external State some point your",
    "start": "2292560",
    "end": "2298960"
  },
  {
    "text": "application change external",
    "start": "2298960",
    "end": "2302760"
  },
  {
    "text": "State yeah so um I don't know if everyone got that the question is at some point if you touch these external",
    "start": "2304599",
    "end": "2309760"
  },
  {
    "text": "systems you must have some some kind of impact um I mean we we didn't really",
    "start": "2309760",
    "end": "2316319"
  },
  {
    "text": "care particularly if for example we spewed in logs on some service that we were calling that wasn't a consideration",
    "start": "2316319",
    "end": "2321480"
  },
  {
    "text": "of us um and similar it wasn't necessarily consideration of our we call a service and we have some kind of",
    "start": "2321480",
    "end": "2327319"
  },
  {
    "text": "degradation of service in that service if that makes sense what we wanted was that um if we made a call to a service",
    "start": "2327319",
    "end": "2334839"
  },
  {
    "text": "so for example uh a get call then every time we make that get call we should get the",
    "start": "2334839",
    "end": "2340599"
  },
  {
    "text": "same response and there should be no impact there um I it's kind of like a slippery slope to start talking about",
    "start": "2340599",
    "end": "2346319"
  },
  {
    "text": "item potency and side effects and repeatability and stuff because we we didn't necessarily want that because we",
    "start": "2346319",
    "end": "2351680"
  },
  {
    "text": "didn't want the idea that you could for example delete a record in a database and keep deleting that record and that",
    "start": "2351680",
    "end": "2357760"
  },
  {
    "text": "would kind of be okay that's definitely not what we wanted um so we the the way",
    "start": "2357760",
    "end": "2363200"
  },
  {
    "text": "I always kind of think about it is kind of like almost embracing a functional paradigm we have very clearly defined",
    "start": "2363200",
    "end": "2368520"
  },
  {
    "text": "inputs and outputs and then it becomes exceptionally easy to test your code it's it's trivial to test your code then",
    "start": "2368520",
    "end": "2374440"
  },
  {
    "text": "and the key thing to our mind was that business logic is the thing that varies all the time it's not the interaction",
    "start": "2374440",
    "end": "2380200"
  },
  {
    "text": "with the database or all these other kind of libraries and services it's just like that computation that you do so",
    "start": "2380200",
    "end": "2386640"
  },
  {
    "text": "separate that bring that out make it trivial to run new versions of that alternate versions of that and give some",
    "start": "2386640",
    "end": "2393680"
  },
  {
    "text": "really really nice clean way to test it amazingly well and then we can race his",
    "start": "2393680",
    "end": "2400720"
  },
  {
    "text": "confidence that other",
    "start": "2400920",
    "end": "2409039"
  },
  {
    "text": "questions well please feel free to come and talk to us afterwards like I said this is a production system that's been",
    "start": "2413520",
    "end": "2418960"
  },
  {
    "text": "running for for a year without cubanes or probably eight months without cues uh",
    "start": "2418960",
    "end": "2424400"
  },
  {
    "text": "and then the last four or five months on cues so the initial version was significantly more uh naive than the",
    "start": "2424400",
    "end": "2431880"
  },
  {
    "text": "version that we have now so Cuban's added a lot um I would say through that kind of process uh we we learned a lot",
    "start": "2431880",
    "end": "2439000"
  },
  {
    "text": "more lessons than this so uh people talked about fluent D at the keynote speeches yesterday I think we had a",
    "start": "2439000",
    "end": "2445400"
  },
  {
    "text": "really interesting uh journey and um over kind of log aggregation and lob",
    "start": "2445400",
    "end": "2452000"
  },
  {
    "text": "shipping I think there's a lot of interesting conversations to have there um we use Prometheus at the moment but",
    "start": "2452000",
    "end": "2457839"
  },
  {
    "text": "we have different ideas or concepts of different types of logging within our system so we use Prometheus for some",
    "start": "2457839",
    "end": "2464599"
  },
  {
    "text": "data and we use other kinds of data stores for other kinds of data as well so you know if people want to come and",
    "start": "2464599",
    "end": "2469960"
  },
  {
    "text": "pick our brains please feel free okay thank you",
    "start": "2469960",
    "end": "2478040"
  },
  {
    "text": "[Applause]",
    "start": "2478040",
    "end": "2482159"
  }
]