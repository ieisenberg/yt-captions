[
  {
    "text": "all right hello everybody um I saw this giant room they scheduled us for for a talk on DNS it was a little surprise but",
    "start": "199",
    "end": "6839"
  },
  {
    "text": "actually it's filling up not too bad um my name is John bck uh I'm from Google",
    "start": "6839",
    "end": "11960"
  },
  {
    "text": "and this is uh young want to introduce yourself or I'll just be long so Yang is",
    "start": "11960",
    "end": "18160"
  },
  {
    "text": "at ofan and um we are here to talk about CNS",
    "start": "18160",
    "end": "23920"
  },
  {
    "text": "um so what is cord I don't know how many of you actually are familiar I mean if",
    "start": "24039",
    "end": "29480"
  },
  {
    "text": "you've been using kubernetes you may have been using it without knowing it how many are you familiar with with gordian that's pretty good um so yeah",
    "start": "29480",
    "end": "37480"
  },
  {
    "text": "it's it when when uh kubernetes first started",
    "start": "37480",
    "end": "42520"
  },
  {
    "text": "uh it it had a very strange DNS implementation that included um sort of",
    "start": "42520",
    "end": "48600"
  },
  {
    "text": "a DNS mask running in a in a pod along with ETD running in the same pod and a",
    "start": "48600",
    "end": "55079"
  },
  {
    "text": "special controller that wrote the DNS config file DNS mask config files so",
    "start": "55079",
    "end": "60559"
  },
  {
    "text": "that it could serve up things and and um Yang and I at the time were at a a",
    "start": "60559",
    "end": "65600"
  },
  {
    "text": "company called infol blocks which some of you may know and uh and we we were like this is insane and so we um our uh",
    "start": "65600",
    "end": "74040"
  },
  {
    "text": "our chief uh DNS guy there uh cricket Lou he he hooked us up with somebody at",
    "start": "74040",
    "end": "79520"
  },
  {
    "text": "Google who had been building a um this cordan s thing we're like what is this thing so we actually worked with him and",
    "start": "79520",
    "end": "86520"
  },
  {
    "text": "we we worked to get it uh integrated with kubernetes so that instead of having these three processes all running",
    "start": "86520",
    "end": "92880"
  },
  {
    "text": "in a pod and sort of a lot of failure points and other issues um we had a",
    "start": "92880",
    "end": "97920"
  },
  {
    "text": "single process that talk directly to the cube API server um and of course does a",
    "start": "97920",
    "end": "103560"
  },
  {
    "text": "lot of other things so the the whole goal behind it wasn't just to work with kubernetes but to work with um in in",
    "start": "103560",
    "end": "112399"
  },
  {
    "text": "general in Cloud native ecosystems at this time of course kubernetes wasn't the only uh container orchestrator uh of",
    "start": "112399",
    "end": "119880"
  },
  {
    "text": "of uh Merit and so uh we intended to integrate with others but but of course",
    "start": "119880",
    "end": "125039"
  },
  {
    "text": "kubernetes is one uh and we primarily do kubernetes now although we also integrate and people use it as just an",
    "start": "125039",
    "end": "131440"
  },
  {
    "text": "ordinary DNS server so hopefully you can check it out for some of that that as well um the the idea is instead of just",
    "start": "131440",
    "end": "139319"
  },
  {
    "text": "serving based on you know traditional Zone files you can serve up DNS from",
    "start": "139319",
    "end": "144480"
  },
  {
    "text": "anywhere from any Source uh and then you can also put uh plugins within the",
    "start": "144480",
    "end": "151239"
  },
  {
    "text": "request processing pipeline of the DNS request so that you can do interesting and novel things that are really",
    "start": "151239",
    "end": "157640"
  },
  {
    "text": "challenging to do in traditional DNS servers so architecturally uh we wrote",
    "start": "157640",
    "end": "163239"
  },
  {
    "text": "it in go or you know the meek who first wrote it wrote it and go and we we enhanced it um as a community we've",
    "start": "163239",
    "end": "169239"
  },
  {
    "text": "continued uh to enhance it over over the last few years um service Discovery with",
    "start": "169239",
    "end": "174920"
  },
  {
    "text": "or without kubernetes is a focus but not the only thing we do um that plug",
    "start": "174920",
    "end": "179959"
  },
  {
    "text": "architecture allows us to do interesting things um we also added some being being sort of trying to do novel things and",
    "start": "179959",
    "end": "187519"
  },
  {
    "text": "and experiment and see where things are going in the future which is it kind of provides an excellent base for that we we did some new and novel things like",
    "start": "187519",
    "end": "194200"
  },
  {
    "text": "DNS over grpc that's not a standard that is a cords thing um but actually people",
    "start": "194200",
    "end": "200239"
  },
  {
    "text": "use it and you could do really interesting things like pass you know um uh distributed tracing spans across your",
    "start": "200239",
    "end": "207000"
  },
  {
    "text": "DNS if you use that and so you can kind of get visibility into your entire request flow including the DNS portion",
    "start": "207000",
    "end": "213519"
  },
  {
    "text": "in ways that you really couldn't before and you can also use it to integrate with policy engines which is something",
    "start": "213519",
    "end": "218599"
  },
  {
    "text": "we do as well um the",
    "start": "218599",
    "end": "223879"
  },
  {
    "text": "the other integration that probably is more commonly used other than file and kubernetes are the ones to the cloud",
    "start": "223879",
    "end": "230439"
  },
  {
    "text": "providers so essentially we can provide and we'll show some more detail on this in a little bit but you can use the same",
    "start": "230439",
    "end": "236439"
  },
  {
    "text": "DNS server core DNS to uh front for zones in any of your different clouds",
    "start": "236439",
    "end": "243480"
  },
  {
    "text": "and so you you kind of can bring everything together in one in one place",
    "start": "243480",
    "end": "248879"
  },
  {
    "text": "there um so we do have 350 contributors um we have a lot of folks who've because",
    "start": "248879",
    "end": "256280"
  },
  {
    "text": "it's a plugin architecture what what will happen is somebody will have a particular interest uh and they'll develop a particular plugin and then",
    "start": "256280",
    "end": "262520"
  },
  {
    "text": "they can you know obviously they become a contributor but if they're really interested in continuing on and maintaining and owning that plugin then",
    "start": "262520",
    "end": "269160"
  },
  {
    "text": "they can they can become a maintainer as well so it's a although 350 is uh a",
    "start": "269160",
    "end": "274680"
  },
  {
    "text": "large number it actually is a pretty small community um and so you know we'd",
    "start": "274680",
    "end": "279840"
  },
  {
    "text": "love to have any of you come and join us uh we we you know recently we have like",
    "start": "279840",
    "end": "286520"
  },
  {
    "text": "I said mostly contributions around individual plugins there's some bigger things we'd like to do but we haven't uh",
    "start": "286520",
    "end": "292360"
  },
  {
    "text": "had the you know we need the right the right contributor who has the right need to make those things",
    "start": "292360",
    "end": "298560"
  },
  {
    "text": "happen um recently our project lead who was Meek Gibbon who started the project uh",
    "start": "298560",
    "end": "306120"
  },
  {
    "text": "he uh has decided to go on and do other things and so we've moved to a steering committee governance model so that's the",
    "start": "306120",
    "end": "312800"
  },
  {
    "text": "last item on this slide where it changes our governance Model A little bit but honestly we've never had to escalate",
    "start": "312800",
    "end": "318440"
  },
  {
    "text": "anything to the steering committee because it's a pretty friendly place so what have we been up to",
    "start": "318440",
    "end": "325199"
  },
  {
    "text": "recently um we just uh released 1.11.1 not that long ago um we have one new",
    "start": "325199",
    "end": "332720"
  },
  {
    "text": "plugin in there and then enhancements to existing plugins um as I said we do some",
    "start": "332720",
    "end": "338120"
  },
  {
    "text": "novel things so you know some of the interesting things uh you see these",
    "start": "338120",
    "end": "343240"
  },
  {
    "text": "these plugins on here things like a template allows you to sort of uh dynamically generate records based upon",
    "start": "343240",
    "end": "349840"
  },
  {
    "text": "the metadata that comes in on the request so really things you don't normally see in a DNS server so I love",
    "start": "349840",
    "end": "355400"
  },
  {
    "text": "to have um have people play with those and see what they think uh I think that's it for the",
    "start": "355400",
    "end": "361360"
  },
  {
    "text": "project updates Yang you want to talk a little bit about service Discovery and some of the ideas there okay yes okay so",
    "start": "361360",
    "end": "368000"
  },
  {
    "text": "Ser Discovery is obviously one my favorite topic your mic's not",
    "start": "368000",
    "end": "374120"
  },
  {
    "text": "on oh and I wanted to say before that we do have a bunch of Swag up here so after",
    "start": "374360",
    "end": "380000"
  },
  {
    "text": "the talk you guys can come up and grab some and uh uh enjoy yeah I I want to discuss about s",
    "start": "380000",
    "end": "387720"
  },
  {
    "text": "Discovery that's my favorite topic in DNS uh many people probably ask okay so",
    "start": "387720",
    "end": "392800"
  },
  {
    "text": "Discovery by itself sounds like interesting but how is that related to DNS no DNS seem to be pretty simple",
    "start": "392800",
    "end": "399360"
  },
  {
    "text": "right it's a uh DS record with just one string with IP address what else do you",
    "start": "399360",
    "end": "405680"
  },
  {
    "text": "expect right how is that D going to translate anything interesting into service Discovery but I want discuss",
    "start": "405680",
    "end": "414120"
  },
  {
    "text": "that in several different angles so first of all why D still exist you know",
    "start": "414120",
    "end": "419639"
  },
  {
    "text": "nowadays you have SDM you have self defined networking that can Define anything you like you you're not limited",
    "start": "419639",
    "end": "425599"
  },
  {
    "text": "by like cyer Brock you your IP address space can can randomly assign any way",
    "start": "425599",
    "end": "430879"
  },
  {
    "text": "you want right everything can be um if you want everything to be high coded you can hard code you can say your web",
    "start": "430879",
    "end": "437400"
  },
  {
    "text": "server is one11 one1 and inside your company it's probably going to work if you want to do it this way right what's",
    "start": "437400",
    "end": "443720"
  },
  {
    "text": "the point what's the deal with DNS the one thing that's very important with DNS",
    "start": "443720",
    "end": "448840"
  },
  {
    "text": "is that one thing as it's a nice IND Direction and this IND direction is very",
    "start": "448840",
    "end": "454280"
  },
  {
    "text": "flexible and it's something you definitely want uh let's let's talk about this way",
    "start": "454280",
    "end": "461080"
  },
  {
    "text": "if you have a corporated infrastructure and you want to make a change you even if you do a let's say a sofware defin",
    "start": "461080",
    "end": "468319"
  },
  {
    "text": "networking you hard code those uh strings so that hard code those IP addresses so that people does not need",
    "start": "468319",
    "end": "474800"
  },
  {
    "text": "to remember the DS names which may sounds like D is getting uh deprecated",
    "start": "474800",
    "end": "481639"
  },
  {
    "text": "or out of favor but in reality changing uh IP IP in SD is still going to be a",
    "start": "481639",
    "end": "488199"
  },
  {
    "text": "lot more harder than changing DS record I mean you change your DS record especially with the qu DS that's just",
    "start": "488199",
    "end": "494479"
  },
  {
    "text": "like one L change right if you like so that's why the DS still has a place",
    "start": "494479",
    "end": "500080"
  },
  {
    "text": "secondly uh uh DS by itself is Distributing nature many people didn't",
    "start": "500080",
    "end": "505319"
  },
  {
    "text": "realize when people talking about the distribut system people talk about ref protocol talking about how big the",
    "start": "505319",
    "end": "511919"
  },
  {
    "text": "system can be but many people didn't realize that D is supporting a massive",
    "start": "511919",
    "end": "518039"
  },
  {
    "text": "scalable uh distribut system that is internet right the whole internet is backed by the DNS right so certainly",
    "start": "518039",
    "end": "524279"
  },
  {
    "text": "it's a scalable and it's a uh it's disp in nature another thing that many people",
    "start": "524279",
    "end": "529800"
  },
  {
    "text": "didn't realize is that DS by itself it's a pervasive in your it even in your it",
    "start": "529800",
    "end": "536120"
  },
  {
    "text": "infrastructure here I I assume many people uh coming from the uh operations",
    "start": "536120",
    "end": "541920"
  },
  {
    "text": "develops or S background but in it space people still dealing with the DNS your",
    "start": "541920",
    "end": "547839"
  },
  {
    "text": "your corporate still had VPN your corporate may still have some internal website and you have to manage all that",
    "start": "547839",
    "end": "554079"
  },
  {
    "text": "and uh what's the you know what's the communication channel in between those two words your customer outside and your",
    "start": "554079",
    "end": "561560"
  },
  {
    "text": "internal uh DS internal servers actually DS make it very easy to manage both w",
    "start": "561560",
    "end": "569880"
  },
  {
    "text": "so that's why in nowadays even with the sdn with all the advancement in",
    "start": "569880",
    "end": "574959"
  },
  {
    "text": "kubernetes with all those things you still see a place in DS because it's just very pervasive in both it",
    "start": "574959",
    "end": "581079"
  },
  {
    "text": "infrastructure as well as your Dev weite environment uh uh by the way uh John",
    "start": "581079",
    "end": "588640"
  },
  {
    "text": "mentioned that Cod has a lot of support on different protocols uh one",
    "start": "588640",
    "end": "594440"
  },
  {
    "text": "interesting uh feature from coding as is the Cloud sync uh syncing data DS record",
    "start": "594440",
    "end": "600519"
  },
  {
    "text": "from your local Cod DS all the way to Cloud so how does that Cloud sync",
    "start": "600519",
    "end": "606600"
  },
  {
    "text": "matters one the when you use DS because DS by itself",
    "start": "606600",
    "end": "612880"
  },
  {
    "text": "is disre in nature you actually can just forward your Upstream D server to let's say the Google's 8.8.8.8",
    "start": "612880",
    "end": "620519"
  },
  {
    "text": "or uh forward to for example Cloud FL I CL it's 999 no it's it's one one one one",
    "start": "620519",
    "end": "630839"
  },
  {
    "text": "anyway but the cloud syncer from cordance is different uh cordance when",
    "start": "630839",
    "end": "636120"
  },
  {
    "text": "syn up with the cloud Windows cordin as we actually take the secur communication through ACP to the uh to the cloud",
    "start": "636120",
    "end": "643600"
  },
  {
    "text": "Windows API end point so the communication is not done through UDP Which is less secure but done through",
    "start": "643600",
    "end": "650959"
  },
  {
    "text": "ATP with the proper authentication uh uh with profile section and",
    "start": "650959",
    "end": "657120"
  },
  {
    "text": "authorization uh the Clos Sy C with coordinat is also handled with TCP and",
    "start": "657120",
    "end": "663440"
  },
  {
    "text": "that makes the the uh the arrow handling uh a better place and the the whole",
    "start": "663440",
    "end": "670240"
  },
  {
    "text": "communication is much more reliable and finally the separation of data syncup and the DS query is is a big",
    "start": "670240",
    "end": "678000"
  },
  {
    "text": "deal because when you syncer with the cloud vendors you don't want to to be",
    "start": "678000",
    "end": "683920"
  },
  {
    "text": "blocked by by the path of your forwarding to DS Curry you actually can get indication gets authorization uh",
    "start": "683920",
    "end": "691320"
  },
  {
    "text": "gets a record from the CL window uh pull back into a DNS and then into the C DS",
    "start": "691320",
    "end": "697560"
  },
  {
    "text": "and they expose the DS locally to your uh uh uh to your services that's",
    "start": "697560",
    "end": "704399"
  },
  {
    "text": "deployed locally the local environment DNS communication with the UDP seem to",
    "start": "704399",
    "end": "709720"
  },
  {
    "text": "be okay thing but if you want your DNS to tr what through the whole chain of DNS and going talking to a local DNS",
    "start": "709720",
    "end": "716639"
  },
  {
    "text": "server all the way going back to the cloud window that can add additional pass and that can cause uh failures at",
    "start": "716639",
    "end": "723639"
  },
  {
    "text": "any time and that could be a very critical thing in operational envirment um we we talk about cloud",
    "start": "723639",
    "end": "730760"
  },
  {
    "text": "syncup and one interesting another interesting about quoting as is that c can actually integrate with the m Cloud",
    "start": "730760",
    "end": "738199"
  },
  {
    "text": "uh nowadays when people talk about M Cloud there are several reasons for M Cloud one reason obviously is the data",
    "start": "738199",
    "end": "743680"
  },
  {
    "text": "sing and uh data residency you know in certain countries they may not want to",
    "start": "743680",
    "end": "749040"
  },
  {
    "text": "share the data with another country so you may be forced to say okay in certain countries you you have to choose the",
    "start": "749040",
    "end": "755839"
  },
  {
    "text": "cloud vendor that's maybe different from rest of world that's one thing uh another thing that's actually came to my",
    "start": "755839",
    "end": "762600"
  },
  {
    "text": "attention is that when we talk about the M Cloud we also the another reason for M cloud is also the M uh especially with",
    "start": "762600",
    "end": "771240"
  },
  {
    "text": "the current High interest environment many companies you know may have some uh",
    "start": "771240",
    "end": "776600"
  },
  {
    "text": "financial situation such as Ma became you know more active in case of MMA if",
    "start": "776600",
    "end": "782519"
  },
  {
    "text": "two company or three company combin together you may not have a choice you have to do multic cloud and you may not",
    "start": "782519",
    "end": "788600"
  },
  {
    "text": "be easily migrate from One Cloud to another I don't know if any anyone ever moved from One Cloud to another in in",
    "start": "788600",
    "end": "795880"
  },
  {
    "text": "the past several years really hand oh interesting okay how was the",
    "start": "795880",
    "end": "803440"
  },
  {
    "text": "experience how was the experience of for migrating from One Cloud to another",
    "start": "803519",
    "end": "810760"
  },
  {
    "text": "okay I I think I think everyone will agree that if the application or architecture of the your service has",
    "start": "814760",
    "end": "820480"
  },
  {
    "text": "been designed designed in a way it's clear it's a rock solid moving from One",
    "start": "820480",
    "end": "825639"
  },
  {
    "text": "Cloud vendor to another Cloud may be a smooth experience right but that's",
    "start": "825639",
    "end": "830880"
  },
  {
    "text": "unlikely to be the case if you dealing with ma situation because in MA you're always dealing with all kind of lexico",
    "start": "830880",
    "end": "837959"
  },
  {
    "text": "no one want to touch well whoever wrote the code has already left a company decided to go with some other interesting things right and and in that",
    "start": "837959",
    "end": "846160"
  },
  {
    "text": "situation as operation guy the only thing you want to do is don't touch anything just leave alone",
    "start": "846160",
    "end": "853279"
  },
  {
    "text": "right okay so that's M Cloud um uh in in in in terms of um cord another thing is",
    "start": "853279",
    "end": "861639"
  },
  {
    "text": "cordance also has Diversified Source information as I mentioned coding has consoled both the customer information",
    "start": "861639",
    "end": "867800"
  },
  {
    "text": "from cloud windows from kuet as well as a corporate de as servers that will serve the it infrastructure uh and the",
    "start": "867800",
    "end": "874680"
  },
  {
    "text": "final Point people may be asking okay now noway you have like AWS add DNS",
    "start": "874680",
    "end": "880720"
  },
  {
    "text": "what's the deal with qus do you still need a DS server I think you still need to consider that because even though as",
    "start": "880720",
    "end": "886560"
  },
  {
    "text": "far as I know all the CL Windows all the three major CL window already offered 100% sea uh many people didn't realize",
    "start": "886560",
    "end": "894199"
  },
  {
    "text": "what does that mean of 100% sea when we talk about SE we have to",
    "start": "894199",
    "end": "899279"
  },
  {
    "text": "think about the consequence what if that CA has not been met what is for it's not",
    "start": "899279",
    "end": "904399"
  },
  {
    "text": "up 100% if you look through the terms of contract term you're going to realize the only consequence is that they will",
    "start": "904399",
    "end": "911199"
  },
  {
    "text": "return the money back to you uh during the time that a service is not available unfortunately as I said DS",
    "start": "911199",
    "end": "919199"
  },
  {
    "text": "is a simple service and it's a cheap service okay so the company work for at one point had a major loss because the D",
    "start": "919199",
    "end": "927079"
  },
  {
    "text": "server from one cl window was done for several hours as as that caus certain",
    "start": "927079",
    "end": "933319"
  },
  {
    "text": "millions of dollars of loss but the when we talk to the club window we realize",
    "start": "933319",
    "end": "939600"
  },
  {
    "text": "the the money we can recover is so small such that they even offer option of gift",
    "start": "939600",
    "end": "945360"
  },
  {
    "text": "card Uber gift card yes because they realize yeah for several hours you only",
    "start": "945360",
    "end": "950480"
  },
  {
    "text": "spend maybe like $100 in in D okay so do you want $100 to return back to your",
    "start": "950480",
    "end": "956519"
  },
  {
    "text": "bank account or do you want the UB gift card so make it a good gesture right yeah that's a true story yeah that is a",
    "start": "956519",
    "end": "962959"
  },
  {
    "text": "true story I experience okay okay uh so I think I need to speed up a little bit so that's",
    "start": "962959",
    "end": "969560"
  },
  {
    "text": "one architecture we talked about uh in the past already but I want to go over that the one architecture you can go",
    "start": "969560",
    "end": "976360"
  },
  {
    "text": "with the m cloud with simple setup you have a DS server uh on uh locally that's",
    "start": "976360",
    "end": "983920"
  },
  {
    "text": "qus and you you have some infrastructure on both a and good Cloud now your you",
    "start": "983920",
    "end": "991399"
  },
  {
    "text": "know even either your corporate it or your like multic Cloud deployment need to expose certain services from",
    "start": "991399",
    "end": "998319"
  },
  {
    "text": "different you know different places different Cloud Windows how you going to achieve that so this is one example",
    "start": "998319",
    "end": "1004360"
  },
  {
    "text": "where you are going to expose your DNS in a similar way even",
    "start": "1004360",
    "end": "1009600"
  },
  {
    "text": "though they are backed from different uh uh Cloud windows and the cloud ders uh",
    "start": "1009600",
    "end": "1015519"
  },
  {
    "text": "right so I'm going to show a core file to to make it happen this is a COR file that's",
    "start": "1015519",
    "end": "1022240"
  },
  {
    "text": "actually going to work to achieve what I described in the previous slide uh you",
    "start": "1022240",
    "end": "1027760"
  },
  {
    "text": "only specify three section the first section is a the draw phory you specify",
    "start": "1027760",
    "end": "1033280"
  },
  {
    "text": "how your coding is going to talk to Raw F3 to fetch a record and uh if a record",
    "start": "1033280",
    "end": "1038678"
  },
  {
    "text": "is not available in uh raw F3 you can set up the F through uh uh F through",
    "start": "1038679",
    "end": "1045280"
  },
  {
    "text": "line that means the coding as will it through different plugins and they will",
    "start": "1045280",
    "end": "1050640"
  },
  {
    "text": "F through to the next plugin which is cloud DS which is the Google Cloud uh they're going to search for DS record",
    "start": "1050640",
    "end": "1056880"
  },
  {
    "text": "now you okay so if your DNS record is still not available with the Ser service",
    "start": "1056880",
    "end": "1061960"
  },
  {
    "text": "you provide it's not on Google cloudv then you can fall back to your local d c",
    "start": "1061960",
    "end": "1067120"
  },
  {
    "text": "DS to figure out where the where the uh service is is located of course it can",
    "start": "1067120",
    "end": "1072960"
  },
  {
    "text": "be your corporate it environment or you you'll have some internal services that you want to expose um uh I think uh okay",
    "start": "1072960",
    "end": "1080520"
  },
  {
    "text": "so that's uh that's some of the examples of how you can play with M cloud with Serv Discovery I'm going to hand over",
    "start": "1080520",
    "end": "1087080"
  },
  {
    "text": "back to Jang to talk about uh demo plugin on coding as great thanks y um",
    "start": "1087080",
    "end": "1093919"
  },
  {
    "text": "so we've mentioned a few times that it's pluggable architecture so one of the things you might want to do is create a",
    "start": "1093919",
    "end": "1098960"
  },
  {
    "text": "PL plugin um what we're going to go through here briefly we have I'll try and do it in six and a half minutes and",
    "start": "1098960",
    "end": "1105760"
  },
  {
    "text": "then we'll have 10 minutes for questions um we're going to do a plug-in where uh",
    "start": "1105760",
    "end": "1111640"
  },
  {
    "text": "you know when whenever DNS request comes in there's certain information about it contains and one of the most obvious",
    "start": "1111640",
    "end": "1116840"
  },
  {
    "text": "things it contains uh is the the the source IP that's something you might differentiate on so",
    "start": "1116840",
    "end": "1122880"
  },
  {
    "text": "in so in uh you know there's other information you might attach I don't know how many people are intimately",
    "start": "1122880",
    "end": "1128919"
  },
  {
    "text": "familiar with d with DNS but there's other uh extensions to DNS that allow you to attach other information but",
    "start": "1128919",
    "end": "1135320"
  },
  {
    "text": "everything they always have a source IP because they always have to get the response back and so um what we'll do is a very simple",
    "start": "1135320",
    "end": "1141400"
  },
  {
    "text": "plugin uh that basically if if the source IP is in a particular subnet then",
    "start": "1141400",
    "end": "1146799"
  },
  {
    "text": "we'll return one value otherwise we'll return another value this is a stupid plugin you'd never do this because it's",
    "start": "1146799",
    "end": "1153440"
  },
  {
    "text": "you know uh but it's it serves as a decent example and well I'll get to that",
    "start": "1153440",
    "end": "1159640"
  },
  {
    "text": "later okay so there's basically uh just a couple of things you have to do to create a plugin the first thing to",
    "start": "1159640",
    "end": "1165679"
  },
  {
    "text": "understand is that um as y mentioned cordex is configured with something called a core file it's not a core dump",
    "start": "1165679",
    "end": "1172159"
  },
  {
    "text": "but it's a core file and it's just a simple uh cords was originally based on",
    "start": "1172159",
    "end": "1177720"
  },
  {
    "text": "an early version of caddy which is a web server and so that it's the same format",
    "start": "1177720",
    "end": "1182919"
  },
  {
    "text": "and uh but or slightly derivative format of that so basically each uh the core",
    "start": "1182919",
    "end": "1188640"
  },
  {
    "text": "file contain stands is for each Zone and then within each Zone you define which plugins you want to enable and uh uh the",
    "start": "1188640",
    "end": "1197919"
  },
  {
    "text": "specific spefic configurations for those plugins so when you're writing a plugin the first thing you have to do is create",
    "start": "1197919",
    "end": "1204360"
  },
  {
    "text": "a function that will parse that configuration and set your set up your",
    "start": "1204360",
    "end": "1209520"
  },
  {
    "text": "internal internal information so that's essentially what the setup function does",
    "start": "1209520",
    "end": "1214720"
  },
  {
    "text": "so typically that's in like a setup. go like we're showing here uh the init is like the module init so if you're not",
    "start": "1214720",
    "end": "1220520"
  },
  {
    "text": "familiar with go this is like this is done at uh AIT is immediately called whenever the the the module is",
    "start": "1220520",
    "end": "1226919"
  },
  {
    "text": "initialized basically at by inary the time the binary starts up um one time and so that's used to uh um register the",
    "start": "1226919",
    "end": "1236280"
  },
  {
    "text": "plugin with the caddy infrastructure that parses the configuration file so it's say basically saying hey I'm a",
    "start": "1236280",
    "end": "1242159"
  },
  {
    "text": "plugin if you see this keyword invoke me so you pass it your setup function and",
    "start": "1242159",
    "end": "1248440"
  },
  {
    "text": "the and the uh directive to call and then uh Caddy will call in the main",
    "start": "1248440",
    "end": "1254640"
  },
  {
    "text": "server will call into your plug-in if that appears in the in the conf configuration file it'll pass you the",
    "start": "1254640",
    "end": "1259840"
  },
  {
    "text": "parameters for that and you just populate your internal structures whatever they are so that's the setup.",
    "start": "1259840",
    "end": "1265080"
  },
  {
    "text": "go pretty simple uh the uh then you have something that actually performs your",
    "start": "1265080",
    "end": "1271440"
  },
  {
    "text": "request processing so there's a serve DNS method this is the only method you have to actually Implement to in order",
    "start": "1271440",
    "end": "1277000"
  },
  {
    "text": "to to to create a plugin that uh to process your request um and it just gets",
    "start": "1277000",
    "end": "1283520"
  },
  {
    "text": "a you know it gets a request in and a response writer a place to write the the response back to in and and does its",
    "start": "1283520",
    "end": "1290960"
  },
  {
    "text": "does its thing if it doesn't know what to do with it like it checks uh am have",
    "start": "1290960",
    "end": "1296960"
  },
  {
    "text": "is this a request that is in a Zone I manage if it's not it passes it down the chain or in the example young talked",
    "start": "1296960",
    "end": "1304720"
  },
  {
    "text": "about with fall through fall through allows you to to do that same process of like do I manage this request but even",
    "start": "1304720",
    "end": "1310640"
  },
  {
    "text": "for a single zone normally cordan a plugin manages and owns a Zone a backend plugin but you can sort of divide that",
    "start": "1310640",
    "end": "1318080"
  },
  {
    "text": "up with this fall through and say that oh this Zone uh I manage some part of it",
    "start": "1318080",
    "end": "1323400"
  },
  {
    "text": "um but I'm not going to manage all that so even with kubernetes um on reverse lookups we do this so reverse lookups uh",
    "start": "1323400",
    "end": "1331200"
  },
  {
    "text": "the kubernetes plug-in needs to manage um uh the service CER and the Pod cider",
    "start": "1331200",
    "end": "1337039"
  },
  {
    "text": "if there is one uh if you're doing pod pod IPS a pod DNS but the service CER if",
    "start": "1337039",
    "end": "1342320"
  },
  {
    "text": "nothing else and on a reverse look up if it something doesn't fall within the service CER we want to kick it out to",
    "start": "1342320",
    "end": "1347400"
  },
  {
    "text": "whatever else to do the reverse lookup so fall through is used there for example um okay so what do that I took",
    "start": "1347400",
    "end": "1353600"
  },
  {
    "text": "too much time on that so a nit function like I said super simple register the plugin with the word demo and call uh",
    "start": "1353600",
    "end": "1361520"
  },
  {
    "text": "the setup function so that's when it's paring the config it goes through the the configs and um adds itself uh kind",
    "start": "1361520",
    "end": "1369679"
  },
  {
    "text": "of to the to the plug-in chain very straightforward serve DNS okay we grab",
    "start": "1369679",
    "end": "1375400"
  },
  {
    "text": "the the we take a look at the request uh and we decide we we're saying okay if",
    "start": "1375400",
    "end": "1381159"
  },
  {
    "text": "the request is the the the IP The Source IP is starts with 172 or 127 then reply",
    "start": "1381159",
    "end": "1390720"
  },
  {
    "text": "with this otherwise use the 8888 reply add that to our list of responses and",
    "start": "1390720",
    "end": "1397360"
  },
  {
    "text": "we're done this is literally like what 20 lines of code to write that plugin so plugins are super easy to write and you",
    "start": "1397360",
    "end": "1404200"
  },
  {
    "text": "only need to think about the specific functionality you care about and you can just hand off everything else to the",
    "start": "1404200",
    "end": "1409720"
  },
  {
    "text": "rest of the system to deal with the core file ends up look looking like this this",
    "start": "1409720",
    "end": "1414840"
  },
  {
    "text": "is saying that this core file manages dot so everything um and so demo is",
    "start": "1414840",
    "end": "1421720"
  },
  {
    "text": "going to handle everything um and this is just how to run it so if you pull this deck down off",
    "start": "1421720",
    "end": "1427720"
  },
  {
    "text": "of uh off of uh skedge afterward then uh you can copy this out of",
    "start": "1427720",
    "end": "1433760"
  },
  {
    "text": "here so that's the link to it and um H I did it in 5 and 1/2 minutes um hopefully",
    "start": "1433760",
    "end": "1442520"
  },
  {
    "text": "not leaving too many questions um before we go to Q&A uh we'd love to",
    "start": "1442520",
    "end": "1449919"
  },
  {
    "text": "have you come join in uh if you've got a unique plugin we have tons of external plugins there's two classes of plugins",
    "start": "1449919",
    "end": "1455520"
  },
  {
    "text": "there's the ones that are built in to the binary that we build um and then",
    "start": "1455520",
    "end": "1462360"
  },
  {
    "text": "there are external plugins but it's pretty easy but plugins are not dynamically loaded if you're familiar",
    "start": "1462360",
    "end": "1468559"
  },
  {
    "text": "with go go is not great at dynamically loading things I mean newer versions",
    "start": "1468559",
    "end": "1473679"
  },
  {
    "text": "have it but um the they're just compiled in but it's quick and easy to compile so",
    "start": "1473679",
    "end": "1479559"
  },
  {
    "text": "you just add a line to a file compile and you've got your own custom CNS with",
    "start": "1479559",
    "end": "1484960"
  },
  {
    "text": "your plugin in it and you can the other the other kind of gotcha is that the the plug-in order chain is not related to",
    "start": "1484960",
    "end": "1492120"
  },
  {
    "text": "the core file it's related to the compiled in ordering so those are probably the two biggest gotchas with",
    "start": "1492120",
    "end": "1497200"
  },
  {
    "text": "doing plugins and uh so but otherwise it's pretty pretty straightforward so thank you and I think",
    "start": "1497200",
    "end": "1505080"
  },
  {
    "text": "we can go on to Q&A any questions you will get first",
    "start": "1505080",
    "end": "1511480"
  },
  {
    "text": "pick of the swag no C yes sir I do want I have a gen",
    "start": "1511480",
    "end": "1520559"
  },
  {
    "text": "question so in the file do I have to follow the order in which the plins were compiled ah so the question is in the",
    "start": "1520559",
    "end": "1527960"
  },
  {
    "text": "core file do you have to follow the order of the plugins no uh you can put them in any order but when the request",
    "start": "1527960",
    "end": "1534000"
  },
  {
    "text": "happens the request will be processed in the order of the compiled in order of",
    "start": "1534000",
    "end": "1539200"
  },
  {
    "text": "the plugins so for example um uh there's a the there's a plugin you",
    "start": "1539200",
    "end": "1546760"
  },
  {
    "text": "know to handle files so Zone files and there's a plugin to handle kubernetes and there's a plugin to handle Cloud DNS",
    "start": "1546760",
    "end": "1553600"
  },
  {
    "text": "from Google right they're in a specific order so the first plugin that gets the opportunity to handle the request is",
    "start": "1553600",
    "end": "1559919"
  },
  {
    "text": "going to be the first one that that's that's compiled in in that order regardless of the order you you enable them within the core",
    "start": "1559919",
    "end": "1566200"
  },
  {
    "text": "file and now you can grab something yes sir if it might be better",
    "start": "1566200",
    "end": "1571520"
  },
  {
    "text": "I think it's recorded so you probably should use the mic that's why I repeated the question last",
    "start": "1571520",
    "end": "1577158"
  },
  {
    "text": "time yeah I have uh two questions hopefully they'll be quick the first one is for the multicluster example are you",
    "start": "1577840",
    "end": "1583840"
  },
  {
    "text": "putting that configuration in a separate core DNS that you're running outside your kubernetes cluster or just the one",
    "start": "1583840",
    "end": "1588880"
  },
  {
    "text": "that comes with okay so basically mik okay so basically when we talk about",
    "start": "1588880",
    "end": "1596360"
  },
  {
    "text": "M Cloud you're actually talking about your service deployed into mulle Cloud environment or your local Cloud",
    "start": "1596360",
    "end": "1601840"
  },
  {
    "text": "environment however your your DNS are scattered around but there one core DNS",
    "start": "1601840",
    "end": "1607000"
  },
  {
    "text": "that's sitting uh at the central of information so that you can see through all the backend the information like",
    "start": "1607000",
    "end": "1613159"
  },
  {
    "text": "from Google cloud or from the AWS or from AG so there is one place you can",
    "start": "1613159",
    "end": "1618480"
  },
  {
    "text": "see as a source for truth yeah like it has nothing to do with the cordas that's",
    "start": "1618480",
    "end": "1623880"
  },
  {
    "text": "running in kubernetes it could be a complet you could be running it in Docker you could be running it on a hosted like and in fact I would",
    "start": "1623880",
    "end": "1630720"
  },
  {
    "text": "recommend that you don't do anything else in the kubernetes so we have a bunch of things like like external DNS",
    "start": "1630720",
    "end": "1637480"
  },
  {
    "text": "where you can um external kubernetes plugin where you can take things that are uh like like your services or your",
    "start": "1637480",
    "end": "1644559"
  },
  {
    "text": "external IPS on your on your uh kubernetes services and you can expose them via DNS even for that I would",
    "start": "1644559",
    "end": "1650840"
  },
  {
    "text": "recommend you run a separate because that way you don't threaten your internal cluster DNS with external",
    "start": "1650840",
    "end": "1656240"
  },
  {
    "text": "traffic which could overwhelm it yeah that was interesting because that was actually one thing that I immediately looked up was that plugin exactly um",
    "start": "1656240",
    "end": "1663039"
  },
  {
    "text": "that's interesting yeah and then the second question I had is we have a very kind of Niche use case we're using core",
    "start": "1663039",
    "end": "1668080"
  },
  {
    "text": "DNS SRV records for service Discovery between our multiple layers in kubernetes we have a desire to be able",
    "start": "1668080",
    "end": "1675320"
  },
  {
    "text": "to set the the waiting on a particular instance on the Fly uh do you know if",
    "start": "1675320",
    "end": "1681760"
  },
  {
    "text": "there's anything off the shelf that does that in cords or is that something that we would want to write a plugin for and just put in the chain after the",
    "start": "1681760",
    "end": "1687840"
  },
  {
    "text": "kubernetes Plugin or um so we have a few interesting",
    "start": "1687840",
    "end": "1693840"
  },
  {
    "text": "plugins I don't know if they do that off the shelf we have one called rewrite I don't know if it can rewrite weights on",
    "start": "1693840",
    "end": "1699480"
  },
  {
    "text": "SRV records um it usually is for rewriting names and name responses but",
    "start": "1699480",
    "end": "1705039"
  },
  {
    "text": "there are some you can rewrite some headers like it you should look at it I'm I'm not sure it does that there's a",
    "start": "1705039",
    "end": "1711120"
  },
  {
    "text": "template plugin that probably doesn't do what you want because you'd have to know everything up front you could easily Implement",
    "start": "1711120",
    "end": "1717679"
  },
  {
    "text": "something you might want to look at there's a policy plugin it's an external plugin I think but it actually allows",
    "start": "1717679",
    "end": "1723120"
  },
  {
    "text": "you to um do pretty sophisticated things so we have this what we call metadata",
    "start": "1723120",
    "end": "1728240"
  },
  {
    "text": "plug-in um that if you enable it it will actually um kind of take the request and",
    "start": "1728240",
    "end": "1735519"
  },
  {
    "text": "make information that's embedded in their request in weird ways available so each plugin can kind of enhance the",
    "start": "1735519",
    "end": "1741159"
  },
  {
    "text": "request with metadata so for examp Q plugin can add the service name the Pod",
    "start": "1741159",
    "end": "1746559"
  },
  {
    "text": "name the name space depending on what information you have and then you can use that in later plugins in the policy plugin for example I was going to say",
    "start": "1746559",
    "end": "1752480"
  },
  {
    "text": "that because that was the next big thing is if you were to write your own plug-in would you embed your own essentially",
    "start": "1752480",
    "end": "1757600"
  },
  {
    "text": "kubernetes client in there to get that information if you wanted to like put it on the Pod as an example um so that's",
    "start": "1757600",
    "end": "1762880"
  },
  {
    "text": "actually an interesting idea yeah there's a lot of tricky trickiness and we can talk afterwards if you want about",
    "start": "1762880",
    "end": "1768840"
  },
  {
    "text": "Source IP based mapping to pod IP like it's not as it doesn't work as well as you'd hope but it that way thank you the",
    "start": "1768840",
    "end": "1775600"
  },
  {
    "text": "demo example it's actually uh thanks for your presentation",
    "start": "1775600",
    "end": "1782159"
  },
  {
    "text": "um I had a question um we run eks and lately we've had problems with Cod ands",
    "start": "1782159",
    "end": "1788840"
  },
  {
    "text": "timing out extensively um I don't know if it's a Cod problem or IKS problem so our walk",
    "start": "1788840",
    "end": "1795320"
  },
  {
    "text": "around was using node Lo local cach on each node I was wondering how do you deal",
    "start": "1795320",
    "end": "1802640"
  },
  {
    "text": "with that kind of situation on eks if if you're familiar with it um let me was",
    "start": "1802640",
    "end": "1809679"
  },
  {
    "text": "the microphone is a little hard to understand you're saying you have a you're using local DNS cache yeah so we",
    "start": "1809679",
    "end": "1815600"
  },
  {
    "text": "run into massive timeout C DNS so e CL could not resolve anything so we",
    "start": "1815600",
    "end": "1823360"
  },
  {
    "text": "couldn't figure out what was going on right you know apparently it's a common problem in eks eks and and forns there's",
    "start": "1823360",
    "end": "1829440"
  },
  {
    "text": "a lot of people that have the same problem okay our solution was to use noal no local uh no loal cash uh that",
    "start": "1829440",
    "end": "1837760"
  },
  {
    "text": "seems to solve a problem but I was surprised that uh CS had his issue with eks it it's probably not cord so there's",
    "start": "1837760",
    "end": "1845480"
  },
  {
    "text": "a number of issues we we can look into there there's a few issues that we've seen over the years although I would be",
    "start": "1845480",
    "end": "1851200"
  },
  {
    "text": "surprised that we're still seeing some of them because they were related to Kernel bugs and and UDP timeouts is in",
    "start": "1851200",
    "end": "1857519"
  },
  {
    "text": "the contract table um those are some of the the really old ones eks has",
    "start": "1857519",
    "end": "1862760"
  },
  {
    "text": "depending on the kind of node you have has request you know uh Network limits",
    "start": "1862760",
    "end": "1868120"
  },
  {
    "text": "that in DNS world are really low like 50k QPS right but but in most people's",
    "start": "1868120",
    "end": "1874679"
  },
  {
    "text": "circumstances a node getting 50k QPS is is high is a high number but but that like when we were doing testing back in",
    "start": "1874679",
    "end": "1881000"
  },
  {
    "text": "info blo I mean even five years ago was like we couldn't get we couldn't get Amazon to nodes to deliver very good uh",
    "start": "1881000",
    "end": "1889440"
  },
  {
    "text": "um DNS service because of all those limits so there's a lot that can go into it I'd love to maybe talk more",
    "start": "1889440",
    "end": "1894720"
  },
  {
    "text": "afterwards it's really hard without um getting more detail but you shouldn't run into like the stuff that's served",
    "start": "1894720",
    "end": "1901039"
  },
  {
    "text": "out of kubernetes is literally straight out of memory you don't even need DNS cache it's like we're already have it in",
    "start": "1901039",
    "end": "1906679"
  },
  {
    "text": "memory the whole thing's loaded it should be almost instantaneous so it's likely a networking issue between",
    "start": "1906679",
    "end": "1911720"
  },
  {
    "text": "between there or a UDP Contra like UDP the ENT entries in the connection",
    "start": "1911720",
    "end": "1918120"
  },
  {
    "text": "tracking table in the kernel have to time out whereas TCP they get removed as soon as the connection's closed okay and",
    "start": "1918120",
    "end": "1924480"
  },
  {
    "text": "so that's why one of the things node local DNS does is it upgrades the connection from the node to the central",
    "start": "1924480",
    "end": "1929919"
  },
  {
    "text": "cord DNS to TCP so that it'll get it won't run into these contract issues so",
    "start": "1929919",
    "end": "1935159"
  },
  {
    "text": "that's one of the yeah I I want to add a couple of things you know based on at least my POS experience but now we see",
    "start": "1935159",
    "end": "1941519"
  },
  {
    "text": "elect as isue uh I normally will look at the networking to make sure that the the",
    "start": "1941519",
    "end": "1947760"
  },
  {
    "text": "path that runs from you know from your service or from where the DS request",
    "start": "1947760",
    "end": "1953279"
  },
  {
    "text": "happens can reach to the DS server and try try to diagnose with networking",
    "start": "1953279",
    "end": "1959080"
  },
  {
    "text": "issue because that's most likely scenario uh as as J mention DS uh that's",
    "start": "1959080",
    "end": "1964120"
  },
  {
    "text": "one one reason uh we when we do the cloud syn up we use uh TCP I mean people",
    "start": "1964120",
    "end": "1970000"
  },
  {
    "text": "may believe okay UDP that's can be more efficient but that's not necessarily the case because the UDP other as who",
    "start": "1970000",
    "end": "1978440"
  },
  {
    "text": "ELP okay so optimization uh now the focusing in this area in in linel in any",
    "start": "1978440",
    "end": "1984519"
  },
  {
    "text": "place people are focusing on TCP so PTP normally have a high optimization but",
    "start": "1984519",
    "end": "1989720"
  },
  {
    "text": "UDP are falling behind in fact you can not even find lot of UDP related software than DNS that's why the if",
    "start": "1989720",
    "end": "1997399"
  },
  {
    "text": "there any issue likely going to be networking issue or UDP related issue",
    "start": "1997399",
    "end": "2002440"
  },
  {
    "text": "that's caused by konel but I I mean most of the time unless you're doing something really massive no we're not or",
    "start": "2002440",
    "end": "2010159"
  },
  {
    "text": "your D are serving some record in a very I'm going to say t very short TTL you",
    "start": "2010159",
    "end": "2016639"
  },
  {
    "text": "it's very unlikely your your diners will be flooded we we tried a bunch of those T increase TTL increase cash and bu of",
    "start": "2016639",
    "end": "2024200"
  },
  {
    "text": "things yeah it worked for a while then you started failing again you know but I'll talk to you guys after after the",
    "start": "2024200",
    "end": "2029720"
  },
  {
    "text": "presentation so just to get more information of how we can solve the problem thank you okay sure thank you",
    "start": "2029720",
    "end": "2035960"
  },
  {
    "text": "sure hi there I am a manager in a room of",
    "start": "2035960",
    "end": "2041399"
  },
  {
    "text": "Engineers this might be a very stupid question uh thinking of modern uh practices by which Engineers are",
    "start": "2041399",
    "end": "2046600"
  },
  {
    "text": "developing um Dev SEC Ops platforms and consuming them uh one of the patterns that we see is uh developers using",
    "start": "2046600",
    "end": "2052320"
  },
  {
    "text": "bastions within AWS uh on ec2s and then we have uh our devc Ops workload such as",
    "start": "2052320",
    "end": "2058040"
  },
  {
    "text": "kubernetes and Nexus running within cluster as we have those resolving uh with like publicly trusted CTS what is a",
    "start": "2058040",
    "end": "2064280"
  },
  {
    "text": "method by which we consistently resolve those records both inclass and out of cluster um that might not be a plug-in",
    "start": "2064280",
    "end": "2070240"
  },
  {
    "text": "question if it's out of scope of this talk I apologize it's for some reason it's hard both people are softspoken and it's",
    "start": "2070240",
    "end": "2076760"
  },
  {
    "text": "really hard to actually understand you're maybe because we're behind the speakers can are you saying the you're",
    "start": "2076760",
    "end": "2082919"
  },
  {
    "text": "serving you want to do DNS resolution for workloads that are in the cluster and out of the cluster um workloads that",
    "start": "2082919",
    "end": "2088960"
  },
  {
    "text": "are within the cluster but provide that um experience consistently so let's say like a creates",
    "start": "2088960",
    "end": "2095280"
  },
  {
    "text": "an uh internal load balancer it knows what it is within cluster and manage it we can resolve that um that with like",
    "start": "2095280",
    "end": "2101480"
  },
  {
    "text": "rout 53 we can register that with rout 53 um through some manual operations of get Ops flows uh within the cluster as",
    "start": "2101480",
    "end": "2108079"
  },
  {
    "text": "well how do we manage those custom DNS records custom DNS records within from within the cluster so um I think you can",
    "start": "2108079",
    "end": "2116119"
  },
  {
    "text": "do that um there's a couple of options right so one option is you can create",
    "start": "2116119",
    "end": "2121839"
  },
  {
    "text": "external name DNS external name services and then it just works as it does today",
    "start": "2121839",
    "end": "2127320"
  },
  {
    "text": "the other is you can use um you this is a case where you might want to use additional plugins within your",
    "start": "2127320",
    "end": "2133560"
  },
  {
    "text": "kubernetes DNS instance I talked about not doing that earlier but that was more because of external traffic coming into",
    "start": "2133560",
    "end": "2138599"
  },
  {
    "text": "the cluster um could overwhelm your your cluster DNS and cause your things within the cluster to fail but if what you're",
    "start": "2138599",
    "end": "2145400"
  },
  {
    "text": "doing is things within the cluster need to get DNS access to things that don't live in the cluster then these",
    "start": "2145400",
    "end": "2151480"
  },
  {
    "text": "additional plugins would be just the right thing for it I would think gotta thank you yeah",
    "start": "2151480",
    "end": "2157359"
  },
  {
    "text": "I think we're over time so thank you very much come and grab some swag I don't want to take any home",
    "start": "2157359",
    "end": "2163520"
  },
  {
    "text": "so thank you",
    "start": "2163520",
    "end": "2168319"
  }
]