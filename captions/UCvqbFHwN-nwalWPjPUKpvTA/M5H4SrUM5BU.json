[
  {
    "start": "0",
    "end": "39000"
  },
  {
    "text": "thanks everyone for coming my name is Xiao I'm a director of software",
    "start": "60",
    "end": "6180"
  },
  {
    "text": "engineering at Salesforce with me is my colleague Thomas Heung growth is which",
    "start": "6180",
    "end": "11429"
  },
  {
    "text": "is a senior director at Salesforce so today let's go take a peek inside the",
    "start": "11429",
    "end": "19500"
  },
  {
    "text": "enterprise cloud at Salesforce we're going to be talking about how we manage kubernetes at work at scale so we also",
    "start": "19500",
    "end": "27539"
  },
  {
    "text": "listed our email address there so if you have any questions and in discussions we",
    "start": "27539",
    "end": "32578"
  },
  {
    "text": "want to talk about after the talk please feel free to email us so here is today's",
    "start": "32579",
    "end": "41010"
  },
  {
    "start": "39000",
    "end": "39000"
  },
  {
    "text": "agenda first let's talk about the unique challenges in using kubernetes at",
    "start": "41010",
    "end": "47160"
  },
  {
    "text": "Salesforce Salesforce is the leading cloud company we own many private data centers as we",
    "start": "47160",
    "end": "55260"
  },
  {
    "text": "develop our a lot of the internal management system to manage our private data centers kubernetes is a so open",
    "start": "55260",
    "end": "62160"
  },
  {
    "text": "source software which doesn't necessarily fit into those existing management tools does give us a lot of",
    "start": "62160",
    "end": "70350"
  },
  {
    "text": "the unique challenges our team started to work on coronaries back in 2015 we",
    "start": "70350",
    "end": "78240"
  },
  {
    "text": "actually started used kubernetes when was coronaries version 1.3 kubernetes",
    "start": "78240",
    "end": "84119"
  },
  {
    "text": "has a go a long way from there we also have gone a long way from there today in this platform I want to share what we",
    "start": "84119",
    "end": "91380"
  },
  {
    "text": "have learned in this journey what worked what didn't work and what can be",
    "start": "91380",
    "end": "97979"
  },
  {
    "text": "improved so today we're going to be talking about four aspects of solutions",
    "start": "97979",
    "end": "104640"
  },
  {
    "text": "so first one is multi-tenancy and security how do we manage kubernetes",
    "start": "104640",
    "end": "111060"
  },
  {
    "text": "cluster when multiple tenants using the same cluster with necessary protection",
    "start": "111060",
    "end": "116630"
  },
  {
    "text": "second one I want to talk about is deployment management system we actually",
    "start": "116630",
    "end": "122130"
  },
  {
    "text": "developed in-house the internal development management system and the third one is orchestrated production",
    "start": "122130",
    "end": "129599"
  },
  {
    "text": "visibility we actually have open source some of",
    "start": "129599",
    "end": "134909"
  },
  {
    "text": "this software I'm super excited about it Tom here is going to talk about it in a",
    "start": "134909",
    "end": "141239"
  },
  {
    "text": "later section of the presentation and last but not least I want to talk about",
    "start": "141239",
    "end": "148760"
  },
  {
    "text": "how do we do testing monitoring and our learning and then we're gonna be talking",
    "start": "148760",
    "end": "156329"
  },
  {
    "text": "about what's the future projects we have something in mind what's gonna be next for enterprise cloud so first let's take",
    "start": "156329",
    "end": "166799"
  },
  {
    "start": "164000",
    "end": "164000"
  },
  {
    "text": "a look at the unique challenges for the enterprise cloud for kubernetes s use",
    "start": "166799",
    "end": "171810"
  },
  {
    "text": "force so who here I have a question for you guys so who here is deploying coronaries",
    "start": "171810",
    "end": "179099"
  },
  {
    "text": "in private data centers awesome and who",
    "start": "179099",
    "end": "184200"
  },
  {
    "text": "is actually deploying coronaries on bare metal machines awesome",
    "start": "184200",
    "end": "189359"
  },
  {
    "text": "I'm glad like some people here know exactly what we're going through with these challenges and the next challenge",
    "start": "189359",
    "end": "196620"
  },
  {
    "text": "I want to talk about is network isolation which means from production data center to production data center",
    "start": "196620",
    "end": "202530"
  },
  {
    "text": "they don't talk to each other and also we have the challenge of restrictive",
    "start": "202530",
    "end": "209639"
  },
  {
    "text": "privileges for the end-user which means not everybody can just log into production data centers so let me give",
    "start": "209639",
    "end": "218310"
  },
  {
    "text": "you example for this particular challenge let's say we wrote out a change to multiple production data",
    "start": "218310",
    "end": "225090"
  },
  {
    "text": "centers and it has an issue so what do we do developers can just log into production",
    "start": "225090",
    "end": "231299"
  },
  {
    "text": "data center you know anytime and even then we get some people who has the privilege to log into production data",
    "start": "231299",
    "end": "238139"
  },
  {
    "text": "center to look at these resources they can't really just log into multiple production data center at the same time",
    "start": "238139",
    "end": "244879"
  },
  {
    "text": "so this actually makes our communities management system extremely challenging",
    "start": "244879",
    "end": "252209"
  },
  {
    "text": "and also from a security perspective we",
    "start": "252209",
    "end": "257370"
  },
  {
    "text": "need to uphold the standard to the enterprise level container security ok",
    "start": "257370",
    "end": "263400"
  },
  {
    "text": "so next I want to talk about it's very interesting internal integration what",
    "start": "263400",
    "end": "269270"
  },
  {
    "text": "that means Suz force as a enterprise we have a lot of the internal services and teams that",
    "start": "269270",
    "end": "280220"
  },
  {
    "text": "we need to integrate with which means we cannot just use any software off the shelf we have to use the Salesforce ones",
    "start": "280220",
    "end": "287590"
  },
  {
    "text": "which means we have to in develop our own interface on top of the Coronet",
    "start": "287590",
    "end": "293630"
  },
  {
    "text": "clusters in order to use the Salesforce services so next challenge yeah we have",
    "start": "293630",
    "end": "303560"
  },
  {
    "text": "a lot of challenges next challenge I want to talk about is we have a lot of the internal teams to support we're not",
    "start": "303560",
    "end": "311030"
  },
  {
    "text": "just aiming for one team we're aiming for develop the coronaries platform",
    "start": "311030",
    "end": "316090"
  },
  {
    "text": "which fits all teams in Salesforce and those team necessarily they have to be",
    "start": "316090",
    "end": "322640"
  },
  {
    "text": "the quranic' cast experts we develop tools for them so for example we have",
    "start": "322640",
    "end": "331940"
  },
  {
    "text": "hundreds of teams right now which are deployed our community caster in each of",
    "start": "331940",
    "end": "338180"
  },
  {
    "text": "the production data center and also each team has multiple applications running in those production data centers so the",
    "start": "338180",
    "end": "347840"
  },
  {
    "text": "last challenge I want to talk about is the requirement for the advanced tools when we first started to use coronaries",
    "start": "347840",
    "end": "355400"
  },
  {
    "text": "in 2015 there were not a lot of advanced tools I'm sure a lot of you guys know",
    "start": "355400",
    "end": "361220"
  },
  {
    "text": "that which means we have to develop our internal tools in order to satisfy the",
    "start": "361220",
    "end": "368600"
  },
  {
    "text": "needs of like for example the marginal production data centers and the skills were running at okay so we talked about",
    "start": "368600",
    "end": "380780"
  },
  {
    "text": "all those challenges we are facing what do we do so first one I want to talk",
    "start": "380780",
    "end": "388400"
  },
  {
    "text": "about a solution is Marta tenancy and security so each of the tenant in the",
    "start": "388400",
    "end": "395600"
  },
  {
    "text": "kubernetes cluster will get its own names which gets a native kubernetes separation by default but on top of that",
    "start": "395600",
    "end": "404510"
  },
  {
    "text": "we actually put additional security to satisfy the enterprise security needs",
    "start": "404510",
    "end": "410650"
  },
  {
    "text": "for example we have an TOS communication with internal PCI services the",
    "start": "410650",
    "end": "418330"
  },
  {
    "text": "certificates are actually automated rotated also we use OPA the open policy",
    "start": "418330",
    "end": "426800"
  },
  {
    "text": "agent and our back to limit access to each of the namespace to protect our",
    "start": "426800",
    "end": "432020"
  },
  {
    "text": "tenants instead of using the native coronary secrets we actually use",
    "start": "432020",
    "end": "438110"
  },
  {
    "text": "internal secret management system and on",
    "start": "438110",
    "end": "443180"
  },
  {
    "text": "top of that on the shared cluster we have automatic detection of malicious",
    "start": "443180",
    "end": "449180"
  },
  {
    "text": "behavior so that our tenant will get alerted and necessary action will get",
    "start": "449180",
    "end": "454520"
  },
  {
    "text": "taken across the board we also have",
    "start": "454520",
    "end": "459880"
  },
  {
    "text": "container security for forensic analysis and security concerns we actually scan",
    "start": "459880",
    "end": "466100"
  },
  {
    "text": "the container images before they even go to the production and also across all",
    "start": "466100",
    "end": "475280"
  },
  {
    "text": "get ripples we have co-signing to make sure that all the checking's are properly signed I guess from the",
    "start": "475280",
    "end": "485300"
  },
  {
    "text": "previous slide I cannot mention that we actually deploy Fairmeadow machines so",
    "start": "485300",
    "end": "491180"
  },
  {
    "text": "because we're doing that in-house we actually do develop the tools for all our men patching for those hosts with",
    "start": "491180",
    "end": "498260"
  },
  {
    "text": "house checks also we have the channel tracking and sequencing on a host level",
    "start": "498260",
    "end": "503960"
  },
  {
    "text": "as well to better support multi-tenancy and provide a consistent set up across",
    "start": "503960",
    "end": "510710"
  },
  {
    "text": "all teams that's used in the same coordinate cluster we integrated with service mesh which means if you deploy",
    "start": "510710",
    "end": "517669"
  },
  {
    "text": "our covenant cluster you'll get some cluding features for free for example api is throttling low",
    "start": "517669",
    "end": "525230"
  },
  {
    "text": "balancing and many other features",
    "start": "525230",
    "end": "530050"
  },
  {
    "start": "531000",
    "end": "531000"
  },
  {
    "text": "the second aspect I want to talk about is this internal deployment managed",
    "start": "531670",
    "end": "537800"
  },
  {
    "text": "system that would deploy in-house so",
    "start": "537800",
    "end": "542920"
  },
  {
    "text": "like I mentioned we started to use kubernetes one it was 2015 so we",
    "start": "542920",
    "end": "550100"
  },
  {
    "text": "developed this as a version 1 deployment system which proved that actually works",
    "start": "550100",
    "end": "555620"
  },
  {
    "text": "pretty well so let's look at this graph we define our own manifest formats and",
    "start": "555620",
    "end": "562910"
  },
  {
    "text": "then we're checking those at the tree so net in the kid report if you're not",
    "start": "562910",
    "end": "568670"
  },
  {
    "text": "familiar with JSON air it's actually a pretty clever trees done templating tool where your template is a superset of the",
    "start": "568670",
    "end": "575870"
  },
  {
    "text": "JSON string tags if you're interested just go check it out it's a pretty cool then through the CI system it is",
    "start": "575870",
    "end": "584029"
  },
  {
    "text": "actually getting delivered through different deployment pipelines into the",
    "start": "584029",
    "end": "590540"
  },
  {
    "text": "production data center after getting to a detect production data center we",
    "start": "590540",
    "end": "597249"
  },
  {
    "text": "develop in-house a controller that will get those JSON files and Chrissie RDS on",
    "start": "597249",
    "end": "603649"
  },
  {
    "text": "a kubernetes cluster and after that an operator actually it's also running each",
    "start": "603649",
    "end": "610129"
  },
  {
    "text": "of the kubernetes cluster will watch for every change of the zrd so we have",
    "start": "610129",
    "end": "616459"
  },
  {
    "text": "creation updates and deletion so whenever those CRE changes the operator",
    "start": "616459",
    "end": "621559"
  },
  {
    "text": "will actually do the corresponding action to that kubernetes cluster so the",
    "start": "621559",
    "end": "627529"
  },
  {
    "text": "cool thing about the operator is we actually inject Salesforce integration features and security info within the",
    "start": "627529",
    "end": "635629"
  },
  {
    "text": "operator so this system is a go sneaking",
    "start": "635629",
    "end": "642319"
  },
  {
    "text": "system so that any change does get",
    "start": "642319",
    "end": "647420"
  },
  {
    "text": "checking in the ripple will be quickly reflected in one or multiple productions",
    "start": "647420",
    "end": "652819"
  },
  {
    "text": "and also I think that's pretty cool because sometimes people log in to the",
    "start": "652819",
    "end": "658519"
  },
  {
    "text": "Karina's cluster in production and modify something and this operator will actually override",
    "start": "658519",
    "end": "663970"
  },
  {
    "text": "this change to back the previous state corresponding to the reason and in the",
    "start": "663970",
    "end": "669820"
  },
  {
    "text": "bid ripple because we do resync of the operator pretty fast so we say that is",
    "start": "669820",
    "end": "677550"
  },
  {
    "text": "the system works because we already have 40,000 almost 40,000 PR checking's in",
    "start": "677550",
    "end": "686410"
  },
  {
    "text": "this system which means more than 40,000 commonest deployment has happened in",
    "start": "686410",
    "end": "692740"
  },
  {
    "text": "this system so we allow the system to have so many promise because the teams",
    "start": "692740",
    "end": "698740"
  },
  {
    "text": "actually manage the deployment provoked by the PR approval so it's pretty scalable so we call this version 1",
    "start": "698740",
    "end": "706960"
  },
  {
    "text": "because after we've done this we found some like challenges for example there is no blue/green deployment and also the",
    "start": "706960",
    "end": "713710"
  },
  {
    "text": "manifest formats we defining a house it's kind of complex to learn also this",
    "start": "713710",
    "end": "721060"
  },
  {
    "text": "product this process is pretty much all proprietary this way to address all",
    "start": "721060",
    "end": "728350"
  },
  {
    "text": "those challenges were marching towards version 2 which is a pretty much more",
    "start": "728350",
    "end": "733930"
  },
  {
    "text": "open source solution so from left to right we're checking the home charts and",
    "start": "733930",
    "end": "739870"
  },
  {
    "text": "the CI system picks up the checking and then the delivery pipeline will ship it",
    "start": "739870",
    "end": "745420"
  },
  {
    "text": "to replicate storage and 1 spinnaker instance will be triggered on any change",
    "start": "745420",
    "end": "752980"
  },
  {
    "text": "of the home charts in a storage and do the deployments in the multiple production data centers and in order for",
    "start": "752980",
    "end": "760120"
  },
  {
    "text": "a new data center to get like set up very fast who actually utilize the spinnaker",
    "start": "760120",
    "end": "766000"
  },
  {
    "text": "templates in kill so that the new pipeline will be mature alized without",
    "start": "766000",
    "end": "772960"
  },
  {
    "text": "human intervention cool so next aspect I",
    "start": "772960",
    "end": "781060"
  },
  {
    "text": "want to talk about is orchestrated production visibility so if you guys",
    "start": "781060",
    "end": "787180"
  },
  {
    "text": "remember I mentioned that there's network isolation production data center didn't talk to each other there's also",
    "start": "787180",
    "end": "793570"
  },
  {
    "text": "privileged restrictive privilege so that people cannot just like using your laptop to",
    "start": "793570",
    "end": "800290"
  },
  {
    "text": "log into production data center as they wish so this those restrictions have",
    "start": "800290",
    "end": "807400"
  },
  {
    "text": "been making you know ad hoc analysis or lighters you know I just want to look at the production deployment those things",
    "start": "807400",
    "end": "814000"
  },
  {
    "text": "are hard to address those we actually deploy developing house this",
    "start": "814000",
    "end": "820960"
  },
  {
    "text": "orchestrated production visibility pipeline which is pretty cool if you",
    "start": "820960",
    "end": "826090"
  },
  {
    "text": "look at this graph in each of the production data centers we deploy a",
    "start": "826090",
    "end": "831790"
  },
  {
    "text": "component called snapshot producer which watches the kubernetes coop API server",
    "start": "831790",
    "end": "839650"
  },
  {
    "text": "in the kubernetes cluster and gets all the status of all the",
    "start": "839650",
    "end": "846550"
  },
  {
    "text": "components resources in that cluster and it actually ships all the state of the",
    "start": "846550",
    "end": "852940"
  },
  {
    "text": "current kubernetes resources from production through Kafka into the Rd",
    "start": "852940",
    "end": "859690"
  },
  {
    "text": "data center where we set up a sequel instance so actually in a psycho",
    "start": "859690",
    "end": "865360"
  },
  {
    "text": "instance you have a read-only copy of all the state of all the kubernetes",
    "start": "865360",
    "end": "870550"
  },
  {
    "text": "cluster of all the production data centers in front of that we have the",
    "start": "870550",
    "end": "876820"
  },
  {
    "text": "pseudo cube API because pseudo code API because is not a real Kupa api server",
    "start": "876820",
    "end": "884200"
  },
  {
    "text": "but the cool thing is is speaks the same protocol as the Kouga api server this",
    "start": "884200",
    "end": "890110"
  },
  {
    "text": "actually enables like people can use standard kubernetes tour like coop CTL",
    "start": "890110",
    "end": "895960"
  },
  {
    "text": "and coop dashboard against this coop api server actually curing the read-only",
    "start": "895960",
    "end": "903430"
  },
  {
    "text": "copy Seco in our new data center instead of actually logging to the production",
    "start": "903430",
    "end": "908740"
  },
  {
    "text": "data centers so this model has worked really well we have customers using this tool all",
    "start": "908740",
    "end": "915640"
  },
  {
    "text": "the time and whether when they're using it they don't know they're Korea against the read-only copy in the R&D data",
    "start": "915640",
    "end": "921550"
  },
  {
    "text": "center this is all they were occurring against the production in as an arm so",
    "start": "921550",
    "end": "927700"
  },
  {
    "text": "after we build this initial system we had in mind for visibility but after it",
    "start": "927700",
    "end": "933100"
  },
  {
    "text": "was working it's like almost we found it so helpful for a lot of other user cases",
    "start": "933100",
    "end": "939510"
  },
  {
    "text": "wait I said a hundred to town to talk about those user cases Thank You chef so",
    "start": "939510",
    "end": "946990"
  },
  {
    "start": "946000",
    "end": "946000"
  },
  {
    "text": "when we built this system we quickly found that just clearing the raw sequel was incredibly powerful for a lot of",
    "start": "946990",
    "end": "953620"
  },
  {
    "text": "scenarios so let me give a quick example let's say an alert goes off and I",
    "start": "953620",
    "end": "959190"
  },
  {
    "text": "investigate and I find that the root cause is a container that has a a pod",
    "start": "959190",
    "end": "966190"
  },
  {
    "text": "within a NIC container that's in a crash loop and it's just failing to come up so",
    "start": "966190",
    "end": "971950"
  },
  {
    "text": "I found that it's happening this one cluster and now I want to know is this happening in all the other clusters well I could run a whole bunch of coupe",
    "start": "971950",
    "end": "978700"
  },
  {
    "text": "cuddle commands against each cluster and I could collate all the results and if I want to share it with my co-workers I",
    "start": "978700",
    "end": "984280"
  },
  {
    "text": "could send it to them and taxed but we found works much better as just writing a little bit of sequel this is valid my",
    "start": "984280",
    "end": "992980"
  },
  {
    "text": "sequel syntax this query finds all pods and all namespaces and all clusters with",
    "start": "992980",
    "end": "1000240"
  },
  {
    "text": "a phase of pending and some message on the NIC container and the only part that might look a little funny is where it",
    "start": "1000240",
    "end": "1006210"
  },
  {
    "text": "says payload - greater than greater than and that is my sequels shorthand for",
    "start": "1006210",
    "end": "1011400"
  },
  {
    "text": "jason extract the payload column is the kubernetes resource in json format the",
    "start": "1011400",
    "end": "1018600"
  },
  {
    "text": "exact same thing you would get from coop cuddle get pod - Oh Jason and on the right side is the Jason path I want to",
    "start": "1018600",
    "end": "1026339"
  },
  {
    "text": "pull a value out of so let's run this query and this tells me I've got four",
    "start": "1026340",
    "end": "1033150"
  },
  {
    "text": "pods with this issue two and cluster seven and two and cluster 21 and I can",
    "start": "1033150",
    "end": "1038730"
  },
  {
    "text": "see that the ones in cluster seven have been broken for quite a while because one of them restarted almost 10,000",
    "start": "1038730",
    "end": "1044579"
  },
  {
    "text": "times and I can see that it it's consistently this certain it container that's failing so this is a useful query",
    "start": "1044580",
    "end": "1052350"
  },
  {
    "text": "I might want to run this in the future after we've rolled out a fix so we have",
    "start": "1052350",
    "end": "1058710"
  },
  {
    "text": "a component called sequel reporter where I can check this query into a config map it lights this up on a",
    "start": "1058710",
    "end": "1065700"
  },
  {
    "text": "dashboard and now this query has a URL so I can hit that URL at any point and get the results this query I could share",
    "start": "1065700",
    "end": "1071370"
  },
  {
    "text": "it with my coworkers so I go roll out a fix I go to the dashboard and no results",
    "start": "1071370",
    "end": "1076860"
  },
  {
    "text": "return so I've fixed it but now I want to know if this issue comes back so we have another component called the sequel",
    "start": "1076860",
    "end": "1082680"
  },
  {
    "text": "watchdog again a config map I could drop in the same query and I could set it to page the on-call person if there's ever",
    "start": "1082680",
    "end": "1089790"
  },
  {
    "text": "a new world returned we also have a third component that's very similar",
    "start": "1089790",
    "end": "1095490"
  },
  {
    "text": "where I can compute a custom metric so if I don't have a built in metric I need",
    "start": "1095490",
    "end": "1100980"
  },
  {
    "text": "but I can compute it using sequel I can drop it in there we use that for things like how many nodes are on this version",
    "start": "1100980",
    "end": "1108030"
  },
  {
    "text": "of docker this version of kubernetes or how many what is the count of pods by phase and that's been really helpful and",
    "start": "1108030",
    "end": "1116600"
  },
  {
    "text": "this has actually been used so heavily that we hit the size limit on a config",
    "start": "1116600",
    "end": "1122430"
  },
  {
    "text": "map from handwritten sequel queries and had to do a little work to condense them",
    "start": "1122430",
    "end": "1127980"
  },
  {
    "text": "down on the same note of visibility and",
    "start": "1127980",
    "end": "1133200"
  },
  {
    "text": "monitoring this is a open source project for your release last month that I'm very excited about sloop is a kubernetes history you know a",
    "start": "1133200",
    "end": "1142230"
  },
  {
    "text": "tool for capturing kubernetes history and showing it to you visually so you deploy this into the cluster it monitors",
    "start": "1142230",
    "end": "1149100"
  },
  {
    "text": "keeps track of about two weeks of history and lets you explore that",
    "start": "1149100",
    "end": "1154500"
  },
  {
    "text": "history visually so what I'm showing here is the last hour of the lizard deployment so this timeline at the top",
    "start": "1154500",
    "end": "1161940"
  },
  {
    "text": "green bar is the deployment these orange bars are pods you can see I started with",
    "start": "1161940",
    "end": "1168030"
  },
  {
    "text": "four and a deployment happened right about 11:20 I started bring on new pods",
    "start": "1168030",
    "end": "1174330"
  },
  {
    "text": "and as those became healthy I drained the old pods and at the bottom are replicas sets and if you use kubernetes",
    "start": "1174330",
    "end": "1181620"
  },
  {
    "text": "you know that kubernetes can be a little lazy about garbage collecting old replica sets they're usually just count",
    "start": "1181620",
    "end": "1186900"
  },
  {
    "text": "zero there's actually a new replica start set that started 11 20 bit got clipped off the bottom but in addition",
    "start": "1186900",
    "end": "1193950"
  },
  {
    "text": "to showing this visually you can actually drill in and get kubernetes events and payload changes like you",
    "start": "1193950",
    "end": "1200250"
  },
  {
    "text": "could see what actually changed in this deployment at this time and one cool use case we have internally there's a team",
    "start": "1200250",
    "end": "1206669"
  },
  {
    "text": "that for each test run spins up a kubernetes cluster runs all their tests",
    "start": "1206669",
    "end": "1211710"
  },
  {
    "text": "and he includes loop in the cluster and before they delete the cluster they download a copy of this loop history so",
    "start": "1211710",
    "end": "1218850"
  },
  {
    "text": "if they wanted to debug a failure after the fact they can load it into the sloop UI figure out what the issue was and",
    "start": "1218850",
    "end": "1224640"
  },
  {
    "text": "that's them debugging a cluster that doesn't even exist anymore which I'm not aware of any other tools that does this",
    "start": "1224640",
    "end": "1230299"
  },
  {
    "text": "unfortunately we don't have time for live demo but the website address is",
    "start": "1230299",
    "end": "1235860"
  },
  {
    "text": "there and we're giving demos at our Salesforce booth tomorrow from 1:00 to 3:00 and Thursday from 3:00 to 5:00",
    "start": "1235860",
    "end": "1243799"
  },
  {
    "text": "this next slide talks about our approach to quality or our team's approach to",
    "start": "1243799",
    "end": "1249090"
  },
  {
    "start": "1244000",
    "end": "1244000"
  },
  {
    "text": "quality the first one is unit tests which is very common but the next part is we tend",
    "start": "1249090",
    "end": "1259230"
  },
  {
    "text": "to under intentionally under invest in traditional integration tests and edie tests these are typically things that",
    "start": "1259230",
    "end": "1265710"
  },
  {
    "text": "you would run in a VM and you'd bring up three different components and they would talk to each other the problem is",
    "start": "1265710",
    "end": "1271440"
  },
  {
    "text": "a lot of times these testing environments don't perfectly match production and so you miss some things",
    "start": "1271440",
    "end": "1277289"
  },
  {
    "text": "but also sometimes you get false alerts you know maybe there's not as much memory in the test environment as production so what we invest in instead",
    "start": "1277289",
    "end": "1284970"
  },
  {
    "text": "are watch dogs watch dogs for us is a deployment or daemon set that runs a set",
    "start": "1284970",
    "end": "1290909"
  },
  {
    "text": "of synthetic checks and a synthetic check is like pretending to be the user",
    "start": "1290909",
    "end": "1295950"
  },
  {
    "text": "so I'll change a deployment I'll make sure that I can connect to the new pods I'll route some traffic through Dean you",
    "start": "1295950",
    "end": "1303330"
  },
  {
    "text": "know make sure I'm using the right dns I'll read and write some data to a local volume maybe we have one that hits the",
    "start": "1303330",
    "end": "1312270"
  },
  {
    "text": "API server with intentionally invalid requests to make sure that our back rules are catching it so these checks we",
    "start": "1312270",
    "end": "1320190"
  },
  {
    "text": "run you know a couple times a minute we run them in every cluster we operate and",
    "start": "1320190",
    "end": "1325460"
  },
  {
    "text": "when they detect a failure you know we wire them up to page the on-call person",
    "start": "1325460",
    "end": "1330510"
  },
  {
    "text": "we write the results to see our DS which we can again query and sequel and view",
    "start": "1330510",
    "end": "1337200"
  },
  {
    "text": "the history of in sloop but this saves us a lot of time because we write one",
    "start": "1337200",
    "end": "1343500"
  },
  {
    "text": "check and it helps us prevent regressions on new code we write it helps us monitor all of our live",
    "start": "1343500",
    "end": "1350010"
  },
  {
    "text": "production clusters so we know that every feature is working at all times and it really just helps where if",
    "start": "1350010",
    "end": "1356460"
  },
  {
    "text": "there's any sort of inconsistencies across production data centers say this new one has a different chipset a",
    "start": "1356460",
    "end": "1362520"
  },
  {
    "text": "slightly different disk driver well maybe I can't get test beds that",
    "start": "1362520",
    "end": "1368250"
  },
  {
    "text": "perfectly match every production data center but at least I know that I've got these checks if there is an issue I'll",
    "start": "1368250",
    "end": "1373679"
  },
  {
    "text": "know it immediately as opposed to getting surprised later on next up is",
    "start": "1373679",
    "end": "1378690"
  },
  {
    "text": "how we roll out our changes using phased release this is common practice we first",
    "start": "1378690",
    "end": "1383970"
  },
  {
    "text": "rolled a test bed and then an RD environment with customer clusters and",
    "start": "1383970",
    "end": "1389520"
  },
  {
    "text": "then a subset of production and then the rest of production we have a few hours of make time in each phase and all we're",
    "start": "1389520",
    "end": "1395909"
  },
  {
    "text": "doing is seeing if any watchdogs fire and page s and if not we are confident that these new bits are good and we can",
    "start": "1395909",
    "end": "1401850"
  },
  {
    "text": "proceed forward but we also do is for",
    "start": "1401850",
    "end": "1406980"
  },
  {
    "text": "the vast majority of new features we build them disabled by default so I'm gonna go build a new feature I will",
    "start": "1406980",
    "end": "1413970"
  },
  {
    "text": "first put in a boolean into the config file set it default to false and then my code is largely under an if statement",
    "start": "1413970",
    "end": "1420110"
  },
  {
    "text": "what this means is the next phase release goes out my code is now in production but it's not doing anything",
    "start": "1420110",
    "end": "1427049"
  },
  {
    "text": "because it's disabled me as the subject matter expert can go in after the phase release and go turn it on monitor my",
    "start": "1427049",
    "end": "1434130"
  },
  {
    "text": "feature that I know well because I wrote it if everything's good I'm done if not I can quickly switch it off and what's",
    "start": "1434130",
    "end": "1441299"
  },
  {
    "text": "really great about this is I didn't have to roll back all four phases because I dick has discovered a bug I just turned",
    "start": "1441299",
    "end": "1447659"
  },
  {
    "text": "off the feature and so that greatly minimizes well then the other thing is",
    "start": "1447659",
    "end": "1454370"
  },
  {
    "text": "if it was an enabled by default it would go out in the phase earliest and the person that's running the phase release",
    "start": "1454370",
    "end": "1460440"
  },
  {
    "text": "might not be the expert if not than our outage might last longer last",
    "start": "1460440",
    "end": "1466490"
  },
  {
    "text": "is repair automation because we have this watchdog signal flowing through CDs flowing to sequel we just have a simple",
    "start": "1466490",
    "end": "1472580"
  },
  {
    "text": "automation system that can detect unhealthy hosts and trigger power cycle based on that signal this last slide",
    "start": "1472580",
    "end": "1480309"
  },
  {
    "start": "1479000",
    "end": "1479000"
  },
  {
    "text": "talks about some future projects so the first one is mutating in mission controllers we use these we're starting",
    "start": "1480309",
    "end": "1487730"
  },
  {
    "text": "to use these much more heavily internally for injecting things around certs or logging or a whole bunch of",
    "start": "1487730",
    "end": "1495170"
  },
  {
    "text": "different things we found this to be an incredibly powerful integration point in kubernetes but also probably the most",
    "start": "1495170",
    "end": "1501620"
  },
  {
    "text": "dangerous one if you're not familiar with these you can basically say he commits is when you go to create this resource before you finish creating it",
    "start": "1501620",
    "end": "1508340"
  },
  {
    "text": "send it to me I'm gonna make a little bit of modification send it back there's a lot of boilerplate code and it can be",
    "start": "1508340",
    "end": "1515420"
  },
  {
    "text": "tricky to validate these right so we're building a common framework that makes that easier so we can ship high quality",
    "start": "1515420",
    "end": "1521690"
  },
  {
    "text": "ones and consistently validate these next up is cost to serve reporting and",
    "start": "1521690",
    "end": "1527330"
  },
  {
    "text": "alerting so with bare metal first party machines underutilizing Hardware wasn't something",
    "start": "1527330",
    "end": "1534410"
  },
  {
    "text": "we were going to page someone about because we paid for the hardware if we",
    "start": "1534410",
    "end": "1539960"
  },
  {
    "text": "don't have workload for it right now we can't give it back as we move more into public cloud this becomes much more",
    "start": "1539960",
    "end": "1546080"
  },
  {
    "text": "important because we can auto scale up and down VMs so we're gonna be reporting",
    "start": "1546080",
    "end": "1551330"
  },
  {
    "text": "and learning both for over utilized and underutilized hardware so like if something is wasting money we want to",
    "start": "1551330",
    "end": "1556460"
  },
  {
    "text": "get the tenant to fix that but if a process is trending where they're using",
    "start": "1556460",
    "end": "1562520"
  },
  {
    "text": "more and more memory or more more CPU and they're gonna hit some limit we want to let them know before they hit that limit next up is one step onboarding so",
    "start": "1562520",
    "end": "1570980"
  },
  {
    "text": "if an internal team wants to build a new micro service and they're kind of new to this space all they need is a repo and",
    "start": "1570980",
    "end": "1577490"
  },
  {
    "text": "source code and a build scripts and a docker file and a CI job to publish the docker file and a helm chair and a",
    "start": "1577490",
    "end": "1584090"
  },
  {
    "text": "spinnaker pipeline and then they get their app deployed to test bed but that's a lot of new technologies - all",
    "start": "1584090",
    "end": "1590120"
  },
  {
    "text": "taken at once so building a one step onboarding portal you",
    "start": "1590120",
    "end": "1595389"
  },
  {
    "text": "fill in a few details about your team and it gives you a hello world app fully built and deployed and then you can",
    "start": "1595389",
    "end": "1601539"
  },
  {
    "text": "start piling in your business logic next up is better helm validations of PR time",
    "start": "1601539",
    "end": "1607389"
  },
  {
    "text": "so our our helm workflow today is I go make a change to a helmet art I send out",
    "start": "1607389",
    "end": "1613329"
  },
  {
    "text": "a PR I have a peer review it it gets merged ci builds it ships it spinnaker",
    "start": "1613329",
    "end": "1618700"
  },
  {
    "text": "takes it and applies it to kubernetes but there's a bunch of internal requirements we have for our helmet arts",
    "start": "1618700",
    "end": "1624190"
  },
  {
    "text": "for security reasons or for auditing or any number of things we rely on OPA to fail that deployment",
    "start": "1624190",
    "end": "1631749"
  },
  {
    "text": "if there's any issues but this is way down the pipeline and we would much rather just have a status check on the",
    "start": "1631749",
    "end": "1638349"
  },
  {
    "text": "helm PR saying hey if you check this in it's gonna fail because you forgot to put the tag for resource accounting",
    "start": "1638349",
    "end": "1643570"
  },
  {
    "text": "purposes so that's something we'll work on and the last is an open-source version of the visibility pipeline we",
    "start": "1643570",
    "end": "1649149"
  },
  {
    "text": "talked about earlier with the pseudo API and the sequel the card version is a little coupled to some internal systems",
    "start": "1649149",
    "end": "1655509"
  },
  {
    "text": "but for not a whole lot more work we're gonna build one that's easy to deploy at",
    "start": "1655509",
    "end": "1661089"
  },
  {
    "text": "public cloud and open source for other people to use because we've found it to be incredibly valuable and with that",
    "start": "1661089",
    "end": "1672129"
  },
  {
    "text": "that's all of our prepared content and we're happy to answer any questions we",
    "start": "1672129",
    "end": "1677709"
  },
  {
    "text": "have a microphone right here if do you mean do you mind using the microphone so",
    "start": "1677709",
    "end": "1684759"
  },
  {
    "text": "I for the recording",
    "start": "1684759",
    "end": "1688379"
  },
  {
    "text": "thanks for the wonderful talk so part of the thing that you're kind of doing with",
    "start": "1695190",
    "end": "1704380"
  },
  {
    "text": "the read-only sequel copy could also be achieved through like a logging pipeline",
    "start": "1704380",
    "end": "1710290"
  },
  {
    "text": "that it is a logging pipeline right we're logging messages to Kafka but but",
    "start": "1710290",
    "end": "1718330"
  },
  {
    "text": "this is something where on the other end we're exposing it as if it's a kubernetes api so you can use your",
    "start": "1718330",
    "end": "1724540"
  },
  {
    "text": "standard tools as opposed most logging systems you could write a log query so",
    "start": "1724540",
    "end": "1729730"
  },
  {
    "text": "we can actually run coop cuddle or coop dashboard but sorry what's the question yeah the question is basically the kind",
    "start": "1729730",
    "end": "1737230"
  },
  {
    "text": "of what made you kind of use the cue Carol API as the API as opposed to like",
    "start": "1737230",
    "end": "1743710"
  },
  {
    "text": "what usually used to kind of for the logging monitoring logging an aggregation and locks no basically the",
    "start": "1743710",
    "end": "1756310"
  },
  {
    "text": "logging that the cluster produces say audit logs are the regular API server",
    "start": "1756310",
    "end": "1761950"
  },
  {
    "text": "logs it could probably give you the same information that your we do have that as well",
    "start": "1761950",
    "end": "1767110"
  },
  {
    "text": "we're just no one uses it so the nice thing about exposing a cuban api is as",
    "start": "1767110",
    "end": "1772540"
  },
  {
    "text": "new tools are developed mm-hmm any user can just spin it up point it at the api and so like something can be",
    "start": "1772540",
    "end": "1779140"
  },
  {
    "text": "invented tomorrow or like slip came online we can point it at the pseudo api and now we have a historic analysis tool",
    "start": "1779140",
    "end": "1786480"
  },
  {
    "text": "where as we don't get that for free if we just ship it to a log storage and",
    "start": "1786480",
    "end": "1792040"
  },
  {
    "text": "also i can act is so for this visit but it's a pipeline we're more like looking",
    "start": "1792040",
    "end": "1798130"
  },
  {
    "text": "at the current status of all actual kubernetes resource status and for logging some stuff we actually have a",
    "start": "1798130",
    "end": "1804100"
  },
  {
    "text": "building house logging system as well to ship the logging from the production to",
    "start": "1804100",
    "end": "1809560"
  },
  {
    "text": "a visit like a dashboard and stuff so it's actually their internal that that's",
    "start": "1809560",
    "end": "1814810"
  },
  {
    "text": "posting to get a category that there's actually actually internal tools so we need to integrate with to build use",
    "start": "1814810",
    "end": "1821410"
  },
  {
    "text": "those two on top of coronaries so to apply yes we do have those got it yeah the other question is about",
    "start": "1821410",
    "end": "1828310"
  },
  {
    "text": "the framework for admission controller um did you guys like investigate if",
    "start": "1828310",
    "end": "1834430"
  },
  {
    "text": "there's something similar available in open source or are you guys are gonna be open sourcing yours that's one thing I",
    "start": "1834430",
    "end": "1860260"
  },
  {
    "text": "forgot to mention Oh most of the things on this future project we're gonna try and open source like that we've had a",
    "start": "1860260",
    "end": "1866110"
  },
  {
    "text": "really good experience open sourcing soup and some as much as possible we're gonna try and open source future",
    "start": "1866110",
    "end": "1871360"
  },
  {
    "text": "projects it's actually been a really great experience so stay tuned we're gonna have more open source thank you",
    "start": "1871360",
    "end": "1877390"
  },
  {
    "text": "thank you [Applause]",
    "start": "1877390",
    "end": "1885970"
  },
  {
    "text": "any other questions just one because I'm like how do you manage secrets you said",
    "start": "1887410",
    "end": "1893900"
  },
  {
    "text": "like you you're not using kubernetes secrets so is it something like you guys",
    "start": "1893900",
    "end": "1899060"
  },
  {
    "text": "have built out yeah it's a proprietary internal system we built so yes so it",
    "start": "1899060",
    "end": "1904580"
  },
  {
    "text": "will uphold to the enterprise standard we can just use kubernetes secret management because that's also good as",
    "start": "1904580",
    "end": "1911090"
  },
  {
    "text": "no like set it's fine the enterprise need thank you thank you you did it",
    "start": "1911090",
    "end": "1923800"
  }
]