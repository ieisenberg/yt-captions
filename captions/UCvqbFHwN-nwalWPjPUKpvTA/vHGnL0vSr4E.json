[
  {
    "start": "0",
    "end": "39000"
  },
  {
    "text": "welcome everyone I'm Sandra I'm working",
    "start": "179",
    "end": "5549"
  },
  {
    "text": "for booking comm in Amsterdam and sorry",
    "start": "5549",
    "end": "14849"
  },
  {
    "text": "it froze yeah so my talk is as you can",
    "start": "14849",
    "end": "24119"
  },
  {
    "text": "see life cycle of coop CTL command here I'll show you how we hardened out kubernetes set up with automation and how that gets reflected throughout the",
    "start": "24119",
    "end": "31380"
  },
  {
    "text": "lifespan of a cup CTL command so let's have a quick look at the agenda of the",
    "start": "31380",
    "end": "36690"
  },
  {
    "text": "talk first we will see the different multi tenant kubernetes cluster",
    "start": "36690",
    "end": "42680"
  },
  {
    "start": "39000",
    "end": "39000"
  },
  {
    "text": "architecture we have in booking.com and the usual deployment works slow that our",
    "start": "42680",
    "end": "48899"
  },
  {
    "text": "developer swallows and then we will see the challenges that we faced during",
    "start": "48899",
    "end": "55399"
  },
  {
    "text": "managing this automation as sorta managing this multi tenant on Prem clusters and the solutions that we came",
    "start": "55399",
    "end": "62250"
  },
  {
    "text": "up with and also we will see how we automated all the solutions for all the",
    "start": "62250",
    "end": "67470"
  },
  {
    "text": "multi engine clusters we have across our infrastructure then we will see how these automations are leveraged by the",
    "start": "67470",
    "end": "75270"
  },
  {
    "text": "lifespan of a single cup serial command with an example and if we hopefully get",
    "start": "75270",
    "end": "81299"
  },
  {
    "text": "time we will go through a Q&A session as well so let's begin so let's have a look",
    "start": "81299",
    "end": "87360"
  },
  {
    "text": "first the different cluster architecture we have so currently at this moment in",
    "start": "87360",
    "end": "92400"
  },
  {
    "text": "booking.com we run tens of multi-tenant kubernetes clusters where we categorize",
    "start": "92400",
    "end": "98180"
  },
  {
    "text": "these clusters into three environments basically the first one is the dev",
    "start": "98180",
    "end": "103619"
  },
  {
    "text": "environment where the developers actually hack into their prototypes and new ideas then we have the staging",
    "start": "103619",
    "end": "109680"
  },
  {
    "text": "environment which resembles the production environment but is used mostly for testing purposes and then we",
    "start": "109680",
    "end": "116640"
  },
  {
    "text": "have the production clusters where the application runs instead of the production traffic now the we will look",
    "start": "116640",
    "end": "123840"
  },
  {
    "text": "at the usual deployment workflow on these clusters in every environment so the workflow is very simple in each",
    "start": "123840",
    "end": "130020"
  },
  {
    "start": "129000",
    "end": "129000"
  },
  {
    "text": "environment we have two types of clusters one is application type in the",
    "start": "130020",
    "end": "136080"
  },
  {
    "text": "application clusters the workloads are actually run there the pods deployment",
    "start": "136080",
    "end": "141720"
  },
  {
    "text": "is always a workload type of objects are created in application application cluster and then they run there and we",
    "start": "141720",
    "end": "147810"
  },
  {
    "text": "have a separate type of cluster called management clusters and in this management cluster Dave's actually go",
    "start": "147810",
    "end": "154440"
  },
  {
    "text": "and deploy their application with our in-house built multi cluster Kennedy",
    "start": "154440",
    "end": "159960"
  },
  {
    "text": "deployment solution shipper which is a communities native way to deploy multiple cluster route traffic and shift",
    "start": "159960",
    "end": "166590"
  },
  {
    "text": "capacity and all these things so our developers just go to management cluster and then tell shipper to deploy it",
    "start": "166590",
    "end": "172650"
  },
  {
    "text": "across our fleet and shipper then deploys the application across multiple clusters if you want to know more about",
    "start": "172650",
    "end": "179690"
  },
  {
    "text": "shipper and the workflow you can read more about shipper here now the",
    "start": "179690",
    "end": "185040"
  },
  {
    "text": "challenges that we faced during managing these multi-tenant cluster because as you saw we have different types of",
    "start": "185040",
    "end": "192110"
  },
  {
    "text": "clusters in in our infrastructure every cluster has to maintain a consistent",
    "start": "192110",
    "end": "198360"
  },
  {
    "text": "workflow permissions and configurations right in every namespace so each cluster actually shares the same name spaces so",
    "start": "198360",
    "end": "205860"
  },
  {
    "text": "that we can maintain the deployment workflow in a smooth way so the challenges that we faced initially was",
    "start": "205860",
    "end": "212460"
  },
  {
    "start": "211000",
    "end": "211000"
  },
  {
    "text": "the project management because multi-tenant cluster means multiple service owners and multiple deploy their",
    "start": "212460",
    "end": "218580"
  },
  {
    "text": "multiple projects in these clusters and we need resource isolation which gets solved basically by using kubernetes",
    "start": "218580",
    "end": "226020"
  },
  {
    "text": "namespaces because that creates the business isolation but then comes the resource management because it's a",
    "start": "226020",
    "end": "232740"
  },
  {
    "text": "challenge because different projects has different types of requirements some requires more resources more CPU more",
    "start": "232740",
    "end": "239100"
  },
  {
    "text": "memory some require less write and we handle such cases using kubernetes native resource code object that",
    "start": "239100",
    "end": "245190"
  },
  {
    "text": "actually acts as a safeguard so that one project accidentally does not continue",
    "start": "245190",
    "end": "250530"
  },
  {
    "text": "consume entire cluster resources so resource quotas actually helped us",
    "start": "250530",
    "end": "256530"
  },
  {
    "text": "achieve that then we face the challenge of providing auth management or",
    "start": "256530",
    "end": "261600"
  },
  {
    "text": "maintaining the auth management because in all of our clusters we want to make",
    "start": "261600",
    "end": "266700"
  },
  {
    "text": "in the same ought protocol an autumn pipeline so that users can just go to",
    "start": "266700",
    "end": "272700"
  },
  {
    "text": "our management cluster and apply the application without thinking they have permission in every cluster or not that",
    "start": "272700",
    "end": "278340"
  },
  {
    "text": "just works because we have a consistent off pipeline across all clusters using kubernetes roll bindings and the",
    "start": "278340",
    "end": "284250"
  },
  {
    "text": "kubernetes are back and using custom oscar books then next challenge game is",
    "start": "284250",
    "end": "290700"
  },
  {
    "text": "config management different organization a different requirement for the application to run with certain configurations right so the way we",
    "start": "290700",
    "end": "297270"
  },
  {
    "text": "propagate these configurations is using config maps and these config maps are injected in every namespace well the",
    "start": "297270",
    "end": "304650"
  },
  {
    "text": "namespaces are created and finally the validation and safeguards of the resources that are being created and we",
    "start": "304650",
    "end": "311310"
  },
  {
    "text": "achieve that using admission webhooks from communities and part security policies which are also known as PSPs",
    "start": "311310",
    "end": "316410"
  },
  {
    "text": "using this we can ensure a secure environment for your workloads to run now this solutions at a glance may seem",
    "start": "316410",
    "end": "325410"
  },
  {
    "text": "a bit simple to create for one cluster or a couple of namespaces but when your",
    "start": "325410",
    "end": "331590"
  },
  {
    "text": "cluster increases and when the this projects running on your clusters",
    "start": "331590",
    "end": "337470"
  },
  {
    "text": "increases because right now in our tens of clusters we run almost half a thousand of services in production and",
    "start": "337470",
    "end": "343230"
  },
  {
    "text": "at that point it becomes more challenging or toilet for the admins to maintain those clusters and this is",
    "start": "343230",
    "end": "350910"
  },
  {
    "text": "exactly the point when we need automation to saw came out to solve all the problems because doing them by hand",
    "start": "350910",
    "end": "357600"
  },
  {
    "text": "is not feasible by that time anymore the way we tackle that is using a word source provisioning sorry what space",
    "start": "357600",
    "end": "363540"
  },
  {
    "text": "provisioning which takes care of automating all the solutions that I discussed in the previous slide so the",
    "start": "363540",
    "end": "369840"
  },
  {
    "text": "automated works is provisioning works with three main components which is the first one is Service Catalog this is",
    "start": "369840",
    "end": "377220"
  },
  {
    "text": "something that we built in our company and the Service Catalog is just a catalog well before deploying any new",
    "start": "377220",
    "end": "383010"
  },
  {
    "text": "service in kubernetes or any new project project our developers actually registered that service or the project",
    "start": "383010",
    "end": "388800"
  },
  {
    "text": "in service catalog so that they can maintain an ownership information and service catalog just gives that keeps",
    "start": "388800",
    "end": "394590"
  },
  {
    "text": "track of the projects that are created and the ownership meta information then the next thing is the booking I am",
    "start": "394590",
    "end": "401030"
  },
  {
    "text": "we have this is the identity provider for all of our users in the company which is kept in sync with with the",
    "start": "401030",
    "end": "407330"
  },
  {
    "text": "service catalog so that it knows which user has permission to which project or which user is admin of which project",
    "start": "407330",
    "end": "413750"
  },
  {
    "text": "this is just keeping track of the different projects we have and then we have a custom namespace controller that",
    "start": "413750",
    "end": "420920"
  },
  {
    "text": "actually does the heavy lifting and it does the automation for us based on the projects created or kept in or",
    "start": "420920",
    "end": "427280"
  },
  {
    "text": "registered in service Drake service catalog and now we will see how the workflow works so first our developers",
    "start": "427280",
    "end": "435110"
  },
  {
    "text": "create a project in the service catalog and at the same point of time our",
    "start": "435110",
    "end": "441260"
  },
  {
    "text": "identity provider gets inked with service catalog with the information for",
    "start": "441260",
    "end": "446870"
  },
  {
    "text": "the ownership like this user has created the project so this user is an admin of this project now right and then what",
    "start": "446870",
    "end": "454010"
  },
  {
    "text": "happens after that is the namespace controller that I talked about in the previous slide runs in every cluster we have that keeps a watch on Service",
    "start": "454010",
    "end": "461780"
  },
  {
    "text": "Catalog and then whenever it figures out there is a new project created that",
    "start": "461780",
    "end": "467450"
  },
  {
    "text": "namespace controller in the local kubernetes cluster creates these following resources it creates a",
    "start": "467450",
    "end": "473720"
  },
  {
    "text": "namespace for that project to be deployed on it creates a role binding for all the users who will have access",
    "start": "473720",
    "end": "481790"
  },
  {
    "text": "to this project it will actually assign a group not static users in the role binding we'll see that later it creates",
    "start": "481790",
    "end": "488210"
  },
  {
    "text": "a resource quota object which actually acts as a safeguard for all the resources to be created in this namespace it also creates limit ranges",
    "start": "488210",
    "end": "495350"
  },
  {
    "text": "object which is a kubernetes native object that defines the default CPU and",
    "start": "495350",
    "end": "501050"
  },
  {
    "text": "memory requests and limits for every container if the users do not provide by",
    "start": "501050",
    "end": "506150"
  },
  {
    "text": "themselves also it propagates some or odd specific configuration to every",
    "start": "506150",
    "end": "512599"
  },
  {
    "text": "namespace that gets created and out the applications that get right deployed in",
    "start": "512600",
    "end": "517610"
  },
  {
    "text": "these namespaces can make use of these afterwards now I we will see how the",
    "start": "517610",
    "end": "524840"
  },
  {
    "text": "lifespan of AI or lifecycle of a cup CTL camp command actually leverages the automation provided by the previous",
    "start": "524840",
    "end": "531880"
  },
  {
    "text": "provisioning work so so for that let's take an example for a simple Katia mole",
    "start": "531880",
    "end": "539050"
  },
  {
    "text": "is just a simple busybox pod which we will see will get created in an m-space",
    "start": "539050",
    "end": "544390"
  },
  {
    "text": "called by Trenton for example and it's run the busybox image with image pool policy if not present and for say a",
    "start": "544390",
    "end": "552280"
  },
  {
    "start": "551000",
    "end": "551000"
  },
  {
    "text": "developer now we'll run cook CTL player - f on this pod manifest object right so",
    "start": "552280",
    "end": "558880"
  },
  {
    "text": "what happened actually in this case first the user or developer runs the coop CTL command or makes a list API",
    "start": "558880",
    "end": "565180"
  },
  {
    "text": "call to the kubernetes api server and then the coop config file that we use",
    "start": "565180",
    "end": "572380"
  },
  {
    "text": "looks any other coop config file that everyone uses but instead of using static token or certificate for auth we",
    "start": "572380",
    "end": "580240"
  },
  {
    "text": "actually use the coop coop CTL executed angel plugin as you can see in the users",
    "start": "580240",
    "end": "585610"
  },
  {
    "text": "field there is no credentials there and instead they it has a command field that",
    "start": "585610",
    "end": "590890"
  },
  {
    "text": "has a path to an executable which is supposed to generate a token for every",
    "start": "590890",
    "end": "596470"
  },
  {
    "text": "cup CTL command someone runs and after making a cup CTL call command this",
    "start": "596470",
    "end": "602380"
  },
  {
    "text": "command fills executable actually is invoked by coop CTL itself internally which we wrote and that actually",
    "start": "602380",
    "end": "609010"
  },
  {
    "text": "generates a custom token that our identity provider understands then this",
    "start": "609010",
    "end": "614050"
  },
  {
    "text": "binary outputs this kind of JSON payload it has a kind exact attention and it has",
    "start": "614050",
    "end": "620680"
  },
  {
    "text": "a status field with a bearer token that it creates and an expression timestamp for the token right so you can generate",
    "start": "620680",
    "end": "627970"
  },
  {
    "text": "any token from your own exact attention executable which your identity provider",
    "start": "627970",
    "end": "634240"
  },
  {
    "text": "understands and that's it when you do that when this executable does that this request is sent to kubernetes api server",
    "start": "634240",
    "end": "640990"
  },
  {
    "text": "and then after cabinet is going to accompany the passer of kubernetes api server then sends it to our custom Otway",
    "start": "640990",
    "end": "647350"
  },
  {
    "text": "book for validating the token that is being sent so kubernetes then sends the request to",
    "start": "647350",
    "end": "654280"
  },
  {
    "text": "our custom auto web book and the example request first that kubernetes api server sends looks like this",
    "start": "654280",
    "end": "660970"
  },
  {
    "text": "it contains the API version the kind that provides in the JSON payload is token review and then this in the spec",
    "start": "660970",
    "end": "668500"
  },
  {
    "text": "field it injects the token that came from the executive initial plugin when the proxy tell command was run as you",
    "start": "668500",
    "end": "674350"
  },
  {
    "text": "can see the token has my bearer token which was created by the the exec tential plugin here in the token field",
    "start": "674350",
    "end": "680740"
  },
  {
    "text": "then our customer who actually sends this extracts this token from the token",
    "start": "680740",
    "end": "685930"
  },
  {
    "text": "review object and sends this to our identity provider that contains the information for all the users in our",
    "start": "685930",
    "end": "691120"
  },
  {
    "text": "company and then identity provider actually checks with the service directory project permissions and returns back the the projects that this",
    "start": "691120",
    "end": "699310"
  },
  {
    "text": "user has access to and then the username also to which they took this token",
    "start": "699310",
    "end": "704800"
  },
  {
    "text": "belongs to and then the auth webhook sends back the response to kubernetes api server after authenticating this",
    "start": "704800",
    "end": "711430"
  },
  {
    "text": "request and that the example response looks like this if the request is",
    "start": "711430",
    "end": "716740"
  },
  {
    "text": "accepted that the exam then the example response looks like this it has an API version kind is again token review in",
    "start": "716740",
    "end": "722680"
  },
  {
    "text": "the status field it says the value of analytic authenticated field to true and it also",
    "start": "722680",
    "end": "728020"
  },
  {
    "text": "sends the user meta information with username to which this token belongs to the UID of the user and the group's the",
    "start": "728020",
    "end": "735610"
  },
  {
    "text": "group's is actually generated by the earth web book after reading the project",
    "start": "735610",
    "end": "742540"
  },
  {
    "text": "permission from our identity provider so we just came up with our naming convention that the group name will look",
    "start": "742540",
    "end": "747550"
  },
  {
    "text": "like this the project name : the permission it can be editor admin viewer however you set up the role binding for",
    "start": "747550",
    "end": "753610"
  },
  {
    "text": "your namespace will see that afterwards after that if the request is rejected",
    "start": "753610",
    "end": "758710"
  },
  {
    "text": "instead of getting allowed then the response looks like this is the same as the allowed response in the kind it will",
    "start": "758710",
    "end": "765040"
  },
  {
    "text": "be talking review but in the status it will be authenticated false and the user will get back this response all the way",
    "start": "765040",
    "end": "771550"
  },
  {
    "text": "back to the output of coop CTL command that he ran rather user and so this is",
    "start": "771550",
    "end": "778510"
  },
  {
    "text": "the custom auth workflow that happens in our cluster and it happens consistently across all of our clusters now how can",
    "start": "778510",
    "end": "785500"
  },
  {
    "text": "we we saw that the how the example request and response looks like now we will see how to configure this auth web",
    "start": "785500",
    "end": "792820"
  },
  {
    "text": "hook with your when it is API server you just have to pass this two flags authentication token",
    "start": "792820",
    "end": "799020"
  },
  {
    "text": "web config file where you pass a coupon thick file and you pass a flag authentication token web cache TTL by",
    "start": "799020",
    "end": "804839"
  },
  {
    "text": "default the value of this TTL is two minutes what this flag does it sets the",
    "start": "804839",
    "end": "810060"
  },
  {
    "text": "timeout for a decision that is taken by the the earthwork so after that this",
    "start": "810060",
    "end": "815880"
  },
  {
    "text": "decision is not cached anymore so if you are using a short loop token I would suggest reducing it to something like",
    "start": "815880",
    "end": "821760"
  },
  {
    "text": "five seconds or 10 seconds then the coop config file that you pass to the first",
    "start": "821760",
    "end": "827250"
  },
  {
    "text": "flag looks like this it looks exactly like any other group config file it has type config it has clusters or any user",
    "start": "827250",
    "end": "834300"
  },
  {
    "text": "set a context and current context but the difference is in the cluster server URL instead of passing it an API server",
    "start": "834300",
    "end": "841050"
  },
  {
    "text": "URL you pass it to the custom auto a book URL that you built yourselves for",
    "start": "841050",
    "end": "847170"
  },
  {
    "text": "your organization and you were running and that's it after that your auth wave",
    "start": "847170",
    "end": "852209"
  },
  {
    "text": "book is configured and it can validate your user the next thing then after",
    "start": "852209",
    "end": "858120"
  },
  {
    "text": "authenticating this request this request then goes through the kubernetes are back now how does our back knows about",
    "start": "858120",
    "end": "864930"
  },
  {
    "text": "this request now so just a quick recap that in the world's best provisioning we saw the controller create that this role",
    "start": "864930",
    "end": "871290"
  },
  {
    "start": "867000",
    "end": "867000"
  },
  {
    "text": "binding object in the limb space right and the role binding object definition looks like this it is type role binding",
    "start": "871290",
    "end": "877140"
  },
  {
    "text": "it says the namespace name bike rental that we created the name of the role",
    "start": "877140",
    "end": "882779"
  },
  {
    "text": "binding object is is admin and the role reference is cluster role admin so it's",
    "start": "882779",
    "end": "889709"
  },
  {
    "text": "referring to cluster role admin and then it's assigning this role to a group not",
    "start": "889709",
    "end": "895050"
  },
  {
    "text": "any particular user to a group called bike rental : admin ok so dynamically",
    "start": "895050",
    "end": "901079"
  },
  {
    "text": "every user who will be a part of this bike rental Pollin admin group will have",
    "start": "901079",
    "end": "906120"
  },
  {
    "text": "admin access to only to this namespace though the cluster role here is admin but the user will not get this",
    "start": "906120",
    "end": "913640"
  },
  {
    "text": "permission on entire cluster it will be on the namespace itself only because",
    "start": "913640",
    "end": "919290"
  },
  {
    "text": "it's just a role reference and it's a role binding object not a cluster all binding object okay so this bike rental",
    "start": "919290",
    "end": "925650"
  },
  {
    "text": ": admin group that you can see here was actually asserted dynamically on after in the",
    "start": "925650",
    "end": "932839"
  },
  {
    "text": "earth way book when the request was sent and this example response was returned",
    "start": "932839",
    "end": "938660"
  },
  {
    "text": "back by asserting this bike rental : admin group there and that's how coupon it is this role binding object in the",
    "start": "938660",
    "end": "945230"
  },
  {
    "text": "namespace will authorize this request in the namespace so this is how kubernetes",
    "start": "945230",
    "end": "952129"
  },
  {
    "text": "are back will allow or disallow this request based on if the user has permission in this namespace or not then",
    "start": "952129",
    "end": "959029"
  },
  {
    "text": "after passing through kubernetes are back this request goes through kubernetes mutating admission waiver so",
    "start": "959029",
    "end": "965029"
  },
  {
    "text": "kubernetes admission controller provides us a way to define mutation web hooks to",
    "start": "965029",
    "end": "970579"
  },
  {
    "text": "intercept any requests to your kubernetes api server and then you can change the definition of the object or",
    "start": "970579",
    "end": "977509"
  },
  {
    "text": "inject new things there based on your organization requirement so you can customize every payload that gets sent",
    "start": "977509",
    "end": "984139"
  },
  {
    "text": "to your cluster some example use case of the mutation mutation web book is you",
    "start": "984139",
    "end": "991699"
  },
  {
    "start": "988000",
    "end": "988000"
  },
  {
    "text": "can assign random non-root you IDs because root UID is vulnerable and also",
    "start": "991699",
    "end": "997100"
  },
  {
    "text": "root URI is injected automatically by kubernetes if you don't define any so you can assign or change the UID to some",
    "start": "997100",
    "end": "1003459"
  },
  {
    "text": "non random UID based on the namespace in the pod you can inject environment",
    "start": "1003459",
    "end": "1008920"
  },
  {
    "text": "variables in the pod if the pod does not contain when the ones that your organization requires you",
    "start": "1008920",
    "end": "1015040"
  },
  {
    "text": "can inject some labels on the pod before even the pod so these things will happen before the pot actually gets created in",
    "start": "1015040",
    "end": "1021490"
  },
  {
    "text": "the mutation wave book you can also inject in it containers or site cars in",
    "start": "1021490",
    "end": "1026798"
  },
  {
    "text": "your pod definition even though if your user or developer does not define them in the pod definition now we will see",
    "start": "1026799",
    "end": "1035079"
  },
  {
    "text": "how the example request from kubernetes api server to this mutation web book",
    "start": "1035079",
    "end": "1040089"
  },
  {
    "text": "looks like so the payload will look like this it will have an OID field which will just be used for auditing purposes",
    "start": "1040089",
    "end": "1046350"
  },
  {
    "text": "as a reference and then it will have the resource type here I ran coop CTL create command so on the pod creation so it",
    "start": "1046350",
    "end": "1054070"
  },
  {
    "text": "will say it's a pod and then the name of the part that was in the pod definition and the namespace where the body is",
    "start": "1054070",
    "end": "1060160"
  },
  {
    "text": "created on an operation which operation was made on this so it is it was a create operation as we saw it can be",
    "start": "1060160",
    "end": "1066190"
  },
  {
    "text": "creative date or delete based on your coop CTL command and then it also will",
    "start": "1066190",
    "end": "1071260"
  },
  {
    "text": "contain the user information like which user actually made this request the you",
    "start": "1071260",
    "end": "1076720"
  },
  {
    "text": "idea of the user and also the groups this user belong to which was provided",
    "start": "1076720",
    "end": "1082480"
  },
  {
    "text": "by the earthquake that we saw in previous slides and it will also contain the object definition that the user is",
    "start": "1082480",
    "end": "1089050"
  },
  {
    "text": "requesting right so after reading this object definition you can actually analyze the definition and make",
    "start": "1089050",
    "end": "1094960"
  },
  {
    "text": "mutations on top of it to change the definition if you want or inject new things and also if it's an update",
    "start": "1094960",
    "end": "1102070"
  },
  {
    "text": "operation then you will have an old object field as well which will show you what was the previous state so that you can take a diff and based on that you",
    "start": "1102070",
    "end": "1109000"
  },
  {
    "text": "can decide and that's it that's the example request the example response will look like this it will have an UID",
    "start": "1109000",
    "end": "1115240"
  },
  {
    "text": "field which you will have to propel it from the request field so that you can cross-reference them during the auditing",
    "start": "1115240",
    "end": "1121120"
  },
  {
    "text": "and then you have to pass the allowed field to be true and you have to pass a",
    "start": "1121120",
    "end": "1126250"
  },
  {
    "text": "batch type that you want to make here I'm passing JSON patch and currently as",
    "start": "1126250",
    "end": "1131950"
  },
  {
    "text": "of now mutation will book only supports JSON patches and then you send a byte",
    "start": "1131950",
    "end": "1137140"
  },
  {
    "text": "array of all your patches and the patches look like this here underneath it will have an awful which will say",
    "start": "1137140",
    "end": "1143500"
  },
  {
    "text": "what operation you want to make I said add and I pass a path adjacent path in the JSON definition it's a suspect",
    "start": "1143500",
    "end": "1149470"
  },
  {
    "text": "containers 0 which is the first container and then image pool policy and the value I'm setting here is always",
    "start": "1149470",
    "end": "1155850"
  },
  {
    "text": "what this patch will do in the poor definition we saw the image pool policy",
    "start": "1155850",
    "end": "1162370"
  },
  {
    "text": "was if not present that's how I created it but if it goes to the mutation wave after mutation it will turn into always",
    "start": "1162370",
    "end": "1169380"
  },
  {
    "text": "so this is just one example that you can do so you can change basically any field",
    "start": "1169380",
    "end": "1174790"
  },
  {
    "text": "in the per definition or any object definition that will go through the mutation web book now we will see how to",
    "start": "1174790",
    "end": "1180550"
  },
  {
    "text": "configure the mutation web book with your API server so you have to pass this enable admission plugins flag in your",
    "start": "1180550",
    "end": "1187090"
  },
  {
    "text": "API server definition a binary when you run it and you have to pass mutating",
    "start": "1187090",
    "end": "1192700"
  },
  {
    "text": "admission web option there that's how you can enable the mutation webbook and then you have",
    "start": "1192700",
    "end": "1197990"
  },
  {
    "text": "to create a mutating webbook configuration type of type of object which will define what are the objects",
    "start": "1197990",
    "end": "1205159"
  },
  {
    "text": "on which this mutation web book will be applied okay so here I am passing metadata part mutation and then I define",
    "start": "1205159",
    "end": "1211279"
  },
  {
    "text": "the webhooks configuration where we'll pass the client configu RL and that will",
    "start": "1211279",
    "end": "1217399"
  },
  {
    "text": "contain the URL to the mutation vapor query or mutation web book is actually running and serving requests and it has",
    "start": "1217399",
    "end": "1223580"
  },
  {
    "text": "failure policy fail it can also be ignored so failure policy defines if the",
    "start": "1223580",
    "end": "1229250"
  },
  {
    "text": "if there is an error in server side or this way book is not it not reachable then what will happen will it fail open",
    "start": "1229250",
    "end": "1236000"
  },
  {
    "text": "or will it actually fail the requests so if you've set ignored then the request will be fail open if a mutation workbook",
    "start": "1236000",
    "end": "1242419"
  },
  {
    "text": "is down if it is failed then if mutation why book is down every pod creation request will fail based on the policy",
    "start": "1242419",
    "end": "1248360"
  },
  {
    "text": "and you pass the name of the apartment name of the configuration and also the define the rules like which objects will",
    "start": "1248360",
    "end": "1255350"
  },
  {
    "text": "be applicable for this mutation we have up here I'm passing resources pods and the tree and the operation type create",
    "start": "1255350",
    "end": "1262970"
  },
  {
    "text": "which will actually define that only for what creation request send the participation request to this way book",
    "start": "1262970",
    "end": "1269659"
  },
  {
    "text": "and after doing coups it'll apply on this waiver configuration your pod",
    "start": "1269659",
    "end": "1275120"
  },
  {
    "text": "mutation will book is configured in the cluster so that's part mutation way book or any",
    "start": "1275120",
    "end": "1280250"
  },
  {
    "text": "mutation wave book that you want for your cluster for any resources not only just pause now after going to mutation",
    "start": "1280250",
    "end": "1286630"
  },
  {
    "text": "the request will go through object schema validation internally in kubernetes control in kubernetes and",
    "start": "1286630",
    "end": "1292399"
  },
  {
    "text": "mission controller because you can change any field or definition in the object right then kubernetes needs to",
    "start": "1292399",
    "end": "1298429"
  },
  {
    "text": "check that if it still complies with the default schema definition of the core objects in inside communities and after",
    "start": "1298429",
    "end": "1305690"
  },
  {
    "text": "this validation this request will get forwarded to a validating admission web",
    "start": "1305690",
    "end": "1311240"
  },
  {
    "text": "book so it's quite like mutating admission workbook but validating admission where book also intercepts the",
    "start": "1311240",
    "end": "1317240"
  },
  {
    "text": "request but it cannot mutate it it just validates that if the field values are correct as per your organization",
    "start": "1317240",
    "end": "1324260"
  },
  {
    "text": "requirement you can check any field then you can reject the request based on",
    "start": "1324260",
    "end": "1329550"
  },
  {
    "text": "your requirement if some field has some unexpected value or if someone is trying to do something differently than your",
    "start": "1329550",
    "end": "1336060"
  },
  {
    "text": "expectation some example use cases for using validation wave-wave book is like you can check legitimacy of the board or",
    "start": "1336060",
    "end": "1343860"
  },
  {
    "start": "1337000",
    "end": "1337000"
  },
  {
    "text": "service or object that is being created for us we just check if this project if",
    "start": "1343860",
    "end": "1349170"
  },
  {
    "text": "this spot is register I mean sorry the project this spot belongs to is registered in Service Catalog or not",
    "start": "1349170",
    "end": "1355910"
  },
  {
    "text": "then it you can also check like the images that your containers in the pod is used that are being used are actually",
    "start": "1355910",
    "end": "1363480"
  },
  {
    "text": "from trusted so image registry or not and based on these decisions you can",
    "start": "1363480",
    "end": "1369060"
  },
  {
    "text": "actually reject them reject this request immediately before even the pod is created you can also check the number of",
    "start": "1369060",
    "end": "1374580"
  },
  {
    "text": "containers in the pod which actually we have tested and found out that large number of containers in one single pod",
    "start": "1374580",
    "end": "1380370"
  },
  {
    "text": "makes some performance degradation for the daka runtime engine on the host so you can check that and even and if the",
    "start": "1380370",
    "end": "1386970"
  },
  {
    "text": "the number of containers in the pod is higher you can reject that request as well with proper message then you can",
    "start": "1386970",
    "end": "1393900"
  },
  {
    "text": "also check the presence of some certain labels or even environment variables if you want that are present on the under",
    "start": "1393900",
    "end": "1400140"
  },
  {
    "text": "container or not on the pod or not also you can enforce certain based practices",
    "start": "1400140",
    "end": "1406500"
  },
  {
    "text": "for the kubernetes resource declaration like how the label case will look like you can verify them and validate them so",
    "start": "1406500",
    "end": "1414990"
  },
  {
    "text": "the example requests for the mutation of a book looks exactly same as the sorry",
    "start": "1414990",
    "end": "1420540"
  },
  {
    "text": "validation where book looks exactly same as the mutation web book but the",
    "start": "1420540",
    "end": "1427140"
  },
  {
    "text": "response looks a little bit different if the request is accepted then the response looks the following it",
    "start": "1427140",
    "end": "1433200"
  },
  {
    "text": "has the response field it has Eid and it will have allowed will set to true but",
    "start": "1433200",
    "end": "1439080"
  },
  {
    "text": "it will not have the patch field because validation where book cannot patch object definition but if it is a deny if",
    "start": "1439080",
    "end": "1447570"
  },
  {
    "text": "you don't want to allow this request to be accepted then you can send the",
    "start": "1447570",
    "end": "1453330"
  },
  {
    "text": "response with this UID you say allowed filled to be false and then in the status field you can set a",
    "start": "1453330",
    "end": "1459600"
  },
  {
    "text": "some error code with for example this this this time I'm sending 400 and a",
    "start": "1459600",
    "end": "1464910"
  },
  {
    "text": "custom message why this request will not be accepted right so that your user gets",
    "start": "1464910",
    "end": "1470490"
  },
  {
    "text": "a nice feedback that why this pod request is being denied with proper",
    "start": "1470490",
    "end": "1475679"
  },
  {
    "text": "error code and message so the the configuration for validating webhook is",
    "start": "1475679",
    "end": "1481320"
  },
  {
    "text": "same as mutation workbook you just passed validating with admission webbook value in the flag and then you create a",
    "start": "1481320",
    "end": "1488429"
  },
  {
    "text": "validating web book configuration instead of imitating web configuration object and the rest of the definition",
    "start": "1488429",
    "end": "1494039"
  },
  {
    "text": "looks exactly same as a mutation we hope you can define the rules the same way",
    "start": "1494039",
    "end": "1499370"
  },
  {
    "text": "after going through validation validating admission web book if the request is denied you can send right",
    "start": "1499370",
    "end": "1506220"
  },
  {
    "text": "from here a denial message with error code to the user a full example",
    "start": "1506220",
    "end": "1513390"
  },
  {
    "text": "implementation of kubernetes validating and mediating admission where book can be found in this link if you want to go",
    "start": "1513390",
    "end": "1518880"
  },
  {
    "text": "through it after passing through validating admission web book the request actually boast resource potter",
    "start": "1518880",
    "end": "1526200"
  },
  {
    "text": "controller which is the last admission control that happens in communities admission controller so a quick recap",
    "start": "1526200",
    "end": "1532200"
  },
  {
    "text": "that our automation actually created a resource quota object in the namespace right so based on that resource coder",
    "start": "1532200",
    "end": "1539309"
  },
  {
    "text": "controller we'll see if it can sustain one more part in this namespace or not if it can then it will allow this",
    "start": "1539309",
    "end": "1545340"
  },
  {
    "text": "request but if it cannot then it will reject the request saying you are out of quota you cannot create a new board in",
    "start": "1545340",
    "end": "1551159"
  },
  {
    "text": "this namespace right now after passing through the source quota controller after only that it gets stored in",
    "start": "1551159",
    "end": "1558030"
  },
  {
    "text": "kubernetes back in storage ACD at this moment this part now exists in kubernetes state kubernetes HCD cluster",
    "start": "1558030",
    "end": "1565919"
  },
  {
    "text": "but that does not mean the pod will pod has started run running right away",
    "start": "1565919",
    "end": "1571400"
  },
  {
    "text": "because after storing it in a city then port security policy or a PSP kicks in",
    "start": "1571400",
    "end": "1578960"
  },
  {
    "text": "support security policies are a cluster wide resource that manages some security",
    "start": "1578960",
    "end": "1585299"
  },
  {
    "text": "sensitive information for the containers in your pod and you can restrict",
    "start": "1585299",
    "end": "1591000"
  },
  {
    "text": "different accesses from your controller eyes using part security policies so in order for a pot to actually start it has to",
    "start": "1591000",
    "end": "1597800"
  },
  {
    "text": "comply at with at least one persecutory policy that you have in your cluster some example use cases of for security",
    "start": "1597800",
    "end": "1605330"
  },
  {
    "start": "1604000",
    "end": "1604000"
  },
  {
    "text": "policy are it can prohibit running part",
    "start": "1605330",
    "end": "1610550"
  },
  {
    "text": "with UID 0 so if container breakout happens it can so that containerized",
    "start": "1610550",
    "end": "1616040"
  },
  {
    "text": "processes cannot make any harm to your host processes because if it runs with route ID route EU ID and if it has",
    "start": "1616040",
    "end": "1622550"
  },
  {
    "text": "privileged accesses then it can be dangerous for you cluster then you can allow certain or no host part at all to",
    "start": "1622550",
    "end": "1630170"
  },
  {
    "text": "be mounted within your pod just to be safe and secure so that your parts do",
    "start": "1630170",
    "end": "1636110"
  },
  {
    "text": "not access the host parts without poor security policy actually kubernetes allows you to run any part as route",
    "start": "1636110",
    "end": "1643010"
  },
  {
    "text": "which may have root access on your node because that's the default behavior of any vanilla kubernetes cluster so you",
    "start": "1643010",
    "end": "1649700"
  },
  {
    "text": "can restrict these things using poor security policies other things you can do is you can forbid access to the host",
    "start": "1649700",
    "end": "1655820"
  },
  {
    "text": "network namespace or host IPC namespace and host PID name spaces because allowing this will actually allow the",
    "start": "1655820",
    "end": "1662660"
  },
  {
    "text": "contraries process to have same almost same level of access to the host processes and they will be able to sniff",
    "start": "1662660",
    "end": "1670730"
  },
  {
    "text": "into other post processes or other containers running on the same nodes they will be able to sniff their",
    "start": "1670730",
    "end": "1676070"
  },
  {
    "text": "environment variable or configurations as well if they have this kind of thing permissions or even they will be able to",
    "start": "1676070",
    "end": "1681350"
  },
  {
    "text": "manipulate the network stack as well on your host node what the pod is running",
    "start": "1681350",
    "end": "1686630"
  },
  {
    "text": "you can also limit Linux capabilities which are mostly associated with super user permissions like cap net admin or",
    "start": "1686630",
    "end": "1693350"
  },
  {
    "text": "or cap net binding so that what you what",
    "start": "1693350",
    "end": "1698870"
  },
  {
    "text": "can happen is it may have more privileged privileged escalation",
    "start": "1698870",
    "end": "1705010"
  },
  {
    "text": "permission then it requires so that what it will be able to do it will be able to",
    "start": "1705010",
    "end": "1710060"
  },
  {
    "text": "actually escalate privileges to its child processes I mean the containerized",
    "start": "1710060",
    "end": "1715340"
  },
  {
    "text": "process will be able to escalate privileges to a child processes more than itself this can be limited may",
    "start": "1715340",
    "end": "1722040"
  },
  {
    "text": "limited using the port security policies so that you are safe and secure if any",
    "start": "1722040",
    "end": "1727230"
  },
  {
    "text": "container a breakout happens some more use cases are you can allow a certain range of you IDs and group IDs with",
    "start": "1727230",
    "end": "1733860"
  },
  {
    "text": "which your containers will run with so that you 100% sure that it won't be able to use any other UID orgy ID and you can",
    "start": "1733860",
    "end": "1739980"
  },
  {
    "text": "also allow certain types of volumes to be used by the ports in your cluster like you can define like only allow",
    "start": "1739980",
    "end": "1746610"
  },
  {
    "text": "secret persistent volume config map and download API or you can also add emptier right so only those volumes will be able",
    "start": "1746610",
    "end": "1754070"
  },
  {
    "text": "will be mountable by your ports in the cluster and you can also say allow only",
    "start": "1754070",
    "end": "1759150"
  },
  {
    "text": "a certain range of host port access in the host network namespaces this type of things you can define or you can also",
    "start": "1759150",
    "end": "1764820"
  },
  {
    "text": "make sorry root filesystem inside your container to be read-only so that",
    "start": "1764820",
    "end": "1770130"
  },
  {
    "text": "container cannot write anything in your namespace so these are the configurations that you can do you can",
    "start": "1770130",
    "end": "1777030"
  },
  {
    "text": "you can allow enable the admission PSP using passing this flag and you have to",
    "start": "1777030",
    "end": "1782190"
  },
  {
    "text": "create a default PSP for all the ports",
    "start": "1782190",
    "end": "1787290"
  },
  {
    "text": "in your cluster you can just be at a port security policy object with restricted name and then you can fill",
    "start": "1787290",
    "end": "1794010"
  },
  {
    "text": "the the other specs as per the as per the example shown in the link so I'm not",
    "start": "1794010",
    "end": "1799830"
  },
  {
    "text": "showing them here and then you will have to create a cluster role and cluster all binding here you can see them so that",
    "start": "1799830",
    "end": "1806580"
  },
  {
    "text": "the service accounts which reach your port will run will be able to use these things we use this port security policy",
    "start": "1806580",
    "end": "1812430"
  },
  {
    "text": "and a cluster all binding will be able to then use this cluster role restricted and it will be applicable to system",
    "start": "1812430",
    "end": "1819360"
  },
  {
    "text": "service accounts which is all service accounts in your name space in your cluster and then it will also get a",
    "start": "1819360",
    "end": "1824940"
  },
  {
    "text": "applicable to a system authenticated which will be all authenticated users will be able to use this port security",
    "start": "1824940",
    "end": "1830070"
  },
  {
    "text": "policy so by default every part will run with restricted policy but if you have a valid use case for your for having",
    "start": "1830070",
    "end": "1838620"
  },
  {
    "text": "privileged spots then you can create it by creating a privileged PSP and giving some relaxed permission to that PSP and",
    "start": "1838620",
    "end": "1847560"
  },
  {
    "text": "use it only in a certain namespaces with certain service accounts by creating",
    "start": "1847560",
    "end": "1852780"
  },
  {
    "text": "additional cluster rules and class rule binding for Espie Espie and if multiple port",
    "start": "1852780",
    "end": "1858730"
  },
  {
    "start": "1857000",
    "end": "1857000"
  },
  {
    "text": "security policies are there only the ones and that comes the first in the alphabetic order will be used for by",
    "start": "1858730",
    "end": "1864490"
  },
  {
    "text": "upon this is tricky one but that's how it happens for port security policies after passing through port security",
    "start": "1864490",
    "end": "1870760"
  },
  {
    "text": "policy only then a pod starts actually running and if the user gets the final",
    "start": "1870760",
    "end": "1876190"
  },
  {
    "text": "response back this is how the entire lifecycle of the coop CTL perman looks like you know all of our kubernetes",
    "start": "1876190",
    "end": "1881290"
  },
  {
    "text": "clusters in a very consistent way because these are all automated not done by hand some key takeaways are you can",
    "start": "1881290",
    "end": "1888190"
  },
  {
    "text": "customize your workflow using custom controllers or maybe using a framework like Co builder to automate any work so",
    "start": "1888190",
    "end": "1893620"
  },
  {
    "start": "1889000",
    "end": "1889000"
  },
  {
    "text": "that you have in your organization custom controllers are very useful you can get some example information from",
    "start": "1893620",
    "end": "1899830"
  },
  {
    "text": "there and you can also reuse your organization existing organizations existing permission provide provider",
    "start": "1899830",
    "end": "1907770"
  },
  {
    "text": "using kubernetes custom web books so that you don't have to implement something new you can also leverage the",
    "start": "1907770",
    "end": "1913630"
  },
  {
    "text": "admission controllers our web hooks that kubernetes provides to validate and mutate the resources so that you won't",
    "start": "1913630",
    "end": "1918970"
  },
  {
    "text": "you know what is happening in your cluster and finally take the opportunity to use poor security policies to enforce",
    "start": "1918970",
    "end": "1924670"
  },
  {
    "text": "a security environment for your workloads to run thank you so much and if you have any question or if anything",
    "start": "1924670",
    "end": "1931870"
  },
  {
    "text": "looks daunting to you in the slides we are hiring you can come to me I can",
    "start": "1931870",
    "end": "1937360"
  },
  {
    "text": "ensure a smooth onboarding process just kidding I will be here you can ask more questions here thank you so much",
    "start": "1937360",
    "end": "1945450"
  },
  {
    "start": "1943000",
    "end": "1943000"
  },
  {
    "text": "the slide links are here if you want to scan so you can find it if you do it three minutes if anybody has a question",
    "start": "1949350",
    "end": "1955230"
  },
  {
    "text": "they want to ask sure hi thanks for the talk",
    "start": "1955230",
    "end": "1961830"
  },
  {
    "text": "I would like to ask if there was any decision between Susan outwork hook",
    "start": "1961830",
    "end": "1967200"
  },
  {
    "text": "instead of JSON web tokens and you seen an OECD validation from baby server so",
    "start": "1967200",
    "end": "1973500"
  },
  {
    "text": "check the idea French is not love the token instead of active validation okay",
    "start": "1973500",
    "end": "1978950"
  },
  {
    "text": "so you're saying what what about using OID C right instead of instead of using",
    "start": "1978950",
    "end": "1990870"
  },
  {
    "text": "an active validation if you discussed it internally on and why did you choose",
    "start": "1990870",
    "end": "1996120"
  },
  {
    "text": "past evaluation instead of online offline validation right so we are using",
    "start": "1996120",
    "end": "2001940"
  },
  {
    "text": "this kind of dynamic behavior because as we saw every project gets registered in our Service Catalog",
    "start": "2001940",
    "end": "2007340"
  },
  {
    "text": "right so permissions actually changes dynamically so if we do offline then someone if a project permission changes",
    "start": "2007340",
    "end": "2014420"
  },
  {
    "text": "in a namespace right then someone will the person who will lose the access will have to read re login to get the new",
    "start": "2014420",
    "end": "2021110"
  },
  {
    "text": "type of permission if we go through this dynamic works so this is how we are actually dynamically giving someone",
    "start": "2021110",
    "end": "2027440"
  },
  {
    "text": "permission or revoking someone's permission and every cup CTL command goes to that what works slow and that's",
    "start": "2027440",
    "end": "2032930"
  },
  {
    "text": "why you saw in the roll binding we created a gave the permission to a group not a particular user so this is why we",
    "start": "2032930",
    "end": "2039860"
  },
  {
    "text": "use this kind of dynamic behavior does that answer you hello thank you for this",
    "start": "2039860",
    "end": "2046310"
  },
  {
    "text": "talk how much of this is open source especially the Service Catalog port so",
    "start": "2046310",
    "end": "2054050"
  },
  {
    "text": "the thing you saw here except for the auto hook because the auth wave book can talk to any identity provider that your",
    "start": "2054050",
    "end": "2062450"
  },
  {
    "text": "organization has write rest of the things are like from directly from kubernetes the service catalog is not",
    "start": "2062450",
    "end": "2069050"
  },
  {
    "text": "open source is just in-house built but it is only used for the purpose of keeping the service it has a database",
    "start": "2069050",
    "end": "2074810"
  },
  {
    "text": "and interface users go there and create a project and then the user name based on our energy provider gets stored there",
    "start": "2074810",
    "end": "2081169"
  },
  {
    "text": "but is not something like outside because this is very tightly coupled with our odd structures so but yeah you can have",
    "start": "2081169",
    "end": "2088330"
  },
  {
    "text": "any source right now you have to include with your works though each one yeah",
    "start": "2088330",
    "end": "2100950"
  },
  {
    "text": "because the interact thing I forgot that the interact thing you saw here the deployment solution that I mentioned",
    "start": "2100950",
    "end": "2107260"
  },
  {
    "text": "that goes to multiple multiple clusters that is open source and I provided the link there yeah our multi cluster Canada",
    "start": "2107260",
    "end": "2113020"
  },
  {
    "text": "deployment solution is fully open source yeah yeah I have a very general question",
    "start": "2113020",
    "end": "2118440"
  },
  {
    "text": "why did you decide to give developers or give developers cube CTL at access in",
    "start": "2118440",
    "end": "2126130"
  },
  {
    "text": "the first place so why don't you go through some automated process only let rent Jenkins to do cubes it applies but",
    "start": "2126130",
    "end": "2134200"
  },
  {
    "text": "let the developers do it very nice question this is kind of like third or",
    "start": "2134200",
    "end": "2141160"
  },
  {
    "text": "fourth iteration of the platform as a service that we are providing right now and we took that path that the one that",
    "start": "2141160",
    "end": "2147490"
  },
  {
    "text": "you are suggesting we came up some kind of magical tooling that we will help users to do their job but the server",
    "start": "2147490",
    "end": "2154450"
  },
  {
    "text": "does not say that the reality was not like this users are not happy at all when they go through a predefined path",
    "start": "2154450",
    "end": "2160570"
  },
  {
    "text": "because there is always like in our 20s clusters more than thousands of developers actually work every day and",
    "start": "2160570",
    "end": "2166390"
  },
  {
    "text": "everyone has their specific needs they see that kubernetes as a as an open",
    "start": "2166390",
    "end": "2171640"
  },
  {
    "text": "source project which has a lot of possibilities but when you give them a path or a CI pipeline there you just",
    "start": "2171640",
    "end": "2178570"
  },
  {
    "text": "narrow down the road right so that then based on our user feedbacks the road that we took or the approach that we",
    "start": "2178570",
    "end": "2184990"
  },
  {
    "text": "took here we are providing all the features of kubernetes that kubernetes provides but in a controlled fashion so",
    "start": "2184990",
    "end": "2191980"
  },
  {
    "text": "that users and do not feel left left out so this is exactly why this is based on our user feedback and user requirement",
    "start": "2191980",
    "end": "2198400"
  },
  {
    "text": "in our company okay and with that I think we have to stop thank you very much and thank you guys for the great questions and please remember to rate",
    "start": "2198400",
    "end": "2203980"
  },
  {
    "text": "them on the app thank you",
    "start": "2203980",
    "end": "2207359"
  }
]