[
  {
    "start": "0",
    "end": "33000"
  },
  {
    "text": "uh thanks everybody for coming uh this",
    "start": "120",
    "end": "2580"
  },
  {
    "text": "talk is called stretching the cni",
    "start": "2580",
    "end": "4020"
  },
  {
    "text": "boundaries with service meshes a roadmap",
    "start": "4020",
    "end": "5580"
  },
  {
    "text": "for the future",
    "start": "5580",
    "end": "7080"
  },
  {
    "text": "uh so first a little bit about myself my",
    "start": "7080",
    "end": "9000"
  },
  {
    "text": "name is Alex I'm a software engineer at",
    "start": "9000",
    "end": "11040"
  },
  {
    "text": "a company called buoyant I'm one of the",
    "start": "11040",
    "end": "12540"
  },
  {
    "text": "Linker D maintainers so I feel very",
    "start": "12540",
    "end": "14519"
  },
  {
    "text": "lucky that I get to spend my day job",
    "start": "14519",
    "end": "16198"
  },
  {
    "text": "working on open source software which is",
    "start": "16199",
    "end": "18060"
  },
  {
    "text": "awesome",
    "start": "18060",
    "end": "20240"
  },
  {
    "text": "uh linkertys is a pretty cool project",
    "start": "20520",
    "end": "23039"
  },
  {
    "text": "that I work on it's service mesh it's",
    "start": "23039",
    "end": "25019"
  },
  {
    "text": "the only graduated service mesh in the",
    "start": "25019",
    "end": "28439"
  },
  {
    "text": "cncf and lots of people use it and it's",
    "start": "28439",
    "end": "31080"
  },
  {
    "text": "very cool",
    "start": "31080",
    "end": "33380"
  },
  {
    "start": "33000",
    "end": "78000"
  },
  {
    "text": "so this talk in retrospect could have",
    "start": "34500",
    "end": "36780"
  },
  {
    "text": "been called how do service meshes use",
    "start": "36780",
    "end": "38820"
  },
  {
    "text": "and configure cni and what sucks about",
    "start": "38820",
    "end": "40800"
  },
  {
    "text": "it and also what what can we do better",
    "start": "40800",
    "end": "42540"
  },
  {
    "text": "so we're going to be talking a lot about",
    "start": "42540",
    "end": "44480"
  },
  {
    "text": "uh the some of the problems that service",
    "start": "44480",
    "end": "46739"
  },
  {
    "text": "meshes have encountered and how cni can",
    "start": "46739",
    "end": "49800"
  },
  {
    "text": "be used to solve those problems and what",
    "start": "49800",
    "end": "52020"
  },
  {
    "text": "additional problems that that raises and",
    "start": "52020",
    "end": "55379"
  },
  {
    "text": "I'm going to be talking a lot about",
    "start": "55379",
    "end": "56340"
  },
  {
    "text": "Linker D throughout this talk because",
    "start": "56340",
    "end": "58079"
  },
  {
    "text": "that's the project that I work on but",
    "start": "58079",
    "end": "59820"
  },
  {
    "text": "all of the ideas here are kind of",
    "start": "59820",
    "end": "61559"
  },
  {
    "text": "broadly applicable to service meshes in",
    "start": "61559",
    "end": "63480"
  },
  {
    "text": "general and so I'll try to call that out",
    "start": "63480",
    "end": "65720"
  },
  {
    "text": "throughout but this is kind of",
    "start": "65720",
    "end": "67860"
  },
  {
    "text": "applicable to all service meshes and I",
    "start": "67860",
    "end": "69960"
  },
  {
    "text": "know in particular I think istio has had",
    "start": "69960",
    "end": "71700"
  },
  {
    "text": "run into a lot of the same problems that",
    "start": "71700",
    "end": "73140"
  },
  {
    "text": "I'm talking about here and I think has",
    "start": "73140",
    "end": "74520"
  },
  {
    "text": "even implemented some very similar",
    "start": "74520",
    "end": "75840"
  },
  {
    "text": "Solutions",
    "start": "75840",
    "end": "78200"
  },
  {
    "start": "78000",
    "end": "111000"
  },
  {
    "text": "uh so this is basically what we're going",
    "start": "79619",
    "end": "81240"
  },
  {
    "text": "to cover we're going to talk about what",
    "start": "81240",
    "end": "82680"
  },
  {
    "text": "what is Linker D and what is a cni",
    "start": "82680",
    "end": "84119"
  },
  {
    "text": "plug-in to give you some background so",
    "start": "84119",
    "end": "85439"
  },
  {
    "text": "that this stuff makes sense and I'm",
    "start": "85439",
    "end": "87780"
  },
  {
    "text": "going to talk about uh two problems kind",
    "start": "87780",
    "end": "90720"
  },
  {
    "text": "of in particular that we ran into what",
    "start": "90720",
    "end": "93360"
  },
  {
    "text": "happens when there's multiple cni",
    "start": "93360",
    "end": "94799"
  },
  {
    "text": "plugins installed and there's conflicts",
    "start": "94799",
    "end": "97020"
  },
  {
    "text": "between them and how do you how do you",
    "start": "97020",
    "end": "98400"
  },
  {
    "text": "deal with that and uh what happens when",
    "start": "98400",
    "end": "101700"
  },
  {
    "text": "a new node joins the cluster or restarts",
    "start": "101700",
    "end": "104119"
  },
  {
    "text": "there's some race conditions that can",
    "start": "104119",
    "end": "106200"
  },
  {
    "text": "occur when that happens with cni plugins",
    "start": "106200",
    "end": "108060"
  },
  {
    "text": "and I'm going to talk about that as well",
    "start": "108060",
    "end": "111560"
  },
  {
    "start": "111000",
    "end": "185000"
  },
  {
    "text": "okay so first and background what is",
    "start": "112740",
    "end": "114780"
  },
  {
    "text": "Linker d",
    "start": "114780",
    "end": "115740"
  },
  {
    "text": "uh I'm not telling",
    "start": "115740",
    "end": "118500"
  },
  {
    "text": "this uh hopefully you know if you're",
    "start": "118500",
    "end": "120899"
  },
  {
    "text": "here at 255 at service mesh con you've",
    "start": "120899",
    "end": "123479"
  },
  {
    "text": "at least heard of linker D you at least",
    "start": "123479",
    "end": "124920"
  },
  {
    "text": "know the concept behind a service mesh",
    "start": "124920",
    "end": "127619"
  },
  {
    "text": "um and so for this talk I really want to",
    "start": "127619",
    "end": "129479"
  },
  {
    "text": "focus on how service measures use cni",
    "start": "129479",
    "end": "132120"
  },
  {
    "text": "rather than spend a lot of time on the",
    "start": "132120",
    "end": "134160"
  },
  {
    "text": "background if you are interested in",
    "start": "134160",
    "end": "136500"
  },
  {
    "text": "learning more about this there's a",
    "start": "136500",
    "end": "137700"
  },
  {
    "text": "really good talk on Wednesday uh called",
    "start": "137700",
    "end": "140580"
  },
  {
    "text": "whose packet is this life of a packet",
    "start": "140580",
    "end": "142200"
  },
  {
    "text": "through the service mesh from Kevin and",
    "start": "142200",
    "end": "143520"
  },
  {
    "text": "Doug that's going to go into a lot more",
    "start": "143520",
    "end": "145500"
  },
  {
    "text": "detail about the iptables rules and the",
    "start": "145500",
    "end": "148440"
  },
  {
    "text": "routing that Linker uses I'm going to",
    "start": "148440",
    "end": "151140"
  },
  {
    "text": "talk about that at a high level today",
    "start": "151140",
    "end": "152459"
  },
  {
    "text": "and talk about how those things get set",
    "start": "152459",
    "end": "154620"
  },
  {
    "text": "up but if you really want to get into",
    "start": "154620",
    "end": "156420"
  },
  {
    "text": "the nitty-gritty of what those rules are",
    "start": "156420",
    "end": "158280"
  },
  {
    "text": "and how they work this is going to be a",
    "start": "158280",
    "end": "159780"
  },
  {
    "text": "really really good talk",
    "start": "159780",
    "end": "161879"
  },
  {
    "text": "um for something a little more high",
    "start": "161879",
    "end": "162959"
  },
  {
    "text": "level I also have a talk on Thursday",
    "start": "162959",
    "end": "164879"
  },
  {
    "text": "which is overview and state of liberty",
    "start": "164879",
    "end": "166739"
  },
  {
    "text": "that'll give a higher level talk about",
    "start": "166739",
    "end": "169140"
  },
  {
    "text": "what Linker D is how it's used what is",
    "start": "169140",
    "end": "172440"
  },
  {
    "text": "new in the past year or so and kind of",
    "start": "172440",
    "end": "174180"
  },
  {
    "text": "what's coming up on the road map so I",
    "start": "174180",
    "end": "176040"
  },
  {
    "text": "highly recommend both those talks if you",
    "start": "176040",
    "end": "177599"
  },
  {
    "text": "want to learn more but for now we're",
    "start": "177599",
    "end": "179760"
  },
  {
    "text": "just going to focus on how service",
    "start": "179760",
    "end": "181500"
  },
  {
    "text": "meshes use cni specifically",
    "start": "181500",
    "end": "185480"
  },
  {
    "start": "185000",
    "end": "248000"
  },
  {
    "text": "uh so you do need a little bit of",
    "start": "186900",
    "end": "188879"
  },
  {
    "text": "background so I do have to tell you a",
    "start": "188879",
    "end": "190080"
  },
  {
    "text": "little bit uh which is that for the",
    "start": "190080",
    "end": "192360"
  },
  {
    "text": "purposes of this talk all we really care",
    "start": "192360",
    "end": "193860"
  },
  {
    "text": "about for service meshes is that they",
    "start": "193860",
    "end": "196560"
  },
  {
    "text": "are something that runs a sidecar proxy",
    "start": "196560",
    "end": "199019"
  },
  {
    "text": "here's the Lincoln proxy in each pod",
    "start": "199019",
    "end": "202560"
  },
  {
    "text": "and that proxy is responsible for",
    "start": "202560",
    "end": "204480"
  },
  {
    "text": "intercepting all inbound and outbound",
    "start": "204480",
    "end": "206459"
  },
  {
    "text": "traffic from that pod and doing stuff",
    "start": "206459",
    "end": "209159"
  },
  {
    "text": "with it uh and so the way it",
    "start": "209159",
    "end": "211200"
  },
  {
    "text": "accomplishes that is that uh",
    "start": "211200",
    "end": "213000"
  },
  {
    "text": "traditionally there is an init container",
    "start": "213000",
    "end": "214620"
  },
  {
    "text": "which also runs in the pod",
    "start": "214620",
    "end": "216900"
  },
  {
    "text": "and that init container runs before any",
    "start": "216900",
    "end": "218879"
  },
  {
    "text": "of the the main containers and its job",
    "start": "218879",
    "end": "220980"
  },
  {
    "text": "is just to set up ibtables rules which",
    "start": "220980",
    "end": "223500"
  },
  {
    "text": "configure that routing so anytime",
    "start": "223500",
    "end": "225420"
  },
  {
    "text": "someone tries to establish a connection",
    "start": "225420",
    "end": "226920"
  },
  {
    "text": "to anything in that pod those ibtable",
    "start": "226920",
    "end": "229620"
  },
  {
    "text": "rules will reroute that connection to",
    "start": "229620",
    "end": "231000"
  },
  {
    "text": "the proxy and the proxy can handle it",
    "start": "231000",
    "end": "232920"
  },
  {
    "text": "and similarly on the outbound side",
    "start": "232920",
    "end": "234780"
  },
  {
    "text": "whenever anything in the Pod tries to",
    "start": "234780",
    "end": "237120"
  },
  {
    "text": "connect outside of it those ibtable",
    "start": "237120",
    "end": "239519"
  },
  {
    "text": "rules will intercept that connection and",
    "start": "239519",
    "end": "241500"
  },
  {
    "text": "rewrite it so you're connecting to the",
    "start": "241500",
    "end": "242700"
  },
  {
    "text": "proxy instead so the proxy intercepts in",
    "start": "242700",
    "end": "245459"
  },
  {
    "text": "both directions",
    "start": "245459",
    "end": "247760"
  },
  {
    "start": "248000",
    "end": "300000"
  },
  {
    "text": "and in order to do this it needs some",
    "start": "249959",
    "end": "251640"
  },
  {
    "text": "elevated privileges I think it needs",
    "start": "251640",
    "end": "253140"
  },
  {
    "text": "specifically net admin and net raw in",
    "start": "253140",
    "end": "255239"
  },
  {
    "text": "order to create those iptable rules",
    "start": "255239",
    "end": "258419"
  },
  {
    "text": "and so the problem with this is that it",
    "start": "258419",
    "end": "260699"
  },
  {
    "text": "means that all of the pods in your",
    "start": "260699",
    "end": "262440"
  },
  {
    "text": "cluster that want to be part of the mesh",
    "start": "262440",
    "end": "264840"
  },
  {
    "text": "need to have these Privileges and so",
    "start": "264840",
    "end": "267300"
  },
  {
    "text": "most of the time that's fine that's no",
    "start": "267300",
    "end": "269520"
  },
  {
    "text": "issue but if you really want to lock",
    "start": "269520",
    "end": "270960"
  },
  {
    "text": "things down and you don't want every pod",
    "start": "270960",
    "end": "273660"
  },
  {
    "text": "in your cluster to necessarily have",
    "start": "273660",
    "end": "275040"
  },
  {
    "text": "these privileges that can be a problem",
    "start": "275040",
    "end": "277380"
  },
  {
    "text": "and so the question we ask ourselves is",
    "start": "277380",
    "end": "279360"
  },
  {
    "text": "to get around that is there any way to",
    "start": "279360",
    "end": "281639"
  },
  {
    "text": "set up these iptable rules ahead of time",
    "start": "281639",
    "end": "283500"
  },
  {
    "text": "so that we don't have to Grant these",
    "start": "283500",
    "end": "286500"
  },
  {
    "text": "privileges to everything in the cluster",
    "start": "286500",
    "end": "288120"
  },
  {
    "text": "is there some way we can get this set up",
    "start": "288120",
    "end": "290280"
  },
  {
    "text": "for every Pod without needing those",
    "start": "290280",
    "end": "291840"
  },
  {
    "text": "additional Privileges and cni container",
    "start": "291840",
    "end": "295680"
  },
  {
    "text": "networking interface seemed like a",
    "start": "295680",
    "end": "297060"
  },
  {
    "text": "promising way to maybe do that",
    "start": "297060",
    "end": "300440"
  },
  {
    "start": "300000",
    "end": "337000"
  },
  {
    "text": "so what is cni",
    "start": "301259",
    "end": "303300"
  },
  {
    "text": "uh so cni stands for container",
    "start": "303300",
    "end": "305639"
  },
  {
    "text": "networking interface and it's basically",
    "start": "305639",
    "end": "307560"
  },
  {
    "text": "the system where you can have these",
    "start": "307560",
    "end": "309540"
  },
  {
    "text": "things called cni plugins and cni",
    "start": "309540",
    "end": "311639"
  },
  {
    "text": "plugins are installed on the host and",
    "start": "311639",
    "end": "313979"
  },
  {
    "text": "they're called by the container runtime",
    "start": "313979",
    "end": "315660"
  },
  {
    "text": "whenever a new pod is created and their",
    "start": "315660",
    "end": "318300"
  },
  {
    "text": "job is to set up the network",
    "start": "318300",
    "end": "319580"
  },
  {
    "text": "appropriately for that pod and so what",
    "start": "319580",
    "end": "321540"
  },
  {
    "text": "that means can vary a lot depending on",
    "start": "321540",
    "end": "323160"
  },
  {
    "text": "the plugin different plugins can do",
    "start": "323160",
    "end": "324720"
  },
  {
    "text": "different things you know they may set",
    "start": "324720",
    "end": "326400"
  },
  {
    "text": "up the Pod Network they may create",
    "start": "326400",
    "end": "327720"
  },
  {
    "text": "network interfaces they may set up",
    "start": "327720",
    "end": "329639"
  },
  {
    "text": "firewalls or throttling or other types",
    "start": "329639",
    "end": "331560"
  },
  {
    "text": "of policy but basically their job is",
    "start": "331560",
    "end": "333539"
  },
  {
    "text": "just to set up the network for that pod",
    "start": "333539",
    "end": "337400"
  },
  {
    "start": "337000",
    "end": "395000"
  },
  {
    "text": "and so we thought well maybe this is a",
    "start": "338400",
    "end": "340139"
  },
  {
    "text": "good way to uh a good place for us to",
    "start": "340139",
    "end": "343440"
  },
  {
    "text": "set up the policy for for link Rd right",
    "start": "343440",
    "end": "345840"
  },
  {
    "text": "because Linker D needs those iptable",
    "start": "345840",
    "end": "347580"
  },
  {
    "text": "rules that intercept the traffic on the",
    "start": "347580",
    "end": "349800"
  },
  {
    "text": "going in and out and so if we had a cni",
    "start": "349800",
    "end": "352020"
  },
  {
    "text": "plug-in uh that would get called",
    "start": "352020",
    "end": "354539"
  },
  {
    "text": "whenever a new pod is created and it can",
    "start": "354539",
    "end": "356340"
  },
  {
    "text": "set those things up and that way the Pod",
    "start": "356340",
    "end": "357720"
  },
  {
    "text": "itself wouldn't need those privileges",
    "start": "357720",
    "end": "359340"
  },
  {
    "text": "because it would all be set up by by cni",
    "start": "359340",
    "end": "362759"
  },
  {
    "text": "uh and so to get a little bit more",
    "start": "362759",
    "end": "364800"
  },
  {
    "text": "specific about what a cni plugin is it's",
    "start": "364800",
    "end": "366539"
  },
  {
    "text": "mostly made up of just two files so",
    "start": "366539",
    "end": "368699"
  },
  {
    "text": "there's a configuration file and there's",
    "start": "368699",
    "end": "371039"
  },
  {
    "text": "an executable binary and those live on",
    "start": "371039",
    "end": "373800"
  },
  {
    "text": "the Node file system",
    "start": "373800",
    "end": "375600"
  },
  {
    "text": "and so anything that's kind of in the",
    "start": "375600",
    "end": "377699"
  },
  {
    "text": "right place and in the right format on",
    "start": "377699",
    "end": "379860"
  },
  {
    "text": "the Node file system will get recognized",
    "start": "379860",
    "end": "381900"
  },
  {
    "text": "as a cni plugin and whenever a new pod",
    "start": "381900",
    "end": "384360"
  },
  {
    "text": "is created on that node the container",
    "start": "384360",
    "end": "387300"
  },
  {
    "text": "runtime is going to call that plug-in",
    "start": "387300",
    "end": "388620"
  },
  {
    "text": "and say hey you're a plug-in you're",
    "start": "388620",
    "end": "390660"
  },
  {
    "text": "supposed to set up the network do your",
    "start": "390660",
    "end": "392039"
  },
  {
    "text": "thing",
    "start": "392039",
    "end": "394220"
  },
  {
    "start": "395000",
    "end": "415000"
  },
  {
    "text": "and you can have multiple plugins",
    "start": "396060",
    "end": "397560"
  },
  {
    "text": "installed at once so rather than having",
    "start": "397560",
    "end": "399360"
  },
  {
    "text": "just a regular config file you can have",
    "start": "399360",
    "end": "401639"
  },
  {
    "text": "a conf list file which lists a bunch of",
    "start": "401639",
    "end": "404340"
  },
  {
    "text": "plugins which are installed and those",
    "start": "404340",
    "end": "406560"
  },
  {
    "text": "will run in what's called chained mode",
    "start": "406560",
    "end": "407880"
  },
  {
    "text": "which means that each of those plugins",
    "start": "407880",
    "end": "409560"
  },
  {
    "text": "will get run sequentially whenever a",
    "start": "409560",
    "end": "411660"
  },
  {
    "text": "plot is created",
    "start": "411660",
    "end": "414199"
  },
  {
    "start": "415000",
    "end": "452000"
  },
  {
    "text": "uh so right like I said we can have this",
    "start": "416699",
    "end": "418800"
  },
  {
    "text": "Linker dcni plugin which configures the",
    "start": "418800",
    "end": "420660"
  },
  {
    "text": "iptable's rules for a pod and if we do",
    "start": "420660",
    "end": "423120"
  },
  {
    "text": "that then we no longer need that init",
    "start": "423120",
    "end": "424800"
  },
  {
    "text": "container anymore because those rules",
    "start": "424800",
    "end": "426360"
  },
  {
    "text": "are set up by cni when the Pod is",
    "start": "426360",
    "end": "428160"
  },
  {
    "text": "created we don't need an init container",
    "start": "428160",
    "end": "429960"
  },
  {
    "text": "to do that and we also don't need those",
    "start": "429960",
    "end": "431520"
  },
  {
    "text": "elevated privileges",
    "start": "431520",
    "end": "433259"
  },
  {
    "text": "so it's great and it works great uh",
    "start": "433259",
    "end": "435720"
  },
  {
    "text": "liquidy has been doing this for a long",
    "start": "435720",
    "end": "437220"
  },
  {
    "text": "time and and it's fantastic",
    "start": "437220",
    "end": "440220"
  },
  {
    "text": "um",
    "start": "440220",
    "end": "441000"
  },
  {
    "text": "but it does raise a question of how do",
    "start": "441000",
    "end": "443160"
  },
  {
    "text": "you get that cni plugin set up in the",
    "start": "443160",
    "end": "444900"
  },
  {
    "text": "first place remember I said that that",
    "start": "444900",
    "end": "446340"
  },
  {
    "text": "was made up of files on the Node file",
    "start": "446340",
    "end": "448860"
  },
  {
    "text": "system so how do they get there who puts",
    "start": "448860",
    "end": "450300"
  },
  {
    "text": "them there",
    "start": "450300",
    "end": "452539"
  },
  {
    "start": "452000",
    "end": "508000"
  },
  {
    "text": "um so I think traditionally when you're",
    "start": "454979",
    "end": "457620"
  },
  {
    "text": "using cni plugins it's the",
    "start": "457620",
    "end": "459060"
  },
  {
    "text": "responsibility of the cluster",
    "start": "459060",
    "end": "461460"
  },
  {
    "text": "administrator to to set that up uh but",
    "start": "461460",
    "end": "465419"
  },
  {
    "text": "you know it's a little bit involved you",
    "start": "465419",
    "end": "466740"
  },
  {
    "text": "have to take these files you have to put",
    "start": "466740",
    "end": "468120"
  },
  {
    "text": "them on the host file system or the node",
    "start": "468120",
    "end": "470039"
  },
  {
    "text": "file system",
    "start": "470039",
    "end": "471060"
  },
  {
    "text": "uh in order to know how to do that you",
    "start": "471060",
    "end": "473160"
  },
  {
    "text": "need some amount of cni expertise you",
    "start": "473160",
    "end": "476099"
  },
  {
    "text": "could make a mistake doing that where do",
    "start": "476099",
    "end": "477660"
  },
  {
    "text": "you put the files what format do they",
    "start": "477660",
    "end": "478860"
  },
  {
    "text": "have to be in and you probably want to",
    "start": "478860",
    "end": "481199"
  },
  {
    "text": "integrate this with your Automation in",
    "start": "481199",
    "end": "482520"
  },
  {
    "text": "some way so that you're not manually",
    "start": "482520",
    "end": "483840"
  },
  {
    "text": "doing this for every for every node so",
    "start": "483840",
    "end": "486360"
  },
  {
    "text": "it's like it's a non-trivial task to get",
    "start": "486360",
    "end": "487979"
  },
  {
    "text": "this set up",
    "start": "487979",
    "end": "489120"
  },
  {
    "text": "uh and one of the philosophies behind",
    "start": "489120",
    "end": "492120"
  },
  {
    "text": "Linker D is we wanted to alleviate as",
    "start": "492120",
    "end": "494340"
  },
  {
    "text": "much as possible the kind of manual",
    "start": "494340",
    "end": "496500"
  },
  {
    "text": "administrative work that can be",
    "start": "496500",
    "end": "498240"
  },
  {
    "text": "automated and take that burden off of",
    "start": "498240",
    "end": "499979"
  },
  {
    "text": "cluster administrators wherever it makes",
    "start": "499979",
    "end": "501419"
  },
  {
    "text": "sense to",
    "start": "501419",
    "end": "502379"
  },
  {
    "text": "so we asked the question well what if a",
    "start": "502379",
    "end": "504300"
  },
  {
    "text": "cni plug-in could install itself",
    "start": "504300",
    "end": "508099"
  },
  {
    "start": "508000",
    "end": "567000"
  },
  {
    "text": "uh so remember I said that all a cni",
    "start": "508919",
    "end": "511259"
  },
  {
    "text": "plugin is it's basically just two files",
    "start": "511259",
    "end": "514140"
  },
  {
    "text": "so what we did is we created this",
    "start": "514140",
    "end": "516060"
  },
  {
    "text": "command and in the Lincoln CLI linkready",
    "start": "516060",
    "end": "518700"
  },
  {
    "text": "install or the CLI sorry link ready",
    "start": "518700",
    "end": "521700"
  },
  {
    "text": "install cni and you can pipe that to",
    "start": "521700",
    "end": "524099"
  },
  {
    "text": "Coupe cuddle apply and that will install",
    "start": "524099",
    "end": "525779"
  },
  {
    "text": "the cni plugin for you",
    "start": "525779",
    "end": "527700"
  },
  {
    "text": "and the way that works is it just",
    "start": "527700",
    "end": "529200"
  },
  {
    "text": "creates a Daemon set that runs a pod on",
    "start": "529200",
    "end": "531779"
  },
  {
    "text": "every node",
    "start": "531779",
    "end": "532740"
  },
  {
    "text": "and what that pod does is it mounts the",
    "start": "532740",
    "end": "534600"
  },
  {
    "text": "node file system and copies those files",
    "start": "534600",
    "end": "536700"
  },
  {
    "text": "into place very simple",
    "start": "536700",
    "end": "538800"
  },
  {
    "text": "but what it means is that once you run",
    "start": "538800",
    "end": "541380"
  },
  {
    "text": "that those files will be copied onto",
    "start": "541380",
    "end": "543120"
  },
  {
    "text": "every node and then from that point",
    "start": "543120",
    "end": "544980"
  },
  {
    "text": "forward any pods that are created will",
    "start": "544980",
    "end": "547980"
  },
  {
    "text": "be running on that node with that cni",
    "start": "547980",
    "end": "549420"
  },
  {
    "text": "plugin installed and so the container",
    "start": "549420",
    "end": "551580"
  },
  {
    "text": "runtime will call into those that plugin",
    "start": "551580",
    "end": "554760"
  },
  {
    "text": "and say hey there's a pod being created",
    "start": "554760",
    "end": "556500"
  },
  {
    "text": "I need you to set up the network for me",
    "start": "556500",
    "end": "557940"
  },
  {
    "text": "it's going to create those iptables",
    "start": "557940",
    "end": "559680"
  },
  {
    "text": "rules and now that pod is all set up and",
    "start": "559680",
    "end": "562019"
  },
  {
    "text": "all that traffic will go through the",
    "start": "562019",
    "end": "563220"
  },
  {
    "text": "proxy as intended",
    "start": "563220",
    "end": "566720"
  },
  {
    "start": "567000",
    "end": "585000"
  },
  {
    "text": "so this works wonderfully most of the",
    "start": "568440",
    "end": "570959"
  },
  {
    "text": "time but we did run into some problems",
    "start": "570959",
    "end": "572880"
  },
  {
    "text": "especially for people who were running",
    "start": "572880",
    "end": "574500"
  },
  {
    "text": "multiple cni plugins you know we would",
    "start": "574500",
    "end": "576480"
  },
  {
    "text": "get these error reports we're saying hey",
    "start": "576480",
    "end": "577800"
  },
  {
    "text": "I'm running with Calico or I'm running",
    "start": "577800",
    "end": "579720"
  },
  {
    "text": "with you know psyllium or I'm running",
    "start": "579720",
    "end": "581399"
  },
  {
    "text": "with whatever and things aren't working",
    "start": "581399",
    "end": "585260"
  },
  {
    "start": "585000",
    "end": "630000"
  },
  {
    "text": "so like I said",
    "start": "586500",
    "end": "588660"
  },
  {
    "text": "cni is designed so you can have multiple",
    "start": "588660",
    "end": "590339"
  },
  {
    "text": "cni plugins installed at the same time",
    "start": "590339",
    "end": "592620"
  },
  {
    "text": "uh",
    "start": "592620",
    "end": "594420"
  },
  {
    "text": "and that's fine because they'll run in",
    "start": "594420",
    "end": "595740"
  },
  {
    "text": "chain mode and and they'll get",
    "start": "595740",
    "end": "597779"
  },
  {
    "text": "consequently and everything's great but",
    "start": "597779",
    "end": "599760"
  },
  {
    "text": "if you have two different cni installers",
    "start": "599760",
    "end": "603480"
  },
  {
    "text": "that are unaware of each other well what",
    "start": "603480",
    "end": "605339"
  },
  {
    "text": "are they going to do they're both going",
    "start": "605339",
    "end": "606959"
  },
  {
    "text": "to run on the Node they're both going to",
    "start": "606959",
    "end": "608459"
  },
  {
    "text": "mount the file system and you know",
    "start": "608459",
    "end": "610500"
  },
  {
    "text": "Linker dcni is going to copy these files",
    "start": "610500",
    "end": "612240"
  },
  {
    "text": "into place if you have something else",
    "start": "612240",
    "end": "613860"
  },
  {
    "text": "like for example the Calico operator or",
    "start": "613860",
    "end": "615720"
  },
  {
    "text": "something else that's doing a similar",
    "start": "615720",
    "end": "617339"
  },
  {
    "text": "thing it's also going to copy those",
    "start": "617339",
    "end": "619080"
  },
  {
    "text": "files in and those files can conflict or",
    "start": "619080",
    "end": "621540"
  },
  {
    "text": "Shadow each other they won't necessarily",
    "start": "621540",
    "end": "624180"
  },
  {
    "text": "be changed because those two installers",
    "start": "624180",
    "end": "627420"
  },
  {
    "text": "are not aware of each other",
    "start": "627420",
    "end": "630320"
  },
  {
    "start": "630000",
    "end": "681000"
  },
  {
    "text": "so since those installers are not kind",
    "start": "632220",
    "end": "634500"
  },
  {
    "text": "of aware of what the other one is doing",
    "start": "634500",
    "end": "635880"
  },
  {
    "text": "you can get in the situation where where",
    "start": "635880",
    "end": "637860"
  },
  {
    "text": "they're overriding each other remember",
    "start": "637860",
    "end": "638880"
  },
  {
    "text": "that when you just have a single cni",
    "start": "638880",
    "end": "640680"
  },
  {
    "text": "plugin you have what's called a dot-comp",
    "start": "640680",
    "end": "642959"
  },
  {
    "text": "file but if you have multiple cni",
    "start": "642959",
    "end": "644880"
  },
  {
    "text": "plugins you need to have a conf list",
    "start": "644880",
    "end": "647160"
  },
  {
    "text": "file and So since neither those plugins",
    "start": "647160",
    "end": "649380"
  },
  {
    "text": "are aware of each other they don't know",
    "start": "649380",
    "end": "651000"
  },
  {
    "text": "to create that conflict file they both",
    "start": "651000",
    "end": "652680"
  },
  {
    "text": "think they're the only one there and",
    "start": "652680",
    "end": "653880"
  },
  {
    "text": "they step on each other's toes and so",
    "start": "653880",
    "end": "656459"
  },
  {
    "text": "the result is that you end up in these",
    "start": "656459",
    "end": "658260"
  },
  {
    "text": "very broken Network states where you",
    "start": "658260",
    "end": "660060"
  },
  {
    "text": "think you have multiple plugins",
    "start": "660060",
    "end": "661200"
  },
  {
    "text": "installed but only one of them is",
    "start": "661200",
    "end": "662940"
  },
  {
    "text": "running and you don't know why and you",
    "start": "662940",
    "end": "665760"
  },
  {
    "text": "know anything that's expecting to be",
    "start": "665760",
    "end": "666899"
  },
  {
    "text": "there is going to get confused",
    "start": "666899",
    "end": "669240"
  },
  {
    "text": "and so what we really want is we really",
    "start": "669240",
    "end": "670980"
  },
  {
    "text": "want to be in a chained configuration we",
    "start": "670980",
    "end": "674579"
  },
  {
    "text": "want accomplished",
    "start": "674579",
    "end": "676620"
  },
  {
    "text": "but neither of these things know that",
    "start": "676620",
    "end": "681079"
  },
  {
    "start": "681000",
    "end": "756000"
  },
  {
    "text": "uh so the solution we implemented in",
    "start": "682920",
    "end": "684899"
  },
  {
    "text": "linkerty was basically to become a cni",
    "start": "684899",
    "end": "688079"
  },
  {
    "text": "plugin manager so what we'll do is that",
    "start": "688079",
    "end": "690360"
  },
  {
    "text": "whenever you have that Linker DC and I",
    "start": "690360",
    "end": "693120"
  },
  {
    "text": "damage that that's installing the cni",
    "start": "693120",
    "end": "695459"
  },
  {
    "text": "plugins what it's going to do is it's",
    "start": "695459",
    "end": "697320"
  },
  {
    "text": "going to first look at that directory",
    "start": "697320",
    "end": "698519"
  },
  {
    "text": "and say hey is there any cni plugin",
    "start": "698519",
    "end": "700740"
  },
  {
    "text": "already installed here if so we need to",
    "start": "700740",
    "end": "703380"
  },
  {
    "text": "rewrite its configuration turn it into a",
    "start": "703380",
    "end": "705600"
  },
  {
    "text": "Comp List and chain those two plugins",
    "start": "705600",
    "end": "707880"
  },
  {
    "text": "together",
    "start": "707880",
    "end": "709079"
  },
  {
    "text": "and then furthermore it needs to watch",
    "start": "709079",
    "end": "711420"
  },
  {
    "text": "that directory and say well if any cni",
    "start": "711420",
    "end": "713760"
  },
  {
    "text": "plugins are installed after I have been",
    "start": "713760",
    "end": "716279"
  },
  {
    "text": "installed I need to notice that I need",
    "start": "716279",
    "end": "718680"
  },
  {
    "text": "to take those configurations and also",
    "start": "718680",
    "end": "720959"
  },
  {
    "text": "rewrite them into the conflist",
    "start": "720959",
    "end": "722760"
  },
  {
    "text": "and combine all the cni plugins into a",
    "start": "722760",
    "end": "725040"
  },
  {
    "text": "single chained list",
    "start": "725040",
    "end": "727079"
  },
  {
    "text": "and so it it you know this works but",
    "start": "727079",
    "end": "730380"
  },
  {
    "text": "like it uses I notify weight there's a",
    "start": "730380",
    "end": "732660"
  },
  {
    "text": "whole bunch of gross bash and in fact",
    "start": "732660",
    "end": "734519"
  },
  {
    "text": "the majority maybe even the vast",
    "start": "734519",
    "end": "736079"
  },
  {
    "text": "majority of the code in the cni linked",
    "start": "736079",
    "end": "739260"
  },
  {
    "text": "cni plugin installer is dealing with",
    "start": "739260",
    "end": "742079"
  },
  {
    "text": "parsing config files and watching",
    "start": "742079",
    "end": "744360"
  },
  {
    "text": "directories and rewriting them and uh",
    "start": "744360",
    "end": "747899"
  },
  {
    "text": "doing all of that kind of plug-in",
    "start": "747899",
    "end": "749940"
  },
  {
    "text": "management rather than doing its own job",
    "start": "749940",
    "end": "752100"
  },
  {
    "text": "which is unfortunate",
    "start": "752100",
    "end": "755600"
  },
  {
    "start": "756000",
    "end": "844000"
  },
  {
    "text": "so this works but but how could it be",
    "start": "757500",
    "end": "760500"
  },
  {
    "text": "better",
    "start": "760500",
    "end": "762420"
  },
  {
    "text": "um and these are just kind of some",
    "start": "762420",
    "end": "764160"
  },
  {
    "text": "half-baked ideas about about how we",
    "start": "764160",
    "end": "766740"
  },
  {
    "text": "could make this better you know there's",
    "start": "766740",
    "end": "767760"
  },
  {
    "text": "a lot of stuff here still to figure out",
    "start": "767760",
    "end": "769320"
  },
  {
    "text": "but it would be cool if we had some kind",
    "start": "769320",
    "end": "771899"
  },
  {
    "text": "of convention for how cni plugins should",
    "start": "771899",
    "end": "774660"
  },
  {
    "text": "interact with each other when they're",
    "start": "774660",
    "end": "775920"
  },
  {
    "text": "being installed if you're a cni plug-in",
    "start": "775920",
    "end": "777839"
  },
  {
    "text": "and you're installing yourself and you",
    "start": "777839",
    "end": "779399"
  },
  {
    "text": "notice that there's already some plugins",
    "start": "779399",
    "end": "780959"
  },
  {
    "text": "there what should you do what should the",
    "start": "780959",
    "end": "782940"
  },
  {
    "text": "conventions be around uh chaining to",
    "start": "782940",
    "end": "786060"
  },
  {
    "text": "those or or somehow integrating with",
    "start": "786060",
    "end": "789300"
  },
  {
    "text": "them rather than just kind of blindly",
    "start": "789300",
    "end": "791100"
  },
  {
    "text": "overriding",
    "start": "791100",
    "end": "792680"
  },
  {
    "text": "uh but there's a lot of questions there",
    "start": "792680",
    "end": "794820"
  },
  {
    "text": "like how do you decide what order to",
    "start": "794820",
    "end": "797040"
  },
  {
    "text": "chain those in because of course these",
    "start": "797040",
    "end": "798420"
  },
  {
    "text": "cni plugins they do things to the",
    "start": "798420",
    "end": "800399"
  },
  {
    "text": "network the orders that they run in is",
    "start": "800399",
    "end": "802079"
  },
  {
    "text": "very important uh so how do you",
    "start": "802079",
    "end": "804120"
  },
  {
    "text": "determine that order uh how do you deal",
    "start": "804120",
    "end": "806220"
  },
  {
    "text": "with atomicity if you have two uh",
    "start": "806220",
    "end": "808380"
  },
  {
    "text": "plugins installing themselves at the",
    "start": "808380",
    "end": "809820"
  },
  {
    "text": "same time",
    "start": "809820",
    "end": "811019"
  },
  {
    "text": "how do you guarantee that that's going",
    "start": "811019",
    "end": "812639"
  },
  {
    "text": "to work out",
    "start": "812639",
    "end": "814100"
  },
  {
    "text": "another potential idea would be to have",
    "start": "814100",
    "end": "816779"
  },
  {
    "text": "this uh be handled sometime somehow by",
    "start": "816779",
    "end": "819300"
  },
  {
    "text": "the runtime uh to basically move this",
    "start": "819300",
    "end": "821940"
  },
  {
    "text": "down to the infrastructure rather than",
    "start": "821940",
    "end": "823139"
  },
  {
    "text": "having the Linker DC and I be a plugin",
    "start": "823139",
    "end": "824880"
  },
  {
    "text": "manager you know what if there was",
    "start": "824880",
    "end": "826380"
  },
  {
    "text": "something analogous to a plugin manager",
    "start": "826380",
    "end": "829320"
  },
  {
    "text": "that would take all those configuration",
    "start": "829320",
    "end": "830880"
  },
  {
    "text": "files and know how to combine them in an",
    "start": "830880",
    "end": "833220"
  },
  {
    "text": "intelligent way",
    "start": "833220",
    "end": "834480"
  },
  {
    "text": "uh but again you still have some of",
    "start": "834480",
    "end": "836220"
  },
  {
    "text": "these questions like the order that",
    "start": "836220",
    "end": "837600"
  },
  {
    "text": "they're combined is very important so",
    "start": "837600",
    "end": "838860"
  },
  {
    "text": "you need some way to specify that",
    "start": "838860",
    "end": "842120"
  },
  {
    "start": "844000",
    "end": "875000"
  },
  {
    "text": "okay and the other issue that I really",
    "start": "845220",
    "end": "847740"
  },
  {
    "text": "want to talk about was a cni plug-in",
    "start": "847740",
    "end": "850139"
  },
  {
    "text": "race conditions so this is something",
    "start": "850139",
    "end": "852420"
  },
  {
    "text": "that happens when a node joins the",
    "start": "852420",
    "end": "855540"
  },
  {
    "text": "cluster and this can happen for a",
    "start": "855540",
    "end": "856680"
  },
  {
    "text": "variety of reasons you can have just a",
    "start": "856680",
    "end": "858540"
  },
  {
    "text": "new node spin up because you're adding",
    "start": "858540",
    "end": "860220"
  },
  {
    "text": "expanding capacity or something like",
    "start": "860220",
    "end": "861779"
  },
  {
    "text": "that it also happens when a node",
    "start": "861779",
    "end": "863459"
  },
  {
    "text": "restarts so when a node restarts it's",
    "start": "863459",
    "end": "865139"
  },
  {
    "text": "going to leave the cluster and then once",
    "start": "865139",
    "end": "867180"
  },
  {
    "text": "it restarts it'll it'll join again",
    "start": "867180",
    "end": "869220"
  },
  {
    "text": "and so this is something that we saw",
    "start": "869220",
    "end": "871440"
  },
  {
    "text": "happening a lot during node restarts we",
    "start": "871440",
    "end": "873180"
  },
  {
    "text": "would run into these problems",
    "start": "873180",
    "end": "875820"
  },
  {
    "start": "875000",
    "end": "879000"
  },
  {
    "text": "uh so what happens when when this occurs",
    "start": "875820",
    "end": "880440"
  },
  {
    "start": "879000",
    "end": "891000"
  },
  {
    "text": "well first of all the node comes up",
    "start": "880440",
    "end": "882899"
  },
  {
    "text": "uh once it's healthy it announces to",
    "start": "882899",
    "end": "885600"
  },
  {
    "text": "kubernetes hey I'm available you can",
    "start": "885600",
    "end": "888000"
  },
  {
    "text": "schedule pods now here",
    "start": "888000",
    "end": "891019"
  },
  {
    "start": "891000",
    "end": "914000"
  },
  {
    "text": "and kubernetes says okay well I've got",
    "start": "892079",
    "end": "893880"
  },
  {
    "text": "some pods in particular I've got the",
    "start": "893880",
    "end": "895800"
  },
  {
    "text": "Linker dcni pod because this is a demon",
    "start": "895800",
    "end": "897959"
  },
  {
    "text": "set and we need to run one of these on",
    "start": "897959",
    "end": "899160"
  },
  {
    "text": "every node so here you go and",
    "start": "899160",
    "end": "901620"
  },
  {
    "text": "potentially I have some other pods that",
    "start": "901620",
    "end": "903000"
  },
  {
    "text": "need to be scheduled so I'm going to",
    "start": "903000",
    "end": "904199"
  },
  {
    "text": "schedule those as well",
    "start": "904199",
    "end": "906480"
  },
  {
    "text": "and there's no ordering constraint on",
    "start": "906480",
    "end": "908579"
  },
  {
    "text": "how these two pods come up they're just",
    "start": "908579",
    "end": "910740"
  },
  {
    "text": "both supposed to be scheduled there so",
    "start": "910740",
    "end": "912180"
  },
  {
    "text": "they are",
    "start": "912180",
    "end": "914540"
  },
  {
    "start": "914000",
    "end": "997000"
  },
  {
    "text": "and remember the job of this cni plug-in",
    "start": "915000",
    "end": "917639"
  },
  {
    "text": "pod here is to copy these files onto the",
    "start": "917639",
    "end": "919800"
  },
  {
    "text": "host system that uh represent the the",
    "start": "919800",
    "end": "923160"
  },
  {
    "text": "cni plugin and are responsible for",
    "start": "923160",
    "end": "925320"
  },
  {
    "text": "creating the networking rules the",
    "start": "925320",
    "end": "927600"
  },
  {
    "text": "iptables rules",
    "start": "927600",
    "end": "929760"
  },
  {
    "text": "so if this pod happens to come up before",
    "start": "929760",
    "end": "932220"
  },
  {
    "text": "these files are in place when this pod",
    "start": "932220",
    "end": "934500"
  },
  {
    "text": "comes up the container runtime is going",
    "start": "934500",
    "end": "937560"
  },
  {
    "text": "to say hey there's a new pod being",
    "start": "937560",
    "end": "938940"
  },
  {
    "text": "created let me check to see if there's",
    "start": "938940",
    "end": "940560"
  },
  {
    "text": "any cni plugins I need to run to set up",
    "start": "940560",
    "end": "942300"
  },
  {
    "text": "the network for this pod no these files",
    "start": "942300",
    "end": "944399"
  },
  {
    "text": "aren't here yet okay there's no plugin",
    "start": "944399",
    "end": "945839"
  },
  {
    "text": "so okay pods created we're good to go",
    "start": "945839",
    "end": "948720"
  },
  {
    "text": "and so this pod is going to come up in a",
    "start": "948720",
    "end": "950519"
  },
  {
    "text": "broken State because it will have a",
    "start": "950519",
    "end": "951959"
  },
  {
    "text": "proxy but it won't have any rules saying",
    "start": "951959",
    "end": "954720"
  },
  {
    "text": "to direct the traffic through that proxy",
    "start": "954720",
    "end": "956579"
  },
  {
    "text": "and so things are going to be very",
    "start": "956579",
    "end": "958260"
  },
  {
    "text": "broken",
    "start": "958260",
    "end": "959180"
  },
  {
    "text": "especially because other pods in the",
    "start": "959180",
    "end": "962279"
  },
  {
    "text": "network in the mesh will expect this pod",
    "start": "962279",
    "end": "964860"
  },
  {
    "text": "to have a proxy because it does have one",
    "start": "964860",
    "end": "966300"
  },
  {
    "text": "and so that means that for example it",
    "start": "966300",
    "end": "968639"
  },
  {
    "text": "can send traffic there that is encrypted",
    "start": "968639",
    "end": "970740"
  },
  {
    "text": "with mtls it could send traffic there",
    "start": "970740",
    "end": "972899"
  },
  {
    "text": "that's had a protocol upgrade that only",
    "start": "972899",
    "end": "974579"
  },
  {
    "text": "Linker D is aware of but because those",
    "start": "974579",
    "end": "977399"
  },
  {
    "text": "iptable rules aren't set up on that pod",
    "start": "977399",
    "end": "980100"
  },
  {
    "text": "all that traffic is going to go directly",
    "start": "980100",
    "end": "981420"
  },
  {
    "text": "to the application and the application",
    "start": "981420",
    "end": "983399"
  },
  {
    "text": "is not going to know what to do with it",
    "start": "983399",
    "end": "985980"
  },
  {
    "text": "and things will be very broken",
    "start": "985980",
    "end": "989240"
  },
  {
    "text": "uh yeah it's bad",
    "start": "993180",
    "end": "996860"
  },
  {
    "start": "997000",
    "end": "1069000"
  },
  {
    "text": "uh so the solution where we come up with",
    "start": "998880",
    "end": "1000920"
  },
  {
    "text": "in Linker D and this is something that's",
    "start": "1000920",
    "end": "1002420"
  },
  {
    "text": "still uh in progress I feel work is",
    "start": "1002420",
    "end": "1004160"
  },
  {
    "text": "mostly done it's just a matter of",
    "start": "1004160",
    "end": "1005300"
  },
  {
    "text": "rolling it out uh is that we want to",
    "start": "1005300",
    "end": "1007820"
  },
  {
    "text": "validate uh the routing on pod startup",
    "start": "1007820",
    "end": "1010279"
  },
  {
    "text": "so in other words when a pod starts up",
    "start": "1010279",
    "end": "1012199"
  },
  {
    "text": "we want to validate does the routing",
    "start": "1012199",
    "end": "1014060"
  },
  {
    "text": "rule do the routing rules here make",
    "start": "1014060",
    "end": "1015380"
  },
  {
    "text": "sense are they what they're supposed to",
    "start": "1015380",
    "end": "1017060"
  },
  {
    "text": "be have things been set up correctly and",
    "start": "1017060",
    "end": "1019699"
  },
  {
    "text": "if they're not we need to fail the Pod",
    "start": "1019699",
    "end": "1022279"
  },
  {
    "text": "and start over again and try again",
    "start": "1022279",
    "end": "1024380"
  },
  {
    "text": "and this is very reminiscent of",
    "start": "1024380",
    "end": "1026839"
  },
  {
    "text": "something that cni itself actually does",
    "start": "1026839",
    "end": "1028339"
  },
  {
    "text": "so cni has this command called check I",
    "start": "1028339",
    "end": "1031579"
  },
  {
    "text": "believe where uh the container runtime",
    "start": "1031579",
    "end": "1034160"
  },
  {
    "text": "can call into each cni plugin with a",
    "start": "1034160",
    "end": "1036558"
  },
  {
    "text": "check and say hey",
    "start": "1036559",
    "end": "1038120"
  },
  {
    "text": "I know you're already done setting up",
    "start": "1038120",
    "end": "1039438"
  },
  {
    "text": "but are things still the way you think",
    "start": "1039439",
    "end": "1041540"
  },
  {
    "text": "they should be is you know are you still",
    "start": "1041540",
    "end": "1043459"
  },
  {
    "text": "set up correctly and the cni plugin can",
    "start": "1043459",
    "end": "1046220"
  },
  {
    "text": "respond yes things are good everything",
    "start": "1046220",
    "end": "1047780"
  },
  {
    "text": "looks fine or no something's gone wrong",
    "start": "1047780",
    "end": "1049760"
  },
  {
    "text": "we need to we need to fix things",
    "start": "1049760",
    "end": "1052340"
  },
  {
    "text": "and so this is a very similar idea uh by",
    "start": "1052340",
    "end": "1055520"
  },
  {
    "text": "having pods check their own routing and",
    "start": "1055520",
    "end": "1057919"
  },
  {
    "text": "saying is the routing on this pod set up",
    "start": "1057919",
    "end": "1060140"
  },
  {
    "text": "correctly uh yes it is we're good to go",
    "start": "1060140",
    "end": "1063380"
  },
  {
    "text": "or no it's not we need to we need to",
    "start": "1063380",
    "end": "1066200"
  },
  {
    "text": "restart this pod and try again",
    "start": "1066200",
    "end": "1069220"
  },
  {
    "start": "1069000",
    "end": "1201000"
  },
  {
    "text": "oh that is very hard to read okay uh so",
    "start": "1071360",
    "end": "1074480"
  },
  {
    "text": "the way this works is that we have uh a",
    "start": "1074480",
    "end": "1076940"
  },
  {
    "text": "validator pod which is an in it or a",
    "start": "1076940",
    "end": "1079340"
  },
  {
    "text": "validator container I'm sorry uh which",
    "start": "1079340",
    "end": "1080720"
  },
  {
    "text": "is in a knit container this says",
    "start": "1080720",
    "end": "1082520"
  },
  {
    "text": "validator it's very hard to read uh and",
    "start": "1082520",
    "end": "1085580"
  },
  {
    "text": "that runs in the Pod first so that's",
    "start": "1085580",
    "end": "1086900"
  },
  {
    "text": "going to run before any of the main",
    "start": "1086900",
    "end": "1088160"
  },
  {
    "text": "containers it's going to run before the",
    "start": "1088160",
    "end": "1089480"
  },
  {
    "text": "proxy it's going to run before the",
    "start": "1089480",
    "end": "1090799"
  },
  {
    "text": "application",
    "start": "1090799",
    "end": "1092000"
  },
  {
    "text": "uh and it what it does is it sets up a",
    "start": "1092000",
    "end": "1095059"
  },
  {
    "text": "server that listens on Port 4140 4140 is",
    "start": "1095059",
    "end": "1098600"
  },
  {
    "text": "the outgoing Port of the proxy so what",
    "start": "1098600",
    "end": "1101059"
  },
  {
    "text": "that means is that when things are",
    "start": "1101059",
    "end": "1102500"
  },
  {
    "text": "running correctly uh all of the traffic",
    "start": "1102500",
    "end": "1105440"
  },
  {
    "text": "which goes out of the Pod is redirected",
    "start": "1105440",
    "end": "1107660"
  },
  {
    "text": "to Port 4140 on the proxy",
    "start": "1107660",
    "end": "1110059"
  },
  {
    "text": "but of course this runs before the proxy",
    "start": "1110059",
    "end": "1111980"
  },
  {
    "text": "exists this is an init container so uh",
    "start": "1111980",
    "end": "1115520"
  },
  {
    "text": "that Port is available and it can kind",
    "start": "1115520",
    "end": "1117080"
  },
  {
    "text": "of listen there and it's going to listen",
    "start": "1117080",
    "end": "1118580"
  },
  {
    "text": "there as as a test",
    "start": "1118580",
    "end": "1121100"
  },
  {
    "text": "uh and then the second thing it does is",
    "start": "1121100",
    "end": "1123320"
  },
  {
    "text": "it tries to connect to some IP address",
    "start": "1123320",
    "end": "1126020"
  },
  {
    "text": "outside of the pod doesn't matter what",
    "start": "1126020",
    "end": "1128660"
  },
  {
    "text": "it is",
    "start": "1128660",
    "end": "1130700"
  },
  {
    "text": "and when it does this if those iptable",
    "start": "1130700",
    "end": "1133580"
  },
  {
    "text": "rules have been set up correctly what",
    "start": "1133580",
    "end": "1135020"
  },
  {
    "text": "they're supposed to do is they're",
    "start": "1135020",
    "end": "1136520"
  },
  {
    "text": "supposed to redirect that connection",
    "start": "1136520",
    "end": "1137740"
  },
  {
    "text": "back to the proxy or in this case the",
    "start": "1137740",
    "end": "1140840"
  },
  {
    "text": "validator itself port 4140. so things",
    "start": "1140840",
    "end": "1143539"
  },
  {
    "text": "are set up correctly that should",
    "start": "1143539",
    "end": "1144860"
  },
  {
    "text": "redirect back to there and we can detect",
    "start": "1144860",
    "end": "1146840"
  },
  {
    "text": "that we can say hey we connected to our",
    "start": "1146840",
    "end": "1149240"
  },
  {
    "text": "own thing and that means the routing",
    "start": "1149240",
    "end": "1151160"
  },
  {
    "text": "rules are set up correctly we're good to",
    "start": "1151160",
    "end": "1152299"
  },
  {
    "text": "go the init container can terminate",
    "start": "1152299",
    "end": "1154280"
  },
  {
    "text": "successfully and then the Pod can spit",
    "start": "1154280",
    "end": "1155840"
  },
  {
    "text": "up spin up as normal",
    "start": "1155840",
    "end": "1158660"
  },
  {
    "text": "if this doesn't happen if that",
    "start": "1158660",
    "end": "1161000"
  },
  {
    "text": "connection kind of just goes through to",
    "start": "1161000",
    "end": "1162679"
  },
  {
    "text": "its original destination and nothing",
    "start": "1162679",
    "end": "1164480"
  },
  {
    "text": "connects to 4140. we know that",
    "start": "1164480",
    "end": "1166520"
  },
  {
    "text": "something's gone wrong we know that the",
    "start": "1166520",
    "end": "1168679"
  },
  {
    "text": "iptables rules have not been set up",
    "start": "1168679",
    "end": "1170299"
  },
  {
    "text": "correctly for this pod so we need to",
    "start": "1170299",
    "end": "1172160"
  },
  {
    "text": "fail and so when that IP or when that",
    "start": "1172160",
    "end": "1174440"
  },
  {
    "text": "validator container fails the whole pod",
    "start": "1174440",
    "end": "1177440"
  },
  {
    "text": "will fail startup kubernetes will kill",
    "start": "1177440",
    "end": "1179720"
  },
  {
    "text": "it and try and start again try and",
    "start": "1179720",
    "end": "1181880"
  },
  {
    "text": "create a new one and hopefully by the",
    "start": "1181880",
    "end": "1183679"
  },
  {
    "text": "time that pod comes up a second time the",
    "start": "1183679",
    "end": "1186620"
  },
  {
    "text": "cni plugin will have had time to install",
    "start": "1186620",
    "end": "1188299"
  },
  {
    "text": "correctly and everything will work so",
    "start": "1188299",
    "end": "1190760"
  },
  {
    "text": "you get into this kind of eventually",
    "start": "1190760",
    "end": "1192080"
  },
  {
    "text": "eventually consistent state where things",
    "start": "1192080",
    "end": "1194660"
  },
  {
    "text": "will hopefully after some number of",
    "start": "1194660",
    "end": "1196460"
  },
  {
    "text": "restarts uh work as expected",
    "start": "1196460",
    "end": "1200919"
  },
  {
    "text": "so this again this is something that",
    "start": "1203000",
    "end": "1205160"
  },
  {
    "text": "works",
    "start": "1205160",
    "end": "1206240"
  },
  {
    "text": "um it solves the problem it's a little",
    "start": "1206240",
    "end": "1208100"
  },
  {
    "text": "bit gross it's a little bit messy it has",
    "start": "1208100",
    "end": "1210320"
  },
  {
    "text": "this eventually consistent nature where",
    "start": "1210320",
    "end": "1212000"
  },
  {
    "text": "pods may have to restart several times",
    "start": "1212000",
    "end": "1213620"
  },
  {
    "text": "if they are scheduled on a node that is",
    "start": "1213620",
    "end": "1215960"
  },
  {
    "text": "in the process of coming up",
    "start": "1215960",
    "end": "1218179"
  },
  {
    "text": "uh",
    "start": "1218179",
    "end": "1219440"
  },
  {
    "text": "and ideally there would be kind of a",
    "start": "1219440",
    "end": "1221600"
  },
  {
    "text": "cleaner solution so what we would really",
    "start": "1221600",
    "end": "1223100"
  },
  {
    "text": "love to see is if there was some way to",
    "start": "1223100",
    "end": "1225620"
  },
  {
    "text": "add constraints on The Ordering of these",
    "start": "1225620",
    "end": "1227660"
  },
  {
    "text": "pods so that we could say yes we know",
    "start": "1227660",
    "end": "1230360"
  },
  {
    "text": "that the cni plugin has been installed",
    "start": "1230360",
    "end": "1232640"
  },
  {
    "text": "all the networking stuff is set up",
    "start": "1232640",
    "end": "1235160"
  },
  {
    "text": "before we try to schedule any other pods",
    "start": "1235160",
    "end": "1237620"
  },
  {
    "text": "on that on that node",
    "start": "1237620",
    "end": "1239360"
  },
  {
    "text": "uh and so that could be",
    "start": "1239360",
    "end": "1243260"
  },
  {
    "text": "um",
    "start": "1243260",
    "end": "1244039"
  },
  {
    "text": "there could be some kind of affordance",
    "start": "1244039",
    "end": "1245600"
  },
  {
    "text": "for that in kubernetes to say that hey",
    "start": "1245600",
    "end": "1247520"
  },
  {
    "text": "these are cni set up jobs or pods and we",
    "start": "1247520",
    "end": "1251299"
  },
  {
    "text": "need to uh let those run first or more",
    "start": "1251299",
    "end": "1255020"
  },
  {
    "text": "generally you know some other way of",
    "start": "1255020",
    "end": "1257179"
  },
  {
    "text": "specifying pod ordering constraints so",
    "start": "1257179",
    "end": "1259220"
  },
  {
    "text": "that we can guarantee that certain pods",
    "start": "1259220",
    "end": "1261740"
  },
  {
    "text": "are run and complete before other pods",
    "start": "1261740",
    "end": "1264440"
  },
  {
    "text": "are scheduled",
    "start": "1264440",
    "end": "1265820"
  },
  {
    "text": "but as far as I know there isn't",
    "start": "1265820",
    "end": "1267919"
  },
  {
    "text": "anything quite like this",
    "start": "1267919",
    "end": "1270759"
  },
  {
    "start": "1271000",
    "end": "1315000"
  },
  {
    "text": "okay so uh what we kind of talked about",
    "start": "1273200",
    "end": "1275600"
  },
  {
    "text": "uh through this presentation is I gave a",
    "start": "1275600",
    "end": "1277520"
  },
  {
    "text": "little background on how service meshes",
    "start": "1277520",
    "end": "1279500"
  },
  {
    "text": "use cni plugins in order to set up their",
    "start": "1279500",
    "end": "1281780"
  },
  {
    "text": "iptables rules so that they can",
    "start": "1281780",
    "end": "1284000"
  },
  {
    "text": "intercept traffic going in and out of",
    "start": "1284000",
    "end": "1285860"
  },
  {
    "text": "the pod",
    "start": "1285860",
    "end": "1286660"
  },
  {
    "text": "uh and talked about these kind of two",
    "start": "1286660",
    "end": "1289580"
  },
  {
    "text": "big issues that we encountered uh cni",
    "start": "1289580",
    "end": "1292640"
  },
  {
    "text": "plug-in conflicts when there's multiple",
    "start": "1292640",
    "end": "1293840"
  },
  {
    "text": "cni plugins installed and they override",
    "start": "1293840",
    "end": "1296179"
  },
  {
    "text": "each other's config",
    "start": "1296179",
    "end": "1298120"
  },
  {
    "text": "and the cni plug-in race conditions",
    "start": "1298120",
    "end": "1300559"
  },
  {
    "text": "where when a node first joins cluster or",
    "start": "1300559",
    "end": "1303080"
  },
  {
    "text": "when it restarts you get into the",
    "start": "1303080",
    "end": "1305000"
  },
  {
    "text": "situation where pods can get scheduled",
    "start": "1305000",
    "end": "1306620"
  },
  {
    "text": "before the cni is done setting up and",
    "start": "1306620",
    "end": "1309500"
  },
  {
    "text": "therefore those pods don't have the",
    "start": "1309500",
    "end": "1311539"
  },
  {
    "text": "right routing rules",
    "start": "1311539",
    "end": "1314440"
  },
  {
    "text": "um",
    "start": "1314480",
    "end": "1315620"
  },
  {
    "start": "1315000",
    "end": "1344000"
  },
  {
    "text": "if you're interested in kind of learning",
    "start": "1315620",
    "end": "1317480"
  },
  {
    "text": "more about the nitty-gritty of how",
    "start": "1317480",
    "end": "1320840"
  },
  {
    "text": "Lincoln it works how cni plugins work",
    "start": "1320840",
    "end": "1323480"
  },
  {
    "text": "and really dive deep there's a very good",
    "start": "1323480",
    "end": "1326140"
  },
  {
    "text": "service mesh academy uh that you can",
    "start": "1326140",
    "end": "1329000"
  },
  {
    "text": "sign up for it's completely free I think",
    "start": "1329000",
    "end": "1330799"
  },
  {
    "text": "the next one runs from November 11th to",
    "start": "1330799",
    "end": "1332480"
  },
  {
    "text": "17th it's very very Hands-On so uh it'll",
    "start": "1332480",
    "end": "1335659"
  },
  {
    "text": "help you kind of get into some of the",
    "start": "1335659",
    "end": "1337640"
  },
  {
    "text": "details there that I glossed over in",
    "start": "1337640",
    "end": "1339380"
  },
  {
    "text": "this talk so that's very interesting if",
    "start": "1339380",
    "end": "1342020"
  },
  {
    "text": "that is something that you're interested",
    "start": "1342020",
    "end": "1344059"
  },
  {
    "start": "1344000",
    "end": "1367000"
  },
  {
    "text": "in uh buoyant also offers fully managed",
    "start": "1344059",
    "end": "1346940"
  },
  {
    "text": "link reviews so if you're interested in",
    "start": "1346940",
    "end": "1348260"
  },
  {
    "text": "running Lincoln production and you want",
    "start": "1348260",
    "end": "1350000"
  },
  {
    "text": "some of that administrative burden",
    "start": "1350000",
    "end": "1352039"
  },
  {
    "text": "alleviated uh this should be of interest",
    "start": "1352039",
    "end": "1355159"
  },
  {
    "text": "to you boinkcloud can handle things like",
    "start": "1355159",
    "end": "1357440"
  },
  {
    "text": "automatic upgrades and uh and other",
    "start": "1357440",
    "end": "1360799"
  },
  {
    "text": "administrative tasks so if that's",
    "start": "1360799",
    "end": "1362840"
  },
  {
    "text": "interesting you can find the buoyant",
    "start": "1362840",
    "end": "1364220"
  },
  {
    "text": "Booth or you can book a demo online",
    "start": "1364220",
    "end": "1367600"
  },
  {
    "start": "1367000",
    "end": "1386000"
  },
  {
    "text": "um other than that I am going to be",
    "start": "1368179",
    "end": "1370220"
  },
  {
    "text": "around to answer questions you can also",
    "start": "1370220",
    "end": "1372140"
  },
  {
    "text": "find me in the Linker D booth in the",
    "start": "1372140",
    "end": "1374419"
  },
  {
    "text": "project Pavilion if you want to come",
    "start": "1374419",
    "end": "1376159"
  },
  {
    "text": "talk about Linker to your service meshes",
    "start": "1376159",
    "end": "1377780"
  },
  {
    "text": "I would be more than happy to and I",
    "start": "1377780",
    "end": "1380000"
  },
  {
    "text": "think we have some time now for",
    "start": "1380000",
    "end": "1381260"
  },
  {
    "text": "questions yes we do we have a plenty of",
    "start": "1381260",
    "end": "1383240"
  },
  {
    "text": "time for questions",
    "start": "1383240",
    "end": "1385960"
  },
  {
    "start": "1386000",
    "end": "1498000"
  },
  {
    "text": "hi you you mentioned the the solution",
    "start": "1392419",
    "end": "1394580"
  },
  {
    "text": "you've got is a little janky so this is",
    "start": "1394580",
    "end": "1395960"
  },
  {
    "text": "maybe uh just a possible Jank but",
    "start": "1395960",
    "end": "1399380"
  },
  {
    "text": "um the test that goes out and then test",
    "start": "1399380",
    "end": "1401539"
  },
  {
    "text": "that local redirection is working would",
    "start": "1401539",
    "end": "1403220"
  },
  {
    "text": "that Miss",
    "start": "1403220",
    "end": "1404500"
  },
  {
    "text": "iptables inbound redirection is not",
    "start": "1404500",
    "end": "1406820"
  },
  {
    "text": "working or are they is that possible",
    "start": "1406820",
    "end": "1409700"
  },
  {
    "text": "yeah that's right so it only tests the",
    "start": "1409700",
    "end": "1411380"
  },
  {
    "text": "kind of the outbound Direction but uh",
    "start": "1411380",
    "end": "1414860"
  },
  {
    "text": "is kind of as there as a proxy right",
    "start": "1414860",
    "end": "1416960"
  },
  {
    "text": "it'll tell us whether the rules have run",
    "start": "1416960",
    "end": "1418220"
  },
  {
    "text": "at all and the rules you know are",
    "start": "1418220",
    "end": "1419720"
  },
  {
    "text": "intended to set up both inbound and",
    "start": "1419720",
    "end": "1421280"
  },
  {
    "text": "outbound so this kind of if we see that",
    "start": "1421280",
    "end": "1423320"
  },
  {
    "text": "outbound is working we can kind of",
    "start": "1423320",
    "end": "1424520"
  },
  {
    "text": "assume that inbound is also it seems",
    "start": "1424520",
    "end": "1425960"
  },
  {
    "text": "like a safe assumption yeah thanks",
    "start": "1425960",
    "end": "1429460"
  },
  {
    "text": "this one over here oh yep",
    "start": "1433580",
    "end": "1437080"
  },
  {
    "text": "that was a great talk thank you the kind",
    "start": "1438580",
    "end": "1441440"
  },
  {
    "text": "of issue of I guess all your critical",
    "start": "1441440",
    "end": "1443840"
  },
  {
    "text": "demon sets not being ready until and",
    "start": "1443840",
    "end": "1446840"
  },
  {
    "text": "then user applications come on I",
    "start": "1446840",
    "end": "1448340"
  },
  {
    "text": "remember like reading a lot about it",
    "start": "1448340",
    "end": "1449360"
  },
  {
    "text": "when I was looking to the storage stuff",
    "start": "1449360",
    "end": "1450500"
  },
  {
    "text": "because they have a very similar problem",
    "start": "1450500",
    "end": "1451700"
  },
  {
    "text": "there and then like there was this",
    "start": "1451700",
    "end": "1453380"
  },
  {
    "text": "GitHub issue and a cat floating around",
    "start": "1453380",
    "end": "1455179"
  },
  {
    "text": "about like tating nodes and all that",
    "start": "1455179",
    "end": "1456860"
  },
  {
    "text": "kind of stuff and I was curious about",
    "start": "1456860",
    "end": "1457880"
  },
  {
    "text": "did you think about that kind of idea",
    "start": "1457880",
    "end": "1459919"
  },
  {
    "text": "and then I guess it seems like we just",
    "start": "1459919",
    "end": "1462140"
  },
  {
    "text": "kind of need a general feature to be",
    "start": "1462140",
    "end": "1463580"
  },
  {
    "text": "like these things are really critical",
    "start": "1463580",
    "end": "1464900"
  },
  {
    "text": "for the nodes don't let me schedule",
    "start": "1464900",
    "end": "1466700"
  },
  {
    "text": "stuff till they come up",
    "start": "1466700",
    "end": "1468260"
  },
  {
    "text": "yeah yeah I mean it's true that there",
    "start": "1468260",
    "end": "1470299"
  },
  {
    "text": "are a lot of things that this kind of",
    "start": "1470299",
    "end": "1471440"
  },
  {
    "text": "applies to",
    "start": "1471440",
    "end": "1472880"
  },
  {
    "text": "um this was kind of the best the best",
    "start": "1472880",
    "end": "1474380"
  },
  {
    "text": "thing that we could find that that would",
    "start": "1474380",
    "end": "1475880"
  },
  {
    "text": "would solve this but I agree like having",
    "start": "1475880",
    "end": "1477559"
  },
  {
    "text": "this solved at the infrastructure layer",
    "start": "1477559",
    "end": "1478880"
  },
  {
    "text": "would just be so much nicer",
    "start": "1478880",
    "end": "1481840"
  },
  {
    "text": "going once",
    "start": "1487100",
    "end": "1489020"
  },
  {
    "text": "go win twice uh let's have a round of",
    "start": "1489020",
    "end": "1492740"
  },
  {
    "text": "applause for Alex",
    "start": "1492740",
    "end": "1495700"
  },
  {
    "text": "[Applause]",
    "start": "1496430",
    "end": "1499539"
  }
]