[
  {
    "start": "0",
    "end": "25000"
  },
  {
    "text": "welcome everyone to our session um for uh working group component standard uh",
    "start": "80",
    "end": "5680"
  },
  {
    "text": "my name is mike tauffin uh this is my co-presenter uh alex kniffing um today we'll be",
    "start": "5680",
    "end": "11679"
  },
  {
    "text": "presenting on some of the technical challenges that alex encountered while trying to implement",
    "start": "11679",
    "end": "18080"
  },
  {
    "text": "various pieces of component config so just quickly before we get started a",
    "start": "18080",
    "end": "23519"
  },
  {
    "text": "little bit about the working group we formed this working group a couple years ago with the idea of trying to",
    "start": "23519",
    "end": "29760"
  },
  {
    "start": "25000",
    "end": "78000"
  },
  {
    "text": "develop a standard foundation for uh core kubernetes components to build on top of",
    "start": "29760",
    "end": "35040"
  },
  {
    "text": "um we have many core components such as the api server the scheduler the cubelet uh cube proxy um",
    "start": "35040",
    "end": "42079"
  },
  {
    "text": "and many common functionalities that are distributed across these components but we didn't necessarily have standard",
    "start": "42079",
    "end": "48719"
  },
  {
    "text": "implementations of these functions across the project and so that's the idea behind the working group is to provide a place where we can talk",
    "start": "48719",
    "end": "55760"
  },
  {
    "text": "about uh and design and standardize these solutions so these are a few examples um how components are configured uh how",
    "start": "55760",
    "end": "63280"
  },
  {
    "text": "they sort of report their status various integration points and and sort of logging in metrics are the main areas",
    "start": "63280",
    "end": "69600"
  },
  {
    "text": "so i'm going to turn it over to alex and let him talk about sort of how he was introduced to the working group and",
    "start": "69600",
    "end": "75119"
  },
  {
    "text": "some of the projects that he's worked on thanks mike uh yeah before we get",
    "start": "75119",
    "end": "80479"
  },
  {
    "start": "78000",
    "end": "102000"
  },
  {
    "text": "started just a quick overview of the agenda today so we already heard the introduction uh",
    "start": "80479",
    "end": "86000"
  },
  {
    "text": "from mike um i'll be talking about points two and three um basically two of the problems i",
    "start": "86000",
    "end": "92400"
  },
  {
    "text": "encountered or i dealt with uh when working with the working group and then we'll close up with some uh",
    "start": "92400",
    "end": "97759"
  },
  {
    "text": "shout outs other works with durian and of course q a alright so uh this is me my name is alex",
    "start": "97759",
    "end": "105119"
  },
  {
    "start": "102000",
    "end": "260000"
  },
  {
    "text": "i'm a site reliability engineer at x-ray in munich we're building a german iptv",
    "start": "105119",
    "end": "110159"
  },
  {
    "text": "platform and it was around mid-may or admit last year um that i got interested in contributing",
    "start": "110159",
    "end": "117920"
  },
  {
    "text": "to the kubernetes project i think it was um for kubecon in europe around may when i",
    "start": "117920",
    "end": "125920"
  },
  {
    "text": "like went to a couple talks and you know i saw a couple of uh like working groups or",
    "start": "125920",
    "end": "133360"
  },
  {
    "text": "special interest groups and themselves i think one of them was a c-class life cycle and it was really a",
    "start": "133360",
    "end": "139360"
  },
  {
    "text": "nice and open environment and a very like welcoming community",
    "start": "139360",
    "end": "144640"
  },
  {
    "text": "and it was around that time um where i was trying to get into the project i",
    "start": "144640",
    "end": "150080"
  },
  {
    "text": "tried to contribute a little bit i started with some golden golin issues um although that got",
    "start": "150080",
    "end": "155680"
  },
  {
    "text": "a bit boring after a while so i was kind of looking for a new challenge but it was a bit daunting like",
    "start": "155680",
    "end": "161519"
  },
  {
    "text": "kubernetes being such a big project it can be quite tough or like at least at the beginning um to",
    "start": "161519",
    "end": "167680"
  },
  {
    "text": "really get a grip on on this if you want to start out contributing so um the guys from sicar's life cycle",
    "start": "167680",
    "end": "175280"
  },
  {
    "text": "they pointed me actually to the working group and i didn't have any prior experience to that i've had little go experience",
    "start": "175280",
    "end": "181519"
  },
  {
    "text": "um certainly no open source experience uh and uh he just told me like you know",
    "start": "181519",
    "end": "187280"
  },
  {
    "text": "just just talk to them um talk to mike and lee at the time and uh i went there at a good time basically",
    "start": "187280",
    "end": "193360"
  },
  {
    "text": "they just had a contributor onboarding coming up and we discussed a couple of things they're",
    "start": "193360",
    "end": "199680"
  },
  {
    "text": "really really nice and welcoming um just didn't really matter that i didn't have any",
    "start": "199680",
    "end": "205040"
  },
  {
    "text": "uh prior experience there's a lot of issues actually um in the community that can be tackled by",
    "start": "205040",
    "end": "211040"
  },
  {
    "text": "people with a fewer technical skills but they walked me through the code base uh regardless",
    "start": "211040",
    "end": "218080"
  },
  {
    "text": "and you know we talked a little bit about the projects i could be working on uh why am i telling you this well i want",
    "start": "218080",
    "end": "224799"
  },
  {
    "text": "to structure this talk a little bit uh like this to to take you on a journey um it's like my journey through uh",
    "start": "224799",
    "end": "232560"
  },
  {
    "text": "through the project at least like over the past year um and just really you know show you what kind",
    "start": "232560",
    "end": "238159"
  },
  {
    "text": "of problems are dealt with and how i learned step by step and hopefully you know if you're",
    "start": "238159",
    "end": "244480"
  },
  {
    "text": "looking to contribute or if you're thinking about it but you're also a little bit scared as i was you know maybe i can take away some of",
    "start": "244480",
    "end": "250799"
  },
  {
    "text": "that and show you know it's it's really not that not that of an issue and there are loads of friendly people who can help you with",
    "start": "250799",
    "end": "256400"
  },
  {
    "text": "it all right so um back when i started uh coming to like the meetings of the",
    "start": "256400",
    "end": "263360"
  },
  {
    "text": "working group there was just this pr was just merged basically codec factory options which allowed some options to",
    "start": "263360",
    "end": "271360"
  },
  {
    "text": "pass through codec factory mainly like the pretty encoders and the strict decoders what those are will explain in detail",
    "start": "271360",
    "end": "278000"
  },
  {
    "text": "but basically the problem was that when you load a component config which is the ammo",
    "start": "278000",
    "end": "284400"
  },
  {
    "text": "file um which configures a component like the api server or cubelet",
    "start": "284400",
    "end": "289520"
  },
  {
    "text": "those yaml files can be malformed so they couldn't have duplicate fields or typos and field",
    "start": "289520",
    "end": "296000"
  },
  {
    "text": "names in the ammo and those arrows would be ignored right and this could lead to undefined",
    "start": "296000",
    "end": "302320"
  },
  {
    "text": "behavior so we can't really assume like which of those fields are intended or not",
    "start": "302320",
    "end": "307919"
  },
  {
    "text": "um and back then you know that wasn't really happening like anything straightforward i think it was just like the first field i",
    "start": "307919",
    "end": "313600"
  },
  {
    "text": "encountered it took but you know as i said it could lead to unexpected behaviors",
    "start": "313600",
    "end": "318639"
  },
  {
    "text": "and um with this pr merged basically it was creating the prerequisite to deal",
    "start": "318639",
    "end": "324880"
  },
  {
    "text": "with this problem to actually load the config file um and arrow out on those you know um like malformed",
    "start": "324880",
    "end": "331840"
  },
  {
    "text": "fields so this was like the first challenge the guys suggested to me it's like",
    "start": "331840",
    "end": "336880"
  },
  {
    "text": "no why don't you deal with this it's a good um it's a good point to you know get familiar with the code",
    "start": "336880",
    "end": "342479"
  },
  {
    "text": "base to learn a bit about api machinery so this is what i did uh this is what i",
    "start": "342479",
    "end": "347680"
  },
  {
    "text": "you know told him i will tackle on so you know it sounds quite straightforward you know we can we have",
    "start": "347680",
    "end": "352720"
  },
  {
    "text": "uh male 4 gamma files and if we load them um it should throw an error right so",
    "start": "352720",
    "end": "359840"
  },
  {
    "text": "uh sounds quite easy right well at that time you know i didn't really know anything uh you know what was the",
    "start": "359840",
    "end": "366720"
  },
  {
    "text": "component conflict well obviously it was the ammo file you passed to the component but you know how does it work like what are the",
    "start": "366720",
    "end": "372960"
  },
  {
    "text": "concepts behind it um also what's the codec what's the codec factory um i didn't really have any clues so you",
    "start": "372960",
    "end": "380000"
  },
  {
    "text": "know let's start at the beginning and you know walk a little bit through the process",
    "start": "380000",
    "end": "385360"
  },
  {
    "start": "386000",
    "end": "493000"
  },
  {
    "text": "all right so this is the configuration it's called cubic configuration and this is a component config and it's for the",
    "start": "386400",
    "end": "392639"
  },
  {
    "text": "cubelet all right and um when if you're if you installed a cluster before if you did",
    "start": "392639",
    "end": "397919"
  },
  {
    "text": "uh kelsey high towers um kubernetes the hardware you've probably seen this before created it yourself",
    "start": "397919",
    "end": "403520"
  },
  {
    "text": "um this config file you pass it equivalent as i said when you start it now this goes alongside to right now the",
    "start": "403520",
    "end": "410720"
  },
  {
    "text": "cli flags as well now the cr flags uh configure the cubelet too but um like in the future",
    "start": "410720",
    "end": "417919"
  },
  {
    "text": "we want to like phase out the cli flex completely why is that well there are loads of",
    "start": "417919",
    "end": "423039"
  },
  {
    "text": "problems with flags one of the bigger ones is that you can't version them right it's really tough to deprecate",
    "start": "423039",
    "end": "428960"
  },
  {
    "text": "flags in a way that it doesn't break you know older clusters or things like that so this is just one",
    "start": "428960",
    "end": "435280"
  },
  {
    "text": "of the problems um i won't go on in detail here if you're interested in that and there's still lots of work around this section",
    "start": "435280",
    "end": "441440"
  },
  {
    "text": "like deprecating cli flags um i recommend you to talk from the",
    "start": "441440",
    "end": "446479"
  },
  {
    "text": "working group last year at cubecon san diego i think um and those uh some great detail into that",
    "start": "446479",
    "end": "453599"
  },
  {
    "text": "so this all happens on the note right all right so and this is the problem basically",
    "start": "453599",
    "end": "459199"
  },
  {
    "text": "we're trying to solve so if you have you know a config here and you have a duplicate field like one's cluster local the other one",
    "start": "459199",
    "end": "465759"
  },
  {
    "text": "is my cluster local like which of those fields you know do actually you know want to load you know it's not really clear and uh the same",
    "start": "465759",
    "end": "472560"
  },
  {
    "text": "as this area is this like a field which doesn't really exist in the individual beta one api so what do you",
    "start": "472560",
    "end": "479039"
  },
  {
    "text": "do with it right um and as i said you know the idea is to to load these configs",
    "start": "479039",
    "end": "484960"
  },
  {
    "text": "and if you know um through the process of loading it if you encounter any of these errors like you you error out",
    "start": "484960",
    "end": "493440"
  },
  {
    "start": "493000",
    "end": "587000"
  },
  {
    "text": "all right so the first thing i did basically i loaded up the the editor i jumped right into the code",
    "start": "493440",
    "end": "500080"
  },
  {
    "text": "um and digged a little bit through the gcublet codebase and um basically i i found this function",
    "start": "500080",
    "end": "507440"
  },
  {
    "text": "right you have s loader uh it takes a file system and a cubit file as a string so the file system is just an",
    "start": "507440",
    "end": "513599"
  },
  {
    "text": "abstraction basically if you're for testing uh whereas the cubelet file is the path",
    "start": "513599",
    "end": "519200"
  },
  {
    "text": "to the to the actually q black camera uh yamo and uh what does it do",
    "start": "519200",
    "end": "524480"
  },
  {
    "text": "it's the first line here in 148 it returns a cubelet scheme or like uh basically a",
    "start": "524480",
    "end": "531120"
  },
  {
    "text": "new scheme and codex like here right um didn't really know what that was so you know follow the function and in",
    "start": "531120",
    "end": "538480"
  },
  {
    "text": "scheme dot go you see it returns a scheme an encoder factory and an error",
    "start": "538480",
    "end": "543920"
  },
  {
    "text": "so there are a couple points here which you know obviously i didn't know exactly what",
    "start": "543920",
    "end": "549360"
  },
  {
    "text": "they were so we have a scheme um which gets returned from from the runtime package",
    "start": "549360",
    "end": "555600"
  },
  {
    "text": "then some things are added to the scheme and then we take the scheme and then we",
    "start": "555600",
    "end": "560800"
  },
  {
    "text": "turn some codecs right so um obviously the question were here like what's the scheme you know and",
    "start": "560800",
    "end": "567279"
  },
  {
    "text": "you know what's at it and um looking up like digging into these questions really let me down the",
    "start": "567279",
    "end": "572800"
  },
  {
    "text": "akai machine rabbit hole i won't go into too much detail here i'll just try to give you",
    "start": "572800",
    "end": "578240"
  },
  {
    "text": "the overview but these are like core kubernetes concepts it's really good to know about them",
    "start": "578240",
    "end": "583519"
  },
  {
    "text": "especially when you want to start out so let's start with the scheme right um let's say you're",
    "start": "583519",
    "end": "591040"
  },
  {
    "start": "587000",
    "end": "723000"
  },
  {
    "text": "like cube control and uh you fire up a get pods and it's like you know ask the api server and the ibi",
    "start": "591040",
    "end": "597360"
  },
  {
    "text": "api server responds like here are some structs you know here you go now how does cube control figure out if",
    "start": "597360",
    "end": "604240"
  },
  {
    "text": "those were actually parts which were sent over here right um these are just like for all intents and purposes just you",
    "start": "604240",
    "end": "610640"
  },
  {
    "text": "know some some ghost trucks it received and this job actually from translating it",
    "start": "610640",
    "end": "617200"
  },
  {
    "text": "from like some struct to a known type uh this is what the scheme does uh one of the things it does actually as",
    "start": "617200",
    "end": "624160"
  },
  {
    "text": "i said like the scheme is uh one of the core concepts in kubernetes and a bit of a like a swiss army knife for api",
    "start": "624160",
    "end": "630160"
  },
  {
    "text": "machinery but one thing it does it provides a mapping between an object so like a ghost truck for the part for",
    "start": "630160",
    "end": "637680"
  },
  {
    "text": "example um to a specific goal type which is called group version kind of gbk in short",
    "start": "637680",
    "end": "643120"
  },
  {
    "text": "and you'll find this a lot around the code base this terminology now in order for it to do it you know we",
    "start": "643120",
    "end": "650079"
  },
  {
    "text": "need to tell the scheme uh what kind of goal types it it knows basically we have",
    "start": "650079",
    "end": "656560"
  },
  {
    "text": "to tell it you know okay here this is what a pod looks like with version v1 um and as soon as we have registered",
    "start": "656560",
    "end": "663680"
  },
  {
    "text": "into that we can pass on an object and we will turn this to group version kind if it knows about it um",
    "start": "663680",
    "end": "670079"
  },
  {
    "text": "so it's really an elemental process which happens all the time this kind of conversion and if you go and dig through the code",
    "start": "670079",
    "end": "676959"
  },
  {
    "text": "basically when you look up the scheme you'll find you know a comment that says it's the foundation of the version the api",
    "start": "676959",
    "end": "682800"
  },
  {
    "text": "and configuration over time and as you might know you know every api uh",
    "start": "682800",
    "end": "688240"
  },
  {
    "text": "in kubernetes is version or like pretty much everything is version and the scheme basically provides us the",
    "start": "688240",
    "end": "694800"
  },
  {
    "text": "tools to i know like work with these versions to convert between them um and to do yeah conversions basically",
    "start": "694800",
    "end": "702880"
  },
  {
    "text": "and this can easily happen you know if for example like the client is uh has a different version than the",
    "start": "702880",
    "end": "708880"
  },
  {
    "text": "api server uh like i think with the version sku policy we allow like two major versions to differ of i",
    "start": "708880",
    "end": "715519"
  },
  {
    "text": "remember correctly so you know we definitely need to have some tools to convert between these different versions",
    "start": "715519",
    "end": "722880"
  },
  {
    "start": "723000",
    "end": "766000"
  },
  {
    "text": "all right so this is what the scheme does you know it gives us some some tools to convert between versions and",
    "start": "723120",
    "end": "728880"
  },
  {
    "text": "speaking of versions this is exactly what we do here you know we tell the scheme which versions are available and we can",
    "start": "728880",
    "end": "735440"
  },
  {
    "text": "see here is an even better one it's the one we you know it's the the api version we see here",
    "start": "735440",
    "end": "741519"
  },
  {
    "text": "it's an even better one this is the basically the external api it's called",
    "start": "741519",
    "end": "746959"
  },
  {
    "text": "and then we also register another thing in here and it's just called cubic config",
    "start": "746959",
    "end": "752399"
  },
  {
    "text": "without a version now this is what is called the internal api and this was",
    "start": "752399",
    "end": "757600"
  },
  {
    "text": "very confusing to me at the beginning like internal excuse me internal and external versions",
    "start": "757600",
    "end": "763200"
  },
  {
    "text": "you know what does it mean like why do we need this and um it's basically like the internal version is like a hub type",
    "start": "763200",
    "end": "769519"
  },
  {
    "start": "766000",
    "end": "812000"
  },
  {
    "text": "right and it's used to convert between any different versions you can obviously you convert between",
    "start": "769519",
    "end": "775360"
  },
  {
    "text": "external version and the internal version but you can also convert between two external versions going through",
    "start": "775360",
    "end": "781839"
  },
  {
    "text": "this hub type called the internal versions so let's say we one alpha one has you know",
    "start": "781839",
    "end": "788240"
  },
  {
    "text": "fields a and b and b one better one has fields b c and d the internal version would know about",
    "start": "788240",
    "end": "794720"
  },
  {
    "text": "all fields a to d so and it would it would provide you with some tools to",
    "start": "794720",
    "end": "800160"
  },
  {
    "text": "you know convert between those versions do some defaults um all kinds of things you know so in",
    "start": "800160",
    "end": "807360"
  },
  {
    "text": "the end you know you don't lose any information when you do these conversions",
    "start": "807360",
    "end": "812320"
  },
  {
    "start": "812000",
    "end": "955000"
  },
  {
    "text": "all right so we have a scheme now we register some versions into it",
    "start": "812560",
    "end": "817839"
  },
  {
    "text": "and then we pass it to a codec factory uh we get some codecs back all right what's the codec factory let's",
    "start": "817839",
    "end": "824000"
  },
  {
    "text": "have a look now if you look through the code you see that for codefactory it says it provides",
    "start": "824000",
    "end": "831199"
  },
  {
    "text": "methods for retrieving codecs and serializers for specific versions and content type",
    "start": "831199",
    "end": "836720"
  },
  {
    "text": "now you can see here the codec factory has a scheme it has serializers and has a decoder a",
    "start": "836720",
    "end": "842880"
  },
  {
    "text": "universal decoder now there are a lot of things to it but on a high level basically a serializer",
    "start": "842880",
    "end": "850720"
  },
  {
    "text": "or deserializing what we do in our case is we convert it from a wire format",
    "start": "850720",
    "end": "856880"
  },
  {
    "text": "so a yaml file into a memory representation which is the go struct",
    "start": "856880",
    "end": "862160"
  },
  {
    "text": "then we take the decoder and take the go struct and map it to an internal or any",
    "start": "862160",
    "end": "867600"
  },
  {
    "text": "external version doesn't really matter um and basically this is where the the actual conversion happens between",
    "start": "867600",
    "end": "874240"
  },
  {
    "text": "the between the actual uh versions yeah um and if we look down here we can see it",
    "start": "874240",
    "end": "881680"
  },
  {
    "text": "also has some options right so uh in this case we have strict and we have pretty",
    "start": "881680",
    "end": "887760"
  },
  {
    "text": "and strict is what we want right so configures all serializes the strict mode",
    "start": "887760",
    "end": "893199"
  },
  {
    "text": "and this is exactly the behavior we need in this case um so if you know the serializer",
    "start": "893199",
    "end": "899680"
  },
  {
    "text": "encounters any errors um or like any any unknown fields you know doesn't know about you know",
    "start": "899680",
    "end": "905199"
  },
  {
    "text": "overthrow and error all right so we have everything covered we have the scheme",
    "start": "905199",
    "end": "911199"
  },
  {
    "text": "we have some versions which we which we need you know the internal version and the external version we've on better one",
    "start": "911199",
    "end": "916800"
  },
  {
    "text": "in this case and we have the codex you know which you know we can use to actually convert",
    "start": "916800",
    "end": "923040"
  },
  {
    "text": "and uh and load the file all right so the idea is just has the strict option",
    "start": "923040",
    "end": "928560"
  },
  {
    "text": "here you know behind the scheme and should be fine right well you know technically yes",
    "start": "928560",
    "end": "934480"
  },
  {
    "text": "it's it's just how it works but there's one more thing we forgot and i forgot this at first as",
    "start": "934480",
    "end": "941199"
  },
  {
    "text": "well uh so i implemented this pr got merged but then you know",
    "start": "941199",
    "end": "946320"
  },
  {
    "text": "then um we you know we got some some ideas that you know we actually might",
    "start": "946320",
    "end": "951680"
  },
  {
    "text": "break some clusters some older clusters how does this work you know what what happens um",
    "start": "951680",
    "end": "957600"
  },
  {
    "text": "so let's say you know we introduce this change from uh let's say 119 is the current uh",
    "start": "957600",
    "end": "964240"
  },
  {
    "text": "current version let's say we introduce this for 119. um but the thing is when uh 119 gets released",
    "start": "964240",
    "end": "973120"
  },
  {
    "text": "this doesn't actually increase this version here so you know the version of the api of the cubic",
    "start": "973120",
    "end": "978720"
  },
  {
    "text": "configuration doesn't go in lockstep with the kubernetes release cycle",
    "start": "978720",
    "end": "983839"
  },
  {
    "text": "so what would happen you know people would upgrade let's say someone has has this config here and has",
    "start": "983839",
    "end": "989279"
  },
  {
    "text": "a duplicate field the change would get into the tree and",
    "start": "989279",
    "end": "994800"
  },
  {
    "text": "the the user would upgrade his tubeler uh and what would happen the cuber would fail you know which would break the",
    "start": "994800",
    "end": "1000560"
  },
  {
    "text": "cluster in the worst case and this is not something i as user would expect right so because this version didn't change you know why is my",
    "start": "1000560",
    "end": "1007199"
  },
  {
    "text": "cluster not working basically um this version kind of especially like better and upwards",
    "start": "1007199",
    "end": "1013040"
  },
  {
    "text": "uh implies some kind of stability in this case so you know we don't want to break any",
    "start": "1013040",
    "end": "1018800"
  },
  {
    "text": "user clusters so we need to figure out a way to you know only strengthen this when this version",
    "start": "1018800",
    "end": "1025520"
  },
  {
    "text": "changes and this is exactly what we did you know we strengthen",
    "start": "1025520",
    "end": "1030720"
  },
  {
    "start": "1027000",
    "end": "1086000"
  },
  {
    "text": "our the validation on the version boundary um and basically we want to for v one",
    "start": "1030720",
    "end": "1036160"
  },
  {
    "text": "better one we want to decode with some warnings but on v1 better 2 and upwards you know",
    "start": "1036160",
    "end": "1042400"
  },
  {
    "text": "we want to have the expected behavior that it will throw an error when the ammo is",
    "start": "1042400",
    "end": "1047520"
  },
  {
    "text": "now formed and what we introduced here is called the new linear scheme and codex",
    "start": "1047520",
    "end": "1052720"
  },
  {
    "text": "it's like a helper function and this is used to you know return a codec factory with",
    "start": "1052720",
    "end": "1060960"
  },
  {
    "text": "disable strict so like the strix here that was disabled just for a single version and this gets",
    "start": "1060960",
    "end": "1066400"
  },
  {
    "text": "called with the scheme of the version for even better one and just for this version it returns um",
    "start": "1066400",
    "end": "1073760"
  },
  {
    "text": "like some codecs which uh you know have strict disabled and everyone",
    "start": "1073760",
    "end": "1079200"
  },
  {
    "text": "upwards every version upwards will have the strict serializers enabled all right",
    "start": "1079200",
    "end": "1086640"
  },
  {
    "start": "1086000",
    "end": "1149000"
  },
  {
    "text": "and we basically did this for every um component so for like the q proxy the",
    "start": "1086640",
    "end": "1092400"
  },
  {
    "text": "cube scheduler and cubelet as you see here the first list we implemented these first um and then we came you know upon",
    "start": "1092400",
    "end": "1099760"
  },
  {
    "text": "the issue i just talked about and then afterwards we shipped basically the lenient paths as",
    "start": "1099760",
    "end": "1105919"
  },
  {
    "text": "well so we call it so you know this was all in the same release cycle and um so the user didn't really you know",
    "start": "1105919",
    "end": "1113840"
  },
  {
    "text": "uh recognize any of the of the issues um you know unless they were running from master but yeah",
    "start": "1113840",
    "end": "1120160"
  },
  {
    "text": "so this only like all these changes got in into the next version i think it was 1 17 or 118 i'm not sure anymore",
    "start": "1120160",
    "end": "1128559"
  },
  {
    "text": "all right yeah so we did this for these components uh now as you can see here the cube",
    "start": "1128559",
    "end": "1134799"
  },
  {
    "text": "controller manager is strikethrough right so actually and i didn't i didn't",
    "start": "1134799",
    "end": "1140240"
  },
  {
    "text": "know this uh before so the cube controller manager doesn't use a component config i think it's one of the only components",
    "start": "1140240",
    "end": "1146720"
  },
  {
    "text": "which doesn't why is that this is what i uh asked",
    "start": "1146720",
    "end": "1151760"
  },
  {
    "text": "myself why doesn't the controller manager use a component config and i asked it",
    "start": "1151760",
    "end": "1158320"
  },
  {
    "text": "to the guys and now they told me well that's difficult the cube controller",
    "start": "1158320",
    "end": "1163679"
  },
  {
    "text": "manager is like works a little bit different than um the other components",
    "start": "1163679",
    "end": "1169120"
  },
  {
    "text": "in the new kubernetes cluster or ecosystem and let's do it as we did earlier so",
    "start": "1169120",
    "end": "1175679"
  },
  {
    "text": "let's start from the beginning you know first of all what's what's controller manager and this is from the official documentation um",
    "start": "1175679",
    "end": "1182559"
  },
  {
    "start": "1179000",
    "end": "1273000"
  },
  {
    "text": "basically the controller manager embeds core control loops ship with kubernetes",
    "start": "1182559",
    "end": "1188240"
  },
  {
    "text": "and a control loop watches the shared state of a cluster through the api server and makes changes",
    "start": "1188240",
    "end": "1193840"
  },
  {
    "text": "attempting to move the current state towards the desired state right so um basically it it looks like",
    "start": "1193840",
    "end": "1201919"
  },
  {
    "text": "to the api server and it checks you know is is my cluster in the state it should be right if someone starts a",
    "start": "1201919",
    "end": "1208400"
  },
  {
    "text": "deployment and the pod isn't rolled out on on this on any node yet you know the",
    "start": "1208400",
    "end": "1213840"
  },
  {
    "text": "uh there would actually be a controller making sure that would happen right and it's like",
    "start": "1213840",
    "end": "1218880"
  },
  {
    "text": "this this basically uh infinite loop just always checking if a certain condition is true or",
    "start": "1218880",
    "end": "1224640"
  },
  {
    "text": "conditions and if not it will try to reconcile that so this is a controller",
    "start": "1224640",
    "end": "1230320"
  },
  {
    "text": "and the controller manager is is a binary host basically it is um also like a hub or a host which holds",
    "start": "1230320",
    "end": "1238480"
  },
  {
    "text": "all the controllers basically or almost every controller uh and starts them make sure they're",
    "start": "1238480",
    "end": "1243840"
  },
  {
    "text": "configured and provides a home for them more or less now the idea is that",
    "start": "1243840",
    "end": "1248960"
  },
  {
    "text": "individual controllers are interchangeable and our users should be able to you know build their own controllers or",
    "start": "1248960",
    "end": "1254240"
  },
  {
    "text": "put their own controller managers for industry card and so this is what we have to keep in mind you",
    "start": "1254240",
    "end": "1260640"
  },
  {
    "text": "know um well probably not many uh are doing that but",
    "start": "1260640",
    "end": "1265679"
  },
  {
    "text": "you know it should be possible it's one of the core principles of kubernetes that you can exchange things and build your own stuff",
    "start": "1265679",
    "end": "1272559"
  },
  {
    "text": "all right um and you know if you look into the code uh you know you can see you know what",
    "start": "1272559",
    "end": "1278720"
  },
  {
    "start": "1273000",
    "end": "1340000"
  },
  {
    "text": "the controller manager does one of the things it does uh it has this function called new",
    "start": "1278720",
    "end": "1283760"
  },
  {
    "text": "controller initializers and it has you know a map of basically if the key",
    "start": "1283760",
    "end": "1289280"
  },
  {
    "text": "of the name of the controller and the value is a function which starts the controller",
    "start": "1289280",
    "end": "1294559"
  },
  {
    "text": "right so we have i think over 30 here and this is this looks quite daunting",
    "start": "1294559",
    "end": "1299919"
  },
  {
    "text": "you know there's quite a bit of complexity in here but you know in the end you know that we're",
    "start": "1299919",
    "end": "1304960"
  },
  {
    "text": "just starting individual controllers and this can be uh configured from the command line uh of course you know we don't have a",
    "start": "1304960",
    "end": "1310720"
  },
  {
    "text": "component config and um it takes a list i think i'm not sure what the flag is called but it takes a",
    "start": "1310720",
    "end": "1316720"
  },
  {
    "text": "list and you can turn on or turn off uh specific controllers",
    "start": "1316720",
    "end": "1321840"
  },
  {
    "text": "and by default it has a star so basically it turns on all the controllers",
    "start": "1321840",
    "end": "1327200"
  },
  {
    "text": "right so next question would be okay so it starts the controllers but how are they configured right as i said",
    "start": "1327200",
    "end": "1333600"
  },
  {
    "text": "control manager deals also with configuration of of the controllers or provides uh primitives for that and",
    "start": "1333600",
    "end": "1341360"
  },
  {
    "start": "1340000",
    "end": "1504000"
  },
  {
    "text": "basically the controller manager configuration exists and it's also it's a version api right",
    "start": "1341360",
    "end": "1347440"
  },
  {
    "text": "and it is uh like uh yeah a version api holding all the configuration uh necessary to",
    "start": "1347440",
    "end": "1353440"
  },
  {
    "text": "start the controller manager and the individual controllers right so in this case it's what we call a",
    "start": "1353440",
    "end": "1360000"
  },
  {
    "text": "container config so we see here it has a type meta which basically means it is it is",
    "start": "1360000",
    "end": "1365360"
  },
  {
    "text": "versioned you know it has like an external version but then we have the individual controllers as fields in",
    "start": "1365360",
    "end": "1372960"
  },
  {
    "text": "the struct and each of these controllers basically",
    "start": "1372960",
    "end": "1378159"
  },
  {
    "text": "holds the or like sorry each of these configurations holds the configuration for the individual",
    "start": "1378159",
    "end": "1384240"
  },
  {
    "text": "controllers now we do have something you know curious here it's called cube cloud",
    "start": "1384240",
    "end": "1389919"
  },
  {
    "text": "shared and it holds configuration for shared related features both in controller manager and cube controller manager",
    "start": "1389919",
    "end": "1396799"
  },
  {
    "text": "so actually the cloud controller manager used to be part of the controller manager but it moved",
    "start": "1396799",
    "end": "1402960"
  },
  {
    "text": "out of three because it was just too much complexity and the individual cloud controllers",
    "start": "1402960",
    "end": "1408240"
  },
  {
    "text": "were differing uh you know too much after a while so you know the maintainers decided to",
    "start": "1408240",
    "end": "1414559"
  },
  {
    "text": "take it out of tree and maintain it as an individual controller basically which is not",
    "start": "1414559",
    "end": "1419600"
  },
  {
    "text": "maintained by the controller manager so this is the first you know the first",
    "start": "1419600",
    "end": "1425360"
  },
  {
    "text": "example you see of everything should be should be plug and play in a way so uh",
    "start": "1425360",
    "end": "1431760"
  },
  {
    "text": "you know the controller manager doesn't really start or care anymore that much about the cloud controller manager",
    "start": "1431760",
    "end": "1437679"
  },
  {
    "text": "but there are still some configuration fields which are needed by both parties right um so this is why we have this",
    "start": "1437679",
    "end": "1445039"
  },
  {
    "text": "configuration uh substruct basically all right so as we said the container",
    "start": "1445039",
    "end": "1452159"
  },
  {
    "text": "type the controller manager configuration is version but if we look at the individual controllers um",
    "start": "1452159",
    "end": "1458240"
  },
  {
    "text": "we can see that they are actually not versioned you know they only have an internal api and the first thing that gives that away",
    "start": "1458240",
    "end": "1464640"
  },
  {
    "text": "is you look to the import paths and if you see that these are coming from like entry so the kubernetes slash package",
    "start": "1464640",
    "end": "1471440"
  },
  {
    "text": "um basically directory it's where the internal apis are like when you go to slash config in the end",
    "start": "1471440",
    "end": "1477520"
  },
  {
    "text": "and this is what it looks like right conceptually so you have one container tile and this is one version",
    "start": "1477520",
    "end": "1483919"
  },
  {
    "text": "but it loads all the all it like um embeds all the um configurations of all",
    "start": "1483919",
    "end": "1490880"
  },
  {
    "text": "controllers so if anything changes here you know uh it goes into the same version of this so we basically",
    "start": "1490880",
    "end": "1497760"
  },
  {
    "text": "version it more or less and step although these are all internal right these are not really externally versioned",
    "start": "1497760",
    "end": "1504480"
  },
  {
    "start": "1504000",
    "end": "1518000"
  },
  {
    "text": "and if we go into you know any controller or like a specific controller configuration we can see we don't see a",
    "start": "1504480",
    "end": "1511039"
  },
  {
    "text": "type meta here indicating this is just an internal api right",
    "start": "1511039",
    "end": "1517520"
  },
  {
    "text": "all right so you know actually there's no real argument against not having you",
    "start": "1517520",
    "end": "1524080"
  },
  {
    "start": "1518000",
    "end": "1561000"
  },
  {
    "text": "know a configuration or like component config at least not technically you know we can",
    "start": "1524080",
    "end": "1530320"
  },
  {
    "text": "easily just create a mo file give it a like gvk a kind api version an api group and then we just list all",
    "start": "1530320",
    "end": "1538000"
  },
  {
    "text": "the fields and now we can we can load this and we get a conflict from that",
    "start": "1538000",
    "end": "1543760"
  },
  {
    "text": "so it's not really a problem technically right so if it's so easy why don't we have it yet you know that was my question basically",
    "start": "1543760",
    "end": "1550320"
  },
  {
    "text": "and uh well you know it's difficult it's it's not you know it's it is a technical challenge still um",
    "start": "1550320",
    "end": "1558240"
  },
  {
    "text": "but it's also an organizational challenge so we need to think about couple of things",
    "start": "1558240",
    "end": "1563279"
  },
  {
    "text": "you know um so for example what happens if a controller moves out of tree so we saw this with the cloud controller",
    "start": "1563279",
    "end": "1568880"
  },
  {
    "text": "you know we had to introduce a shared configuration field now if we have to do this for every",
    "start": "1568880",
    "end": "1575200"
  },
  {
    "text": "controller which we move out you know it gets a bit busy in the code base and it's not really you know a nice solution probably",
    "start": "1575200",
    "end": "1583440"
  },
  {
    "text": "and then again you know what happens uh if control the share config fields actually i think i looked at it they're",
    "start": "1583440",
    "end": "1588880"
  },
  {
    "text": "about 10 so like a third a little bit less of a third of the controllers we have in the controller manager",
    "start": "1588880",
    "end": "1595120"
  },
  {
    "text": "actually share some configuration fields so we need to deal with this you know what if you know if we have a single",
    "start": "1595120",
    "end": "1601039"
  },
  {
    "text": "controller which we don't want to get uh start from the controller manager how do we you know",
    "start": "1601039",
    "end": "1606159"
  },
  {
    "text": "build and build a component config around that or what does it mean for our yml file",
    "start": "1606159",
    "end": "1611279"
  },
  {
    "text": "um then what happens uh if a con if the owner of controller or like",
    "start": "1611279",
    "end": "1616559"
  },
  {
    "text": "the group owning a specific controller um you know doesn't want to follow this uh versioning you know they're kind of",
    "start": "1616559",
    "end": "1622799"
  },
  {
    "text": "bound to it as soon as we load it from a file um or what happens if users want to",
    "start": "1622799",
    "end": "1628000"
  },
  {
    "text": "implement their own controller manager now how do they like can they write their own component config like what kind of",
    "start": "1628000",
    "end": "1633679"
  },
  {
    "text": "primitives do we provide for that and these are all like like kind of tough questions you know it's very much",
    "start": "1633679",
    "end": "1640480"
  },
  {
    "text": "an architectural uh problem uh and also like a community you know organizational",
    "start": "1640480",
    "end": "1646559"
  },
  {
    "text": "problem i would say you know there's a lot of you know um a lot of targets and and",
    "start": "1646559",
    "end": "1651600"
  },
  {
    "text": "brainstorming which has to go into that and it's quite difficult now um one option would be for example",
    "start": "1651600",
    "end": "1660080"
  },
  {
    "start": "1657000",
    "end": "1680000"
  },
  {
    "text": "to you know just give each controller its own external version so we still have you know the same api group maybe we can",
    "start": "1660080",
    "end": "1666640"
  },
  {
    "text": "share we still have a container type which is version but then we also have individual versions you know for the",
    "start": "1666640",
    "end": "1673440"
  },
  {
    "text": "controller and you know they can move as quickly or as slow as you as they want um you know this",
    "start": "1673440",
    "end": "1679200"
  },
  {
    "text": "this could work but the problem is like we have a lot of controllers so if you think about",
    "start": "1679200",
    "end": "1684799"
  },
  {
    "start": "1680000",
    "end": "1713000"
  },
  {
    "text": "having external apis maybe several external apis for each controller",
    "start": "1684799",
    "end": "1690320"
  },
  {
    "text": "this can get quite messy you know there's a lot of lot of code a lot of duplicate code probably which has to be",
    "start": "1690320",
    "end": "1695840"
  },
  {
    "text": "written um it just you know quickly blows up in proportion so it's it's a possibility but it comes",
    "start": "1695840",
    "end": "1702640"
  },
  {
    "text": "with some serious tradeoffs as well as everything basically and it's just something you know we need",
    "start": "1702640",
    "end": "1708480"
  },
  {
    "text": "to get a consensus around you know if we want to do this so actually like the community has been",
    "start": "1708480",
    "end": "1714799"
  },
  {
    "start": "1713000",
    "end": "1734000"
  },
  {
    "text": "trying to figure out this problem you know since i think 2018 uh there was first students who tried to",
    "start": "1714799",
    "end": "1723120"
  },
  {
    "text": "you know merge the pr which introduced a conflict for the controller manager this one got",
    "start": "1723120",
    "end": "1728720"
  },
  {
    "text": "closed because it was missing a cap kubernetes enhancement proposal so",
    "start": "1728720",
    "end": "1734159"
  },
  {
    "start": "1734000",
    "end": "1822000"
  },
  {
    "text": "shortly afterwards it was lucas who started the discussion um around the component config for the",
    "start": "1734159",
    "end": "1740960"
  },
  {
    "text": "controller manager uh start with some brainstorming and a design document i have it linked here if you're interested by the way",
    "start": "1740960",
    "end": "1746399"
  },
  {
    "text": "i'm just on slides you can you can go to all the links um and you know there was there was the",
    "start": "1746399",
    "end": "1751919"
  },
  {
    "text": "initial discussion around it unfortunately you know it kind of got a little bit stale um",
    "start": "1751919",
    "end": "1757440"
  },
  {
    "text": "there hasn't been much uh around this topic um still tried again in 2019 uh",
    "start": "1757440",
    "end": "1764080"
  },
  {
    "text": "failed to gain some consensus um i think it also you know slipped under the radar of some people",
    "start": "1764080",
    "end": "1770320"
  },
  {
    "text": "uh this cap uh unfortunately he uh in the end didn't have much time and uh had to deal with other",
    "start": "1770320",
    "end": "1777360"
  },
  {
    "text": "projects so um basically this kind of got stale a little bit abandoned as well",
    "start": "1777360",
    "end": "1782799"
  },
  {
    "text": "so and yeah and and this basically shows you know the the problem uh you know one of the big",
    "start": "1782799",
    "end": "1788480"
  },
  {
    "text": "bigger problems of such a big community or like open source community you know it's quite difficult to get these",
    "start": "1788480",
    "end": "1793679"
  },
  {
    "text": "changes through now if it's not like the most shiny feature you know all the",
    "start": "1793679",
    "end": "1799039"
  },
  {
    "text": "core main contributor companies want um if it's like some cleanup you know and",
    "start": "1799039",
    "end": "1804480"
  },
  {
    "text": "some some housekeeping you want to do it can get really really tough to get consensus on these guys on these things",
    "start": "1804480",
    "end": "1811760"
  },
  {
    "text": "um especially if there's you know no one real you know with no no big contributor driving it it can",
    "start": "1811760",
    "end": "1818799"
  },
  {
    "text": "get really really hard um okay so what's the plan well",
    "start": "1818799",
    "end": "1824799"
  },
  {
    "start": "1822000",
    "end": "1918000"
  },
  {
    "text": "i i thought you know the current plan is let's pick up where uh stuart left and um",
    "start": "1824799",
    "end": "1831039"
  },
  {
    "text": "you know try to get the conversation going again um you know take his cap maybe extend it",
    "start": "1831039",
    "end": "1836640"
  },
  {
    "text": "a little bit and try to get everyone on the table and uh you know you might think now so okay",
    "start": "1836640",
    "end": "1841919"
  },
  {
    "text": "so what what's what's the plan now like how how should it end differently then then what's your day you know",
    "start": "1841919",
    "end": "1847919"
  },
  {
    "text": "honestly i don't have a i don't have a answer for that you know um i'm definitely not not more",
    "start": "1847919",
    "end": "1854399"
  },
  {
    "text": "qualified than uh than stuart was but you know at least you know i think we have to try",
    "start": "1854399",
    "end": "1860080"
  },
  {
    "text": "this is really an important um issue and um you know we just have to you know get the conversation",
    "start": "1860080",
    "end": "1865919"
  },
  {
    "text": "going again and i'll just try to you know stick with it or like we as a community that say we should try to",
    "start": "1865919",
    "end": "1872480"
  },
  {
    "text": "to really you know stick our heads together and try to come up with solutions to this problem",
    "start": "1872480",
    "end": "1878080"
  },
  {
    "text": "um yeah so that's the current uh situation right now of course you know",
    "start": "1878080",
    "end": "1883440"
  },
  {
    "text": "always looking for some help or we are always looking for some help on this i just mentioned two issues or working",
    "start": "1883440",
    "end": "1890960"
  },
  {
    "text": "on there are loads more um you know the working group could use help with so if you're",
    "start": "1890960",
    "end": "1897200"
  },
  {
    "text": "interested in any of that i think it's a really good way to learn about the code base to learn about some core concepts in kubernetes in api",
    "start": "1897200",
    "end": "1904320"
  },
  {
    "text": "machinery you know please don't hesitate to just you know join our slack or you know come to come to the working",
    "start": "1904320",
    "end": "1910080"
  },
  {
    "text": "group meetings and uh you know we'll be happy to onboard you and help you uh become a contributor all right",
    "start": "1910080",
    "end": "1919600"
  },
  {
    "start": "1918000",
    "end": "1985000"
  },
  {
    "text": "all right thanks alex uh for the presentation um and thanks for all of your work in the working group um",
    "start": "1919679",
    "end": "1926320"
  },
  {
    "text": "as we wrap up here i just wanted to quickly highlight a few things so these are some of the other projects and areas of work in our working group",
    "start": "1926320",
    "end": "1934320"
  },
  {
    "text": "um some are being worked on actively some are not uh so we have a lot of component config stuff",
    "start": "1934320",
    "end": "1939840"
  },
  {
    "text": "as alex talked about in the presentation um there's some work that overlaps with that around",
    "start": "1939840",
    "end": "1945440"
  },
  {
    "text": "command building as far as sort of dealing with flags and that migration to config there's a bunch of work going on uh a",
    "start": "1945440",
    "end": "1952960"
  },
  {
    "text": "contributor whose handle is cerrathius is leading that around standardizing the logging",
    "start": "1952960",
    "end": "1958880"
  },
  {
    "text": "subsystem in kubernetes and uh kind of redoing a lot of that um and finally there's there's some",
    "start": "1958880",
    "end": "1965519"
  },
  {
    "text": "potential work around uh standardizing component servers and some of the common endpoints like",
    "start": "1965519",
    "end": "1971039"
  },
  {
    "text": "healthy um and configsy between them um so if folks are interested in that please feel",
    "start": "1971039",
    "end": "1977039"
  },
  {
    "text": "free to reach out to us we'll have some information about that right at the end of the presentation",
    "start": "1977039",
    "end": "1982559"
  },
  {
    "text": "um and then the next thing if we go to the next slide i just wanted to give shout outs to all",
    "start": "1982559",
    "end": "1987760"
  },
  {
    "start": "1985000",
    "end": "2008000"
  },
  {
    "text": "of the folks who have contributed in some form or another maybe just a couple lines of code maybe a major",
    "start": "1987760",
    "end": "1993360"
  },
  {
    "text": "project two working group projects whether that's contributing to things in the",
    "start": "1993360",
    "end": "1998880"
  },
  {
    "text": "core kubernetes repo or in our component-based repo in the past year so thank you to all these folks really",
    "start": "1998880",
    "end": "2004960"
  },
  {
    "text": "appreciate all of your hard work and finally this is how you can get",
    "start": "2004960",
    "end": "2010880"
  },
  {
    "start": "2008000",
    "end": "2039000"
  },
  {
    "text": "involved with our working group we have weekly meetings on tuesdays at 8 30 a.m pacific time",
    "start": "2010880",
    "end": "2017279"
  },
  {
    "text": "there's also weekly office hours for folks who are working on things and have questions or need help and that's the same tuesday but at 10 am",
    "start": "2017279",
    "end": "2026320"
  },
  {
    "text": "we have our mailing list our slack and our github label as well so please feel free",
    "start": "2026320",
    "end": "2032399"
  },
  {
    "text": "to reach out to us the best way to reach us is typically on our slack channels",
    "start": "2032399",
    "end": "2037919"
  },
  {
    "text": "thank you",
    "start": "2037919",
    "end": "2041440"
  }
]