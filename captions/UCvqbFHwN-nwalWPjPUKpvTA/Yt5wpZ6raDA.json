[
  {
    "start": "0",
    "end": "10000"
  },
  {
    "text": "all right hey everybody i'm sarah felipe and i'm grant griffis and we'll be talking to you today about kindly",
    "start": "320",
    "end": "6399"
  },
  {
    "text": "validating your kubernetes apps automatically per pr",
    "start": "6399",
    "end": "11360"
  },
  {
    "start": "10000",
    "end": "33000"
  },
  {
    "text": "to give you a little background about myself i'm a field solutions engineer i'm i've been at github for 11 months",
    "start": "11759",
    "end": "17199"
  },
  {
    "text": "now previously i was a cloud apps and platform engineer at ge where i worked on microservices kubernetes and",
    "start": "17199",
    "end": "23920"
  },
  {
    "text": "cloud foundry today i'm focusing on intersource automation and improving the software development lifecycle",
    "start": "23920",
    "end": "30160"
  },
  {
    "text": "for fun i enjoy volleyball traveling and the beach and i'm grant i've been at pork's for",
    "start": "30160",
    "end": "36960"
  },
  {
    "text": "about a year and a half now i'm a software engineer previously i was at ge working on the data services team and",
    "start": "36960",
    "end": "43760"
  },
  {
    "text": "platform engineer i'm a contributor to sig storage and kubernetes csi and for fun i like climbing soccer and",
    "start": "43760",
    "end": "51120"
  },
  {
    "text": "surfing awesome all right let's jump into our agenda so",
    "start": "51120",
    "end": "58559"
  },
  {
    "start": "55000",
    "end": "76000"
  },
  {
    "text": "today we'll give you a quick overview what our motivations are what our challenges are we'll go into why kinds jump into our",
    "start": "58559",
    "end": "65439"
  },
  {
    "text": "automation and continuous integration conversations give you a quick overview of what we'll be testing we'll do a live demo right",
    "start": "65439",
    "end": "72400"
  },
  {
    "text": "after that and then talk about our takeaways",
    "start": "72400",
    "end": "76880"
  },
  {
    "start": "76000",
    "end": "117000"
  },
  {
    "text": "so let's start off with our overview so what why did we why did we want to do this talk well we",
    "start": "78479",
    "end": "84240"
  },
  {
    "text": "wanted to be able to collaborate successfully in both internal and open source projects",
    "start": "84240",
    "end": "90159"
  },
  {
    "text": "we had some challenges what were those challenges well collaborating needs to be transparent",
    "start": "90159",
    "end": "95280"
  },
  {
    "text": "consistent and rigorous testing kubernetes applications varies varies",
    "start": "95280",
    "end": "100720"
  },
  {
    "text": "all the time between per developer environment it can vary against the different configurations",
    "start": "100720",
    "end": "106399"
  },
  {
    "text": "that you have when set up for your environments and it's time and resource consuming to constantly spin up kubernetes",
    "start": "106399",
    "end": "112720"
  },
  {
    "text": "applications and kubernetes clusters every single time you make a single change",
    "start": "112720",
    "end": "118479"
  },
  {
    "start": "117000",
    "end": "144000"
  },
  {
    "text": "so yeah what we'll cover is basically a simple steps simple simple set of steps to create and automate",
    "start": "118640",
    "end": "123680"
  },
  {
    "text": "a homogeneous testing environment and we'll use kind to automatically run e2e tests across a common environment",
    "start": "123680",
    "end": "129840"
  },
  {
    "text": "and then we'll also automate the creation of this environment per perl crest and run the test suite before merging",
    "start": "129840",
    "end": "135760"
  },
  {
    "text": "and you might notice a lot of uh fun pictures from amsterdam as you know this conference was supposed",
    "start": "135760",
    "end": "141120"
  },
  {
    "text": "to be in amsterdam so try to keep the theme going strong so yeah we're going to talk about kind",
    "start": "141120",
    "end": "147280"
  },
  {
    "text": "now so kind is basically kubernetes and docker it's similar in usage to meaning something like mini cube or k3s",
    "start": "147280",
    "end": "153840"
  },
  {
    "text": "basically a different disk of of k3s of sorry kubernetes it's great for local",
    "start": "153840",
    "end": "160480"
  },
  {
    "text": "testing or testing even remotely in ci cd and if you want to learn more",
    "start": "160480",
    "end": "167599"
  },
  {
    "text": "you can go to kind.sigs.k s dot io um yeah all you need is docker and you",
    "start": "167599",
    "end": "173280"
  },
  {
    "text": "can spin up your own kubernetes cluster so yeah how do you actually do this so if you're on a mac or if you have brew",
    "start": "173280",
    "end": "180080"
  },
  {
    "text": "installed all you need to do is to brew install kind and then kind create cluster so it's extremely easy to get started",
    "start": "180080",
    "end": "186879"
  },
  {
    "text": "probably the lowest barrier of entry tool to kind of spin up your own container scheduler ever",
    "start": "186879",
    "end": "193519"
  },
  {
    "text": "it's very awesome and a really cool tool to use so this is kind of what it looks like when you start up so it pulls the",
    "start": "193519",
    "end": "200000"
  },
  {
    "text": "kubernetes version and prepares the nodes and then it starts up all the different components",
    "start": "200000",
    "end": "206799"
  },
  {
    "start": "205000",
    "end": "262000"
  },
  {
    "text": "so just a quick comparison you might be using another tool out there maybe k3s or mini cube so",
    "start": "206879",
    "end": "212239"
  },
  {
    "text": "i pulled up a quick comparison here chart from this blog post we found um",
    "start": "212239",
    "end": "219120"
  },
  {
    "text": "and basically compares all the different uh miniature versions of kubernetes pretty",
    "start": "219120",
    "end": "224400"
  },
  {
    "text": "much so for example there's a mini cube that that actually",
    "start": "224400",
    "end": "229680"
  },
  {
    "text": "requires the vm but it's a single node kubernetes itself they didn't change any of the kubernetes",
    "start": "229680",
    "end": "235040"
  },
  {
    "text": "code that's the main difference between k3s and mini cube k3s is actually a slimmed down version",
    "start": "235040",
    "end": "240879"
  },
  {
    "text": "of kubernetes they actually pulled out things like the the volume drivers you can only use csi um and they pulled",
    "start": "240879",
    "end": "248959"
  },
  {
    "text": "out some other things that are deprecated to basically lower the binary size so that it's very quick and a minimal version of",
    "start": "248959",
    "end": "254560"
  },
  {
    "text": "kubernetes and kind as we mentioned it's quick easy to deploy low barrier entry and great for",
    "start": "254560",
    "end": "260000"
  },
  {
    "text": "testing so let's jump into our automation and",
    "start": "260000",
    "end": "266320"
  },
  {
    "start": "262000",
    "end": "370000"
  },
  {
    "text": "our continuous integration today will be we have today we have a couple of goals that we wanted to achieve when we ran our tests",
    "start": "266320",
    "end": "273120"
  },
  {
    "text": "so the first goal is to run our validation test on new code changes that helps us reduce the amount of bugs and",
    "start": "273120",
    "end": "278960"
  },
  {
    "text": "validate before it hits production want to block merge uh to production if tests have failed",
    "start": "278960",
    "end": "284479"
  },
  {
    "text": "so if the test has failed you don't want to merge any broken code no inter no introduction of broken code into your main branch or a production",
    "start": "284479",
    "end": "290720"
  },
  {
    "text": "branch and you also want to hold the dev accountable to fix the issue",
    "start": "290720",
    "end": "296400"
  },
  {
    "text": "you also want to set up a pre-configured environment when testing this helps you allow to systematically",
    "start": "296400",
    "end": "301600"
  },
  {
    "text": "this helps you this allows you to systematically catch problems with your application uh with your application",
    "start": "301600",
    "end": "307280"
  },
  {
    "text": "logic and it helps you maintain consistency across the results that you receive from your tests",
    "start": "307280",
    "end": "312479"
  },
  {
    "text": "automate everything with event triggers that increases the frequency of your test runs that",
    "start": "312479",
    "end": "317600"
  },
  {
    "text": "makes it more repeatable and generally more efficient you don't want to spin up a test if it's just a simple code fix on a readme",
    "start": "317600",
    "end": "324160"
  },
  {
    "text": "but you want to spin up a test when it's a pull request against your production code",
    "start": "324160",
    "end": "329600"
  },
  {
    "text": "all of that is great but what's also top of mind even from an individual developer point of view or",
    "start": "329600",
    "end": "335039"
  },
  {
    "text": "from a enterprise point of view from our organization point of view is resource uh is costa sorry",
    "start": "335039",
    "end": "342160"
  },
  {
    "text": "it is the cost efficiency of using up resources and you don't want to reinvent the wheel",
    "start": "342160",
    "end": "347919"
  },
  {
    "text": "if somebody has already worked on something similar so what do you think about when you do that open source",
    "start": "347919",
    "end": "353759"
  },
  {
    "text": "open source comes into mind into my mind all the time especially because 90 of today's",
    "start": "353759",
    "end": "360000"
  },
  {
    "text": "software is composed of open source software you're using dependencies you're using scripts that people have worked on",
    "start": "360000",
    "end": "366479"
  },
  {
    "text": "so with that in mind what did we do next well we found an open source action that",
    "start": "366479",
    "end": "373680"
  },
  {
    "start": "370000",
    "end": "409000"
  },
  {
    "text": "spins up kubernetes spins up kind and darker for us sorry kind in kubernetes and docker for",
    "start": "373680",
    "end": "381280"
  },
  {
    "text": "us so with that we were able to find a pre-existing action i didn't have to",
    "start": "381280",
    "end": "386400"
  },
  {
    "text": "reinvent the wheel it's open source so i was able to go through the code make sure that it",
    "start": "386400",
    "end": "391440"
  },
  {
    "text": "works for our use case and we made sure that it's configurable so we can actually",
    "start": "391440",
    "end": "396479"
  },
  {
    "text": "implement our own yaml files make sure that we're using kubernetes version that we want to",
    "start": "396479",
    "end": "401919"
  },
  {
    "text": "so here's a quick link if you wanted to find the action that we used again it's open source and you can find",
    "start": "401919",
    "end": "407280"
  },
  {
    "text": "on the github marketplace so for our automation today we'll we'll",
    "start": "407280",
    "end": "413599"
  },
  {
    "start": "409000",
    "end": "474000"
  },
  {
    "text": "walk through some of the components that we'll be talking in our demo so we have our kitty cat dev over here",
    "start": "413599",
    "end": "420000"
  },
  {
    "text": "he introduces new code and creates a full request this pull request then triggers our",
    "start": "420000",
    "end": "425199"
  },
  {
    "text": "automation workflow that automation workflow spins up a build job and a publish job so we build",
    "start": "425199",
    "end": "430639"
  },
  {
    "text": "and publish it to dtr after that we spin up our kind creation uh our kind",
    "start": "430639",
    "end": "437520"
  },
  {
    "text": "cluster creation our kubernetes testing that's great but i also said that the",
    "start": "437520",
    "end": "442720"
  },
  {
    "text": "kind action was configurable second test against a kubernetes version well we use a matrix build to actually test against",
    "start": "442720",
    "end": "449039"
  },
  {
    "text": "three different kubernetes versions because i want my application to be able to run across all of these and be compatible",
    "start": "449039",
    "end": "455840"
  },
  {
    "text": "once we have all of the tests passing and we're confident that this is not going to break any of our production",
    "start": "455840",
    "end": "461039"
  },
  {
    "text": "code that's when we decide to merge we actually block the merge by implementing protective branches so we don't have to",
    "start": "461039",
    "end": "467199"
  },
  {
    "text": "merge so nobody will be merging code if the tests fail and speaking of testing let's jump into",
    "start": "467199",
    "end": "473280"
  },
  {
    "text": "what we'll be showing and testing today awesome so yeah now that we've covered basically uh",
    "start": "473280",
    "end": "479120"
  },
  {
    "start": "474000",
    "end": "548000"
  },
  {
    "text": "at a high level what's going to happen let's go into detail about testing and how you can actually test your kubernetes applications",
    "start": "479120",
    "end": "485680"
  },
  {
    "text": "so typically you'd want to do this with integration or etv tests if you're going through the hoops of spinning up a kubernetes",
    "start": "485680",
    "end": "491840"
  },
  {
    "text": "cluster or kind cluster um you'd want to use uh integration or e2e tests and the reason for this is if you have",
    "start": "491840",
    "end": "498160"
  },
  {
    "text": "maybe dependency between apps if you have like a database like mysql or cassandra or kafka or something",
    "start": "498160",
    "end": "504160"
  },
  {
    "text": "and you want to basically uh see how your code interacts with those applications",
    "start": "504160",
    "end": "509759"
  },
  {
    "text": "or if you want to see how your code interacts with a kubernetes object say your application actually needs to",
    "start": "509759",
    "end": "515440"
  },
  {
    "text": "read from the secret or read from a config map or something then you might want to actually do an e2e or integration test",
    "start": "515440",
    "end": "523200"
  },
  {
    "text": "but there are some there are some reasons as to why you might not want to actually use integration tests",
    "start": "523200",
    "end": "529040"
  },
  {
    "text": "it can be very resource and time intensive or basically unit tests can cover a lot of",
    "start": "529040",
    "end": "534240"
  },
  {
    "text": "business logic you don't need to spend three or four hours running all of your",
    "start": "534240",
    "end": "539279"
  },
  {
    "text": "unit tests within against uh against an actual kubernetes cluster because that would be way too",
    "start": "539279",
    "end": "544640"
  },
  {
    "text": "time-consuming and not very smart use of infrastructure",
    "start": "544640",
    "end": "549839"
  },
  {
    "start": "548000",
    "end": "645000"
  },
  {
    "text": "so an example of out there you can actually see for yourself is being used in production is uh the",
    "start": "550000",
    "end": "555519"
  },
  {
    "text": "kubernetes side team has something called csi release tools just a repo that has all the",
    "start": "555519",
    "end": "560959"
  },
  {
    "text": "release tools basically that we use to to basically test all the different repositories for kubernetes csi",
    "start": "560959",
    "end": "568720"
  },
  {
    "text": "and inside of there is something called pow.sh and what it does is it creates a kind cluster it deploys a",
    "start": "568720",
    "end": "574640"
  },
  {
    "text": "sample of csi driver and its side cars so basically it's dependencies and then it runs some tests against them",
    "start": "574640",
    "end": "582720"
  },
  {
    "text": "so basically it's an example the kubernetes team itself actually uses to do development and what we did actually",
    "start": "582720",
    "end": "590399"
  },
  {
    "text": "for our example today is we did something similar um we basically uh started a",
    "start": "590399",
    "end": "596720"
  },
  {
    "text": "works uh e2e tests um a regular works so it's a project that i work on in a is something",
    "start": "596720",
    "end": "603440"
  },
  {
    "text": "called pork security um basically prevents uh users unauthenticated users from accessing the",
    "start": "603440",
    "end": "609920"
  },
  {
    "text": "platform so you basically can't create a volume or mount the volume if you don't have uh",
    "start": "609920",
    "end": "615519"
  },
  {
    "text": "if you don't have the correct token secret um so that's kind of the test we're going to be going over and we'll",
    "start": "615519",
    "end": "620640"
  },
  {
    "text": "be testing using the porix csi driver which basically is a driver that allows",
    "start": "620640",
    "end": "626000"
  },
  {
    "text": "you to create storage uh storage volumes um",
    "start": "626000",
    "end": "632000"
  },
  {
    "text": "so yeah and open storage just so we're clear is the open source control plane for portworx so it's basically",
    "start": "632000",
    "end": "637519"
  },
  {
    "text": "all of the code that basically handles um like all the different control plane components it doesn't have the actual storage layer",
    "start": "637519",
    "end": "646560"
  },
  {
    "start": "645000",
    "end": "785000"
  },
  {
    "text": "so yeah let's go into our e2e test so basically the first step you'll see and actually when we talk",
    "start": "646560",
    "end": "653200"
  },
  {
    "text": "about the demo this is the same scenario that we're going to demo so basically the first step is to create a",
    "start": "653200",
    "end": "658959"
  },
  {
    "text": "kind cluster and inside of that kind cluster we're going to have a cube system space and then a user space as well",
    "start": "658959",
    "end": "667680"
  },
  {
    "text": "and then what we're going to do is deploy the forex csi driver that's going to be in the cube system space and all of its dependencies will",
    "start": "668640",
    "end": "674800"
  },
  {
    "text": "be there as well next we're going to create a token secret this basically is basically your",
    "start": "674800",
    "end": "679839"
  },
  {
    "text": "password and it's basically the the token that's required in order to authenticate with poll works",
    "start": "679839",
    "end": "688240"
  },
  {
    "text": "next we're going to create a storage class and the storage class refers to our porex csi driver",
    "start": "688240",
    "end": "694720"
  },
  {
    "text": "after that you're going to create a create a persistent volume that basically looks at that storage",
    "start": "694720",
    "end": "700560"
  },
  {
    "text": "class to get it's basically uh it's its parameters and basically you'll",
    "start": "700560",
    "end": "705600"
  },
  {
    "text": "create the persistent volume based on the storage class parameters",
    "start": "705600",
    "end": "710639"
  },
  {
    "text": "next we're going to create a pod that uses this for example a mysql pod and we're going to use the persistent",
    "start": "710639",
    "end": "716160"
  },
  {
    "text": "volume to store its data so the test scenario we have today is basically",
    "start": "716160",
    "end": "722399"
  },
  {
    "text": "the test that we want to cover and we want it is very crucial to the to the actual performance of px security",
    "start": "722399",
    "end": "729760"
  },
  {
    "text": "is that you shouldn't be able to create a a volume in a private system if you do not have a",
    "start": "729760",
    "end": "737680"
  },
  {
    "text": "token secret so in this case actually right here um",
    "start": "737680",
    "end": "745440"
  },
  {
    "text": "you'll notice that the test has failed and that's because there's no link between the storage class and the token",
    "start": "745440",
    "end": "750720"
  },
  {
    "text": "secret so in order to get this test to pass what we're going to have to do is create a link from the storage class",
    "start": "750720",
    "end": "756720"
  },
  {
    "text": "pointing to the token secret to basically tell our app to basically tell it to look for",
    "start": "756720",
    "end": "762880"
  },
  {
    "text": "the token secret so that pool works knows where to find the credentials",
    "start": "762880",
    "end": "767920"
  },
  {
    "text": "and then the test should pass once we actually edit the storage class to look at that token secret",
    "start": "767920",
    "end": "772959"
  },
  {
    "text": "and that's actually what we're going to demo right now so what we have is we're going to do a",
    "start": "772959",
    "end": "778880"
  },
  {
    "text": "screen share and i'm going to show you all my upload requests we have open already",
    "start": "778880",
    "end": "786399"
  },
  {
    "start": "785000",
    "end": "925000"
  },
  {
    "text": "so what we have here as you may have noticed this is open storage so it's basically",
    "start": "786399",
    "end": "792959"
  },
  {
    "text": "the control plane components it has the csi driver and everything inside of it so what we're going to do",
    "start": "792959",
    "end": "799040"
  },
  {
    "text": "is we're basically going to open a a little pr um inside of this pr we're just going to change",
    "start": "799040",
    "end": "804880"
  },
  {
    "text": "really quickly um and basically do change from debug f to info ref not the",
    "start": "804880",
    "end": "811279"
  },
  {
    "text": "biggest change in the world but for a demo it's nice and then what we're going to actually do is we're going to notice that the test",
    "start": "811279",
    "end": "817680"
  },
  {
    "text": "is failing because i've manually set the token secret to be invalid um and then so what happens actually as",
    "start": "817680",
    "end": "826000"
  },
  {
    "text": "a result is that the tests here are failing as you can see so it's preventing merging from",
    "start": "826000",
    "end": "831120"
  },
  {
    "text": "happening because we have protected branch which sarah's going to talk about in a little bit so basically what we do is we can bring",
    "start": "831120",
    "end": "837920"
  },
  {
    "text": "up this test and we can look inside and we can see oh what happens so run test failed so let's go inside of",
    "start": "837920",
    "end": "845680"
  },
  {
    "text": "run test and we can actually see that it created the secret created the storage class it created the",
    "start": "845680",
    "end": "852720"
  },
  {
    "text": "pvc however the pvc was not bound after 15 seconds so basically poll works wasn't able to",
    "start": "852720",
    "end": "860320"
  },
  {
    "text": "create the volume and it said who is this person trying to create a volume because you don't have the correct token",
    "start": "860320",
    "end": "866240"
  },
  {
    "text": "so i'm not going to let you create a token create a volume um so that's the reason for the test failing",
    "start": "866240",
    "end": "872560"
  },
  {
    "text": "so let's go ahead and actually fix that live um right now so what we're going to do is",
    "start": "872560",
    "end": "879519"
  },
  {
    "text": "inside of here we can actually just edit this so if we edit the file we can actually",
    "start": "879519",
    "end": "885920"
  },
  {
    "text": "just change this real quick to be a valid token secret",
    "start": "885920",
    "end": "891440"
  },
  {
    "text": "boom so now what we're going to do is just create commit that change",
    "start": "892079",
    "end": "899440"
  },
  {
    "text": "and now we just have our one change right here so the test should pass now so as you can see since we set up our",
    "start": "899440",
    "end": "906399"
  },
  {
    "text": "action to basically run on pull request open when you update or you send a new commit it'll basically",
    "start": "906399",
    "end": "912079"
  },
  {
    "text": "rerun the tests and see if they pass or not",
    "start": "912079",
    "end": "917040"
  },
  {
    "text": "awesome and then let's jump into a quick overview of what that will look like it just kicked off our build test here",
    "start": "917199",
    "end": "923040"
  },
  {
    "text": "and we can see that it's building running building and running our docker image builds so",
    "start": "923040",
    "end": "929680"
  },
  {
    "start": "925000",
    "end": "1230000"
  },
  {
    "text": "now that we are seeing this in action let's jump into the actual yaml so we can talk through that here we have our e",
    "start": "929680",
    "end": "937040"
  },
  {
    "text": "with kind yaml file this is our automated workflow as grant mentioned we're only running",
    "start": "937040",
    "end": "942399"
  },
  {
    "text": "this on pull request and specifically on pull request master the point the reason is",
    "start": "942399",
    "end": "947839"
  },
  {
    "text": "around this is we don't want to run our end-to-end testing every time there's a push or a small change we actually want",
    "start": "947839",
    "end": "953600"
  },
  {
    "text": "to run it only in pull request because that will be the time where new new code is being",
    "start": "953600",
    "end": "958800"
  },
  {
    "text": "introduced into a master branch in this case we're using our master branch as our production branch so we don't want to",
    "start": "958800",
    "end": "965519"
  },
  {
    "text": "merge any code that hasn't passed into any testing in the first place so now that we have our trigger here",
    "start": "965519",
    "end": "971920"
  },
  {
    "text": "let's jump into our different jobs so our jobs here we have two main jobs our build and our test job",
    "start": "971920",
    "end": "978959"
  },
  {
    "text": "in reality what we first what we have learned trying to achieve this um uh overall",
    "start": "978959",
    "end": "984880"
  },
  {
    "text": "workflow is that we originally had our build and test job only in a single job so it did builds and tests all in once",
    "start": "984880",
    "end": "991199"
  },
  {
    "text": "uh all at once what that really did not that why that really did not work is because the",
    "start": "991199",
    "end": "997839"
  },
  {
    "text": "testing and the build jobs had two functionalities the the reason for the build job was to run",
    "start": "997839",
    "end": "1003920"
  },
  {
    "text": "and sorry run up make docker build osd and that on",
    "start": "1003920",
    "end": "1008959"
  },
  {
    "text": "ultimately builds our image and then pushes it to quay in our second in our second job we",
    "start": "1008959",
    "end": "1015360"
  },
  {
    "text": "actually have our full-blown integration testing running with kind spinning up the cluster and running our test scripts",
    "start": "1015360",
    "end": "1021839"
  },
  {
    "text": "we split these up in the first place because our kind cluster creation and our tests",
    "start": "1021839",
    "end": "1028400"
  },
  {
    "text": "are going to be run against three different kubernetes version but when we build our our image we only",
    "start": "1028400",
    "end": "1035760"
  },
  {
    "text": "need to build it on a single on a single version so we're running ubuntu latest",
    "start": "1035760",
    "end": "1041199"
  },
  {
    "text": "for both of these but we did not need to spin up a docker sorry different kubernetes version to run our build job",
    "start": "1041199",
    "end": "1047600"
  },
  {
    "text": "but let's jump into our test job so you can see what we mean",
    "start": "1047600",
    "end": "1052640"
  },
  {
    "text": "so we have our test job we said that our test job needs our build job because our build job runs and validates our content and then",
    "start": "1052640",
    "end": "1059280"
  },
  {
    "text": "pushes the image to a dtr docker trusted registry registry to quay or to get her packages",
    "start": "1059280",
    "end": "1067280"
  },
  {
    "text": "wherever you want to store it but in this case we the test job needs the build job and similarly to above we're running in",
    "start": "1067280",
    "end": "1074400"
  },
  {
    "text": "ubuntu in this case we have configured a matrix build this allows us to concurrently run three",
    "start": "1074400",
    "end": "1081280"
  },
  {
    "text": "different versions of kubernetes and this is simply an environment variable that kicks off",
    "start": "1081280",
    "end": "1086320"
  },
  {
    "text": "three concurrent jobs we use this environment variable later on when we're setting up our kind",
    "start": "1086320",
    "end": "1091360"
  },
  {
    "text": "cluster as you see here this is similar to what we showed in the powerpoint but this has",
    "start": "1091360",
    "end": "1097120"
  },
  {
    "text": "the configuration that i mentioned uh we're using this open source action and configuring it with our specific use",
    "start": "1097120",
    "end": "1103200"
  },
  {
    "text": "cases so we named our cluster name we had our cluster name we set up our yamo and we are testing against the",
    "start": "1103200",
    "end": "1109200"
  },
  {
    "text": "different kubernetes versions using the matrix build with that matrix build in mind we then uh set it up correctly to spin",
    "start": "1109200",
    "end": "1117120"
  },
  {
    "text": "up all of our applications and then we have our test being run in this case here",
    "start": "1117120",
    "end": "1123840"
  },
  {
    "text": "so now that we've seen all of that let's go into a quick a quick overview of what the branch",
    "start": "1123840",
    "end": "1128880"
  },
  {
    "text": "protections rules look like so here we have our master branch this",
    "start": "1128880",
    "end": "1134640"
  },
  {
    "text": "is the name pattern that you couldn't decide on how you want to configure it in this case we call it master but you can have",
    "start": "1134640",
    "end": "1140480"
  },
  {
    "text": "a prod you can have release you can call it main you can have several types of branch",
    "start": "1140480",
    "end": "1145919"
  },
  {
    "text": "protections and we really encourage this because this will allow you to protect any changes that are",
    "start": "1145919",
    "end": "1151200"
  },
  {
    "text": "happening into that branch by validating and having somebody review it once you have these checks run then that",
    "start": "1151200",
    "end": "1158160"
  },
  {
    "text": "allows you to then merge the code into your production so in this case i'm requiring a pull",
    "start": "1158160",
    "end": "1164080"
  },
  {
    "text": "request review before merging so i'm only requiring one reviewer most of the times you probably want to have a",
    "start": "1164080",
    "end": "1169760"
  },
  {
    "text": "code owner that's more knowledgeable of the code changes that are happening and we're also",
    "start": "1169760",
    "end": "1175679"
  },
  {
    "text": "requiring a couple status checks so in this case we're running the build job so that's also required and then we also have our three test",
    "start": "1175679",
    "end": "1182960"
  },
  {
    "text": "jobs running against the three different kubernetes versions the reason why this is important is because",
    "start": "1182960",
    "end": "1188880"
  },
  {
    "text": "again we are compatible our application is supposed to be compatible against all of these and if that's not compatible against one",
    "start": "1188880",
    "end": "1195280"
  },
  {
    "text": "of these then it will be an issue so we don't want to merge that code into production you can configure to",
    "start": "1195280",
    "end": "1201039"
  },
  {
    "text": "allow different um other types of requirements you can have require commits and i know that's something that some open source",
    "start": "1201039",
    "end": "1208640"
  },
  {
    "text": "communities are doing today require linear history and this can include administrators so",
    "start": "1208640",
    "end": "1215200"
  },
  {
    "text": "now that i've gave given a quick overview of the branch protections and the kind yaml",
    "start": "1215200",
    "end": "1220240"
  },
  {
    "text": "let's go back into our pull request and see what's happening here",
    "start": "1220240",
    "end": "1225200"
  },
  {
    "text": "sweet so we just ran a couple of our components we see our setup kind job spun up",
    "start": "1227600",
    "end": "1234559"
  },
  {
    "start": "1230000",
    "end": "1340000"
  },
  {
    "text": "we have our start open storage job oh sorry start open storage step also",
    "start": "1234559",
    "end": "1240080"
  },
  {
    "text": "running and now we're running our environment checks so great do you want to talk a little bit about the",
    "start": "1240080",
    "end": "1246080"
  },
  {
    "text": "different uh checks that we're running through yeah so basically what we're doing now",
    "start": "1246080",
    "end": "1251919"
  },
  {
    "text": "here is uh we started open storage we started in the cube cube system space um after spinning up the kubernetes",
    "start": "1251919",
    "end": "1258720"
  },
  {
    "text": "cluster this is running kubernetes 1.16. next what we're doing actually is we're",
    "start": "1258720",
    "end": "1264720"
  },
  {
    "text": "checking to see if the environment is set up this is important because you can't run the test until you've ensured that",
    "start": "1264720",
    "end": "1270240"
  },
  {
    "text": "basically the environment is set up or else it basically won't ever run so what actually is happening live",
    "start": "1270240",
    "end": "1276000"
  },
  {
    "text": "now as you can see is that the containers are spinning up so open storage is zero out of two zero out of three",
    "start": "1276000",
    "end": "1281919"
  },
  {
    "text": "looks like open source just started two out of two and now we're running the tests because",
    "start": "1281919",
    "end": "1287120"
  },
  {
    "text": "everything is successfully up and checked to make sure and now we've created the token secret we've created",
    "start": "1287120",
    "end": "1294640"
  },
  {
    "text": "the storage class and we've created a pvc now we're basically um yeah test passed",
    "start": "1294640",
    "end": "1302559"
  },
  {
    "text": "luckily and then uh live demos are always nervous nervous",
    "start": "1302559",
    "end": "1308320"
  },
  {
    "text": "but yeah uh test passed it's all good um and yeah so everything looks good so what we did is",
    "start": "1308320",
    "end": "1314640"
  },
  {
    "text": "we introduced that fix um and it fixed everything and now the test is passing",
    "start": "1314640",
    "end": "1320640"
  },
  {
    "text": "and as you can see if you go back to the pr and refresh you can see that all of the",
    "start": "1320640",
    "end": "1327039"
  },
  {
    "text": "tests have passed um we just need to get someone to review this pull request before we can merge it but",
    "start": "1327039",
    "end": "1332320"
  },
  {
    "text": "that's for another day uh in this case i'll just do a quick review since i am the reviewer so we can merge",
    "start": "1332320",
    "end": "1338720"
  },
  {
    "text": "the code and you can see the change happening so awesome it looks good i'm going to approve this",
    "start": "1338720",
    "end": "1344840"
  },
  {
    "start": "1340000",
    "end": "1370000"
  },
  {
    "text": "exam great job grant i love the fixes that you made and now that we have all of our checks",
    "start": "1344840",
    "end": "1351039"
  },
  {
    "text": "have been uh all the changes have been approved by the reviewer all the checks have passed everything",
    "start": "1351039",
    "end": "1356480"
  },
  {
    "text": "that is required it has a little check mark next to it now we can completely uh merge the code",
    "start": "1356480",
    "end": "1363919"
  },
  {
    "text": "so let's jump into sorry let's jump back to our slides",
    "start": "1363919",
    "end": "1369760"
  },
  {
    "text": "so let's talk about our takeaways here so what did we learn today normal manual work you can decide on the",
    "start": "1369760",
    "end": "1376320"
  },
  {
    "start": "1370000",
    "end": "1645000"
  },
  {
    "text": "events that you want to trigger your automated workflows with deciding what type of events make best",
    "start": "1376320",
    "end": "1381520"
  },
  {
    "text": "make sense for your uh that suit the job that you need to run so in this case i have two examples",
    "start": "1381520",
    "end": "1387360"
  },
  {
    "text": "should i run this test on every push to main or should i run it on a specific push",
    "start": "1387360",
    "end": "1392880"
  },
  {
    "text": "domain in this case i decided to only run it against our branch our main branch and only our on our pull",
    "start": "1392880",
    "end": "1399919"
  },
  {
    "text": "request to our main branch as well when should i deploy to my my app to gke",
    "start": "1399919",
    "end": "1406000"
  },
  {
    "text": "well i don't want to deploy it every time somebody makes a push i don't want to deploy it every time somebody creates a pull request in this case i only want to deploy it",
    "start": "1406000",
    "end": "1412559"
  },
  {
    "text": "when i create a release and and that's how you can show it and this is similar way",
    "start": "1412559",
    "end": "1417600"
  },
  {
    "text": "this is very similar to what you could do with other automation tools as well you can use this in pipelines in jenkins pipelines or",
    "start": "1417600",
    "end": "1423279"
  },
  {
    "text": "traffic ci so next up after we decided what our",
    "start": "1423279",
    "end": "1428320"
  },
  {
    "text": "trigger was let's decide let's talk about our workflow our workflow here talks uh these are two examples of our",
    "start": "1428320",
    "end": "1435360"
  },
  {
    "text": "workflow i need to build my docker image and push a dtr that's one workflow and then the",
    "start": "1435360",
    "end": "1440559"
  },
  {
    "text": "other workflow was our kind workflow i want to set up kind spin up and run it run my test against that and i need",
    "start": "1440559",
    "end": "1447120"
  },
  {
    "text": "docker builds to be successful beforehand just to make sure that all the images that we're pulling are the latest code",
    "start": "1447120",
    "end": "1454640"
  },
  {
    "text": "we also decided to set up branch protections in these branch protections we decided oh we need",
    "start": "1454640",
    "end": "1460400"
  },
  {
    "text": "a code reviewer we need to have status checks and we also disabled force push we do not want any time",
    "start": "1460400",
    "end": "1466480"
  },
  {
    "text": "we don't want any anybody to erase any commits accidentally when they do a force push into our master branch",
    "start": "1466480",
    "end": "1473679"
  },
  {
    "text": "so let's do a quick recap our dev introduced some new code and created a",
    "start": "1473679",
    "end": "1479840"
  },
  {
    "text": "pr so that was an event trigger using the pull request events then we kicked off our first build job",
    "start": "1479840",
    "end": "1485840"
  },
  {
    "text": "following up with our kind of cluster creation job and with that second job we actually had",
    "start": "1485840",
    "end": "1491120"
  },
  {
    "text": "a matrix build that had three parallel jobs to test against all kubernetes versions and finally we had branch protection",
    "start": "1491120",
    "end": "1498159"
  },
  {
    "text": "rules already set where you can only merge your branch you can only merge your",
    "start": "1498159",
    "end": "1503360"
  },
  {
    "text": "branch changes into your master branch when the tests have passed and thanks to",
    "start": "1503360",
    "end": "1508799"
  },
  {
    "text": "grant being such a great coder all the tests passed and we're able to successfully were able to successfully uh merge that",
    "start": "1508799",
    "end": "1515440"
  },
  {
    "text": "code so lessons learned what were the lessons learned break down the build job and the kind",
    "start": "1515440",
    "end": "1521760"
  },
  {
    "text": "jobs into two separate ones that made that made it much easier to have a cleaner workflow and to have",
    "start": "1521760",
    "end": "1526880"
  },
  {
    "text": "different configurations for each of those jobs triggering end-to-end testing on only pr's to the master branch",
    "start": "1526880",
    "end": "1533120"
  },
  {
    "text": "you don't need to have end-to-end testing on every single push unless that pushes the master",
    "start": "1533120",
    "end": "1539600"
  },
  {
    "text": "use matrix builds to run your tests to validate against multiple kubernetes versions well in this case we had our application",
    "start": "1539600",
    "end": "1545760"
  },
  {
    "text": "running against three different kubernetes versions to make sure it's compatible across all three and lastly test against the same image",
    "start": "1545760",
    "end": "1552559"
  },
  {
    "text": "in all your workflows if you are building a brand new image during your workflow then you should use that exact same image you shouldn't have",
    "start": "1552559",
    "end": "1558720"
  },
  {
    "text": "to build it every single time you don't need to use a pre-existing one so why did we do",
    "start": "1558720",
    "end": "1564960"
  },
  {
    "text": "this overall simplified builds cleaner workflows are more efficient runs the end-to-end testing will otherwise be",
    "start": "1564960",
    "end": "1571360"
  },
  {
    "text": "efficient inefficient if you have them running per push using unnecessary using up unnecessary",
    "start": "1571360",
    "end": "1576400"
  },
  {
    "text": "resources having the concurrent testing with the same automation script made your life",
    "start": "1576400",
    "end": "1582320"
  },
  {
    "text": "as a developer a little easier because you don't have to write another automation script and it spun up everything based on our",
    "start": "1582320",
    "end": "1588080"
  },
  {
    "text": "existing configuration and at the end of the day you always want to save time and resources you",
    "start": "1588080",
    "end": "1594000"
  },
  {
    "text": "don't want to reinvent the wheel you don't want to talk about uh creating something from scratch when somebody else has already done that job",
    "start": "1594000",
    "end": "1600559"
  },
  {
    "text": "for you and if it's open source you can just use the open source projects and leverage them for your use case you can",
    "start": "1600559",
    "end": "1606880"
  },
  {
    "text": "contribute back when you find a bug you can contribute back if you want to enhance that open source project at the end of the day it's up to you as",
    "start": "1606880",
    "end": "1613760"
  },
  {
    "text": "a developer to decide you know what's the best solution that i need to achieve and this is the and you can and how can i do that in",
    "start": "1613760",
    "end": "1620240"
  },
  {
    "text": "an automated way in addition using uh you can use a",
    "start": "1620240",
    "end": "1625840"
  },
  {
    "text": "docker registry quay packages or whatever you want to manage your docker images with",
    "start": "1625840",
    "end": "1631440"
  },
  {
    "text": "and pull from that image because you want it to always be auditable and you can refer back to it if a change did",
    "start": "1631440",
    "end": "1638080"
  },
  {
    "text": "happen and you want and there was a breaking uh configuration change you can always refer back to it and analyze that",
    "start": "1638080",
    "end": "1643600"
  },
  {
    "text": "and use that image in your following um and your following tests so with that i'll pass it off oh",
    "start": "1643600",
    "end": "1651679"
  },
  {
    "start": "1645000",
    "end": "2026000"
  },
  {
    "text": "yeah so we're here we're done thanks everyone for listening uh let us know if you have any questions and",
    "start": "1651679",
    "end": "1657039"
  },
  {
    "text": "we'll go ahead and answer them thanks everyone",
    "start": "1657039",
    "end": "1661200"
  },
  {
    "text": "okay um so yeah let's we're just going to go through some of the questions that we have in the platform so let's see the first",
    "start": "1666000",
    "end": "1672720"
  },
  {
    "text": "one how you wrote the test to create storage class um i actually answered this",
    "start": "1672720",
    "end": "1678080"
  },
  {
    "text": "and you can actually check um the actual github code itself so just github.com open storage",
    "start": "1678080",
    "end": "1685679"
  },
  {
    "text": "um and all the code is in the demo folder there you can see the link in the q a section awesome so",
    "start": "1685679",
    "end": "1694799"
  },
  {
    "text": "i'll be answering alexander's question do you suggest to launch this per on the cicd pipeline on each commit or",
    "start": "1694799",
    "end": "1702320"
  },
  {
    "text": "only on pr or a specific branch um in this case we are only running it on pr to our master",
    "start": "1702320",
    "end": "1709679"
  },
  {
    "text": "branch we're not running in on each commit since it's end-to-end testing we figured",
    "start": "1709679",
    "end": "1714799"
  },
  {
    "text": "it's not necessary because it will use it too many resources",
    "start": "1714799",
    "end": "1720080"
  },
  {
    "text": "cool so another question we've been getting a lot of questions about the slides um and we we will be uploading them",
    "start": "1720480",
    "end": "1727840"
  },
  {
    "text": "after this talk we'll upload them on sket itself so if you go back to where you saw this talking",
    "start": "1727840",
    "end": "1733520"
  },
  {
    "text": "schedule you can find the slides there awesome so we have one more question uh",
    "start": "1733520",
    "end": "1739679"
  },
  {
    "text": "can we integrate the solutions with the rest of the ci tools like jenkins yes you can integrate the solution with any type of",
    "start": "1739679",
    "end": "1746080"
  },
  {
    "text": "ci tool um if you want to write your own pipelines and jenkins using jenkins files that's also a possibility",
    "start": "1746080",
    "end": "1752399"
  },
  {
    "text": "you can integrate that testing tools that that grant mentions during our session",
    "start": "1752399",
    "end": "1758399"
  },
  {
    "text": "in any type of ci tool that you want to today yep so we have a couple more questions",
    "start": "1758399",
    "end": "1764080"
  },
  {
    "text": "coming in um so the question is so this e3 testing is only for",
    "start": "1764080",
    "end": "1769120"
  },
  {
    "text": "infrastructure or is it also for application e2e testing the answer is it can be both if you",
    "start": "1769120",
    "end": "1775600"
  },
  {
    "text": "would like if your integration test may involve application logic and yeah",
    "start": "1775600",
    "end": "1781520"
  },
  {
    "text": "you could totally test both um with this method um this method basically just",
    "start": "1781520",
    "end": "1786799"
  },
  {
    "text": "shows you how you could spin up a cluster and run any set of tests it's up to you what you want to test",
    "start": "1786799",
    "end": "1792320"
  },
  {
    "text": "with this um if the test fails don't you need to",
    "start": "1792320",
    "end": "1798559"
  },
  {
    "text": "delete the pushed image from the registry um do you want to answer that question there yeah uh",
    "start": "1798559",
    "end": "1805440"
  },
  {
    "text": "you can you can delete it um you don't have to you can just put a new image with a new um version number that is based on",
    "start": "1805440",
    "end": "1814080"
  },
  {
    "text": "the commit or hash code that you're using or shop code that you're using um in this case deleting it will save",
    "start": "1814080",
    "end": "1820799"
  },
  {
    "text": "you some resources so yes you can clean it up afterwards if you want to refer back to it and understand why it failed",
    "start": "1820799",
    "end": "1826640"
  },
  {
    "text": "you can always pull that keep that image there and pull it uh locally so then you can run your own tests um locally you don't have to run it on",
    "start": "1826640",
    "end": "1832799"
  },
  {
    "text": "your ci pipeline yeah the next one is can this pattern be",
    "start": "1832799",
    "end": "1838080"
  },
  {
    "text": "used to test and validate kubernetes animals um yes definitely that's probably the most",
    "start": "1838080",
    "end": "1843679"
  },
  {
    "text": "useful one of the most useful use cases is actually interacting with kubernetes",
    "start": "1843679",
    "end": "1849279"
  },
  {
    "text": "through these tests um because you can't really do that easily through unit tests it's just not natural to do it that way",
    "start": "1849279",
    "end": "1856080"
  },
  {
    "text": "um so yeah you could totally do this use this pattern to test and validate kubernetes",
    "start": "1856080",
    "end": "1862320"
  },
  {
    "text": "what you would want to do is just in your test scripts whatever test testing framework you're using you could",
    "start": "1862320",
    "end": "1867919"
  },
  {
    "text": "just apply the ammos and basically validate that the expected",
    "start": "1867919",
    "end": "1873360"
  },
  {
    "text": "behavior is happening um yeah awesome so",
    "start": "1873360",
    "end": "1878880"
  },
  {
    "text": "i'll be answering hereman's question so are there any plans to for github actions to be multi-repo yes",
    "start": "1878880",
    "end": "1884799"
  },
  {
    "text": "they're open source so you can actually use them across any type of repos um you can",
    "start": "1884799",
    "end": "1890399"
  },
  {
    "text": "use them within your org you can have an org template that allows you to create actions",
    "start": "1890399",
    "end": "1895440"
  },
  {
    "text": "at the org level um so yes the answer is yes to all of the your questions uh they can be used",
    "start": "1895440",
    "end": "1901760"
  },
  {
    "text": "across multiple repos and they can be shared so then you don't have to reinvent the wheel rewriting an action every single",
    "start": "1901760",
    "end": "1907600"
  },
  {
    "text": "time yep so another quick question um can i get the github link of the demo",
    "start": "1907600",
    "end": "1914559"
  },
  {
    "text": "please um yeah we'll um i'll answer the uh i'll answer with the link there in a",
    "start": "1914559",
    "end": "1920559"
  },
  {
    "text": "second but it's basically uh yeah it's also in one of the other the other answers but i'll send you the link",
    "start": "1920559",
    "end": "1927279"
  },
  {
    "text": "in a second uh question on kinds are we using self-hosted gha running on kubernetes",
    "start": "1927279",
    "end": "1934480"
  },
  {
    "text": "pods will i be able to create the kinds in pod um kind of",
    "start": "1934480",
    "end": "1941679"
  },
  {
    "text": "using the self-hosted gdha not sure what the question is asking you",
    "start": "1941679",
    "end": "1947760"
  },
  {
    "text": "know um yeah i'm not sure what dha is but we only have a couple of uh seconds left so i think we need to",
    "start": "1947760",
    "end": "1956240"
  },
  {
    "text": "uh take this offline back to the slack channel so if you have any other questions we didn't get to all of these um please",
    "start": "1956240",
    "end": "1962960"
  },
  {
    "text": "feel free to message us on slack and we'll answer them there do you remember the github link really",
    "start": "1962960",
    "end": "1968320"
  },
  {
    "text": "quick before we close our session yeah um it's github.com yeah it's",
    "start": "1968320",
    "end": "1975279"
  },
  {
    "text": "s github.com it's s k h a l i f e slash open storage one word",
    "start": "1975279",
    "end": "1982799"
  },
  {
    "text": "and um inside of there you'll see a demo folder and i'll send that in the answer for the",
    "start": "1982799",
    "end": "1988720"
  },
  {
    "text": "q a there as well cool so yeah it looks like there's a couple more questions but unfortunately",
    "start": "1988720",
    "end": "1994960"
  },
  {
    "text": "we're going to have to end here again both of us are available",
    "start": "1994960",
    "end": "2000159"
  },
  {
    "text": "on the cncf slack so let us know if you have any questions there um do you want to what's your handle on",
    "start": "2000159",
    "end": "2006399"
  },
  {
    "text": "the cncf slack it's s khalifa yeah and mine's uh g griffiths so first letter my first name in the",
    "start": "2006399",
    "end": "2013039"
  },
  {
    "text": "last name um you can find that both of those and the talk details",
    "start": "2013039",
    "end": "2018960"
  },
  {
    "text": "so yeah thanks everyone and have a good kubecon thanks for attending a session",
    "start": "2018960",
    "end": "2028559"
  }
]