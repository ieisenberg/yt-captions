[
  {
    "start": "0",
    "end": "660000"
  },
  {
    "text": "first I'd like to thank everybody for joining us today welcome to today's webinar delivering progressive delivery",
    "start": "2120",
    "end": "7859"
  },
  {
    "text": "with service mesh I'm Taylor Wagner the operations analyst for CNCs I'll be",
    "start": "7859",
    "end": "14099"
  },
  {
    "text": "moderating today's webinar we would like to welcome our presenters today Andrew Jenkins CTO and Zak jewelry head of",
    "start": "14099",
    "end": "20279"
  },
  {
    "text": "marketing for ask the mesh before we get started there's a few housekeeping items we'd like to go over during the webinar",
    "start": "20279",
    "end": "27689"
  },
  {
    "text": "you are not able to talk as an attendee there is a Q&A box at the bottom of your zoom screen please feel free to drop in",
    "start": "27689",
    "end": "34410"
  },
  {
    "text": "your questions and we'll get to as many as we can at the end with that I'll hand",
    "start": "34410",
    "end": "39660"
  },
  {
    "text": "it over to Andrew and Zack to kick off today's presentation great thanks Taylor",
    "start": "39660",
    "end": "45500"
  },
  {
    "text": "actuary here had a marketing looking forward to spending a few minutes up",
    "start": "45500",
    "end": "50610"
  },
  {
    "text": "front and the presentation talking about press and delivery some of the concepts behind it why we think matters and why",
    "start": "50610",
    "end": "57660"
  },
  {
    "text": "we think the service mesh helps with that and then I will wait to the fun bit after that we'll Andrew we'll do a couple of demos showing how you can",
    "start": "57660",
    "end": "64559"
  },
  {
    "text": "actually use service mesh to deliver progressive delivery so progressive",
    "start": "64559",
    "end": "69630"
  },
  {
    "text": "delivery is an idea I should give credit where it's due that James governor of Redmond introduced a year and a half or",
    "start": "69630",
    "end": "76409"
  },
  {
    "text": "so ago there were a couple of companies that were doing progressive delivery we",
    "start": "76409",
    "end": "81930"
  },
  {
    "text": "works launched darkly the engineering team at Target we're using a stack of",
    "start": "81930",
    "end": "87180"
  },
  {
    "text": "tools to I would say do a new new method of CIC be around kubernetes things have",
    "start": "87180",
    "end": "94229"
  },
  {
    "text": "kind of changed the way we deliver applications now the micro service has become all the rage and the way you",
    "start": "94229",
    "end": "100700"
  },
  {
    "text": "build and deliver and deploy kubernetes based applications requires a little bit",
    "start": "100700",
    "end": "105810"
  },
  {
    "text": "different way of thinking and that's where per asset delivery comes in so these companies that I mentioned",
    "start": "105810",
    "end": "111000"
  },
  {
    "text": "launched darkly we works we're using tools like kubernetes get up service measure flags to roll out software",
    "start": "111000",
    "end": "118710"
  },
  {
    "text": "deploys to small sets of the users to see how those went and use the learnings from those deploys to you know the roll",
    "start": "118710",
    "end": "126479"
  },
  {
    "text": "back didn't go well or make changes based on what they were learning when",
    "start": "126479",
    "end": "131489"
  },
  {
    "text": "you combine these set of tools in do software delivery in this way it's really cool because progressive juggler",
    "start": "131489",
    "end": "137459"
  },
  {
    "text": "delivery means software deployment does not necessarily equal software activation which means that just because",
    "start": "137459",
    "end": "145110"
  },
  {
    "text": "your dev team is doing deploys doesn't mean you have to roll out those features to all your end users at once this is",
    "start": "145110",
    "end": "152519"
  },
  {
    "text": "very similar you know these thoughts from CI I like to think of this as CI 2.0 kind of the new requirements for how",
    "start": "152519",
    "end": "159390"
  },
  {
    "text": "you deliver software in the micro services world CI was really great for",
    "start": "159390",
    "end": "165090"
  },
  {
    "text": "the business because it gave the business away to limit the blast radius",
    "start": "165090",
    "end": "170159"
  },
  {
    "text": "around software deploys so deploys weren't as scary I think progressive delivery takes that",
    "start": "170159",
    "end": "175859"
  },
  {
    "text": "a step further by not only allowing you to turn hand grenades into firecrackers",
    "start": "175859",
    "end": "180900"
  },
  {
    "text": "but also being able to put those firecrackers out very quickly if there are a problem and even put a band-aid if",
    "start": "180900",
    "end": "187200"
  },
  {
    "text": "they have one of those firecrackers causes a wound one of the really neat",
    "start": "187200",
    "end": "192930"
  },
  {
    "text": "things about for instant delivery is the business actually cares about it this controlled empowerment idea is around",
    "start": "192930",
    "end": "199590"
  },
  {
    "text": "the sense that the business can say when it's acceptable for new code to hit the end user so dev teams are not",
    "start": "199590",
    "end": "206160"
  },
  {
    "text": "constrained by the business they can still do rapid iterative development but the business can say we're gonna package",
    "start": "206160",
    "end": "213389"
  },
  {
    "text": "that all up and we can wait for six ten twelve deploys until we activate that for the end user this is really cool",
    "start": "213389",
    "end": "220530"
  },
  {
    "text": "because it gives the business psychological safety around deploys and I think rapid software development is",
    "start": "220530",
    "end": "227639"
  },
  {
    "text": "not just scary for the business side of the house anymore the deployments not",
    "start": "227639",
    "end": "232739"
  },
  {
    "text": "the same as release service activation is not the same as deployment and devs can deploy a service and it can ship but",
    "start": "232739",
    "end": "239099"
  },
  {
    "text": "it doesn't mean it hits all your end users and this is a great way so the business side of the house the",
    "start": "239099",
    "end": "244799"
  },
  {
    "text": "application owner doesn't have to put any handcuffs on the dev team that keep moving at the pace they want to move at",
    "start": "244799",
    "end": "250739"
  },
  {
    "text": "and the you know the business doesn't have to be quite as terrified as it has",
    "start": "250739",
    "end": "255900"
  },
  {
    "text": "been of that in the past so there there",
    "start": "255900",
    "end": "262710"
  },
  {
    "text": "are a couple different pieces here one is psychological safety for the business I",
    "start": "262710",
    "end": "269110"
  },
  {
    "text": "talked about in the last slide the other one that's really neat is the fact that this provides a much better developer",
    "start": "269110",
    "end": "274870"
  },
  {
    "text": "experience decoupling releases from rolling out any features the customers is a really good way for the business to",
    "start": "274870",
    "end": "281800"
  },
  {
    "text": "be satisfied without forcing dev teams to comply with business controls and",
    "start": "281800",
    "end": "288039"
  },
  {
    "text": "concerns so that means app owners can say when new features hit users and that",
    "start": "288039",
    "end": "294430"
  },
  {
    "text": "means the business can not only be feel better about the way things are getting",
    "start": "294430",
    "end": "299650"
  },
  {
    "text": "rolled out but it makes a lot easier to meet a lot of security and compliance concerns by being able to put some",
    "start": "299650",
    "end": "307270"
  },
  {
    "text": "guardrails on the way your developers are rolling out new deployments so there",
    "start": "307270",
    "end": "313300"
  },
  {
    "text": "are as I said a few pieces to progress a delivery the part we're going to focus on the second half of this webcast is",
    "start": "313300",
    "end": "321010"
  },
  {
    "text": "about how service mission navels presses delivery feature flags and rolling",
    "start": "321010",
    "end": "326199"
  },
  {
    "text": "deploys or some things launch dark that I mentioned earlier is a great tool to use feature flags for a progressive",
    "start": "326199",
    "end": "331210"
  },
  {
    "text": "delivery one of the things that we have been using with our customers is a service mission and it allows us to do",
    "start": "331210",
    "end": "337750"
  },
  {
    "text": "progressive delivery things like canary and traffic mirroring which are really cool because you can roll out an",
    "start": "337750",
    "end": "343360"
  },
  {
    "text": "experimental service see how that service is performing with a set of users and use those metrics to decide if",
    "start": "343360",
    "end": "349630"
  },
  {
    "text": "you rolled out further or roll it back and so with that I think that I will turn it over to Andrew here to deep dive",
    "start": "349630",
    "end": "357310"
  },
  {
    "text": "a little bit more into how you can use canary and traffic mirroring and do a couple demos yes sounds great",
    "start": "357310",
    "end": "364360"
  },
  {
    "text": "thanks Zack so let's go ahead let's take over from where Zack was so so you know",
    "start": "364360",
    "end": "376620"
  },
  {
    "text": "is actually mentioned right you've got the you've got a bunch of sort of",
    "start": "376620",
    "end": "383409"
  },
  {
    "text": "components to progressive delivery it's all about decoupling the the deployment",
    "start": "383409",
    "end": "390699"
  },
  {
    "text": "of software from the way that users for the counter so that way businesses would make",
    "start": "390699",
    "end": "397830"
  },
  {
    "text": "trade-offs and that can involve kind of independently of a decouple and let",
    "start": "397830",
    "end": "403770"
  },
  {
    "text": "software teams go as fast as they as they can however you still need some stuff to manage how you're going to",
    "start": "403770",
    "end": "410340"
  },
  {
    "text": "actually activate it for new users how you're going to deploy it and so part of",
    "start": "410340",
    "end": "415680"
  },
  {
    "text": "that story is around sort of these news with deployment techniques for deciding",
    "start": "415680",
    "end": "422130"
  },
  {
    "text": "how you're going to shift traffic and expose it to users so what we're going to talk about today sort of demo is",
    "start": "422130",
    "end": "429860"
  },
  {
    "text": "canary deployments and traffic mirroring which is a kind of a new thing that a",
    "start": "429860",
    "end": "436080"
  },
  {
    "text": "service mesh lets you do that's as some interesting sort of opportunities for improving the way that",
    "start": "436080",
    "end": "443220"
  },
  {
    "text": "you you might have used or heard about Canaries before so what we're going to",
    "start": "443220",
    "end": "449400"
  },
  {
    "text": "demo here is using a progressive delivery operator called flagger and so",
    "start": "449400",
    "end": "455460"
  },
  {
    "text": "this is kind of the flagger architecture and so flaggers job is to you know sort",
    "start": "455460",
    "end": "462780"
  },
  {
    "text": "of employee of canary and then shift traffic to that canary based on",
    "start": "462780",
    "end": "468770"
  },
  {
    "text": "different criteria for this demo we're going to step through you know ramping",
    "start": "468770",
    "end": "474870"
  },
  {
    "text": "some random subset of traffic there are other options as well and the and then",
    "start": "474870",
    "end": "481500"
  },
  {
    "text": "from flagger observes what happens to that you know that new canary service",
    "start": "481500",
    "end": "487260"
  },
  {
    "text": "compares the performance of the canary to the primary service and continues with its progressive deployment and",
    "start": "487260",
    "end": "494580"
  },
  {
    "text": "activation of the canary service as long as that's healthy and if it becomes unhealthy if the canary is now",
    "start": "494580",
    "end": "501390"
  },
  {
    "text": "performing out of spec relative to the primary or relative to absolute markers",
    "start": "501390",
    "end": "506880"
  },
  {
    "text": "then you can say okay wait hold on this activation is failing and so we're gonna we're gonna roll back to the primary",
    "start": "506880",
    "end": "513900"
  },
  {
    "text": "we're going to cancel this activation and we're going to let somebody figure out what's wrong wait for a new",
    "start": "513900",
    "end": "521250"
  },
  {
    "text": "candidate version that we can we can try activating along those same lines so and",
    "start": "521250",
    "end": "528030"
  },
  {
    "text": "the the service mesh tie in here is that for actually choosing what traffic goes to",
    "start": "528030",
    "end": "536730"
  },
  {
    "text": "the primary and what traffic goes to the Canary you can use a service mesh to do that kind of traffic shifting and then",
    "start": "536730",
    "end": "544260"
  },
  {
    "text": "later we'll see how you can also do something called traffic mirroring that will let you do a little bit of both",
    "start": "544260",
    "end": "550850"
  },
  {
    "text": "before you sort of activate the canary at all and we'll talk about why that's",
    "start": "550850",
    "end": "556920"
  },
  {
    "text": "that's good or bad so this is a this is an example of a canary deployment",
    "start": "556920",
    "end": "563610"
  },
  {
    "text": "through a time line and so what we're looking at here is we've got an old",
    "start": "563610",
    "end": "570780"
  },
  {
    "text": "version of service deployed and fully activated 100% of traffic is going to",
    "start": "570780",
    "end": "577980"
  },
  {
    "text": "the old version of the service we've got a new version it's passed you know our continuous integration tests it's you",
    "start": "577980",
    "end": "585480"
  },
  {
    "text": "know we're ready to go we're ready to actually use this guy and its deployed",
    "start": "585480",
    "end": "590850"
  },
  {
    "text": "it's up and running and and so now we're going to do this sort of progressive activation piece and so what we're gonna",
    "start": "590850",
    "end": "597150"
  },
  {
    "text": "do here is you can see we're going to start by shifting some traffic to the new service and then we're going to",
    "start": "597150",
    "end": "604380"
  },
  {
    "text": "pause for a while and measure this and we're going to confirm that the new service is performing successfully and",
    "start": "604380",
    "end": "611550"
  },
  {
    "text": "if that's if that is true then we'll keep going and shift a little bit more",
    "start": "611550",
    "end": "616980"
  },
  {
    "text": "and then you know we'll sort of proceed on and on through the progressive deployment until we decide ok you know",
    "start": "616980",
    "end": "623790"
  },
  {
    "text": "for our activation thresholds we've shifted traffic over this new service it's performing healthy grade and we can",
    "start": "623790",
    "end": "631770"
  },
  {
    "text": "go ahead and complete the activation for all users and shift 100% of traffic to the new service so this is this kind of",
    "start": "631770",
    "end": "638520"
  },
  {
    "text": "like shift measure shift measure or sort of loop and the the service mesh is",
    "start": "638520",
    "end": "644160"
  },
  {
    "text": "involved in shifting traffic to the new service as well as collecting the measurements in a way that we can we can",
    "start": "644160",
    "end": "650340"
  },
  {
    "text": "compare so at this point I'm going to shift over to the demo and go through",
    "start": "650340",
    "end": "656430"
  },
  {
    "text": "we'll sort of see this in action so let's I'm going to get out of here so",
    "start": "656430",
    "end": "668130"
  },
  {
    "start": "660000",
    "end": "1358000"
  },
  {
    "text": "I'm going to go through this demo I'll copy this URL here and slap it down in",
    "start": "668130",
    "end": "675630"
  },
  {
    "text": "the chat you've been playing at home or try this out yourself with you know the",
    "start": "675630",
    "end": "681800"
  },
  {
    "text": "examples on if you follow that link and",
    "start": "681800",
    "end": "689240"
  },
  {
    "text": "so of god make sure Prometheus is up and going",
    "start": "689420",
    "end": "695279"
  },
  {
    "text": "alright and I'm gonna shrink this so that we can see sort of just the current amount of time here so right now I've",
    "start": "695279",
    "end": "702720"
  },
  {
    "text": "got my old service running this is it's taking all the requests currently and",
    "start": "702720",
    "end": "708390"
  },
  {
    "text": "nothing is shifting over to the new service and what we're going to do is",
    "start": "708390",
    "end": "714290"
  },
  {
    "text": "I've got so this is a table we'll watch",
    "start": "714290",
    "end": "719520"
  },
  {
    "text": "this is the flagger operator and it's going to tell us what it's doing and why it just was step through here and then",
    "start": "719520",
    "end": "726510"
  },
  {
    "text": "the I've got what is called a canary resource and this is how you tell",
    "start": "726510",
    "end": "734160"
  },
  {
    "text": "flagger what traffic to shift where how to work through this this progressive",
    "start": "734160",
    "end": "740400"
  },
  {
    "text": "delivery scenario and so this this canary is going to say hey every 30",
    "start": "740400",
    "end": "746220"
  },
  {
    "text": "seconds we're going to move one more step through our progressive delivery",
    "start": "746220",
    "end": "751350"
  },
  {
    "text": "our canary deployment and what we're going to do is we're going to compare the request success rate and the request",
    "start": "751350",
    "end": "758850"
  },
  {
    "text": "duration between these two the primary service and the new canary service these",
    "start": "758850",
    "end": "765510"
  },
  {
    "text": "are handles for cans from Prometheus queries inside a flagger that go and",
    "start": "765510",
    "end": "771810"
  },
  {
    "text": "look at the service mesh underneath like Aspen mash that is collecting the",
    "start": "771810",
    "end": "777029"
  },
  {
    "text": "metrics from the scenario deployment and then here we're going to say we're going to do every step is going to be adding",
    "start": "777029",
    "end": "784260"
  },
  {
    "text": "10% of traffic shift and this version we're not going to do the",
    "start": "784260",
    "end": "789810"
  },
  {
    "text": "the mirroring stuff that we'll talk about later so we've got mirror sentinels so what we've got right now is",
    "start": "789810",
    "end": "801269"
  },
  {
    "text": "we're running a basic primary service version two point one point one we've",
    "start": "801269",
    "end": "807029"
  },
  {
    "text": "got our canary configured flagger is sitting there ready to go and so what we'll do is we will try to update this",
    "start": "807029",
    "end": "814709"
  },
  {
    "text": "image to be a new version two point one point two and I'm going to do this manually and directly in the demo but",
    "start": "814709",
    "end": "821970"
  },
  {
    "text": "you know in production usage this is driven by whatever sort of your deployment scenario is if you're using",
    "start": "821970",
    "end": "828899"
  },
  {
    "text": "you know get ops then it's your get ops operator for configuring this maybe it's",
    "start": "828899",
    "end": "834240"
  },
  {
    "text": "just you know a CD system that's driving this for you whatever it is but for the purposes of this demo we're just going",
    "start": "834240",
    "end": "840180"
  },
  {
    "text": "to play around with with updating this image directly so I'm taking the place of you know your good ops operator and",
    "start": "840180",
    "end": "847139"
  },
  {
    "text": "I've just said okay great we're we're now saying that we want to try this candidate image pot info two",
    "start": "847139",
    "end": "852959"
  },
  {
    "text": "dot one dot two and we've got the little canned Watchers that we can kind of see",
    "start": "852959",
    "end": "859019"
  },
  {
    "text": "what's what's going on here so flagger has noticed the new revision detected",
    "start": "859019",
    "end": "864059"
  },
  {
    "text": "and so it's deploying some two point one point two pods and it's going to wait",
    "start": "864059",
    "end": "869970"
  },
  {
    "text": "for those to get started and show up but right now it's still saying hey all the traffic is going to go to this this",
    "start": "869970",
    "end": "876120"
  },
  {
    "text": "primary version of the service so we'll wait for just a bit and now the the two",
    "start": "876120",
    "end": "882660"
  },
  {
    "text": "point one point two pod is actually available it's a pretty soon your flag are noticed and it started shifting some",
    "start": "882660",
    "end": "889529"
  },
  {
    "text": "traffic 90/10 between the canary service and the pod and the primary service so I",
    "start": "889529",
    "end": "897240"
  },
  {
    "text": "will go ahead and we can take a look over here and Prometheus can lag just a little bit I'll go ahead and load this",
    "start": "897240",
    "end": "903269"
  },
  {
    "text": "guy we can see that there's a little blip of traffic starting to go over to",
    "start": "903269",
    "end": "909179"
  },
  {
    "text": "the the canary version of the service you can see okay now we're stepping and",
    "start": "909179",
    "end": "915209"
  },
  {
    "text": "stepping it up and if we flip over here we can see you know flag are saying okay yeah we're getting some success so",
    "start": "915209",
    "end": "921770"
  },
  {
    "text": "it's starting to shift you know 80/20 it will go to 70/30 overtime and then we'll",
    "start": "921770",
    "end": "928610"
  },
  {
    "text": "end up with you know in this case canary version of the service should hopefully",
    "start": "928610",
    "end": "934610"
  },
  {
    "text": "be happy and we will say okay great this two point one point two version is our",
    "start": "934610",
    "end": "940340"
  },
  {
    "text": "new primary version and complete the the deployment to go back over here and a",
    "start": "940340",
    "end": "946630"
  },
  {
    "text": "little bit more the traffic continuing to step up on the the canary version of",
    "start": "946630",
    "end": "952760"
  },
  {
    "text": "the service and starts with marching down on the primary version of the service keep shifting traffic and this",
    "start": "952760",
    "end": "962180"
  },
  {
    "text": "it's for the purpose of the demo you know I've got a pretty quick ramp here 30 seconds only on on each sort of stage",
    "start": "962180",
    "end": "970450"
  },
  {
    "text": "that's to make the demo go fast enough that it's you know interesting to watch",
    "start": "970450",
    "end": "976490"
  },
  {
    "text": "in production you're probably looking at you know letting this soak for quite a",
    "start": "976490",
    "end": "982820"
  },
  {
    "text": "bit longer depending on how rapidly you sort of do these these these deployments",
    "start": "982820",
    "end": "989080"
  },
  {
    "text": "right he's continuing is from March more",
    "start": "989080",
    "end": "994130"
  },
  {
    "text": "and more traffic shifting to the canary version of the service and less and less",
    "start": "994130",
    "end": "1000040"
  },
  {
    "text": "the primary version of the service",
    "start": "1000040",
    "end": "1003630"
  },
  {
    "text": "and we're finally at 5050 and so this",
    "start": "1007660",
    "end": "1013220"
  },
  {
    "text": "means that you know flagger has now decided that hey everything's good and",
    "start": "1013220",
    "end": "1019370"
  },
  {
    "text": "we're ready to go ahead and make two point one point to the new versions this is a successful canary deployment from",
    "start": "1019370",
    "end": "1025720"
  },
  {
    "text": "flagger and so it's going to update the primary to be our new two point one point two",
    "start": "1025720",
    "end": "1030740"
  },
  {
    "text": "version and it says you know it's a finalizing this canary getting",
    "start": "1030740",
    "end": "1036800"
  },
  {
    "text": "everything else done yeah so here goes shifting all traffic over to primary and",
    "start": "1036800",
    "end": "1042199"
  },
  {
    "text": "then it'll start you know the canary is now ready to be used again for the next",
    "start": "1042200",
    "end": "1048730"
  },
  {
    "text": "sort of Kanak canary to plan and so we'll see here take a little while for",
    "start": "1048730",
    "end": "1055040"
  },
  {
    "text": "the Prometheus metrics to soak through but then we'll go back to the stage where all the traffic is going to the",
    "start": "1055040",
    "end": "1061670"
  },
  {
    "text": "primary you know the primary is now new it's that two point one point two version of the service",
    "start": "1061670",
    "end": "1068500"
  },
  {
    "text": "there you go so now it's all shifted over traffic is is totally shifted to",
    "start": "1068500",
    "end": "1073539"
  },
  {
    "text": "the primary okay so that's a successful canary canary deployment with traffic",
    "start": "1073539",
    "end": "1080860"
  },
  {
    "text": "shifting I can show you the next one here is what happens on failure and so",
    "start": "1080860",
    "end": "1089889"
  },
  {
    "text": "what happens on failure that's pretty cool is so we can shift we can measure you can say oh wait this traffic is not",
    "start": "1089889",
    "end": "1097240"
  },
  {
    "text": "not as healthy as the old traffic and so we should actually roll back and sort of",
    "start": "1097240",
    "end": "1103720"
  },
  {
    "text": "step through that scenario now and the one thing that I know I could watch out for here is that I always put long",
    "start": "1103720",
    "end": "1113070"
  },
  {
    "text": "deployment let me make sure there we go so what I'm going to do is I'm going to",
    "start": "1113070",
    "end": "1118450"
  },
  {
    "text": "try to playing an image that I've configured that always gives back an",
    "start": "1118450",
    "end": "1123700"
  },
  {
    "text": "error response so this is a imagine this is a busted build that somehow slipped through CI",
    "start": "1123700",
    "end": "1128919"
  },
  {
    "text": "and it's got some bug where it responds with failures to just you know some some",
    "start": "1128919",
    "end": "1134649"
  },
  {
    "text": "subset of requests and so you can now detect this with the canary and we'll",
    "start": "1134649",
    "end": "1140230"
  },
  {
    "text": "see how by doing it with traffic shifting or some other sort of thing you can limit just as Zack was saying you",
    "start": "1140230",
    "end": "1146799"
  },
  {
    "text": "can limit this the impact of letting one of these broken deployments you know it",
    "start": "1146799",
    "end": "1152710"
  },
  {
    "text": "doesn't have to be activated for for all users and you can detect it quickly rollback automatically so I'm going to",
    "start": "1152710",
    "end": "1161559"
  },
  {
    "text": "go and try and deploy that guy and let me flip back to my launch loop here and",
    "start": "1161559",
    "end": "1167860"
  },
  {
    "text": "we can see okay I've told you know I'm pretending to the CIA or get-ups",
    "start": "1167860",
    "end": "1173460"
  },
  {
    "text": "operator again here and I've said okay we're going to try to playing this new image and so once",
    "start": "1173460",
    "end": "1180690"
  },
  {
    "text": "Liger notices this guy he's gonna go ahead and start scaling that up there",
    "start": "1180690",
    "end": "1186669"
  },
  {
    "text": "you go so flagger bugger notices flaggers saying okay cool i'm going to execute this canary now let's go ahead",
    "start": "1186669",
    "end": "1193090"
  },
  {
    "text": "and scale up that container get it to be available and then start",
    "start": "1193090",
    "end": "1198950"
  },
  {
    "text": "shifting some traffic you",
    "start": "1198950",
    "end": "1205900"
  },
  {
    "text": "okay so now that the new candidate billet is available and flagger is",
    "start": "1208240",
    "end": "1217580"
  },
  {
    "text": "noticed flagger is shifting you know ninety ten on the traffic here in here",
    "start": "1217580",
    "end": "1222830"
  },
  {
    "text": "we should see something a little bit different which is",
    "start": "1222830",
    "end": "1228370"
  },
  {
    "text": "so this this top plot will show only",
    "start": "1232240",
    "end": "1239140"
  },
  {
    "text": "successful traffic that didn't have 500s and down here I'll show you traffic that does have 500 so we'll see",
    "start": "1239140",
    "end": "1246800"
  },
  {
    "text": "a some amount of traffic shifting from the primary over so here it goes you see a little dip there you don't see this",
    "start": "1246800",
    "end": "1253280"
  },
  {
    "text": "count up in this view because this is all these are all errors but what you'll see here is there are now a high rate of",
    "start": "1253280",
    "end": "1260059"
  },
  {
    "text": "errors coming out of out of this service if you go over to flagger we'll see oops",
    "start": "1260059",
    "end": "1267770"
  },
  {
    "text": "halt pot info test advancement success rate is less than 99 percent so this is",
    "start": "1267770",
    "end": "1273620"
  },
  {
    "text": "not happy so we're not going to progress and fire will sit there it's going to try a couple times and then say that",
    "start": "1273620",
    "end": "1281090"
  },
  {
    "text": "this is all busted and it will roll it will just sort of shift traffic back 100",
    "start": "1281090",
    "end": "1287870"
  },
  {
    "text": "percent two primary zero percent to canary and it will mark this canary as failed and so if you're an operator you",
    "start": "1287870",
    "end": "1295820"
  },
  {
    "text": "can go look at you know why what happened to this build why were there all of these errors and",
    "start": "1295820",
    "end": "1301160"
  },
  {
    "text": "then you can you just continue so the next time you have a new build that hopefully has this bug fixed then you",
    "start": "1301160",
    "end": "1309110"
  },
  {
    "text": "deploy that build and flagger will repeat but be happy with the canary that",
    "start": "1309110",
    "end": "1314510"
  },
  {
    "text": "time and then do a successful delivery so flagger - now said Oh yep this is no",
    "start": "1314510",
    "end": "1320600"
  },
  {
    "text": "good routes you know 100 zero back and then left us a note that the canary has",
    "start": "1320600",
    "end": "1327710"
  },
  {
    "text": "failed and now we can go take action but we've automatically rolled back so our",
    "start": "1327710",
    "end": "1333320"
  },
  {
    "text": "production deployment all of our users are seeing responses from 2.1 the",
    "start": "1333320",
    "end": "1338540"
  },
  {
    "text": "healthy two point one point two deployment and so now we can pause you",
    "start": "1338540",
    "end": "1343820"
  },
  {
    "text": "know we don't have to panic we can take our time to figure out exactly what home",
    "start": "1343820",
    "end": "1349090"
  },
  {
    "text": "so that's that's neat hope it you've got",
    "start": "1349090",
    "end": "1354679"
  },
  {
    "text": "you know traffic all back to the primary we want to talk about something",
    "start": "1354679",
    "end": "1360910"
  },
  {
    "start": "1358000",
    "end": "1640000"
  },
  {
    "text": "something that you know we when we saw this you know we thought that service fish an opportunity to do something",
    "start": "1360910",
    "end": "1366520"
  },
  {
    "text": "pretty cool and so we did an experiment as adness to flagger and this is not",
    "start": "1366520",
    "end": "1372920"
  },
  {
    "text": "committed to upstream flagger yet because it's not ready we haven't",
    "start": "1372920",
    "end": "1378050"
  },
  {
    "text": "figured out enough about how other service meshes do this sort of thing there's some caveats that we'll go",
    "start": "1378050",
    "end": "1383360"
  },
  {
    "text": "through but this is the the sort of traffic mirror in case the source code is available look if you go to that demo",
    "start": "1383360",
    "end": "1389360"
  },
  {
    "text": "you can see the source code it's just this this part this mirroring part is not really probably ready for production",
    "start": "1389360",
    "end": "1396320"
  },
  {
    "text": "usage yet and we'd like to get it upstream into flagger so that it's available for everybody so traffic",
    "start": "1396320",
    "end": "1402290"
  },
  {
    "text": "mirroring is cool because it's a little bit of a difference so in this mirror",
    "start": "1402290",
    "end": "1409010"
  },
  {
    "text": "increase stage we're going to actually duplicate the request one copy is going to go to our primary and one copy is",
    "start": "1409010",
    "end": "1416000"
  },
  {
    "text": "going to go to the canary the user sees only the response from the primary so the service match is going to take care",
    "start": "1416000",
    "end": "1421880"
  },
  {
    "text": "of copying these requests and it's going to take care of taking the response back from the primary and sending it on to",
    "start": "1421880",
    "end": "1428600"
  },
  {
    "text": "the user for the duplicate that it's sent to the canary all it's going to do",
    "start": "1428600",
    "end": "1433820"
  },
  {
    "text": "is collect the response drop the response on the floor but still collect",
    "start": "1433820",
    "end": "1439940"
  },
  {
    "text": "a metrics and statistics about how long it took and about whether it was a success or a failure but then it's not",
    "start": "1439940",
    "end": "1447530"
  },
  {
    "text": "going to send that it's not going to send the actual response on to anybody like the end user it's just going to kind of drop it on the floor so what",
    "start": "1447530",
    "end": "1455240"
  },
  {
    "text": "this enables that's pretty cool is that if the canary is a bad release you can",
    "start": "1455240",
    "end": "1460670"
  },
  {
    "text": "detect it without actually sending any bad responses back to the end-users so",
    "start": "1460670",
    "end": "1466490"
  },
  {
    "text": "in that traffic shifting case you know we said okay we're going to shift 10% of traffic to the to the canary bill right",
    "start": "1466490",
    "end": "1475430"
  },
  {
    "text": "and so that meant that while we have that deployment going on and we were in",
    "start": "1475430",
    "end": "1480500"
  },
  {
    "text": "that 90 but 10% of our users were getting those bad responses and that's a lot better",
    "start": "1480500",
    "end": "1487250"
  },
  {
    "text": "than a hundred percent right this is part of the progressive delivery story where you can limit the activation scope",
    "start": "1487250",
    "end": "1492970"
  },
  {
    "text": "but you know 10% is still more than zero and so if you can improve on that even",
    "start": "1492970",
    "end": "1498980"
  },
  {
    "text": "more by saying hey we're going to do some free testing where we're just going to like try to filter out you know bad",
    "start": "1498980",
    "end": "1505250"
  },
  {
    "text": "builds in advance of this then you know we think mirroring is a cool opportunity",
    "start": "1505250",
    "end": "1510740"
  },
  {
    "text": "to do that kind of thing so the caveat here is that the service",
    "start": "1510740",
    "end": "1518600"
  },
  {
    "text": "mesh is going to mirror the traffic by duplicating the requests and it's going to send one request to the canary and",
    "start": "1518600",
    "end": "1524810"
  },
  {
    "text": "it's going to send one request to the primary and so that means that there there will actually be two copies of",
    "start": "1524810",
    "end": "1530390"
  },
  {
    "text": "each request that you choose to mirror this way and so that means that those",
    "start": "1530390",
    "end": "1535940"
  },
  {
    "text": "requests must be what's called item hope so that means that your system if it handy if it receives a copy of the",
    "start": "1535940",
    "end": "1542750"
  },
  {
    "text": "request it'll still be okay and so idempotent requests cover gets like all sort of",
    "start": "1542750",
    "end": "1549530"
  },
  {
    "text": "read operations are naturally item potent and also special kinds of rights",
    "start": "1549530",
    "end": "1555340"
  },
  {
    "text": "so if you have requests that are rights like puts are posted that are",
    "start": "1555340",
    "end": "1561440"
  },
  {
    "text": "semantically kind of like this thing on the left hey did docked $100 from my account then",
    "start": "1561440",
    "end": "1567620"
  },
  {
    "text": "those are not item potent because you might have you know like when we",
    "start": "1567620",
    "end": "1573380"
  },
  {
    "text": "duplicate the request you'll get two requests that say deduct $100 from Andrews account that will mean then I've",
    "start": "1573380",
    "end": "1579350"
  },
  {
    "text": "been deducted $200 I'm not happy about that so you know I don't that that",
    "start": "1579350",
    "end": "1585140"
  },
  {
    "text": "traffic is not compatible it's not idempotent so it's not compatible with this very the kinds of requests that all",
    "start": "1585140",
    "end": "1592580"
  },
  {
    "text": "right impotant are all gets like hey get my account balance if you duplicate that it's fine it's a read also here's an",
    "start": "1592580",
    "end": "1599240"
  },
  {
    "text": "example of an item potent right set my time zone to a mountain Daylight Time right and if you do another copy of the",
    "start": "1599240",
    "end": "1606620"
  },
  {
    "text": "set that's fine unimportance e is a good thing to have in your system anyways because since",
    "start": "1606620",
    "end": "1613790"
  },
  {
    "text": "we are dealing with unreliable networks we have a hard time guaranteeing that",
    "start": "1613790",
    "end": "1618800"
  },
  {
    "text": "that you know there's only one copy and it's reliably delivered this is pretty",
    "start": "1618800",
    "end": "1624530"
  },
  {
    "text": "interesting to a lot of people so we're publishing a blog this week that goes into a lot of details about what item",
    "start": "1624530",
    "end": "1631580"
  },
  {
    "text": "code is why you want it in general and then you know that sort of unlocks the door for this this mirroring kind of",
    "start": "1631580",
    "end": "1638240"
  },
  {
    "text": "operation all right so mirroring as I talked about this is this this pre stage",
    "start": "1638240",
    "end": "1645110"
  },
  {
    "start": "1640000",
    "end": "1816000"
  },
  {
    "text": "and so this is going to look kinda like the the other graph where we've got old traffic up here new traffic down at the",
    "start": "1645110",
    "end": "1651620"
  },
  {
    "text": "bottom and so when we when we run the canary the first thing we're going to do",
    "start": "1651620",
    "end": "1656720"
  },
  {
    "text": "is a mirror pre stage and so here we're gonna copy traffic that's that little blue dotted line there and send it to",
    "start": "1656720",
    "end": "1662960"
  },
  {
    "text": "the mirror and then once the will do this pre stage and let it soak for a",
    "start": "1662960",
    "end": "1668120"
  },
  {
    "text": "while and as long as that canary is happy according to the service mesh",
    "start": "1668120",
    "end": "1673430"
  },
  {
    "text": "statistics will measure here and we'll say okay good we're ready to proceed to the next stage and so then when when you",
    "start": "1673430",
    "end": "1679910"
  },
  {
    "text": "want to do that then we'll start with the the shifting traffic measure shifting traffic going through the whole",
    "start": "1679910",
    "end": "1685340"
  },
  {
    "text": "rest of the thing and then you know the canary proceeds is normally we hit success and we say great we're good",
    "start": "1685340",
    "end": "1691960"
  },
  {
    "text": "alright so let's see this in action alright so I'm gonna go over here and",
    "start": "1691960",
    "end": "1701650"
  },
  {
    "text": "canary info and I'm just gonna turn on this mirror property theory and so we're",
    "start": "1701650",
    "end": "1710930"
  },
  {
    "text": "just telling Fagor hey we want you to do a mirror stage before you do all the",
    "start": "1710930",
    "end": "1717620"
  },
  {
    "text": "rest of the normal canary deployment stuff and I'm going to deploy to point I",
    "start": "1717620",
    "end": "1728750"
  },
  {
    "text": "always do is I get the wrong one okay cool so when I deploy to point one point two and we'll see hopefully I didn't",
    "start": "1728750",
    "end": "1737840"
  },
  {
    "text": "talk so long that Sturm got disconnected all right update that image",
    "start": "1737840",
    "end": "1747160"
  },
  {
    "text": "and we will go ahead and wait for for flagger to notice oh whoops I did",
    "start": "1747160",
    "end": "1754210"
  },
  {
    "text": "something wrong which is I try to deploy the same image again so that's vigor is going to ignore that",
    "start": "1754210",
    "end": "1759550"
  },
  {
    "text": "because you're not really doing a very interesting deployment if you're deploying the same thing so I'll go",
    "start": "1759550",
    "end": "1764830"
  },
  {
    "text": "ahead and step forward one more version here and so now we've got a canary deployment that we're proposing hey",
    "start": "1764830",
    "end": "1771430"
  },
  {
    "text": "Fagor you want to do this we want you do this traffic mirroring thing first and so go ahead and wait for flagger to",
    "start": "1771430",
    "end": "1778540"
  },
  {
    "text": "notice over here we'll go back to prometheus",
    "start": "1778540",
    "end": "1784500"
  },
  {
    "text": "there we go so flagger noticed and is waiting for",
    "start": "1786350",
    "end": "1792419"
  },
  {
    "text": "our new version to be available to do the traffic mirroring we're gonna see down here these are this is the command",
    "start": "1792419",
    "end": "1797490"
  },
  {
    "text": "to the service mesh for how to split traffic it's going to have a mirror pre-staged that's going to run for a bit",
    "start": "1797490",
    "end": "1803610"
  },
  {
    "text": "that's going to do the the mirroring stuff that we talked about cool so now",
    "start": "1803610",
    "end": "1817590"
  },
  {
    "start": "1816000",
    "end": "1904000"
  },
  {
    "text": "you can see it ran this is now looks different it's going to say hey do some",
    "start": "1817590",
    "end": "1822720"
  },
  {
    "text": "mirroring right now and so we're in the mirror stage and so we're not actually sending any production traffic to the",
    "start": "1822720",
    "end": "1829529"
  },
  {
    "text": "canary aside from the special traffic that we're mirroring for dropping the responses on that mirror traffic on the",
    "start": "1829529",
    "end": "1836519"
  },
  {
    "text": "floor so that we're not actually sending them back to users and over here we can",
    "start": "1836519",
    "end": "1842309"
  },
  {
    "text": "see that it's a little bit hard to see here but the the mirror traffic is going",
    "start": "1842309",
    "end": "1849059"
  },
  {
    "text": "to be 100% of the the primary traffickers are going to be the same for the pre-staged mirror all the requests",
    "start": "1849059",
    "end": "1856019"
  },
  {
    "text": "in this pre stage and mirrored requests when use a service much like aspen mash",
    "start": "1856019",
    "end": "1862710"
  },
  {
    "text": "or sto that have they are built on envoy envoy a mirrored traffic has the",
    "start": "1862710",
    "end": "1869549"
  },
  {
    "text": "authority or host header as an addition where it says - shadow at the end and",
    "start": "1869549",
    "end": "1875070"
  },
  {
    "text": "that's how if you have other tracing systems or logging systems you can differentiate that shadow is the clue",
    "start": "1875070",
    "end": "1882090"
  },
  {
    "text": "that hey this was actually mirrored traffic and so you can kind of compare",
    "start": "1882090",
    "end": "1888679"
  },
  {
    "text": "cool so this the pre-staged just went successfully and mirrored traffic",
    "start": "1888679",
    "end": "1894600"
  },
  {
    "text": "completed here and flagger decided hopefully okay and so now it's gonna start",
    "start": "1894600",
    "end": "1900580"
  },
  {
    "text": "shifting traffic over to that canary clip back and see yep canary says it's",
    "start": "1900580",
    "end": "1906549"
  },
  {
    "start": "1904000",
    "end": "2065000"
  },
  {
    "text": "happy it's it's progressing through right it went 90 and then 80 and it's all the way up to 70 that's got a 70/30",
    "start": "1906549",
    "end": "1913809"
  },
  {
    "text": "split we're now under that normal sort of canary traffic split scenario the",
    "start": "1913809",
    "end": "1919480"
  },
  {
    "text": "service mesh is continuing to split traffic according to the commands that flagger gives to it and then once we get",
    "start": "1919480",
    "end": "1927190"
  },
  {
    "text": "all happy here it'll go 6040 5050 and then we're good",
    "start": "1927190",
    "end": "1934020"
  },
  {
    "text": "so we're up to 60/40 now wait just a few",
    "start": "1949780",
    "end": "1955490"
  },
  {
    "text": "more seconds and it should go ahead and go all the way back to 50/50 we can see",
    "start": "1955490",
    "end": "1960740"
  },
  {
    "text": "you know this is this this so here's the mirror in pre-staged and then here's the the Canary ramped up and then we're",
    "start": "1960740",
    "end": "1969140"
  },
  {
    "text": "about to hit 50/50 and then if that's healthy we'll go ahead and declare the Canary a success we go 50/50 and so now",
    "start": "1969140",
    "end": "1977360"
  },
  {
    "text": "you know flagger is shifted we're deploying two point one point three is the new primary once that's finished we",
    "start": "1977360",
    "end": "1984650"
  },
  {
    "text": "will flaggers next step is to go ahead and ship traffic 100% to the new",
    "start": "1984650",
    "end": "1990470"
  },
  {
    "text": "deployment and be ready for you know the future other other deployments that we want to do routing all traffic primary",
    "start": "1990470",
    "end": "1998750"
  },
  {
    "text": "100 zero flaggers finalizing and I think",
    "start": "1998750",
    "end": "2003790"
  },
  {
    "text": "at this point we don't need to watch the tail end really here so that's that's a",
    "start": "2003790",
    "end": "2011140"
  },
  {
    "text": "flagger progressive delivery in in a nutshell you know I pasted it into the",
    "start": "2011140",
    "end": "2018220"
  },
  {
    "text": "the slack the links here for if you want to try this you know at home all the",
    "start": "2018220",
    "end": "2024010"
  },
  {
    "text": "commands yeah Mel's toast will reproduce the same demo you can see right there great and so at this point you know I",
    "start": "2024010",
    "end": "2032620"
  },
  {
    "text": "think my demo is finished and I'll go ahead and I think open it up for",
    "start": "2032620",
    "end": "2038020"
  },
  {
    "text": "questions yeah",
    "start": "2038020",
    "end": "2040860"
  },
  {
    "text": "grasan for all the great questions in QA Taylor I see quite a few there should we",
    "start": "2047720",
    "end": "2054300"
  },
  {
    "text": "just start going down the list and given answers yes let's do that all right so the first question from",
    "start": "2054300",
    "end": "2060510"
  },
  {
    "text": "anonymous attendee is can this be deployed and openshift",
    "start": "2060510",
    "end": "2065419"
  },
  {
    "start": "2065000",
    "end": "2190000"
  },
  {
    "text": "yeah so I'm pretty sure that this can be to put an open shift as sort of a",
    "start": "2065540",
    "end": "2071220"
  },
  {
    "text": "primary you know open shift has a lot of kubernetes stuff inside right and so the",
    "start": "2071220",
    "end": "2077520"
  },
  {
    "text": "way that flagger works is it's it's taking normal kubernetes workload",
    "start": "2077520",
    "end": "2084118"
  },
  {
    "text": "descriptions like deployments and services and then commanding one or more",
    "start": "2084119",
    "end": "2090540"
  },
  {
    "text": "service meshes underneath to do the traffic shifting and so the you should",
    "start": "2090540",
    "end": "2097320"
  },
  {
    "text": "go check flaggers page for any of that the details around compatibility but basically those are the two pieces that",
    "start": "2097320",
    "end": "2103560"
  },
  {
    "text": "you need you need kubernetes deployments and you need a service mesh you know we're asked to match we love aspen mesh",
    "start": "2103560",
    "end": "2110820"
  },
  {
    "text": "for that service mesh you get a service mesh that flagger knows how to command underneath ok great thanks the next",
    "start": "2110820",
    "end": "2120570"
  },
  {
    "text": "question is what CNI is supported that's a good question so this is this layer",
    "start": "2120570",
    "end": "2128040"
  },
  {
    "text": "it's independent of CNI so the trick is that your again your service mesh is going to be the thing that's doing the",
    "start": "2128040",
    "end": "2133619"
  },
  {
    "text": "traffic shifting and so your service mesh has to be compatible with whatever C&I you have underneath this demo I",
    "start": "2133619",
    "end": "2141270"
  },
  {
    "text": "happened to use flannel which is like VX land underneath but you know most",
    "start": "2141270",
    "end": "2147359"
  },
  {
    "text": "service meshes are compatible with most seeing eyes try to operate a layer above that Aspen mesh does operate at a layer",
    "start": "2147359",
    "end": "2153840"
  },
  {
    "text": "above that and so we don't really care about this ok great the next question",
    "start": "2153840",
    "end": "2162060"
  },
  {
    "text": "from Jeff is curious if canary analysis can incorporate metrics from other",
    "start": "2162060",
    "end": "2167460"
  },
  {
    "text": "sources besides Prometheus such as an APM tool that provides a REST API for",
    "start": "2167460",
    "end": "2173040"
  },
  {
    "text": "getting performance metrics for canary yeah that's that's a that's a great question so flag",
    "start": "2173040",
    "end": "2179820"
  },
  {
    "text": "so let me show you kind of where the the metrics came from we talked about just a",
    "start": "2179820",
    "end": "2185070"
  },
  {
    "text": "little bit so this so flyer comes in",
    "start": "2185070",
    "end": "2193530"
  },
  {
    "start": "2190000",
    "end": "2730000"
  },
  {
    "text": "some so here's where I specified the metrics request success rate and request duration these are handles in flaggers",
    "start": "2193530",
    "end": "2200460"
  },
  {
    "text": "code to say hey if the if the user is running on top of an sto or an sto",
    "start": "2200460",
    "end": "2206850"
  },
  {
    "text": "service mesh like Aspen mesh then you should query Prometheus this way so you",
    "start": "2206850",
    "end": "2212850"
  },
  {
    "text": "can get the the corresponding service match metrics back out and so this is an easy way so that users don't have to",
    "start": "2212850",
    "end": "2219960"
  },
  {
    "text": "bother with with all the details of what query owner we're going to run against Prometheus and where and you know all",
    "start": "2219960",
    "end": "2226590"
  },
  {
    "text": "that sort of stuff it's designed to make that pretty easy but you can do that yourself and you can go check sort of",
    "start": "2226590",
    "end": "2234060"
  },
  {
    "text": "the flagger web github repository and documentation for how you would make your own metrics here you could point",
    "start": "2234060",
    "end": "2241619"
  },
  {
    "text": "them in previous you could point them as you say some other you know APM tool whatever you want you can list more and",
    "start": "2241619",
    "end": "2248430"
  },
  {
    "text": "more metrics here this is basically a handle - a template that flagger will",
    "start": "2248430",
    "end": "2253859"
  },
  {
    "text": "fill in with like the names of the deployments and stuff that it that it's controlling and so yeah you can",
    "start": "2253859",
    "end": "2259560"
  },
  {
    "text": "definitely you know go wild and pull in other data sources ok great",
    "start": "2259560",
    "end": "2268380"
  },
  {
    "text": "the next question is from Jim he actually asked two quick questions right no row so I'll just give you both the",
    "start": "2268380",
    "end": "2275280"
  },
  {
    "text": "first is which metrics are you using to make the canary decision how are you determining if the app is good and ready",
    "start": "2275280",
    "end": "2281490"
  },
  {
    "text": "and then right after that he asked seems like failure rate based on response codes yep so there's there's a",
    "start": "2281490",
    "end": "2289740"
  },
  {
    "text": "couple of parts here and so I'll sort of go through all the details the the first",
    "start": "2289740",
    "end": "2295710"
  },
  {
    "text": "is that when I said hey deploy this new you update the image here's our new",
    "start": "2295710",
    "end": "2301680"
  },
  {
    "text": "build that we want you to run that was adjusting a plain old kubernetes deployment and so that's the glue",
    "start": "2301680",
    "end": "2309540"
  },
  {
    "text": "between whatever CD system you have and flagger and so that plain old kubernetes deployment in production",
    "start": "2309540",
    "end": "2316250"
  },
  {
    "text": "usage should have all the normal things that you should do for one of those kubernetes deployments it should have",
    "start": "2316250",
    "end": "2321560"
  },
  {
    "text": "liveness and readiness checks associated with it and so once you do that flag art",
    "start": "2321560",
    "end": "2327770"
  },
  {
    "text": "controls how many of those Canaries to spin up and it'll spin up one and let you know Auto scalars take over if you",
    "start": "2327770",
    "end": "2334460"
  },
  {
    "text": "need more but it'll just say hey I want you know I want this to be available and it will let the plain old kubernetes",
    "start": "2334460",
    "end": "2340550"
  },
  {
    "text": "machinery take care of deploying that and it's not you know just like all",
    "start": "2340550",
    "end": "2346190"
  },
  {
    "text": "other kubernetes deployments they're not available to be part of a service until aliveness and readiness checks have",
    "start": "2346190",
    "end": "2352310"
  },
  {
    "text": "passed and so that that first stage before plugger can even start mirroring",
    "start": "2352310",
    "end": "2357680"
  },
  {
    "text": "traffic or shifting traffic that first stage is a plain old kubernetes deployment and that's great because it",
    "start": "2357680",
    "end": "2363530"
  },
  {
    "text": "means that you can use all the stuff you've already got for managing that for rolling deployments and you know those",
    "start": "2363530",
    "end": "2369710"
  },
  {
    "text": "the ones that I recommend really are yeah you want health checks you want aliveness checks and readiness checks",
    "start": "2369710",
    "end": "2375230"
  },
  {
    "text": "before you even start shifting traffic so that's that's the first that's just getting the deployment up and running",
    "start": "2375230",
    "end": "2380510"
  },
  {
    "text": "then the next one is going to be how you start deciding that it's it's ready to",
    "start": "2380510",
    "end": "2388760"
  },
  {
    "text": "take traffic and so that's where your service manager flag or progressive delivery canary deployments start coming",
    "start": "2388760",
    "end": "2395510"
  },
  {
    "text": "in so the first scenario I showed is that okay we've got one that's deployed it's past you know readiness checks and",
    "start": "2395510",
    "end": "2401690"
  },
  {
    "text": "so now we're going to ship just start shifting some traffic to it and see if it's healthy or not and then the",
    "start": "2401690",
    "end": "2408020"
  },
  {
    "text": "extension that we showed was hey maybe you want this pre stage where you're gonna mirror some traffic in advance and",
    "start": "2408020",
    "end": "2413630"
  },
  {
    "text": "that'll give you that you know okay it's good and ready to even start taking some production some production traffic so",
    "start": "2413630",
    "end": "2419810"
  },
  {
    "text": "this is really about a couple of layers of pre testing so that you can make sure that before it goes out to some subset",
    "start": "2419810",
    "end": "2427069"
  },
  {
    "text": "of your users then eventually 100% of your users that it's good good and ready",
    "start": "2427069",
    "end": "2432800"
  },
  {
    "text": "as you put it and then you asked about seems like response codes so yeah that's",
    "start": "2432800",
    "end": "2439910"
  },
  {
    "text": "the analysis in the in part in the you know sort of showed",
    "start": "2439910",
    "end": "2447460"
  },
  {
    "text": "in the slides here it's shift and measure so that measurement part is in",
    "start": "2447460",
    "end": "2453070"
  },
  {
    "text": "the demo based on response codes and latency we sort of showed the example of failing response codes means rollback",
    "start": "2453070",
    "end": "2459630"
  },
  {
    "text": "and just as I sort of described in the other question you could choose other metrics for for your application okay we",
    "start": "2459630",
    "end": "2469630"
  },
  {
    "text": "have more questions about canary deployment this one's from samox well the canary deployment work for TCP",
    "start": "2469630",
    "end": "2475510"
  },
  {
    "text": "traffic as well so for TCP traffic the the trick is that you have to have some",
    "start": "2475510",
    "end": "2481870"
  },
  {
    "text": "way to decide that it is healthy or not so in theory this would work for hey as",
    "start": "2481870",
    "end": "2488530"
  },
  {
    "text": "long as there's some Prometheus metric that we can go grab somewhere it may be a different metric than you know you're",
    "start": "2488530",
    "end": "2493930"
  },
  {
    "text": "an application layer sort of computes and reports like the app could be trusted to say how successful or family",
    "start": "2493930",
    "end": "2499990"
  },
  {
    "text": "it is that would mean that you'd have to go write your own custom you know metric",
    "start": "2499990",
    "end": "2505150"
  },
  {
    "text": "to go find one of those and get it so it works you know pretty well out of the box like we demoed for HTTP if you want",
    "start": "2505150",
    "end": "2511390"
  },
  {
    "text": "to do TCP or your own custom stuff well the the problem is that you you both",
    "start": "2511390",
    "end": "2517780"
  },
  {
    "text": "have to be able to collect the metrics and you have to be able to shift traffic and so if it's TCP if the TCP layer",
    "start": "2517780",
    "end": "2525010"
  },
  {
    "text": "right the service measure can't tell the difference between one request in the next so the best it could do is some",
    "start": "2525010",
    "end": "2530290"
  },
  {
    "text": "sort of shifting based on connections and so that's kind of course branding",
    "start": "2530290",
    "end": "2536740"
  },
  {
    "text": "but you can you can still do it and the mirroring thing does not work for TCP",
    "start": "2536740",
    "end": "2541780"
  },
  {
    "text": "traffic as far as I know onwe cannot your TCP traffic and since it doesn't",
    "start": "2541780",
    "end": "2548170"
  },
  {
    "text": "understand anything about the semantics of the things going on inside its it's",
    "start": "2548170",
    "end": "2553360"
  },
  {
    "text": "not very helpful they're mirroring is is best suited for you know layer seven protocols that your service mesh",
    "start": "2553360",
    "end": "2559720"
  },
  {
    "text": "understands that's a good question so this one might be similar you can let",
    "start": "2559720",
    "end": "2564820"
  },
  {
    "text": "me know but the traffic which the canary probe is HTTP in case this is database traffic or any TCP traffic",
    "start": "2564820",
    "end": "2571240"
  },
  {
    "text": "well the canary still work I yeah I think that one sounds like the",
    "start": "2571240",
    "end": "2578330"
  },
  {
    "text": "same as the okay was the same action same person asking so we'll just keep",
    "start": "2578330",
    "end": "2585050"
  },
  {
    "text": "going is the canary analysis only comparing against static thresholds by default or is it more intelligent",
    "start": "2585050",
    "end": "2593290"
  },
  {
    "text": "so this one is configured to compare against static static thresholds I'm not",
    "start": "2593720",
    "end": "2602840"
  },
  {
    "text": "aware if Uyghur might have more smarts inside of it but I'm not I'm not aware",
    "start": "2602840",
    "end": "2608990"
  },
  {
    "text": "of that okay well starvation that will service",
    "start": "2608990",
    "end": "2615530"
  },
  {
    "text": "mesh be working across multiple kubernetes clusters that's a great question so it depends on the service",
    "start": "2615530",
    "end": "2621260"
  },
  {
    "text": "mesh so Aspen mesh and which is built on top of sto and you know sto other sto",
    "start": "2621260",
    "end": "2628400"
  },
  {
    "text": "based service meshes do work across multiple clusters it just depends on on",
    "start": "2628400",
    "end": "2634700"
  },
  {
    "text": "your on the surface mesh implementation that you chose okay and the next",
    "start": "2634700",
    "end": "2642170"
  },
  {
    "text": "question is do you have some telemetry features telemetry features yeah another",
    "start": "2642170",
    "end": "2647240"
  },
  {
    "text": "one graphing tools like yelling yeah astín rush has service graph as so much as you",
    "start": "2647240",
    "end": "2652670"
  },
  {
    "text": "know telemetry computing things like that we didn't show that off in this demo we focused just on progressive",
    "start": "2652670",
    "end": "2657860"
  },
  {
    "text": "delivery you can head over to our website and get all lunch more details on that we've happy to show this off to",
    "start": "2657860",
    "end": "2666260"
  },
  {
    "text": "you set up set up a call with us or check out our demo our open beta that",
    "start": "2666260",
    "end": "2671690"
  },
  {
    "text": "just wasn't the focus really of this webinar okay this one is from one",
    "start": "2671690",
    "end": "2680540"
  },
  {
    "text": "anonymous attendee I think gate code state would be different against cluster deployment state when roll back the",
    "start": "2680540",
    "end": "2686000"
  },
  {
    "text": "kirtan failure what do you think that that's a great that's a really great question and let me talk about what's",
    "start": "2686000",
    "end": "2692780"
  },
  {
    "text": "going on inside of there so the question I think is so like if you have a failed",
    "start": "2692780",
    "end": "2698780"
  },
  {
    "text": "deployment and it might take a minute but I'm gonna trying I'll try to set this to do this",
    "start": "2698780",
    "end": "2704520"
  },
  {
    "text": "and then we'll talk about it while it's going you can come see what's going on oh yeah let me share am i screaming in",
    "start": "2704520",
    "end": "2710869"
  },
  {
    "text": "thank you yeah and I'll just talk through it because it",
    "start": "2710869",
    "end": "2718020"
  },
  {
    "text": "might take a few minutes for the demo to catch up so when so if you have a bad",
    "start": "2718020",
    "end": "2732890"
  },
  {
    "text": "deployment a bad canary deployment then what happens is you roll back and so the",
    "start": "2732890",
    "end": "2741420"
  },
  {
    "text": "and then the get code state might be different than what's running in in",
    "start": "2741420",
    "end": "2746910"
  },
  {
    "text": "production and so there's a couple of pieces here with so one is the get ops",
    "start": "2746910",
    "end": "2753329"
  },
  {
    "text": "sort of half of it and so that is where what you're trying to do is you're trying to say I want to manage the state",
    "start": "2753329",
    "end": "2759839"
  },
  {
    "text": "of my cluster all the applications that are running in it I want to manage that like how I manage source code in game so",
    "start": "2759839",
    "end": "2768000"
  },
  {
    "text": "that I can you know sort of code review it I can merge it I can review history all that sort of stuff and so that that",
    "start": "2768000",
    "end": "2776819"
  },
  {
    "text": "is still supported because the key is that when I did my deployment of the broken image here I touched this pot",
    "start": "2776819",
    "end": "2784290"
  },
  {
    "text": "info deployment and what happens when you set up a flagger is that the first",
    "start": "2784290",
    "end": "2790140"
  },
  {
    "text": "thing it does is it doesn't creates a second deployment for you that flagger",
    "start": "2790140",
    "end": "2795300"
  },
  {
    "text": "owns that is not respected reflected in your dip ops and it or you get",
    "start": "2795300",
    "end": "2801060"
  },
  {
    "text": "repository or declarative view of the cluster no human has configured this the operator of the flagger operator took",
    "start": "2801060",
    "end": "2807960"
  },
  {
    "text": "care of it and this is the special pot info primary deployment and so the contract is that flagger gets to own",
    "start": "2807960",
    "end": "2815190"
  },
  {
    "text": "what potica primary is running and that is always the version of pod info the",
    "start": "2815190",
    "end": "2821760"
  },
  {
    "text": "most recent version that has passed the canary deployment scenario and so you do have to get used to the fact that what",
    "start": "2821760",
    "end": "2828210"
  },
  {
    "text": "you have in version control for pod info may not reflect what you have",
    "start": "2828210",
    "end": "2833440"
  },
  {
    "text": "in version what you you are actually running for pod info primary and that's why you have to let flag or manage this",
    "start": "2833440",
    "end": "2839560"
  },
  {
    "text": "pot info primary deployment leave it out of your your sort of your world view of",
    "start": "2839560",
    "end": "2844840"
  },
  {
    "text": "your declarative config what you're putting into your get ops operator you have to decouple those and so that you",
    "start": "2844840",
    "end": "2852220"
  },
  {
    "text": "do have to you have to account for that and so that means that you can still",
    "start": "2852220",
    "end": "2857790"
  },
  {
    "text": "treat your code image and all that sort of stuff as you normally do where you're",
    "start": "2857790",
    "end": "2863320"
  },
  {
    "text": "just continuing to roll forward and create new deployments and you do have to be careful that you have in your head",
    "start": "2863320",
    "end": "2870850"
  },
  {
    "text": "hey the primary may not be the most recent one that we've published a past",
    "start": "2870850",
    "end": "2876430"
  },
  {
    "text": "CI it's actually the most recent one that passed CI and also passed this progressive delivery scenario and so if",
    "start": "2876430",
    "end": "2884800"
  },
  {
    "text": "you notice a flag or canary has failed that should make you uncomfortable you should go make code changes and fixes",
    "start": "2884800",
    "end": "2891190"
  },
  {
    "text": "and try to push a new-build through that moves it forward to be so that pas tempo and potential primary are",
    "start": "2891190",
    "end": "2898330"
  },
  {
    "text": "both running the most recent version of your code and you sort of reconciled",
    "start": "2898330",
    "end": "2903940"
  },
  {
    "text": "that difference so I think it's totally corrected it should be a little bit uncomfortable that you have a canary",
    "start": "2903940",
    "end": "2909880"
  },
  {
    "text": "build that failed the only other options you have are you could you know revert",
    "start": "2909880",
    "end": "2916720"
  },
  {
    "text": "like you could have a robot go and revert the commits that caused the build to fail but that can be kind of",
    "start": "2916720",
    "end": "2922060"
  },
  {
    "text": "hazardous because you know there may be other commits pending that are changing things what if that robot can't actually",
    "start": "2922060",
    "end": "2928180"
  },
  {
    "text": "merge things so I'm not aware of a lot of people doing that what I usually see is people say okay we understand what's",
    "start": "2928180",
    "end": "2935200"
  },
  {
    "text": "happened this canary has failed let's go try and move the ball forward let's fail forward and come up with a new bill that",
    "start": "2935200",
    "end": "2941170"
  },
  {
    "text": "we think will fix that problem and make progress",
    "start": "2941170",
    "end": "2946230"
  },
  {
    "text": "okay last question is a little bit of a long one from Alexander one of his",
    "start": "2950550",
    "end": "2957070"
  },
  {
    "text": "services is using WebRTC connections between client and service terminating connection will cause bad user",
    "start": "2957070",
    "end": "2963610"
  },
  {
    "text": "experience the session is typically going on for one to two hours is it possible to gradually prevent new",
    "start": "2963610",
    "end": "2969370"
  },
  {
    "text": "connections to be established on the old version and shipped new connections to the new service to allow him to remove",
    "start": "2969370",
    "end": "2975910"
  },
  {
    "text": "the old version when there will be no more WebRTC session is open any ole information so that's this is a question",
    "start": "2975910",
    "end": "2984520"
  },
  {
    "text": "again that kind of depends on your service mesh so so for a spin mash you",
    "start": "2984520",
    "end": "2990970"
  },
  {
    "text": "know it's you an envoy again the you know envoy will last at least for a",
    "start": "2990970",
    "end": "2996700"
  },
  {
    "text": "configurable amount of time old connections to old services stay open and so you can sort of gradually shift",
    "start": "2996700",
    "end": "3003810"
  },
  {
    "text": "that over but you do face this tension of well but if you're not gonna shift over any old stuff if you're not going",
    "start": "3003810",
    "end": "3010770"
  },
  {
    "text": "to shift over anything you've got connections that last one or two hours then the soak time in order for you to",
    "start": "3010770",
    "end": "3016350"
  },
  {
    "text": "get enough new traffic to your new connections might be pretty darn long and so you know you might be looking at",
    "start": "3016350",
    "end": "3022260"
  },
  {
    "text": "hey how long of a window do I have to have to get enough new stuff but you",
    "start": "3022260",
    "end": "3027420"
  },
  {
    "text": "know most I think most service measures support this sort of you know hey let's let's tail off let's not disrupt",
    "start": "3027420",
    "end": "3034680"
  },
  {
    "text": "existing connections I know as to mesh does and the others you just have to",
    "start": "3034680",
    "end": "3039810"
  },
  {
    "text": "check if anybody else has a question to",
    "start": "3039810",
    "end": "3047190"
  },
  {
    "text": "ask please type it into the Q&A box now we can wait like another minute in case",
    "start": "3047190",
    "end": "3052770"
  },
  {
    "text": "anybody has any questions",
    "start": "3052770",
    "end": "3055850"
  },
  {
    "text": "all right well it looks like we're with questions I thank Sandra and Zach for a great presentation and thanks",
    "start": "3073790",
    "end": "3080910"
  },
  {
    "text": "everybody for joining us today and the webinar recording on slides will be online later today on the CN CF website",
    "start": "3080910",
    "end": "3086700"
  },
  {
    "text": "and the link I posted earlier in the chat we're looking forward to seeing you all at the future CF webinar have a",
    "start": "3086700",
    "end": "3092970"
  },
  {
    "text": "great day thanks so much Zach and Andrew thanks everyone thanks for joining them",
    "start": "3092970",
    "end": "3098160"
  },
  {
    "text": "have a good day",
    "start": "3098160",
    "end": "3100880"
  }
]