[
  {
    "start": "0",
    "end": "14000"
  },
  {
    "text": "NARRATOR: The following\ncontent provided by MIT OpenCourseWare under\na Creative Commons license.",
    "start": "0",
    "end": "6399"
  },
  {
    "text": "Additional information\nabout our license and MIT OpenCourseWare\nin general is available at ocw.mit.edu.",
    "start": "6400",
    "end": "11799"
  },
  {
    "text": " PROFESSOR: So this is the\nsecond 086 lecture and it'll be",
    "start": "11800",
    "end": "21340"
  },
  {
    "start": "14000",
    "end": "552000"
  },
  {
    "text": "my second and last lecture on\nsolving ordinary differential",
    "start": "21340",
    "end": "27040"
  },
  {
    "text": "equations -- u prime\nequal f of u and t.",
    "start": "27040",
    "end": "33270"
  },
  {
    "text": "So last time, we got Euler's\nmethod, both ordinary,",
    "start": "33270",
    "end": "40290"
  },
  {
    "text": "forward Euler, which is this\nmethod for the particular",
    "start": "40290",
    "end": "45970"
  },
  {
    "text": "equation -- so I'm using my\nmodel problem, as always, u prime equal a*u.",
    "start": "45970",
    "end": "51440"
  },
  {
    "text": "That's the model. And I'm using small u for\nthe true solution and capital",
    "start": "51440",
    "end": "59530"
  },
  {
    "text": "U for the approximation. By whatever method we use,\nand right now, that method",
    "start": "59530",
    "end": "65379"
  },
  {
    "text": "is forward Euler. We looked at the\nidea of stability,",
    "start": "65380",
    "end": "71720"
  },
  {
    "text": "but now let me\nfollow up right away with the point of stability.",
    "start": "71720",
    "end": "78160"
  },
  {
    "text": "Where does stability come in? So I want to do that for\nthis simplest of all methods,",
    "start": "78160",
    "end": "84740"
  },
  {
    "text": "because you'll see how we\nget to an error equation",
    "start": "84740",
    "end": "92820"
  },
  {
    "text": "and we'll get to a similar\nerror equation for much better methods.",
    "start": "92820",
    "end": "98710"
  },
  {
    "text": "So the accuracy of\nEuler is minimal, but the question of\nhow stability enters",
    "start": "98710",
    "end": "106009"
  },
  {
    "text": "and how we show\nthat it converges will be the same, also in\npartial differential equations,",
    "start": "106010",
    "end": "112880"
  },
  {
    "text": "so this is the place to see it. So I'll start with that, but\nthen after that topic will",
    "start": "112880",
    "end": "122409"
  },
  {
    "text": "come better methods than\nEuler and the first step will be, of course,\nsecond-order methods,",
    "start": "122410",
    "end": "129240"
  },
  {
    "text": "because Euler and backward\nEuler are only first-order. And we'll see -- actually,\nthat'll be the point.",
    "start": "129240",
    "end": "135300"
  },
  {
    "text": "Not only will show\nwhen they converge, why they converge, but also\nhow fast they converge.",
    "start": "135300",
    "end": "141790"
  },
  {
    "text": "What's the error? This estimate of the\nerror is something that every code is going\nto somehow use internally",
    "start": "141790",
    "end": "149700"
  },
  {
    "text": "to control the\nstep size delta t. So I'm just going to go\nwith the model problem,",
    "start": "149700",
    "end": "156380"
  },
  {
    "text": "u prime equal a*u,\nthe Euler method. So here is the evaluation\n-- a*u is f there,",
    "start": "156380",
    "end": "165200"
  },
  {
    "text": "so it's really delta\nt multiplying f, which is just a*u\nin this easy case.",
    "start": "165200",
    "end": "171599"
  },
  {
    "text": "Here's the true\nsolution and then here is the new point, that\nwhen I plug the true solution",
    "start": "171600",
    "end": "178460"
  },
  {
    "text": "in to the difference\nequation, it, of course, doesn't satisfy exactly.",
    "start": "178460",
    "end": "185800"
  },
  {
    "text": "There's some error term -- this,\nI would call the discretization error -- making the\nproblem discrete.",
    "start": "185800",
    "end": "195030"
  },
  {
    "text": " So this is the, you could say,\nthe error at a single time step",
    "start": "195030",
    "end": "203599"
  },
  {
    "text": "-- it's the new error that's\nintroduced at time step n. ",
    "start": "203600",
    "end": "212370"
  },
  {
    "text": "Error, now, is going to be\n-- e will be u, the true one,",
    "start": "212370",
    "end": "218220"
  },
  {
    "text": "minus the approximate, so I\njust subtract to get an equation",
    "start": "218220",
    "end": "223970"
  },
  {
    "text": "for the error at\ntime step n plus 1. That subtraction\ngives e_n, a delta t.",
    "start": "223970",
    "end": "232210"
  },
  {
    "text": "That subtraction gives e_n, and\nthis is the inhomogeneous term,",
    "start": "232210",
    "end": "239360"
  },
  {
    "text": "you could say, the new error. So the question is -- first, the\nquestion is, what size is that,",
    "start": "239360",
    "end": "248239"
  },
  {
    "text": "the local error? Then the key question is, when I\ncombine all these local errors,",
    "start": "248240",
    "end": "257829"
  },
  {
    "text": "what's the global error? So first, the local error.",
    "start": "257830",
    "end": "263889"
  },
  {
    "text": "You can see what this\nis, approximately, because the true solution would\nbe e to the a*t and we all know",
    "start": "263890",
    "end": "274199"
  },
  {
    "text": "that e to the a*t times\nu_0 -- e to the at --",
    "start": "274200",
    "end": "280990"
  },
  {
    "text": "there's a 1 plus an a delta\n-- from a single time step --",
    "start": "280990",
    "end": "287470"
  },
  {
    "text": "sorry, I should have said the\ntrue solution would grow by e",
    "start": "287470",
    "end": "293420"
  },
  {
    "text": "to the a delta t over one step. It would multiply by\ne to the a delta t,",
    "start": "293420",
    "end": "300080"
  },
  {
    "text": "but instead of multiplying\nby that exponential e to the a delta t, we're only\nmultiplying by the first two",
    "start": "300080",
    "end": "306510"
  },
  {
    "text": "terms in the series. So the error here is going to\nbe something like a half delta t",
    "start": "306510",
    "end": "318220"
  },
  {
    "text": "squared -- that's the key point\nwhere we see the local error --",
    "start": "318220",
    "end": "325830"
  },
  {
    "text": "times probably a squared --\nwe needed an a squared and u.",
    "start": "325830",
    "end": "338840"
  },
  {
    "text": "So a squared u_n,\nthat would really be the second derivative.",
    "start": "338840",
    "end": "344240"
  },
  {
    "text": "I'll put it in as\nsecond derivative, because that's what it would\nlook like in a nonlinear case.",
    "start": "344240",
    "end": "353389"
  },
  {
    "text": "So I'm working the linear\ncase for simplicity, but the point is that this\nis the Euler local error.",
    "start": "353390",
    "end": "363360"
  },
  {
    "text": "That's so typical,\nthat you really want to look at that local\nerror, see what it looks like.",
    "start": "363360",
    "end": "369280"
  },
  {
    "text": "There is some constant and\nthat has a certain effect on the quality of the method.",
    "start": "369280",
    "end": "377310"
  },
  {
    "text": "There's a power of delta\nt and the question, what is that exponent\nhas a big effect.",
    "start": "377310",
    "end": "382660"
  },
  {
    "text": "So that exponent is\nthe order plus 1.",
    "start": "382660",
    "end": "389430"
  },
  {
    "text": "So for me, Euler's method\nhas accuracy p equal 1.",
    "start": "389430",
    "end": "395100"
  },
  {
    "text": "Over a single delta t step,\nthe error is delta t squared,",
    "start": "395100",
    "end": "401710"
  },
  {
    "text": "but we'll see that when I\ntake 1 over delta t steps to get somewhere, to get\nto some fixed time like 1,",
    "start": "401710",
    "end": "411330"
  },
  {
    "text": "then I have one over\ndelta t of these things and the 2 comes back down to\nthe 1, which I expect for Euler.",
    "start": "411330",
    "end": "420860"
  },
  {
    "text": "And finally, this term is out\nof our control, basically.",
    "start": "420860",
    "end": "427550"
  },
  {
    "text": "That's coming from the\ndifferential equation. That would tell us how\nhard or easy the method",
    "start": "427550",
    "end": "436949"
  },
  {
    "text": "is, the equation is. So if u double\nprime is real big,",
    "start": "436950",
    "end": "442770"
  },
  {
    "text": "we're going to expect to have\nto reduce delta t to keep this error under control, so\nthat's a typical term --",
    "start": "442770",
    "end": "450300"
  },
  {
    "text": "a constant delta t to a power\nof p plus 1 and the p plus first",
    "start": "450300",
    "end": "457550"
  },
  {
    "text": "derivative, the second\nderivative matching that 2 of the solution.",
    "start": "457550",
    "end": "463050"
  },
  {
    "text": "So that's -- if\nI now put this --",
    "start": "463050",
    "end": "469990"
  },
  {
    "text": "think of that as here in the\n-- as the sort of inhomogeneous",
    "start": "469990",
    "end": "476669"
  },
  {
    "text": "term or the new source term. I just want to estimate e_n now.",
    "start": "476670",
    "end": "483410"
  },
  {
    "text": "So I've done the local\npart and now I'm interested in putting it all together.",
    "start": "483410",
    "end": "489050"
  },
  {
    "text": "How do I look at e -- so\nI really want, somehow, the solution -- e at some\ndefinite time n is what?",
    "start": "489050",
    "end": "501240"
  },
  {
    "text": "I'm asking, really, for the\nsolution to this system,",
    "start": "501240",
    "end": "507449"
  },
  {
    "text": "and sort of in words\n-- so that's a good --",
    "start": "507450",
    "end": "515469"
  },
  {
    "text": "a totally typical\nerror equation. ",
    "start": "515470",
    "end": "522440"
  },
  {
    "text": "I think the way to\nlook at it in words is, at each step, some new\nterm, new error is committed,",
    "start": "522440",
    "end": "532480"
  },
  {
    "text": "and what happens to that\nerror at later steps?",
    "start": "532480",
    "end": "538089"
  },
  {
    "text": "At later steps, that\nerror committed then gets multiplied by 1 plus a\ndelta t at the next step and 1",
    "start": "538090",
    "end": "546110"
  },
  {
    "text": "plus a delta t at\nthe following step. So I think we have something\nlike, after n steps,",
    "start": "546110",
    "end": "554300"
  },
  {
    "text": "we would have 1 plus a delta\nt to the n-th times the error",
    "start": "554300",
    "end": "562480"
  },
  {
    "text": "that we did -- our\nfirst step error. ",
    "start": "562480",
    "end": "568390"
  },
  {
    "text": "So that's -- you see\nwhat's happening here? Whatever error we commit\ngrows or decays according",
    "start": "568390",
    "end": "575530"
  },
  {
    "text": "to this growth factor. Then of course, we made\nan error at step two",
    "start": "575530",
    "end": "581230"
  },
  {
    "text": "and we made an error at\nstep k, so at step k, it will have n minus\nk steps still to grow.",
    "start": "581230",
    "end": "591370"
  },
  {
    "text": "This is DE, the\nerror DE at step k,",
    "start": "591370",
    "end": "603220"
  },
  {
    "text": "and all the way through the --\nI guess it would end with DE_N.",
    "start": "603220",
    "end": "610439"
  },
  {
    "text": "DE_N would be the last\nthing that hadn't yet",
    "start": "610440",
    "end": "616550"
  },
  {
    "text": "started to grow or decay. Okay. So that's our formula.",
    "start": "616550",
    "end": "622570"
  },
  {
    "text": "It looks a little messy,\nbut it shows everything.",
    "start": "622570",
    "end": "628860"
  },
  {
    "text": "It shows the crucial important\nof stability and how it enters.",
    "start": "628860",
    "end": "633980"
  },
  {
    "text": "Stability controls -- so there\nis the error that we made way at the beginning and then\nthis is the growth factor that",
    "start": "633980",
    "end": "641960"
  },
  {
    "text": "happened n time, so you see\nthat if 1 plus a delta t has",
    "start": "641960",
    "end": "649870"
  },
  {
    "text": "magnitude bigger than 1,\nwhat's going to happen?",
    "start": "649870",
    "end": "654890"
  },
  {
    "text": "That will explode\nand the computer",
    "start": "654890",
    "end": "660040"
  },
  {
    "text": "will very quickly show\ntotally out of bounds output.",
    "start": "660040",
    "end": "670480"
  },
  {
    "text": "But if it's stable, if\nthis thing is less than 1,",
    "start": "670480",
    "end": "675980"
  },
  {
    "text": "less or equal to 1, then that\nstability means that this error",
    "start": "675980",
    "end": "681480"
  },
  {
    "text": "is not growing and so\nwe get -- so let me put,",
    "start": "681480",
    "end": "687269"
  },
  {
    "text": "if we have this stability,\n1 plus a delta t,",
    "start": "687270",
    "end": "692430"
  },
  {
    "text": "smaller equal 1, then we\nget the bound that we want. So can you see what\nthat looks like?",
    "start": "692430",
    "end": "698500"
  },
  {
    "text": " We've got N terms, right?",
    "start": "698500",
    "end": "707310"
  },
  {
    "text": "To get to point N, we've made\nN errors -- capital N errors --",
    "start": "707310",
    "end": "712600"
  },
  {
    "text": "and then each term,\nthat gives a 1. That's the critical\nrole of stability.",
    "start": "712600",
    "end": "721000"
  },
  {
    "text": "And the error is of this order,\nso I'm getting something like",
    "start": "721000",
    "end": "728270"
  },
  {
    "text": "a half delta t squared\nover 2 times --",
    "start": "728270",
    "end": "736050"
  },
  {
    "text": "let's say some maximum. I'll use u double prime for\na maximum value, let's say,",
    "start": "736050",
    "end": "744160"
  },
  {
    "text": "of the second derivative. That's a typical good\nsatisfactory error estimate.",
    "start": "744160",
    "end": "754000"
  },
  {
    "text": "So what's up here? So N times delta t --\ntimes one delta t --",
    "start": "754000",
    "end": "759710"
  },
  {
    "text": "is the time that\nwe reached, right? We took N steps,\ndelta t each step.",
    "start": "759710",
    "end": "765030"
  },
  {
    "text": "So this is the same as --\nthis is what I'm wanting and it's going to\nfit on this board --",
    "start": "765030",
    "end": "770459"
  },
  {
    "text": "there's a one half T -- I\nshould make it T over 2, right?",
    "start": "770460",
    "end": "778490"
  },
  {
    "text": "N delta t is some time\ncapital T. We have the half.",
    "start": "778490",
    "end": "784830"
  },
  {
    "text": "We still have one delta t. That's the key. We have this u double\nprime, which is fixed.",
    "start": "784830",
    "end": "794650"
  },
  {
    "text": "Anyway, we have\nfirst-order convergence. So the error after n steps\ngoes down like delta t.",
    "start": "794650",
    "end": "804459"
  },
  {
    "text": " If I cut the time step in\nhalf, I cut the error in half.",
    "start": "804460",
    "end": "812709"
  },
  {
    "text": "So that's not a great\nrate of convergence. That's, like, the minimal\nrate of convergence --",
    "start": "812710",
    "end": "818530"
  },
  {
    "text": "just one power delta t. And that's why we call\nEuler a first-order method.",
    "start": "818530",
    "end": "824649"
  },
  {
    "text": " I think, I hope you've seen and\ncan kind of -- because we'll --",
    "start": "824650",
    "end": "831660"
  },
  {
    "text": "this expression for the solution\nis messy but meaningful.",
    "start": "831660",
    "end": "840110"
  },
  {
    "text": " That's a little bit of\npure algebra or something",
    "start": "840110",
    "end": "850509"
  },
  {
    "text": "that shows how stability\nis used, where it enters.",
    "start": "850510",
    "end": "856630"
  },
  {
    "text": "So now I'm ready, if you are,\nto move to second-order methods.",
    "start": "856630",
    "end": "862070"
  },
  {
    "text": " Now we're actually\ngoing to get methods that people would really use.",
    "start": "862070",
    "end": "868280"
  },
  {
    "text": " So all those methods are,\nI think, worth looking at.",
    "start": "868280",
    "end": "878340"
  },
  {
    "text": "Can I say that the notes\nthat are on the web -- you may have spotted chapter\nfive, section one, for example,",
    "start": "878340",
    "end": "886580"
  },
  {
    "text": "which is this material --\nso I'm -- after the lecture, I always think back, what did\nI say and improve those notes,",
    "start": "886580",
    "end": "897580"
  },
  {
    "text": "so possibly later this\nafternoon a revised, improved version of this\nmaterial will go up and then",
    "start": "897580",
    "end": "906740"
  },
  {
    "text": "next week starts the real thing,\nwhat I think of as the real thing, the wave equation\nand the heat equation --",
    "start": "906740",
    "end": "913310"
  },
  {
    "text": "partial differential\nequations -- but it's worth -- here we saw how stability works.",
    "start": "913310",
    "end": "919970"
  },
  {
    "text": "Here we're going to see how\naccuracy can be increased and in different ways.",
    "start": "919970",
    "end": "931600"
  },
  {
    "start": "927000",
    "end": "1005000"
  },
  {
    "text": "In this way -- so what do I\nnotice about the trapezoidal method? ",
    "start": "931600",
    "end": "939670"
  },
  {
    "text": "Sometimes it's called\nCrank-Nicolson. In PDEs, the same idea was\nproposed by Crank and Nicolson.",
    "start": "939670",
    "end": "950840"
  },
  {
    "text": "So what's their idea? Or what's the trapezoidal\nidea in the first place?",
    "start": "950840",
    "end": "957550"
  },
  {
    "text": "Basically, we've centered --\nwe've recentered the method at what time position?",
    "start": "957550",
    "end": "964709"
  },
  {
    "text": " You can go ahead. So where -- instead of\nEuler, which was, like,",
    "start": "964710",
    "end": "973080"
  },
  {
    "text": "started at time n,\nt_n, or backward Euler, that was sort of focused\non the new time, t_(n+1),",
    "start": "973080",
    "end": "981180"
  },
  {
    "text": "this combination is at time\nn plus a half delta t, right?",
    "start": "981180",
    "end": "989750"
  },
  {
    "text": "Somehow we've symmetrized\neverything around a half",
    "start": "989750",
    "end": "995460"
  },
  {
    "text": "and the point is that\naround the midpoint,",
    "start": "995460",
    "end": "1002810"
  },
  {
    "text": "the accuracy jumps up to 2. ",
    "start": "1002810",
    "end": "1008839"
  },
  {
    "start": "1005000",
    "end": "1165000"
  },
  {
    "text": "Let me try, always,\nu prime equal a*u. ",
    "start": "1008840",
    "end": "1014990"
  },
  {
    "text": "So f is a*u. Then what does this become?",
    "start": "1014990",
    "end": "1021029"
  },
  {
    "text": "Can I, as you would\nhave to do in coding it, separate the implicit part?",
    "start": "1021030",
    "end": "1026589"
  },
  {
    "text": "This is implicit, of course.  That stands for this: f_(n+1)\nmeans f of the new unknown u",
    "start": "1026590",
    "end": "1037650"
  },
  {
    "text": "at the new time. So it's implicit. ",
    "start": "1037650",
    "end": "1046760"
  },
  {
    "text": "So let me bring that\nover to the left side, because it's sort of\npart of the unknown. I'll multiply through by delta\nt and I'll take f to be a*u.",
    "start": "1046760",
    "end": "1057490"
  },
  {
    "text": "So I just want to rewrite\nthat for our model problem. So it will be 1 minus a\nhalf, when I bring that over,",
    "start": "1057490",
    "end": "1067309"
  },
  {
    "text": "minus a delta t over 2 U_(n+1). ",
    "start": "1067310",
    "end": "1075110"
  },
  {
    "text": "Is that what I get, when I\nmultiply through by delta t and bring the\nimplicit part over?",
    "start": "1075110",
    "end": "1080220"
  },
  {
    "text": "And now I bring the\nexplicit part to that side, so it's 1 plus a half\ndelta t a delta t U_n.",
    "start": "1080220",
    "end": "1090210"
  },
  {
    "text": " So that's what we actually\nsolve at every step.",
    "start": "1090210",
    "end": "1097000"
  },
  {
    "text": " So first of all, I see\nthat it's pretty centered.",
    "start": "1097000",
    "end": "1105210"
  },
  {
    "text": "I see that there's something\nhas to be inverted. That's because the\nmethod's implicit.",
    "start": "1105210",
    "end": "1111590"
  },
  {
    "text": "If this was a matrix,\na system of equations, which is very typical -- could\nbe a large system of equations",
    "start": "1111590",
    "end": "1119360"
  },
  {
    "text": "with a matrix, capital A. Then\nu would be a vector and we would",
    "start": "1119360",
    "end": "1126230"
  },
  {
    "text": "be solving this system: matrix\ntimes vector equals known",
    "start": "1126230",
    "end": "1132750"
  },
  {
    "text": "right-hand side from time n. But here it's a scalar,\nit's just a division,",
    "start": "1132750",
    "end": "1139580"
  },
  {
    "text": "so what is stability\ngoing to depend on? What does stability require?",
    "start": "1139580",
    "end": "1145679"
  },
  {
    "text": "At every step, we\ndon't want to grow. So if we take a step -- that's\n1 plus a over 2 delta t divided",
    "start": "1145680",
    "end": "1155830"
  },
  {
    "text": "by 1 minus a over 2 delta\nt, that's the growth factor,",
    "start": "1155830",
    "end": "1162919"
  },
  {
    "text": "the decay factor that multiplies\nU_n to give you n plus 1,",
    "start": "1162920",
    "end": "1168730"
  },
  {
    "start": "1165000",
    "end": "1296000"
  },
  {
    "text": "so the stability question is,\nis this smaller or equal to 1?",
    "start": "1168730",
    "end": "1174600"
  },
  {
    "text": "That's stability for\nthis trapezoidal method.",
    "start": "1174600",
    "end": "1182530"
  },
  {
    "text": "What's the story on that? Suppose a is very negative.",
    "start": "1182530",
    "end": "1188580"
  },
  {
    "text": "That's what killed\nforward Euler, right? If a delta t -- that's where\nwe look for instability.",
    "start": "1188580",
    "end": "1196230"
  },
  {
    "text": "If a delta t becomes\ntoo negative,",
    "start": "1196230",
    "end": "1201660"
  },
  {
    "text": "we lost stability\nin forward Euler",
    "start": "1201660",
    "end": "1206700"
  },
  {
    "text": "and we'll lose stability in\nother, better methods too. But here, if a\ndelta t is negative,",
    "start": "1206700",
    "end": "1216850"
  },
  {
    "text": "that denominator is good. It's bigger than the\nnumerator, right?",
    "start": "1216850",
    "end": "1223790"
  },
  {
    "text": "So we have a -- you'll see it. If a delta t is less than 0,\nif it's very much less than 0,",
    "start": "1223790",
    "end": "1231940"
  },
  {
    "text": "then this is approaching maybe\nminus 1, but it's below 1.",
    "start": "1231940",
    "end": "1240500"
  },
  {
    "text": "So this method is A-stable. Absolutely stable.",
    "start": "1240500",
    "end": "1246730"
  },
  {
    "text": "Stable for all a less than 0.",
    "start": "1246730",
    "end": "1252530"
  },
  {
    "text": "We're fine. Delta t can be, in principle,\nas large as we like.",
    "start": "1252530",
    "end": "1260800"
  },
  {
    "text": "So we might ask, why\ndon't I just jump in one step to the time that\nI want to reach and not bother",
    "start": "1260800",
    "end": "1268700"
  },
  {
    "text": "taking a lot of small steps? What's the -- in\nthat little paradox?",
    "start": "1268700",
    "end": "1275270"
  },
  {
    "text": "It would be stable,\nbut what's no good?",
    "start": "1275270",
    "end": "1280750"
  },
  {
    "text": "So if I jumped in\none giant step, this thing would be about\nminus 1 or something.",
    "start": "1280750",
    "end": "1287630"
  },
  {
    "text": " So u here would be\nabout minus 1 times u_0,",
    "start": "1287630",
    "end": "1294260"
  },
  {
    "text": "and of course that's\nnot the answer. So why do we still\nneed a delta t?",
    "start": "1294260",
    "end": "1304030"
  },
  {
    "start": "1296000",
    "end": "1420000"
  },
  {
    "text": "Because of the\ndiscretization error. Because this isn't the\nexact differential equation,",
    "start": "1304030",
    "end": "1317410"
  },
  {
    "text": "so we still need -- we don't\nhave problem with stability,",
    "start": "1317410",
    "end": "1322640"
  },
  {
    "text": "but we still have to get the\nlocal errors down to whatever",
    "start": "1322640",
    "end": "1331310"
  },
  {
    "text": "level we want. Now what are those local\nerrors for this guy?",
    "start": "1331310",
    "end": "1337460"
  },
  {
    "text": "What are the local\nerrors for that method?",
    "start": "1337460",
    "end": "1345029"
  },
  {
    "text": "Let's see. Can we actually see it? I mean, you know what\nI'm thinking, right?",
    "start": "1345030",
    "end": "1351480"
  },
  {
    "text": "I'm thinking that\nthe local error is of order delta t cubed.",
    "start": "1351480",
    "end": "1356840"
  },
  {
    "text": "That's a second-order\nmethod for me. Delta t cubed at each step. 1 over delta t steps, so\ndelta t squared overall,",
    "start": "1356840",
    "end": "1365549"
  },
  {
    "text": "and that's second order. But do we see why this is? I mean, instinctively, we say,\nit's centered, it should be.",
    "start": "1365550",
    "end": "1373510"
  },
  {
    "text": "But let me expand\nthis to see, are we --",
    "start": "1373510",
    "end": "1382450"
  },
  {
    "text": "is e to the a delta t --\nhow close is it to 1 --",
    "start": "1382450",
    "end": "1388740"
  },
  {
    "text": "so it's approximately 1 plus\na over 2 delta t divided by 1",
    "start": "1388740",
    "end": "1397080"
  },
  {
    "text": "minus a half a delta t.",
    "start": "1397080",
    "end": "1402529"
  },
  {
    "text": "I just want to see that sure\nenough, this is second order. So of course, I have\na denominator here",
    "start": "1402530",
    "end": "1408900"
  },
  {
    "text": "that I want to multiply. So that's 1 plus a delta t\nover 2, the explicit part,",
    "start": "1408900",
    "end": "1415340"
  },
  {
    "text": "and then everybody\nknows the 1 -- there are only two series\nto know, the truth is.",
    "start": "1415340",
    "end": "1424890"
  },
  {
    "text": "We study infinite series\na lot, but the two that everybody needs to know\nare the exponential series,",
    "start": "1424890",
    "end": "1432259"
  },
  {
    "text": "which is for the left side,\nand the geometric series,",
    "start": "1432260",
    "end": "1438150"
  },
  {
    "text": "for the right side, 1\nover 1 minus x is 1 plus x",
    "start": "1438150",
    "end": "1445570"
  },
  {
    "text": "plus x squared plus so on.",
    "start": "1445570",
    "end": "1453830"
  },
  {
    "text": " So that's the -- this\ncame from the denominator,",
    "start": "1453830",
    "end": "1460450"
  },
  {
    "text": "getting it up in the numerator\nwhere I can multiply the other term and get 1 plus a\ndelta t, which is good",
    "start": "1460450",
    "end": "1469830"
  },
  {
    "text": "and what's the coefficient\nof a squared delta t squared? ",
    "start": "1469830",
    "end": "1480300"
  },
  {
    "text": "Can you see what it is? If I do that multiplication,\nwhat does -- you see it?",
    "start": "1480300",
    "end": "1490330"
  },
  {
    "text": "Where do I get a delta\nt squared from this? I get one here, times 1/4\nand I get 1 here times 1/4,",
    "start": "1490330",
    "end": "1500850"
  },
  {
    "text": "so that's 2/4, is 1/2.  So it's great, right?",
    "start": "1500850",
    "end": "1507040"
  },
  {
    "text": "It got the next term correct\nin the exponential series.",
    "start": "1507040",
    "end": "1512470"
  },
  {
    "text": "so that's why it's one\norder higher, because it got the right number there, but\nit won't get the right number",
    "start": "1512470",
    "end": "1518490"
  },
  {
    "text": "at the next step. What's the -- I'd have to\nfind out what the cube -- this would be a delta t over\n2 cubed, so what will it --",
    "start": "1518490",
    "end": "1529080"
  },
  {
    "text": "the I'll get a wrong\ncoefficient for a delta t cubed. I'll get -- that would give\nme 1/8 and this would give me",
    "start": "1529080",
    "end": "1540520"
  },
  {
    "text": "another 1/8, I think, so I think\nI'm getting two eighths out of that. I'm getting 1/4, which is wrong.",
    "start": "1540520",
    "end": "1547290"
  },
  {
    "text": "What's right there? For the exponential\nseries, it should",
    "start": "1547290",
    "end": "1552850"
  },
  {
    "text": "be one over three factorial. It should be 1/6. So I got 1/4, not\n1/6, and the error",
    "start": "1552850",
    "end": "1562759"
  },
  {
    "text": "is the difference between\nthem, which is 1/12. So 1/12 would be this number.",
    "start": "1562760",
    "end": "1570130"
  },
  {
    "text": "The local error, so\nthe local error DE",
    "start": "1570130",
    "end": "1575700"
  },
  {
    "text": "would be like the missing 1/12,\nthe delta t to the third power",
    "start": "1575700",
    "end": "1585659"
  },
  {
    "text": "now, and the third derivative. ",
    "start": "1585660",
    "end": "1592340"
  },
  {
    "text": "That's what would come out\nif I patiently went through",
    "start": "1592340",
    "end": "1599029"
  },
  {
    "text": "the estimate, just to\nsee, because we'll --",
    "start": "1599030",
    "end": "1605590"
  },
  {
    "text": "in these weeks, we'll be\ncreating difference methods for partial differential\nequations and we'll want",
    "start": "1605590",
    "end": "1613620"
  },
  {
    "text": "to know, what's\ncontrolling the error? This is the kind of calculation,\nthe beginning of a Taylor",
    "start": "1613620",
    "end": "1620660"
  },
  {
    "text": "series that answers\nthat question. So the main point is, local\nerror delta t cubed, stable",
    "start": "1620660",
    "end": "1629890"
  },
  {
    "text": "for every a delta t. So our method would move from\nEuler to trapezoidal and it",
    "start": "1629890",
    "end": "1639170"
  },
  {
    "text": "would give us a final\nerror e -- sorry, small e.",
    "start": "1639170",
    "end": "1645810"
  },
  {
    "text": "I can say it without writing it. The error, small e, would\nbe delta t to -- what power?",
    "start": "1645810",
    "end": "1652740"
  },
  {
    "text": "Squared, delta t squared. Good. The same kind of reasoning\n-- now I want to ask about --",
    "start": "1652740",
    "end": "1662700"
  },
  {
    "text": "so that takes care\nof trapezoidal, which is a pretty good method.",
    "start": "1662700",
    "end": "1667980"
  },
  {
    "text": "I think it's -- in MATLAB, it\nwould be ode something small t",
    "start": "1667980",
    "end": "1676090"
  },
  {
    "text": "for trapezoidal. Forgot -- maybe 1, 2. I should know. ",
    "start": "1676090",
    "end": "1683710"
  },
  {
    "text": "It's used quite a bit.  Of course, we're going to\nget higher than second order,",
    "start": "1683710",
    "end": "1691970"
  },
  {
    "text": "but second order is often,\nin computational mathematics, a good balance.",
    "start": "1691970",
    "end": "1698309"
  },
  {
    "text": "Newton's method for\nsolving nonlinear equation is second order and it\ndoesn't pay to go to higher.",
    "start": "1698310",
    "end": "1705130"
  },
  {
    "text": "You could invent a -- you\ncould beat Newton by going,",
    "start": "1705130",
    "end": "1710700"
  },
  {
    "text": "by inventing some third-order\nmethod for solving a nonlinear equation, but in the end,\nNewton would be the favorite.",
    "start": "1710700",
    "end": "1721240"
  },
  {
    "text": "So second order is\npretty important.  So let me point to --\nso that was implicit,",
    "start": "1721240",
    "end": "1732220"
  },
  {
    "text": "because it involved f_(n+1),\nbut Adams had another idea,",
    "start": "1732220",
    "end": "1740110"
  },
  {
    "text": "which seems like a great idea. Instead of implicit,\nusing f_(n+1),",
    "start": "1740110",
    "end": "1748170"
  },
  {
    "text": "he used the previous value,\nf_(n-1), which we already know.",
    "start": "1748170",
    "end": "1754590"
  },
  {
    "text": "We've already, at\nthat previous step, substituted u_(n-1) into f.",
    "start": "1754590",
    "end": "1763520"
  },
  {
    "text": "That might have\nbeen time consuming, but we sure had to do\nit once and we only have to do it once with Adams.",
    "start": "1763520",
    "end": "1771480"
  },
  {
    "text": "We're using something\nwe already know. This is the one new\ntime that we need it,",
    "start": "1771480",
    "end": "1776690"
  },
  {
    "text": "that we have to compute f, and\nwe get explicitly the new u.",
    "start": "1776690",
    "end": "1786120"
  },
  {
    "text": "These numbers, 3/2\nand minus 1/2 were chosen to make it second\norder and the notes",
    "start": "1786120",
    "end": "1793140"
  },
  {
    "text": "check that, that with the series\nthat it comes out to give us",
    "start": "1793140",
    "end": "1798170"
  },
  {
    "text": "the correct second term. Good. ",
    "start": "1798170",
    "end": "1804450"
  },
  {
    "text": "Let me mention\nbackward differences. ",
    "start": "1804450",
    "end": "1810270"
  },
  {
    "text": "Now we're just using one f\nand actually the implicit one,",
    "start": "1810270",
    "end": "1817600"
  },
  {
    "text": "so I'm making it implicit. So why am I interested\nin number 3 at all?",
    "start": "1817600",
    "end": "1823390"
  },
  {
    "text": "Because it's going to\nhave better stability. By being implicit and by\nchoosing these numbers,",
    "start": "1823390",
    "end": "1830530"
  },
  {
    "text": "3/2, minus 4/2, and 1/2,\nI've upped the accuracy to 2,",
    "start": "1830530",
    "end": "1837450"
  },
  {
    "text": "p equal to 2, and I've\nmaintained high stability",
    "start": "1837450",
    "end": "1843470"
  },
  {
    "text": "by making it implicit. So this one competes with this\none for importance, for use.",
    "start": "1843470",
    "end": "1853700"
  },
  {
    "text": "So you're really seeing\nthree pretty good methods that can be written down.",
    "start": "1853700",
    "end": "1858840"
  },
  {
    "text": "So these numbers\nwere chosen to get that extra accuracy, which we\ndidn't get from backward Euler.",
    "start": "1858840",
    "end": "1869590"
  },
  {
    "text": "When those numbers\nwere 1 and minus 1, backward Euler was\nonly first order.",
    "start": "1869590",
    "end": "1875080"
  },
  {
    "text": "Now this goes up to second order\nand you can guess that we can",
    "start": "1875080",
    "end": "1883890"
  },
  {
    "text": "-- that every term\nwe allow ourselves, we can choose our\ncoefficients well,",
    "start": "1883890",
    "end": "1890320"
  },
  {
    "text": "so that the order\ngoes up by one more. Now if you looked at that,\nyou might say, why not keep --",
    "start": "1890320",
    "end": "1905150"
  },
  {
    "text": "you could come back to this. Why not combine the idea of\nbackward differences, more",
    "start": "1905150",
    "end": "1912170"
  },
  {
    "text": "left-hand sides, with\nthe Adams-Bashforth idea",
    "start": "1912170",
    "end": "1917770"
  },
  {
    "text": "of more right-hand sides? Suppose I come back\nto Adams-Bashforth and create like\nan 18.086 method.",
    "start": "1917770",
    "end": "1926020"
  },
  {
    "text": "That'll be third order,\nbut still will only go back one step.",
    "start": "1926020",
    "end": "1931090"
  },
  {
    "text": "So it will somehow use\nsome combination like this, that goes back -- I'm not\nwriting this method down,",
    "start": "1931090",
    "end": "1939780"
  },
  {
    "text": "for a good reason, of course,\nbut it will use something like",
    "start": "1939780",
    "end": "1945030"
  },
  {
    "text": "this on the left side\nand something like this",
    "start": "1945030",
    "end": "1950120"
  },
  {
    "text": "on the right side and that\ngives us enough freedom,",
    "start": "1950120",
    "end": "1958280"
  },
  {
    "text": "enough coefficients to choose\n-- two coefficients there, three there -- and enough --\nthat we can get third-order",
    "start": "1958280",
    "end": "1966779"
  },
  {
    "text": "accuracy. In other words, the natural idea\nis use both U_(n-1) and f_(n-1)",
    "start": "1966780",
    "end": "1976980"
  },
  {
    "text": "in the formula to get\nthat extra accuracy. So why isn't that the\nmost famous method of all?",
    "start": "1976980",
    "end": "1984740"
  },
  {
    "text": "Why isn't that\neven on the board? You can guess.",
    "start": "1984740",
    "end": "1990230"
  },
  {
    "text": "It's violently\nunstable, so sadly,",
    "start": "1990230",
    "end": "1995410"
  },
  {
    "text": "the most accurate methods,\nwhich use both an old value of u",
    "start": "1995410",
    "end": "2001870"
  },
  {
    "text": "and an old value of f of u,\nuse both of this and this --",
    "start": "2001870",
    "end": "2007630"
  },
  {
    "text": "the numbers that show\nup here are bad news. It's a fact of life and so\nthat's why we go backwards.",
    "start": "2007630",
    "end": "2021300"
  },
  {
    "text": "We have to make a choice:\nWe go backwards with u, or Adams goes backwards with\nf, or we think of something way",
    "start": "2021300",
    "end": "2035409"
  },
  {
    "text": "to hype up the accuracy even\nfurther within one step method.",
    "start": "2035410",
    "end": "2042020"
  },
  {
    "text": "So the notes give a table,\nthe beginning of a table.",
    "start": "2042020",
    "end": "2050260"
  },
  {
    "text": "People could figure out the\nformulas for any order p,",
    "start": "2050260",
    "end": "2056230"
  },
  {
    "text": "so the notes will\ngive the beginning of a table for p equal 1,\nwhich is Euler; p equal 2,",
    "start": "2056230",
    "end": "2062119"
  },
  {
    "text": "which is this; p\nequal 3 and p equal 4, which is Adams-Bashforth\nfurther back, backward",
    "start": "2062120",
    "end": "2069870"
  },
  {
    "text": "differences further back. And those tables\nshow the constants.",
    "start": "2069870",
    "end": "2079200"
  },
  {
    "text": "So they show the 1/12\nor the 1/2 or whatever that is, and they show\nthe stability limit",
    "start": "2079200",
    "end": "2088879"
  },
  {
    "text": "and of course, that's critical. The stability limit is much\nbetter for backward differences",
    "start": "2088880",
    "end": "2097240"
  },
  {
    "text": "than it is for Adams-Bashforth. So actually, I only learned\nrecently that Adams-Bashforth,",
    "start": "2097240",
    "end": "2106410"
  },
  {
    "text": "which we all teach, which all\nbooks teach, I should say,",
    "start": "2106410",
    "end": "2111579"
  },
  {
    "text": "isn't that much used way back --\nmaybe the astronomers might use it or they might use\nbackward differences,",
    "start": "2111580",
    "end": "2119599"
  },
  {
    "text": "which are more stable. So backward differences\nhas an important role",
    "start": "2119600",
    "end": "2125500"
  },
  {
    "text": "and then one-step methods\nwill have an important role. Backward differences\nare implicit,",
    "start": "2125500",
    "end": "2131490"
  },
  {
    "text": "so those are great for stiff\n-- you turn that way for stiff",
    "start": "2131490",
    "end": "2137010"
  },
  {
    "text": "equations and for\nnonstiff equations,",
    "start": "2137010",
    "end": "2145800"
  },
  {
    "text": "let me show you what\nthe workhorse method is in a moment.",
    "start": "2145800",
    "end": "2151000"
  },
  {
    "text": "So I have a number 4 here,\nwhose name I better put up here.",
    "start": "2151000",
    "end": "2157680"
  },
  {
    "text": "Let me put up the name\nof method 4, which is two names: Runge-Kutta.",
    "start": "2157680",
    "end": "2165200"
  },
  {
    "text": " So that's a sort of\none compound step.",
    "start": "2165200",
    "end": "2172900"
  },
  {
    "start": "2172900",
    "end": "2179700"
  },
  {
    "text": "So what do I mean by --\nwhat's the point of -- this looked pretty efficient,\nbut there are two aspects that",
    "start": "2179700",
    "end": "2188470"
  },
  {
    "text": "we didn't really -- I\ndidn't really mention, and on those two aspects,\nRunge-Kutta wins by being just",
    "start": "2188470",
    "end": "2196010"
  },
  {
    "text": "a single self-contained step. So what are the\ndrawbacks of a multistep",
    "start": "2196010",
    "end": "2205550"
  },
  {
    "text": "method like this or like this? ",
    "start": "2205550",
    "end": "2211839"
  },
  {
    "text": "You have to store the\nold value, no problem, but at the beginning, at t\nequals 0, what's the problem?",
    "start": "2211840",
    "end": "2219740"
  },
  {
    "text": " You don't know the old value, so\nyou have to get started somehow",
    "start": "2219740",
    "end": "2228319"
  },
  {
    "text": "with some separate -- you\ncan't use this at t equals 0, because it's calling for a\nvalue at minus delta t and you",
    "start": "2228320",
    "end": "2236150"
  },
  {
    "text": "haven't got it. So you need -- it takes\na separate method.",
    "start": "2236150",
    "end": "2241580"
  },
  {
    "text": "You can deal with that,\ncreate -- use Runge-Kutta, for example, to get\nthat first step.",
    "start": "2241580",
    "end": "2247700"
  },
  {
    "text": "But then there's another\nproblem with these backward step methods, which again,\ncan be resolved. So this is a live method.",
    "start": "2247700",
    "end": "2256760"
  },
  {
    "text": "The other problem is, if you\nwant to change delta t -- suppose you want to\ncut delta t in half,",
    "start": "2256760",
    "end": "2263760"
  },
  {
    "text": "then this is looking for a\nvalue that's a half delta t back in time and you haven't\ngot that either,",
    "start": "2263760",
    "end": "2271640"
  },
  {
    "text": "but you've got values 1 delta\nt back and 2 delta t back",
    "start": "2271640",
    "end": "2276760"
  },
  {
    "text": "and some interpolation process\nwill produce that half value.",
    "start": "2276760",
    "end": "2283110"
  },
  {
    "text": "So what am I saying? I'm just saying\nthat getting started",
    "start": "2283110",
    "end": "2288170"
  },
  {
    "text": "takes a special\nattention, changing delta t takes a little\nspecial attention,",
    "start": "2288170",
    "end": "2294060"
  },
  {
    "text": "but still, it's all doable. So that this method, which I\ngave a name to last time --",
    "start": "2294060",
    "end": "2301339"
  },
  {
    "text": "I've forgotten what it was. I think it was\nsomething like ode15s",
    "start": "2301340",
    "end": "2308730"
  },
  {
    "text": "for stiff is much used\nfor stiff equations.",
    "start": "2308730",
    "end": "2320150"
  },
  {
    "start": "2319000",
    "end": "2398000"
  },
  {
    "text": "So now I'm left -- let\nme not only write down",
    "start": "2320150",
    "end": "2325329"
  },
  {
    "text": "Runge-Kutta's name,\nbut the other -- so multistep I've spoken about.",
    "start": "2325330",
    "end": "2330440"
  },
  {
    "text": "I just -- this is -- I'm just\ngoing to write this to remind myself to say one\nword about it -- DAE.",
    "start": "2330440",
    "end": "2339890"
  },
  {
    "text": " Can I say one word even now?",
    "start": "2339890",
    "end": "2345460"
  },
  {
    "text": "I'm sorry. Then I'll say one word later. So that's a differential\nalgebraic equation.",
    "start": "2345460",
    "end": "2354570"
  },
  {
    "text": "That's like a situation\nwhich comes up in chemical engineering and\nmany other places, in which,",
    "start": "2354570",
    "end": "2361400"
  },
  {
    "text": "out of our n given\nequations, some of them",
    "start": "2361400",
    "end": "2366990"
  },
  {
    "text": "are differential\nequations, but others are ordinary algebra equations,\nso there's no d by dt in them.",
    "start": "2366990",
    "end": "2378270"
  },
  {
    "text": "Nevertheless, we have to\nsolve, and there is a d by dt in the others. So this is a whole\nlittle world of DAEs,",
    "start": "2378270",
    "end": "2386950"
  },
  {
    "text": "which you may never meet. I have never personally met. But it has to be dealt\nwith and there are codes --",
    "start": "2386950",
    "end": "2397349"
  },
  {
    "text": "I'll just mention the\ncode DASSL by Petzold --",
    "start": "2397350",
    "end": "2403900"
  },
  {
    "start": "2398000",
    "end": "3346000"
  },
  {
    "text": "I'll finish saying the one word. A model problem here\nwould be some matrix times",
    "start": "2403900",
    "end": "2413130"
  },
  {
    "text": "u prime equal f of u and t, so\na sort of implicit differential",
    "start": "2413130",
    "end": "2423460"
  },
  {
    "text": "equation, because I'm\nnot given u prime, I'm only given M u prime.",
    "start": "2423460",
    "end": "2428700"
  },
  {
    "text": "If M is singular -- otherwise\nI could multiply by M inverse",
    "start": "2428700",
    "end": "2435310"
  },
  {
    "text": "and make it totally normal,\nbut if M, at some times t --",
    "start": "2435310",
    "end": "2442040"
  },
  {
    "text": "or M may depend on u and\nt -- it could go singular.",
    "start": "2442040",
    "end": "2448430"
  },
  {
    "text": "If it goes singular, then\nthis system is degenerating and we have to think what to do.",
    "start": "2448430",
    "end": "2453650"
  },
  {
    "text": "And this DASSL code would be\none of the good ones that does.",
    "start": "2453650",
    "end": "2460200"
  },
  {
    "text": "So that's sort of like\nmy memory to myself to say something about\nDAEs before completing",
    "start": "2460200",
    "end": "2468890"
  },
  {
    "text": "this topic of ordinary\ndifferential equations. Now for Runge-Kutta.",
    "start": "2468890",
    "end": "2474450"
  },
  {
    "text": "Let me take p equal to 2 first. The famous Runge-Kutta\nis the one at p equal --",
    "start": "2474450",
    "end": "2482130"
  },
  {
    "text": "with forth order accuracy. ",
    "start": "2482130",
    "end": "2489000"
  },
  {
    "text": "That will take more of the\nlittle internal compounded",
    "start": "2489000",
    "end": "2495990"
  },
  {
    "text": "steps than p equal\nto 2 takes, but p equal to 2 makes the point.",
    "start": "2495990",
    "end": "2501070"
  },
  {
    "text": " So this'll be simplified\nRunge-Kutta -- p equal to 2.",
    "start": "2501070",
    "end": "2509980"
  },
  {
    "text": "It'll be U_(n+1) minus U_n --\nyou see, it's just one step,",
    "start": "2509980",
    "end": "2519990"
  },
  {
    "text": "but what goes here? ",
    "start": "2519990",
    "end": "2525250"
  },
  {
    "text": "Do I remember? The notes will tell me. I better -- since it's\ngoing to be kept forever,",
    "start": "2525250",
    "end": "2532230"
  },
  {
    "text": "I better get it right. It involves f_n and f of f,\nso Runge-Kutta, here we go.",
    "start": "2532230",
    "end": "2545769"
  },
  {
    "text": "It has a half of f_n, the usual\nEuler figure out this slope.",
    "start": "2545770",
    "end": "2555110"
  },
  {
    "text": "But then, the other half is\nthe same f at -- I take Euler,",
    "start": "2555110",
    "end": "2564800"
  },
  {
    "text": "so doing this part allowed me\nto take a forward Euler step, and now I put that forward Euler\nstep in as like a U_(n+1) delta",
    "start": "2564800",
    "end": "2578730"
  },
  {
    "text": "t f_n at time --\nwhat's the right time?",
    "start": "2578730",
    "end": "2584830"
  },
  {
    "text": "Probably -- that's sort of\n-- this is like u_(n+1),",
    "start": "2584830",
    "end": "2592020"
  },
  {
    "text": "but we didn't have to do --\nwe're not implicit and so I presume that that's\nat time n plus 1.",
    "start": "2592020",
    "end": "2599050"
  },
  {
    "text": " So I've written in one\nline what the code would",
    "start": "2599050",
    "end": "2607800"
  },
  {
    "text": "have to write in two lines. The first line of code would\nbe compute f at the old U_n,",
    "start": "2607800",
    "end": "2618590"
  },
  {
    "text": "then take an Euler step,\nmultiply it by delta t and add",
    "start": "2618590",
    "end": "2624400"
  },
  {
    "text": "to U_n, so this gives\nsomething that's like U_(n+1),",
    "start": "2624400",
    "end": "2630000"
  },
  {
    "text": "but didn't cost us anything.",
    "start": "2630000",
    "end": "2635420"
  },
  {
    "text": "So can you compare\nthat with trapezoidal? ",
    "start": "2635420",
    "end": "2641330"
  },
  {
    "text": "You see, the comparison with\ntrapezoidal is trapezoidal has the 1/2 f_n, the same, but it\nhas the 1/2 f_(n+1) at the new",
    "start": "2641330",
    "end": "2652340"
  },
  {
    "text": "step, involving the new U_(n+1),\nwhere this one is something",
    "start": "2652340",
    "end": "2659620"
  },
  {
    "text": "like it, but something we\nalready knew from Euler. So that's the natural idea.",
    "start": "2659620",
    "end": "2667120"
  },
  {
    "text": "All these ideas actually\nwould occur to all of us, if we started thinking\nabout these for a few weeks.",
    "start": "2667120",
    "end": "2675440"
  },
  {
    "text": "But, I guess I'm not planning\nto spend a few weeks on that, so I'm just jumping ahead to\nwhat people have thought of.",
    "start": "2675440",
    "end": "2686610"
  },
  {
    "text": "So that's, you could\nsay, two-step Euler.",
    "start": "2686610",
    "end": "2691680"
  },
  {
    "text": "There's two evaluations\nof f within a step.",
    "start": "2691680",
    "end": "2698700"
  },
  {
    "text": "So what's p equal 4? The famous Runge-Kutta\nis four of those.",
    "start": "2698700",
    "end": "2704670"
  },
  {
    "text": "So you take --\nthere's an Euler step. That'll be step one. Then you'll stick that into\nsomething, at step n plus 1/2.",
    "start": "2704670",
    "end": "2713890"
  },
  {
    "text": "That'll be a second\nevaluation of f. That'll give you some output. You plug that in and\nthat will actually,",
    "start": "2713890",
    "end": "2722480"
  },
  {
    "text": "if it's correctly chosen, be\nanother, better approximation at 1/2, at n plus 1/2.",
    "start": "2722480",
    "end": "2728440"
  },
  {
    "text": "You put that into\nthe fourth one, which will give you something\nclose to U_(n+1) and then you",
    "start": "2728440",
    "end": "2734180"
  },
  {
    "text": "take the right weights. Here they were 1/2 and 1/2. ",
    "start": "2734180",
    "end": "2739890"
  },
  {
    "text": "Anyway, you can do it. The algebra begins to get\nmessy beyond p equal 4,",
    "start": "2739890",
    "end": "2746150"
  },
  {
    "text": "but you can go beyond p equal 4. I mean, there's books\non Runge-Kutta methods",
    "start": "2746150",
    "end": "2753180"
  },
  {
    "text": "because the algebra gets\n-- of these f of f of f. If there's anything that -- any\nconstruction in math that looks",
    "start": "2753180",
    "end": "2762330"
  },
  {
    "text": "so easy, just take f of f\nof f of f of a function,",
    "start": "2762330",
    "end": "2769080"
  },
  {
    "text": "of a number. That seems so simple, but\nactually it's extremely hard",
    "start": "2769080",
    "end": "2774510"
  },
  {
    "text": "to understand what happens. Maybe you know that Mandelbrot's\nfractal sets and all",
    "start": "2774510",
    "end": "2782430"
  },
  {
    "text": "these problems of chaos\ncome exactly that way and they're extremely hard\nto see what's happening.",
    "start": "2782430",
    "end": "2789940"
  },
  {
    "text": "When you do repeated\ncomposition, you would call that f of f of f.",
    "start": "2789940",
    "end": "2797759"
  },
  {
    "text": "So Runge-Kutta stops\nat 4 and then there",
    "start": "2797760",
    "end": "2803740"
  },
  {
    "text": "is actually an\nimplicit Runge-Kutta that people work\non, but I don't dare to begin to write that\ndown and I won't even",
    "start": "2803740",
    "end": "2810910"
  },
  {
    "text": "write the details of that\none, which are in our notes and in every set of notes.",
    "start": "2810910",
    "end": "2817100"
  },
  {
    "text": "But what's the point?  First, we get the\naccuracy, so what's",
    "start": "2817100",
    "end": "2824420"
  },
  {
    "text": "the other thing you\nhave to ask about? Stability. So what does our\nstability calculation",
    "start": "2824420",
    "end": "2831940"
  },
  {
    "text": "give for Runge-Kutta? ",
    "start": "2831940",
    "end": "2838960"
  },
  {
    "text": "The thing that you\nhave to work with, actually, turns out\nto be quite nice. It's just the series for\ne to the a*t chopped off",
    "start": "2838960",
    "end": "2850010"
  },
  {
    "text": "at the power, however\nfar you're going. So this is Runge-Kutta\nstability, p equal to 2.",
    "start": "2850010",
    "end": "2864480"
  },
  {
    "text": "The growth factor\nwill be from -- if I just do this and I take\nthe model problem, f equal a*u,",
    "start": "2864480",
    "end": "2876140"
  },
  {
    "text": "you could -- if I took\nthat out of there, the growth factor will be 1 plus\na delta t plus 1/2 a delta t",
    "start": "2876140",
    "end": "2886540"
  },
  {
    "text": "squared. Stop. ",
    "start": "2886540",
    "end": "2893540"
  },
  {
    "text": "That's what this would\ngive, for the model problem, as the growth factor that\nmultiplies each U to get",
    "start": "2893540",
    "end": "2899990"
  },
  {
    "text": "the next U. What p equal 4 would\ngive would be the same thing",
    "start": "2899990",
    "end": "2910420"
  },
  {
    "text": "plus -- it's just the right\n-- it's just the exponential series chopped off\nat the fourth term.",
    "start": "2910420",
    "end": "2923369"
  },
  {
    "text": "So of course, you\nsee immediately, what's the discretization error? It's delta t of the fifth.",
    "start": "2923370",
    "end": "2929420"
  },
  {
    "text": "It's the first missing term\nthat Runge-Kutta didn't capture,",
    "start": "2929420",
    "end": "2937640"
  },
  {
    "text": "multiplied by 1\nover 5 factorial, so you know right away that\nthe constant is 1 over 120,",
    "start": "2937640",
    "end": "2943740"
  },
  {
    "text": "which is pretty good. But the question\nis the stability.",
    "start": "2943740",
    "end": "2950070"
  },
  {
    "text": "So what do we want to know here? We want to know -- so let\nme let a delta t be some --",
    "start": "2950070",
    "end": "2958170"
  },
  {
    "text": "because that same number is\ncoming up -- let me call it z, right? So the stability test,\nfor p equal to 2,",
    "start": "2958170",
    "end": "2966790"
  },
  {
    "text": "is to look at the\nmagnitude of 1 plus z plus 1/2 z squared and we\nwant it to be less than",
    "start": "2966790",
    "end": "2975925"
  },
  {
    "text": "or equal to 1.",
    "start": "2975925",
    "end": "2983370"
  },
  {
    "text": "Now, the point is,\nthis is something -- I hope you try\nthis this weekend.",
    "start": "2983370",
    "end": "2990530"
  },
  {
    "text": "Somehow get MATLAB to plot,\nin the complex plane -- see you really -- up there now\nwe've just -- at some point z,",
    "start": "2990530",
    "end": "3000990"
  },
  {
    "text": "some negative value of z -- it's\ngoing to hit 1 and then after that, it's going to be unstable.",
    "start": "3000990",
    "end": "3011040"
  },
  {
    "text": "Of course, there's got to be\na point where it's unstable. This is an explicit method.",
    "start": "3011040",
    "end": "3016420"
  },
  {
    "text": "Runge-Kutta is explicit. So it can't -- if the\nproblem is too stiff,",
    "start": "3016420",
    "end": "3022820"
  },
  {
    "text": "we're going to be killed, but\nif it's an ordinary problem, this is a winner.",
    "start": "3022820",
    "end": "3028880"
  },
  {
    "text": "So p equal 4, this is the\ncode ode45, which uses --",
    "start": "3028880",
    "end": "3035029"
  },
  {
    "text": "combines Runge-Kutta with 4 on\na higher-order formula to get",
    "start": "3035030",
    "end": "3041960"
  },
  {
    "text": "an estimate for the\nerror in that step.",
    "start": "3041960",
    "end": "3047770"
  },
  {
    "text": "So I could make some comment\non predictor-corrector methods, but I'll leave\nthat in the notes.",
    "start": "3047770",
    "end": "3054100"
  },
  {
    "text": "So, what does that\nregion look like?",
    "start": "3054100",
    "end": "3062430"
  },
  {
    "text": "And then, the other one is, what\ndoes the region 1 plus the z plus 1/2 z squared plus\n1/6 z cubed plus 1/24 z",
    "start": "3062430",
    "end": "3072820"
  },
  {
    "text": "to the fourth,\nless or equal 1 -- what's that region look like?",
    "start": "3072820",
    "end": "3078760"
  },
  {
    "text": "I mean, if those regions\nare small, the method loses.",
    "start": "3078760",
    "end": "3084680"
  },
  {
    "text": "If those regions\nare bigger than we get from Adams-Bashforth\nor backward differences,",
    "start": "3084680",
    "end": "3090829"
  },
  {
    "text": "then the methods in there\nare good, successful.",
    "start": "3090830",
    "end": "3098240"
  },
  {
    "text": "I've forgotten exactly what\nthe picture is like there.",
    "start": "3098240",
    "end": "3103260"
  },
  {
    "text": "Why am I in the complex plane? Because the number\na -- z is a delta t.",
    "start": "3103260",
    "end": "3110430"
  },
  {
    "text": "That number a can be complex. How can it be complex?",
    "start": "3110430",
    "end": "3116110"
  },
  {
    "text": "I'm not really thinking that\nour model equation u prime equal a*u will be complex, but our\nmodel system would be u prime",
    "start": "3116110",
    "end": "3125400"
  },
  {
    "text": "equals a matrix times u and then\nit's the eigenvalues of that",
    "start": "3125400",
    "end": "3131270"
  },
  {
    "text": "matrix that take the\nplace of little a.",
    "start": "3131270",
    "end": "3138010"
  },
  {
    "text": "So we have n different\nlittle a's going for a system and the eigenvalues of a totally\nreal matrix can be nonreal,",
    "start": "3138010",
    "end": "3148330"
  },
  {
    "text": "can be complex numbers. Let's just think when that\nhappens and then I'll --",
    "start": "3148330",
    "end": "3155797"
  },
  {
    "text": "what does the figure looks like? For p equals 4, I sort of\nremember that the figure even",
    "start": "3155797",
    "end": "3161009"
  },
  {
    "text": "captures a little bit of that\nplane and then it goes -- why should I mess\nup the board with --",
    "start": "3161010",
    "end": "3172570"
  },
  {
    "text": "it's a pretty good-sized region. It's probably not\nshaped like that at all,",
    "start": "3172570",
    "end": "3179390"
  },
  {
    "text": "but the point is, maybe\nthis reaches out to about e,",
    "start": "3179390",
    "end": "3184809"
  },
  {
    "text": "minus e. I think it does,\nsomewhere around -- I don't know if that's\nan accurate -- right, reaches out around minus --\nand reaches up to around 2.",
    "start": "3184810",
    "end": "3195780"
  },
  {
    "text": "So in this last second, I\nwas just going to say -- and we'll see it plenty of times\n-- where do we get complex --",
    "start": "3195780",
    "end": "3203640"
  },
  {
    "text": "where do we get nice,\nreal, big systems, stiff systems with complex\neigenvalues in real",
    "start": "3203640",
    "end": "3213430"
  },
  {
    "text": "calculations? By real calculations,\nI really mean PDEs.",
    "start": "3213430",
    "end": "3220560"
  },
  {
    "text": "So in a partial\ndifferential equation -- so this is just a throw-away\ncomment that we'll deal with",
    "start": "3220560",
    "end": "3228130"
  },
  {
    "text": "again -- in partial\ndifferential equations, a u_(x,x) term or a u_(y,y)\nterm -- that get multiplied,",
    "start": "3228130",
    "end": "3238920"
  },
  {
    "text": "typically, by diffusion,\nthose are diffusion terms --",
    "start": "3238920",
    "end": "3245309"
  },
  {
    "text": "those produce symmetric things,\nsymmetric negative definite.",
    "start": "3245310",
    "end": "3250790"
  },
  {
    "text": "But convection, advection\nterms, velocity terms that get",
    "start": "3250790",
    "end": "3257120"
  },
  {
    "text": "multiplied by some -- that\nare first derivatives -- those produce -- those\nare antisymmetric.",
    "start": "3257120",
    "end": "3265890"
  },
  {
    "text": "Those produce these\ncomplex eigenvalues that we have to deal with. So, everybody wants to\nsolve convection-diffusion.",
    "start": "3265890",
    "end": "3276480"
  },
  {
    "text": "Convection has these\nterms, diffusion has these. The coefficient\nmay be very small.",
    "start": "3276480",
    "end": "3282770"
  },
  {
    "text": "The hard -- that's\nthe hard case, when the convection is serious. It's pushing us up\nthe imaginary axis,",
    "start": "3282770",
    "end": "3290970"
  },
  {
    "text": "where this is bringing\nus to the left and we're going to spend\ntime thinking of good methods",
    "start": "3290970",
    "end": "3298740"
  },
  {
    "text": "for that. So my homework -- would you like\nfigure out this region and make",
    "start": "3298740",
    "end": "3305470"
  },
  {
    "text": "a better pictures? Get MATLAB to do it and try\nany one of these methods",
    "start": "3305470",
    "end": "3312829"
  },
  {
    "text": "on the model problem. Try a method or two.",
    "start": "3312830",
    "end": "3318470"
  },
  {
    "text": "See whether the stability, the\ntheoretical stability limit is serious.",
    "start": "3318470",
    "end": "3323560"
  },
  {
    "text": "I mean, does the limit\nof a delta t -- can we --",
    "start": "3323560",
    "end": "3331450"
  },
  {
    "text": "as I'm driving to MIT, I\nsometimes exceed the speed limit, the stability limit.",
    "start": "3331450",
    "end": "3339069"
  },
  {
    "text": "Is that OK or not with\nfinite differences? I'll see you Monday.",
    "start": "3339070",
    "end": "3344780"
  },
  {
    "text": "All right, thanks. Have a good weekend.",
    "start": "3344780",
    "end": "3347480"
  }
]