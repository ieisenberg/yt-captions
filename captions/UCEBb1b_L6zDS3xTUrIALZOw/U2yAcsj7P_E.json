[
  {
    "start": "0",
    "end": "75000"
  },
  {
    "text": " The following content is\nprovided under a Creative Commons license. Your support will help\nMIT OpenCourseWare",
    "start": "0",
    "end": "7080"
  },
  {
    "text": "continue to offer high-quality,\neducational resources for free. To make a donation or to\nview additional materials",
    "start": "7080",
    "end": "13740"
  },
  {
    "text": "from hundreds of MIT courses,\nvisit MIT OpenCourseWare at ocw.mit.edu. ",
    "start": "13740",
    "end": "22840"
  },
  {
    "text": "NEHA NARULA: Welcome back. Today, we are going\nto talk about forks.",
    "start": "22840",
    "end": "29860"
  },
  {
    "text": "So I think you guys have had\na guest lecture last week from Alin Tomescu, who talked\nabout his project, Catena.",
    "start": "29860",
    "end": "37780"
  },
  {
    "text": "And one of the really\ninteresting things about Catena is that he's trying to prevent\na server from equivocating.",
    "start": "37780",
    "end": "44470"
  },
  {
    "text": "So he's trying to keep\na server from being able to say one answer to\nsome people and another answer to another person.",
    "start": "44470",
    "end": "51039"
  },
  {
    "text": "That's kind of the goal of\nthis whole blockchain thing. But there's actually\nsomething really complex",
    "start": "51040",
    "end": "57969"
  },
  {
    "text": "that happens when we\nstart to change what's happening in the\nnetwork, and we start",
    "start": "57970",
    "end": "63580"
  },
  {
    "text": "to change the software that's\nhappening in the network. And so this lecture is\ngoing to be about forks.",
    "start": "63580",
    "end": "70240"
  },
  {
    "text": "And I want you guys to feel\nfree to raise your hands and ask questions during class,\nbecause this stuff is actually",
    "start": "70240",
    "end": "77170"
  },
  {
    "start": "75000",
    "end": "217000"
  },
  {
    "text": "kind of non-intuitive sometimes. So a blockchain is a chain of\nblocks which have previous hash",
    "start": "77170",
    "end": "84370"
  },
  {
    "text": "pointers inside of them. So a question-- can a block\npoint to two previous blocks",
    "start": "84370",
    "end": "90610"
  },
  {
    "text": "at the same time? Anybody know the answer\nto this question? No, exactly, that\nis the whole point.",
    "start": "90610",
    "end": "96820"
  },
  {
    "text": "There is exactly one\nspot in the block header for a previous hash block.",
    "start": "96820",
    "end": "102580"
  },
  {
    "text": "And so a block can only\npoint to one previous block. A single block cannot point\nto two previous blocks.",
    "start": "102580",
    "end": "110360"
  },
  {
    "text": "However, can this happen? Can two different blocks point\nto the same previous block header?",
    "start": "110360",
    "end": "116270"
  },
  {
    "text": "Yes, yes, and this\nhappens all the time. Now, part of the reason that\nthis happens all the time",
    "start": "116270",
    "end": "123310"
  },
  {
    "text": "is because the way\nthat blocks are found in the bitcoin network\nis completely probabilistic.",
    "start": "123310",
    "end": "129759"
  },
  {
    "text": "There are many\npeople who are trying to find the next block\nat the same time. And it's entirely possible\nthat two different miners",
    "start": "129759",
    "end": "136930"
  },
  {
    "text": "will get lucky in\na time period that is within the time it takes\nfor a block to get gossipped",
    "start": "136930",
    "end": "142720"
  },
  {
    "text": "around the network. And so, totally, two people\ncan find the same block at the same time. This is actually\nwhat's known as a fork.",
    "start": "142720",
    "end": "150819"
  },
  {
    "text": "And you can kind of see why. We have a fork in\nthe chain right here. But what does it\nreally mean when",
    "start": "150820",
    "end": "157990"
  },
  {
    "text": "there's a fork in the chain? I just told you that\nthis is something that happens all the time.",
    "start": "157990",
    "end": "163299"
  },
  {
    "text": "And these cryptocurrency\nnetworks seem to keep running. They seem to be keep going. So perhaps it's not\nas bad as it seems,",
    "start": "163300",
    "end": "171820"
  },
  {
    "text": "even though it seems\nto be violating one of the major tenets\nof what a blockchain is.",
    "start": "171820",
    "end": "177250"
  },
  {
    "text": "Well, it is kind\nof bad, actually, because when you have\nthese two blocks here,",
    "start": "177250",
    "end": "182650"
  },
  {
    "text": "is there anything that makes\none the right blockchain over the other blockchain? Just if this is one\nblockchain right here,",
    "start": "182650",
    "end": "190030"
  },
  {
    "text": "and this is another\nblockchain right there, how is one supposed to\ndistinguish between this? Yeah?",
    "start": "190030",
    "end": "195430"
  },
  {
    "text": "AUDIENCE: The one\nwith the most work. NEHA NARULA: The one\nwith the most work, OK, that's a great sort of\nway of thinking about it.",
    "start": "195430",
    "end": "202215"
  },
  {
    "text": "What if they have similar\namounts of proof of work. Then what? AUDIENCE: The one\nthat's accepted by the majority of the network. NEHA NARULA: The\none that's accepted",
    "start": "202215",
    "end": "208300"
  },
  {
    "text": "by the majority of the network. How do we know which\none is accepted by the majority of the network?",
    "start": "208300",
    "end": "213380"
  },
  {
    "text": "It gets extended, OK, great. So that's a really good\nway of looking at it.",
    "start": "213380",
    "end": "219910"
  },
  {
    "start": "217000",
    "end": "312000"
  },
  {
    "text": "Before we go into\nwhat that means, do people understand why if\nthis state were to persist",
    "start": "219910",
    "end": "226390"
  },
  {
    "text": "it would be a really\nbad situation? One thing that we\ncould have, given that there's two blocks,\nwhat that really means",
    "start": "226390",
    "end": "232750"
  },
  {
    "text": "is that we have two\nversions of history. We have two versions\nof the ledger if these two things\nare not the same.",
    "start": "232750",
    "end": "238270"
  },
  {
    "text": "Different coins might be\nspent on one side of the fork, versus on the other\nside of the fork.",
    "start": "238270",
    "end": "244270"
  },
  {
    "text": "In fact, the same coin might be\nspent in two different people on either sides of these forks.",
    "start": "244270",
    "end": "250599"
  },
  {
    "text": "And so over here, Alice might\nbe spending her coin to Bob. Over here, Alex might be\nspending that same coin--",
    "start": "250600",
    "end": "256269"
  },
  {
    "text": "and, remember, coins\ncan only be spent once. Even if Alice has\nother coins, she specifies which\ncoin she's spending.",
    "start": "256269",
    "end": "262610"
  },
  {
    "text": "Alice might spend that\ncoin over to Carol. And so if Bob sees this,\nhe thinks he got paid.",
    "start": "262610",
    "end": "267790"
  },
  {
    "text": "If Carol sees this, she\nthinks she got paid. And we violated one of\nthe fundamental tenets",
    "start": "267790",
    "end": "273789"
  },
  {
    "text": "of the blockchain, which is\nnot to double spend coins. You can't create\nmoney out of nowhere. ",
    "start": "273790",
    "end": "280770"
  },
  {
    "text": "If these two things\nwould persist, if we don't resolve\nthis fork somehow,",
    "start": "280770",
    "end": "287130"
  },
  {
    "text": "then we literally have\ntwo different versions of the same currency.",
    "start": "287130",
    "end": "293890"
  },
  {
    "text": "This is kind of as\nthough I took the money in my pocket, my dollar\nbill, and I xeroxed them all,",
    "start": "293890",
    "end": "300820"
  },
  {
    "text": "and managed to convince some\npeople that the Xerox was also real. This is the exact\nsame thing as what's",
    "start": "300820",
    "end": "307569"
  },
  {
    "text": "happening when you have\nthese two things persist.",
    "start": "307570",
    "end": "312740"
  },
  {
    "start": "312000",
    "end": "334000"
  },
  {
    "text": "OK, so how do we fix it? Well, which is the right one?",
    "start": "312740",
    "end": "319800"
  },
  {
    "text": "And just given what I've\nshown you right here, it is not clear which\nis the right one. And like I also said,\nthis happens all the time",
    "start": "319800",
    "end": "326957"
  },
  {
    "text": "in the bitcoin network\nbecause the bitcoin network is probabilistic. So the way that people figure\nout which one is the right one",
    "start": "326957",
    "end": "334680"
  },
  {
    "text": "is they wait. They wait and see which\nside gets extended.",
    "start": "334680",
    "end": "339760"
  },
  {
    "text": "And by the nature\nof probability, one side is going to eventually\nwin out, and get extended",
    "start": "339760",
    "end": "345360"
  },
  {
    "text": "more often than the other side. It's very unlikely for\ntwo forks to randomly sort",
    "start": "345360",
    "end": "351090"
  },
  {
    "text": "of probabilistically exist\nat roughly the same way for the same amount\nof time for very long.",
    "start": "351090",
    "end": "357220"
  },
  {
    "text": "Now, as someone said,\nyou might look at this. How do you distinguish\nbetween these two things?",
    "start": "357220",
    "end": "362940"
  },
  {
    "text": "There is this common idea\nthat in blockchains we take the longest chain. Longest is a little bit\nmisleading actually.",
    "start": "362940",
    "end": "370530"
  },
  {
    "text": "It's not the longest chain. It's the heaviest work chain. So we pick the chain that\nhas the most proof of work",
    "start": "370530",
    "end": "378870"
  },
  {
    "text": "on it, even if that\nhappens to have a smaller number of blocks. Usually that's not the case.",
    "start": "378870",
    "end": "384009"
  },
  {
    "text": "That's not what happens. The reason for\nthat-- does anyone know why we take the heaviest\nchain instead of the longest",
    "start": "384010",
    "end": "389250"
  },
  {
    "text": "chain?  AUDIENCE: So that nobody\ncan cheat and lower",
    "start": "389250",
    "end": "395370"
  },
  {
    "text": "the level of difficulty. NEHA NARULA: Right, so it's\nnot very easy to do this. But over time,\nsomeone could slowly",
    "start": "395370",
    "end": "401550"
  },
  {
    "text": "decrease difficulty\nlevel, and then create a nice, really long\nchain with many low difficulty",
    "start": "401550",
    "end": "407430"
  },
  {
    "text": "blocks, and then say, hey,\nI've got the longest chain. I have the most\nnumber of blocks. Despite the fact that your chain\nhas more proof of work on it,",
    "start": "407430",
    "end": "414990"
  },
  {
    "text": "you should all take my chain. And they could do that\nwith less than a majority of the hash power.",
    "start": "414990",
    "end": "421142"
  },
  {
    "text": "Now, this is not\neasy attack to do. But it is a possible attack. And so that's why we take\nthe heaviest chain, which",
    "start": "421142",
    "end": "426380"
  },
  {
    "start": "425000",
    "end": "470000"
  },
  {
    "text": "represents the most hash power\nin the system, the majority of the system.",
    "start": "426380",
    "end": "432500"
  },
  {
    "text": "So forks happen all the time. Forks are normal.",
    "start": "432500",
    "end": "439439"
  },
  {
    "text": "The way that people\nwho see forks decide which side of the\nfork to use, is they",
    "start": "439440",
    "end": "445940"
  },
  {
    "text": "check and see which one\nhas the most proof of work, the heaviest proof of work. Now, one thing\nthat's kind of cool,",
    "start": "445940",
    "end": "452780"
  },
  {
    "text": "is, as you probably learned\nabout two classes ago, even SPV nodes,\neven clients, can",
    "start": "452780",
    "end": "460130"
  },
  {
    "text": "tell which chain has\nthe most proof of work simply by looking at the\nheaders, the block headers.",
    "start": "460130",
    "end": "466159"
  },
  {
    "text": "They can see what\nthe difficulty is. And they can measure\nfor themselves which side of the chain\nhas the most proof of work. They don't even need\nall of the chain.",
    "start": "466159",
    "end": "472980"
  },
  {
    "start": "470000",
    "end": "537000"
  },
  {
    "text": "So this is a nice\nproperty of light clients, is that they can download\nall of the block headers and immediately tell\nwhich side of a fork",
    "start": "472980",
    "end": "480229"
  },
  {
    "text": "has the most proof of work. Great, we call the block\nthat ends up-- so what",
    "start": "480230",
    "end": "488068"
  },
  {
    "text": "do we do with this block? Does anyone know what actually\nhappens with this block?",
    "start": "488068",
    "end": "493330"
  },
  {
    "text": "Anybody? OK, so this book is\nbasically abandoned.",
    "start": "493330",
    "end": "499790"
  },
  {
    "text": "This block is just left. It exists. It points into the chain. That's great.",
    "start": "499790",
    "end": "505780"
  },
  {
    "text": "In bitcoin, in particular,\nit's meaningless. It doesn't mean anything. Every transaction\nthat was in that block",
    "start": "505780",
    "end": "512870"
  },
  {
    "text": "is not considered\nto have happened. So those transactions\nneed to be replayed on the chain that ends up\nbeing the longest chain.",
    "start": "512870",
    "end": "521270"
  },
  {
    "text": "And this happens, like\nI said, all the time. We call that block an orphan,\nbecause it doesn't have anyone.",
    "start": "521270",
    "end": "528500"
  },
  {
    "text": "It's kind of the\nwrong way around. I mean, I think of\nthis as a child. But, whatever, this block\ndoesn't have a parent.",
    "start": "528500",
    "end": "533980"
  },
  {
    "text": "But we call those\nblocks orphans. And, again, remember,\nwe pick the side of the chain that ends up\nhaving the most proof of work.",
    "start": "533980",
    "end": "543070"
  },
  {
    "start": "537000",
    "end": "643000"
  },
  {
    "text": "Now, we draw these figures\nin two different ways. Sometimes we draw the\nfigures like this,",
    "start": "543070",
    "end": "549070"
  },
  {
    "text": "like there's this blockchain\nthat exists out there, that is written down, and that\neveryone is sort of looking at.",
    "start": "549070",
    "end": "555790"
  },
  {
    "text": "There's one blockchain. But this isn't a\nlogical representation. In reality, there are many,\nmany, many, many different",
    "start": "555790",
    "end": "563529"
  },
  {
    "text": "blockchains. In fact, every\nnode in the system has its own version\nof the blockchain.",
    "start": "563530",
    "end": "568750"
  },
  {
    "text": "And it's what those\nnodes are doing together that ends up deciding what\nthe blockchain actually is.",
    "start": "568750",
    "end": "574610"
  },
  {
    "text": "So if these are nodes that are\nrunning the bitcoin protocol, and when I say nodes,\nwhat's the difference",
    "start": "574610",
    "end": "582590"
  },
  {
    "text": "between a miner and a node? ",
    "start": "582590",
    "end": "589640"
  },
  {
    "text": "AUDIENCE: Nodes\nverify transactions, but miners push blocks.",
    "start": "589640",
    "end": "595319"
  },
  {
    "text": "NEHA NARULA: Exactly,\nso miners actually create blocks in the system. Miners have write access\nto the blockchain.",
    "start": "595320",
    "end": "602880"
  },
  {
    "text": "They actually\nproduce new blocks. People think a lot about\nwhat the miners are,",
    "start": "602880",
    "end": "608940"
  },
  {
    "text": "and what the miners can do. And there's a lot of game theory\nthinking about the miners. And, oh, what if they collude,\nbut the hash power does this?",
    "start": "608940",
    "end": "615000"
  },
  {
    "text": "And sometimes we forget that\nnodes in the bitcoin network are actually incredibly\nimportant too, because it's the nodes\nin the bitcoin network",
    "start": "615000",
    "end": "621082"
  },
  {
    "text": "that are now creating blocks. And, to be clear,\nsomeone could be a miner and a node at the same time. They're distinct roles.",
    "start": "621082",
    "end": "627360"
  },
  {
    "text": "The same entity could certainly\nrun a node and be a miner. But nodes are doing\nsomething really important",
    "start": "627360",
    "end": "633270"
  },
  {
    "text": "as well, which is they're\nreading all of the blocks. And they're deciding which\nside of a fork to take,",
    "start": "633270",
    "end": "639569"
  },
  {
    "text": "and which blocks to accept and\nwhich blocks not to accept. So let's say that these\nare all bitcoin nodes.",
    "start": "639570",
    "end": "646770"
  },
  {
    "start": "643000",
    "end": "762000"
  },
  {
    "text": "And this is what the blockchain\nlooks like right now. And we've used this\nfigure multiple times.",
    "start": "646770",
    "end": "653670"
  },
  {
    "text": "Every block has a previous\nhash, which acts as a pointer to the previous block.",
    "start": "653670",
    "end": "661050"
  },
  {
    "text": "Every block has a\nset of transactions. And every block\nhas a nonce, such",
    "start": "661050",
    "end": "666180"
  },
  {
    "text": "that when you take the\nhash of the block header, you end up with something\nthat has a sufficient number",
    "start": "666180",
    "end": "672449"
  },
  {
    "text": "of leading zeros. It has valid proof of work. ",
    "start": "672450",
    "end": "677710"
  },
  {
    "text": "So let's say that this is the\nstate of the system right now. And then, we see this\nnew block come along.",
    "start": "677710",
    "end": "685890"
  },
  {
    "text": "So what happens here is that a\nminer has produced this block, and has sent it out over\nthe bitcoin network.",
    "start": "685890",
    "end": "692890"
  },
  {
    "text": "They've started gossiping\nthe block around the bitcoin network. And so every one of these nodes,\nhopefully, will eventually,",
    "start": "692890",
    "end": "698910"
  },
  {
    "text": "if they're well connected,\nwill see this block. They're going to see the\nblock at different times. And they're each going to\nmake an independent decision",
    "start": "698910",
    "end": "708000"
  },
  {
    "text": "about the block. So every node is going\nto decide when it sees",
    "start": "708000",
    "end": "713190"
  },
  {
    "text": "this block what to do with it. And there's basically two\nthings it can do with it.",
    "start": "713190",
    "end": "719110"
  },
  {
    "text": "One, it can add it to\nits own local version of the blockchain.",
    "start": "719110",
    "end": "725250"
  },
  {
    "text": "And number two,\nit can reject it. Does everyone see why that is?",
    "start": "725250",
    "end": "733110"
  },
  {
    "text": "So sure, every node is\nmaintaining this local copy of a blockchain. There is no single,\nglobal copy that everyone",
    "start": "733110",
    "end": "741000"
  },
  {
    "text": "is referring to physically. There's no single database\nrunning the blockchain. Every node has its own local\ncopy of the blockchain.",
    "start": "741000",
    "end": "747029"
  },
  {
    "text": "Every node is making its\nown local decisions about whether or not a block is\nvalid, and about whether or not",
    "start": "747030",
    "end": "754020"
  },
  {
    "text": "it's going to add that\nblock to its own local copy of its blockchain. ",
    "start": "754020",
    "end": "761350"
  },
  {
    "text": "So the way that the\nnode decides this is that it has a set\nof validation rules.",
    "start": "761350",
    "end": "768670"
  },
  {
    "start": "762000",
    "end": "923000"
  },
  {
    "text": "So it has its own set of\nrules, which are specified by the bitcoin protocol.",
    "start": "768670",
    "end": "775300"
  },
  {
    "text": "And it checks that block against\nits set of validation rules.",
    "start": "775300",
    "end": "780670"
  },
  {
    "text": "So every node,\nevery bitcoin node, is constantly validating,\nconstantly validating blocks.",
    "start": "780670",
    "end": "785860"
  },
  {
    "text": "Here are just some of\nthe validation rules. And we've talked about a lot\nof these sort of off and on",
    "start": "785860",
    "end": "791170"
  },
  {
    "text": "during the class. So first of all, there's\na max block size. And the way that this\nworks is if at any point",
    "start": "791170",
    "end": "798610"
  },
  {
    "text": "you fail one of these validation\nrules, you reject the block. So first, the block has to be\nsmaller than this variable max",
    "start": "798610",
    "end": "806740"
  },
  {
    "text": "block size. At the moment, max block\nsize is set to 1 megabyte.",
    "start": "806740",
    "end": "812080"
  },
  {
    "text": "Every single transaction in\nthe block also has to be valid. And what does that mean?",
    "start": "812080",
    "end": "817855"
  },
  {
    "text": "Well, it needs to be\nformatted a certain way. And it also means that when\nwe concatenate the script pub",
    "start": "817855",
    "end": "823870"
  },
  {
    "text": "key and the script sig\ntogether, and then run that through the\ninterpreter to evaluate",
    "start": "823870",
    "end": "830170"
  },
  {
    "text": "the script on the stack,\nit ends up returning true.",
    "start": "830170",
    "end": "835779"
  },
  {
    "text": "And if at any point, any\ntransaction-- and not just any transaction, any\ninput in any transaction, does not satisfy this, we\nreject the entire block.",
    "start": "835780",
    "end": "843399"
  },
  {
    "text": " Another thing that\neach transaction",
    "start": "843400",
    "end": "848410"
  },
  {
    "text": "needs to satisfy if it's valid,\nis if the transaction specifies an end lock time,\nthan that end lock",
    "start": "848410",
    "end": "855300"
  },
  {
    "text": "time needs to be greater\nthan whatever is specified in the transaction. That transaction is now is\nnow far enough in the future",
    "start": "855300",
    "end": "862900"
  },
  {
    "text": "that it can be satisfied. The block as a whole needs\nto have valid proof of work.",
    "start": "862900",
    "end": "869200"
  },
  {
    "text": "So it needs to\nhave a nonce, such that when you hash\nthe block header, you end up with a hash that\nhas a certain number of leading",
    "start": "869200",
    "end": "875830"
  },
  {
    "text": "zeros. And what's really interesting\nis the protocol also",
    "start": "875830",
    "end": "880930"
  },
  {
    "text": "specifies exactly how many\nleading zeros there need to be, depending upon how many\nleading zeros there have",
    "start": "880930",
    "end": "888020"
  },
  {
    "text": "been in blocks in the past.  There cannot be\nany double spends.",
    "start": "888020",
    "end": "893560"
  },
  {
    "text": "So given the version of the\nblockchain that I, as a node, have, this better not be\ndouble spending any outputs.",
    "start": "893560",
    "end": "902070"
  },
  {
    "text": "There are some rules\naround what the block can have as its timestamp. It cannot be more than--",
    "start": "902070",
    "end": "907870"
  },
  {
    "text": "if I see a block that\nhas a timestamp that's more than two hours in the\nfuture from my own timestamp, I will reject it.",
    "start": "907870",
    "end": "914330"
  },
  {
    "text": "And if it isn't after\nsome point that's the median of the previous\nblock's timestamps,",
    "start": "914330",
    "end": "920949"
  },
  {
    "text": "then I'll also reject it. And, of course, the block needs\nto actually point to a block",
    "start": "920950",
    "end": "928980"
  },
  {
    "start": "923000",
    "end": "1243000"
  },
  {
    "text": "that I've seen before. And as a node, I\nwill keep around blocks which have a\nprevious hash pointer that I",
    "start": "928980",
    "end": "935610"
  },
  {
    "text": "don't know about. But I'm not going to\nkeep them around forever, because that's a\npotential Dos attack.",
    "start": "935610",
    "end": "941700"
  },
  {
    "text": "And in order for me to\nactually insert this block into my version\nof a blockchain, I",
    "start": "941700",
    "end": "947910"
  },
  {
    "text": "need to know which\nblock to put it after. Note also, note\nwhat's not on here",
    "start": "947910",
    "end": "955260"
  },
  {
    "text": "is that it needs to be\nthe only block pointing to a previous block. I'll keep around multiple\nblocks at the same level",
    "start": "955260",
    "end": "963330"
  },
  {
    "text": "until I have some sense of\nwhich one is going to win out, because of the\nprobabilistic nature of maybe this block I'm\nseeing is not going to end up",
    "start": "963330",
    "end": "970552"
  },
  {
    "text": "being part of the blockchain. Maybe it's going\nto be an orphan. ",
    "start": "970552",
    "end": "976480"
  },
  {
    "text": "So these validation\nrules are what",
    "start": "976480",
    "end": "981810"
  },
  {
    "text": "are called consensus critical\nrules in the bitcoin network. And what that means is that if\nyou want to tweak these rules,",
    "start": "981810",
    "end": "990000"
  },
  {
    "text": "if you want to\nchange them, then you may end up changing which\nblocks nodes will accept,",
    "start": "990000",
    "end": "996450"
  },
  {
    "text": "and which blocks\nnodes won't accept. Now, something that's kind\nof interesting to note here",
    "start": "996450",
    "end": "1003120"
  },
  {
    "text": "is that the entire script\ninterpreter in bitcoin is consensus critical.",
    "start": "1003120",
    "end": "1008680"
  },
  {
    "text": "Yes? AUDIENCE: If you reduce\nthe amount of transactions, does that reduce the size\nof the blocks as well?",
    "start": "1008680",
    "end": "1015060"
  },
  {
    "text": "NEHA NARULA: Yes, it can. Yes, so you can\ndefinitely have a block-- so that's a great\nquestion actually.",
    "start": "1015060",
    "end": "1020650"
  },
  {
    "text": "So let's say that we had a\nblock that was half a megabyte. What would nodes do?",
    "start": "1020650",
    "end": "1027400"
  },
  {
    "text": "What do you think? AUDIENCE: I think an\nadvantageous miner would potentially process it faster.",
    "start": "1027400",
    "end": "1034307"
  },
  {
    "text": "NEHA NARULA: That's true.  What would you as a node do. If you're running the bitcoin\nprotocol as it exists today,",
    "start": "1034307",
    "end": "1041646"
  },
  {
    "text": "and it has the\nfollowing set of rules, and I hand you a block\nthat's half a megabyte, what would you do?",
    "start": "1041646",
    "end": "1047709"
  },
  {
    "text": "You would say OK, exactly,\nbecause the rule that I specified here just\nsays the block has to be less than 1 megabyte.",
    "start": "1047710",
    "end": "1054150"
  },
  {
    "text": "It didn't say it has to\nbe greater than anything. And is half a megabyte\nless than 1 megabyte?",
    "start": "1054150",
    "end": "1059580"
  },
  {
    "text": "Yes, so you're going\nto pass the checks. And you're going to\naccept the block. ",
    "start": "1059580",
    "end": "1066770"
  },
  {
    "text": "AUDIENCE: Is that a good\nthing for miners, so maybe remove the transactions\nfrom a potential block,",
    "start": "1066770",
    "end": "1072690"
  },
  {
    "text": "because they want to\nprocess it faster? NEHA NARULA: Sure, so the\nquestion is, should miners remove transactions\nfrom a block,",
    "start": "1072690",
    "end": "1079500"
  },
  {
    "text": "or perhaps not put\ntransactions in a block, because it seems like they could\nprocess a small block faster",
    "start": "1079500",
    "end": "1084570"
  },
  {
    "text": "than a large block, right? So that is very true. Miners, if there are\nfewer transactions,",
    "start": "1084570",
    "end": "1091649"
  },
  {
    "text": "they have fewer\nthings to verify. So they can check and see\nif the book is valid faster. However, the fewer transactions,\nthe fewer the transaction fees.",
    "start": "1091650",
    "end": "1100140"
  },
  {
    "text": "And so the less the miner\nwill earn from the block. ",
    "start": "1100140",
    "end": "1105460"
  },
  {
    "text": "Yes? AUDIENCE: And also, the energy\nput in, most of it mining,",
    "start": "1105460",
    "end": "1111250"
  },
  {
    "text": "is like mining the block,\nnot actually verifying. NEHA NARULA: Yeah.  So verifying transactions is\nnowhere near as CPU-intensive",
    "start": "1111250",
    "end": "1122409"
  },
  {
    "text": "as it is to actually\nfind the nonce and produce the proof of work. However, miners should\nverify transactions",
    "start": "1122410",
    "end": "1131799"
  },
  {
    "text": "before even starting\nthat process. And so if a miner didn't\nverify transactions,",
    "start": "1131800",
    "end": "1137050"
  },
  {
    "text": "they would get a head start\non the proof of work process. So there's that sort of balance.",
    "start": "1137050",
    "end": "1142600"
  },
  {
    "text": "And, in fact, I think we've\ntalked about this in this class before, there have\nbeen times in history",
    "start": "1142600",
    "end": "1147940"
  },
  {
    "text": "where things have happened that\nhave shown that miners actually haven't been verifying blocks. They'll just mine on whatever.",
    "start": "1147940",
    "end": "1153350"
  },
  {
    "text": "It's caused some problems. And they ended up\nlosing a lot of money because they should have\nbeen verifying blocks.",
    "start": "1153350",
    "end": "1160120"
  },
  {
    "text": "Great. So these rules are what are\ncalled consensus critical. They are the rules that\neach node independently",
    "start": "1160120",
    "end": "1166240"
  },
  {
    "text": "uses to decide\nwhether or not they're going to accept the block.",
    "start": "1166240",
    "end": "1171570"
  },
  {
    "text": "Yes? AUDIENCE: When you\ntalk about nodes, you talk about SPDs, right?",
    "start": "1171570",
    "end": "1176632"
  },
  {
    "text": "NEHA NARULA: No. I'm not talking about SPDs\nwhen I talk about nodes. I'm actually talking\nabout full nodes.",
    "start": "1176633",
    "end": "1182940"
  },
  {
    "text": "So I'm talking about\nnodes that are holding onto the entire bitcoin\nblockchain, that",
    "start": "1182940",
    "end": "1189440"
  },
  {
    "text": "are looking at every\nblock, every transaction. AUDIENCE: So the\ndifference between a miner",
    "start": "1189440",
    "end": "1194750"
  },
  {
    "text": "and and a node are [INAUDIBLE]? NEHA NARULA: A miner--",
    "start": "1194750",
    "end": "1199790"
  },
  {
    "text": "yeah, they're distinct roles. So a miner is running this\nproof of work algorithm",
    "start": "1199790",
    "end": "1205220"
  },
  {
    "text": "to try to find-- to produce blocks. A full node does\nnot write blocks.",
    "start": "1205220",
    "end": "1210680"
  },
  {
    "text": "It doesn't create new blocks. It receives blocks, and\nthen validates them, or not, and adds them to its local\ncopy of the blockchain.",
    "start": "1210680",
    "end": "1217520"
  },
  {
    "text": "A miner might also be\nrunning a full node. Yes? AUDIENCE: Miners should\nbe running full nodes.",
    "start": "1217520",
    "end": "1223070"
  },
  {
    "text": "NEHA NARULA: Yeah,\nthey should be. But it's not clear that that\nhappens, for the reasons",
    "start": "1223070",
    "end": "1228590"
  },
  {
    "text": "we were talking about before. I'm sorry? AUDIENCE: You can force\nminers to [INAUDIBLE]",
    "start": "1228590",
    "end": "1241230"
  },
  {
    "text": "NEHA NARULA: OK, so let's go\nback to this image right here.",
    "start": "1241230",
    "end": "1246480"
  },
  {
    "start": "1243000",
    "end": "1780000"
  },
  {
    "text": "These nodes are all running\nsome version of the software. They see this transaction. And they say, yes, this looks\nlike a valid transaction to me.",
    "start": "1246480",
    "end": "1255990"
  },
  {
    "text": "And note that they have to-- or, sorry, block. They look at this block. Yes, this looks like\na valid block to me. And note that they kind\nof have to evaluate",
    "start": "1255990",
    "end": "1262860"
  },
  {
    "text": "that block with respect\nto all of the other blocks that it's seen. No double spends, all of the\nscripts eggs, the script pub",
    "start": "1262860",
    "end": "1270480"
  },
  {
    "text": "keys, work out correctly, it's\nthe right size, et cetera, et cetera.",
    "start": "1270480",
    "end": "1276840"
  },
  {
    "text": "And then once it's decided\nthat that's all OK, each node will independently\nmake the same decision",
    "start": "1276840",
    "end": "1286440"
  },
  {
    "text": "to add that block\nto its blockchain. So you can see here that\ndeterminism is actually",
    "start": "1286440",
    "end": "1292830"
  },
  {
    "text": "really important. It can't be the\ncase that there's any randomness in this process. It can't be the case\nthat sort of randomly,",
    "start": "1292830",
    "end": "1298890"
  },
  {
    "text": "depending on the time of\nday, one node will decide this is a valid\nblock, one node will decide it's not a valid block. That's not the greatest\nsituation to have happen.",
    "start": "1298890",
    "end": "1306660"
  },
  {
    "text": "We want this to be as\ndeterministic as possible. We want them to all\nindependently arrive at the same decision.",
    "start": "1306660",
    "end": "1313800"
  },
  {
    "text": "Great. So this is how validation works. This is what nodes do.",
    "start": "1313800",
    "end": "1318960"
  },
  {
    "text": "Major problem,\nthough-- sometimes, we need to change\nthe validation rules.",
    "start": "1318960",
    "end": "1324779"
  },
  {
    "text": "Sometimes, we need to\nupgrade the software. I mean, software is\nnot a static thing.",
    "start": "1324780",
    "end": "1330450"
  },
  {
    "text": "The software that these\nnodes are running, there's going to be bugs. There might be security\nvulnerabilities.",
    "start": "1330450",
    "end": "1336220"
  },
  {
    "text": "We might want to\nadd new features. And so we're going to want to\nchange the validation rules.",
    "start": "1336220",
    "end": "1343990"
  },
  {
    "text": "It's pretty much inevitable. And, yet, given the\nnature of the system,",
    "start": "1343990",
    "end": "1349540"
  },
  {
    "text": "we can't upgrade every\nsingle node at the same time. ",
    "start": "1349540",
    "end": "1356800"
  },
  {
    "text": "So I think a useful analogy\nhere, something to think about, is actually browsers.",
    "start": "1356800",
    "end": "1363240"
  },
  {
    "text": "So web browsers-- right now,\na lot of people run Chrome. But not everyone runs Chrome.",
    "start": "1363240",
    "end": "1368940"
  },
  {
    "text": "And Chrome actually\nhas auto update where it will push\nchanges to your browser. Google will automatically\nupgrade you.",
    "start": "1368940",
    "end": "1376080"
  },
  {
    "text": "But the way the\nbrowsers used to work is that you didn't\nalways have auto update. Or it would bother\nyou, and ask you",
    "start": "1376080",
    "end": "1381540"
  },
  {
    "text": "if you were OK with\nauto updating before. And people would say, I don't\ndeal with this right now.",
    "start": "1381540",
    "end": "1386940"
  },
  {
    "text": "I'm in the middle of something. I don't want to auto\nupdate my browser, and have to restart\nthe whole thing. And so what would\nend up happening",
    "start": "1386940",
    "end": "1392399"
  },
  {
    "text": "is you'd have significant\nnumbers of people on very different versions of browsers.",
    "start": "1392400",
    "end": "1397800"
  },
  {
    "text": "And this was kind of a\ndisaster for the internet, because people who were\ndeveloping websites,",
    "start": "1397800",
    "end": "1404340"
  },
  {
    "text": "they wouldn't have\nany confidence that the majority\nof their users, or a significant\nmajority of their users, had upgraded to\nthe new features.",
    "start": "1404340",
    "end": "1411130"
  },
  {
    "text": "So they had to support all\nthese old versions of browsers. And it was a nightmare.",
    "start": "1411130",
    "end": "1417910"
  },
  {
    "text": "So that's what we're dealing\nwith here in cryptocurrencies,",
    "start": "1417910",
    "end": "1423120"
  },
  {
    "text": "except it's even worse. So you definitely cannot\nguarantee that everyone will",
    "start": "1423120",
    "end": "1428820"
  },
  {
    "text": "upgrade their software\nat the same time. You can't guarantee\nthat everyone will even upgrade ever.",
    "start": "1428820",
    "end": "1435510"
  },
  {
    "text": "And so the designers\nof the software, when you want to create a\nnew version of software, you have to think really,\nreally carefully about it.",
    "start": "1435510",
    "end": "1443732"
  },
  {
    "text": "So let's say that we're\nin this situation right here, where these three nodes\nare running V1 of the software.",
    "start": "1443732",
    "end": "1449519"
  },
  {
    "text": "The developers\nhave worked out V2. V2 has some interesting\nnew features, which slightly\nchanged the validation",
    "start": "1449520",
    "end": "1455920"
  },
  {
    "text": "rules about what a\nnode running V2 will consider valid or invalid.",
    "start": "1455920",
    "end": "1461840"
  },
  {
    "text": "So now, when we see this new\nblock, and we ask the question,",
    "start": "1461840",
    "end": "1467070"
  },
  {
    "text": "is this block valid, these nodes\nmight make different decisions. In particular, maybe the old\nnodes will think it's valid.",
    "start": "1467070",
    "end": "1475400"
  },
  {
    "text": "Great, passes all\nthe validation rules. I will append this\nblock to my blockchain. And the new node will\nnot think it's valid,",
    "start": "1475400",
    "end": "1482429"
  },
  {
    "text": "and will say, garbage\nblock, fantastic. I will not append this\nblock to my blockchain.",
    "start": "1482430",
    "end": "1488420"
  },
  {
    "text": "And what we end up\nwith when this happens is we have two different\nversions of history.",
    "start": "1488420",
    "end": "1493730"
  },
  {
    "text": "The nodes running the old\nversion of the software think that there are four\nblocks in the blockchain. The nodes that are running the\nnew version of the software",
    "start": "1493730",
    "end": "1501280"
  },
  {
    "text": "have decided that\nthat block is invalid. And they only have three\nblocks in the blockchain.",
    "start": "1501280",
    "end": "1506880"
  },
  {
    "text": "So what does this mean? First of all, is this like\nthe situation we saw before,",
    "start": "1506880",
    "end": "1512530"
  },
  {
    "text": "where if we just wait\nfor enough proof of work this will sort itself out? ",
    "start": "1512530",
    "end": "1519179"
  },
  {
    "text": "What do you guys think? I'm seeing some people\nshaking their heads. And, yes, this situation is\ndifferent than the situation",
    "start": "1519180",
    "end": "1527370"
  },
  {
    "text": "we saw before,\nbecause the situation we saw before, all the nodes\nstill had the same validation",
    "start": "1527370",
    "end": "1532720"
  },
  {
    "text": "rules.  They just saw the blocks\nin different orders,",
    "start": "1532720",
    "end": "1540630"
  },
  {
    "text": "or they got later, whatever. All of that can be resolved by\nlooking at the proof of work.",
    "start": "1540630",
    "end": "1546540"
  },
  {
    "text": "Sometimes when this\nhappens, sometimes when nodes are actually\nrunning different versions",
    "start": "1546540",
    "end": "1552390"
  },
  {
    "text": "of validation\nsoftware, things can be resolved by just\nlooking at proof of work. But quite often,\nactually, they can't.",
    "start": "1552390",
    "end": "1558900"
  },
  {
    "text": "And so in this situation,\nwhat might happen is another block comes along. So this is a different\nblock than this one.",
    "start": "1558900",
    "end": "1567000"
  },
  {
    "text": "And this set of\nnodes might decide that this is the next\nblock in the blockchain, whereas the blue nodes will\nnever, ever, ever validate",
    "start": "1567000",
    "end": "1576630"
  },
  {
    "text": "this block. They will never decide\nthat this block is valid, given the version of the\nsoftware they are running.",
    "start": "1576630",
    "end": "1582600"
  },
  {
    "text": "They will never\nswitch to a blockchain that has this block\nin it, even if it",
    "start": "1582600",
    "end": "1587610"
  },
  {
    "text": "has the most proof of work. So I think this is a\nreally important point. And I think it sort\nof fundamentally",
    "start": "1587610",
    "end": "1593820"
  },
  {
    "text": "gets to why miners\ndon't actually have as much power\nin the system as one might think that they do.",
    "start": "1593820",
    "end": "1600060"
  },
  {
    "text": "And the reason for that is that\nthe way bitcoin is designed is that a node will never accept\na chain with a single invalid",
    "start": "1600060",
    "end": "1608190"
  },
  {
    "text": "transaction. If, according to\nits set of rules, a single transaction is\ninvalid, it will completely",
    "start": "1608190",
    "end": "1615730"
  },
  {
    "text": "ignore that chain. Doesn't matter if it has\nthe most proof of work. ",
    "start": "1615730",
    "end": "1620980"
  },
  {
    "text": "Does that make\nsense to everyone?  It's kind of intense.",
    "start": "1620980",
    "end": "1626860"
  },
  {
    "text": "It's kind of crazy, right? Like, even if it has\nmountains upon mountains of proof of work,\nit will completely",
    "start": "1626860",
    "end": "1632740"
  },
  {
    "text": "ignore that chain\nbecause there's something invalid about it. So miners can mine\nwhat they want.",
    "start": "1632740",
    "end": "1640450"
  },
  {
    "text": "But they better mine\nwithin the validation rules set of the economic\nmajority of the nodes.",
    "start": "1640450",
    "end": "1647260"
  },
  {
    "text": "Otherwise, those\nnodes are all going to ignore whatever they mine. And their money is not\ngoing to be worth anything.",
    "start": "1647260",
    "end": "1652290"
  },
  {
    "text": " Great.",
    "start": "1652290",
    "end": "1657590"
  },
  {
    "text": "So in this situation, we end up\nwith two different blockchains. And we actually end up with\nsomething quite irreconcilable,",
    "start": "1657590",
    "end": "1665750"
  },
  {
    "text": "unless we change the\nsoftware again, somehow. And what we've ended up\nwith that's irreconcilable",
    "start": "1665750",
    "end": "1671570"
  },
  {
    "text": "is we now have a block over\nhere, and a block over here. This node will never accept a\nchain with this block in it.",
    "start": "1671570",
    "end": "1680400"
  },
  {
    "text": "And so we've got two\ndifferent blockchains. ",
    "start": "1680400",
    "end": "1686110"
  },
  {
    "text": "So when this happens,\nwe call it a fork. Now, the word fork can be used\nto mean many different things",
    "start": "1686110",
    "end": "1693650"
  },
  {
    "text": "in software. For example, you fork\na project on GitHub. When you fork a\nproject on GitHub, you might make changes to it.",
    "start": "1693650",
    "end": "1700840"
  },
  {
    "text": "This is a little bit different\nbecause of the linearity of history here.",
    "start": "1700840",
    "end": "1706090"
  },
  {
    "text": "When a fork happens\nin a cryptocurrency, in particular a sort of a fork\nthat can't easily be resolved,",
    "start": "1706090",
    "end": "1713320"
  },
  {
    "text": "that isn't just\ngoing to, oh, one side has more proof\nof work, OK, great we're all going to switch\nto that other side. When you have a fork\nthat can't be resolved",
    "start": "1713320",
    "end": "1719612"
  },
  {
    "text": "that easily then it's\nactually a pretty big deal, because like we\nwere saying earlier",
    "start": "1719612",
    "end": "1725082"
  },
  {
    "text": "we now have two versions of\nhistory, two different versions of money. It's like I took the\ndollar from my wallet,",
    "start": "1725082",
    "end": "1730750"
  },
  {
    "text": "and I photocopied it. And now there's $2 where\nthere was only one. So maybe you like\nthis kind of dollars.",
    "start": "1730750",
    "end": "1737750"
  },
  {
    "text": "Maybe you don't like\nthat kind of dollars. We've basically taken\nthis entire network that all sort of agreed on\nwhat this form of money was,",
    "start": "1737750",
    "end": "1745090"
  },
  {
    "text": "and we've divided it into two.  So there's two\ndifferent kind of forks",
    "start": "1745090",
    "end": "1752740"
  },
  {
    "text": "that people will talk about\nmostly in this industry. But forking is actually much\nmore complicated than that.",
    "start": "1752740",
    "end": "1760420"
  },
  {
    "text": "You can't just\ntalk about forks as in-- so the two\ndifferent kinds of forks are soft forks and hard forks.",
    "start": "1760420",
    "end": "1766044"
  },
  {
    "text": "And I'm going to explain\nwhat a soft work is, versus a hard fork. But, actually, that\ndelineation, it",
    "start": "1766045",
    "end": "1772120"
  },
  {
    "text": "gets much more nuanced because\ndifferent things happen in a soft fork\nversus a hard fork, depending upon who's\ndecided to adopt the rules.",
    "start": "1772120",
    "end": "1780890"
  },
  {
    "start": "1780000",
    "end": "2540000"
  },
  {
    "text": "OK, so a soft fork-- a soft fork is a fork which\nis backwards compatible.",
    "start": "1780890",
    "end": "1789250"
  },
  {
    "text": "So we have some rule set. And under that\nrule set you apply",
    "start": "1789250",
    "end": "1796900"
  },
  {
    "text": "that rule set to every\nsingle possible one megabyte",
    "start": "1796900",
    "end": "1803660"
  },
  {
    "text": "chunk of data. And we're going to end\nup with some set of what are valid blocks.",
    "start": "1803660",
    "end": "1809840"
  },
  {
    "text": "A soft fork is when you\nadd rules to the rule set, such that the set of valid\nblocks actually shrinks.",
    "start": "1809840",
    "end": "1817460"
  },
  {
    "text": " So what does that mean?",
    "start": "1817460",
    "end": "1822950"
  },
  {
    "text": "We had a whole bunch\nof rules before. Blocks have to be\nless than 1 megabyte. Transactions all\nhave to be valid.",
    "start": "1822950",
    "end": "1828355"
  },
  {
    "text": "It means that their scripts\ncertify, like validate, under the certain\nscript interpreter, et cetera, no double spends.",
    "start": "1828355",
    "end": "1834103"
  },
  {
    "text": "Let's take one of the rules\nthat's actually pretty simple, which is that blocks have to\nbe less than one megabyte.",
    "start": "1834103",
    "end": "1840050"
  },
  {
    "text": "Let's say that I\nchange that to blocks have to be less\nthan two megabytes. Is that a soft fork?",
    "start": "1840050",
    "end": "1845210"
  },
  {
    "text": " AUDIENCE: Yes. ",
    "start": "1845210",
    "end": "1851330"
  },
  {
    "text": "NEHA NARULA: Oh, wow, there's\nsome actual dissent over this, right? OK, so someone who says\nno, why is the answer no?",
    "start": "1851330",
    "end": "1859415"
  },
  {
    "text": "AUDIENCE: Because you have\nsomething that is now accepted that wasn't accepted before. NEHA NARULA: Right, so\nremember, valid blocks",
    "start": "1859415",
    "end": "1866590"
  },
  {
    "text": "before newly valid blocks\nfit inside of this. Now, someone who\nsaid yes it's a soft fork, why do you think that?",
    "start": "1866590",
    "end": "1874020"
  },
  {
    "text": "AUDIENCE: All blocks\nstill have less than two. NEHA NARULA: Right. So it's actually\nnot a soft fork.",
    "start": "1874020",
    "end": "1881740"
  },
  {
    "text": "And the reason that\nit's not a soft fork is because a block that is\n1.75 megabytes, previously,",
    "start": "1881740",
    "end": "1891220"
  },
  {
    "text": "the old rule set, was invalid. New rule set, it's valid.",
    "start": "1891220",
    "end": "1897360"
  },
  {
    "text": "But we just said everything\nthat's newly valid has to fit inside\nwhat used to be valid.",
    "start": "1897360",
    "end": "1903570"
  },
  {
    "text": "So a soft fork is restricting\nthe set of valid things. You can think of it as\nexpanding the set of rules",
    "start": "1903570",
    "end": "1910070"
  },
  {
    "text": "that a block now\nhas to comply with.",
    "start": "1910070",
    "end": "1915755"
  },
  {
    "text": "So a feature of this is\nthat if you don't upgrade--",
    "start": "1915755",
    "end": "1924110"
  },
  {
    "text": "so V1 is the old rule software. V2 is the new rule software. If you don't upgrade,\nyou will continue",
    "start": "1924110",
    "end": "1932059"
  },
  {
    "text": "to see the new blocks as valid. And this is actually\na very nice property,",
    "start": "1932060",
    "end": "1937400"
  },
  {
    "text": "because, remember what\nhappened over here, we had this property where\nthe people on the blue side were just never,\never going to accept",
    "start": "1937400",
    "end": "1944300"
  },
  {
    "text": "one of these blockchains. And if it were the case\nthat this were a soft fork,",
    "start": "1944300",
    "end": "1953130"
  },
  {
    "text": "the old side would never, ever-- well, if this sorry,\nif it were the case",
    "start": "1953130",
    "end": "1959610"
  },
  {
    "text": "that this weren't a\nsoft work, the old nodes would never accept\nthis new stuff.",
    "start": "1959610",
    "end": "1965280"
  },
  {
    "text": "So soft forks are really\nnice, because they're backwards compatible. Old nodes will still see\nthe new blocks as valid.",
    "start": "1965280",
    "end": "1972150"
  },
  {
    "text": "They won't reject them. If that chain gets a\nton of proof of work, then the old nodes will happily\nswitch over to that chain.",
    "start": "1972150",
    "end": "1979440"
  },
  {
    "text": "So, what does that mean? So let's say that the black\nnodes are the old rules,",
    "start": "1979440",
    "end": "1985100"
  },
  {
    "text": "and the blue nodes are new\nrules, new rule blocks. And, again, we have to\nlook at this from two",
    "start": "1985100",
    "end": "1991190"
  },
  {
    "text": "different perspectives. There are the people\ncreating the blocks. And there are the people\nreading the blocks.",
    "start": "1991190",
    "end": "1996289"
  },
  {
    "text": "And sometimes those\nare the same people. Sometimes, they're not. So we're looking at blocks here. So these are people who\nare creating the blocks.",
    "start": "1996290",
    "end": "2002700"
  },
  {
    "text": " And, again, both of\nthese sets of people",
    "start": "2002700",
    "end": "2008710"
  },
  {
    "text": "might upgrade or not upgrade. So we might have miners who\nare following the old rules",
    "start": "2008710",
    "end": "2014947"
  },
  {
    "text": "and miners who were\nfollowing the new rules. Then we might have\nvalidating nodes who are following the old\nrules, and validating nodes who",
    "start": "2014947",
    "end": "2020075"
  },
  {
    "text": "are following the new rules. And this is not even\ntalking about SPV yet. OK, we're just\ntalking about miners. And we're talking about nodes.",
    "start": "2020075",
    "end": "2027799"
  },
  {
    "text": "So let's say some of the miners\nupgrade to the new rules, but not all of the miners\nupgrade to the new rules.",
    "start": "2027800",
    "end": "2034340"
  },
  {
    "text": "The miners who didn't\nupgrade to the new rules are going to continue\nproducing old rule blocks.",
    "start": "2034340",
    "end": "2040860"
  },
  {
    "text": "They're going to continue\nproducing V1 version blocks. But if the majority of miners\nupgrade to the new rules,",
    "start": "2040860",
    "end": "2048649"
  },
  {
    "text": "remember, the new rule\npeople have new rules. So they have more restrictions\non the set of blocks",
    "start": "2048650",
    "end": "2056750"
  },
  {
    "text": "that they will accept. So they might not see\nthat block as valid.",
    "start": "2056750",
    "end": "2062558"
  },
  {
    "text": "So they're never going to\naccept that chain, because it has invalid things in it. Once you've upgraded,\nyou might no longer",
    "start": "2062558",
    "end": "2068779"
  },
  {
    "text": "accept the old chain as valid. And so what's going\nto end up happening is something that looks\nvery much like the orphaning",
    "start": "2068780",
    "end": "2074246"
  },
  {
    "text": "situation that was\nhappening before, where if the majority of\nthe hash powers, which is over here, this chain is\ngoing to keep going bigger.",
    "start": "2074246",
    "end": "2082638"
  },
  {
    "text": "These guys might keep trying\nto produce old style blocks. But they just keep\ngetting orphaned off.",
    "start": "2082639",
    "end": "2087770"
  },
  {
    "text": "It's actually like very much\nin their economic interest to hurry up and upgrade, so\nthey're not wasting hash power",
    "start": "2087770",
    "end": "2094010"
  },
  {
    "text": "on orphan blocks. ",
    "start": "2094010",
    "end": "2099170"
  },
  {
    "text": "Are there questions\nabout soft forks? ",
    "start": "2099170",
    "end": "2107000"
  },
  {
    "text": "Yes? AUDIENCE: So are\nsoft forks also used for changing software\nother than validation?",
    "start": "2107000",
    "end": "2115640"
  },
  {
    "text": "NEHA NARULA: Yes,\nthat's a great question. Are soft forks also used\nfor changing software other",
    "start": "2115640",
    "end": "2121040"
  },
  {
    "text": "than validation? So we can certainly upgrade\nmore than just the validation",
    "start": "2121040",
    "end": "2127760"
  },
  {
    "text": "parts of the bitcoin software. If it doesn't change the set of\nblocks that would be accepted",
    "start": "2127760",
    "end": "2133849"
  },
  {
    "text": "or not accepted, we don't\neven bother calling it a fork. So let's say that we wanted to\nchange something about the peer",
    "start": "2133850",
    "end": "2142250"
  },
  {
    "text": "to peer network, or the way\nthat things are stored on disk, or something like that.",
    "start": "2142250",
    "end": "2148340"
  },
  {
    "text": "We would see that\na change like that, if it didn't change the set\nof blocks that would have been",
    "start": "2148340",
    "end": "2153470"
  },
  {
    "text": "accepted or not accepted,\nif after the change a set of blocks accepted or\nnot accepted is the exact same,",
    "start": "2153470",
    "end": "2159230"
  },
  {
    "text": "we don't call that a fork, a\nchange that induces a fork. It's only when the set of blocks\nare accepted or wouldn't be",
    "start": "2159230",
    "end": "2165410"
  },
  {
    "text": "accepted are actually changed. Yes? AUDIENCE: How often do updates\nget pushed on the network? NEHA NARULA: Great question.",
    "start": "2165410",
    "end": "2171080"
  },
  {
    "text": "How often do updates get\npushed on the network? So Bitcoin is at\nversion 0.16 right now.",
    "start": "2171080",
    "end": "2176870"
  },
  {
    "text": "And 0.16 came out like\na week or two ago. And I think it's sort of been\non the order of a couple months",
    "start": "2176870",
    "end": "2182540"
  },
  {
    "text": "between different\nversions of Bitcoin. Other cryptocurrencies\nrelease more frequently.",
    "start": "2182540",
    "end": "2188510"
  },
  {
    "text": "Some release less frequently. Some do forks very,\nvery regularly. And we'll speak a\nlittle bit about that.",
    "start": "2188510",
    "end": "2195322"
  },
  {
    "text": "But the software is pretty much\nconstantly getting updated. ",
    "start": "2195322",
    "end": "2201840"
  },
  {
    "text": "Yeah? AUDIENCE: So in\npractice, people are just updating their versions?",
    "start": "2201840",
    "end": "2207680"
  },
  {
    "text": "NEHA NARULA: Yeah, so in\nBitcoin in particular, Bitcoin does not have\nan auto update function. So in order to run the new\nversion of the software,",
    "start": "2207680",
    "end": "2214650"
  },
  {
    "text": "you have to decide\nthat you're going to run the new version\nof the software. Or there might be a way to\ndecide to turn auto update on.",
    "start": "2214650",
    "end": "2220620"
  },
  {
    "text": "I can't remember. But the point is that\nthey try to leave it in their user's hands. Yes?",
    "start": "2220620",
    "end": "2225830"
  },
  {
    "text": "AUDIENCE: How are\nversions created? So if you like on the GitHub,\nthere are a ton of features,",
    "start": "2225830",
    "end": "2230870"
  },
  {
    "text": "and sometimes they're\npushed forward. Is there a subreddit, where\nthey're like, OK, version? ",
    "start": "2230870",
    "end": "2238690"
  },
  {
    "text": "NEHA NARULA: OK, how\nare versions created? It's actually very similar to\nany other software project, where the people who work\non the software project",
    "start": "2238690",
    "end": "2244970"
  },
  {
    "text": "get together, and decide\nwhich pull requests are going to be part of the new version.",
    "start": "2244970",
    "end": "2250200"
  },
  {
    "text": "So, yes, at some\npoint, they're just like, new version, release. Yeah? ",
    "start": "2250200",
    "end": "2257130"
  },
  {
    "text": "AUDIENCE: Do software get\nreleased as updated versions? NEHA NARULA: Yes, soft\nforks are definitely",
    "start": "2257130",
    "end": "2262730"
  },
  {
    "text": "released as updated versions. So that's a great question.",
    "start": "2262730",
    "end": "2268250"
  },
  {
    "text": "I think not every version\nhas a soft fork in it. But if there is a soft\nfork, it will definitely be a new version.",
    "start": "2268250",
    "end": "2273950"
  },
  {
    "text": "Yes? AUDIENCE: Why can't\nthis black miner not just look at the\nversion in the blue block",
    "start": "2273950",
    "end": "2280200"
  },
  {
    "text": "and decide not to? NEHA NARULA: Because\nit's not a blue block. So you're talking\nabout here, right?",
    "start": "2280200",
    "end": "2289110"
  },
  {
    "text": " OK, so the nodes are\nrunning different software.",
    "start": "2289110",
    "end": "2295460"
  },
  {
    "text": "And then a block\ncomes along that-- ",
    "start": "2295460",
    "end": "2301630"
  },
  {
    "text": "ideally, yes the block would\nhave a version number in it that specifies which\nversion of the software.",
    "start": "2301630",
    "end": "2309770"
  },
  {
    "text": "And this is a very useful\nfield in the block header. But that's not really--",
    "start": "2309770",
    "end": "2318049"
  },
  {
    "text": "so what it has a\ndifferent version? AUDIENCE: If it's\nlower than mine-- sorry, higher than mine,\nthen I don't do it.",
    "start": "2318050",
    "end": "2325550"
  },
  {
    "text": "Then I won't update first. NEHA NARULA: What do\nyou mean by don't do it? You mean, you ignore it? AUDIENCE: No, I\n[INAUDIBLE] myself,",
    "start": "2325550",
    "end": "2332840"
  },
  {
    "text": "because I see that a higher\nversion is in circulation. NEHA NARULA: So that\nwould be one way of running the network, which\nis if I ever see anything that",
    "start": "2332840",
    "end": "2339450"
  },
  {
    "text": "indicates that there's\nnewer software out there, I just realize I'm old,\nand that I need to update.",
    "start": "2339450",
    "end": "2344990"
  },
  {
    "text": " I think that Bitcoin simply\nmade a different design",
    "start": "2344990",
    "end": "2350720"
  },
  {
    "text": "decision, which was that older\nnodes should still be able to-- because think about nodes\nthat were sort of set it",
    "start": "2350720",
    "end": "2359450"
  },
  {
    "text": "and forget it, they're\nout there running. One tenant that\nis absolutely true is that users will not upgrade.",
    "start": "2359450",
    "end": "2365900"
  },
  {
    "text": "They will not all upgrade. It just won't happen. You will have old versions\nof software running. And given that you will have old\nversions of software running,",
    "start": "2365900",
    "end": "2372620"
  },
  {
    "text": "I think it's a question\nas to whether or not those nodes should still be\na part of the network, or whether you just\nwant to slice them off",
    "start": "2372620",
    "end": "2378120"
  },
  {
    "text": "because they're not\nrunning the latest version. And I think in\nBitcoin, they want those nodes to still be\na part of the network.",
    "start": "2378120",
    "end": "2383940"
  },
  {
    "text": "They want people to be able to\nmake the active decision not to upgrade. Tadge actually, I think is still\nrunning 0.13, or some older",
    "start": "2383940",
    "end": "2392680"
  },
  {
    "text": "version of Bitcoin. Still works great. He can still validate\ntransactions totally fine.",
    "start": "2392680",
    "end": "2399440"
  },
  {
    "text": "OK, so we just talked\nabout soft forks. And I think the important thing\nto remember about soft works",
    "start": "2399440",
    "end": "2405510"
  },
  {
    "text": "is that soft works are\nbackwards compatible. We also talked about an example\nthat is not a hard fork, which",
    "start": "2405510",
    "end": "2413850"
  },
  {
    "text": "is if we decided that we\nwanted to allow blocks that were less than two\nmegabytes, instead of less",
    "start": "2413850",
    "end": "2419040"
  },
  {
    "text": "than one megabyte. And so a 1.75 megabyte\nof block appears.",
    "start": "2419040",
    "end": "2425500"
  },
  {
    "text": "That is not a soft work. What if we changed\nthe rule to say that, instead of only\naccepting blocks that",
    "start": "2425500",
    "end": "2432795"
  },
  {
    "text": "are less than one\nmegabyte, we're only going to accept blocks that\nare less than half a megabyte. Is that a soft\nwork or hard fork?",
    "start": "2432795",
    "end": "2438720"
  },
  {
    "text": " AUDIENCE: Soft fork.",
    "start": "2438720",
    "end": "2445127"
  },
  {
    "text": "NEHA NARULA: That's a soft work. The reason that\nthat's a soft fork, is because a block that is\nless than half a megabyte",
    "start": "2445127",
    "end": "2450890"
  },
  {
    "text": "was also still less\nthan one megabyte. So it's still valid under\nthe old set of rules.",
    "start": "2450890",
    "end": "2458210"
  },
  {
    "text": "So if the change made here was\nnow we want smaller blocks. So we're only going\nto take blocks that are less than half a megabyte.",
    "start": "2458210",
    "end": "2465029"
  },
  {
    "text": "That's fine. Everyone will still see\nthis chain as valid. This is still\nbackwards compatible.",
    "start": "2465030",
    "end": "2470800"
  },
  {
    "text": "Just because your blocks\nare 300 kilobytes now doesn't mean that\nthey violate a rule.",
    "start": "2470800",
    "end": "2475970"
  },
  {
    "text": "AUDIENCE: Can I ask one last\nquestion in relation to that? So what happens if I\nwant to do something",
    "start": "2475970",
    "end": "2481120"
  },
  {
    "text": "with the old version,\nand [INAUDIBLE]..",
    "start": "2481120",
    "end": "2486160"
  },
  {
    "text": "And they realize, wow,\nI love [INAUDIBLE].. ",
    "start": "2486160",
    "end": "2495172"
  },
  {
    "text": "NEHA NARULA: Right,\nso what happens to all the previous\nstuff in my chain, right? Now, ideally, the\nway that the rules",
    "start": "2495172",
    "end": "2501069"
  },
  {
    "text": "would be setup, the new rules,\nis that they would take effect sometime in the future.",
    "start": "2501070",
    "end": "2506265"
  },
  {
    "text": "So you wouldn't\napply those rules retroactively to the things that\nyou already put into the chain,",
    "start": "2506265",
    "end": "2511329"
  },
  {
    "text": "because then you just\nthrow away all history. And that would be\nkind of a bummer. Instead, you say,\nafter this block,",
    "start": "2511330",
    "end": "2516335"
  },
  {
    "text": "we are only going to\naccept blocks that are less than half a megabyte. AUDIENCE: So what happens\nif after that block, so a majority of miners\nare running old software.",
    "start": "2516335",
    "end": "2525963"
  },
  {
    "text": "NEHA NARULA: Great question. AUDIENCE: [INAUDIBLE] NEHA NARULA: We'll\nget into that. We'll get into what happens when\nthe majority, versus minority,",
    "start": "2525963",
    "end": "2533470"
  },
  {
    "text": "of different parts of\nthe ecosystem decide to adopt the change, versus\nnot adopt the change.",
    "start": "2533470",
    "end": "2539720"
  },
  {
    "text": "But first, we're going\nto talk about hard forks. What is a hard fork? A hard fork is not\nbackwards compatible.",
    "start": "2539720",
    "end": "2546070"
  },
  {
    "start": "2540000",
    "end": "2838000"
  },
  {
    "text": "And so a hard fork\nis a fork where, if this was the\nold set of rules,",
    "start": "2546070",
    "end": "2551200"
  },
  {
    "text": "under the new set of\nrules you actually accept more blocks than you would\nhave accepted before. ",
    "start": "2551200",
    "end": "2559119"
  },
  {
    "text": "So just to be clear,\nunder the new rules,",
    "start": "2559120",
    "end": "2564720"
  },
  {
    "text": "you might produce a block,\nwhich a node running under the old rules will reject.",
    "start": "2564720",
    "end": "2571410"
  },
  {
    "text": "This is not\nbackwards compatible, because any chain that has\nthis new type of block in it",
    "start": "2571410",
    "end": "2580440"
  },
  {
    "text": "will not be accepted by any\nof the old nodes, full stop. It doesn't matter about\nproof of work at all. ",
    "start": "2580440",
    "end": "2592920"
  },
  {
    "text": "OK, so the thing\nwith hard forks is",
    "start": "2592920",
    "end": "2598940"
  },
  {
    "text": "that because they're not\nbackwards compatible, they're a little crazier and\na little bit sort of harder",
    "start": "2598940",
    "end": "2604790"
  },
  {
    "text": "to manage in your network. Because if you do a hard fork\nand not everyone upgrades,",
    "start": "2604790",
    "end": "2611030"
  },
  {
    "text": "you might end up with two\nchains, possibly forever. ",
    "start": "2611030",
    "end": "2616240"
  },
  {
    "text": "If we assume that those nodes\nare not going to upgrade-- and let's say they're not\nupgrading because there's",
    "start": "2616240",
    "end": "2621840"
  },
  {
    "text": "no one really maintaining them. Then they're not going\nto upgrade in the future. And they're not going to\nupgrade to a change that",
    "start": "2621840",
    "end": "2628380"
  },
  {
    "text": "might fix what's going on here. They're just going to keep\ndoing their old time thing.",
    "start": "2628380",
    "end": "2633540"
  },
  {
    "text": "Then with a hard\nfork, these nodes are never going to\naccept the new blocks.",
    "start": "2633540",
    "end": "2641723"
  },
  {
    "text": "It doesn't matter what the\nproof of work is on that chain. So hard forks\nversus soft works--",
    "start": "2641723",
    "end": "2648490"
  },
  {
    "text": "hard forks, as I keep stressing,\nare not backwards compatible. Guess what? A fork can be a hard fork and\na soft work at the same time.",
    "start": "2648490",
    "end": "2655570"
  },
  {
    "text": "Yay. Super confusing,\nactually, because you",
    "start": "2655570",
    "end": "2661510"
  },
  {
    "text": "can both restrict\nthe set of rules and expand the set of\nrules at the same time. Basically, it means it's a new,\noverlapping, but not entirely",
    "start": "2661510",
    "end": "2669819"
  },
  {
    "text": "inclusive or not inclusive,\nset of rules, very unfortunate. In fact, most things\nshould actually",
    "start": "2669820",
    "end": "2676020"
  },
  {
    "text": "be both, to avoid\nsome of the things that I'm going to\nshow you in a minute. Yes? AUDIENCE: But then for\nall useful purposes,",
    "start": "2676020",
    "end": "2682079"
  },
  {
    "text": "isn't it just a hard\nfork, because that means some nodes won't\nbe inside the blocks. NEHA NARULA: For\nall useful purposes,",
    "start": "2682080",
    "end": "2687510"
  },
  {
    "text": "it's not just a hard fork. Let me see if I can-- ",
    "start": "2687510",
    "end": "2701450"
  },
  {
    "text": "The reason that it's\nnot just a hard fork-- ",
    "start": "2701450",
    "end": "2708373"
  },
  {
    "text": "this is something that requires\na little bit more thought. It's not just a hard fork. But I will think about how\nto explain this, and perhaps",
    "start": "2708373",
    "end": "2714070"
  },
  {
    "text": "say something on this. Or, yeah? AUDIENCE: [INAUDIBLE] ",
    "start": "2714070",
    "end": "2735078"
  },
  {
    "text": "NEHA NARULA: It is. But he's asking, isn't\nthat just a hard fork? And it's not just a\nhard fork, because I",
    "start": "2735078",
    "end": "2740670"
  },
  {
    "text": "think old nodes will\ndo something different.",
    "start": "2740670",
    "end": "2746900"
  },
  {
    "text": "Ah, OK, so there's two reasons\nwhy it's not just a hard fork.",
    "start": "2746900",
    "end": "2752099"
  },
  {
    "text": "One is because of reorgs. So different things will happen\nas the majority of hash power",
    "start": "2752100",
    "end": "2759690"
  },
  {
    "text": "starts to accept or\nnot accept the change, whether or not all nodes\nwill switch over or not.",
    "start": "2759690",
    "end": "2767250"
  },
  {
    "text": "But if it's both a\nhard and a soft work, they will never switch over. But I think the question\nis whether old nodes can",
    "start": "2767250",
    "end": "2778050"
  },
  {
    "text": "even still function. So I think one way\nto use combination",
    "start": "2778050",
    "end": "2784589"
  },
  {
    "text": "hard and soft works\nis to actually stop the old nodes from being\nable to have blocks at all.",
    "start": "2784590",
    "end": "2791730"
  },
  {
    "text": "Like, you design\nthings in such a way, that given a majority of\nhash power moves over,",
    "start": "2791730",
    "end": "2797430"
  },
  {
    "text": "they're just going to\nend up with nothing. But this is a really\ngood question. And we should go into\nmore detail on this.",
    "start": "2797430",
    "end": "2802780"
  },
  {
    "text": "And I will try to figure out\na way to get that to you guys. OK, so who controls forks?",
    "start": "2802780",
    "end": "2810140"
  },
  {
    "text": " Yes? ",
    "start": "2810140",
    "end": "2818250"
  },
  {
    "text": "Sorry? AUDIENCE: The developers. NEHA NARULA: OK, the\ndevelopers, which I didn't even write down as a note here. OK, do the Bitcoin\ndevelopers control forks?",
    "start": "2818250",
    "end": "2826460"
  },
  {
    "text": "Who thinks yes? You're not even\nraising your hand.",
    "start": "2826460",
    "end": "2832360"
  },
  {
    "text": "Who thinks no?  Determines whether or not a\nfork is going to go through.",
    "start": "2832360",
    "end": "2838600"
  },
  {
    "start": "2838000",
    "end": "3377000"
  },
  {
    "text": "There's the Bitcoin\ndevelopers, who are actually writing the software,\nand who also have a lot of influence\nin the system,",
    "start": "2838600",
    "end": "2846140"
  },
  {
    "text": "because presumably they\nunderstand it really well if they're writing software. So they can write some\nsoftware, and decide",
    "start": "2846140",
    "end": "2853073"
  },
  {
    "text": "that they want to do a fork. Does that mean that the\nfork is going to go through? No, certainly not,\neveryone can ignore them.",
    "start": "2853073",
    "end": "2859900"
  },
  {
    "text": "And there have been\nsituations in the past where everyone ignored\nthem for quite a long time, and argued about it, and\ndidn't push a fork through.",
    "start": "2859900",
    "end": "2866870"
  },
  {
    "text": "Well, miners are the ones who\nactually create the blocks.",
    "start": "2866870",
    "end": "2872000"
  },
  {
    "text": "Are they the ones\nwho control forks? I see a very strong\nhead shake no.",
    "start": "2872000",
    "end": "2877900"
  },
  {
    "text": "Why do you shake your head? AUDIENCE: So if\nthe miners decide to change what types of\nblocks they're putting out,",
    "start": "2877900",
    "end": "2884500"
  },
  {
    "text": "they can do that. But the nodes that are\nactually validating it, no one can say they're\nnot going to accept it.",
    "start": "2884500",
    "end": "2890502"
  },
  {
    "text": "NEHA NARULA: Very true. So as we saw before, there\nare times when nodes will not",
    "start": "2890502",
    "end": "2895810"
  },
  {
    "text": "accept a chain no matter\nhow much proof of work it has on it. I think that's a very\ncommon misunderstanding.",
    "start": "2895810",
    "end": "2901390"
  },
  {
    "text": "The nodes run their\nown validation rules. And so if I'm running a\nnode, I can run whatever",
    "start": "2901390",
    "end": "2908830"
  },
  {
    "text": "validation rules I want. And I can decide what\nchain is the one that",
    "start": "2908830",
    "end": "2914050"
  },
  {
    "text": "aligns with my interests. Yes? ",
    "start": "2914050",
    "end": "2921987"
  },
  {
    "text": "AUDIENCE: If you're\ndoing a hard fork, and you are\naccepting new blocks, and they just never mined any\nblocks with those new rules.",
    "start": "2921987",
    "end": "2928220"
  },
  {
    "text": "NEHA NARULA: Exactly. So there's certainly incentives\nin many different directions. If all the miners decided\nto go to one side,",
    "start": "2928220",
    "end": "2935832"
  },
  {
    "text": "then I'm a full node with\nmy side of validation rules who has no new blocks. Great, what am I going to do?",
    "start": "2935832",
    "end": "2941200"
  },
  {
    "text": "How am I going to\nmake transactions? How am I going to\nspend my money? Also, let's say all the\nminers don't go to one side,",
    "start": "2941200",
    "end": "2948170"
  },
  {
    "text": "but most of them do, and most of\nthe nodes go to the other side. Then what am I going to do?",
    "start": "2948170",
    "end": "2953853"
  },
  {
    "text": "Who's going to listen to me? Who's going to trade with me? Who's going to take the\ncoins on my side of the fork?",
    "start": "2953853",
    "end": "2961610"
  },
  {
    "text": "So I guess that's just to\nsay that it's complicated. There's the developers.",
    "start": "2961610",
    "end": "2967340"
  },
  {
    "text": "There's the miners. There's nodes. There's the users who\ndetermine the economic value of these tokens, and\nwhich side they think",
    "start": "2967340",
    "end": "2973820"
  },
  {
    "text": "is more valuable\nor less valuable. And we've seen this\nhappen with lots of cryptocurrencies\nmultiple times.",
    "start": "2973820",
    "end": "2979890"
  },
  {
    "text": "And it's kind of exciting. So Bitcoin has forked\nmultiple times. And every time\nit's forked so far,",
    "start": "2979890",
    "end": "2987590"
  },
  {
    "text": "it has created a whole\nnew version of the coin. So it's been like a\npretty serious hard fork.",
    "start": "2987590",
    "end": "2994642"
  },
  {
    "text": "And so now, in\naddition to Bitcoin, there's Bitcoin Cash, Bitcoin\nGold, Bitcoin Diamond.",
    "start": "2994642",
    "end": "3001050"
  },
  {
    "text": "Ethereum also has fought. In Ethereum's case, they\ntried to take along everyone",
    "start": "3001050",
    "end": "3009000"
  },
  {
    "text": "with them. And so the hard\nfork was supposed to be an upgrade to Ethereum. But some people\ndecided they didn't",
    "start": "3009000",
    "end": "3015450"
  },
  {
    "text": "want to go along with it. So there's Ethereum Classic. And there's Ethereum. ",
    "start": "3015450",
    "end": "3023300"
  },
  {
    "text": "Both of them have value. So it's really unclear\nwho controls forks.",
    "start": "3023300",
    "end": "3030829"
  },
  {
    "text": "So now, let's talk about\nhash rate and forks. So nodes are pretty--",
    "start": "3030830",
    "end": "3036980"
  },
  {
    "text": "OK, what nodes will do is they\nhave a set of validation rules. If a block validates under\ntheir set of validation rules,",
    "start": "3036980",
    "end": "3047040"
  },
  {
    "text": "they will accept it. And if all the blocks validate\nunder their validation rules,",
    "start": "3047040",
    "end": "3052260"
  },
  {
    "text": "they will accept the chain\nthat those blocks are on. And if there are two\ndifferent chains where",
    "start": "3052260",
    "end": "3057720"
  },
  {
    "text": "all the blocks validate\nunder their validation rules, they'll take the one with\nthe heaviest proof of work.",
    "start": "3057720",
    "end": "3063450"
  },
  {
    "text": "That's what nodes do. So heaviest proof of work\nis clearly kind of important",
    "start": "3063450",
    "end": "3069900"
  },
  {
    "text": "here, if both sides\nof a fork validate. So if both sides of\na fork validate--",
    "start": "3069900",
    "end": "3076610"
  },
  {
    "text": "so we have to think about this\nfrom the perspective of nodes who upgrade to the new\nsoftware, and nodes who",
    "start": "3076610",
    "end": "3082110"
  },
  {
    "text": "don't upgrade to new software. So it might be worth it\nto try to kind of write",
    "start": "3082110",
    "end": "3087362"
  },
  {
    "text": "this down a little bit. ",
    "start": "3087362",
    "end": "3102300"
  },
  {
    "text": "So we have the old rule\nnodes, and the new rule nodes.",
    "start": "3102300",
    "end": "3109185"
  },
  {
    "text": " And let's just talk about\none kind of work for now.",
    "start": "3109185",
    "end": "3117310"
  },
  {
    "text": "Now, let's say less than\n50% of the miners upgrade.",
    "start": "3117310",
    "end": "3122830"
  },
  {
    "text": " And let's say greater than\n50% of the miners upgrade.",
    "start": "3122830",
    "end": "3133780"
  },
  {
    "text": "OK, so let's use\nthis chart, as we're kind of trying to\nreason about what's",
    "start": "3133780",
    "end": "3138810"
  },
  {
    "text": "going to happen in the ecosystem\nfor soft works and hard works.",
    "start": "3138810",
    "end": "3144420"
  },
  {
    "text": "So what happens if a soft fork\ndoes not obtain more than 50%",
    "start": "3144420",
    "end": "3150462"
  },
  {
    "text": "of the hash rate?  So we've got the old rules. ",
    "start": "3150462",
    "end": "3158530"
  },
  {
    "text": "We've got nodes. Some nodes have upgraded. Some nodes haven't upgraded.",
    "start": "3158530",
    "end": "3163720"
  },
  {
    "text": "Less than 50% of the\nminers have upgraded. So the old rule chain\nis going to be longer,",
    "start": "3163720",
    "end": "3170223"
  },
  {
    "text": "because they're going\nto continue mining on the old rules. By the way, sometimes\nthey don't ignore things",
    "start": "3170223",
    "end": "3175877"
  },
  {
    "text": "with the new rules. Sometimes they do. It's very complicated. But let's just pretend right now\nthat they are ignoring things",
    "start": "3175877",
    "end": "3181100"
  },
  {
    "text": "with the new rules, because\nthey haven't upgraded, and they don't see that. ",
    "start": "3181100",
    "end": "3186120"
  },
  {
    "text": "Or, sorry, they would see\nthe new rules as valid. But the majority of the\nhashing power is over here.",
    "start": "3186120",
    "end": "3192150"
  },
  {
    "text": "So what's going to happen? ",
    "start": "3192150",
    "end": "3198589"
  },
  {
    "text": "Yes? AUDIENCE: The\nbenefits of the fork aren't going to really be\nuseful much, because be there'll",
    "start": "3198590",
    "end": "3205260"
  },
  {
    "text": "be some blocks\nwith the new rules. But the majority is just\nnot going to change.",
    "start": "3205260",
    "end": "3213900"
  },
  {
    "text": "NEHA NARULA: Right, so it kind\nof depends on the soft fork.",
    "start": "3213900",
    "end": "3219299"
  },
  {
    "text": "So it depends on what the new\nrule nodes think of old blocks.",
    "start": "3219300",
    "end": "3224340"
  },
  {
    "text": "If they think that old\nblocks are still all valid,",
    "start": "3224340",
    "end": "3229960"
  },
  {
    "text": "then they're going to build\nupon old blocks just fine,",
    "start": "3229960",
    "end": "3235270"
  },
  {
    "text": "because they think\nthey're valid. If they think that old\nblocks are no longer valid, then they're going to try\nto do their own chain.",
    "start": "3235270",
    "end": "3243460"
  },
  {
    "text": " But the majority of the hashing\npower is with the old side.",
    "start": "3243460",
    "end": "3249250"
  },
  {
    "text": "So they're just going\nto get reorged out. Yes? AUDIENCE: If it's a\nsoft fork, but they also",
    "start": "3249250",
    "end": "3255630"
  },
  {
    "text": "think all the blocks are\nvalid, how is it a fork at all? ",
    "start": "3255630",
    "end": "3261763"
  },
  {
    "text": "NEHA NARULA: So\nan example of this is taking what was\nan unused op code,",
    "start": "3261763",
    "end": "3270950"
  },
  {
    "text": "and now making it meaningful. So it just so happens that\nnone of the old rule nodes",
    "start": "3270950",
    "end": "3277250"
  },
  {
    "text": "ever used this silly\nunused op code. Because they never\nused it, they never",
    "start": "3277250",
    "end": "3282410"
  },
  {
    "text": "had any invalid\nuses of the op code. So the new nodes will\nstill accept old blocks,",
    "start": "3282410",
    "end": "3292395"
  },
  {
    "text": "because none of them\nuse this op code anyway. But if they were to\nuse the new op code,",
    "start": "3292395",
    "end": "3297720"
  },
  {
    "text": "and they used it\nas a no-op op code, instead of what the\nnew rules are then it would be an invalid block.",
    "start": "3297720",
    "end": "3303925"
  },
  {
    "text": "Does that make sense?  So you have to think\nreally carefully",
    "start": "3303925",
    "end": "3310690"
  },
  {
    "text": "about how you are\ndesigning these upgrades to your software. You have to think\nvery carefully what",
    "start": "3310690",
    "end": "3316112"
  },
  {
    "text": "will happen to the old nodes. What happens if 50% of the\nminers take this thing? Well, under the old rules,\nwas anyone actually using",
    "start": "3316112",
    "end": "3322360"
  },
  {
    "text": "this thing, that we\nare now maintaining must be used in a new way? Or pay to script hash is a\ngood example of this as well.",
    "start": "3322360",
    "end": "3328799"
  },
  {
    "text": "Pay to script hash, technically,\nlooks like you're just paying to a hash. So old nodes will\nsee it, and say, OK,",
    "start": "3328800",
    "end": "3334780"
  },
  {
    "text": "if you can produce\na signature that shows that this is valid,\nblah, blah, whatever, whatever, that's fine.",
    "start": "3334780",
    "end": "3340340"
  },
  {
    "text": "But nobody ever did that. Nobody ever did that\nin a way that was",
    "start": "3340340",
    "end": "3345430"
  },
  {
    "text": "meaningful under the new rules. No one ever used it. So all the old things will\nstill validate, simply",
    "start": "3345430",
    "end": "3351490"
  },
  {
    "text": "because no one ever\ndid anything that was under the subset\nof the new rules. Sorry, this is very\nkind of complicated.",
    "start": "3351490",
    "end": "3357370"
  },
  {
    "text": "So what we have here is that\nif old rule blocks are still",
    "start": "3357370",
    "end": "3363670"
  },
  {
    "text": "valid, the software\nwill get reorged out. So no fork there, no fork there.",
    "start": "3363670",
    "end": "3374349"
  },
  {
    "text": "You're just not\nreally going to end up with stuff in the blockchain. If old rule blocks\nare now invalid,",
    "start": "3374350",
    "end": "3383460"
  },
  {
    "start": "3377000",
    "end": "3599000"
  },
  {
    "text": "then we're going to\nend up with two chains. Do people see why this is?",
    "start": "3383460",
    "end": "3390050"
  },
  {
    "text": "Because the new\nrule people are not",
    "start": "3390050",
    "end": "3395390"
  },
  {
    "text": "going to accept any chain that\nhas an invalid thing in it.",
    "start": "3395390",
    "end": "3401359"
  },
  {
    "text": "So they're not\ngoing to reorg out. They are going to continue.",
    "start": "3401360",
    "end": "3406579"
  },
  {
    "text": "And they are going to\nhave their own chain. And they're going to\nignore all of the blocks",
    "start": "3406580",
    "end": "3412040"
  },
  {
    "text": "on the other chain, which they\ndeem to be the invalid chain. Yes? AUDIENCE: Is this the\ncase for Bitcoin Cash? NEHA NARULA: No, it's not\nthe case for Bitcoin Cash.",
    "start": "3412040",
    "end": "3419180"
  },
  {
    "text": "It's actually the\ncase for something called a user-activated\nsoft fork, which the bitcoin",
    "start": "3419180",
    "end": "3424579"
  },
  {
    "text": "community threatened to do\nwhen the miners wouldn't do a soft fork they\nwanted them to do. They said, fine, you miners\nwon't do the software",
    "start": "3424580",
    "end": "3431900"
  },
  {
    "text": "that we want you to do. So, normally, people\ndon't like the situation. So you don't want\nthis to happen.",
    "start": "3431900",
    "end": "3437750"
  },
  {
    "text": "So, normally, soft\nforks are written such that if you don't get 95%\nof the miners to sign,",
    "start": "3437750",
    "end": "3444440"
  },
  {
    "text": "on the soft fork\nnever activates. So that's the way that,\ntraditionally, soft works are done in the Bitcoin ecosystem.",
    "start": "3444440",
    "end": "3450680"
  },
  {
    "text": "What does that mean? It means 5.001%\nof the hash power can stop a soft fork\nfrom going through.",
    "start": "3450680",
    "end": "3456590"
  },
  {
    "text": " So usually, things are\nwritten in such a way that you really want to\nguarantee this two chain",
    "start": "3456590",
    "end": "3463589"
  },
  {
    "text": "thing never happens. We see hash power\nis kind of voting. And if you can get\n95% of the hash power",
    "start": "3463590",
    "end": "3469849"
  },
  {
    "text": "to agree with the soft fork,\nthen only will the soft fork activate. And the way that miners do this\nis they signal in their block",
    "start": "3469850",
    "end": "3476960"
  },
  {
    "text": "headers that they are going\nto adopt the soft fork. And then the software is\nusually programmed in such a way",
    "start": "3476960",
    "end": "3483590"
  },
  {
    "text": "that it looks at some sliding\nwindow of block headers to determine whether\n95% of the hash power has decided that they're\ngoing to go along with it.",
    "start": "3483590",
    "end": "3490640"
  },
  {
    "text": "And it only activates\nonce that's the case. So doing protocol\nupgrades is really hard.",
    "start": "3490640",
    "end": "3498100"
  },
  {
    "text": "It's not a trivial matter. You don't just push some code. So usually, it's\nthe case that you",
    "start": "3498100",
    "end": "3504030"
  },
  {
    "text": "want to wait for a significant\nmajority of the mining power to indicate support\nfor the soft fork.",
    "start": "3504030",
    "end": "3510740"
  },
  {
    "text": "And, by the way, they\ncan indicate support without actually\nrunning the soft fork. This happens all the time.",
    "start": "3510740",
    "end": "3516329"
  },
  {
    "text": "But you want to wait\nfor significant support from the mining\ncommunity before actually",
    "start": "3516330",
    "end": "3522180"
  },
  {
    "text": "activating the soft fork. What happened recently\nwith something",
    "start": "3522180",
    "end": "3527397"
  },
  {
    "text": "called Segregated Witness,\nwhich we'll talk about, which was a soft fork to Bitcoin\nto introduce new functionality",
    "start": "3527397",
    "end": "3532410"
  },
  {
    "text": "that the miners opposed, was\nthe community actually said, forget it. We are going to start\nrunning the new rules.",
    "start": "3532410",
    "end": "3539100"
  },
  {
    "text": "We're going to ignore you. We don't care what the majority\nof the hash power does. We are going to go ahead\nand create this two chain",
    "start": "3539100",
    "end": "3545970"
  },
  {
    "text": "situation, and follow the\nchain with the new rules. Interestingly, this\nactually worked.",
    "start": "3545970",
    "end": "3554020"
  },
  {
    "text": "I think it was like 80 plus\npercent of the hash power was not in favor\nof the soft fork.",
    "start": "3554020",
    "end": "3559380"
  },
  {
    "text": "And the users managed to create\nthis kind of detente where they forced everyone to go along\nwith what they wanted,",
    "start": "3559380",
    "end": "3565770"
  },
  {
    "text": "super interesting.  They had no actual way to vote.",
    "start": "3565770",
    "end": "3572670"
  },
  {
    "text": "It was entirely\nsort of via Twitter. AUDIENCE: [INAUDIBLE]",
    "start": "3572670",
    "end": "3578390"
  },
  {
    "start": "3578390",
    "end": "3591839"
  },
  {
    "text": "NEHA NARULA: Yes, so this\nis one of the major reasons, and I think some of\nthe strongest evidence, that miners have nowhere\nnear as much power",
    "start": "3591840",
    "end": "3597900"
  },
  {
    "text": "as you actually think they\ndo in these ecosystems. Certainly have power, and\npart of the power they have is to do what's\ncalled an evil soft fork,",
    "start": "3597900",
    "end": "3606300"
  },
  {
    "text": "which I'm not going to\ntalk about in this class, but I think we\nprobably should talk about at some point in time.",
    "start": "3606300",
    "end": "3612359"
  },
  {
    "text": "OK, great. Let's see. OK, if the soft fork\nis greater than 50%,",
    "start": "3612360",
    "end": "3620740"
  },
  {
    "text": "old rule blocks will follow the\nnew rule blocks automatically.",
    "start": "3620740",
    "end": "3626020"
  },
  {
    "text": "So we get soft fork successful. We do not have two chains,\nbecause these will simply",
    "start": "3626020",
    "end": "3634390"
  },
  {
    "text": "be orphaned and abandoned. And, in fact, there's actually\npressure for the miners",
    "start": "3634390",
    "end": "3640359"
  },
  {
    "text": "to move over to the new rules\nso that their blocks aren't abandoned. ",
    "start": "3640360",
    "end": "3646880"
  },
  {
    "text": "Yes? AUDIENCE: So [INAUDIBLE]\nmaking it easier",
    "start": "3646880",
    "end": "3654270"
  },
  {
    "text": "mine, are those\nconsidered types of forks? NEHA NARULA: It depends.",
    "start": "3654270",
    "end": "3659930"
  },
  {
    "text": "So the question is\naround difficulty, and the number of leading zeros\nrequired in the proof of work. That changes all the time.",
    "start": "3659930",
    "end": "3665910"
  },
  {
    "text": "There's a formula\nwhich determines what that number should be. So, no, it doesn't\nrequire a fork.",
    "start": "3665910",
    "end": "3671210"
  },
  {
    "text": "But if you want to change the\nformula, that would be a fork. Requiring more proof of\nwork would be a soft work.",
    "start": "3671210",
    "end": "3679687"
  },
  {
    "text": "Requiring less proof of\nwork would be a hard fork. ",
    "start": "3679687",
    "end": "3685160"
  },
  {
    "text": "OK, now let's talk\nabout hard forks. So what happens if\na hard fork doesn't",
    "start": "3685160",
    "end": "3690650"
  },
  {
    "text": "obtain 50% of the hash rate? ",
    "start": "3690650",
    "end": "3698984"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]  NEHA NARULA: It depends, again.",
    "start": "3698984",
    "end": "3705660"
  },
  {
    "text": "It depends on if the old\nrule blocks are still valid. So we're doing a hard fork.",
    "start": "3705660",
    "end": "3712530"
  },
  {
    "text": "We're changing the\nset of valid blocks. If blocks are still valid\nunder the old rules,",
    "start": "3712530",
    "end": "3721200"
  },
  {
    "text": "then we're going to end up\nwith a situation like this. If old rule blocks\nare still valid",
    "start": "3721200",
    "end": "3727920"
  },
  {
    "text": "according to the new rule\nnodes, then the new rule nodes will just follow along. OK, so basically no\nwork happening here,",
    "start": "3727920",
    "end": "3737880"
  },
  {
    "text": "because the new rule nodes\nare going to produce blocks.",
    "start": "3737880",
    "end": "3742940"
  },
  {
    "text": "They're not going to have\nenough of the hash power. And so they're not going\nto be considered valid",
    "start": "3742940",
    "end": "3751950"
  },
  {
    "text": "by the other set. So they're going\nto end up following",
    "start": "3751950",
    "end": "3757770"
  },
  {
    "text": "along with the old rule nodes. Yes? AUDIENCE: Again, isn't the\nwhole point of a hard fork",
    "start": "3757770",
    "end": "3763360"
  },
  {
    "text": "that you're expanding the\nset of things that are valid? So aren't all old blocks going\nto be valid in a hard fork?",
    "start": "3763360",
    "end": "3771498"
  },
  {
    "text": "NEHA NARULA: Not if it's\na combination hard fork, soft fork. So maybe I should\nsplit this up into whether or not\nit's a combination",
    "start": "3771498",
    "end": "3777450"
  },
  {
    "text": "hard fork, soft fork, or not. OK, so what happens if a hard\nfork doesn't obtain greater",
    "start": "3777450",
    "end": "3782819"
  },
  {
    "text": "than 50% of the hash rate? What's going to happen then? ",
    "start": "3782820",
    "end": "3792606"
  },
  {
    "text": "AUDIENCE: We'll be\nmining to the old rules. NEHA NARULA: Yes, we're going\nto end up with two chains.",
    "start": "3792606",
    "end": "3798570"
  },
  {
    "text": "This is going to have chain-- whatever, the point\nis, there's going to be an old chain\nand a new chain.",
    "start": "3798570",
    "end": "3806040"
  },
  {
    "text": "The old nodes are never going\nto accept the new nodes blocks.",
    "start": "3806040",
    "end": "3812590"
  },
  {
    "text": "And we're going to end up\nwith two chains forever.",
    "start": "3812590",
    "end": "3817940"
  },
  {
    "text": "And this has happened\nmultiple times. ",
    "start": "3817940",
    "end": "3823290"
  },
  {
    "text": "Are there questions\nabout hard forks? ",
    "start": "3823290",
    "end": "3830790"
  },
  {
    "text": "Yes? AUDIENCE: Are there ways for\nthe hard fork to make life really difficult for\nthe smaller chain?",
    "start": "3830790",
    "end": "3837756"
  },
  {
    "text": "NEHA NARULA: Are there ways\nfor a hard work to make life really difficult for\nthe smaller chain? That is a good question.",
    "start": "3837757",
    "end": "3843450"
  },
  {
    "text": "I think it depends. ",
    "start": "3843450",
    "end": "3848840"
  },
  {
    "text": "So there's multiple ways\nto make life difficult. I think what you're\nasking is not,",
    "start": "3848840",
    "end": "3854220"
  },
  {
    "text": "what if the hard fork becomes\nmore popular and more people decide to move over to it,\nand abandon the smaller chain?",
    "start": "3854220",
    "end": "3859460"
  },
  {
    "text": "That's one way in which life\ncould be more difficult. But another way that life\ncould be more difficult",
    "start": "3859460",
    "end": "3864590"
  },
  {
    "text": "is if the hard fork somehow made\nthe previous chain no longer",
    "start": "3864590",
    "end": "3869690"
  },
  {
    "text": "a productive chain to be on. And I think that the primary\nway that that would happen",
    "start": "3869690",
    "end": "3877760"
  },
  {
    "text": "would not actually\nbe a hard fork, but would be a combination\nhard fork, soft fork.",
    "start": "3877760",
    "end": "3882859"
  },
  {
    "text": "But there are definitely\nways for miners to play with hard forks and soft\nforks in such a way that-- see,",
    "start": "3882860",
    "end": "3891410"
  },
  {
    "text": "this is actually kind\nof ideal in some ways. This is like, OK, we disagree\non what the rules should be.",
    "start": "3891410",
    "end": "3898182"
  },
  {
    "text": "I want some new set of rules. You don't want some\nnew set of rules. Fine, let's just\nsplit the ecosystem.",
    "start": "3898182",
    "end": "3903380"
  },
  {
    "text": "You guys go your way. I'll go my way. We'll have two different coins.",
    "start": "3903380",
    "end": "3908570"
  },
  {
    "text": "Life will be great. What's kind of not\nso nice is when one side tries to coerce\nthe other side to go along,",
    "start": "3908570",
    "end": "3917240"
  },
  {
    "text": "which is kind of what a\ngreater than 50% soft fork is. You're kind of\ncoercing the other side",
    "start": "3917240",
    "end": "3922820"
  },
  {
    "text": "to go along, because they\nhave no way of opting out.",
    "start": "3922820",
    "end": "3928270"
  },
  {
    "text": "And there are ways that miners\ncan make the side of the chain",
    "start": "3928270",
    "end": "3933610"
  },
  {
    "text": "with less harsh power\nbasically useless. ",
    "start": "3933610",
    "end": "3940270"
  },
  {
    "text": "This is totally\nsomething miners can do. People talk about\nit occasionally. It just doesn't seem\nlike they figured out",
    "start": "3940270",
    "end": "3945970"
  },
  {
    "text": "that they can do it, or\nthey haven't tried to do it. I don't know. Maybe they don't want to do it. I'm not sure. It would be pretty\ndisruptive to the ecosystem.",
    "start": "3945970",
    "end": "3952613"
  },
  {
    "text": " OK, so question-- we've\ntalked about what happens here",
    "start": "3952613",
    "end": "3960610"
  },
  {
    "text": "from the perspective\nof full nodes, and from the\nperspective of miners. What happens from the\nperspective of people",
    "start": "3960610",
    "end": "3967119"
  },
  {
    "text": "with wallets who\nmight be running SPV? ",
    "start": "3967120",
    "end": "3974121"
  },
  {
    "text": "What do we think?  Depends on which node\nthey're connected to.",
    "start": "3974122",
    "end": "3981950"
  },
  {
    "text": "So one problem with SPV is\nthat they don't actually",
    "start": "3981950",
    "end": "3987750"
  },
  {
    "text": "get the blocks. So they don't actually\nvalidate blocks. All they validate\nis proof of work.",
    "start": "3987750",
    "end": "3996060"
  },
  {
    "text": "Some changes that\nmake a block invalid might show up in the header.",
    "start": "3996060",
    "end": "4001940"
  },
  {
    "text": "But a lot of changes that\nmight make a block invalid, or new blocks valid, don't\nshow up in the header.",
    "start": "4001940",
    "end": "4009183"
  },
  {
    "text": " So given what we've learned\nabout how SPV works,",
    "start": "4009184",
    "end": "4015680"
  },
  {
    "text": "what happens when\nthere's a fork? So let's go back and take a\nlook at what SPV wallets see.",
    "start": "4015680",
    "end": "4023710"
  },
  {
    "text": "They see the block headers. You have to download\nall the headers, which includes the nines\nfor the proof of work,",
    "start": "4023710",
    "end": "4030340"
  },
  {
    "text": "the Merkle root for the\ntransaction, timestamp, stuff like that. They also get Merkle\npaths for the transactions",
    "start": "4030340",
    "end": "4036819"
  },
  {
    "text": "that they've told the node\nthey're interested in. ",
    "start": "4036820",
    "end": "4043009"
  },
  {
    "text": "So what would happen if there\nwere a soft work or hard fork? What would happen to an SPV?",
    "start": "4043010",
    "end": "4048035"
  },
  {
    "start": "4048035",
    "end": "4053839"
  },
  {
    "text": "They don't really have\na say in the situation. They aren't really\nparticipating in validation.",
    "start": "4053840",
    "end": "4059569"
  },
  {
    "text": "They're not\nparticipating in mining. And they're kind of at\nthe mercy of whatever",
    "start": "4059570",
    "end": "4065240"
  },
  {
    "text": "node that they are talking to. And, in fact, if they try\nto talk to multiple nodes,",
    "start": "4065240",
    "end": "4071119"
  },
  {
    "text": "they might get multiple\ndifferent answers. And they don't really know which\nanswer is the right answer.",
    "start": "4071120",
    "end": "4077279"
  },
  {
    "text": "And this could get really\ntricky and complicated. Now, I think probably\nit's fair to say",
    "start": "4077279",
    "end": "4083569"
  },
  {
    "text": "that the majority of the Bitcoin\necosystem, in terms of users, actually does not run\ntheir own full nodes.",
    "start": "4083570",
    "end": "4090589"
  },
  {
    "text": "They interact with\nthe Bitcoin network, at best, through SPV, and\nat worst through a trusted",
    "start": "4090590",
    "end": "4097220"
  },
  {
    "text": "third party like Coinbase. So what does the ecosystem\nhave to say or do about",
    "start": "4097220",
    "end": "4104600"
  },
  {
    "text": "whether or not forks are\naccepted or not accepted? ",
    "start": "4104600",
    "end": "4115920"
  },
  {
    "text": "Yeah? AUDIENCE: They don't\nreally have to. NEHA NARULA: They don't\nreally have a say. They kind of I would say at\nlike a meta level, in that users",
    "start": "4115920",
    "end": "4124000"
  },
  {
    "text": "can pressure Coinbase to start\nfollowing Bitcoin Cash which is a hard fork of bitcoin.",
    "start": "4124000",
    "end": "4130660"
  },
  {
    "text": "They kind of have a say\nat an economic level, in that if Coinbase starts\naccepting Bitcoin Cash,",
    "start": "4130660",
    "end": "4138160"
  },
  {
    "text": "then the price of\nBitcoin Cash will go up. And so that's kind\nof a big deal. But in terms of like\na protocol level,",
    "start": "4138160",
    "end": "4144130"
  },
  {
    "text": "in terms of accepting or\nrejecting transactions,",
    "start": "4144130",
    "end": "4149290"
  },
  {
    "text": "they don't really have\na say because they can't see enough to\ndetermine whether or not",
    "start": "4149290",
    "end": "4157165"
  },
  {
    "text": "they're interested in following\na fork or not following a fork. In fact, it's even\nworse than that. There were multiple\nsituations where",
    "start": "4157165",
    "end": "4163509"
  },
  {
    "text": "we ended up with two chains. So an SPV wallet might think\nthat they received money",
    "start": "4163510",
    "end": "4169899"
  },
  {
    "text": "on one chain, and they\ndidn't receive money on the other chain. So very bad things can happen\nto wallets and to SPV clients",
    "start": "4169899",
    "end": "4181199"
  },
  {
    "text": "during a fork. And it's incredibly disruptive. And people who create software\non the behalf of users--",
    "start": "4181200",
    "end": "4190240"
  },
  {
    "text": "so not even running SPV,\nbut like the Coinbase's of the world, and the\nexchanges of the world-- they have to do a\nfair amount of work",
    "start": "4190240",
    "end": "4197130"
  },
  {
    "text": "to make sure that they aren't\ngoing to lose users' money when",
    "start": "4197130",
    "end": "4202770"
  },
  {
    "text": "there's a fork. And the exchanges, and the\nCoinbase's of the world,",
    "start": "4202770",
    "end": "4207900"
  },
  {
    "text": "have screwed this\nup in the past. There's been money lost.",
    "start": "4207900",
    "end": "4213330"
  },
  {
    "text": "There are ways to\nsafely design your fork so that it's less\nlikely that wallets",
    "start": "4213330",
    "end": "4218850"
  },
  {
    "text": "will do the wrong thing. But I think we're kind\nof just figuring out how",
    "start": "4218850",
    "end": "4224400"
  },
  {
    "text": "to really do that effectively. AUDIENCE: [INAUDIBLE] ",
    "start": "4224400",
    "end": "4237780"
  },
  {
    "text": "NEHA NARULA: Yeah, so this\nis kind of pretty bad, because if Bitcoin\nis really going",
    "start": "4237780",
    "end": "4242970"
  },
  {
    "text": "to undergo a hard\nfork or soft fork, everybody is paying attention. If Ethereum is going to do it,\neveryone's paying attention.",
    "start": "4242970",
    "end": "4248188"
  },
  {
    "text": "But there's so many\naltcoins out there. And, yeah, there's\nso much opportunity for people to take advantage\nof the disarray that",
    "start": "4248188",
    "end": "4255030"
  },
  {
    "text": "happens when a fork happens. So I think we're right in the\nmiddle of trying to figure out",
    "start": "4255030",
    "end": "4260940"
  },
  {
    "text": "best practices for handling\nforks safely, and also,",
    "start": "4260940",
    "end": "4266880"
  },
  {
    "text": "giving users some way of\nchoosing what side of a fork that they want, because\nthere's this sort of thought",
    "start": "4266880",
    "end": "4276150"
  },
  {
    "text": "that eventually there will\nbe economic pressure to--",
    "start": "4276150",
    "end": "4281340"
  },
  {
    "text": "for a long time, people thought\nthat if Bitcoin hard forked, one side would win, and the\nother side would go to zero.",
    "start": "4281340",
    "end": "4288750"
  },
  {
    "text": "And now, we've seen that\nthat is absolutely not true. In fact, when\nBitcoin hard forked,",
    "start": "4288750",
    "end": "4294570"
  },
  {
    "text": "sometimes the total market cap\nof one side plus the other side is bigger than the total market\ncap of what Bitcoin used to be.",
    "start": "4294570",
    "end": "4301440"
  },
  {
    "text": "So money is literally\ncreated out of nowhere. So hard forking\nis very lucrative.",
    "start": "4301440",
    "end": "4306780"
  },
  {
    "text": "It literally gives every\nBitcoin user more money. So if you own Bitcoin\nwithin the past--",
    "start": "4306780",
    "end": "4313440"
  },
  {
    "text": "like, if you owned\nBitcoin a year ago, you probably have like\nfour other coins right now.",
    "start": "4313440",
    "end": "4318628"
  },
  {
    "text": "I don't know. You should go sell them,\nor sell the Bitcoin, and buy the other coins,\nor whatever you want to do. But the point is,\nyou have more money",
    "start": "4318628",
    "end": "4325080"
  },
  {
    "text": "than you might have\neven known that you had, because someone has\ndone these forks. Don't even like get\nstarted about the tax",
    "start": "4325080",
    "end": "4331320"
  },
  {
    "text": "consequences of this. It's very confusing,\nextraordinarily confusing. And people are trying to\nfigure out what to do,",
    "start": "4331320",
    "end": "4336510"
  },
  {
    "text": "because you didn't\nask for this fork. Like, I as a holder\nof Bitcoin, didn't decide that I wanted\nBitcoin Cash to be a thing.",
    "start": "4336510",
    "end": "4344369"
  },
  {
    "text": "I didn't accept Bitcoin Cash. But now, the same private keys I\nused to control my Bitcoin also",
    "start": "4344370",
    "end": "4349710"
  },
  {
    "text": "control the same\namount of Bitcoin Cash. It's kind of crazy. Let's talk about\nforks in practice.",
    "start": "4349710",
    "end": "4355559"
  },
  {
    "text": "So soft forks in\npractice-- there have been lots of soft forks. Soft forks are very useful. Soft forks are helpful. This is the major way that\npeople upgrade software.",
    "start": "4355559",
    "end": "4362652"
  },
  {
    "text": "And, again, the\nway that they do it is they try to make sure\n95%, or some huge majority of the miners, are on board.",
    "start": "4362652",
    "end": "4368130"
  },
  {
    "text": "And that way, it's sort\nof like as non-disruptive to the ecosystem as possible. So pay to script\nhas was a soft fork.",
    "start": "4368130",
    "end": "4375830"
  },
  {
    "text": "The introduction of\nSegwit was a soft fork. In operation, check\nsequence verify was added as a soft fork.",
    "start": "4375830",
    "end": "4382150"
  },
  {
    "text": "So that's kind of why they're\nall these like unused ops out there. In case we want to use one\nof them for something new,",
    "start": "4382150",
    "end": "4389820"
  },
  {
    "text": "we can do that with a soft fork. Hard forks in practice--",
    "start": "4389820",
    "end": "4395340"
  },
  {
    "text": "there's lots of new Bitcoins,\nBitcoin Cash, Gold, Diamond, like I said.",
    "start": "4395340",
    "end": "4400500"
  },
  {
    "text": "Ethereum went through a\nreally interesting hard fork. And there's some\ncryptocurrencies that actually",
    "start": "4400500",
    "end": "4405540"
  },
  {
    "text": "hard fork quite frequently. For instance, I learned\nthe Monero hard forks about every six months. Vertcoin, how many hard\nforks have you guys done?",
    "start": "4405540",
    "end": "4413120"
  },
  {
    "text": "Three? Three hard forks. So, despite the way that\nI said that hard forks are",
    "start": "4413120",
    "end": "4419640"
  },
  {
    "text": "very disruptive, if you can\nget all the nodes to upgrade, it's not really a big problem.",
    "start": "4419640",
    "end": "4426150"
  },
  {
    "text": "So for cryptocurrencies where\nthe nodes are really well connected, or they auto\nupdate, or things like that,",
    "start": "4426150",
    "end": "4432180"
  },
  {
    "text": "hard forks are much\nless disruptive. So let's talk about the\nEthereum hard fork for a moment.",
    "start": "4432180",
    "end": "4439540"
  },
  {
    "text": "So this happened two years ago-- a year ago? I can't remember when this\nhappened, two years ago,",
    "start": "4439540",
    "end": "4446460"
  },
  {
    "text": "I think, almost. And so what happened\nwas we haven't talked a lot about\nEthereum, so we'll",
    "start": "4446460",
    "end": "4452690"
  },
  {
    "text": "be coming to explain Ethereum\nin much greater detail. But the point is Ethereum\nhad a smart contract",
    "start": "4452690",
    "end": "4458219"
  },
  {
    "text": "which had a bug in it.  And someone hacked the contract,\nand started siphoning off ether",
    "start": "4458220",
    "end": "4466920"
  },
  {
    "text": "from the contract. So the Ethereum team all\ngot together, and decided,",
    "start": "4466920",
    "end": "4472449"
  },
  {
    "text": "we're going to\nrectify this wrong. Now, rectifying the wrong-- I mean, I already\nsaid it's a hard fork.",
    "start": "4472450",
    "end": "4477770"
  },
  {
    "text": "But why is rectifying this wrong\na hard fork not a soft fork?",
    "start": "4477770",
    "end": "4484250"
  },
  {
    "text": "AUDIENCE: Because you\nwant to change history. NEHA NARULA: Because you\nwant to change history.",
    "start": "4484250",
    "end": "4489619"
  },
  {
    "text": "That's an interesting\nway of putting it. And the way that\nwe change history is not by actually going back\nin time and editing history,",
    "start": "4489620",
    "end": "4496490"
  },
  {
    "text": "unless you are\nAccenture I guess, which creates\neditable blockchains. But the way that\nwe edit history,",
    "start": "4496490",
    "end": "4502159"
  },
  {
    "text": "is we add something to\nthe blockchain which indicates that we're going to\nundo, or change, or rollback",
    "start": "4502160",
    "end": "4508760"
  },
  {
    "text": "or somehow create\nan operation, that does something that\neffectively undoes",
    "start": "4508760",
    "end": "4514100"
  },
  {
    "text": "what happened in the past. ",
    "start": "4514100",
    "end": "4520330"
  },
  {
    "text": "So the Ethereum\ndeveloper got together. And they originally tried to do\nthis as a soft fork, actually.",
    "start": "4520330",
    "end": "4526210"
  },
  {
    "text": "So it could have\nbeen a soft fork. And the way that the soft\nwork would have worked is that it just\nwould have ignored",
    "start": "4526210",
    "end": "4532900"
  },
  {
    "text": "all of the transactions\nthat were sort of--",
    "start": "4532900",
    "end": "4539045"
  },
  {
    "text": "I can't remember\nexactly how it worked. But, basically, the\ngeneral idea was, ignore all of the transactions that\nmight spend the hacker's money.",
    "start": "4539045",
    "end": "4548440"
  },
  {
    "text": "Ignore the transaction\nwhere people gave money to the hacker, what ultimately\nbecame the hacker, which",
    "start": "4548440",
    "end": "4555670"
  },
  {
    "text": "is a new rule. Now, you're shrinking the\nset of acceptable blocks. And the problem\nwas they realized",
    "start": "4555670",
    "end": "4561159"
  },
  {
    "text": "that if they did this\nas a soft fork, then they were inadvertently\ncreating an attack",
    "start": "4561160",
    "end": "4566740"
  },
  {
    "text": "vector, because people\ncould now spam the network and potentially waste the\nresources of the miners--",
    "start": "4566740",
    "end": "4573670"
  },
  {
    "text": "very challenging to do soft\nforks and hard forks correctly. So they decided,\nOK, you know what? We're just going to\ndo it as a hard fork.",
    "start": "4573670",
    "end": "4580180"
  },
  {
    "text": "When this block comes\nabout, block 1,920,000,",
    "start": "4580180",
    "end": "4585230"
  },
  {
    "text": "we are going to simply\ntransfer around 12 million either from the hacker's\naccount into this other account,",
    "start": "4585230",
    "end": "4595152"
  },
  {
    "text": "this other contract, which is\ngoing to give the money back, where people can\nreclaim their money.",
    "start": "4595152",
    "end": "4600630"
  },
  {
    "text": "So literally just\nhardcoded in this transfer. 85% of the hash power in\nEthereum went along with it.",
    "start": "4600630",
    "end": "4610619"
  },
  {
    "text": "So that means 15% didn't. And that means that there\nare two currencies now. There is Ethereum,\nand Ethereum Classic.",
    "start": "4610620",
    "end": "4618390"
  },
  {
    "text": "And they persist to this\nday, almost two years later. And when I looked this\nmorning, it was about a 30 to 1",
    "start": "4618390",
    "end": "4625230"
  },
  {
    "text": "ratio between Ethereum\nand Ethereum Classic. Yes? AUDIENCE: So Ethereum\nClassic says,",
    "start": "4625230",
    "end": "4630368"
  },
  {
    "text": "we are not OK with you\nguys undoing this hack. NEHA NARULA: Exactly,\nso Ethereum Classic says, we're not messing with\npeople's accounts like that.",
    "start": "4630368",
    "end": "4637800"
  },
  {
    "text": "No, no, no. What happened happened,\nfair and square. We are not changing history.",
    "start": "4637800",
    "end": "4644340"
  },
  {
    "text": "And so in Ethereum Classic,\nthe hacker has money. On Ethereum, the hacker\ndoes not have money. ",
    "start": "4644340",
    "end": "4651940"
  },
  {
    "text": "Yes? AUDIENCE: [INAUDIBLE]\none specific contract.",
    "start": "4651940",
    "end": "4657390"
  },
  {
    "text": "So the argument is we shouldn't\nbe fixing people's mistakes. They should learn--",
    "start": "4657390",
    "end": "4662630"
  },
  {
    "text": "Was this analogous\nto the Parity? NEHA NARULA: Yes.",
    "start": "4662630",
    "end": "4667900"
  },
  {
    "text": "So here they decided,\nthere was a bug in someone's smart contract. It was exploited.",
    "start": "4667900",
    "end": "4673517"
  },
  {
    "text": "We're going to give\npeople their money back. This happened again\nwith a different type of smart contract in a different\nway a couple months ago.",
    "start": "4673517",
    "end": "4681160"
  },
  {
    "text": "And they decided-- well, they\ncould still decide to do it. But so far, they decided not\nto give everyone's money back.",
    "start": "4681160",
    "end": "4688389"
  },
  {
    "text": "So there's about 90 million\nor something dollars worth of ether that's locked\nup in these contracts,",
    "start": "4688390",
    "end": "4693820"
  },
  {
    "text": "due to a bug. And in the case of the DAO,\nthey decided, let's do it. In the case of this Parity bug,\nthey decided, let's not do it.",
    "start": "4693820",
    "end": "4703610"
  },
  {
    "text": "And if you talk to the\nEthereum Foundation people, they'll talk about governance. And they'll say, well, we\nfeel like this made sense",
    "start": "4703610",
    "end": "4710980"
  },
  {
    "text": "for these reasons. But this doesn't make\nsense for these reasons. But it's still it's\na set of people getting together and\ndeciding whether or not",
    "start": "4710980",
    "end": "4717700"
  },
  {
    "text": "to give money back. Yeah? AUDIENCE: [INAUDIBLE] ",
    "start": "4717700",
    "end": "4724747"
  },
  {
    "text": "NEHA NARULA: No, it's not\nthe Ethereum Foundation. The Ethereum Foundation was\nnot a fan of Ethereum Classic. It's a separate group of people.",
    "start": "4724747",
    "end": "4730270"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]  NEHA NARULA: No, actually,\nso it turned out,",
    "start": "4730270",
    "end": "4735535"
  },
  {
    "text": "interestingly enough--\nand this was something that I saw at a\nconference that looked into who were the\ncontributors to all",
    "start": "4735535",
    "end": "4741688"
  },
  {
    "text": "of these different\nforks, when trying to understand governance? It actually turns out that\nno one from the Ethereum Foundation works on\nEthereum Classic.",
    "start": "4741688",
    "end": "4748210"
  },
  {
    "text": "And no one who used\nto work on Bitcoin works on Bitcoin Cash,\nGold, or Diamond. So it's entirely\nnew sets of people.",
    "start": "4748210",
    "end": "4755179"
  },
  {
    "text": "Yes? AUDIENCE: The former lead\ndeveloper of Bitcoin core is working on Bitcoin Cash.",
    "start": "4755180",
    "end": "4761490"
  },
  {
    "text": "NEHA NARULA: He's not actually. You're talking about\nGavin Andreessen? Yeah, I don't think he actually\nmakes commits to Bitcoin Cash.",
    "start": "4761490",
    "end": "4768443"
  },
  {
    "text": "AUDIENCE: In a\ngeneral sense, he's contributing on GitHub,\nnot specifically to any implementations.",
    "start": "4768443",
    "end": "4773980"
  },
  {
    "text": "But to protocol,\nblock-level exchanges. NEHA NARULA: Interesting. Yes?",
    "start": "4773980",
    "end": "4779199"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] ",
    "start": "4779200",
    "end": "4784983"
  },
  {
    "text": "NEHA NARULA: It\ndepends on how you define contribute, certainly. This is a really interesting\nexample of a hard fork.",
    "start": "4784983",
    "end": "4791260"
  },
  {
    "text": "In summary, just\nto wrap up here, forks are extremely challenging.",
    "start": "4791260",
    "end": "4796510"
  },
  {
    "text": "Upgrading software in\ndecentralized cryptocurrencies is extremely challenging.",
    "start": "4796510",
    "end": "4803030"
  },
  {
    "text": "And so the lesson that I want\nyou to take from this is, unless you need what a\ndecentralized cryptocurrency",
    "start": "4803030",
    "end": "4808210"
  },
  {
    "text": "has to offer, you will probably\nbe better off not using a decentralized cryptocurrency.",
    "start": "4808210",
    "end": "4813889"
  },
  {
    "text": "They are very hard to update. They're very hard to upgrade. There are frequently bugs. And so I think that forks and\nthe challenges around forks",
    "start": "4813890",
    "end": "4822490"
  },
  {
    "text": "are an excellent reason not to\ndo this when you don't have to.",
    "start": "4822490",
    "end": "4828880"
  },
  {
    "text": "And also, what's really\ninteresting, I think, is that your traditional\nconsensus systems",
    "start": "4828880",
    "end": "4835059"
  },
  {
    "text": "don't address this\nproblem at all, because your traditional\ndistributed consensus",
    "start": "4835059",
    "end": "4840159"
  },
  {
    "text": "systems don't have any\nnotion of what nodes are going to find\nvalid, or not valid, or changing the\nrules of validity.",
    "start": "4840160",
    "end": "4846045"
  },
  {
    "text": "And so these\nproblems really only arise when you start\nto have these validity rules that you're\ndealing with, and you",
    "start": "4846045",
    "end": "4852070"
  },
  {
    "text": "have nodes that might\ntake one set of rules, and nodes that might take\nanother set of rules. The consensus mechanism\nhere ultimately",
    "start": "4852070",
    "end": "4858460"
  },
  {
    "text": "becomes irrelevant if you\ndon't agree with the validity of the blocks. It doesn't matter that\na majority of hash power",
    "start": "4858460",
    "end": "4865270"
  },
  {
    "text": "said that this is\nthe blockchain. It doesn't matter if\na majority of signers say this is the blockchain. If you don't agree that the\nthings in that blockchain",
    "start": "4865270",
    "end": "4872260"
  },
  {
    "text": "are valid, you're\ngoing to ignore that. Majority be damned. So it's very different\nthan distributed consensus.",
    "start": "4872260",
    "end": "4879270"
  },
  {
    "text": "Okay, and so real quick,\nlast thing... on Wednesday we will have another guest\nlecturer. Her name is Sharon Goldberg.",
    "start": "4879270",
    "end": "4886200"
  },
  {
    "text": "She's a professor at Boston University\nand she's worked on a lot of really interesting things. In particular,\nsomething really cool that she's worked",
    "start": "4886200",
    "end": "4892590"
  },
  {
    "text": "on is using the peer-to-peer network to\ncreate attacks in Bitcoin, and then very",
    "start": "4892590",
    "end": "4897840"
  },
  {
    "text": "recently she nor co-authors released a\npaper on peer-to-peer network attacks in Ethereum. And so she's gonna be here\nto talk about the peer-to-peer networks",
    "start": "4897840",
    "end": "4904920"
  },
  {
    "text": "behind these things and to share some of\nthe research that she's done.",
    "start": "4904920",
    "end": "4911000"
  }
]