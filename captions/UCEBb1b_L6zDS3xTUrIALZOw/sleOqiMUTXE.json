[
  {
    "start": "0",
    "end": "15000"
  },
  {
    "text": "The following\ncontent is provided by MIT OpenCourseWare under\na Creative Commons license.",
    "start": "0",
    "end": "6310"
  },
  {
    "text": "Additional information\nabout our license and MIT OpenCourseWare\nin general is available at ocw.mit.edu.",
    "start": "6310",
    "end": "11799"
  },
  {
    "text": " PROFESSOR: All\nright, so I'll start with this review board, which\nshows the conservation law.",
    "start": "11800",
    "end": "23270"
  },
  {
    "start": "15000",
    "end": "710000"
  },
  {
    "text": "Scalar, one unknown,\none dimension, x, one space variable, and\nthe flux function is f of u.",
    "start": "23270",
    "end": "34309"
  },
  {
    "text": "That's the differential form. We have seen that at some\npoints that differential form",
    "start": "34310",
    "end": "42899"
  },
  {
    "text": "produces a discontinuous\nsolution, a discontinuity.",
    "start": "42900",
    "end": "48400"
  },
  {
    "text": "In that case we\nare better off with the integrated integral form.",
    "start": "48400",
    "end": "54720"
  },
  {
    "text": "So I just integrate that one\nfrom a point x_left to a point",
    "start": "54720",
    "end": "60610"
  },
  {
    "text": "x_right, from an a to\nb, and that gives me-- I have then the integral.",
    "start": "60610",
    "end": "67620"
  },
  {
    "text": "So if u was density,\nfor example, the integral of density\nwill be the mass.",
    "start": "67620",
    "end": "73630"
  },
  {
    "text": "That's the quantity\nthat I'm seeing here, so this is the rate\nof change of mass",
    "start": "73630",
    "end": "80210"
  },
  {
    "text": "in the interval comes from flux\ngoing out minus flux coming in.",
    "start": "80210",
    "end": "89310"
  },
  {
    "text": "So that's the conservation\nlaw in its pure statement.",
    "start": "89310",
    "end": "94530"
  },
  {
    "text": "And we learned that\nsolution for this--",
    "start": "94530",
    "end": "100880"
  },
  {
    "text": "while we're looking at\nthe differential problem, we can follow these\ncharacteristics",
    "start": "100880",
    "end": "106170"
  },
  {
    "text": "from the initial time zero. So at time zero we look\nat a point x and the value",
    "start": "106170",
    "end": "115960"
  },
  {
    "text": "at that point just\ntravels-- is sort of safely",
    "start": "115960",
    "end": "121090"
  },
  {
    "text": "carried up the characteristic\nline, which is that equals x_0.",
    "start": "121090",
    "end": "127509"
  },
  {
    "text": "And the problem arose when\ncharacteristics either collided",
    "start": "127510",
    "end": "134970"
  },
  {
    "text": "into each other or separated. ",
    "start": "134970",
    "end": "141340"
  },
  {
    "text": "Those are the two\ndifficulties and they have different resolutions.",
    "start": "141340",
    "end": "148480"
  },
  {
    "text": "So this is what we met\nin the traffic example when a light goes red.",
    "start": "148480",
    "end": "155580"
  },
  {
    "text": "When a light goes red cars\nare coming up to the light,",
    "start": "155580",
    "end": "161160"
  },
  {
    "text": "in front of the light\nthe density is low.",
    "start": "161160",
    "end": "166950"
  },
  {
    "text": "The cars have to brake quickly. So something happens--\nthat's a question mark there.",
    "start": "166950",
    "end": "172600"
  },
  {
    "text": "What do you do when\ncharacteristics collide? When the value here cannot\nbe both the initial value",
    "start": "172600",
    "end": "179430"
  },
  {
    "text": "that's coming up that\ncharacteristic and the initial value that's coming up there\nbecause they're different?",
    "start": "179430",
    "end": "185720"
  },
  {
    "text": "So we need a rule\nfor what to do there. And we also need a\nrule for what to do",
    "start": "185720",
    "end": "190780"
  },
  {
    "text": "in case of an empty space. When no characteristics--\nhere, two characteristics",
    "start": "190780",
    "end": "196920"
  },
  {
    "text": "are hitting, here none\nare touching there. Characteristics are separating\nin this case and the question",
    "start": "196920",
    "end": "203280"
  },
  {
    "text": "is, what solution do\nyou fill in the middle when you haven't got\na characteristic? It's not coming from the start.",
    "start": "203280",
    "end": "212030"
  },
  {
    "text": "OK, what solution to choose? The answers will be different.",
    "start": "212030",
    "end": "218209"
  },
  {
    "text": "And let me take the first one,\nthe collision question, first.",
    "start": "218210",
    "end": "224490"
  },
  {
    "text": "So what will happen\nis a shock will form.",
    "start": "224490",
    "end": "232850"
  },
  {
    "text": "There'll be a shock line so\nthat these characteristics carry",
    "start": "232850",
    "end": "239330"
  },
  {
    "text": "information into the shock, by\nthe way, that's a big deal--",
    "start": "239330",
    "end": "244500"
  },
  {
    "text": "up until they hit the shock,\nand these characteristics carry their information. And across the shock we\nhave different values,",
    "start": "244500",
    "end": "254110"
  },
  {
    "text": "u on the left and\nu on the right. So that's one possible\nform of the solution",
    "start": "254110",
    "end": "263490"
  },
  {
    "text": "because that will solve\nthe equation in this region where the characteristics\nfrom the right",
    "start": "263490",
    "end": "268760"
  },
  {
    "text": "are following the formula. It'll solve it from the left,\nso everything comes down",
    "start": "268760",
    "end": "275060"
  },
  {
    "text": "to the jump condition\nat the shock. What's the shock speed?",
    "start": "275060",
    "end": "281259"
  },
  {
    "text": "Where does this shock go? It's to find that\nshock in the xt-plane",
    "start": "281260",
    "end": "287500"
  },
  {
    "text": "that I have to use\nthis integral form.",
    "start": "287500",
    "end": "292970"
  },
  {
    "text": "I must use the integral\nform because I've got a discontinuity and\nthe differential form just doesn't make sense.",
    "start": "292970",
    "end": "299280"
  },
  {
    "text": "OK, I wrote down the key idea\nhere or the conclusion, but not",
    "start": "299280",
    "end": "304790"
  },
  {
    "text": "the reasoning. I'm looking for\nthis jump condition at the shock, which is\ngoing to locate the shock.",
    "start": "304790",
    "end": "313370"
  },
  {
    "text": "And the key quantity\nthat I have to find is the shock speed,\nwhich will tell me",
    "start": "313370",
    "end": "319040"
  },
  {
    "text": "where that shock is going,\nhow it's moving up in time.",
    "start": "319040",
    "end": "324520"
  },
  {
    "text": "So time is going that way, x is\ngoing this way in this picture.",
    "start": "324520",
    "end": "330009"
  },
  {
    "text": "So this has a speed, s of t. ",
    "start": "330010",
    "end": "336790"
  },
  {
    "text": "And here's the conclusion. There's the jump condition. So what does it mean?",
    "start": "336790",
    "end": "343729"
  },
  {
    "text": "This notation, this bracket\nnotation is the jump. ",
    "start": "343730",
    "end": "351640"
  },
  {
    "text": "The shock equation is beautiful. It says that s, the shock\nspeed, times the jump",
    "start": "351640",
    "end": "357230"
  },
  {
    "text": "in u is the jump in f of u. And let me take\nthis example that",
    "start": "357230",
    "end": "363640"
  },
  {
    "text": "is sort of the Burgers'\nequation example. So this is the example that\ncomes from Burgers' equation.",
    "start": "363640",
    "end": "371360"
  },
  {
    "start": "371360",
    "end": "378259"
  },
  {
    "text": "That's the example\nwhere the flux is this nice parabolic\nfunction u squared over 2.",
    "start": "378260",
    "end": "387420"
  },
  {
    "text": "Then the change in flux, the\njump in the flux function",
    "start": "387420",
    "end": "392520"
  },
  {
    "text": "is u right squared minus\nu left squared over 2 and I divide by the jump in u,\nwhich is u_right minus u_left",
    "start": "392520",
    "end": "401330"
  },
  {
    "text": "and that cancels\nbeautifully and leaves me with the 1/2 of\nu_right plus u_left.",
    "start": "401330",
    "end": "408680"
  },
  {
    "text": "It tells me that the shock speed\nis exactly halfway between.",
    "start": "408680",
    "end": "414270"
  },
  {
    "text": "It's exactly the average,\nin this Burger's example, of the characteristic\nspeed from the right",
    "start": "414270",
    "end": "422420"
  },
  {
    "text": "and the characteristics\nspeed from the left. And notice, it's in between.",
    "start": "422420",
    "end": "427770"
  },
  {
    "text": "That's crucial. That tells us that\nthis figure is good. It tells us that characteristics\nare entering the shock",
    "start": "427770",
    "end": "437010"
  },
  {
    "text": "from both sides. Characteristic lines\nare entering the shock. The shock is somehow, in\nthis sort of nonlinear case,",
    "start": "437010",
    "end": "445460"
  },
  {
    "text": "it's somehow kind of cutting\nout bits of the solution,",
    "start": "445460",
    "end": "451069"
  },
  {
    "text": "reducing the energy,\nreducing the entropy, reducing the total variation\nas we'll see it in a minute.",
    "start": "451070",
    "end": "457830"
  },
  {
    "text": "So that's the answer here and\nI guess I have to justify, where did this come from?",
    "start": "457830",
    "end": "464880"
  },
  {
    "text": "Well, it came from\nthis integral form. ",
    "start": "464880",
    "end": "472210"
  },
  {
    "text": "Suppose I integrate\nfrom a little bit to the left of the\nshock to a little bit",
    "start": "472210",
    "end": "478117"
  },
  {
    "text": "to the right of the shock. Of course, that's where I\nwant to integrate in order to capture the shock.",
    "start": "478117",
    "end": "484540"
  },
  {
    "text": "OK, so if I just\ntake that equation and write it over here, and\nI'll imagine-- because I'm not",
    "start": "484540",
    "end": "492510"
  },
  {
    "text": "going to be-- x_left and x_right\nare going to be pretty near the shock-- u up to the\nshock will pretty much",
    "start": "492510",
    "end": "499590"
  },
  {
    "text": "have a constant value u_left. So approximately, that\nis the shock position.",
    "start": "499590",
    "end": "506960"
  },
  {
    "text": "Let me say the shock\nis at-- capital X is the position of the shock.",
    "start": "506960",
    "end": "512099"
  },
  {
    "text": "So I have x minus x_left times\nu on the left of the shock.",
    "start": "512100",
    "end": "522459"
  },
  {
    "text": " I'm doing that integral.",
    "start": "522460",
    "end": "527570"
  },
  {
    "text": "Oh, I need d by dt of all this. So d by dt. ",
    "start": "527570",
    "end": "535000"
  },
  {
    "text": "It's d by dt of the\nintegral of u dx. Let me just put here\nwhat I'm computing.",
    "start": "535000",
    "end": "541519"
  },
  {
    "text": "I'm computing that\nfrom x_left to x_right. Well, I'm going up\nto x, up to capital",
    "start": "541520",
    "end": "548560"
  },
  {
    "text": "X where the shock\nis, and then onward. So here I went up to x\nusing the value u left.",
    "start": "548560",
    "end": "555260"
  },
  {
    "text": "And now will be the\nonward part, which will be x_right minus x, the\nhalf of the interval that's",
    "start": "555260",
    "end": "565050"
  },
  {
    "text": "on the right of the\nshock, times u right. ",
    "start": "565050",
    "end": "570160"
  },
  {
    "text": "And then copying this term is\nexactly our jump in f of u.",
    "start": "570160",
    "end": "578430"
  },
  {
    "text": "Plus the jump in f of u is zero.",
    "start": "578430",
    "end": "586529"
  },
  {
    "text": " Those words, total variation\nare a reminder to myself",
    "start": "586530",
    "end": "593019"
  },
  {
    "text": "for what comes next. OK, so is that OK?",
    "start": "593020",
    "end": "598330"
  },
  {
    "text": "That will be approximately\nzero because u wasn't exactly",
    "start": "598330",
    "end": "603440"
  },
  {
    "text": "constant on the left and right. It didn't stay at the\nvalue u_L but we're",
    "start": "603440",
    "end": "609340"
  },
  {
    "text": "squeezing the\ninterval down where it's essentially constant. OK, so now, just look\nand see what we've got.",
    "start": "609340",
    "end": "620850"
  },
  {
    "text": "dx/dt is the shock speed, so\nthat's s, multiplying u_L,",
    "start": "620850",
    "end": "630990"
  },
  {
    "text": "and here I have-- the\nderivative of that is zero, the derivative of x_R is zero.",
    "start": "630990",
    "end": "637230"
  },
  {
    "text": "Here I have a minus,\nso it's minus u_R. ",
    "start": "637230",
    "end": "642540"
  },
  {
    "text": "dx/dt times that number plus the\njump in f of u, left to right,",
    "start": "642540",
    "end": "650320"
  },
  {
    "text": "is 0. And that's our equation. ",
    "start": "650320",
    "end": "657570"
  },
  {
    "text": "If I put this on\nthe opposite side it becomes u_right minus u_left.",
    "start": "657570",
    "end": "662709"
  },
  {
    "text": "Shall I do that? So I'll keep this on this\nside, got a good sign,",
    "start": "662710",
    "end": "669360"
  },
  {
    "text": "but I'll move this\nonto the other side so it will be the shock\nspeed, d capital X dt times",
    "start": "669360",
    "end": "676030"
  },
  {
    "text": "u_R minus u_L, which\nis the jump in u.",
    "start": "676030",
    "end": "682110"
  },
  {
    "text": "So that's great. We now have a way to deal\nwith shocks that collide.",
    "start": "682110",
    "end": "688420"
  },
  {
    "text": " So that was a derivation of\nthis jump condition, which first",
    "start": "688420",
    "end": "700690"
  },
  {
    "text": "had a name, two authors Rankine,\nHugoniot in gas dynamics, but then it was seen\nas the right condition",
    "start": "700690",
    "end": "708860"
  },
  {
    "text": "in all conservation laws. OK. And now I'm ready to\ncomment on the second issue.",
    "start": "708860",
    "end": "716630"
  },
  {
    "start": "710000",
    "end": "1115000"
  },
  {
    "text": "What do you do when\ncharacteristics separate? Well, let me say\nwhat you don't do.",
    "start": "716630",
    "end": "723220"
  },
  {
    "text": "You could, without\nwrecking the equation,",
    "start": "723220",
    "end": "728560"
  },
  {
    "text": "you could try to\nput a shock in there and give this the\nvalue u on the left,",
    "start": "728560",
    "end": "735680"
  },
  {
    "text": "even though a\ncharacteristic isn't telling us what's going on\nin this space or this one.",
    "start": "735680",
    "end": "742450"
  },
  {
    "text": "You could try to put\na shock in there. You could maybe satisfy\nthe jump condition if you put the right shock in,\nbut the characteristics would",
    "start": "742450",
    "end": "751740"
  },
  {
    "text": "be coming out and that's wrong. And it's called the\nentropy condition, which",
    "start": "751740",
    "end": "760400"
  },
  {
    "text": "says that this can't happen. That the derivative of\nentropy has a certain sign",
    "start": "760400",
    "end": "766390"
  },
  {
    "text": "and it rules this out. It rules out this possibility\nof characteristics",
    "start": "766390",
    "end": "772230"
  },
  {
    "text": "emerging from the shock and\nwe need a totally different solution. And it turns out to\nbe a fan in there.",
    "start": "772230",
    "end": "779050"
  },
  {
    "text": "So we put in a fan\nof characteristics",
    "start": "779050",
    "end": "784709"
  },
  {
    "text": "coming from here and that\ngives a solution that actually will depend on x over t.",
    "start": "784710",
    "end": "794490"
  },
  {
    "text": "This solution will be a\nsimple-- a simple ratio x over t",
    "start": "794490",
    "end": "803870"
  },
  {
    "text": "enters that.  In other words, that gives\nus a smooth solution,",
    "start": "803870",
    "end": "810910"
  },
  {
    "text": "and I guess, thinking about\nthe traffic example, that's exactly what happens. So this is the shock part.",
    "start": "810910",
    "end": "817650"
  },
  {
    "text": "Now for the fan\npart, what happens",
    "start": "817650",
    "end": "822850"
  },
  {
    "text": "when we have a bunch of cars\nsitting there, ready to go?",
    "start": "822850",
    "end": "828740"
  },
  {
    "text": "The light goes green, the\nfirst cars start moving,",
    "start": "828740",
    "end": "836430"
  },
  {
    "text": "cars behind them see the car in\nfront moving, they start moving",
    "start": "836430",
    "end": "842149"
  },
  {
    "text": "and so the initial profile\nwould be, in this case,",
    "start": "842150",
    "end": "851140"
  },
  {
    "text": "for cars, would be high\ndensity and then zero density.",
    "start": "851140",
    "end": "860180"
  },
  {
    "text": "So this would be maximum density\nsitting at the light and zero",
    "start": "860180",
    "end": "868800"
  },
  {
    "text": "density in front of the light\nand then the light goes green now and what happens?",
    "start": "868800",
    "end": "875180"
  },
  {
    "text": "Well, as we all know those\nfirst cars pull ahead and the profile is these cars\nhaven't yet started to move.",
    "start": "875180",
    "end": "887670"
  },
  {
    "text": "These have started to\nmove and there's a profile there and then zero density.",
    "start": "887670",
    "end": "896160"
  },
  {
    "text": "So this represents the\nfirst car, the lead car. In front of that car is zero\ndensity and that's the fan.",
    "start": "896160",
    "end": "908899"
  },
  {
    "text": "That's the x over t expression.",
    "start": "908900",
    "end": "914600"
  },
  {
    "text": "So a simple linear expression,\nwhich will flatten out;",
    "start": "914600",
    "end": "919880"
  },
  {
    "text": "as time goes on, these cars\nwill be going faster and faster and then eventually\nup to full speed.",
    "start": "919880",
    "end": "928440"
  },
  {
    "text": "OK, so that's the fan. ",
    "start": "928440",
    "end": "934950"
  },
  {
    "text": "Maybe now is my chance to\nspeak about this concept",
    "start": "934950",
    "end": "941060"
  },
  {
    "text": "of the variation in a function. The idea will be now, how do\nwe get the finite difference",
    "start": "941060",
    "end": "949790"
  },
  {
    "text": "method to do this automatically? Well, OK, one way to do it\nis put in a little viscosity.",
    "start": "949790",
    "end": "960180"
  },
  {
    "text": " This rule, the rule that picks\nout this shock in one case,",
    "start": "960180",
    "end": "970180"
  },
  {
    "text": "of colliding\ncharacteristics, and this fan",
    "start": "970180",
    "end": "977810"
  },
  {
    "text": "in the case of separating\ncharacteristics, one way to get to those\ntwo solution would",
    "start": "977810",
    "end": "985520"
  },
  {
    "text": "be to put in a little\nbit of viscosity",
    "start": "985520",
    "end": "992560"
  },
  {
    "text": "and then let epsilon go to zero. And the result would\nbe these two solutions.",
    "start": "992560",
    "end": "1002070"
  },
  {
    "text": "And in a way, that's what finite\ndifferences is going to do. Finite difference\nor finite volume",
    "start": "1002070",
    "end": "1007760"
  },
  {
    "text": "is going to be a\nnumerical viscosity and the epsilon in\nthe Burgers' equation",
    "start": "1007760",
    "end": "1018400"
  },
  {
    "text": "would become delta t or a delta\nx in the numerical method,",
    "start": "1018400",
    "end": "1025844"
  },
  {
    "text": "in the finite\ndifference equation.  And then what's the concept?",
    "start": "1025844",
    "end": "1032600"
  },
  {
    "text": "So we have to find\nfinite differences. And we want those-- the\npoint is finite differences",
    "start": "1032600",
    "end": "1045100"
  },
  {
    "text": "sort of takes more care. We can't just create\nsomething that's",
    "start": "1045100",
    "end": "1051310"
  },
  {
    "text": "consistent in the smooth case. Up till now we've just\nhad no hesitation.",
    "start": "1051310",
    "end": "1060210"
  },
  {
    "text": "We replaced derivatives\nby differences without too many\nworries, really.",
    "start": "1060210",
    "end": "1066270"
  },
  {
    "text": " And that was fine as long\nas the solution is smooth.",
    "start": "1066270",
    "end": "1071500"
  },
  {
    "text": "But now if we're going\nto replace derivatives by differences, we have\nto do it in such a way",
    "start": "1071500",
    "end": "1079370"
  },
  {
    "text": "that this entropy\ncondition, these solutions",
    "start": "1079370",
    "end": "1085400"
  },
  {
    "text": "emerge automatically. And really, in a way that--\nour finite difference",
    "start": "1085400",
    "end": "1095420"
  },
  {
    "text": "or our finite volume\nmethods should somehow conserve mass the same way\nthe true equation does.",
    "start": "1095420",
    "end": "1104100"
  },
  {
    "text": "So those are two\ndifferent points. First point is this\nquestion of total variation.",
    "start": "1104100",
    "end": "1111720"
  },
  {
    "text": "What's the total\nvariation in a function?  Well, let me draw a function.",
    "start": "1111720",
    "end": "1121220"
  },
  {
    "start": "1115000",
    "end": "1420000"
  },
  {
    "text": "The total variation\nis-- well, let me see. Total variation in a\nfunction u is going to be,",
    "start": "1121220",
    "end": "1130480"
  },
  {
    "text": "by definition, the integral of\nthe absolute value of du/dx.",
    "start": "1130480",
    "end": "1137130"
  },
  {
    "start": "1137130",
    "end": "1143180"
  },
  {
    "text": "OK now we have to\nunderstand this concept.",
    "start": "1143180",
    "end": "1149060"
  },
  {
    "text": "It's beautiful that the analysis\nhas led to a quantity as simple",
    "start": "1149060",
    "end": "1161350"
  },
  {
    "text": "as that, as a guide. So when we create finite\ndifference methods we will ask,",
    "start": "1161350",
    "end": "1171250"
  },
  {
    "text": "are they total\nvariation diminishing?",
    "start": "1171250",
    "end": "1176260"
  },
  {
    "text": "So TVD will be total\nvariation diminishing methods.",
    "start": "1176260",
    "end": "1182060"
  },
  {
    "text": "Methods where this quantity\ndoes not increase in time. ",
    "start": "1182060",
    "end": "1189179"
  },
  {
    "text": "Let me just understand\nthis quantity first. The absolute value is crucial. If the absolute\nvalue was not there,",
    "start": "1189180",
    "end": "1197549"
  },
  {
    "text": "then I would just have the\nintegral of the derivative, so it would be u at that\npoint minus u at that.",
    "start": "1197550",
    "end": "1206250"
  },
  {
    "text": "But here I'm taking absolute\nvalues, so for a while the derivative is\npositive, up to there.",
    "start": "1206250",
    "end": "1214220"
  },
  {
    "text": "So the integral gives me\nthis value minus this. ",
    "start": "1214220",
    "end": "1219840"
  },
  {
    "text": "Then, in this region, the\nderivative is negative, but I'm taking absolute value.",
    "start": "1219840",
    "end": "1226560"
  },
  {
    "text": "Do you see that that\nintegral will split into four separate integrals?",
    "start": "1226560",
    "end": "1232179"
  },
  {
    "text": "The total variation will be this\ndifference plus this difference plus this plus this.",
    "start": "1232180",
    "end": "1239350"
  },
  {
    "text": "I'll have four--\nin this example-- have four positive\ncontributions to the variation.",
    "start": "1239350",
    "end": "1246960"
  },
  {
    "text": " And that's the key\nquantity there.",
    "start": "1246960",
    "end": "1254100"
  },
  {
    "text": "And what a shock\nwill do-- can I maybe mention in this figure what\na shock does, can do, would",
    "start": "1254100",
    "end": "1263630"
  },
  {
    "text": "be to somehow cut out\npart of the variation.",
    "start": "1263630",
    "end": "1270970"
  },
  {
    "text": "When a shock occurs it might\nhappen that these things are going into the shock,\nthese are going",
    "start": "1270970",
    "end": "1277409"
  },
  {
    "text": "in from that side, and\nthe shock kind of jumps",
    "start": "1277410",
    "end": "1283310"
  },
  {
    "text": "from this value, u_left,\nto this value, u_right,",
    "start": "1283310",
    "end": "1288710"
  },
  {
    "text": "following the shock\ncondition when it emerges. And this additional\nvariation is wiped out.",
    "start": "1288710",
    "end": "1297030"
  },
  {
    "text": "You see that the variation\nfor the solution that",
    "start": "1297030",
    "end": "1303020"
  },
  {
    "text": "contains a shock is still--\nthis part is still there, but this part is all\ndownhill, so it's just this.",
    "start": "1303020",
    "end": "1310150"
  },
  {
    "text": " It's that minus that. And the middle two\nparts have been cut out.",
    "start": "1310150",
    "end": "1318350"
  },
  {
    "text": "OK, so that's the total\nvariation in a function. Let me just take the\nmost important example",
    "start": "1318350",
    "end": "1326559"
  },
  {
    "text": "that's not total variation\ndiminishing, which is Lax-Wendroff. ",
    "start": "1326560",
    "end": "1332720"
  },
  {
    "text": "The one-- even in\nthe linear case. ",
    "start": "1332720",
    "end": "1341330"
  },
  {
    "text": "The one experiment we've done\nwith that profile, where,",
    "start": "1341330",
    "end": "1347399"
  },
  {
    "text": "you remember, we had a wall of\nwater and the exact solution",
    "start": "1347400",
    "end": "1354220"
  },
  {
    "text": "brought the wall to the left\nwith velocity c, with speed c,",
    "start": "1354220",
    "end": "1359820"
  },
  {
    "text": "but Lax-Wendroff,\nwhich did quite well staying near the\ndiscontinuity, near the jump,",
    "start": "1359820",
    "end": "1373410"
  },
  {
    "text": "had a little oscillation behind.",
    "start": "1373410",
    "end": "1380970"
  },
  {
    "text": "That was essentially our one\nobjection to Lax-Wendroff, was that oscillation showing up.",
    "start": "1380970",
    "end": "1389900"
  },
  {
    "text": "And so that's telling us\nthat the variation-- see,",
    "start": "1389900",
    "end": "1394970"
  },
  {
    "text": "the variation in the true\nsolution is just that step.",
    "start": "1394970",
    "end": "1400549"
  },
  {
    "text": "The variation in the\nLax-Wendroff answer is this bigger\nstep plus this one",
    "start": "1400550",
    "end": "1408540"
  },
  {
    "text": "plus this one plus\nthis, larger than 1. ",
    "start": "1408540",
    "end": "1416010"
  },
  {
    "text": "Roughly the match is that\nmonotone methods-- so here's",
    "start": "1416010",
    "end": "1425000"
  },
  {
    "start": "1420000",
    "end": "1606000"
  },
  {
    "text": "the general picture. We can get monotone, or I'll\nsay, all positive coefficients,",
    "start": "1425000",
    "end": "1437730"
  },
  {
    "text": "and those will be total\nvariation diminishing. Great.",
    "start": "1437730",
    "end": "1444460"
  },
  {
    "text": "Why don't I draw--\nrecall a monotone example was Lax-Friedrichs or upwind.",
    "start": "1444460",
    "end": "1452650"
  },
  {
    "text": "Upwind will be our model, so\nlet me draw the upwind one. The upwind one didn't increase\nthe variation, it stayed at 1.",
    "start": "1452650",
    "end": "1464830"
  },
  {
    "text": "We had no oscillations,\nbut it was low accuracy.",
    "start": "1464830",
    "end": "1471630"
  },
  {
    "text": "So first order. ",
    "start": "1471630",
    "end": "1478440"
  },
  {
    "text": "We can't do better than\nfirst-order accuracy, the order",
    "start": "1478440",
    "end": "1485355"
  },
  {
    "text": "of accuracy I'm measuring in\nthe smooth part of the solution",
    "start": "1485355",
    "end": "1490860"
  },
  {
    "text": "because that's where I can take\nTaylor series and match terms and see which is the first\none that doesn't match.",
    "start": "1490860",
    "end": "1498730"
  },
  {
    "text": "And Lax-Friedrichs and\nupwind was first order.",
    "start": "1498730",
    "end": "1505950"
  },
  {
    "text": "Then our problem is that if I\nallow a negative coefficient",
    "start": "1505950",
    "end": "1522539"
  },
  {
    "text": "then variation increases,\noscillations will come in,",
    "start": "1522540",
    "end": "1532080"
  },
  {
    "text": "but I can get the accuracy\nup to second order or higher.",
    "start": "1532080",
    "end": "1537730"
  },
  {
    "text": " And Lax-Wendroff is the\nexample, the key example",
    "start": "1537730",
    "end": "1546130"
  },
  {
    "text": "there that I'll continue with. OK, that's the idea\nof total variation.",
    "start": "1546130",
    "end": "1553779"
  },
  {
    "text": "It just gives us\na quantity to work",
    "start": "1553780",
    "end": "1559650"
  },
  {
    "text": "with when we see oscillation.",
    "start": "1559650",
    "end": "1567040"
  },
  {
    "text": "And of course, I'm\ninterested in oscillations, so this is a linear case\nwith a discontinuity.",
    "start": "1567040",
    "end": "1574920"
  },
  {
    "text": "I don't think it's quite\nfair to call it a shock. At least, the\nshocks that we meet",
    "start": "1574920",
    "end": "1581500"
  },
  {
    "text": "in conservation laws in\nthe nonlinear problems, they're created--\nthe ones we saw here",
    "start": "1581500",
    "end": "1588130"
  },
  {
    "text": "are created for nonlinear\nreasons, colliding",
    "start": "1588130",
    "end": "1594970"
  },
  {
    "text": "characteristics, whereas the\nlinear case has characteristics all parallel. ",
    "start": "1594970",
    "end": "1602929"
  },
  {
    "text": "So here, we're in\nthe lecture, we're really into the second lecture\ninto the scientific computing",
    "start": "1602930",
    "end": "1612460"
  },
  {
    "text": "part of our problem. So that's the analysis\npart, the PDE part.",
    "start": "1612460",
    "end": "1618930"
  },
  {
    "text": "Now comes the experience of\nquite a lot of people working",
    "start": "1618930",
    "end": "1628380"
  },
  {
    "text": "hard to identify a way to get\nsecond-order accuracy where",
    "start": "1628380",
    "end": "1637640"
  },
  {
    "text": "it's smooth and monotonicity\nor something like it",
    "start": "1637640",
    "end": "1645220"
  },
  {
    "text": "where the shocks are. So that's essentially the goal.",
    "start": "1645220",
    "end": "1652640"
  },
  {
    "text": "Our method is going to\nturn out to be nonlinear. It's going to have some--\nit'll be called a flux limiter.",
    "start": "1652640",
    "end": "1662510"
  },
  {
    "text": "The key quantity\nwill be the flux.",
    "start": "1662510",
    "end": "1667680"
  },
  {
    "text": "And for a smooth function\nwhen u_right and u_left are",
    "start": "1667680",
    "end": "1676940"
  },
  {
    "text": "very close, the flux is small,\nwe don't have a problem.",
    "start": "1676940",
    "end": "1682000"
  },
  {
    "text": "But at a shock where there's\na significant jump in u and especially in f\nof u, the flux limiter",
    "start": "1682000",
    "end": "1694250"
  },
  {
    "text": "is going to come in,\ninto the discrete method.",
    "start": "1694250",
    "end": "1700160"
  },
  {
    "start": "1700000",
    "end": "1960000"
  },
  {
    "text": "Let me begin discrete\nmethods with a new word, finite volumes. ",
    "start": "1700160",
    "end": "1707650"
  },
  {
    "text": "And with a new\ninterpretation of capital U.",
    "start": "1707650",
    "end": "1714320"
  },
  {
    "text": "So the discrete value,\ncapital U_(j, n), which,",
    "start": "1714320",
    "end": "1720950"
  },
  {
    "text": "up to now we've been thinking\nof as that's an approximation to the true solution,\nat j delta x, n delta t.",
    "start": "1720950",
    "end": "1728860"
  },
  {
    "text": "Now, because we're dealing\nwith discontinuities, we better integrate.",
    "start": "1728860",
    "end": "1734060"
  },
  {
    "text": "We integrate over\na delta x interval. We take the average over\na little delta x interval",
    "start": "1734060",
    "end": "1741130"
  },
  {
    "text": "instead of hitting\njust the point. So the delta x interval from\nj minus 1/2 to j plus 1/2,",
    "start": "1741130",
    "end": "1748270"
  },
  {
    "text": "we take the average of\nu at the time n delta t",
    "start": "1748270",
    "end": "1753340"
  },
  {
    "text": "and that's what finite volume--\nand let's think of as capital",
    "start": "1753340",
    "end": "1763669"
  },
  {
    "text": "U, the discrete approximation. The appropriateness of that\nis in the integral form",
    "start": "1763670",
    "end": "1771940"
  },
  {
    "text": "of the conservation law. So the integral form\nof a conservation law leads us to that natural\ndiscretization, d by dt of U,",
    "start": "1771940",
    "end": "1789669"
  },
  {
    "text": "of the average. You're keeping your eye\non the integral form",
    "start": "1789670",
    "end": "1795750"
  },
  {
    "text": "of the conservation law. I'll just come back to it again. The derivative of the\nmass, the integral",
    "start": "1795750",
    "end": "1804280"
  },
  {
    "text": "of u-- so in the discrete case,\nthe difference of capital U--",
    "start": "1804280",
    "end": "1810430"
  },
  {
    "text": "plus the integrated\nterm of flux at one end",
    "start": "1810430",
    "end": "1815560"
  },
  {
    "text": "of the interval minus a\nflux at the other end. And notice that we are\ngetting for the flux, half--",
    "start": "1815560",
    "end": "1822410"
  },
  {
    "text": "so a staggered grid is\npresenting itself naturally.",
    "start": "1822410",
    "end": "1832320"
  },
  {
    "text": "And so that\nf_(j+1/2), the fluxes, which is the critical thing,\nis on the j plus 1/2 grid.",
    "start": "1832320",
    "end": "1841130"
  },
  {
    "text": "All right, now this\ncould be exactly defined as the flux at that grid point.",
    "start": "1841130",
    "end": "1852200"
  },
  {
    "text": "Capital U squared over 2\nin the Burger equation, at that grid point.",
    "start": "1852200",
    "end": "1858550"
  },
  {
    "text": "That would give us a totally\nstraightforward, first-order",
    "start": "1858550",
    "end": "1864560"
  },
  {
    "text": "numerical method. First order, I see\nfirst order here in time and it might be better\nthan that in space",
    "start": "1864560",
    "end": "1871549"
  },
  {
    "text": "because in some way\nthat's centered.  But if we want higher\naccuracy, if we",
    "start": "1871550",
    "end": "1879450"
  },
  {
    "text": "want to include\nLax-Wendroff, for example, that includes\nseveral values of u,",
    "start": "1879450",
    "end": "1886529"
  },
  {
    "text": "we go to a more\ngeneral flux function. ",
    "start": "1886530",
    "end": "1894670"
  },
  {
    "text": "The whole job here is create\na smart flux function. So a flux function depends not\nonly on u in the center, u_j,",
    "start": "1894670",
    "end": "1908790"
  },
  {
    "text": "at time n-- this\nis all at time n-- it can also depend on\nvalues to the left of it",
    "start": "1908790",
    "end": "1916350"
  },
  {
    "text": "and values to the right.  It may use those\nvalues, it may not,",
    "start": "1916350",
    "end": "1922970"
  },
  {
    "text": "but we allow that\npossibility then, that the flux-- so this\nis the numerical method",
    "start": "1922970",
    "end": "1928900"
  },
  {
    "text": "that you aim for. Is to choose a flux\nfunction and of course,",
    "start": "1928900",
    "end": "1936210"
  },
  {
    "text": "this should be consistent\nwith the original problem and that simply says that if\nall the u's were the same,",
    "start": "1936210",
    "end": "1946180"
  },
  {
    "text": "that the numerical flux\nfunction would give you the flux",
    "start": "1946180",
    "end": "1952159"
  },
  {
    "text": "function in the given equation.  OK, so this is our\ngeneral pattern.",
    "start": "1952159",
    "end": "1959750"
  },
  {
    "text": "And now, the question is\nreally, maybe the first step is write a-- I would like to\nwrite upwind and Lax-Wendroff--",
    "start": "1959750",
    "end": "1980900"
  },
  {
    "text": "I'd like to find\ntheir flux functions. I guess I'm saying\nthat when we look",
    "start": "1980900",
    "end": "1986710"
  },
  {
    "text": "at an equation in\nthis format, we",
    "start": "1986710",
    "end": "1994630"
  },
  {
    "text": "can take methods that\nwe have already used and see, OK, even in the\nlinear case, the one-way wave",
    "start": "1994630",
    "end": "2002000"
  },
  {
    "text": "equation, what are we picking\nfor the flux function? OK, now the one distinction\nis: the one-way wave equation,",
    "start": "2002000",
    "end": "2012169"
  },
  {
    "text": "we had a constant, and\nupwind, for example,",
    "start": "2012170",
    "end": "2018150"
  },
  {
    "text": "went in the direction\ndecided by that speed, c.",
    "start": "2018150",
    "end": "2024070"
  },
  {
    "text": "If the speed reversed sign\nso that the waves were going",
    "start": "2024070",
    "end": "2029350"
  },
  {
    "text": "the other way, the wind\nis coming the other way, the upwind direction\nis the other way,",
    "start": "2029350",
    "end": "2035360"
  },
  {
    "text": "so our method would change. ",
    "start": "2035360",
    "end": "2042770"
  },
  {
    "text": "Let me just write\ndown the flux function that turns out to\ncome for upwind",
    "start": "2042770",
    "end": "2052210"
  },
  {
    "text": "and then for Lax-Wendroff. OK, so for upwind the\nflux turns out to be--",
    "start": "2052210",
    "end": "2058120"
  },
  {
    "text": "F turns out to be 1/2\nof-- because it's at this,",
    "start": "2058120",
    "end": "2064730"
  },
  {
    "text": "this is f_(j+1/2), really. ",
    "start": "2064730",
    "end": "2073460"
  },
  {
    "text": "It's at the center point. The flux function will be--\nI'll put in the a-- a delta t--",
    "start": "2073460",
    "end": "2084000"
  },
  {
    "text": "sorry, a over 2 U_(j+1)\nplus U_j, now, plus--",
    "start": "2084000",
    "end": "2092620"
  },
  {
    "text": "or rather minus actually--\ncomes absolute value of a over 2",
    "start": "2092620",
    "end": "2105290"
  },
  {
    "text": "times u_(j+1) minus u_j. ",
    "start": "2105290",
    "end": "2112510"
  },
  {
    "text": "If we're patient we can track\ndown the two cases, a positive",
    "start": "2112510",
    "end": "2119660"
  },
  {
    "text": "and a negative, and recognize\nthat this form switches",
    "start": "2119660",
    "end": "2128770"
  },
  {
    "text": "direction correctly on\nthe difference method.",
    "start": "2128770",
    "end": "2135160"
  },
  {
    "text": "So it keeps us upwind,\nin other words. If the wind changes\ndirection our flux changes appropriately to\nfollow that direction.",
    "start": "2135160",
    "end": "2144390"
  },
  {
    "text": "So that's an OK flux function. It's a monotone one\nand it's first order.",
    "start": "2144390",
    "end": "2157480"
  },
  {
    "text": "Now let me put in Lax-Wendroff. What would Lax-Wendroff be? Would be the same, the same\nupwind flux, if I call that UP",
    "start": "2157480",
    "end": "2168790"
  },
  {
    "text": "for upwind and\nthen a correction, a Lax-Wendroff term that gets\nthe second-order accuracy.",
    "start": "2168790",
    "end": "2179670"
  },
  {
    "text": "OK, and that turns out to be--\nit turns out that I multiply",
    "start": "2179670",
    "end": "2186730"
  },
  {
    "text": "this term by that ratio r.",
    "start": "2186730",
    "end": "2192780"
  },
  {
    "text": "By the absolute value of r. So it turns out that it's--\nthe Lax-Wendroff thing,",
    "start": "2192780",
    "end": "2199700"
  },
  {
    "text": "to get that extra accuracy,\nyou might remember, had an extra delta\nt over delta x.",
    "start": "2199700",
    "end": "2205200"
  },
  {
    "text": "And so it's this same\nthing times a over 2.",
    "start": "2205200",
    "end": "2211150"
  },
  {
    "text": "In the nonlinear case\nit'll be f of u_(j+1). ",
    "start": "2211150",
    "end": "2219050"
  },
  {
    "text": "f at u_(j+1) minus f at u_j. ",
    "start": "2219050",
    "end": "2230089"
  },
  {
    "text": "Next time, I'll come\nback to this point",
    "start": "2230090",
    "end": "2236640"
  },
  {
    "text": "and pin down this\nmore carefully.",
    "start": "2236640",
    "end": "2244039"
  },
  {
    "text": "All I want to do\nin completing today is introduce this idea\nof a flux limiter.",
    "start": "2244040",
    "end": "2255210"
  },
  {
    "text": "So what people say when\nthey look at Lax-Wendroff",
    "start": "2255210",
    "end": "2262920"
  },
  {
    "text": "is that this term\nthat's been added on",
    "start": "2262920",
    "end": "2269010"
  },
  {
    "text": "is fine in the case\nof a smooth solution, but in that case of a\njump, like our picture",
    "start": "2269010",
    "end": "2279320"
  },
  {
    "text": "here, that term is\nincreasing variation.",
    "start": "2279320",
    "end": "2287030"
  },
  {
    "text": "It's an anti-diffusion term. Instead of smoothing things\nout the way F upwind does,",
    "start": "2287030",
    "end": "2294390"
  },
  {
    "text": "that extra term has the\neffect of increasing the jump.",
    "start": "2294390",
    "end": "2301829"
  },
  {
    "text": "It's anti-diffusive. And therefore, when\nit's a significant term,",
    "start": "2301830",
    "end": "2311500"
  },
  {
    "text": "the flux limiter\ncuts back on it.",
    "start": "2311500",
    "end": "2319120"
  },
  {
    "text": "The result will be\na numerical method, which is not linear\nanymore even if we apply it to a linear problem.",
    "start": "2319120",
    "end": "2325300"
  },
  {
    "text": "The result won't\nbe strictly linear and it will produce\na profile that",
    "start": "2325300",
    "end": "2334400"
  },
  {
    "text": "doesn't have that oscillation. So it has what we want.",
    "start": "2334400",
    "end": "2340630"
  },
  {
    "text": "It gives us good answers\nwhen the solution is smooth, it stays near the shock\nthe way Lax-Wendroff does,",
    "start": "2340630",
    "end": "2348819"
  },
  {
    "text": "but it doesn't oscillate. OK, so what's the flux limiter?",
    "start": "2348820",
    "end": "2355550"
  },
  {
    "text": "The flux limiter is, I multiply\nin here by some function, the limiter function, phi_(j+1)\nand I multiply in here",
    "start": "2355550",
    "end": "2366590"
  },
  {
    "text": "by phi_j. In other words, there's\nan extra factor,",
    "start": "2366590",
    "end": "2373050"
  },
  {
    "text": "this flux limiting factor. So the question is,\nhow to construct that?",
    "start": "2373050",
    "end": "2380090"
  },
  {
    "text": "What formula do we use\nfor the flux limiter? So the flux limiter,\nafter lot of experiments",
    "start": "2380090",
    "end": "2389160"
  },
  {
    "text": "is chosen to depend on--\nso we want it to be 1.",
    "start": "2389160",
    "end": "2400539"
  },
  {
    "text": "So what do we want? We want it to be 1 or\nclose to 1 at smooth part",
    "start": "2400540",
    "end": "2410380"
  },
  {
    "text": "and we want it to be greater\nthan 1 at a discontinuity.",
    "start": "2410380",
    "end": "2417480"
  },
  {
    "text": " OK, so our question\nis, how do you",
    "start": "2417480",
    "end": "2423030"
  },
  {
    "text": "identify that discontinuity? Well, the convenient\nway has turned out",
    "start": "2423030",
    "end": "2429849"
  },
  {
    "text": "to be look at the ratio--\nlook at differences.",
    "start": "2429850",
    "end": "2435980"
  },
  {
    "text": "Look at the ratio of--\nso what comes in here will be the ratio\nr, say, j plus 1/2.",
    "start": "2435980",
    "end": "2446160"
  },
  {
    "text": "That'll be the ratio of U,\nsay j plus 2 minus U_(j+1) 1",
    "start": "2446160",
    "end": "2453609"
  },
  {
    "text": "to U_(j+1) minus U_j. All at time n.",
    "start": "2453610",
    "end": "2460910"
  },
  {
    "text": "That ratio tells us--\nthat ratio is close to 1, if-- so the ratio r is close to\n1 for smooth and our function,",
    "start": "2460910",
    "end": "2476870"
  },
  {
    "text": "phi of r then, we want our\nfunction phi, when the ratio is",
    "start": "2476870",
    "end": "2483620"
  },
  {
    "text": "1, to give the value 1. So if I try to draw\na graph of-- let",
    "start": "2483620",
    "end": "2489269"
  },
  {
    "text": "me draw a graph of people's flux\nfunctions-- of the phi of r.",
    "start": "2489270",
    "end": "2503960"
  },
  {
    "text": "So here's a graph of phi of r. First on the graph I'll\nput upwind and Lax-Wendroff",
    "start": "2503960",
    "end": "2510230"
  },
  {
    "text": "without anything. So Lax-Wendroff would take-- phi\nLax-Wendroff is identically 1.",
    "start": "2510230",
    "end": "2519640"
  },
  {
    "text": "This is the ratio\nr and this is phi. ",
    "start": "2519640",
    "end": "2526490"
  },
  {
    "text": "So Lax-Wendroff, before fixing,\nhad no flux limiter function",
    "start": "2526490",
    "end": "2535250"
  },
  {
    "text": "and it just had 1. And actually, if I can\nkeep the same formula,",
    "start": "2535250",
    "end": "2542680"
  },
  {
    "text": "phi_upwind would just be zero. Then it'll turn out that--\nlet me draw these ratios.",
    "start": "2542680",
    "end": "2554279"
  },
  {
    "text": "There is a region here and\nhere where the flux limiter",
    "start": "2554280",
    "end": "2565750"
  },
  {
    "text": "is doing the right thing. So in that region it's\nacting the right way.",
    "start": "2565750",
    "end": "2573710"
  },
  {
    "text": "It's limiting the\nanti-diffusive flux. It's controlling the variation.",
    "start": "2573710",
    "end": "2579670"
  },
  {
    "text": "It's controlling\nthe oscillation. So various people have\nproposed-- let's see.",
    "start": "2579670",
    "end": "2591020"
  },
  {
    "text": "No, I haven't got this right. ",
    "start": "2591020",
    "end": "2596180"
  },
  {
    "text": "I think it's-- because I\nknow that part is wrong for Lax-Wendroff.",
    "start": "2596180",
    "end": "2601290"
  },
  {
    "text": "So maybe it's there.  No, I've forgotten--\nsorry that I'm",
    "start": "2601290",
    "end": "2608790"
  },
  {
    "text": "not-- I've lost this because\nI know that one possibility is",
    "start": "2608790",
    "end": "2621210"
  },
  {
    "text": "this as the flux limiter. One possibility\nwould be this one",
    "start": "2621210",
    "end": "2628850"
  },
  {
    "text": "and then there's\nanother possibility that is OK that goes through here.",
    "start": "2628850",
    "end": "2634440"
  },
  {
    "start": "2634440",
    "end": "2639950"
  },
  {
    "text": "Let me stop for today with\nthis idea of a flux limiter",
    "start": "2639950",
    "end": "2646770"
  },
  {
    "text": "and you see that it's a\ntask to fix the method",
    "start": "2646770",
    "end": "2652380"
  },
  {
    "text": "to do the right\nthing at smooth parts and also the right thing\nat discontinuities.",
    "start": "2652380",
    "end": "2658089"
  },
  {
    "text": "OK, I'll pick up\non that next time. Thanks. ",
    "start": "2658090",
    "end": "2669290"
  }
]