[
  {
    "start": "0",
    "end": "22000"
  },
  {
    "text": " The following content is\nprovided under a Creative Commons license.",
    "start": "0",
    "end": "5300"
  },
  {
    "text": "Your support will help\nMIT OpenCourseWare continue to offer high quality\neducational resources for free.",
    "start": "5300",
    "end": "11600"
  },
  {
    "text": "To make a donation or to\nview additional materials from hundreds of MIT courses,\nvisit MIT OpenCourseWare",
    "start": "11600",
    "end": "18100"
  },
  {
    "text": "at ocw.mit.edu. ",
    "start": "18100",
    "end": "23490"
  },
  {
    "start": "22000",
    "end": "300000"
  },
  {
    "text": "WILLIAM GREEN: So welcome to\nour special class with half the people gone for\ntonight's hearing.",
    "start": "23490",
    "end": "29550"
  },
  {
    "text": "You guys are the chosen few,\nso I'm pleased you're here. AUDIENCE: [INTERPOSING VOICES]",
    "start": "29550",
    "end": "38814"
  },
  {
    "text": "WILLIAM GREEN: So I'm just\ngoing to say a little bit about models versus\ndata and then I'm going to go back to\nundervalue problems and talk",
    "start": "38814",
    "end": "47913"
  },
  {
    "text": "a little bit about how you\nhandle really big ones. Yeah? AUDIENCE: Are these\ngoing to be [INAUDIBLE].. WILLIAM GREEN: Yeah.",
    "start": "47913",
    "end": "54990"
  },
  {
    "text": "Yes, sir. AUDIENCE: All right. WILLIAM GREEN:\nAnd in fact, these are even going to\nbe on the video, because the guy just\nthis fixed the video, so it will be recorded.",
    "start": "54990",
    "end": "60738"
  },
  {
    "text": " All right. Yeah, I'm sorry.",
    "start": "60738",
    "end": "66200"
  },
  {
    "text": "You said the video\nwas broken last time so that recording didn't work. ",
    "start": "66200",
    "end": "71869"
  },
  {
    "text": "All right. So when we're talking\nabout models versus data",
    "start": "71870",
    "end": "77794"
  },
  {
    "text": "a really critical question\nis whether the model is really consistent\nwith the data or not.",
    "start": "77794",
    "end": "83260"
  },
  {
    "text": "And how do we know\nthis is really true?",
    "start": "83260",
    "end": "89280"
  },
  {
    "text": "So we talked about\nhow we can figure out",
    "start": "89280",
    "end": "95890"
  },
  {
    "text": "some sort of chi-squared\nmaximum that we would tolerate. So the maximum that\nwe tolerate, we",
    "start": "95890",
    "end": "101410"
  },
  {
    "text": "call it Q, capital Q\nin a lecture before. And so if we can find a\nchi-squared of theta that's",
    "start": "101410",
    "end": "111690"
  },
  {
    "text": "less than this, then\nit's at least plausible that our model is true.",
    "start": "111690",
    "end": "116740"
  },
  {
    "text": "Right? Or, alternatively, if\nall chi-squared thetas",
    "start": "116740",
    "end": "123290"
  },
  {
    "text": "for any value of thetas are\ngreater than chi-squared max, then we would say\nthe model is false,",
    "start": "123290",
    "end": "130190"
  },
  {
    "text": "or something else is really\nwrong with our experiment. Right?",
    "start": "130190",
    "end": "135291"
  },
  {
    "text": "That's what we say\nwhen we're saying we have a maximum chi-squared\nthat we would tolerate.",
    "start": "135291",
    "end": "140989"
  },
  {
    "text": "So a critical\nquestion with us is whether we really\nfound the very best fit",
    "start": "140990",
    "end": "147620"
  },
  {
    "text": "value of the parameters.",
    "start": "147620",
    "end": "153799"
  },
  {
    "text": "In some simple problems you\nmight have linear dependence on the parameters, and\nthen there's only one",
    "start": "153800",
    "end": "161930"
  },
  {
    "text": "best fit usually,\nas Long as you have a non-singular set of\nequations and everything",
    "start": "161930",
    "end": "167330"
  },
  {
    "text": "we find there's no trouble. However, more commonly\nyou have equations which are singular\nor close to singular,",
    "start": "167330",
    "end": "174560"
  },
  {
    "text": "and also you normally\nhave non-linear dependence between the model predictions\nand the parameters.",
    "start": "174560",
    "end": "181710"
  },
  {
    "text": "So, for example, I do kinetics. We always care about the ray\ncoefficients, the K's and they",
    "start": "181710",
    "end": "186920"
  },
  {
    "text": "always come in inside a\ndifferential equation. Right? You always have like\nd concentrations",
    "start": "186920",
    "end": "192005"
  },
  {
    "text": "dt is equal to some\nterms, and some of them are, you know, k concentration\nI times concentration j.",
    "start": "192005",
    "end": "201100"
  },
  {
    "text": "whatever one it is, ij. Right? You have a lot of like terms\nlike this by molecular reaction terms.",
    "start": "201100",
    "end": "206670"
  },
  {
    "text": "And these K's, some\nof them I don't know. And so these would\nbe one of my thetas.",
    "start": "206670",
    "end": "213230"
  },
  {
    "text": "So this would be,\nyou know, theta 17 would be one of these K's\nthat I want to determine.",
    "start": "213230",
    "end": "218350"
  },
  {
    "text": "And when I have a differential\nequation like this, when I integrate\nit, the K is always",
    "start": "218350",
    "end": "223690"
  },
  {
    "text": "going to come in\nnon-linearly in the solution. Right? So when I integrate\nthis solution,",
    "start": "223690",
    "end": "229900"
  },
  {
    "text": "even in the simplest case\nyou get things like c of t is equal to ae to\nthe negative kt.",
    "start": "229900",
    "end": "237480"
  },
  {
    "text": "That might be a really\nsuper simple case if you have a linear kinetics. The K is still coming\nin non-linearly",
    "start": "237480",
    "end": "244570"
  },
  {
    "text": "to the predictions. Right? And if you have\nanything complicated you can't even write it down\nin a closed form expression,",
    "start": "244570",
    "end": "251530"
  },
  {
    "text": "and you have to integrate\nwith oed45 or ode15s",
    "start": "251530",
    "end": "257200"
  },
  {
    "text": "and so the\nrelationship between K and the concentrations\nthat you measure can be really complicated.",
    "start": "257200",
    "end": "263467"
  },
  {
    "text": "So it's always non-linear. In my world all the\nmodels are non-linear.",
    "start": "263467",
    "end": "269620"
  },
  {
    "text": "And I think there's many\nother situations like this. So if you try to\nmeasure a diffusivity,",
    "start": "269620",
    "end": "278287"
  },
  {
    "text": "it might be possible\nto set up an experiment where you'd expect a linear\ndependency to something you'd measure in a diffusivity,\nbut most likely not.",
    "start": "278287",
    "end": "284280"
  },
  {
    "text": "So most likely it will come\nin non-linearly somehow and you'd have\nsome model for it,",
    "start": "284280",
    "end": "289787"
  },
  {
    "text": "and you'd have a\nnon-linear dependence between that number and the\nnumbers you would measure. Right?",
    "start": "289787",
    "end": "295420"
  },
  {
    "text": "And almost all the\nproperties are like that. So because you have a\nnon-linear dependence,",
    "start": "295420",
    "end": "303437"
  },
  {
    "text": "then you have to worry\nabout how many minima do you have in your surface? So chi-squared of theta\nis a non-linear function",
    "start": "303437",
    "end": "310300"
  },
  {
    "text": "of a lot of variables. And typically it won't\njust have one minimum, you'll have a whole\nlot of local minima.",
    "start": "310300",
    "end": "316530"
  },
  {
    "text": "Now one of those is\nthe global minimum. And that's the one\nyou want, that's the very best possible fit.",
    "start": "316530",
    "end": "321600"
  },
  {
    "text": "But you normally won't\nknow how many minima it has and so no matter\nhow many minima you",
    "start": "321600",
    "end": "328170"
  },
  {
    "text": "find you don't know\nif you're done, and you don't know if you\nreally found the best fit.",
    "start": "328170",
    "end": "333900"
  },
  {
    "text": "OK? So just because all the\nones you found so far bigger than chi-squared\nmax you might not",
    "start": "333900",
    "end": "339150"
  },
  {
    "text": "be ready to write\nthat article in Nature to claim that the\nlaws of physics are incorrect because\nyou're not sure you really",
    "start": "339150",
    "end": "344389"
  },
  {
    "text": "found the very best fit. OK? So that's one of\nthe many problems of trying to figure out\nif a model of the data",
    "start": "344389",
    "end": "351380"
  },
  {
    "text": "are really consistent. Now that particular\none, you can overcome",
    "start": "351380",
    "end": "356530"
  },
  {
    "text": "if you can find a guaranteed\nway to find the global optimum, to find the very best\npossible that there is.",
    "start": "356530",
    "end": "363070"
  },
  {
    "text": "And some people spend\ntheir life working on this, and one of those people\nis professor Barton in this department.",
    "start": "363070",
    "end": "368290"
  },
  {
    "text": "And so he teaches a\nclass on how to do this, and there are actually\nmethods to do it. So if you want to see\nthe application of this",
    "start": "368290",
    "end": "375130"
  },
  {
    "text": "to kinetic models\nthere's a paper by me and professor Barton. And the lead author is one\nof his former students,",
    "start": "375130",
    "end": "382420"
  },
  {
    "text": "Adam Singer and J. Phys. Chem. and it just shows how\nyou can use global optimization",
    "start": "382420",
    "end": "389387"
  },
  {
    "text": "to guarantee you have\nthe very best possible via the parameters, and then\nthey'll show you what happens.",
    "start": "389387",
    "end": "394430"
  },
  {
    "text": "So this is a case where the\nexperimental data was measured by one of my students,\nJames Taylor, and that's",
    "start": "394430",
    "end": "402150"
  },
  {
    "text": "the thing with the error bars,\nand he did a lot of hard work to make sure he had\npretty good error bars and he really knew\nwhat they were.",
    "start": "402150",
    "end": "408849"
  },
  {
    "text": "And so he had those points. So he measured a lot of points. This measuring a lot of\npoints is a key thing.",
    "start": "408850",
    "end": "414080"
  },
  {
    "text": "So it means his degrees\nof freedom is very large. Because he uses many,\nmany different time",
    "start": "414080",
    "end": "419280"
  },
  {
    "text": "points along the\nway there and he has error bars on all of them. And so because the degrees\nof freedom are very large",
    "start": "419280",
    "end": "426410"
  },
  {
    "text": "it actually makes it a very\ngood constraint on the model. It tested very thoroughly.",
    "start": "426410",
    "end": "432630"
  },
  {
    "text": "Where if you only\nmeasured one point, then that's not a\nvery good constraint. Now what James had done, and we\npublished a paper in 2004 where",
    "start": "432630",
    "end": "440820"
  },
  {
    "text": "he did it, where he said,\nyou know, when I do my fits this is what I get. I get these kind of\npurple and green things,",
    "start": "440820",
    "end": "449229"
  },
  {
    "text": "and therefore they're all\noutside the error bars, and therefore I publish in the\nJournal of Physical Chemistry,",
    "start": "449230",
    "end": "455500"
  },
  {
    "text": "I claim this model is wrong\nbased on my experimental data. OK? So we published that in 2004,\nit was accepted by the referees.",
    "start": "455500",
    "end": "463270"
  },
  {
    "text": "It's in the literature,\nyou can read it. Don't believe it though, because\nAdam singer went back and did",
    "start": "463270",
    "end": "469180"
  },
  {
    "text": "global optimisation\nusing the same model and his red line goes right\nthrough all the points really",
    "start": "469180",
    "end": "476220"
  },
  {
    "text": "well. Do you see that? You can see the red line there. See this red curve? That's the true best fit.",
    "start": "476220",
    "end": "482830"
  },
  {
    "text": "And so all the fits\nthat James had found were all local minima in the\nchi-squared squared surface.",
    "start": "482830",
    "end": "488840"
  },
  {
    "text": "And when he actually\nfound the best fit with Adam's fancy\nmethod, then it turns out that\nactually the model matched the data perfectly.",
    "start": "488840",
    "end": "496270"
  },
  {
    "text": "So that's definitely true. So what we published\nthe first time was completely wrong,\nbecause we said",
    "start": "496270",
    "end": "502742"
  },
  {
    "text": "the model disproved the data. But in fact the model\nproved the data. I mean the data\nproved the model, or was completely\nconsistent with the model",
    "start": "502742",
    "end": "508831"
  },
  {
    "text": "in every way in great detail. So I was a little embarrassed. So then James, also in the\nsame paper, had found--",
    "start": "508831",
    "end": "520559"
  },
  {
    "text": "and they measured\nanother condition in a slightly different\ncase, and actually",
    "start": "520559",
    "end": "525880"
  },
  {
    "text": "was looking at a\ndifferent solvent. And in this case he found this\ngreen curve as his best fit,",
    "start": "525880",
    "end": "533529"
  },
  {
    "text": "and it looked\npretty good by eye, though you can see\nit sort of skittering",
    "start": "533530",
    "end": "539950"
  },
  {
    "text": "on the tops of the\nerror bar bands. And so this is one\nwhere he said, you know,",
    "start": "539950",
    "end": "546450"
  },
  {
    "text": "we do the statistical test,\nthere's like a 5% chance that you would\nmeasure data like he",
    "start": "546450",
    "end": "552190"
  },
  {
    "text": "measured if the green\nmodel was the truth.",
    "start": "552190",
    "end": "557440"
  },
  {
    "text": "And so we said some\nwishy-washy words in the paper, basically because\nwe weren't really",
    "start": "557440",
    "end": "563209"
  },
  {
    "text": "if it was consistent or not\nconsistent with the data. But in that case Adam used\nhis fancy global optimization",
    "start": "563210",
    "end": "569722"
  },
  {
    "text": "techniques and found that\nJames' fit was actually not that far from the\nglobal optimum, and he got the red curve\nthere, marked by the red arrow,",
    "start": "569722",
    "end": "577159"
  },
  {
    "text": "and that one looks\npretty good, it actually goes through the data. But it doesn't\nreally do it right,",
    "start": "577159",
    "end": "583570"
  },
  {
    "text": "and found that the confidence\nintervals are only 16%. So it's only a 16% chance,\none chance out of six,",
    "start": "583570",
    "end": "590800"
  },
  {
    "text": "that James would have\nmeasured the data he measured if that model was true. And now we're sure that we\nhave the global best fit,",
    "start": "590800",
    "end": "597724"
  },
  {
    "text": "so now we're, like,\nthinking well, you know, maybe we should\nsay that the model is not true for this case.",
    "start": "597724",
    "end": "604389"
  },
  {
    "text": "Because it's an 84% chance\nit's not true anyway. So actually we got\nit wrong both ways.",
    "start": "604390",
    "end": "610670"
  },
  {
    "text": "So in the first case\nwe said that our data disproved the model. And in the second case, we said\nthat our model was pretty good",
    "start": "610670",
    "end": "620229"
  },
  {
    "text": "with the data, but actually\nthey were both wrong. So one was wrong that actually--",
    "start": "620229",
    "end": "626267"
  },
  {
    "text": "the data did prove the models\ncorrect for the first case and it actually looks a little\nfishy for the second case.",
    "start": "626267",
    "end": "634329"
  },
  {
    "text": "So anyway this is just\na concrete example to make you be a little bit more\nworried about what you do when",
    "start": "634330",
    "end": "641444"
  },
  {
    "text": "you do these fitting things.  Now there's a variety of ways\nto try to do the least course",
    "start": "641444",
    "end": "649810"
  },
  {
    "text": "fitting to try to find optima. There was a guy named Carr\nfrom University of Minnesota.",
    "start": "649810",
    "end": "656639"
  },
  {
    "text": "And he published\nthis [INAUDIBLE] way to just try a whole lot of\ndifferent initial guesses, and that usually works to\nfind the global minimum.",
    "start": "656639",
    "end": "665363"
  },
  {
    "text": "But if you really want to have\na guaranteed global minimum that you're absolutely\nsure is definitely is the global minimum,\nthen you really",
    "start": "665364",
    "end": "671529"
  },
  {
    "text": "need to use global\noptimization methods and you really should\ntalk to professor Barton. And for these kinetic\nmodels he actually has",
    "start": "671530",
    "end": "678010"
  },
  {
    "text": "a distributed code called\nGDOC that will just find the global optimization\nas long as you don't have",
    "start": "678010",
    "end": "683440"
  },
  {
    "text": "too many kinetic parameters. I think if you go to about 6-- around 6 adjustable\nparameters it can handle.",
    "start": "683440",
    "end": "689980"
  },
  {
    "text": "If you have more than that\nthen usually typically not. Because the problem with\nglobal optimisation methods",
    "start": "689980",
    "end": "695723"
  },
  {
    "text": "is that they scale\nexponentially with the number of adjustable parameters,\nor the number of things",
    "start": "695723",
    "end": "702370"
  },
  {
    "text": "you're trying to optimize. Now on the other\nhand, if you have a model that you\nneed to use more",
    "start": "702370",
    "end": "707620"
  },
  {
    "text": "than six adjustable\nparameters to fit your data, then you might want\nto try to think of a different experiment.",
    "start": "707620",
    "end": "713050"
  },
  {
    "text": "Because you know the famous\nsaying is like, you know, give me N parameters\nI can fit an elephant.",
    "start": "713050",
    "end": "720910"
  },
  {
    "text": "So if you have more\nthan six parameters and you're trying to\nfit some data set, probably if you do it\nright you'll find a fit,",
    "start": "720910",
    "end": "727630"
  },
  {
    "text": "but it may not really\nprove anything.  So from that point\nof view professor",
    "start": "727630",
    "end": "733269"
  },
  {
    "text": "Barton's code, GDOC, is\npretty convenient for doing these non-linear optimizations. So that's a code for non-linear\noptimization with differential",
    "start": "733270",
    "end": "740500"
  },
  {
    "text": "equations embedded. And they can be stiff\nand they can be large, it doesn't matter. What really matters\nit's just the number",
    "start": "740500",
    "end": "746536"
  },
  {
    "text": "of adjustable parameters,\nthat's the cost.",
    "start": "746536",
    "end": "751550"
  },
  {
    "text": "All right now there was\na really good question, that you asked I think,\nin class last time, maybe.",
    "start": "751550",
    "end": "758770"
  },
  {
    "text": "Maybe the time before. And it was what happens-- so let's look at\ndifferent case you get.",
    "start": "758770",
    "end": "765340"
  },
  {
    "text": "So one case you get, you\nknow, if chi-squared square,",
    "start": "765340",
    "end": "770630"
  },
  {
    "text": "theta best, your best fit\nparameters is a lot bigger, think chi-squared max, then\nyou're ready to say the model",
    "start": "770630",
    "end": "779620"
  },
  {
    "text": "disproves it. ",
    "start": "779620",
    "end": "785759"
  },
  {
    "text": "So that one you're OK. If chi-squared of your\nbest fit is less than,",
    "start": "785760",
    "end": "794350"
  },
  {
    "text": "or significantly less\nthan chi-squared max-- it has be much less than\nit, really less, not equal.",
    "start": "794350",
    "end": "801060"
  },
  {
    "text": " --then you're\nreally happy to say that the models are consistent.",
    "start": "801060",
    "end": "807510"
  },
  {
    "text": "The model and data are\nconsistent to each other. ",
    "start": "807510",
    "end": "813404"
  },
  {
    "text": "And, in this case, what\nyou would normally do next",
    "start": "813405",
    "end": "819080"
  },
  {
    "text": "is determine the confidence\nintervals on the thetas",
    "start": "819080",
    "end": "828700"
  },
  {
    "text": "that you adjusted. Right? And if you read the chapter\nin Numerical Recipes,",
    "start": "828700",
    "end": "835030"
  },
  {
    "text": "for example, some\nof the notes online, it could tell you\nhow to do this. Right?",
    "start": "835030",
    "end": "840060"
  },
  {
    "text": "And so that was OK? It's OK. So the case that's\nreally problematic",
    "start": "840060",
    "end": "845140"
  },
  {
    "text": "is you find\nchi-squared theta best, and it's less than\nchi-squared max,",
    "start": "845140",
    "end": "850829"
  },
  {
    "text": "so you think the model\nis consistent with data, but it's pretty darn close\nto theta-squared max.",
    "start": "850830",
    "end": "857760"
  },
  {
    "text": "And so then you have to figure\nout, well, the weird aspect",
    "start": "857760",
    "end": "862980"
  },
  {
    "text": "of this is I now have-- here's my famous plot of\ntheta one and theta two.",
    "start": "862980",
    "end": "869820"
  },
  {
    "text": "So I have two parameters\nI'm adjusting. If they want theta two,\nhere's my best fit. My best fit. ",
    "start": "869820",
    "end": "877540"
  },
  {
    "text": "If chi-squared\nmax-- if the curve of constant chi-squared\nmax is something like this,",
    "start": "877540",
    "end": "885916"
  },
  {
    "text": "this is chi-squared of theta\nequals chi-squared max.",
    "start": "885916",
    "end": "892650"
  },
  {
    "text": "If it's like that then\nI have some big region of a lot of different\ntheta values that give pretty\ngood fits, and I'm",
    "start": "892650",
    "end": "898492"
  },
  {
    "text": "happy to draw\nconfidence intervals, like draw lines here and\nhere, for example, and say that's the confidence\ninterval on theta one,",
    "start": "898492",
    "end": "903759"
  },
  {
    "text": "and I'm all right. OK? And it's sloped\nhere so I might want to tell people about the\nco-variance between theta",
    "start": "903760",
    "end": "910330"
  },
  {
    "text": "one and theta two. All right? But I know what\nto do, it's fine. Now suppose this is the\ncase that's like this.",
    "start": "910330",
    "end": "917817"
  },
  {
    "text": "Where chi-squared theta\nbest is significantly less than chi-squared max. Now suppose instead\nchi-squared best",
    "start": "917817",
    "end": "925620"
  },
  {
    "text": "was very close chi-squared max. So then here is chi-squared max. This is chi-squared of theta\nequals chi-squared max,",
    "start": "925620",
    "end": "933360"
  },
  {
    "text": "this is the good case. Here's the bad case. ",
    "start": "933360",
    "end": "941740"
  },
  {
    "text": "So in the bad case, there\nis some region of thetas that the model is\nconsistent with the data,",
    "start": "941740",
    "end": "947200"
  },
  {
    "text": "but it's very tiny. There's a little tiny\nrange of theta values that would make the models\nconsistent with the data.",
    "start": "947200",
    "end": "955130"
  },
  {
    "text": "Now what's weird about this\nis that my best fit, it's not very good. The chi-squared is\nalmost up to the maximum",
    "start": "955130",
    "end": "961470"
  },
  {
    "text": "chi-squared I would tolerate. So it means my deviations\nbetween my model and data are pretty bad. Like this plot actually.",
    "start": "961470",
    "end": "967380"
  },
  {
    "text": "OK? And so I'm, like, you know,\nit could-- it's possible. I was a little bit\nunlucky and my data set",
    "start": "967380",
    "end": "973990"
  },
  {
    "text": "is pretty far off but still\nwithin the possible range. And so maybe the model\ndata are consistent.",
    "start": "973990",
    "end": "980940"
  },
  {
    "text": "But then when I try to compute\nthe confidence intervals on my parameters, there's\nonly a really small range",
    "start": "980940",
    "end": "987550"
  },
  {
    "text": "of parameters that are going\nto give good fits here. Because the best possible\nfit is this red line.",
    "start": "987550",
    "end": "992620"
  },
  {
    "text": "There's no choice\nof the parameters that's going to go through all\nthe circles with this model.",
    "start": "992620",
    "end": "999690"
  },
  {
    "text": "So now I'm like,\nwhat's going on here? ",
    "start": "999690",
    "end": "1004937"
  },
  {
    "text": "So if I went ahead\nand do the same way I did before, I draw my\nconfidence intervals like this",
    "start": "1004937",
    "end": "1010190"
  },
  {
    "text": "and say, OK. Say, wow, I've done\nan amazingly great job of determining theta one.",
    "start": "1010190",
    "end": "1015940"
  },
  {
    "text": "I know theta one very,\nvery, very precisely. And the same for theta two. Here's theta two, it's\ngot to be in that range",
    "start": "1015940",
    "end": "1021526"
  },
  {
    "text": "and I've really\ndone a great job. So I'm awesome. But I'm only awesome\nbecause my original best",
    "start": "1021526",
    "end": "1028640"
  },
  {
    "text": "fit wasn't very good. So this might make you feel\na little sick in your stomach",
    "start": "1028640",
    "end": "1033890"
  },
  {
    "text": "if you're getting ready\nto publish in nature. Right? And then if the reviewers\nare on their game,",
    "start": "1033890",
    "end": "1041119"
  },
  {
    "text": "you might get something\nreally scathing back from the reviewers. So there's kind of two ways\nto play it at this point.",
    "start": "1041119",
    "end": "1050771"
  },
  {
    "text": "One way is, you are absolutely\nsure that your equations are correct. You are Sir Isaac\nNewton, you have just",
    "start": "1050771",
    "end": "1057140"
  },
  {
    "text": "written the law of gravitation. You are measuring the orbits\nof the moons of Jupiter,",
    "start": "1057140",
    "end": "1062150"
  },
  {
    "text": "and you are sure that\nyour equations are right. And so, you know, my problem\nis my antiquated telescopes",
    "start": "1062150",
    "end": "1069770"
  },
  {
    "text": "of 1600 are not\nthat great, and so I think I have maybe-- maybe\nI misestimated my error bars on my measurements.",
    "start": "1069770",
    "end": "1075971"
  },
  {
    "text": "Maybe I have some\naberration or something, the angles are off, right? My twisted telescope looks as\nif the star moves or something,",
    "start": "1075971",
    "end": "1081929"
  },
  {
    "text": "right? OK? So that's one\npossible way to go,",
    "start": "1081930",
    "end": "1088040"
  },
  {
    "text": "say I really believe\nthe model, and so I believe this is the\ntruth, and I really",
    "start": "1088040",
    "end": "1094140"
  },
  {
    "text": "believe my chi-squared\nmax to be what it is, and I double checked the error\nbars and I think it's true. So I think have done a great\njob and I should publish it",
    "start": "1094140",
    "end": "1100415"
  },
  {
    "text": "in Nature because\nI have determined these parameters with\n17 more decimal places than anybody ever could before.",
    "start": "1100415",
    "end": "1105750"
  },
  {
    "text": "OK? So that's one way to look at it. The other way to\nlook at it is what's recommended in the\nNumerical Recipes book.",
    "start": "1105750",
    "end": "1111550"
  },
  {
    "text": "And they say don't use-- instead of writing the equation\nto be chi-squared of theta",
    "start": "1111550",
    "end": "1120320"
  },
  {
    "text": "has to be less than\nchi-squared max, they say when you're computing\nthe confidence intervals, instead write\nchi-squared of theta",
    "start": "1120320",
    "end": "1129500"
  },
  {
    "text": "has to be less than chi-squared\nbest fit plus chi-squared max.",
    "start": "1129500",
    "end": "1140256"
  },
  {
    "start": "1140000",
    "end": "1275000"
  },
  {
    "text": "So they say don't use a\nstinky little circle here, draw a nice big\none around there.",
    "start": "1140256",
    "end": "1147030"
  },
  {
    "text": " And what is this saying?",
    "start": "1147030",
    "end": "1152314"
  },
  {
    "text": "I guess what this is\nsaying is I don't believe that my poor agreement\nbetween the model and data",
    "start": "1152314",
    "end": "1158080"
  },
  {
    "text": "justifies me declaring very\nnarrow parameter values. So",
    "start": "1158080",
    "end": "1163230"
  },
  {
    "text": "I just use the kinds of\nparameter value confidence intervals that it would have\nactually computed a priori when",
    "start": "1163230",
    "end": "1169200"
  },
  {
    "text": "I do my experimental design. I think that's really how\nwell I can determine stuff.",
    "start": "1169200",
    "end": "1175220"
  },
  {
    "text": "And I think something is\nwrong that my chi-squared best fir is so bad. Maybe I didn't do my\nglobal optimization right",
    "start": "1175220",
    "end": "1181140"
  },
  {
    "text": "and so I have the\nwrong parameters. Maybe I mis-estimated\nmy error bars",
    "start": "1181140",
    "end": "1187360"
  },
  {
    "text": "and so my chi-squared\nare all off. Maybe-- I don't know\nwhat else happened. Something happened, and I\ndon't believe I'm that good,",
    "start": "1187360",
    "end": "1196210"
  },
  {
    "text": "so therefore I'm going to\nquote much broader confidence intervals, which means much less\nprecision in my determination",
    "start": "1196210",
    "end": "1202150"
  },
  {
    "text": "of parameters. And that's what\nthe Numerial Recipe guys recommend you should do. But you know, it's up to you.",
    "start": "1202150",
    "end": "1208030"
  },
  {
    "text": "And I see it both ways. So the people who won the Nobel\nPrize for the dark energy,",
    "start": "1208030",
    "end": "1215165"
  },
  {
    "text": "do you guys know about this? So if you ever saw\nthe data there. So that's one where they said--",
    "start": "1215165",
    "end": "1220875"
  },
  {
    "text": "they were using\nEinstein's theory of relativity,\nGeneral relativity. They say we believe Einstein,\nwe believe that equations true.",
    "start": "1220875",
    "end": "1227790"
  },
  {
    "text": "And we're not going\nto, you know, the fact that the data only\nmatches when you choose a certain value of the\ncosmological constant,",
    "start": "1227790",
    "end": "1234909"
  },
  {
    "text": "we're just going to go with it. And we're reporting\nthat's the value of the cosmological constant. Now some other people might say\nthat's kind of goofy theory.",
    "start": "1234910",
    "end": "1242562"
  },
  {
    "text": "Einstein changed his\nmind six times about whether to put the\ncosmological constant in the equation at all,\nso I'm not so confident",
    "start": "1242562",
    "end": "1249100"
  },
  {
    "text": "and I would report\nsomething different. But they went with their gut. They said we believe Einstein.",
    "start": "1249100",
    "end": "1254679"
  },
  {
    "text": "They went with it. The Nobel Committee agreed,\nand they got the Nobel prize. So you know, you're\ntaking your chances.",
    "start": "1254680",
    "end": "1262060"
  },
  {
    "text": "The Numerical Recipe guys\nare more like engineers, they say, oh, we don't believe\nmodels that much anyway. Let's just use more conservative\nconfidence intervals.",
    "start": "1262060",
    "end": "1271220"
  },
  {
    "text": "Any questions about this?  OK. All right.",
    "start": "1271220",
    "end": "1276320"
  },
  {
    "start": "1275000",
    "end": "1515000"
  },
  {
    "text": "So now let's change topics. ",
    "start": "1276320",
    "end": "1283376"
  },
  {
    "text": "And we'll change to\n[INAUDIBLE] splitting. So if you remember back when\nwe were talking about boundary",
    "start": "1283376",
    "end": "1289670"
  },
  {
    "text": "value problems,\nwe're often trying",
    "start": "1289670",
    "end": "1296439"
  },
  {
    "text": "to solve problems\nthat are like this. ",
    "start": "1296439",
    "end": "1320658"
  },
  {
    "text": "All right. So this is the\nconservation equation for a species in a\nreacting flow situation.",
    "start": "1320658",
    "end": "1327710"
  },
  {
    "text": "So you have some convection,\nyou have some diffusion, you have some reactions.",
    "start": "1327710",
    "end": "1334190"
  },
  {
    "text": "Now in my life I\nhave a lot of models. I have about 200\nspecies in them. So this K is 200\ndifferent variables.",
    "start": "1334190",
    "end": "1341341"
  },
  {
    "text": "And then you have these\nequations, and on top of them you have [INAUDIBLE] equations\nfor that momentum conservation",
    "start": "1341342",
    "end": "1348050"
  },
  {
    "text": "and continuity. And so this is actually a\npretty bad set of equations.",
    "start": "1348050",
    "end": "1353669"
  },
  {
    "text": "And typically the\nchemistry is stiff. Because I have\nchemistry time scales",
    "start": "1353670",
    "end": "1358970"
  },
  {
    "text": "it'll be, like, in picoseconds,\nsub-nanosecond time scales. And I'm caring about\nsimulating-- well in my case",
    "start": "1358970",
    "end": "1366260"
  },
  {
    "text": "maybe I have an advanced new\nengine burning some fuel. And so we're running over a\nsimulation of a piston cycle,",
    "start": "1366260",
    "end": "1371690"
  },
  {
    "text": "maybe 10 milliseconds, but the\nchemistry is sub-nanosecond, so then you multiply it out.",
    "start": "1371690",
    "end": "1376890"
  },
  {
    "text": "So that's like I'm going to 10\nto minus two seconds down to 10 to minus 10 seconds. That's eight orders of magnitude\ndifference in time scales.",
    "start": "1376890",
    "end": "1383520"
  },
  {
    "text": "So I'm in a bad way trying\nto solve this equation. And I have 200 of these\nguys coupled to each other.",
    "start": "1383520",
    "end": "1391520"
  },
  {
    "text": "And then I have to think\nabout what my mesh looks like. And I'm trying to\nsimulate inside a piston,",
    "start": "1391520",
    "end": "1396649"
  },
  {
    "text": "actually I have a moving\nmesh because the pistons compressing, so the equations\nare kind of complicated even with what the mesh is doing.",
    "start": "1396649",
    "end": "1403226"
  },
  {
    "text": "And then I need a\nbunch of mesh points there because the-- do you\nguys hear the Kolmogorov scale? You guys learned this yet?",
    "start": "1403227",
    "end": "1409920"
  },
  {
    "text": "It's a scale like\nthe minimum eddy size if you have a turbulent flow. And that's pretty\ndarn small also.",
    "start": "1409920",
    "end": "1416290"
  },
  {
    "text": "So it might be sub-micron. And so I have a\nnatural, lens scale",
    "start": "1416290",
    "end": "1422500"
  },
  {
    "text": "that's like microns maybe. So 10 to minus six meters,\nbut the piston diameter is couple centimeters,\nso again I",
    "start": "1422500",
    "end": "1428799"
  },
  {
    "text": "have like four orders of\nmagnitude between the mesh size I need to\nresolve the physics",
    "start": "1428800",
    "end": "1436090"
  },
  {
    "text": "and the size of the thing. So I need about 10,000\npoints across the cylinder, but it's a 3-D problem, so I\nneed 10 to the fourth, times 10",
    "start": "1436090",
    "end": "1443020"
  },
  {
    "text": "to the fourth, times\nten to the fourth, so I need 10 to the\n12th mesh points. And then I have 200 variables,\nsay variables at each mesh",
    "start": "1443020",
    "end": "1449700"
  },
  {
    "text": "point, so I have 10 to\nthe 14th stayed variables.",
    "start": "1449700",
    "end": "1455236"
  },
  {
    "text": "So how much memory you\nhave in your computer? How much ram? You have probably\nlike 16 gigabytes.",
    "start": "1455236",
    "end": "1460929"
  },
  {
    "text": "So you have ten to the ninth-\ntenth to the ninth bytes, is that right? No-- what's giga?",
    "start": "1460930",
    "end": "1467741"
  },
  {
    "text": "Ninth? OK, so you have\nten to the tenth. Sorry. Ten to the tenth\nbyes, but I have 10 to the 14th stayed variables.",
    "start": "1467741",
    "end": "1475299"
  },
  {
    "text": "So I have a problem. So then you need to figure\nout how you solve it. So there's two schools\nof thought of how",
    "start": "1475300",
    "end": "1482400"
  },
  {
    "text": "to solve these equations. The school thought which\nhas actually been the most successful so far, but\nis not readily available,",
    "start": "1482400",
    "end": "1489529"
  },
  {
    "text": "is to get the\ngovernment to build you the biggest possible computer\nin the world with as much memory",
    "start": "1489529",
    "end": "1495000"
  },
  {
    "text": "as possible. And then you can actually keep\ntrack of your state vector, all 10 to the 14th\nelements, and you",
    "start": "1495000",
    "end": "1504240"
  },
  {
    "text": "reserve this whole computer\nfor yourself for, your know, a month. And just run it.",
    "start": "1504240",
    "end": "1509810"
  },
  {
    "text": "And you figure out\nhow to parallelize all the calculations, and you\njust use an explicit solver.",
    "start": "1509810",
    "end": "1516220"
  },
  {
    "start": "1515000",
    "end": "1585000"
  },
  {
    "text": "And so that way it's\njust straightforward. All you're doing is\nyou're computing, you know y of T plus delta\nT is equal to something,",
    "start": "1516220",
    "end": "1527146"
  },
  {
    "text": "and it's just an\nexplicit formula ode45, fancy version of that. OK?",
    "start": "1527146",
    "end": "1533050"
  },
  {
    "text": "And it's just algebra,\nand you just add them up and it's no problem.",
    "start": "1533050",
    "end": "1538380"
  },
  {
    "text": "But this is a limited\nfeasibility thing.",
    "start": "1538380",
    "end": "1543480"
  },
  {
    "text": "This only became possible\nabout three years ago when they built a computer\nthat actually had enough memory to store the state factor.",
    "start": "1543480",
    "end": "1549530"
  },
  {
    "text": "It's also-- if the equations\nare too stiff it still doesn't work, because the step\nsize and time step you need",
    "start": "1549530",
    "end": "1559040"
  },
  {
    "text": "to use is so small-- so say it's 100\npicoseconds and you're trying to get it out\nto a millisecond,",
    "start": "1559040",
    "end": "1564800"
  },
  {
    "text": "so you need 10 to\nthe eighth something time steps, which means you need\nto double precision numbers all the way through.",
    "start": "1564800",
    "end": "1571040"
  },
  {
    "text": "But if the government builds\nyou a 64-bit 128-bit machine then you can do it.",
    "start": "1571040",
    "end": "1577860"
  },
  {
    "text": "But anyway this is like a\nvery special kind of approach. So now most people,\nincluding me I",
    "start": "1577860",
    "end": "1583490"
  },
  {
    "text": "don't have access to that\nkind of computer power. Actually if you want\nto read about that there's a woman who does\nthat, who is Jacqueline Chen,",
    "start": "1583490",
    "end": "1592280"
  },
  {
    "start": "1585000",
    "end": "1637000"
  },
  {
    "text": "and you might want to look on\nthe internet and see about her. And somehow she became\nbuddies with the people in charge of the\nsuper computers,",
    "start": "1592280",
    "end": "1598650"
  },
  {
    "text": "and so they're happy to give\nher a month of, you know, the best computer in\nthe world every year, and she runs some really\nawesome calculation",
    "start": "1598650",
    "end": "1606610"
  },
  {
    "text": "that's exactly right. Solves everything, has\nall the state variables ten to the 14th, and\nthat's fantastic.",
    "start": "1606610",
    "end": "1612299"
  },
  {
    "text": "And currently\nthat's the benchmark for how people test approximate\nmethods for how to solve this.",
    "start": "1612300",
    "end": "1619500"
  },
  {
    "text": "Because she actually has the\nfull solution numerically converged.",
    "start": "1619500",
    "end": "1625710"
  },
  {
    "text": "But this again is a\nlimited applicability. So a lot of people are working\non approximation methods",
    "start": "1625710",
    "end": "1632010"
  },
  {
    "text": "to try to solve this equation\nif I don't have access to such awesome\ncomputer resources.",
    "start": "1632010",
    "end": "1638480"
  },
  {
    "start": "1637000",
    "end": "2297000"
  },
  {
    "text": "And the general idea of them--",
    "start": "1638480",
    "end": "1645020"
  },
  {
    "text": "well the two ideas. So one idea is somehow\nget rid of the turbulence. OK?",
    "start": "1645020",
    "end": "1650480"
  },
  {
    "text": "And so what they do is they\nuse a mesh coarser than what you what you would need to\nresolve the Kolmogorov scale,",
    "start": "1650480",
    "end": "1656289"
  },
  {
    "text": "and then they use\nmodels for what happens for itty bitty tiny eddies. And those are called\nsub-grade scale models,",
    "start": "1656290",
    "end": "1663070"
  },
  {
    "text": "and this whole approach is\ncalled large eddy simulation. And the idea is you keep\ntrack of the large eddies, the big recirculation zones\nthat's modelled explicitly,",
    "start": "1663070",
    "end": "1671409"
  },
  {
    "text": "but you don't keep track\nof all the itty bitty tiny swirling off little\neddies that lasts for a little second, a little\nbit of a period of time",
    "start": "1671410",
    "end": "1677518"
  },
  {
    "text": "before they dissipate\nbecause of diffusion. OK? So that's the concept.",
    "start": "1677518",
    "end": "1683590"
  },
  {
    "text": "And there's, I don't\nknow, half of all of the mechanical engineers who\nwork in large eddy simulations",
    "start": "1683590",
    "end": "1689074"
  },
  {
    "text": "are trying to figure\nout how to do this. Maybe Jim as well, I don't know. No. OK, but at least he knows\nsome of them probably.",
    "start": "1689074",
    "end": "1695990"
  },
  {
    "text": "So that's one whole branch. It's to try to get\nrid of the turbulence. And basically that's\ntrying to reduce",
    "start": "1695990",
    "end": "1703120"
  },
  {
    "text": "the density of mesh I need. So trying to get rid of this-- use the spatial mesh.",
    "start": "1703120",
    "end": "1708559"
  },
  {
    "text": "But the other issue\nis the time mesh. And the time is\neven worse, right? Because I said I have ten\nto the eighth time points and I only need ten to\nthe fourth spatial points",
    "start": "1708559",
    "end": "1715919"
  },
  {
    "text": "in the dimension. So in some ways, if I can\ndo something with the time, that really can buy me a lot. I have eight orders\nof magnitude I'd",
    "start": "1715920",
    "end": "1722470"
  },
  {
    "text": "like to try to reduce to three\norders of magnitude if I could, that would be really nice.",
    "start": "1722470",
    "end": "1728540"
  },
  {
    "text": "That idea is to say,\nwell let's separate the fast timescales from\nthe slow time scales. And in fact all the\nfast time scales",
    "start": "1728540",
    "end": "1734710"
  },
  {
    "text": "are mostly all chemistry,\nparticularly after I changed the eddy simulation where I get\nrid of the really small spatial",
    "start": "1734710",
    "end": "1740200"
  },
  {
    "text": "scales, then the time scale of\ndiffusion over this big mesh is kind of slow.",
    "start": "1740200",
    "end": "1746500"
  },
  {
    "text": "And so I can go to a time\nscale that's completely controlled by chemistry.",
    "start": "1746500",
    "end": "1751870"
  },
  {
    "text": "So we already told you, how do\nyou solve stiff differential equations? Use a stiff solver, right?",
    "start": "1751870",
    "end": "1757390"
  },
  {
    "text": "And there are special methods,\nthere are implicit methods, and there's specialized solvers.",
    "start": "1757390",
    "end": "1762430"
  },
  {
    "text": "And what they do is they allow\nyou to take larger time steps than you would be allowed\nto use with explicit methods",
    "start": "1762430",
    "end": "1769779"
  },
  {
    "text": "where you would run into\nnumerical instabilities. If you try to use the explicit\nmethod with a big time stamp,",
    "start": "1769779",
    "end": "1775360"
  },
  {
    "text": "it's much bigger than the\nreal physical time scale, you'll get some\ncrazy oscillations. But if we use the\nstiff solvers you",
    "start": "1775360",
    "end": "1781710"
  },
  {
    "text": "can get away with\ntime steps that are much, much larger than\nthe real physical scale. So that allows you to go\nfrom 100 picoseconds up",
    "start": "1781710",
    "end": "1789010"
  },
  {
    "text": "to maybe 100 nanoseconds. Get rid of three orders\nof magnitude of time step by using a stiff solver.",
    "start": "1789010",
    "end": "1794950"
  },
  {
    "text": "So that's pretty good, three\norders magnitude reduction? Well go for it. It's not only reducing\nthe CPU time potentially,",
    "start": "1794950",
    "end": "1802716"
  },
  {
    "text": "but it's even more\nimportantly reducing the number of points\nyou have to save, because when you run this\ncalculation what Jacqueline",
    "start": "1802716",
    "end": "1809740"
  },
  {
    "text": "Chen ends up with is a list, y\nat every x, xn, yn, el, times",
    "start": "1809740",
    "end": "1820952"
  },
  {
    "text": "e, something like this. Alpha, I don't know.",
    "start": "1820952",
    "end": "1828090"
  },
  {
    "text": "That's the output\nof her program. OK, so how big is this object? This is 200 times 10 to the\nfourth, times 10 to the fourth,",
    "start": "1828090",
    "end": "1835855"
  },
  {
    "text": "times 10 to the fourth,\ntimes 10 to the eighth. Right? That's how many\nnumbers she's going",
    "start": "1835855",
    "end": "1842120"
  },
  {
    "text": "to get out of her simulation. So, actually, her\nbiggest problem is not actually\nsolving the simulation. As long as she can get the one\nmonth of CPU time she's good.",
    "start": "1842120",
    "end": "1849770"
  },
  {
    "text": "She's got to solve. Her Problem is how\nto analyze her data. Because now she\nhas this much data",
    "start": "1849770",
    "end": "1854815"
  },
  {
    "text": "that she has to\nfigure out to say something rational about it. And so she has like a\nwhole army of post-docs",
    "start": "1854815",
    "end": "1859970"
  },
  {
    "text": "whose whole job is trying to\ninvent new day interrogation methods. And also this data set is\nso large it cannot be stored",
    "start": "1859970",
    "end": "1865220"
  },
  {
    "text": "on a hard disk. In fact it cannot be stored in\nthe biggest farm of hard disks. So she has to, as the\ncalculation is running,",
    "start": "1865220",
    "end": "1871790"
  },
  {
    "text": "send the data to different\nfarms of hard disks around the world and\nfilling them completely up,",
    "start": "1871790",
    "end": "1877010"
  },
  {
    "text": "and then sending them to the\nnext one and filling them up. So she has fragments\nof this data set stored all over the place.",
    "start": "1877010",
    "end": "1882110"
  },
  {
    "text": "And then if she\nwants to make a graph she has to have a special\ngraphs software that looks inside this data\nfarm, get some numbers,",
    "start": "1882110",
    "end": "1887620"
  },
  {
    "text": "look inside this\ndata farm and puts it all together in some way. So this is a pretty\nhard project. OK? Now if I can use\na stiff solver I",
    "start": "1887620",
    "end": "1894867"
  },
  {
    "text": "don't need to use\nso many time stamps. So I can get this down, say\n10 to the fifth at least I got rid of three orders\nof magnitude in my data.",
    "start": "1894867",
    "end": "1902180"
  },
  {
    "text": "Right? So now I just need\none data farm maybe, instead of, you know, using all\nthe ones at Amazon and Google own or something.",
    "start": "1902180",
    "end": "1907680"
  },
  {
    "text": "OK?  So this is a pretty big\nadvantage to do it this way.",
    "start": "1907680",
    "end": "1913509"
  },
  {
    "text": "Now the disadvantage,\nas you know, is solving implicit\ndifferential equations",
    "start": "1913510",
    "end": "1918640"
  },
  {
    "text": "is way more expensive, right? Because you have to solve an\nimplicit non-linear algebraic equation at every time step.",
    "start": "1918640",
    "end": "1926534"
  },
  {
    "text": "And in this case it can be a\npretty complicated equation. Because if I have this\nmany state variables, so 10",
    "start": "1926535",
    "end": "1932417"
  },
  {
    "text": "to the fourth, times 10 to the\nfourth, times 10 to the fourth, so 10 to 12th times 200, so 10\nto the 14th at each time step,",
    "start": "1932417",
    "end": "1939800"
  },
  {
    "text": "that's my current state. And I'm trying to solve a\nnon-linear algebraic equation, 10 to the 14th unknowns, you\nneed a pretty good solver.",
    "start": "1939800",
    "end": "1947300"
  },
  {
    "text": "I mean, I know backslash is good\nand F [? solved ?] and stuff, but I really don't think\nit's going to work.",
    "start": "1947300",
    "end": "1953940"
  },
  {
    "text": "So that's a really\nserious problem. So the next trick is to say,\nOK, well this stiffness is only",
    "start": "1953940",
    "end": "1960500"
  },
  {
    "text": "happening because\nof the chemistry. So I don't-- I could solve all of the\nfinite volumes separately.",
    "start": "1960500",
    "end": "1969690"
  },
  {
    "text": "So the idea is to\nsplit the problem up. I'm going to solve the chemistry\nusing a stiff solver only",
    "start": "1969690",
    "end": "1975299"
  },
  {
    "text": "at one point a volume at a time. And then I'm going to do the\ntransport some other way.",
    "start": "1975300",
    "end": "1980410"
  },
  {
    "text": "So what I'm going\nto do is I'm going to rewrite this equation\nas My unknown is dy to t,",
    "start": "1980410",
    "end": "1986330"
  },
  {
    "text": "is equal to some kind\nof transport term and some kind of reactant term.",
    "start": "1986330",
    "end": "1992409"
  },
  {
    "text": "And this term is local. All this in this\nequation, this is really",
    "start": "1992410",
    "end": "2000200"
  },
  {
    "text": "same dy at position x depends\non this at position x.",
    "start": "2000200",
    "end": "2010210"
  },
  {
    "text": "Whereas if you\ncompute these guys I need to do finite\ndifferences or something from adjoining finite volumes.",
    "start": "2010210",
    "end": "2016392"
  },
  {
    "text": "Right? I have to do fluxes from\nthe adjoining volumes. So these guys are\nsensitive not just",
    "start": "2016392",
    "end": "2021409"
  },
  {
    "text": "to my local value of y\nat this finite volume, but also to the\nneighboring values of y.",
    "start": "2021410",
    "end": "2026530"
  },
  {
    "text": "But if I don't worry about\nthem, if I break it up I have this local thing\nand this non-local thing.",
    "start": "2026530",
    "end": "2035110"
  },
  {
    "text": "This one is local, it's stiff. This one is non-local,\nbut it's not so stiff.",
    "start": "2035110",
    "end": "2041440"
  },
  {
    "text": " And often it's linear\nor nearly linear.",
    "start": "2041440",
    "end": "2050850"
  },
  {
    "text": "Because the transport\nterms are mostly linear. And so I can use-- I have specialized\nsolvers that people",
    "start": "2050850",
    "end": "2056638"
  },
  {
    "text": "have worked on for many years\nfor each of these things. So for the stiff thing I\nhave things like ode15s,",
    "start": "2056639",
    "end": "2061790"
  },
  {
    "text": "I have DAEPACK and [? DASPAK ?]\nand [? DASL ?] and sundials and all those programs that\npeople have written and spent",
    "start": "2061790",
    "end": "2068929"
  },
  {
    "text": "a lot of effort to\nsolve this problem. And similarly\nthere's a whole bunch of people who have spent\ntheir whole life trying to solve the convection\ndiffusion problems,",
    "start": "2068929",
    "end": "2075980"
  },
  {
    "text": "the non-reacting flow problem. And so I can use specialized\nsolvers that they have. So I want to split this up.",
    "start": "2075980",
    "end": "2081919"
  },
  {
    "text": "And what I really\nwould like to solve is I'd prefer to solve dy/dt\nequals r and dy/dt equals t",
    "start": "2081920",
    "end": "2088669"
  },
  {
    "text": "completely separately\nif I could. Because I can use\nspecialized methods that are the best for each.",
    "start": "2088670",
    "end": "2094175"
  },
  {
    "text": "So not to figure out,\nwell this is not really the real equation because it\nhas both of them added together. How can I handle that?",
    "start": "2094175",
    "end": "2100589"
  },
  {
    "text": "So this operator\nsplitting recipe",
    "start": "2100590",
    "end": "2106670"
  },
  {
    "text": "is solve dy/dt equals\nto t for a while,",
    "start": "2106670",
    "end": "2115910"
  },
  {
    "text": "and at the end of this process\nI'll have a [? yat ?] final.",
    "start": "2115910",
    "end": "2121250"
  },
  {
    "text": "And then I'll solve this\nequation with y equals y0.",
    "start": "2121250",
    "end": "2127860"
  },
  {
    "text": "That's the equation system\nof solving, of transport. I do some transport for a while,\nI get some values for the y,",
    "start": "2127860",
    "end": "2133670"
  },
  {
    "text": "then I take these\nguys and I solve",
    "start": "2133670",
    "end": "2139220"
  },
  {
    "text": "the reaction equation starting\nfrom y equals y final.",
    "start": "2139220",
    "end": "2144810"
  },
  {
    "text": "How to write this? One or two 0. ",
    "start": "2144810",
    "end": "2151190"
  },
  {
    "text": "OK? And I solve this one for a\nwhile and I'll get a different, you know, a somewhat\ndifferent [? yrt ?] final.",
    "start": "2151190",
    "end": "2158621"
  },
  {
    "text": " All right? And the simplest way\nof putting things is just keep going\nback and forth.",
    "start": "2158621",
    "end": "2164186"
  },
  {
    "text": "Boom, boom, boom, boom,\nboom, boom, boom, boom. And in the limit where I\nmake this t final minus",
    "start": "2164186",
    "end": "2171600"
  },
  {
    "text": "t0 to be very\nsmall, then maybe I",
    "start": "2171600",
    "end": "2177110"
  },
  {
    "text": "might expect that they might\nconverge to the same solution as the couple of questions.",
    "start": "2177110",
    "end": "2183680"
  },
  {
    "text": "All right? So that's the concept. Now, if you do it this way\nit doesn't work very well.",
    "start": "2183680",
    "end": "2189550"
  },
  {
    "text": "You need to make this\ndelta t incredibly small to get any accuracy.",
    "start": "2189550",
    "end": "2194920"
  },
  {
    "text": "However you can do a slightly\nmore clever version, which is I saw dy/dt equal t\nstarting from yt0, so y0,",
    "start": "2194920",
    "end": "2206775"
  },
  {
    "text": "and I solve this to me y\nat t plus delta-t over 2.",
    "start": "2206775",
    "end": "2216099"
  },
  {
    "text": "Then I solve dy/dt is equal\nto r, starting from y of t0",
    "start": "2216100",
    "end": "2224330"
  },
  {
    "text": "equal to, call this y star.",
    "start": "2224330",
    "end": "2229820"
  },
  {
    "text": "y star and this I\nintegrate out to y",
    "start": "2229820",
    "end": "2235660"
  },
  {
    "text": "of t plus the full delta t. I'll call that y double star.",
    "start": "2235660",
    "end": "2241690"
  },
  {
    "text": "And then I solve\nthis one again, and I",
    "start": "2241690",
    "end": "2248800"
  },
  {
    "text": "solve starting from y of\nt0 equal to y double star,",
    "start": "2248800",
    "end": "2253960"
  },
  {
    "text": "and I integrate that out\nfor another delta t over 2. ",
    "start": "2253960",
    "end": "2260680"
  },
  {
    "text": "And this one I\ncalled my y final. And that's the one I use.",
    "start": "2260680",
    "end": "2267349"
  },
  {
    "text": "So I take a half of\na transport step, sort of like I'm starting\nto do the transport, then I suddenly-- oh, hold on.",
    "start": "2267350",
    "end": "2272910"
  },
  {
    "text": "I got you my reaction. I do my reaction, then I do\nthe other half of my transport after that.",
    "start": "2272910",
    "end": "2278570"
  },
  {
    "text": "And if you can do\nthe analysis of this, it turns out this\nthing converges to the true solution\nof the couple equations",
    "start": "2278570",
    "end": "2284460"
  },
  {
    "text": "with second order accuracy. So you might make this\ndelta t, if I cut it in half the precision\nincreased by factor of four.",
    "start": "2284460",
    "end": "2292476"
  },
  {
    "text": "If I cut if by a factor of 10\nit increased by a factor of 100. So this is looking more\npromising as a way to do it.",
    "start": "2292477",
    "end": "2297950"
  },
  {
    "start": "2297000",
    "end": "2402000"
  },
  {
    "text": "This is the most\npopular way to do it. So this recipe here\nfor operator splitting",
    "start": "2297950",
    "end": "2304750"
  },
  {
    "text": "is called Strang splitting. Named after Gill Strang,\nhe was a professor",
    "start": "2304750",
    "end": "2310780"
  },
  {
    "text": "in applied mathematics\ndepartment here. Former head of CIAM,\nthe international body",
    "start": "2310780",
    "end": "2315970"
  },
  {
    "text": "for applied mathematics. And also author of a\nfantastically great linear algebra textbook\nwhich maybe some of you guys",
    "start": "2315970",
    "end": "2321766"
  },
  {
    "text": "might have seen\nsome videos of his. So he invented this 1968,\nI was five years old.",
    "start": "2321766",
    "end": "2328650"
  },
  {
    "text": "He didn't know\nthat his invention was of any practical use,\nbeing a mathematician.",
    "start": "2328650",
    "end": "2334340"
  },
  {
    "text": "So he just published that paper. Now in the meantime, this paper\nis like a citation classic. It's cited like, I don't\nknow, 20,000 times.",
    "start": "2334340",
    "end": "2341150"
  },
  {
    "text": "He had no idea. He never looks at citation\nlist, he's a mathematician. So I was working on\nthis problem and--",
    "start": "2341150",
    "end": "2349880"
  },
  {
    "text": " let's see-- let's back up. So this is how he\nusually solves it.",
    "start": "2349880",
    "end": "2356191"
  },
  {
    "text": "Right? We usually solve\nthe problems, the-- splitting, sorry. Just be able to see it. ",
    "start": "2356191",
    "end": "2362720"
  },
  {
    "text": "And we like to solve\nit this way because I can use specialized solvers. I use a transport solver,\nI use a stiff solver here.",
    "start": "2362720",
    "end": "2369290"
  },
  {
    "text": "This one I can\nparallelize because I can do a different ode\nsolution at each finite volume.",
    "start": "2369290",
    "end": "2374902"
  },
  {
    "text": "So if I have a big computer,\na big parallel computer, say I have 10,000 nodes, I can\nsolve 10,000 finite volumes",
    "start": "2374902",
    "end": "2379970"
  },
  {
    "text": "simultaneously in this\nstep, so the CPU time is reduced a lot because\nit parallelizes easily.",
    "start": "2379970",
    "end": "2386060"
  },
  {
    "text": "So this is really popular. This is the main way\nthat people do things. And then in the\nideal case you do it",
    "start": "2386060",
    "end": "2392600"
  },
  {
    "text": "with a certain guess\nof delta t, then you try delta t divided by five. And if you get the same\nresult then you publish it.",
    "start": "2392600",
    "end": "2399686"
  },
  {
    "text": "OK? And you've converged\nyour solution. ",
    "start": "2399686",
    "end": "2406420"
  },
  {
    "start": "2402000",
    "end": "2605000"
  },
  {
    "text": "However, what I found doing this\nis I was trying to find flames.",
    "start": "2406420",
    "end": "2411520"
  },
  {
    "text": "I was trying to calculate\nthe positions of flames. And what I found was that with\nthe delta t's that I would try,",
    "start": "2411520",
    "end": "2418610"
  },
  {
    "text": "sometimes I would get a\nqualitatively different solution depending on\nthe delta t I chose.",
    "start": "2418610",
    "end": "2425750"
  },
  {
    "text": "And so in particular\nwhat I found was that I was\nsolving burner flames. So I have, like, a burner here,\nand it had a flame on top of it",
    "start": "2425750",
    "end": "2434270"
  },
  {
    "text": "like this. And there's two importantly\ndifferent cases. One is where the flame is\nfloating above the burner.",
    "start": "2434270",
    "end": "2441380"
  },
  {
    "text": "And one is where the flame\nkind of goes all the way and touches the metal. And you've probably\nseen both those cases,",
    "start": "2441380",
    "end": "2447275"
  },
  {
    "text": "like a bunsen burner\nor something like that. Sometimes if you get the\nflow rates high enough, the whole thing lift off\nand be floating there.",
    "start": "2447275",
    "end": "2454680"
  },
  {
    "text": "And sometimes if you\nslow the flow rates down they say that they will\nanchor to the metal.",
    "start": "2454680",
    "end": "2460920"
  },
  {
    "text": "Some piece the flame will\nactually touch the metal. Usually it's like\nif you have a--",
    "start": "2460920",
    "end": "2466412"
  },
  {
    "text": "a lot of times you\nhave a case like this. You have like a metal\npiece, metal piece, here's your mixture coming\nin, out here is the air,",
    "start": "2466412",
    "end": "2474990"
  },
  {
    "text": "and a lot of times the\nflame will actually touch this metal piece here. You know, the flame\nsort of looks like that.",
    "start": "2474990",
    "end": "2480630"
  },
  {
    "text": "Have you ever seen\na flame like this? Anyways, this is a common\nthing, anchored-flame. If you just have a slow speed\nburner that's what you get.",
    "start": "2480630",
    "end": "2486684"
  },
  {
    "text": "If you go high\nspeed on the burner you can make the whole\nthing lift up and sort of dance around if you\nlook at the flame. All right?",
    "start": "2486684",
    "end": "2492140"
  },
  {
    "text": "You could probably see\nthe same if you look at a piece of wood burning. If it's burning well the flame\nwill be lifted off the wood,",
    "start": "2492140",
    "end": "2498030"
  },
  {
    "text": "you'll see a gap between\nthe flame and the wood. If it's not burning that well\nyou can see bits of the flame actually touch the\npieces of wood.",
    "start": "2498030",
    "end": "2504870"
  },
  {
    "text": "OK? So that's a very important\nthing for a commission guy. So was really-- to me\nthis is a big deal.",
    "start": "2504870",
    "end": "2510430"
  },
  {
    "text": "So when I solved it with\none choice of delta t I get the solution. When I solved with\nanother choice of delta t",
    "start": "2510430",
    "end": "2516000"
  },
  {
    "text": "I get the solution,\nwith a nice big gap. Now they both can't be right.",
    "start": "2516000",
    "end": "2522194"
  },
  {
    "text": "And so I was a\nlittle bit alarmed because it's like, it's\nreally different, right? So I thought, you\nknow, I didn't really",
    "start": "2522195",
    "end": "2529360"
  },
  {
    "text": "care that much about the\ndynamics of my problem. I just wanted to make sure that\nthe steady state flame I ended",
    "start": "2529360",
    "end": "2534520"
  },
  {
    "text": "up with was the right one. So if you're interested\nin steady state problems this is a really\nimportant thing. You want to make sure that\nyour solution really converges",
    "start": "2534520",
    "end": "2541874"
  },
  {
    "text": "to the true steady state. So what I demonstrated primarily\nis the Strang splitting method is not reliable to\nconverge steady state.",
    "start": "2541874",
    "end": "2548410"
  },
  {
    "text": "Now I believe I made\nthe delta t tiny enough, probably I would converge\nthe [INAUDIBLE] steady state. But I don't know how\ntiny I have to go,",
    "start": "2548410",
    "end": "2554450"
  },
  {
    "text": "and I can't really judge\nmy convergence criteria very well, because at\nsome point of delta t is it suddenly jumps from one\nsolution to another solution",
    "start": "2554450",
    "end": "2561474"
  },
  {
    "text": "that's qualitatively and\ncompletely different. So the convergence is not\nsmooth and continuous, it's like it's converging,\nconverging, converging,",
    "start": "2561474",
    "end": "2568360"
  },
  {
    "text": "jumps to some other solution. And I don't know where\nthe jump happens. And I don't know if\nI keep going further,",
    "start": "2568360",
    "end": "2573460"
  },
  {
    "text": "will it jump to something else? So this makes me very\nloathe to publish the paper. Right? So I don't know.",
    "start": "2573460",
    "end": "2579412"
  },
  {
    "text": "So I was agitated about that. So I start working on trying\nto fix this splitting. The problem was that\nStrang is really smart.",
    "start": "2579412",
    "end": "2585380"
  },
  {
    "text": "So his splitting\nmethod is really good. It's stable, it's\npretty accurate, it's really hard to\nbeat it actually.",
    "start": "2585380",
    "end": "2591430"
  },
  {
    "text": "And so I published the papers\nand they were that good because they really didn't\nreally improve it that much. But then I had a\nreally smart post-doc",
    "start": "2591430",
    "end": "2597783"
  },
  {
    "text": "named Ray Speth, now works\nin the AeroAstro department. And he came up with a\ndifferent way to look at this.",
    "start": "2597783",
    "end": "2604930"
  },
  {
    "text": "And he said, you know, if I\nhad a problem that's like this, I can always add\nsome constant to this",
    "start": "2604930",
    "end": "2613230"
  },
  {
    "start": "2605000",
    "end": "3031000"
  },
  {
    "text": "and subtract the same\nconstant from this, and I'm really getting\nthe same problem.",
    "start": "2613230",
    "end": "2618290"
  },
  {
    "text": "And so now the thing\nis, can I cleverly choose this constant so that,\nfor example, my steady state",
    "start": "2618290",
    "end": "2624670"
  },
  {
    "text": "solution is going to be good? So how to figure out\nwhat constants to choose? And so the methods where\nyou add these constants",
    "start": "2624670",
    "end": "2632710"
  },
  {
    "text": "are called balancing methods. So it's trying to balance the\noperator splitting scheme. And what Ray's method--",
    "start": "2632710",
    "end": "2640970"
  },
  {
    "text": " pretty simple balancing method.",
    "start": "2640970",
    "end": "2647440"
  },
  {
    "text": "So this is called\nsimple balancing. ",
    "start": "2647440",
    "end": "2659490"
  },
  {
    "text": "Let's see if I have a\nslide that shows it. There we go. Here we go. Simple balancing. You choose a c to be the\naverage of your right hand",
    "start": "2659490",
    "end": "2670300"
  },
  {
    "text": "side at the previous time step. OK, now idea here\nis that as you're",
    "start": "2670300",
    "end": "2675940"
  },
  {
    "text": "getting close to a steady\nstate, the previous time step is not going be that much\ndifferent than the current time",
    "start": "2675940",
    "end": "2681375"
  },
  {
    "text": "step. And so this average\nnumber is going to stay more or less study\nas you as you get close. And so what you're really\ndoing is adding the, sort of,",
    "start": "2681375",
    "end": "2695186"
  },
  {
    "text": "the average of these\ntwo guys to each of them from the previous\nstep, and that has the consequence of really\nchanging the solution.",
    "start": "2695186",
    "end": "2701440"
  },
  {
    "text": "So let me just show you. So the left hand side is\nwhat Strang splitting does.",
    "start": "2701440",
    "end": "2706900"
  },
  {
    "start": "2706900",
    "end": "2714049"
  },
  {
    "text": "The blue chips\nare the transport, and the green steps\nare the reaction.",
    "start": "2714050",
    "end": "2720400"
  },
  {
    "text": "And what's happening is I\ndid a half a transport step, then I do a reaction. The reaction sort of jumps\nme off the trajectory,",
    "start": "2720400",
    "end": "2729867"
  },
  {
    "text": "then brings me back\nto the trajectory, then overshoots because I do a\nwhole delta t step of reaction.",
    "start": "2729867",
    "end": "2735829"
  },
  {
    "text": "And then I have to do a\nhalf step of transport back. And so I get from the\nblack-- one black dot",
    "start": "2735830",
    "end": "2741230"
  },
  {
    "text": "is the first point,\nand the other black dot is what I call y final.",
    "start": "2741230",
    "end": "2747170"
  },
  {
    "text": "And that's showing what happens. And it just repeats like\nthat over and over again. And it makes sense. If you're close\nto a steady state,",
    "start": "2747170",
    "end": "2753750"
  },
  {
    "text": "then if I'd just take\none of these terms, without the balancing\ntheta transport,",
    "start": "2753750",
    "end": "2760450"
  },
  {
    "text": "it's going to head\naway from steady state, because at steady state the\ntransport and the reaction are balancing\nagainst each other.",
    "start": "2760450",
    "end": "2766730"
  },
  {
    "text": "Typically you have\nsomething transporting in and is being consumed\nby the reaction. Or something is being\ncreated by reaction",
    "start": "2766730",
    "end": "2772220"
  },
  {
    "text": "and is being transported away. And they have opposite signs. If I only put one in\nthat has a certain sign, then I'm going to move\naway from the steady state.",
    "start": "2772220",
    "end": "2778760"
  },
  {
    "text": "And then I need the other\none to bring it back. And the reason why Strang\nsplitting has trouble is it's doing these\nhuge excursions away",
    "start": "2778760",
    "end": "2785450"
  },
  {
    "text": "from the steady state\nat each time step, with the hope that it ends\nup back at the steady state.",
    "start": "2785450",
    "end": "2791670"
  },
  {
    "text": "Right? That's the way it's\nsupposed to work out. And to second order\nit does, that's because it's pretty\nclever about how it works.",
    "start": "2791670",
    "end": "2797369"
  },
  {
    "text": "But it does it's\ncrazy excursions. Now if you have a\nnon-linear model, the further you do excursions\nfrom the real trajectory",
    "start": "2797370",
    "end": "2804289"
  },
  {
    "text": "the bigger the area you get. So if you do that\nbalance method,",
    "start": "2804290",
    "end": "2811730"
  },
  {
    "text": "you can see what happens is that\nwhen you get to steady state all the steps are just moving\nyou along the steady state",
    "start": "2811730",
    "end": "2818870"
  },
  {
    "text": "trajectory. They're basically\nmaintaining the steady state, and that's because I added--",
    "start": "2818870",
    "end": "2826099"
  },
  {
    "text": "it's like transport\nplus half of transport",
    "start": "2826100",
    "end": "2834510"
  },
  {
    "text": "plus r or something like that. And what is it?",
    "start": "2834510",
    "end": "2841050"
  },
  {
    "text": "There's probably\na minus sign here. And so I'm getting rid\nof half of my transport",
    "start": "2841050",
    "end": "2849420"
  },
  {
    "text": "and I'm adding in half of this. So I changed-- before I\nhad dy/dt is equal to t,",
    "start": "2849420",
    "end": "2860550"
  },
  {
    "text": "but now I have dy/dt\nis equal to 1/2 of t. ",
    "start": "2860550",
    "end": "2872849"
  },
  {
    "text": "I feel I need a\nsign to stick here. ",
    "start": "2872850",
    "end": "2878920"
  },
  {
    "text": "So half of t minus f of\nr, something like that.",
    "start": "2878920",
    "end": "2886020"
  },
  {
    "text": "And the-- this can't be right.",
    "start": "2886020",
    "end": "2892930"
  },
  {
    "text": "I must have a sign. Maybe this is not the\naverage it's a half. ",
    "start": "2892930",
    "end": "2900680"
  },
  {
    "text": "It should be minus. It's like the-- these\nthings should be added, and these guys are\nyou cancelled out,",
    "start": "2900680",
    "end": "2906570"
  },
  {
    "text": "so basically [INAUDIBLE]\nis going to be zero, which it should be\nas a steady state. So I'm sorry, that previous\nslide had the sign wrong.",
    "start": "2906570",
    "end": "2913760"
  },
  {
    "text": "This is what happens\nas the solution. If you do Strang\nsplitting on the left",
    "start": "2913760",
    "end": "2919740"
  },
  {
    "text": "you get more accuracy as you\ncut delta t, but it's only--",
    "start": "2919740",
    "end": "2927927"
  },
  {
    "text": "it's not getting any better. It doesn't matter if\nit's near steady state or away from steady state,\nit treats everything equally,",
    "start": "2927927",
    "end": "2933183"
  },
  {
    "text": "the Strang splitting. In the balance splittings,\nas you get to steady state, all of a sudden the errors\ndrive exponentially.",
    "start": "2933183",
    "end": "2939400"
  },
  {
    "text": "You see this litte\nlogarithm of the error? Logarithmic plot. So you get tremendously\ngreat convergence",
    "start": "2939400",
    "end": "2946510"
  },
  {
    "text": "to the real steady state\nonce you get anywhere close to the steady state.",
    "start": "2946510",
    "end": "2951619"
  },
  {
    "text": "Now the cost of this is that\nbecause the formula, which",
    "start": "2951620",
    "end": "2957980"
  },
  {
    "text": "has a sign mistake I\nthink, it depends on yn, it makes the whole thing\nmore numerically unstable.",
    "start": "2957980",
    "end": "2966369"
  },
  {
    "text": "Because it's like\nan explicit thing. We're using what happened\nat a previous time to correct our equation\nfor future times.",
    "start": "2966370",
    "end": "2972279"
  },
  {
    "text": "And so you are more likely to\nget numerical instabilities. So then Ray invented\nan implicit version of that, and also a\nhigher order method,",
    "start": "2972280",
    "end": "2978536"
  },
  {
    "text": "and that's called\nre-balance splitting. The equation is way\ntoo complicated for me to write down, since I can't\neven write down the minus signs",
    "start": "2978536",
    "end": "2983939"
  },
  {
    "text": "correctly in this one. But you're happy to read\nthe paper, it's in CIAM. And he has the\nequations for that.",
    "start": "2983939",
    "end": "2989340"
  },
  {
    "text": "And when you put the second\norder one in, that's implicit, then the thing is just as\nstable as Strang splitting,",
    "start": "2989340",
    "end": "2995140"
  },
  {
    "text": "but it also has\nthis great property that as you get\nclose to steady state it exponentially converges\nto the solution, which",
    "start": "2995140",
    "end": "3002160"
  },
  {
    "text": "is sort of like how Newton's\nmethod is really so good. It's sort of like that. You get a lot more\ndecimal places really fast",
    "start": "3002160",
    "end": "3009120"
  },
  {
    "text": "once you get close\nto steady state. All right, that's enough. Enjoy Thanksgiving.",
    "start": "3009120",
    "end": "3014730"
  },
  {
    "text": "I posted a bunch of\nreadings and things about metropolis Monte\nCarlo and stochastic stuff",
    "start": "3014730",
    "end": "3020675"
  },
  {
    "text": "that we're talking about next\nweek, and also a little bit more about models versus data. So do the reading\nwhen you get a chance.",
    "start": "3020675",
    "end": "3026880"
  },
  {
    "text": "Say hi to your families,\nsay hi to your friends. Have a nice time. ",
    "start": "3026880",
    "end": "3031758"
  }
]