[
  {
    "start": "0",
    "end": "17290"
  },
  {
    "text": "MICHALE FEE: OK, good\nmorning, everyone. So today, we're going to\ncontinue with our plan",
    "start": "17290",
    "end": "23680"
  },
  {
    "text": "for developing a\npowerful set of tools for analyzing the temporal\nstructure of signals,",
    "start": "23680",
    "end": "30400"
  },
  {
    "text": "in particular a periodic\nstructure and signals. And so this was\nthe outline that we",
    "start": "30400",
    "end": "38020"
  },
  {
    "text": "had for this series\nof three lectures. Last time, we covered Fourier\nseries, complex Fourier series,",
    "start": "38020",
    "end": "44740"
  },
  {
    "text": "and the Fourier transform,\ndiscrete Fourier transform. And we started talking\nabout the power spectrum.",
    "start": "44740",
    "end": "51820"
  },
  {
    "text": "And in that section,\nwe described how you can take any\nfunction and write it as a--",
    "start": "51820",
    "end": "58050"
  },
  {
    "text": "or any periodic\nfunction and write it as a sum of\nsinusoidal component.",
    "start": "58050",
    "end": "64780"
  },
  {
    "text": "So even functions we can write\ndown as a sum of cosines. And odd functions we can\nwrite down as a sum of sines.",
    "start": "64780",
    "end": "72640"
  },
  {
    "text": "Today, we're going to\ncontinue with that. We're going to talk about the\nconvolution theorem, noise",
    "start": "72640",
    "end": "78250"
  },
  {
    "text": "and filtering Shannon-Nyquist\nsampling theorem and spectral estimation. And next time, we're\ngoing to move on",
    "start": "78250",
    "end": "83560"
  },
  {
    "text": "to spectrograms and an important\nidea of windowing and tapering,",
    "start": "83560",
    "end": "90310"
  },
  {
    "text": "time bandwidth product, and\nsome more advanced filtering methods.",
    "start": "90310",
    "end": "96460"
  },
  {
    "text": "So last time, I gave you\nthis little piece of code that allows you to compute\nthe discrete Fourier transform",
    "start": "96460",
    "end": "104260"
  },
  {
    "text": "using this Matlab function FFT. And we talked about how in\norder to do this properly,",
    "start": "104260",
    "end": "113140"
  },
  {
    "text": "you should first\ncircularly shift. You have to take\nthe time series.",
    "start": "113140",
    "end": "119680"
  },
  {
    "text": "And actually, the\nFFT algorithm is expecting the first half of\nthe data in the second half of that data vector.",
    "start": "119680",
    "end": "126580"
  },
  {
    "text": "Don't ask me why. But we just do a circular\nshift, run the FFT.",
    "start": "126580",
    "end": "131650"
  },
  {
    "text": "And then circular shift again\nto get the negative frequencies",
    "start": "131650",
    "end": "137470"
  },
  {
    "text": "in the first half of the vector. And then you can plot\nthe Fourier transform",
    "start": "137470",
    "end": "142870"
  },
  {
    "text": "of your function. This shows an\nexample where we took a cosine as a function of time. At some frequency,\nhere, 20 hertz.",
    "start": "142870",
    "end": "149590"
  },
  {
    "text": "We compute the Fourier\ntransform of that and plot that. So that's what this looks like. Here is a cosine at 20 hertz.",
    "start": "149590",
    "end": "157360"
  },
  {
    "text": "And you can see if you take the\nfast Fourier transform of that, you can see that what\nyou see is the real part",
    "start": "157360",
    "end": "164530"
  },
  {
    "text": "as a function of frequency. It has two peaks, one at plus\n20 hertz, one at minus 20 hertz.",
    "start": "164530",
    "end": "170890"
  },
  {
    "text": "And the imaginary part is 0. So we have two peaks. One produces a\ncomplex exponential",
    "start": "170890",
    "end": "178810"
  },
  {
    "text": "that goes around the unit\ncircle like this at 20 hertz. The other peak produces\na complex exponential",
    "start": "178810",
    "end": "185560"
  },
  {
    "text": "that goes around the\nother way at 20 hertz. The imaginary parts\ncancel and leave you",
    "start": "185560",
    "end": "191260"
  },
  {
    "text": "with a real part that goes\nback and forth at 20 hertz OK? So that's what those\ntwo peaks are doing.",
    "start": "191260",
    "end": "199560"
  },
  {
    "text": "Here is the Fourier transform\nof a sine wave at 20 hertz.",
    "start": "199560",
    "end": "206130"
  },
  {
    "text": "This is phase shifted so the\ncosine is a symmetric function or an even function.",
    "start": "206130",
    "end": "211740"
  },
  {
    "text": "The sine is an odd function. And you can see\nthat in this case, the Fourier transform\nagain has two peaks.",
    "start": "211740",
    "end": "217770"
  },
  {
    "text": "In this case, the\nreal part is 0. And the two peaks are\nin the imaginary part.",
    "start": "217770",
    "end": "223730"
  },
  {
    "text": "The one at plus 20\nhertz is minus I. And the one at minus\n20 hertz is plus I.",
    "start": "223730",
    "end": "230670"
  },
  {
    "text": "Now, the interesting\nthing here, the key thing, is that when you\ntake the Fourier",
    "start": "230670",
    "end": "236010"
  },
  {
    "text": "transform of a function,\nsymmetric functions, even functions, are always real.",
    "start": "236010",
    "end": "243390"
  },
  {
    "text": "The Fourier transform of even\nfunctions is always real. The Fourier transform,\nif you will,",
    "start": "243390",
    "end": "248760"
  },
  {
    "text": "the Fourier series\nof the even part of the function into the real\npart of the Fourier transform",
    "start": "248760",
    "end": "255769"
  },
  {
    "text": "and the Fourier\nseries of the odd part of the function into the\nimaginary part of the Fourier",
    "start": "255770",
    "end": "262320"
  },
  {
    "text": "transform. OK?  Now, we introduced the idea of\na power spectrum, where we just",
    "start": "262320",
    "end": "271100"
  },
  {
    "text": "take the Fourier transform. And we take the square magnitude\nof that Fourier transform.",
    "start": "271100",
    "end": "276380"
  },
  {
    "text": "And you can see that the power\nspectrum of the sine and cosine function is just a single peak\nat the frequency of the sine",
    "start": "276380",
    "end": "282350"
  },
  {
    "text": "or cosine. OK? And you can see why that is\nbecause the sine and cosine",
    "start": "282350",
    "end": "290180"
  },
  {
    "text": "have a peak at plus 20 hertz. For the cosine, it's real.",
    "start": "290180",
    "end": "296099"
  },
  {
    "text": "And for the sine,\nit's imaginary. But the square magnitude\nof both of those",
    "start": "296100",
    "end": "301130"
  },
  {
    "text": "is 1 at that frequency. OK, any questions about that? Feel like I didn't say\nthat quite as clearly",
    "start": "301130",
    "end": "307490"
  },
  {
    "text": "as I could have? OK. So any questions about this?",
    "start": "307490",
    "end": "313889"
  },
  {
    "text": "OK, let's take a look\nat another function that we've been talking\nabout, a square wave.",
    "start": "313890",
    "end": "320370"
  },
  {
    "text": "In this case, you can see that\nthe square wave is symmetric or even.",
    "start": "320370",
    "end": "326069"
  },
  {
    "text": "And you can see that the Fourier\ntransform of that is all real. The peaks are in the real\npart of the Fourier transform.",
    "start": "326070",
    "end": "333330"
  },
  {
    "text": "You can see the imaginary\npart in red is 0 everywhere. And you can see that the\nFourier transform of this",
    "start": "333330",
    "end": "338669"
  },
  {
    "text": "has multiple peaks\nat intervals that",
    "start": "338670",
    "end": "344400"
  },
  {
    "text": "are again equal to the\nfrequency of this square wave. OK?",
    "start": "344400",
    "end": "350050"
  },
  {
    "text": "If you look at the power\nspectrum of the square wave, you can see again it's\ngot multiple peaks",
    "start": "350050",
    "end": "355870"
  },
  {
    "text": "at regular intervals. One thing that you\noften find when",
    "start": "355870",
    "end": "361870"
  },
  {
    "text": "you look at power\nspectra of functions is that some of the peaks are\nvery low amplitude or very low",
    "start": "361870",
    "end": "369759"
  },
  {
    "text": "power. So one of the\nthings that we often do when we're\nplotting power spectra",
    "start": "369760",
    "end": "375610"
  },
  {
    "text": "is to plot not power\nhere but log power. OK? And so we plot power\nin log base 10.",
    "start": "375610",
    "end": "385849"
  },
  {
    "text": "A difference of an order\nof magnitude in two peaks",
    "start": "385850",
    "end": "391990"
  },
  {
    "text": "corresponds to a unit\ncalled a bel, b-e-l. ",
    "start": "391990",
    "end": "399095"
  },
  {
    "text": "So 1 bel corresponds to a factor\nof 10 difference in power.",
    "start": "399096",
    "end": "405010"
  },
  {
    "text": "So you can see this peak\nhere is about 1 bel lower than that peak, right?",
    "start": "405010",
    "end": "411180"
  },
  {
    "text": "And more commonly used\nunit is called decibels, which are 10 decibels per bel.",
    "start": "411180",
    "end": "419490"
  },
  {
    "text": "So decibels are given\nby 10 times the log",
    "start": "419490",
    "end": "425250"
  },
  {
    "text": "base 10 of the power of the\nsquare magnitude of the Fourier",
    "start": "425250",
    "end": "430380"
  },
  {
    "text": "transform. Does that make sense. Yes. AUDIENCE: So [INAUDIBLE]\nsquare magnitude [INAUDIBLE]",
    "start": "430380",
    "end": "438160"
  },
  {
    "text": "so just like [INAUDIBLE] MICHALE FEE: No, so you take\nthis square magnitude because--",
    "start": "438160",
    "end": "444350"
  },
  {
    "text": "OK, remember, last time\nwe talked about power. So if you have an electrical\nsignal, the power in the signal",
    "start": "444350",
    "end": "451080"
  },
  {
    "text": "would be voltage\nsquared over resistance. ",
    "start": "451080",
    "end": "456270"
  },
  {
    "text": "Power, when you\nrefer to signals, is often kind of used\nsynonymously with variance.",
    "start": "456270",
    "end": "462180"
  },
  {
    "text": "And variance is also goes\nas the square of the signal. Now, because the\nFourier transform",
    "start": "462180",
    "end": "467820"
  },
  {
    "text": "is a complex number, what we\ndo is we don't just square it, but we take the\nsquared magnitude.",
    "start": "467820",
    "end": "473880"
  },
  {
    "text": "So we're measuring the\ndistance from the origin in the complex plane.",
    "start": "473880",
    "end": "479078"
  },
  {
    "text": "OK? Good question. All right, any questions\nabout this and what",
    "start": "479079",
    "end": "485460"
  },
  {
    "text": "the meaning of decibels is? So if a signal had 10\ntimes as much amplitude,",
    "start": "485460",
    "end": "496660"
  },
  {
    "text": "the power would be\nhow much larger? ",
    "start": "496660",
    "end": "503512"
  },
  {
    "text": "If you had 10 times\nas much amplitude, how much increased\npower would there be?",
    "start": "503512",
    "end": "511729"
  },
  {
    "text": "100 times. Which is how many bels? Log base 10 of 100 is 2.",
    "start": "511730",
    "end": "517870"
  },
  {
    "text": "How many decibels? AUDIENCE: 22? MICHALE FEE: No, it's\n10 decibels per bel.",
    "start": "517870",
    "end": "524610"
  },
  {
    "text": "Deci just means a\ntenth of, right? Remember those units?",
    "start": "524610",
    "end": "531589"
  },
  {
    "text": "So a factor of 10 in\nsignal is a factor of 100 in power, which is 2 bels,\nwhich is 20 decibels.",
    "start": "531590",
    "end": "539645"
  },
  {
    "text": " OK.",
    "start": "539645",
    "end": "544910"
  },
  {
    "text": " All right, now I just want to\nshow you one important thing",
    "start": "544910",
    "end": "551560"
  },
  {
    "text": "about Fourier transforms. There's an interesting\nproperty about scaling",
    "start": "551560",
    "end": "557350"
  },
  {
    "text": "in time and frequency. So if you have a signal like\nthis that's periodic at about--",
    "start": "557350",
    "end": "563672"
  },
  {
    "text": "I don't know, it looks like-- OK, there it is-- about 5 hertz. If you look at the\nFourier transform of that,",
    "start": "563672",
    "end": "569080"
  },
  {
    "text": "you can see a series of peaks,\nbecause it's a periodic signal.",
    "start": "569080",
    "end": "574120"
  },
  {
    "text": "Now, if you take\nthat same function and you make it go faster--",
    "start": "574120",
    "end": "581080"
  },
  {
    "text": "so now, it's at about 10\nhertz, instead of 5 hertz, you can see that the Fourier\ntransform is exactly the same.",
    "start": "581080",
    "end": "588930"
  },
  {
    "text": "It's just scaled out. So the faster something moves\nin time, the more stretched",
    "start": "588930",
    "end": "595670"
  },
  {
    "text": "out the frequencies are. Does that makes sense. So if I show you any periodic\nfunction at one frequency",
    "start": "595670",
    "end": "603769"
  },
  {
    "text": "and I show you the\nFourier transform of it, you can immediately write\ndown the Fourier transform",
    "start": "603770",
    "end": "609380"
  },
  {
    "text": "of any scaled version\nof that function, because if this goes faster,\nif this same function but",
    "start": "609380",
    "end": "618610"
  },
  {
    "text": "at a higher frequency, you\ncan write down the Fourier transform just by taking\nthis Fourier transform",
    "start": "618610",
    "end": "623889"
  },
  {
    "text": "and stretching it out\nby that same factor. OK? ",
    "start": "623890",
    "end": "631440"
  },
  {
    "text": "All right, so that was\njust a brief review of what we covered last time.",
    "start": "631440",
    "end": "637270"
  },
  {
    "text": "And here's what we're\ngoing to cover today in a little more detail. So we're going to talk some\nmore about the idea of Fourier",
    "start": "637270",
    "end": "645000"
  },
  {
    "text": "transform pairs. These are functions where\nyou have a function. You take the Fourier\ntransform of it.",
    "start": "645000",
    "end": "652102"
  },
  {
    "text": "You get a different function. If you take the Fourier\ntransform of that, you go back to the\noriginal function.",
    "start": "652102",
    "end": "657670"
  },
  {
    "text": "OK, so there are pairs of\nfunctions that are essentially for transforms of each other. OK?",
    "start": "657670",
    "end": "663160"
  },
  {
    "text": "An example of that you saw here. A square wave like this\nhas a Fourier transform",
    "start": "663160",
    "end": "668220"
  },
  {
    "text": "that's this funny\nfunction a set of peaks. If you take the four\ntransform of that, you would get this square wave.",
    "start": "668220",
    "end": "675320"
  },
  {
    "text": "OK?  We're going to talk about the\nconvolution theorem, which",
    "start": "675320",
    "end": "680700"
  },
  {
    "text": "is a really cool theorem. Convolution in the time domain\nlooks like multiplication in the frequency domain.",
    "start": "680700",
    "end": "686790"
  },
  {
    "text": "Multiplication in\nthe time domain looks like convolution\nin the frequency domain. And it allows you to take a\nset of Fourier transform pairs",
    "start": "686790",
    "end": "697899"
  },
  {
    "text": "that you know, that we'll\nlearn, and figure out what the Fourier transform is\nof any function that's either",
    "start": "697900",
    "end": "706080"
  },
  {
    "text": "a product of those or a\nconvolution of those kind of base functions. It's a very powerful theorem.",
    "start": "706080",
    "end": "714768"
  },
  {
    "text": "We're going to talk\nabout the Fourier transform a Gaussian noise and\nthis power spectrum of Gaussian",
    "start": "714768",
    "end": "719950"
  },
  {
    "text": "noise. We'll talk about how to\ndo spectral estimation. And we'll end up on the\nShannon-Nyquist theorem",
    "start": "719950",
    "end": "728040"
  },
  {
    "text": "and zero padding. And there may be, if\nthere's time at the end, I'll talk about a little\ntrick for removing the line",
    "start": "728040",
    "end": "734160"
  },
  {
    "text": "noise from signals. OK, so let's start with\nFourier transform pairs.",
    "start": "734160",
    "end": "740250"
  },
  {
    "text": "So one of the most\nimportant functions to know the Fourier transform\nof is a square pulse like this.",
    "start": "740250",
    "end": "748260"
  },
  {
    "text": "So let's just take\na function of time. It's 0 everywhere, 0 everywhere.",
    "start": "748260",
    "end": "753540"
  },
  {
    "text": "But it's 1 if the time is\nwithin the interval plus delta",
    "start": "753540",
    "end": "758670"
  },
  {
    "text": "t over 2 to minus\ndelta t over 2, OK, so a square pulse like that.",
    "start": "758670",
    "end": "763730"
  },
  {
    "text": "And let's just\ntake the case where delta t is 100 milliseconds. ",
    "start": "763730",
    "end": "770984"
  },
  {
    "text": "The Fourier transform\nof a square pulse is a function called\nthe sinc function.",
    "start": "770984",
    "end": "776629"
  },
  {
    "text": "It looks a little bit messy. But it's basically\na sine wave that",
    "start": "776630",
    "end": "783769"
  },
  {
    "text": "is weighted so that\nit's big in the middle and it decreases as\nyou move away from 0.",
    "start": "783770",
    "end": "790130"
  },
  {
    "text": "And it decreases as 1/f.  So this is frequency\nalong this axis.",
    "start": "790130",
    "end": "797579"
  },
  {
    "text": "It's just imagine that\nyou have a sine wave that gets smaller as you go away\nfrom the origin by an amount 1",
    "start": "797580",
    "end": "803940"
  },
  {
    "text": "over f. That's all it is. ",
    "start": "803940",
    "end": "809009"
  },
  {
    "text": "Now, really important\nconcept here, remember, we talked about how you can\ntake a function of time.",
    "start": "809010",
    "end": "817820"
  },
  {
    "text": "So once you know that\nthe Fourier transform of a square wave, of this square\nwave of with 100 milliseconds,",
    "start": "817820",
    "end": "823839"
  },
  {
    "text": "is a sinc function. You know what the\nFourier transform is of a square\npulse that's longer.",
    "start": "823840",
    "end": "832209"
  },
  {
    "text": "Right? What is it? ",
    "start": "832210",
    "end": "837709"
  },
  {
    "text": "Remember, if you just\ntake a function in time and you stretch it out,\nthe Fourier transform just does what?",
    "start": "837710",
    "end": "845290"
  },
  {
    "text": "It compresses. It shrinks. And if you take this pulse and\nyou make it narrower in time,",
    "start": "845290",
    "end": "850449"
  },
  {
    "text": "then the Fourier transform\njust stretches out. So if we take that\npulse and we make",
    "start": "850450",
    "end": "855940"
  },
  {
    "text": "it narrower, 25\nmilliseconds, then you can see that\nthe sinc function,",
    "start": "855940",
    "end": "863060"
  },
  {
    "text": "it's the same sinc function,\nbut it's just stretched out in the frequency domain.",
    "start": "863060",
    "end": "868720"
  },
  {
    "text": " So you can see that here\nif it's 10 milliseconds,",
    "start": "868720",
    "end": "874930"
  },
  {
    "text": "the width of this is 12 hertz. The full width at half max\nof that peak is 12 hertz.",
    "start": "874930",
    "end": "880240"
  },
  {
    "text": "If this is 4 times\nnarrower, then this width",
    "start": "880240",
    "end": "885339"
  },
  {
    "text": "will be 4 times wider. What happens if we\nhave a pulse here that",
    "start": "885340",
    "end": "891040"
  },
  {
    "text": "is 500 milliseconds longer? So 5 times longer, what's the\nwidth of the sinc function",
    "start": "891040",
    "end": "898930"
  },
  {
    "text": "here going to be?  It'll be five times\nnarrower than this,",
    "start": "898930",
    "end": "907000"
  },
  {
    "text": "so a little over 2 hertz. OK? Does that makes sense.",
    "start": "907000",
    "end": "913860"
  },
  {
    "text": "So you should\nremember this Fourier transform pair, a square\npulse and a sinc function.",
    "start": "913860",
    "end": "921420"
  },
  {
    "start": "921420",
    "end": "927220"
  },
  {
    "text": "And there's a very important\nconcept called the time bandwidth product.",
    "start": "927220",
    "end": "932850"
  },
  {
    "text": "You can see that as you make\nthe width in time narrower,",
    "start": "932850",
    "end": "938610"
  },
  {
    "text": "the bandwidth in\nfrequency gets bigger.",
    "start": "938610",
    "end": "943700"
  },
  {
    "text": "And as you make the\npulse in time longer, the bandwidth gets smaller.",
    "start": "943700",
    "end": "948890"
  },
  {
    "text": "And it turns out that the\nproduct of the width in time and the width in frequency\nis just a constant.",
    "start": "948890",
    "end": "957639"
  },
  {
    "text": "And for this square pulse sinc\nfunction, that constant is 1.2.",
    "start": "957640",
    "end": "966450"
  },
  {
    "text": "So there's a limit. If you make the\nsquare pulse smaller,",
    "start": "966450",
    "end": "973810"
  },
  {
    "text": "the sinc function gets broader. All right, let's look at a\ndifferent Fourier transform",
    "start": "973810",
    "end": "979180"
  },
  {
    "text": "pair. It turns out that the Fourier\ntransform of a Gaussian",
    "start": "979180",
    "end": "984537"
  },
  {
    "text": "is just a Gaussian. ",
    "start": "984538",
    "end": "993940"
  },
  {
    "text": "So, here, this Gaussian pulse\nis 50 milliseconds long. The Fourier transform of\nthat is a Gaussian pulse",
    "start": "993940",
    "end": "1002100"
  },
  {
    "text": "that's 20 hertz wide. If I make that Gaussian\npulses in time narrower,",
    "start": "1002100",
    "end": "1008160"
  },
  {
    "text": "then the Gaussian in\nfrequency gets wider. And inversely, if I make\nthe pulse in time wider,",
    "start": "1008160",
    "end": "1016800"
  },
  {
    "text": "then the Gaussian in\nfrequency space gets narrower. Yes.",
    "start": "1016800",
    "end": "1022422"
  },
  {
    "text": "AUDIENCE: I just have\na question [INAUDIBLE] MICHALE FEE: Yes. AUDIENCE: [INAUDIBLE]",
    "start": "1022422",
    "end": "1029180"
  },
  {
    "text": "MICHALE FEE: Yep. So I'm trying-- it's a\nlittle bit unclear here, but I'm measuring these\nwidths at the half height.",
    "start": "1029180",
    "end": "1035849"
  },
  {
    "text": " OK, and so you can see that for\na Gaussian, this time bandwidth",
    "start": "1035849",
    "end": "1044560"
  },
  {
    "text": "product, delta f times\ndelta t is just 1. ",
    "start": "1044560",
    "end": "1051320"
  },
  {
    "text": "So there's a time\nbandwidth product of 1. ",
    "start": "1051320",
    "end": "1059690"
  },
  {
    "text": "Who here has taken\nany quantum mechanics? Who here has heard of the\nHeisenberg uncertainty",
    "start": "1059690",
    "end": "1065659"
  },
  {
    "text": "principle? Yeah. This is just the Heisenberg\nuncertainty principle.",
    "start": "1065660",
    "end": "1071360"
  },
  {
    "text": "This is where the\nHeisenberg uncertainty principle comes from, because\nwave functions are just--",
    "start": "1071360",
    "end": "1078640"
  },
  {
    "text": "you can think of wave functions\nas just functions in time. OK?",
    "start": "1078640",
    "end": "1084250"
  },
  {
    "text": "So the spatial localization\nof an object is some--",
    "start": "1084250",
    "end": "1089780"
  },
  {
    "text": "the wave function is just\nsome position of space. ",
    "start": "1089780",
    "end": "1095160"
  },
  {
    "text": "And the momentum\nof that particle can be computed as the Fourier\ntransform of the wave function.",
    "start": "1095160",
    "end": "1104530"
  },
  {
    "text": "And so if the\nparticle is more lo-- [AUDIO OUT] in space, then\nif you compute the Fourier",
    "start": "1104530",
    "end": "1112820"
  },
  {
    "text": "transform of that\nwave function, it's more dispersed in momentum. OK, so the uncertainty\nin momentum is larger.",
    "start": "1112820",
    "end": "1120390"
  },
  {
    "text": "So this concept of\ntime bandwidth product in the physical world is\nwhat gives us the Heisenberg",
    "start": "1120390",
    "end": "1126799"
  },
  {
    "text": "uncertainty principle. It's very cool. Actually, before I go on, you\ncan see that in this case,",
    "start": "1126800",
    "end": "1133690"
  },
  {
    "text": "the Fourier transform of this\nfunction is the same function. Does anyone remember what\na [AUDIO OUT] function",
    "start": "1133690",
    "end": "1139840"
  },
  {
    "text": "is that the Fourier\ntransform of it is another version of\nthat same function?",
    "start": "1139840",
    "end": "1145450"
  },
  {
    "text": "We talked about it last time. AUDIENCE: Pulse train. MICHALE FEE: Pulse\ntrain, that's right.",
    "start": "1145450",
    "end": "1151610"
  },
  {
    "text": "So a train of delta functions\nhas a Fourier transform that's just a train\nof delta functions.",
    "start": "1151610",
    "end": "1157790"
  },
  {
    "text": "And 1 over spacing\nin the time domain is just equal to 1 over the\nspacing in the frequency",
    "start": "1157790",
    "end": "1163715"
  },
  {
    "text": "domain. So that's another\nFourier transform pair",
    "start": "1163715",
    "end": "1169270"
  },
  {
    "text": "that you should remember. All right?",
    "start": "1169270",
    "end": "1174810"
  },
  {
    "text": "OK, convolution theorem. Imagine that we have three\nfunctions of time, y of t,",
    "start": "1174810",
    "end": "1185490"
  },
  {
    "text": "like this one, y of t. We could calculate the\nFourier transform of that.",
    "start": "1185490",
    "end": "1190580"
  },
  {
    "text": "And that's capital Y of omega. And then we have some\nother function, x of t,",
    "start": "1190580",
    "end": "1196650"
  },
  {
    "text": "And its Fourier\ntransform, X of omega, and another function g of tau\nand its Fourier transform,",
    "start": "1196650",
    "end": "1204210"
  },
  {
    "text": "capital G of omega. So remember, we can write down\nthe convolution of this time",
    "start": "1204210",
    "end": "1210779"
  },
  {
    "text": "series, x with this\nkernel g as follows.",
    "start": "1210780",
    "end": "1216130"
  },
  {
    "text": "So in this case,\nwe're defining y as the convolution of g with x. So y of t equals this integral\nd tau g of tau x of t minus tau,",
    "start": "1216130",
    "end": "1227640"
  },
  {
    "text": "integrating over all tau. So that's a convolution.",
    "start": "1227640",
    "end": "1234110"
  },
  {
    "text": "The convolution theorem tells us\nthat the Fourier transform of y",
    "start": "1234110",
    "end": "1241350"
  },
  {
    "text": "is just the product of\nthe Fourier transform of g and the Fourier transform of x.",
    "start": "1241350",
    "end": "1247200"
  },
  {
    "text": " So that, you should remember.",
    "start": "1247200",
    "end": "1253620"
  },
  {
    "text": "All right? I'm going to walk you\nthrough how you derive that. I don't expect you to\nbe able to derive it.",
    "start": "1253620",
    "end": "1259860"
  },
  {
    "text": "But the derivation is kind\nof cute, and I enjoyed it. So I thought I'd\nshow you how it goes.",
    "start": "1259860",
    "end": "1266210"
  },
  {
    "text": "So here's the definition\nof the convolution. What we're going to do is\nwe're going to just take",
    "start": "1266210",
    "end": "1271370"
  },
  {
    "text": "the Fourier transform of y. So here's how you calculate\nFourier transform of something.",
    "start": "1271370",
    "end": "1276620"
  },
  {
    "text": "Capital Y of omega is just the\nintegral over all time dt y",
    "start": "1276620",
    "end": "1283690"
  },
  {
    "text": "of t e to the minus i omega t. So we're going to\nsubstitute this into here.",
    "start": "1283690",
    "end": "1291580"
  },
  {
    "text": "Now, you can see that-- OK, so the first [AUDIO OUT]\nis actually reverse the order of integration.",
    "start": "1291580",
    "end": "1296929"
  },
  {
    "text": "We're going to integrate\nover t first rather than tau. Then what we're\ngoing to do is we",
    "start": "1296930",
    "end": "1302559"
  },
  {
    "text": "can move the g\noutside the integral over t, because it's\njust a function of tau. So we pull that out.",
    "start": "1302560",
    "end": "1310720"
  },
  {
    "text": "So now, we have an integral\ndt x of t minus tau e to the minus i omega t.",
    "start": "1310720",
    "end": "1317770"
  },
  {
    "text": "And what we can do is do a\nlittle modification here. We're going to pull an e to the\nminus i omega tau out of here.",
    "start": "1317770",
    "end": "1328140"
  },
  {
    "text": "So we have e to\nthe minus i omega tau times e to the minus\nj omega t minus tau.",
    "start": "1328140",
    "end": "1333955"
  },
  {
    "text": "So you can say if you multiply\nthose two things together, you just get back to that. ",
    "start": "1333955",
    "end": "1342880"
  },
  {
    "text": "Now, what we're going\nto do is because this is we're integrating over t, but\n[AUDIO OUT] a function of tau,",
    "start": "1342880",
    "end": "1348640"
  },
  {
    "text": "we can pull that\nout of the integral. And now we have integral\ndt x t minus tau",
    "start": "1348640",
    "end": "1355720"
  },
  {
    "text": "e to the minus i\nomega t minus tau. And what do you think that is? What is that?",
    "start": "1355720",
    "end": "1362170"
  },
  {
    "text": "What would it be if\nthere were no tau there? If you just cross that out\nand that, what would that be?",
    "start": "1362170",
    "end": "1370750"
  },
  {
    "text": "Anybody know? What that's? AUDIENCE: The Fourier transform. MICHALE FEE: This is just\nthe Fourier transform of x.",
    "start": "1370750",
    "end": "1379139"
  },
  {
    "text": "Right? And we're integrating from\nminus infinity to infinity. So it does it matter if we're\nshifting the inside by tau?",
    "start": "1379140",
    "end": "1387130"
  },
  {
    "text": "No, it doesn't\nchange the answer. We're integrating from\nminus infinity to infinity. So shifting the inside of\nit by a small amount tau",
    "start": "1387130",
    "end": "1394330"
  },
  {
    "text": "isn't going to do anything. So that's just the\nFourier transform of x.",
    "start": "1394330",
    "end": "1400770"
  },
  {
    "text": "Good? And what is this? Fourier transform of g.",
    "start": "1400770",
    "end": "1406890"
  },
  {
    "text": "So the Fourier transform of y\nis just Fourier transform of g",
    "start": "1406890",
    "end": "1411910"
  },
  {
    "text": "times the Fourier\ntransform of x. All right, that's pretty cool. Kind of cute. But it's also really powerful.",
    "start": "1411910",
    "end": "1418940"
  },
  {
    "text": "OK, so let me show you\nwhat you can do with that. First, let me just\npoint out one thing",
    "start": "1418940",
    "end": "1424810"
  },
  {
    "text": "that there is a\nconvolution theorem that relates convolution\nin the time domain to multiplication in\nthe frequency domain.",
    "start": "1424810",
    "end": "1432460"
  },
  {
    "text": "You can do exactly\nthe same derivation and show that convolution of\ntwo functions in the frequency",
    "start": "1432460",
    "end": "1441810"
  },
  {
    "text": "domain is the same as\nmultiplication in the time domain.",
    "start": "1441810",
    "end": "1447480"
  },
  {
    "text": "So that's the\nconvolution theorem. ",
    "start": "1447480",
    "end": "1452570"
  },
  {
    "text": "So let's see why\nthat's so powerful. So I just showed you the\nFourier transform of a Gaussian.",
    "start": "1452570",
    "end": "1461583"
  },
  {
    "text": "So what we're going\nto do is we're going to calculate transform of\na Gaussian times a sine wave.",
    "start": "1461583",
    "end": "1468830"
  },
  {
    "text": "So if you take a\nGaussian, some window centered around 0\nin time-- this is a function of time now right?",
    "start": "1468830",
    "end": "1474970"
  },
  {
    "text": "So there's a little\nGaussian pulse in time. We're going to multiply\nthat by this sine wave. And when you multiply\nthose together,",
    "start": "1474970",
    "end": "1480650"
  },
  {
    "text": "you get this little\npulse of sine.",
    "start": "1480650",
    "end": "1487330"
  },
  {
    "text": "OK? [WHISTLES] Sorry,\nconstant frequency. Boy, that's harder\nto do than I thought.",
    "start": "1487330",
    "end": "1492760"
  },
  {
    "text": "[WHISTLES] OK, just a\nlittle pulse of sine wave. So what's the forehead\ntransform of that?",
    "start": "1492760",
    "end": "1498130"
  },
  {
    "text": "Well, we don't know, right? We didn't calculate it. But you can actually\njust figure it out very",
    "start": "1498130",
    "end": "1503770"
  },
  {
    "text": "simply, because you\nknow the Fourier transform of a Gaussian. What is that? A Gaussian.",
    "start": "1503770",
    "end": "1509880"
  },
  {
    "text": "You know the Fourier\ntransform of a sine wave. What is that? ",
    "start": "1509880",
    "end": "1515190"
  },
  {
    "text": "Yeah. Hold it up for me. What does it look like?",
    "start": "1515190",
    "end": "1520210"
  },
  {
    "text": "Yes, sine wave,\nthank you, like this. OK. And so what do you know--",
    "start": "1520210",
    "end": "1525930"
  },
  {
    "text": "what can you tell me right\naway what the Fourier transform of this is?",
    "start": "1525930",
    "end": "1531330"
  },
  {
    "text": "You take the Fourier\ntransform of that and can involve it with the\nFourier transform of that.",
    "start": "1531330",
    "end": "1536500"
  },
  {
    "text": "So let's do that. So there's the Fourier\ntransform of this Gaussian. If this is 200 milliseconds\nwide, then how wide is this?",
    "start": "1536500",
    "end": "1548589"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] MICHALE FEE: It's 1 over 200\nmilliseconds, which is what? 5 hertz, right?",
    "start": "1548589",
    "end": "1554760"
  },
  {
    "text": "1 over 0.2 is 5. The Fourier transform\nof this sine wave--",
    "start": "1554760",
    "end": "1561610"
  },
  {
    "text": "and I think I made it a\ncosine instead of a sine. Sorry, that's why I\nwas going like this, and you were going like this.",
    "start": "1561610",
    "end": "1567680"
  },
  {
    "text": "So I made it a cosine function. The Fourier transform of the\ncosine function has two peaks.",
    "start": "1567680",
    "end": "1573820"
  },
  {
    "text": "This is 20 hertz. So one peak at 20,\none at minus 20. And the Fourier\ntransform of this",
    "start": "1573820",
    "end": "1580320"
  },
  {
    "text": "is just the convolution\nof this with that. You take this Gaussian and you\nslide it over those two peaks.",
    "start": "1580320",
    "end": "1591820"
  },
  {
    "text": "You essentially\nsmooth this with that.",
    "start": "1591820",
    "end": "1597575"
  },
  {
    "text": "Does that makes sense? ",
    "start": "1597576",
    "end": "1604370"
  },
  {
    "text": "Cool. So you didn't actually have\nto stick this into Matlab and compute the Fourier\ntransform of that.",
    "start": "1604370",
    "end": "1611320"
  },
  {
    "text": "You can just know in\nyour head that that's the product of a Gaussian\nand a sine wave, or cosine.",
    "start": "1611320",
    "end": "1618680"
  },
  {
    "text": "And therefore, the\nFourier transform of that is the convolution of a\nGaussian with these two peaks. ",
    "start": "1618680",
    "end": "1626440"
  },
  {
    "text": "And there are\nmany, many examples of interesting and useful\nfunctions in the time domain",
    "start": "1626440",
    "end": "1634000"
  },
  {
    "text": "that you can\nintuitively understand what their Fourier transform\nis just by having this idea.",
    "start": "1634000",
    "end": "1641920"
  },
  {
    "text": "It's very powerful. Here's another example. We're going to\ncalculate the Fourier",
    "start": "1641920",
    "end": "1647110"
  },
  {
    "text": "transform of this square\nwindowed cosine function.",
    "start": "1647110",
    "end": "1654330"
  },
  {
    "text": "So it's a product of the\nsquare pulse with this cosine",
    "start": "1654330",
    "end": "1660130"
  },
  {
    "text": "to give this. So what is the Fourier\ntransform of this. What is that? ",
    "start": "1660130",
    "end": "1666470"
  },
  {
    "text": "So what is the Fourier\ntransform of that? AUDIENCE: The sinc function. MICHALE FEE: It's\nthe sync function. It's that kind of\nwiggly, peaky thing.",
    "start": "1666470",
    "end": "1674309"
  },
  {
    "text": "And the Fourier transform\nof that is just two peaks. And so the Fourier transform of\nthis is just like two peaks--",
    "start": "1674310",
    "end": "1682370"
  },
  {
    "text": "yeah-- with wiggly\nstuff around them. That's exactly right.",
    "start": "1682370",
    "end": "1687629"
  },
  {
    "text": "All right, any\nquestions about that? OK. All right, change\nof topic, let's",
    "start": "1687630",
    "end": "1693380"
  },
  {
    "text": "talk about Gaussian noise. The Fourier transform of\nnoise and the power spectrum",
    "start": "1693380",
    "end": "1700640"
  },
  {
    "text": "of noise. And we're going to\neventually bring all these things back together. OK?",
    "start": "1700640",
    "end": "1705980"
  },
  {
    "text": "All right, so what\nis Gaussian noise? So first of all, Gaussian\nnoise is a signal",
    "start": "1705980",
    "end": "1713360"
  },
  {
    "text": "in which the value at each\ntime is randomly sampled from a Gaussian distribution.",
    "start": "1713360",
    "end": "1719630"
  },
  {
    "text": "So you can do that in Matlab. That's a very simple function. This returns a\nvector of length N,",
    "start": "1719630",
    "end": "1725600"
  },
  {
    "text": "sampled from a normal\ndistribution, with variance 1.",
    "start": "1725600",
    "end": "1731580"
  },
  {
    "text": "So here's what that sounds like. ",
    "start": "1731580",
    "end": "1738854"
  },
  {
    "text": "[STATIC NOISE]\nSounds noisy, right?",
    "start": "1738854",
    "end": "1745220"
  },
  {
    "text": "OK, I just wanted to show\nyou what the autocorrelation function of this looks like,\nwhich I think we saw before.",
    "start": "1745220",
    "end": "1752429"
  },
  {
    "text": "So if you look at the\ndistribution of all the samples, it just\ngives you a distribution",
    "start": "1752430",
    "end": "1757950"
  },
  {
    "text": "that it has the\nshape of a Gaussian. And the standard deviation\nof that Gaussian is 1.",
    "start": "1757950",
    "end": "1767520"
  },
  {
    "text": "Now, what if you\nplot the correlation",
    "start": "1767520",
    "end": "1774640"
  },
  {
    "text": "between the value of value\nof this function at time t",
    "start": "1774640",
    "end": "1779800"
  },
  {
    "text": "and time t plus 1? Is there any relation\nbetween the value",
    "start": "1779800",
    "end": "1785440"
  },
  {
    "text": "of this function at any time\nt and another time t plus 1? So they're completely\nuncorrelated with each other.",
    "start": "1785440",
    "end": "1792970"
  },
  {
    "text": "The value of time t is\nuncorrelated with the value of time t plus 1. So there's zero correlations\nbetween neighboring samples.",
    "start": "1792970",
    "end": "1802720"
  },
  {
    "text": "What about the correlation\nof the signal at time t with the signal at time t?",
    "start": "1802720",
    "end": "1809170"
  },
  {
    "text": "Well, that's perfectly\ncorrelated, obviously. So we can plot the correlation\nof this function with itself",
    "start": "1809170",
    "end": "1817150"
  },
  {
    "text": "at different time lags. Remember, that was the\nautocorrelation function. And if we do that, you\nget a 1 at 0 lag and 0",
    "start": "1817150",
    "end": "1827740"
  },
  {
    "text": "at any other lag. So that's the autocorrelation\nfunction of Gaussian noise.",
    "start": "1827740",
    "end": "1832990"
  },
  {
    "text": " All right, now, the Fourier\ntransform of Gaussian noise",
    "start": "1832990",
    "end": "1840310"
  },
  {
    "text": "is just Gaussian noise. It's another kind of interesting\nFourier transform pair.",
    "start": "1840310",
    "end": "1849940"
  },
  {
    "text": "And it's a Gaussian\ndistribution. It's a Gaussian\nrandom distribution in both the real and\nthe imaginary part.",
    "start": "1849940",
    "end": "1856840"
  },
  {
    "text": "So you can see that\nthe blue and red-- the red here is the\nimaginary part-- are both just Gaussian noise.",
    "start": "1856840",
    "end": "1864302"
  },
  {
    "text": "OK?  All right, now what\nis the power spectrum?",
    "start": "1864302",
    "end": "1870529"
  },
  {
    "text": "So we can take this thing-- and, remember, when we\nplot the power [AUDIO OUT] just plot the square\nmagnitude of just",
    "start": "1870530",
    "end": "1878110"
  },
  {
    "text": "the positive frequencies. Why is that again? Why do we only have to\nplot the square magnitude",
    "start": "1878110",
    "end": "1884410"
  },
  {
    "text": "of the positive frequencies? AUDIENCE: [INAUDIBLE] Gaussian,\nso they're all [INAUDIBLE]",
    "start": "1884410",
    "end": "1891270"
  },
  {
    "text": "MICHALE FEE: Yep. So it turns out that\nthe Fourier transform",
    "start": "1891270",
    "end": "1899310"
  },
  {
    "text": "in a positive frequency is\njust the complex conjugate of the Fourier transform\nin the negative frequency.",
    "start": "1899310",
    "end": "1904470"
  },
  {
    "text": "So the square\nmagnitude is identical. So the power\nspectrum on this side is equal to the power\nspectrum on that side.",
    "start": "1904470",
    "end": "1911370"
  },
  {
    "text": "So we just plot half of it. So that's what\nthe power spectrum",
    "start": "1911370",
    "end": "1917400"
  },
  {
    "text": "of this particular piece\nof signal looks like. The power spectrum of\nnoise is very noisy.",
    "start": "1917400",
    "end": "1925980"
  },
  {
    "text": "We're going to\ncome back, and I'm going to show you\nthat on average,",
    "start": "1925980",
    "end": "1932049"
  },
  {
    "text": "if you take many different\nsignals, many copies of this,",
    "start": "1932050",
    "end": "1937860"
  },
  {
    "text": "and calculate the power\nspectrum and average them all altogether, it's\ngoing to be flat. But for any given\npiece of noisy signal,",
    "start": "1937860",
    "end": "1945970"
  },
  {
    "text": "the power spectrum\nis very noisy. Any questions about that?",
    "start": "1945970",
    "end": "1951930"
  },
  {
    "text": "OK. All right, so now let's\nturn to spectral estimation.",
    "start": "1951930",
    "end": "1957750"
  },
  {
    "text": "How do we estimate the\nspectrum of a signal? ",
    "start": "1957750",
    "end": "1966580"
  },
  {
    "text": "So let's say you have\na signal, S of t. And you have a bunch of short\nmeasurements of that signal.",
    "start": "1966580",
    "end": "1975340"
  },
  {
    "text": "You have some signal,\nlet's say, from the brain, like you record some local\nfield potential or some ECG",
    "start": "1975340",
    "end": "1984039"
  },
  {
    "text": "or something like that. And you want to find\nthe spectrum of that.",
    "start": "1984040",
    "end": "1989242"
  },
  {
    "text": "Let's say you're\ninterested in measuring the theta rhythm or\nsome alpha rhythm",
    "start": "1989243",
    "end": "1994330"
  },
  {
    "text": "or some other periodic\nsignal in the brain. What you could do\nis you could have",
    "start": "1994330",
    "end": "2000000"
  },
  {
    "text": "a bunch of independent\nmeasurements of that signal. Let's in this case call them\nfour trials, a bunch of trials.",
    "start": "2000000",
    "end": "2009670"
  },
  {
    "text": "What you can do is calculate\nthe power spectrum, just like [AUDIO OUT] for\neach of those signals.",
    "start": "2009670",
    "end": "2017230"
  },
  {
    "text": "So this is a little sample\ny of t, y1 of t, y2 of t. You can calculate the\nsquare of magnitude",
    "start": "2017230",
    "end": "2024930"
  },
  {
    "text": "of the Fourier transform of\neach one of those samples. And you can estimate the\nspectrum of those signals",
    "start": "2024930",
    "end": "2030960"
  },
  {
    "text": "by just averaging together\nthose separate, independent estimates.",
    "start": "2030960",
    "end": "2036145"
  },
  {
    "text": "Does that make sense? So literally, we just\ndo what we did here. We have a little bit of signal.",
    "start": "2036145",
    "end": "2041760"
  },
  {
    "text": "We Fourier transform it,\ntake the square magnitude. And now, you average together\nall of your different samples.",
    "start": "2041760",
    "end": "2050312"
  },
  {
    "text": "Does that makes sense? That's the simplest form\nof spectral estimation.",
    "start": "2050312",
    "end": "2057179"
  },
  {
    "text": "It's like if you want to\nestimate the average height",
    "start": "2057179",
    "end": "2064589"
  },
  {
    "text": "of a population of people. You take a bunch of\ndifferent measurements. You randomly sample. You take a bunch of\ndifferent measurements.",
    "start": "2064590",
    "end": "2071294"
  },
  {
    "text": "And you average them together. That's all we're doing here. OK?",
    "start": "2071295",
    "end": "2076691"
  },
  {
    "text": " Now, you can apply that same\nprinciple to long signals.",
    "start": "2076692",
    "end": "2086658"
  },
  {
    "text": "What you do is you\njust take that signal and you break it\ninto short pieces. ",
    "start": "2086659",
    "end": "2093440"
  },
  {
    "text": "And you compute\nthe power spectrum in each one of those windows. And again, you\naverage them together.",
    "start": "2093440",
    "end": "2100160"
  },
  {
    "text": "Now, extracting that\nlittle piece of signal from this longer signal\nis essentially the same",
    "start": "2100160",
    "end": "2107870"
  },
  {
    "text": "as multiplying that long\nsignal by a square pulse.",
    "start": "2107870",
    "end": "2113690"
  },
  {
    "text": "0 everywhere, but\n1 in here, 1 here. 0 everywhere else.",
    "start": "2113690",
    "end": "2119090"
  },
  {
    "text": "Right?  So that process of\ntaking a long signal",
    "start": "2119090",
    "end": "2125560"
  },
  {
    "text": "and extracting out one\npiece of it has a name. It's called windowing. ",
    "start": "2125560",
    "end": "2132829"
  },
  {
    "text": "Sort of like you're looking at\na scene through this window, and that's all you can see.",
    "start": "2132830",
    "end": "2138550"
  },
  {
    "start": "2138550",
    "end": "2144760"
  },
  {
    "text": "OK, so one way to estimate\nthe spectrum of this signal is to take the signal\nin this window,",
    "start": "2144760",
    "end": "2151990"
  },
  {
    "text": "compute the FFT of that,\ntake this power spectrum.",
    "start": "2151990",
    "end": "2157150"
  },
  {
    "text": "And then apply this\nwindow to the next piece. Apply this window to the next\npiece and compute the spectrum",
    "start": "2157150",
    "end": "2165510"
  },
  {
    "text": "and average them all altogether. What's the problem with that? Why might that be a bad idea?",
    "start": "2165510",
    "end": "2171920"
  },
  {
    "text": " Yeah.",
    "start": "2171920",
    "end": "2177480"
  },
  {
    "text": "AUDIENCE: Could we [INAUDIBLE]. MICHALE FEE: Good. That's a very good example.",
    "start": "2177480",
    "end": "2184830"
  },
  {
    "text": "But there's sort of\na general principle that we just learned that you\ncan apply to this problem.",
    "start": "2184830",
    "end": "2193500"
  },
  {
    "text": "What happens to the Fourier\ntransform of the signal when we multiply it\nby this square pulse?",
    "start": "2193500",
    "end": "2201696"
  },
  {
    "text": "AUDIENCE: Convolving. MICHALE FEE: We're convolving\nthe spectrum of the signal",
    "start": "2201696",
    "end": "2208319"
  },
  {
    "text": "with a sinc function. And the sinc function\nis really ugly, right? It's got lots of wiggles.",
    "start": "2208320",
    "end": "2213960"
  },
  {
    "text": "And so it turns out this\nprocess of windowing a piece of data with\nthis square pulse",
    "start": "2213960",
    "end": "2220950"
  },
  {
    "text": "actually does really\nhorrible things to our spectral estimate. And we're going to\nspend a lot of time",
    "start": "2220950",
    "end": "2228450"
  },
  {
    "text": "in the next lecture\naddressing how you solve that problem\nin a principled way",
    "start": "2228450",
    "end": "2235319"
  },
  {
    "text": "and make a good\nestimate of the signal by breaking it up\ninto little pieces.",
    "start": "2235320",
    "end": "2240330"
  },
  {
    "text": "But instead of just\ntaking a square window we do something called tapering.",
    "start": "2240330",
    "end": "2246430"
  },
  {
    "text": "So instead of multiplying\nthis signal by square pulses,",
    "start": "2246430",
    "end": "2251579"
  },
  {
    "text": "we sample the signal\nby applying it by little things that look\nlike little smooth functions,",
    "start": "2251580",
    "end": "2257640"
  },
  {
    "text": "like maybe a Gaussian, or other\nfunctions that we'll talk about do an even better job.",
    "start": "2257640",
    "end": "2263780"
  },
  {
    "text": "OK? All right. OK, so that process is\ncalled tapering, multiplying",
    "start": "2263780",
    "end": "2271910"
  },
  {
    "text": "your data by a little\n[AUDIO OUT] paper that's smooth, unlike\na square window.",
    "start": "2271910",
    "end": "2277780"
  },
  {
    "text": "Computing spectral estimates\nfrom each one of those windowed and tapered pieces of data\ngives you a very good estimate",
    "start": "2277780",
    "end": "2286839"
  },
  {
    "text": "of the spectra. And we're going to\ncome back to that, how to really do that\nright, on Thursday.",
    "start": "2286840",
    "end": "2292670"
  },
  {
    "text": "OK?  All right, let me point\nout why this method",
    "start": "2292670",
    "end": "2302470"
  },
  {
    "text": "of spectral estimation\nis very powerful. So, remember, we talked\nabout how you can see--",
    "start": "2302470",
    "end": "2308770"
  },
  {
    "text": "remember, we talked about if\nyou have a noisy signal that has a little bit of\nunderlying sine wave in it,",
    "start": "2308770",
    "end": "2315310"
  },
  {
    "text": "we talked about in\nclass, if you take the autocorrelation\nof that function, you get a delta function and\nthen some little wiggles.",
    "start": "2315310",
    "end": "2323410"
  },
  {
    "text": "So there are ways of\npulling periodic signals, periodic structure\nout of noisy signals.",
    "start": "2323410",
    "end": "2329260"
  },
  {
    "text": "But it turns out\nthat this method of spectral\nestimation [AUDIO OUT] did the most powerful\nway to do it.",
    "start": "2329260",
    "end": "2335799"
  },
  {
    "text": "I'm just going to\nshow you one example. This blue function\nhere is noise,",
    "start": "2335800",
    "end": "2341740"
  },
  {
    "text": "plus a little bit of a sine\nwave at, I think it's 10 hertz. OK, yeah.",
    "start": "2341740",
    "end": "2348090"
  },
  {
    "text": "Anyway, I didn't write\ndown the frequency. But the blue function here is\nnoise plus the red function.",
    "start": "2348090",
    "end": "2354280"
  },
  {
    "text": "So you can see the\nred function is small. And it's buried in the noise,\nso that you can't see it.",
    "start": "2354280",
    "end": "2360440"
  },
  {
    "text": "But when you do this process\nof spectral estimation that we're learning\nabout, you can see that that signal\nburied in that noise",
    "start": "2360440",
    "end": "2369800"
  },
  {
    "text": "is now very easily visible. So using these methods, you can\npull tiny signals out of noise",
    "start": "2369800",
    "end": "2379010"
  },
  {
    "text": "at a very bad signal\nto noise ratio, where the signal is really\nburied in the noise.",
    "start": "2379010",
    "end": "2385500"
  },
  {
    "text": "So it's a very powerful method. And we're going to\nspend more time talking about how to do that properly. ",
    "start": "2385500",
    "end": "2398630"
  },
  {
    "text": "All right, so let me spend a\nlittle bit more time talking about the power\nspectrum of noise,",
    "start": "2398630",
    "end": "2404720"
  },
  {
    "text": "so that we have a better\nsense of what that looks like.",
    "start": "2404720",
    "end": "2410250"
  },
  {
    "text": "So remember, I told\nyou if you take a sample of noise like this\nand you estimate the spectrum",
    "start": "2410250",
    "end": "2416270"
  },
  {
    "text": "of it, you compute the\npower spectrum of one sample of noise, it's extremely noisy. ",
    "start": "2416270",
    "end": "2424550"
  },
  {
    "text": "Let's see, I'm just\ngoing to remind you what that looks like. ",
    "start": "2424550",
    "end": "2430319"
  },
  {
    "text": "That's the power spectrum\nof one sample of noise. In order to estimate what the\nspectrum of noise looks like,",
    "start": "2430320",
    "end": "2438890"
  },
  {
    "text": "you have to take\nmany examples of that and average them together. And when you do\nthat, what you find",
    "start": "2438890",
    "end": "2445880"
  },
  {
    "text": "is that the power spectrum\nof noise is a constant. It's flat. [AUDIO OUT] Gaussian noise.",
    "start": "2445880",
    "end": "2451685"
  },
  {
    "text": " The power spectrum, really, you\nshould think about it properly",
    "start": "2451685",
    "end": "2460970"
  },
  {
    "text": "as a power spectral density. There is a certain amount of\npower at different frequencies",
    "start": "2460970",
    "end": "2467300"
  },
  {
    "text": "in this signal. So there is some power\nat low frequency, some power at\nintermediate frequencies,",
    "start": "2467300",
    "end": "2472880"
  },
  {
    "text": "some power at high frequencies. And for Gaussian noise, that\npower spectral density is flat.",
    "start": "2472880",
    "end": "2478730"
  },
  {
    "text": "It's constant as a\nfunction of frequency. OK? ",
    "start": "2478730",
    "end": "2485750"
  },
  {
    "text": "And the units here have units\nof variance per unit frequency--",
    "start": "2485750",
    "end": "2492560"
  },
  {
    "text": "variance per frequency. OK? Or if it were an\nelectrical signal",
    "start": "2492560",
    "end": "2498513"
  },
  {
    "text": "going through a\nresistor, it would be power per unit frequency.",
    "start": "2498513",
    "end": "2503559"
  },
  {
    "text": "So you can see that here\nthe value here is 0.002.",
    "start": "2503560",
    "end": "2508940"
  },
  {
    "text": "The bandwidth of this\nsignal is 500 hertz. And so the variance\nis the variance",
    "start": "2508940",
    "end": "2514569"
  },
  {
    "text": "per unit per unit frequency\ntimes the bandwidth. And that's 1. And we started with\na Gaussian noise",
    "start": "2514570",
    "end": "2522670"
  },
  {
    "text": "that has variance 1, that\nwhen we calculate the power spectrum of that we\ncan correctly read out",
    "start": "2522670",
    "end": "2529840"
  },
  {
    "text": "from the power spectrum how\nmuch variance there is per unit frequency in the signal.",
    "start": "2529840",
    "end": "2535660"
  },
  {
    "text": "OK? All right, it's kind\nof a subtle point. I actually don't expect\nyou to know this.",
    "start": "2535660",
    "end": "2541930"
  },
  {
    "text": "I just wanted you to\nsee it and hear it. So you know formally\nwhat it is that you're",
    "start": "2541930",
    "end": "2547359"
  },
  {
    "text": "looking at when you look\nat a spectral estimate of a noisy signal. ",
    "start": "2547360",
    "end": "2553850"
  },
  {
    "text": "All right, let's talk about\nfiltering in the frequency domain. So remember, we learned\nhow to smooth a signal,",
    "start": "2553850",
    "end": "2559789"
  },
  {
    "text": "how to filter a signal,\neither high pass or low pass, by convolving a\nsignal with a kernel.",
    "start": "2559790",
    "end": "2566840"
  },
  {
    "text": "So you remember that the\nkernel for a low pass",
    "start": "2566840",
    "end": "2572990"
  },
  {
    "text": "was something like this.  So when you convolve, that's\nthe kernel for a low pass.",
    "start": "2572990",
    "end": "2581930"
  },
  {
    "text": " And for a high pass, anybody\nremember what that looks like?",
    "start": "2581930",
    "end": "2588955"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] MICHALE FEE: Yep. So-- sorry, I should be a little\nmore careful here not to mix up",
    "start": "2588955",
    "end": "2597260"
  },
  {
    "text": "my axes with--  I'm going to remove that.",
    "start": "2597260",
    "end": "2603570"
  },
  {
    "text": "So that's the kernel\nfor a low-pass filter. The kernel for a\nhigh-pass filter is a delta function that\nreproduces the function.",
    "start": "2603570",
    "end": "2612120"
  },
  {
    "text": "And then you subtract off\na low-pass filtered version",
    "start": "2612120",
    "end": "2617400"
  },
  {
    "text": "of the signal. OK? So that's the kernel\nfor a high pass.",
    "start": "2617400",
    "end": "2623730"
  },
  {
    "text": " OK, so this was how\nyou filter a signal",
    "start": "2623730",
    "end": "2629150"
  },
  {
    "text": "by convolving your signal with a\nfunction, with a linear kernel.",
    "start": "2629150",
    "end": "2634910"
  },
  {
    "text": "We're going to talk now\nabout how you do filtering in the frequency domain.",
    "start": "2634910",
    "end": "2640670"
  },
  {
    "text": "So if filtering\nin the time domain is convolving your\n[AUDIO OUT] with a function,",
    "start": "2640670",
    "end": "2648250"
  },
  {
    "text": "what is filtering in the\nfrequency domain going to be? AUDIENCE: [INAUDIBLE] MICHALE FEE: Right.",
    "start": "2648250",
    "end": "2653882"
  },
  {
    "text": "It's going to be multiplying\nthe Fourier transform of your signal times what?",
    "start": "2653882",
    "end": "2661162"
  },
  {
    "text": "AUDIENCE: The Fourier\ntransform [INAUDIBLE] MICHALE FEE: The Fourier\ntransform of things like that. ",
    "start": "2661163",
    "end": "2668050"
  },
  {
    "text": "All right, so let's do that. So this is what we\njust talked about.",
    "start": "2668050",
    "end": "2673080"
  },
  {
    "text": "We introduced the idea before. This was actually\na neural signal that has spikes up here\nand local field potentials",
    "start": "2673080",
    "end": "2680099"
  },
  {
    "text": "down here. And we can extract the\nlocal field potentials by smoothing this [AUDIO OUT]\nby low pass filtering it,",
    "start": "2680100",
    "end": "2687569"
  },
  {
    "text": "by convolving it with\nthis kernel here. ",
    "start": "2687570",
    "end": "2692910"
  },
  {
    "text": "So this is what we\njust talked about. So if filtering\nin the time domain is convolving your\ndata with a signal,",
    "start": "2692910",
    "end": "2700300"
  },
  {
    "text": "then filtering in\nthe frequency domain is multiplying the Fourier\ntransform of a [AUDIO OUT]",
    "start": "2700300",
    "end": "2705340"
  },
  {
    "text": "times the Fourier\ntransform of the kernel. And you can see that what this\ndoes to the power spectrum",
    "start": "2705340",
    "end": "2712030"
  },
  {
    "text": "is just what you would expect. The power spectrum of\nthe filtered signal is just the power spectrum\nof your original signal",
    "start": "2712030",
    "end": "2720820"
  },
  {
    "text": "times the power\nspectrum of the kernel. ",
    "start": "2720820",
    "end": "2727160"
  },
  {
    "text": "All right, so here's an example. So in blue is the\noriginal Gaussian noise.",
    "start": "2727160",
    "end": "2735110"
  },
  {
    "text": "In green is the kernel\nthat I'm smoothing it by, filtering it by.",
    "start": "2735110",
    "end": "2741070"
  },
  {
    "text": "Convolving the blue with the\ngreen gives you the red signal. What kind of filter\nis that called again?",
    "start": "2741070",
    "end": "2747370"
  },
  {
    "start": "2747370",
    "end": "2752790"
  },
  {
    "text": "High pass or low pass? AUDIENCE: Low pass. MICHALE FEE: Low pass, good. All right, so let me play\nyou what those sound like.",
    "start": "2752790",
    "end": "2760720"
  },
  {
    "text": "So here's the original\nGaussian noise. [STATIC] Good.",
    "start": "2760720",
    "end": "2769560"
  },
  {
    "text": "And here's the low\npass Gaussian noise.  [LOWER STATIC] It got rid\nof about the high frequency",
    "start": "2769560",
    "end": "2781560"
  },
  {
    "text": "parts of the noise. ",
    "start": "2781560",
    "end": "2787240"
  },
  {
    "text": "OK, so here's the power spectrum\nof the original signal in blue.",
    "start": "2787240",
    "end": "2794400"
  },
  {
    "text": "In order to get the power\nspectrum of the filtered signal in red, we're going to multiply\nthat by the magnitude squared",
    "start": "2794400",
    "end": "2803700"
  },
  {
    "text": "Fourier transform of this. What do you think\nthat looks like? So this is a little\nGaussian filter in time.",
    "start": "2803700",
    "end": "2809850"
  },
  {
    "text": "What is the Fourier transform\nof that going to look like? AUDIENCE: [INAUDIBLE] MICHALE FEE: The Fourier\ntransform of a Gaussian",
    "start": "2809850",
    "end": "2816110"
  },
  {
    "text": "is a Gaussian. So the power spectrum\nof that signal",
    "start": "2816110",
    "end": "2825790"
  },
  {
    "text": "is going to just be a Gaussian. Now, how would I plot it? It's peaked where? ",
    "start": "2825790",
    "end": "2833730"
  },
  {
    "text": "The Fourier transform of\na Gaussian is peaked at 0. So it's going to be a\nGaussian here centered at 0.",
    "start": "2833730",
    "end": "2841680"
  },
  {
    "text": "We're only plotting the\npositive frequencies. So this, we're ignoring. And it's going to\nbe like that, right?",
    "start": "2841680",
    "end": "2848940"
  },
  {
    "text": "So that's the Fourier transform,\nsquared magnitude Fourier transform of that Gaussian.",
    "start": "2848940",
    "end": "2854530"
  },
  {
    "text": "It's just another Gaussian. And now if we multiply this\npower spectrum times that power",
    "start": "2854530",
    "end": "2861619"
  },
  {
    "text": "spectrum, we get\nthe power spectrum of our filtered signal. Does that makes sense?",
    "start": "2861620",
    "end": "2867420"
  },
  {
    "text": " So convolving our original blue\nsignal with this green Gaussian",
    "start": "2867420",
    "end": "2878990"
  },
  {
    "text": "kernel smooths the signal. It gets rid of high frequencies.",
    "start": "2878990",
    "end": "2884300"
  },
  {
    "text": "In the frequency domain,\nthat's like multiplying the spectrum of the blue\nsignal by a function that's",
    "start": "2884300",
    "end": "2892910"
  },
  {
    "text": "0 at high frequencies\nand 1 at low frequencies. ",
    "start": "2892910",
    "end": "2900040"
  },
  {
    "text": "Does that makes sense? So filtering in the frequency\ndomain, low filtering",
    "start": "2900040",
    "end": "2905490"
  },
  {
    "text": "in the frequency domain, means\nmultiplying the power spectrum of your signal by a function\nthat's low at high frequencies",
    "start": "2905490",
    "end": "2913920"
  },
  {
    "text": "and big at low frequencies. So it passes the\nfrequencies and suppresses",
    "start": "2913920",
    "end": "2919110"
  },
  {
    "text": "the high frequencies. ",
    "start": "2919110",
    "end": "2925380"
  },
  {
    "text": "It's that simple. ",
    "start": "2925380",
    "end": "2931400"
  },
  {
    "text": "Any questions about that?  Well, yes--",
    "start": "2931400",
    "end": "2937380"
  },
  {
    "text": "AUDIENCE: So why\nis it that like-- you need to like-- of I guess when you\nmultiply in the frequency,",
    "start": "2937380",
    "end": "2944555"
  },
  {
    "text": "could you theoretically\nmultiply by anything and that would correspond to\nsome other type of filter.",
    "start": "2944555",
    "end": "2951816"
  },
  {
    "text": "So why don't we just like\nthrow away high frequencies? Or something like multiply by a\nsquare in the frequency domain",
    "start": "2951816",
    "end": "2961340"
  },
  {
    "text": "and correspond to some\ndifferent filter we don't know. MICHALE FEE: Yeah. You can do that.",
    "start": "2961340",
    "end": "2966390"
  },
  {
    "text": "You can take a signal like this,\nFourier transform it, multiply",
    "start": "2966390",
    "end": "2972440"
  },
  {
    "text": "it by a square window to\nsuppress high frequencies.",
    "start": "2972440",
    "end": "2978859"
  },
  {
    "text": "What is that equivalent to? What would be the\ncorresponding temporal kernel",
    "start": "2978860",
    "end": "2985570"
  },
  {
    "text": "that that would correspond to? AUDIENCE: [INAUDIBLE] MICHALE FEE: Good. It would be convulsing your\nfunction with a sinc function.",
    "start": "2985570",
    "end": "2995320"
  },
  {
    "text": "It turns out that's-- ",
    "start": "2995320",
    "end": "3003320"
  },
  {
    "text": "the reason you wouldn't\nnormally do that",
    "start": "3003320",
    "end": "3008950"
  },
  {
    "text": "is that it mixes the\nsignal across all time. The sinc function\ngoes on to infinity.",
    "start": "3008950",
    "end": "3016030"
  },
  {
    "text": "So the nice thing about this\nis when you smooth a signal with a Gaussian, you're not\nadding some of the signal here",
    "start": "3016030",
    "end": "3026050"
  },
  {
    "text": "that were over here. Does that makes sense? Convolving with a sinc function\nkind of mixes things in time.",
    "start": "3026050",
    "end": "3031359"
  },
  {
    "text": " So normally you would\nsmooth by functions",
    "start": "3031360",
    "end": "3038880"
  },
  {
    "text": "that are kind of local in\ntime, local in frequency, but not having sharp edges.",
    "start": "3038880",
    "end": "3047770"
  },
  {
    "text": "Does that makes sense? So we're going to talk about how\nto smooth things in frequency",
    "start": "3047770",
    "end": "3053890"
  },
  {
    "text": "with signals with kernels\nthat are optimal for that job.",
    "start": "3053890",
    "end": "3060819"
  },
  {
    "text": "That's Thursday. What would a\nhigh-pass filter look",
    "start": "3060820",
    "end": "3065970"
  },
  {
    "text": "like in the frequency domain? ",
    "start": "3065970",
    "end": "3075470"
  },
  {
    "text": "So high-pass filter would\npass high frequencies",
    "start": "3075470",
    "end": "3081540"
  },
  {
    "text": "and suppress low frequencies. Right?",
    "start": "3081540",
    "end": "3087388"
  },
  {
    "text": "You've probably not heard of\nit, but, what would a band pass filter look like?",
    "start": "3087388",
    "end": "3092450"
  },
  {
    "text": "It would just pass a band. So it'd be 0 here. It would be big\nsomewhere in the middle",
    "start": "3092450",
    "end": "3097710"
  },
  {
    "text": "and then go to 0 at\nhigher frequencies. OK?",
    "start": "3097710",
    "end": "3103630"
  },
  {
    "text": "Does that makes sense? Any questions about that? ",
    "start": "3103630",
    "end": "3109210"
  },
  {
    "text": "OK. Good. ",
    "start": "3109210",
    "end": "3114710"
  },
  {
    "text": "If we plot this on a\nlog plot in decibels,",
    "start": "3114710",
    "end": "3120160"
  },
  {
    "text": "you can see that on a\nlog plot, a Gaussian, which is e to [AUDIO OUT]\nlike f squared.",
    "start": "3120160",
    "end": "3129000"
  },
  {
    "text": "On a log plot, that's\nminus f squared. Right? That's why on a\nlog plot this would",
    "start": "3129000",
    "end": "3134100"
  },
  {
    "text": "look like an inverted parabola. So that's the same plot here,\nbut plotted on a log scale.",
    "start": "3134100",
    "end": "3143160"
  },
  {
    "text": " Any questions about that?",
    "start": "3143160",
    "end": "3148990"
  },
  {
    "start": "3148990",
    "end": "3155320"
  },
  {
    "text": "I want to tell you about a\ncool little theorem called the Wiener-Khinchin theorem\nthat relates the power",
    "start": "3155320",
    "end": "3163359"
  },
  {
    "text": "spectrum of a signal with the\nautocorrelation of a signal.",
    "start": "3163360",
    "end": "3170500"
  },
  {
    "text": "So in blue, that's our\noriginal Gaussian noise.",
    "start": "3170500",
    "end": "3179780"
  },
  {
    "text": "In red is our smooth\nGaussian noise. If you look at the correlation\nof neighboring time",
    "start": "3179780",
    "end": "3187609"
  },
  {
    "text": "points in the blue\nsignal, you can see they're completely\nuncorrelated with each other. But what about neighboring time\npoints on the smooth signal?",
    "start": "3187610",
    "end": "3195500"
  },
  {
    "text": "Are they correlated\nwith each other? ",
    "start": "3195500",
    "end": "3203266"
  },
  {
    "text": "If we look at for the\nred signal, y of i",
    "start": "3203266",
    "end": "3208820"
  },
  {
    "text": "and y of i plus 1,\nwhat does that look like for the red signal?",
    "start": "3208820",
    "end": "3214523"
  },
  {
    "text": "They become correlated\nwith each other, right? Because each value\nof the smooth signal",
    "start": "3214523",
    "end": "3221660"
  },
  {
    "text": "is some sum over\nthe blue points. So neighboring points here\nwill be similar to each other.",
    "start": "3221660",
    "end": "3229740"
  },
  {
    "text": "That's what smoothness means. Neighboring time points\nare close to each other.",
    "start": "3229740",
    "end": "3236160"
  },
  {
    "text": "So if you look at the\ncorrelation of neighboring time points in the smooth\nsignal, it looks like this.",
    "start": "3236160",
    "end": "3242400"
  },
  {
    "text": "It has a strong correlation.  So if you look at\nthe autocorrelation",
    "start": "3242400",
    "end": "3248270"
  },
  {
    "text": "of the original\nGaussian noise, it has a delta function at zero.",
    "start": "3248270",
    "end": "3255530"
  },
  {
    "text": "The autocorrelation of\nthe smoothed function has some width to it.",
    "start": "3255530",
    "end": "3261440"
  },
  {
    "text": "And the width to that\nautocorrelation function tells you the time [AUDIO OUT]\nthis signal was smoothed.",
    "start": "3261440",
    "end": "3267079"
  },
  {
    "text": "Right? OK. Now, how does that relate\nto the power spectrum?",
    "start": "3267080",
    "end": "3272369"
  },
  {
    "text": "So it turns out that\nthe power spectrum of a signal, the magnitude\nsquared of the Fourier",
    "start": "3272370",
    "end": "3280160"
  },
  {
    "text": "transform, the power\nspectrum of the signal is just the Fourier transform\nof the autocorrelation.",
    "start": "3280160",
    "end": "3288920"
  },
  {
    "text": "So what's the Fourier\ntransform of a delta function? Anybody remember that?",
    "start": "3288920",
    "end": "3295654"
  },
  {
    "text": "AUDIENCE: Constant. MICHALE FEE: It's a constant. ",
    "start": "3295654",
    "end": "3307339"
  },
  {
    "text": "And how about our smoothed? Our smooth signal\nhas a power spectrum",
    "start": "3307340",
    "end": "3314120"
  },
  {
    "text": "that's a Gaussian in this case. What's the transform\nof a Gaussian?",
    "start": "3314120",
    "end": "3320268"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]",
    "start": "3320268",
    "end": "3325702"
  },
  {
    "text": "MICHALE FEE: OK. So if you have a signal that\nyou have some sense of what",
    "start": "3325702",
    "end": "3332190"
  },
  {
    "text": "the power spectrum\nis you immediately know what the\nautocorrelation is. You just Fourier transform that\nand get the autocorrelation.",
    "start": "3332190",
    "end": "3340740"
  },
  {
    "text": "What's the width\nof this in time? How would I get that from here?",
    "start": "3340740",
    "end": "3346400"
  },
  {
    "start": "3346400",
    "end": "3356529"
  },
  {
    "text": "How are the width in time and\nfrequency related to each other for-- AUDIENCE: [INAUDIBLE] MICHALE FEE: Right.",
    "start": "3356530",
    "end": "3361912"
  },
  {
    "text": "The width of this\nin time is just 1 over the width of\n[AUDIO OUT] So you have to take the full width.",
    "start": "3361912",
    "end": "3368610"
  },
  {
    "text": "Does that makes sense? OK. Wiener-Khinchin\ntheorem, very cool. ",
    "start": "3368610",
    "end": "3383400"
  },
  {
    "text": "All right, let's talk about\nthe Shannon-Nyquist theorem.",
    "start": "3383400",
    "end": "3388849"
  },
  {
    "text": "Anybody heard of\nthe Nyquist limit? Anybody heard of this?",
    "start": "3388850",
    "end": "3394770"
  },
  {
    "text": " All right, so it's a\nvery important theorem.",
    "start": "3394770",
    "end": "3402950"
  },
  {
    "text": "Basically anybody who's\nacquiring signals in the lab needs to know the\nShannon-Nyquist theorem.",
    "start": "3402950",
    "end": "3409760"
  },
  {
    "text": "It's very important. All right, so\nremember that when we",
    "start": "3409760",
    "end": "3418180"
  },
  {
    "text": "have discrete Fourier\ntransforms, fast Fourier transforms, our frequencies are\ndiscretized and so is our time.",
    "start": "3418180",
    "end": "3429080"
  },
  {
    "text": "But the discretization\nin frequency means that the\nfunction is periodic.",
    "start": "3429080",
    "end": "3437720"
  },
  {
    "text": "Any signal that has discrete\ncomponents and frequencies",
    "start": "3437720",
    "end": "3445109"
  },
  {
    "text": "is periodic in time. Remember, we started\nwith Fourier series. And we talked about how if\nyou have a signal that's",
    "start": "3445110",
    "end": "3451770"
  },
  {
    "text": "periodic in time, that\nyou can write it down as a set of frequencies\nthat are integer multiples",
    "start": "3451770",
    "end": "3458597"
  },
  {
    "text": "of each other.  Now, in these signals,\ntime is sampled discretely",
    "start": "3458597",
    "end": "3468030"
  },
  {
    "text": "at regular time intervals. So what does that tell us\nabout the spectrum, the Fourier",
    "start": "3468030",
    "end": "3473400"
  },
  {
    "text": "transform? ",
    "start": "3473400",
    "end": "3478750"
  },
  {
    "text": "AUDIENCE: It's periodic. MICHALE FEE: It's also periodic. OK, so discretely sampled in\nfrequency at regular intervals",
    "start": "3478750",
    "end": "3489560"
  },
  {
    "text": "means that the signal\nis periodic in time. Discretely sampled in time\nmeans that the Fourier transform",
    "start": "3489560",
    "end": "3497720"
  },
  {
    "text": "is periodic. Now, we don't usually\nthink about this. We've been taking these\nsignals, sines and cosines",
    "start": "3497720",
    "end": "3506470"
  },
  {
    "text": "and square pulses\nand Gaussian things, and I've been showing\nyou discretely sampled",
    "start": "3506470",
    "end": "3511750"
  },
  {
    "text": "versions of those signals. And I've been showing you\nthe Fourier transforms of those signals.",
    "start": "3511750",
    "end": "3517750"
  },
  {
    "text": "But I've only been showing\nyou this little part of it.",
    "start": "3517750",
    "end": "3522800"
  },
  {
    "text": "In fact, really be thinking\nthat those discreetly sampled",
    "start": "3522800",
    "end": "3527890"
  },
  {
    "text": "signals have a Fourier transform\nthat's actually periodic. There's another copy of that\nspectrum sitting up here",
    "start": "3527890",
    "end": "3539970"
  },
  {
    "text": "at 1 over the sampling rate and\nanother copy sitting up here.",
    "start": "3539970",
    "end": "3545080"
  },
  {
    "text": "Remember, this is like a\ntrain of delta functions. The Fourier transform of\nthat is like another train of delta functions.",
    "start": "3545080",
    "end": "3553360"
  },
  {
    "text": "So there are copies of this\nspectrum spaced every 1 over delta t.",
    "start": "3553360",
    "end": "3559670"
  },
  {
    "text": "It's kind of a strange concept. ",
    "start": "3559670",
    "end": "3570500"
  },
  {
    "text": "So the separation\nbetween those copies of the spectra in\nthe frequency domain are given by 1 over\nthe sampling rate.",
    "start": "3570500",
    "end": "3580910"
  },
  {
    "text": "Any questions about that? It's a little strange. But we'll push on\nbecause I think",
    "start": "3580910",
    "end": "3585940"
  },
  {
    "text": "it's going to be more clear.  So what this says is that if\nyou want to properly sample",
    "start": "3585940",
    "end": "3596779"
  },
  {
    "text": "this signal in time, you\nneed these [AUDIO OUT] copies",
    "start": "3596780",
    "end": "3605990"
  },
  {
    "text": "of its spectrum to be far\naway so they don't interfere with each other. So what that means is that\nyou need the sampling rate",
    "start": "3605990",
    "end": "3618410"
  },
  {
    "text": "to be high enough-- the higher the sampling rate\nis, the further these spectra",
    "start": "3618410",
    "end": "3624545"
  },
  {
    "text": "are in time. Delta t is very small,\nwhich means 1 over delta t",
    "start": "3624545",
    "end": "3630320"
  },
  {
    "text": "is very big. The sampling rate\nneeds to be greater than twice the\nbandwidth of the signal.",
    "start": "3630320",
    "end": "3640210"
  },
  {
    "text": " [AUDIO OUT] bandwidth B.",
    "start": "3640210",
    "end": "3651170"
  },
  {
    "text": "So if the sampling rate is\nless than twice the bandwidth, what happens?",
    "start": "3651170",
    "end": "3657400"
  },
  {
    "text": "That means delta t is too big. These copies of the spectrum\nare too close to [AUDIO OUT]",
    "start": "3657400",
    "end": "3666260"
  },
  {
    "text": "and they overlap. That overlap is\ncalled aliasing--",
    "start": "3666260",
    "end": "3671350"
  },
  {
    "text": "a-l-i-a-s-i-n-g.  OK?",
    "start": "3671350",
    "end": "3678150"
  },
  {
    "text": "So you can see that if you\nsample a signal at too low a sampling rate and you look\nat the spectrum of the signal,",
    "start": "3678150",
    "end": "3688170"
  },
  {
    "text": "you see that it has-- like you'll see this\npart of the spectrum,",
    "start": "3688170",
    "end": "3694390"
  },
  {
    "text": "but you'll also\nsee this other part of the spectrum kind of\ncontaminating the top",
    "start": "3694390",
    "end": "3699570"
  },
  {
    "text": "of your Fourier transform. Does that makes sense? ",
    "start": "3699570",
    "end": "3706059"
  },
  {
    "text": "OK. So let me just say it again. If your signal has some\nbandwidth B that in order",
    "start": "3706060",
    "end": "3713400"
  },
  {
    "text": "to sample that signal\nproperly, your sampling rate needs to be greater than\ntwice that bandwidth, 1, 2.",
    "start": "3713400",
    "end": "3725205"
  },
  {
    "text": "OK?  All right, any\nquestions about that?",
    "start": "3725205",
    "end": "3730430"
  },
  {
    "text": " Actually, there was\nactually recently",
    "start": "3730430",
    "end": "3739550"
  },
  {
    "text": "a paper where somebody claimed-- I think I told you about\nthis last time-- there was a paper where\nsomebody claimed to be",
    "start": "3739550",
    "end": "3745700"
  },
  {
    "text": "able to get around this limit. And they were mercilessly\ntreated in the responses",
    "start": "3745700",
    "end": "3757490"
  },
  {
    "text": "to that paper. So don't make that mistake. ",
    "start": "3757490",
    "end": "3766140"
  },
  {
    "text": "Now, what's really cool\nis that if the sampling rate is greater than\ntwice the bandwidth,",
    "start": "3766140",
    "end": "3772619"
  },
  {
    "text": "something amazing happens. You can perfectly\nreconstruct the signal.",
    "start": "3772620",
    "end": "3778800"
  },
  {
    "text": " Now that's an amazing claim. Right?",
    "start": "3778800",
    "end": "3783880"
  },
  {
    "text": "You have a [AUDIO OUT] time. All right, it's wiggling around. What this is saying\nis that I can",
    "start": "3783880",
    "end": "3789920"
  },
  {
    "text": "sample that signal\nat regular intervals",
    "start": "3789920",
    "end": "3795280"
  },
  {
    "text": "and completely ignore\nwhat's happening between those samples, have no\nknowledge of what's happening",
    "start": "3795280",
    "end": "3800740"
  },
  {
    "text": "between those samples. And I can perfectly\nreconstruct the signal I'm sampling at\nevery time point,",
    "start": "3800740",
    "end": "3813197"
  },
  {
    "text": "even though I didn't look there. ",
    "start": "3813197",
    "end": "3822080"
  },
  {
    "text": "So how do you do that? Basically, your sampled signal,\nyou're regularly sampled",
    "start": "3822080",
    "end": "3828579"
  },
  {
    "text": "signal, has this spectrum-- has this Fourier transform\nwith repeated copies",
    "start": "3828580",
    "end": "3835150"
  },
  {
    "text": "of the signal, repeated\ncopies of the spectrum.",
    "start": "3835150",
    "end": "3841589"
  },
  {
    "text": "So how would I recover the\nspectrum's original signal?",
    "start": "3841590",
    "end": "3846780"
  },
  {
    "text": "Well, the spectrum of\nthe original signal is just this piece right here.",
    "start": "3846780",
    "end": "3852080"
  },
  {
    "text": "So all I do is in the frequency\ndomain I take that part.",
    "start": "3852080",
    "end": "3859040"
  },
  {
    "text": "I keep this, and I\nthrow away all those. In other words, I multiply my\nFourier transfer sampled signal",
    "start": "3859040",
    "end": "3866210"
  },
  {
    "text": "in the frequency domain\nby a square pulse that's",
    "start": "3866210",
    "end": "3872900"
  },
  {
    "text": "1 here and 0 everywhere else. Does that makes sense? ",
    "start": "3872900",
    "end": "3883890"
  },
  {
    "text": "And when I inverse Fourier\ntransform that I've completely recovered my original signal.",
    "start": "3883890",
    "end": "3889950"
  },
  {
    "text": "What is multiplying\nthis spectrum by the square wave in the\nfrequency domain equivalent",
    "start": "3889950",
    "end": "3897120"
  },
  {
    "text": "to in the time domain? AUDIENCE: So I\nwas going to ask-- MICHALE FEE: Yeah. AUDIENCE: [INAUDIBLE]",
    "start": "3897120",
    "end": "3906010"
  },
  {
    "text": "MICHALE FEE: Yeah. AUDIENCE: So why do\nyou want to do that? MICHALE FEE: Yeah, so\nit's amazing, right?",
    "start": "3906010",
    "end": "3911390"
  },
  {
    "text": "It's cool. So let me just what it is. And then we can marvel at\nhow that could possibly be.",
    "start": "3911390",
    "end": "3919720"
  },
  {
    "text": "Multiplying this spectrum\nby this square wave, throwing away all those\nother copies of the spectrum",
    "start": "3919720",
    "end": "3926350"
  },
  {
    "text": "and keeping that\none is multiplying by a square wave in\nthe frequency domain, which is like doing what?",
    "start": "3926350",
    "end": "3932355"
  },
  {
    "text": "AUDIENCE: Convolving. MICHALE FEE: Convolving\nthe time domain sinc-- that regular train of\nsamples, convolving that",
    "start": "3932355",
    "end": "3939740"
  },
  {
    "text": "with a sinc function. So let me just say that. Here, we have a function\nthat we've regularly",
    "start": "3939740",
    "end": "3946339"
  },
  {
    "text": "sampled at these intervals. If we take that function, which\nis a bunch of delta functions",
    "start": "3946340",
    "end": "3953270"
  },
  {
    "text": "here, here, here,\nhere, just samples, and we can evolve that\nwith a sinc function,",
    "start": "3953270",
    "end": "3960750"
  },
  {
    "text": "we perfectly reconstruct\nthe original signal. ",
    "start": "3960750",
    "end": "3973420"
  },
  {
    "text": "Pretty wild. So that's the\nNyquist-Shannon theorem.",
    "start": "3973420",
    "end": "3978579"
  },
  {
    "text": "What it says is that\nwe can perfectly reconstruct the signal we've\nsampled as long as we sample it",
    "start": "3978580",
    "end": "3984520"
  },
  {
    "text": "at a sampling rate\nthat's greater than twice the bandwidth of the signal.",
    "start": "3984520",
    "end": "3989616"
  },
  {
    "text": "OK? All right. OK, good.",
    "start": "3989616",
    "end": "3994690"
  },
  {
    "start": "3994690",
    "end": "4005060"
  },
  {
    "text": "So there's this cute\ntrick called zero-padding,",
    "start": "4005060",
    "end": "4010850"
  },
  {
    "text": "where you don't\nperfectly reconstruct the original signal, but\nbasically you can interpolate.",
    "start": "4010850",
    "end": "4020270"
  },
  {
    "text": "So you can extract the\nvalues of the original signal",
    "start": "4020270",
    "end": "4025550"
  },
  {
    "text": "times between where you\nactually sampled it. OK? And basically the\ntrick is as follows.",
    "start": "4025550",
    "end": "4032480"
  },
  {
    "text": "We take our sampled signal. We Fourier transform it. And what we do is\nwe just add zeros.",
    "start": "4032480",
    "end": "4039350"
  },
  {
    "text": "We pad that Fourier\ntransform with zeros. OK? So we just take\npositive frequencies",
    "start": "4039350",
    "end": "4047182"
  },
  {
    "text": "and the negative\nfrequencies, and we just stick a bunch of zeros between\nand make it a longer vector.",
    "start": "4047182",
    "end": "4054349"
  },
  {
    "text": "And then when we inverse\nFourier transform this, you can see that you\nhave a longer array.",
    "start": "4054350",
    "end": "4061635"
  },
  {
    "text": "When you inverse\ntransform, inverse Fourier transform, what\nyou're going to have",
    "start": "4061635",
    "end": "4066760"
  },
  {
    "text": "is your original samples\nback, plus a bunch of samples",
    "start": "4066760",
    "end": "4072490"
  },
  {
    "text": "in between that\ninterpolate, that are measures of the\noriginal signal at the times",
    "start": "4072490",
    "end": "4079920"
  },
  {
    "text": "where you didn't measure it. So you can essentially\nincrease the sampling rate",
    "start": "4079920",
    "end": "4088150"
  },
  {
    "text": "of your signal after the fact. Pretty cool, right?",
    "start": "4088150",
    "end": "4093360"
  },
  {
    "text": "Again, it requires that you've\nsampled at twice the bandwidth",
    "start": "4093360",
    "end": "4098520"
  },
  {
    "text": "of the original signal. Yes. AUDIENCE: Like how do\nyou know the bandwidth of the original signal if\nyou don't have samples?",
    "start": "4098520",
    "end": "4106649"
  },
  {
    "text": "MICHALE FEE: Good question. How might you do that? ",
    "start": "4106649",
    "end": "4114033"
  },
  {
    "text": "AUDIENCE: Can you like\n[INAUDIBLE] different sampling lengths to get [INAUDIBLE] MICHALE FEE: You could do that.",
    "start": "4114033",
    "end": "4119839"
  },
  {
    "text": "From nearly all\napplications, you have a pretty good sense of what\nthe frequencies are that you're",
    "start": "4119840",
    "end": "4126380"
  },
  {
    "text": "interested in a signal. And then what you do\nis you have to put",
    "start": "4126380",
    "end": "4132049"
  },
  {
    "text": "a filter between your experiment\nand your computer that's",
    "start": "4132050",
    "end": "4137869"
  },
  {
    "text": "doing the sampling\nthat guarantees that it's suppressed all the\nfrequencies above some point.",
    "start": "4137870",
    "end": "4146560"
  },
  {
    "text": "OK? And that kind of filter is\ncalled an anti-aliasing filter.",
    "start": "4146560",
    "end": "4151969"
  },
  {
    "text": "So in that case, even if your\nsignal had higher frequency components, the\nanti-aliasing filter",
    "start": "4151970",
    "end": "4158990"
  },
  {
    "text": "cuts it off so that there's\nnothing at higher frequencies. Does that makes sense?",
    "start": "4158990",
    "end": "4164880"
  },
  {
    "start": "4164880",
    "end": "4172899"
  },
  {
    "text": "Let me give you an\nexample of aliasing. Let's say I had this\nsignal like this. ",
    "start": "4172899",
    "end": "4180949"
  },
  {
    "text": "And I sample it here, here,\nhere, here, here, here.",
    "start": "4180950",
    "end": "4190759"
  },
  {
    "text": "I need to do regular intervals. So you can see that if\nI have a sine wave that",
    "start": "4190760",
    "end": "4198550"
  },
  {
    "text": "is close in frequency\nto the sampling rate, you can see that when\nI sample the signal,",
    "start": "4198550",
    "end": "4210750"
  },
  {
    "text": "I'm going to see something\nat the wrong frequency. That's an example of aliasing.",
    "start": "4210750",
    "end": "4216469"
  },
  {
    "text": "OK? ",
    "start": "4216469",
    "end": "4221910"
  },
  {
    "text": "OK, so here's an example. We have a 20 hertz cosine wave. I've sampled it at 100 hertz.",
    "start": "4221910",
    "end": "4227550"
  },
  {
    "text": "So I'm, you know, 5-- so what frequency would I\nhave to sample this in order",
    "start": "4227550",
    "end": "4234720"
  },
  {
    "text": "to reconstruct the cosine? I'd have to sample\nat least 40 hertz.",
    "start": "4234720",
    "end": "4239940"
  },
  {
    "text": "Here, I'm sampling at 100. The delta t is 10 milliseconds. So those are the blue points.",
    "start": "4239940",
    "end": "4247290"
  },
  {
    "text": "And now, if I do this\nzero-padding trick, I Fourier transform. I do zero-padding\nby a factor of 4.",
    "start": "4247290",
    "end": "4254750"
  },
  {
    "text": "That means if I take the\nFourier transform signal and I'm now making that\nvector 4 times as long",
    "start": "4254750",
    "end": "4261810"
  },
  {
    "text": "by filling in zeros, then I\ninverse Fourier transform. You can see that\nthe red points show",
    "start": "4261810",
    "end": "4268260"
  },
  {
    "text": "the interpolated values of that\nfunction after zero-padding.",
    "start": "4268260",
    "end": "4273579"
  },
  {
    "text": "OK? So it can be a\nvery useful trick. You can also sample the\nsignal in the time domain",
    "start": "4273580",
    "end": "4282790"
  },
  {
    "text": "and then add a bunch of\nzeros to it before you Fourier transform. And that gives you finer\nsamples in the frequency domain.",
    "start": "4282790",
    "end": "4290740"
  },
  {
    "text": "OK? ",
    "start": "4290740",
    "end": "4296000"
  },
  {
    "text": "And I think that's-- so zero-padding\nin the time domain gives you finer spacing\nin the frequency domain.",
    "start": "4296000",
    "end": "4302500"
  },
  {
    "text": "And I'll show you in more\ndetail how to do this after we talk about tapering.",
    "start": "4302500",
    "end": "4308550"
  },
  {
    "text": "And it's very simple\ncode actually. Matlab has built\ninto it the ability",
    "start": "4308550",
    "end": "4317460"
  },
  {
    "text": "to do zero-padding right\nin the FFT function. OK, let's actually\njust stop there.",
    "start": "4317460",
    "end": "4328800"
  },
  {
    "text": "I feel like we covered\na lot of stuff today.",
    "start": "4328800",
    "end": "4335300"
  },
  {
    "start": "4335300",
    "end": "4342000"
  }
]