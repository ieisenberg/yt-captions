[
  {
    "text": " The following content is\nprovided under a Creative Commons license. Your support will help MIT\nOpenCourseWare continue to",
    "start": "0",
    "end": "7910"
  },
  {
    "text": "offer high quality educational\nresources for free. To make a donation or view\nadditional materials from",
    "start": "7910",
    "end": "14460"
  },
  {
    "text": "hundreds of MIT courses, visit\nMIT OpenCourseWare at",
    "start": "14460",
    "end": "20290"
  },
  {
    "text": "ocw.mit.edu.  PROFESSOR: I want to pick up\nwith a little bit of overlap",
    "start": "20290",
    "end": "27449"
  },
  {
    "text": "just to remind people\nwhere we were. We had been looking at\nclustering, and we looked at a",
    "start": "27450",
    "end": "35489"
  },
  {
    "text": "fairly simple example of using\nagglomerative hierarchical",
    "start": "35490",
    "end": "40690"
  },
  {
    "text": "clustering to cluster cities,\nbased upon how far apart they",
    "start": "40690",
    "end": "46129"
  },
  {
    "text": "were from each other cities. So, essentially, using this\ndistance matrix, we could do a",
    "start": "46130",
    "end": "51570"
  },
  {
    "text": "clustering that would\nreflect how close cities were to one another.",
    "start": "51570",
    "end": "57030"
  },
  {
    "text": "And we went through a\nagglomerative clustering, and we saw that we would get a\ndifferent answer, depending",
    "start": "57030",
    "end": "63730"
  },
  {
    "text": "upon which linkage criterion\nwe used. This is an important issue\nbecause as one is using",
    "start": "63730",
    "end": "74060"
  },
  {
    "text": "clustering, one what has to be\naware that it is related to these things, and you choose the\nwrong linkage criterion,",
    "start": "74060",
    "end": "82320"
  },
  {
    "text": "you might get an answer other\nthan the most useful. ",
    "start": "82320",
    "end": "88160"
  },
  {
    "text": "All right. I next went on and said, well,\nthis is pretty easy, because",
    "start": "88160",
    "end": "93580"
  },
  {
    "text": "when we're comparing the\ndistance between two cities or the two features, we just\nsubtract one distance from the",
    "start": "93580",
    "end": "102840"
  },
  {
    "text": "other and we get a number. It's very straightforward. I then raised the question,\nsuppose when we looked at",
    "start": "102840",
    "end": "109960"
  },
  {
    "text": "cities, we looked at a more\ncomplicated way of looking at them than airline distance.",
    "start": "109960",
    "end": "119160"
  },
  {
    "text": "So the first question, I said,\nwell, suppose in addition to the distance by air, we add the\ndistance by road, or the",
    "start": "119160",
    "end": "129949"
  },
  {
    "text": "average temperature. Pick what you will. What do we do?",
    "start": "129949",
    "end": "136310"
  },
  {
    "text": "Well, the answer was we start by\ngeneralizing from a feature",
    "start": "136310",
    "end": "143390"
  },
  {
    "text": "being a single number to the\nnotion of a feature vector,",
    "start": "143390",
    "end": "151860"
  },
  {
    "text": "where the features used to\ndescribe the city are now",
    "start": "151860",
    "end": "158320"
  },
  {
    "text": "represented by a vector,\ntypically of numbers. ",
    "start": "158320",
    "end": "167280"
  },
  {
    "text": "If the vectors are all in the\nsame physical units, we could",
    "start": "167280",
    "end": "173280"
  },
  {
    "text": "easily imagine how we might\ncompare two vectors.",
    "start": "173280",
    "end": "178410"
  },
  {
    "text": "So we might, for example, we\nlook at the Euclidean distance between the two just by,\nsay, subtracting one",
    "start": "178410",
    "end": "186480"
  },
  {
    "text": "vector from the other. However, if we think about\nthat, it can be pretty",
    "start": "186480",
    "end": "193700"
  },
  {
    "text": "misleading because, for example,\nwhen we look at a",
    "start": "193700",
    "end": "199190"
  },
  {
    "text": "city, one element of the vector\nrepresents the distance",
    "start": "199190",
    "end": "205480"
  },
  {
    "text": "in miles from another city,\nor in fact this case, the distance in miles\nto each city.",
    "start": "205480",
    "end": "212609"
  },
  {
    "text": "And another represents\ntemperatures. Well, it's kind of funny to\ncompare distance, which might",
    "start": "212610",
    "end": "219630"
  },
  {
    "text": "be thousands of miles,\nwith the temperature which might be 5 degrees.",
    "start": "219630",
    "end": "225640"
  },
  {
    "text": "A 5 degree difference in average\ntemperature could be significant. Certainly a 20 degree difference\nin temperature is",
    "start": "225640",
    "end": "232270"
  },
  {
    "text": "very significant, but a 20 mile\ndifference in location might not be very significant.",
    "start": "232270",
    "end": "239840"
  },
  {
    "text": "And so to equally weight a 20\ndegree temperature difference and at 20 miles distance\ndifference might give us a",
    "start": "239840",
    "end": "248170"
  },
  {
    "text": "very peculiar answer. And so we have to think about\nthe question of, how are we",
    "start": "248170",
    "end": "254980"
  },
  {
    "text": "going to scale the elements\nof the vectors? ",
    "start": "254980",
    "end": "274310"
  },
  {
    "text": "Even if we're in the same\nunits, say inches,",
    "start": "274310",
    "end": "280669"
  },
  {
    "text": "it can be an issue. So let's look at this example.",
    "start": "280670",
    "end": "285810"
  },
  {
    "text": "Here I've got on the left,\nbefore scaling, something",
    "start": "285810",
    "end": "291410"
  },
  {
    "text": "which we can say is in inches,\nheight and width. This is not from a person, but\nyou could imagine if you were",
    "start": "291410",
    "end": "299420"
  },
  {
    "text": "trying to cluster people, and\nyou measured their height in inches and their width in\ninches, maybe you don't want",
    "start": "299420",
    "end": "307380"
  },
  {
    "text": "to treat them equally. Right? But there's a lot more variance\nin height than in width, or maybe there is\nand maybe there isn't.",
    "start": "307380",
    "end": "315770"
  },
  {
    "text": "So here on the left we don't\nhave any scaling, and we see a very natural clustering.",
    "start": "315770",
    "end": "322830"
  },
  {
    "text": "On the other hand, we notice on\nthe y-axis the values range from not too far from 0\nto not too far from 1.",
    "start": "322830",
    "end": "334390"
  },
  {
    "text": "Whereas on the x-axis, the\ndynamic range is much less,",
    "start": "334390",
    "end": "339750"
  },
  {
    "text": "not too far from 0 to not\ntoo far from 1/2. So we have twice the dynamic\nrange here than we have here.",
    "start": "339750",
    "end": "350940"
  },
  {
    "text": "Therefore, not surprisingly,\nwhen we end up doing the clustering, width plays\na very important role.",
    "start": "350940",
    "end": "362180"
  },
  {
    "text": "And we end up clustering\nit this way, dividing it along here. On the other hand, if I take\nexactly the same data and",
    "start": "362180",
    "end": "371189"
  },
  {
    "text": "scale it, and now the x-axis\nruns from 0 to 1/2 and the",
    "start": "371190",
    "end": "378040"
  },
  {
    "text": "y-axis, roughly again, from 0\nto 1, we see that suddenly",
    "start": "378040",
    "end": "384600"
  },
  {
    "text": "when we look at it\ngeometrically, we end up getting a very different\nlook of clustering.",
    "start": "384600",
    "end": "390540"
  },
  {
    "text": "What's the moral? The moral is you have to think\nhard about how to cluster your",
    "start": "390540",
    "end": "397850"
  },
  {
    "text": "features, about how to scale\nyour features, because it can have a dramatic influence\non your answer.",
    "start": "397850",
    "end": "405580"
  },
  {
    "text": "We'll see some real life\nexamples of this shortly. But these are all the important\nthings to think",
    "start": "405580",
    "end": "412300"
  },
  {
    "text": "about, and they all, in some\nsense, tie up into the same",
    "start": "412300",
    "end": "420099"
  },
  {
    "text": "major point. Whenever you're doing any kind\nof learning, including",
    "start": "420100",
    "end": "425210"
  },
  {
    "text": "clustering, feature, selection,",
    "start": "425210",
    "end": "435819"
  },
  {
    "text": "and scaling is critical.",
    "start": "435820",
    "end": "441705"
  },
  {
    "text": " It is where most of the thinking\nends up going.",
    "start": "441705",
    "end": "451419"
  },
  {
    "text": "And then the rest gets to\nbe fairly mechanical. ",
    "start": "451420",
    "end": "457530"
  },
  {
    "text": "How do we decide what features\nto use and how to scale them? We do that using domain\nknowledge.",
    "start": "457530",
    "end": "465630"
  },
  {
    "text": " So we actually have to think\nabout the objects that we're",
    "start": "465630",
    "end": "474800"
  },
  {
    "text": "trying to learn about and what\nthe objective of the learning process is.",
    "start": "474800",
    "end": "480190"
  },
  {
    "text": " So continuing, how do\nwe do the scaling?",
    "start": "480190",
    "end": "489960"
  },
  {
    "text": "Most of the time, it's done\nusing some variant of what's called the Minkowski metric.",
    "start": "489960",
    "end": "495350"
  },
  {
    "text": " It's not nearly as imposing\nas it looks.",
    "start": "495350",
    "end": "502520"
  },
  {
    "text": "So the distance between two\nvectors, X1 and X2, and then",
    "start": "502520",
    "end": "509039"
  },
  {
    "text": "we use p to talk about,\nessentially, the degree we're",
    "start": "509040",
    "end": "514270"
  },
  {
    "text": "going to be using. So we take the absolute\ndifference between each",
    "start": "514270",
    "end": "519460"
  },
  {
    "text": "element of X1 and X2, raise it\nto the p-th power, sum them",
    "start": "519460",
    "end": "527460"
  },
  {
    "text": "and then take the 1 over p. Not very complicated,\nso let's say p is 2.",
    "start": "527460",
    "end": "536150"
  },
  {
    "text": "That's the one you people\nare most familiar with. Effectively, all we're\ndoing is getting",
    "start": "536150",
    "end": "541400"
  },
  {
    "text": "the Euclidean distance. What we looked at when we looked\nat the mean squared distance between two things,\nbetween our errors and our",
    "start": "541400",
    "end": "550970"
  },
  {
    "text": "measured data, between our\nmeasured data and our predicted data. We used the mean square error.",
    "start": "550970",
    "end": "557640"
  },
  {
    "text": "That's essentially in Minkowski\ndistance with p equal to 2.",
    "start": "557640",
    "end": "563060"
  },
  {
    "text": "That's probably the most\ncommonly used, but an almost equally commonly used sets\np equal to 1, and that's",
    "start": "563060",
    "end": "572900"
  },
  {
    "text": "something called the\nManhattan distance. ",
    "start": "572900",
    "end": "579380"
  },
  {
    "text": "I suspect at least some of you\nhave spent time walking around Manhattan, a small but densely\npopulated island in New York.",
    "start": "579380",
    "end": "589860"
  },
  {
    "text": "And midtown Manhattan has\nthe feature that it's laid out in a grid. ",
    "start": "589860",
    "end": "597120"
  },
  {
    "text": "So what you have is a grid,\nand you have the avenues",
    "start": "597120",
    "end": "605740"
  },
  {
    "text": "running north-south and the\nstreets running east-west.",
    "start": "605740",
    "end": "611730"
  },
  {
    "text": " And if you want to walk from,\nsay, here to here or drive",
    "start": "611730",
    "end": "621180"
  },
  {
    "text": "from here to here, you cannot\ntake the diagonal because there are a bunch of buildings\nin the way.",
    "start": "621180",
    "end": "627200"
  },
  {
    "text": "And so you have to move either\nleft or right, or up, or down. ",
    "start": "627200",
    "end": "633480"
  },
  {
    "text": "That's the Manhattan distance\nbetween two points. This is used, in fact, for a\nlot of problems, typically",
    "start": "633480",
    "end": "642950"
  },
  {
    "text": "when somebody is comparing the\ndistance between two genes, for example, they use a\nManhattan metric rather than a",
    "start": "642950",
    "end": "651390"
  },
  {
    "text": "Euclidean metric to say how\nsimilar two things are. ",
    "start": "651390",
    "end": "659910"
  },
  {
    "text": "Just wanted to show that because\nit is something that you will run across in the\nliterature when you read about",
    "start": "659910",
    "end": "667170"
  },
  {
    "text": "these kinds of things. ",
    "start": "667170",
    "end": "679700"
  },
  {
    "text": "All right. So far, we've talked about\nissues where things are",
    "start": "679700",
    "end": "685430"
  },
  {
    "text": "comparable. And we've been doing that by\nrepresenting each element of",
    "start": "685430",
    "end": "691600"
  },
  {
    "text": "the feature vector as a\nfloating point number.",
    "start": "691600",
    "end": "696699"
  },
  {
    "text": "So we can run a formula like\nthat by subtracting one from the other. ",
    "start": "696700",
    "end": "703620"
  },
  {
    "text": "But we often, in fact, have to\ndeal with nominal categories,",
    "start": "703620",
    "end": "709760"
  },
  {
    "text": "things that have names\nrather than numbers. ",
    "start": "709760",
    "end": "718370"
  },
  {
    "text": "So for clustering people, maybe\nwe care about eye color,",
    "start": "718370",
    "end": "724100"
  },
  {
    "text": "blue, brown, gray, green. Hair color. Well, how do you compare\nblue to green?",
    "start": "724100",
    "end": "732594"
  },
  {
    "text": "Do you subtract one\nfrom the other? Kind of hard to do. What does it mean to subtract\ngreen from blue?",
    "start": "732594",
    "end": "739490"
  },
  {
    "text": "Well, I guess we could talk\nabout it in the frequency domain, enlighten things.",
    "start": "739490",
    "end": "745220"
  },
  {
    "text": "Typically, what we have to do\nin that case is, we convert them to a number and\nthen have some ways",
    "start": "745220",
    "end": "760030"
  },
  {
    "text": "to relate the numbers. Again, this is a place where\ndomain knowledge is critical.",
    "start": "760030",
    "end": "766960"
  },
  {
    "text": "So, for example, we might\nconvert blue to 0, green to 0.5, and brown to 1, thus\nindicating that we think blue",
    "start": "766960",
    "end": "777210"
  },
  {
    "text": "eyes are closer to green eyes\nthan they are to brown eyes.",
    "start": "777210",
    "end": "782430"
  },
  {
    "text": "I don't know why we think that\nbut maybe we think that. Red hair is closer to blonde\nhair than it is to black hair.",
    "start": "782430",
    "end": "789870"
  },
  {
    "text": "I don't know. These are the sorts of things\nthat are not mathematical",
    "start": "789870",
    "end": "795120"
  },
  {
    "text": "questions, typically,\nbut judgments that people have to make.",
    "start": "795120",
    "end": "800980"
  },
  {
    "text": "Once we've converted things to\nnumbers, we then have to go",
    "start": "800980",
    "end": "807449"
  },
  {
    "text": "back to our old friend of\nscaling, which is often called",
    "start": "807450",
    "end": "814840"
  },
  {
    "text": "normalization. ",
    "start": "814840",
    "end": "821940"
  },
  {
    "text": "Very often we try and contrive\nto have every feature range",
    "start": "821940",
    "end": "827300"
  },
  {
    "text": "between 0 and 1, for example,\nso that everything is normalized to the same\ndynamic range,",
    "start": "827300",
    "end": "834870"
  },
  {
    "text": "and then we can compare. Is that the right thing to do? Not necessarily, because you\nmight consider some features",
    "start": "834870",
    "end": "842500"
  },
  {
    "text": "more important than others\nand want to give them a greater weight. And, again, that's something\nwe'll come",
    "start": "842500",
    "end": "848050"
  },
  {
    "text": "back to and look at.  All this is a bit abstract.",
    "start": "848050",
    "end": "853270"
  },
  {
    "text": "I now want to look\nat an example. Let's look at the example\nof clustering mammals.",
    "start": "853270",
    "end": "859730"
  },
  {
    "text": "There are, essentially, an\nunbounded number of features you could use, size at birth,\ngestation period, lifespan,",
    "start": "859730",
    "end": "868650"
  },
  {
    "text": "length of tail, speed,\neating habits. You name it.",
    "start": "868650",
    "end": "875149"
  },
  {
    "text": "The choice of features and\nweighting will, of course, have an enormous impact on\nwhat clusters you get.",
    "start": "875150",
    "end": "882450"
  },
  {
    "text": "If you choose size, humans might\nappear in one cluster.",
    "start": "882450",
    "end": "887910"
  },
  {
    "text": "If you choose eating habits,\nthey might appear in another.",
    "start": "887910",
    "end": "893740"
  },
  {
    "text": "How should you choose which\nfeatures you want? You have to begin by choosing,\nthinking about the reason",
    "start": "893740",
    "end": "901920"
  },
  {
    "text": "you're doing the clustering\nin the first place. What is it you're trying to\nlearn about the mammals?",
    "start": "901920",
    "end": "908005"
  },
  {
    "text": " As an example, I'm going\nto choose the",
    "start": "908005",
    "end": "913550"
  },
  {
    "text": "objective of eating habits. I want to cluster mammals\nsomehow based",
    "start": "913550",
    "end": "919940"
  },
  {
    "text": "upon what they eat. But I want to do that, and\nhere's a very important thing",
    "start": "919940",
    "end": "925610"
  },
  {
    "text": "about what we often see in\nlearning without any direct information about\nwhat they eat.",
    "start": "925610",
    "end": "932172"
  },
  {
    "text": " Typically, when we're using\nmachine learning, we're trying",
    "start": "932172",
    "end": "941720"
  },
  {
    "text": "to learn about something\nfor which we have",
    "start": "941720",
    "end": "947420"
  },
  {
    "text": "limited or no data. Remember when we talked about\nlearning, I talked about",
    "start": "947420",
    "end": "956100"
  },
  {
    "text": "learning in which it was\nsupervised, and which we had some data, and unsupervised,\nin which, essentially, we",
    "start": "956100",
    "end": "964510"
  },
  {
    "text": "don't have any labels. So let's say we don't have any\nlabels about what mammals eat,",
    "start": "964510",
    "end": "973790"
  },
  {
    "text": "but we do know a lot about\nthe mammals themselves. And, in fact, the hypothesis I'm\ngoing to start with here",
    "start": "973790",
    "end": "983380"
  },
  {
    "text": "is that you can infer people's\nor creatures' eating habits",
    "start": "983380",
    "end": "991570"
  },
  {
    "text": "from their dental records,\nor their dentitian.",
    "start": "991570",
    "end": "997260"
  },
  {
    "text": "But over time, we have evolved,\nall creatures have evolved, to have teeth that are\nrelated to what they eat,",
    "start": "997260",
    "end": "1007019"
  },
  {
    "text": "we can see. So I managed to procure a\ndatabase of dentitian for",
    "start": "1007020",
    "end": "1016149"
  },
  {
    "text": "various mammals. ",
    "start": "1016150",
    "end": "1022070"
  },
  {
    "text": "There's the laser pointer.  So what I've got here\nis the number of",
    "start": "1022070",
    "end": "1030980"
  },
  {
    "text": "different kinds of teeth. So the right top incisors, the\nright bottom incisors, molars,",
    "start": "1030980",
    "end": "1037099"
  },
  {
    "text": "et cetera, pre-molars. Don't worry if you don't know\nabout teeth very much. I don't know very much.",
    "start": "1037099",
    "end": "1043859"
  },
  {
    "text": "And then for each animal,\nI have the number of each kind of tooth. ",
    "start": "1043859",
    "end": "1049850"
  },
  {
    "text": "Actually, I don't have it for\nthis particular mammal, but these two I do. I don't even remember\nwhat they are.",
    "start": "1049850",
    "end": "1055720"
  },
  {
    "text": "They're cute.  All right. So I've got that database, and\nnow I want to try and see what",
    "start": "1055720",
    "end": "1066200"
  },
  {
    "text": "happens when I cluster them. ",
    "start": "1066200",
    "end": "1071540"
  },
  {
    "text": "The code to do this is not very\ncomplicated, but I should",
    "start": "1071540",
    "end": "1077450"
  },
  {
    "text": "make a confession about it. ",
    "start": "1077450",
    "end": "1090330"
  },
  {
    "text": "Last night, I won't\nsay I learned it. I was reminded of a lesson that\nI've often preached in",
    "start": "1090330",
    "end": "1095480"
  },
  {
    "text": "6.00, is that it's not good to\nget your programming done at the last minute.",
    "start": "1095480",
    "end": "1100810"
  },
  {
    "text": "So as I was debugging this code\nat 2:00 and 3:00 in the morning today, I was realizing\nhow inefficient I am at",
    "start": "1100810",
    "end": "1108100"
  },
  {
    "text": "debugging at that hour. Maybe for you guys that's\nthe shank of the day. For me, it's too late.",
    "start": "1108100",
    "end": "1113610"
  },
  {
    "text": "I think it all works, but I was\ncertainly not at my best as I was debugging last night.",
    "start": "1113610",
    "end": "1122570"
  },
  {
    "text": "All right. But at the moment, I don't want\nyou to spend time working",
    "start": "1122570",
    "end": "1128160"
  },
  {
    "text": "on the code itself. I would like you to think a\nlittle bit about the overall",
    "start": "1128160",
    "end": "1134550"
  },
  {
    "text": "class structure of the code,\nwhich I've got on the first page of the handout.",
    "start": "1134550",
    "end": "1140000"
  },
  {
    "text": " So at the bottom of my\nhierarchy, I've got something",
    "start": "1140000",
    "end": "1148670"
  },
  {
    "text": "called a point, and that's an\nabstraction of the things to",
    "start": "1148670",
    "end": "1156440"
  },
  {
    "text": "be clustered. And I've done it in quite a\ngeneralized way, because, as",
    "start": "1156440",
    "end": "1163780"
  },
  {
    "text": "you're going to see, the code\nwe're looking at today, I'm going to use not only for\nclustering mammals but for",
    "start": "1163780",
    "end": "1169790"
  },
  {
    "text": "clustering all sorts of\nother things as well. So I decided to take the trouble\nof building up a set",
    "start": "1169790",
    "end": "1177520"
  },
  {
    "text": "of classes that would\nbe useful. And in this class, I can have\nthe name of a point, its",
    "start": "1177520",
    "end": "1186860"
  },
  {
    "text": "original attributes. That say its original feature\nvector, an unscaled feature vector, and then whether or not\nI choose to normalize it.",
    "start": "1186860",
    "end": "1196720"
  },
  {
    "text": "I might have normalized\nfeatures as well. Again, I don't want you worry\ntoo much about the details of the code.",
    "start": "1196720",
    "end": "1203820"
  },
  {
    "text": "And then I have a distance\nmetric, and I'm just for the moment using simple Euclidean\ndistance.",
    "start": "1203820",
    "end": "1209340"
  },
  {
    "text": " The next element in my\nhierarchy, not yet a",
    "start": "1209340",
    "end": "1216550"
  },
  {
    "text": "hierarchy-- it's still flat-- is a cluster.",
    "start": "1216550",
    "end": "1221600"
  },
  {
    "start": "1221600",
    "end": "1229210"
  },
  {
    "text": "And so what a cluster is, you\ncan think of it as, at some abstract level, it's just going\nto be a set of points,",
    "start": "1229210",
    "end": "1235990"
  },
  {
    "text": "the points that are\nin the cluster. But I've got some other\noperations on it",
    "start": "1235990",
    "end": "1242605"
  },
  {
    "text": "that will be useful.  I can compute the distance\nbetween two clusters, and as",
    "start": "1242605",
    "end": "1249950"
  },
  {
    "text": "you'll see, I have single\nlinkage, Mac Link, max , average, the three I talked\nabout last week.",
    "start": "1249950",
    "end": "1256970"
  },
  {
    "text": "And also this notion\nof a centroid. We'll come back to that when we\nget to k-means clustering.",
    "start": "1256970",
    "end": "1264019"
  },
  {
    "text": " We don't need to worry right\nnow about what that is.",
    "start": "1264020",
    "end": "1269910"
  },
  {
    "start": "1269910",
    "end": "1275210"
  },
  {
    "text": "Then I'm going to have\na cluster set. That's another useful\ndata abstraction.",
    "start": "1275210",
    "end": "1280715"
  },
  {
    "start": "1280715",
    "end": "1287820"
  },
  {
    "text": "And that's what you might guess\nfrom its name, just a set of clusters.",
    "start": "1287820",
    "end": "1294000"
  },
  {
    "text": "The most interesting operation\nthere is merge. ",
    "start": "1294000",
    "end": "1300050"
  },
  {
    "text": "As you saw, when we looked at\nhierarchical clustering last week, the key step there is\nmerging two clusters.",
    "start": "1300050",
    "end": "1307269"
  },
  {
    "text": "And in doing that, I'm going to\nhave a function called Find",
    "start": "1307270",
    "end": "1314500"
  },
  {
    "text": "Closest, which given a metric\nand a cluster, finds the",
    "start": "1314500",
    "end": "1320960"
  },
  {
    "text": "cluster that is most similar to\nthat, to self, because as you, again, will recall from\nhierarchical clustering,",
    "start": "1320960",
    "end": "1328090"
  },
  {
    "text": "that's what I merged at\neach step is the two most similar clusters. ",
    "start": "1328090",
    "end": "1334580"
  },
  {
    "text": "And then there's some details\nabout how it works, which again, we don't need to worry\nabout at the moment.",
    "start": "1334580",
    "end": "1341080"
  },
  {
    "text": " And then I'm going to have a\nsubclass of point called",
    "start": "1341080",
    "end": "1350250"
  },
  {
    "text": "Mammal, in which I will\nrepresent each mammal by the",
    "start": "1350250",
    "end": "1371070"
  },
  {
    "text": "dentitian as we've\nlooked at before. ",
    "start": "1371070",
    "end": "1377870"
  },
  {
    "text": "Then pretty simply, we can do\na bunch of things with it.",
    "start": "1377870",
    "end": "1382960"
  },
  {
    "text": " Before we look at the other\ndetails of the code, I want to",
    "start": "1382960",
    "end": "1389380"
  },
  {
    "text": "now run it and see\nwhat we get. So I'm just going to use\nhierarchical clustering now to",
    "start": "1389380",
    "end": "1395960"
  },
  {
    "text": "cluster the mammals based upon\nthis feature vector, which",
    "start": "1395960",
    "end": "1401360"
  },
  {
    "text": "will be a list of numbers\nshowing how many of each kind of tooth the mammals have.",
    "start": "1401360",
    "end": "1406930"
  },
  {
    "text": "Let's see what we get. ",
    "start": "1406930",
    "end": "1417850"
  },
  {
    "text": "So it's doing the merging. ",
    "start": "1417850",
    "end": "1425390"
  },
  {
    "text": "So we can see the first step, it\nmerged beavers with ground",
    "start": "1425390",
    "end": "1430750"
  },
  {
    "text": "hogs and it merged grey\nsquirrels with porcupines, wolves and bears.",
    "start": "1430750",
    "end": "1437120"
  },
  {
    "text": "Various other kinds of things,\nlike jaguars and cougars, were a lot alike.",
    "start": "1437120",
    "end": "1443650"
  },
  {
    "text": "Eventually, it starts doing\nmore complicated merges. It merges a cluster containing\nonly the river otter with one",
    "start": "1443650",
    "end": "1450470"
  },
  {
    "text": "containing a Martin and a\nwolverine, beavers and ground",
    "start": "1450470",
    "end": "1457049"
  },
  {
    "text": "hogs with squirrels and\nporcupines, et cetera. And at the end, I had it\nstop with two clusters.",
    "start": "1457050",
    "end": "1465940"
  },
  {
    "text": "It came up with these\nclusters. Now we can look at these\nclusters and say, all right.",
    "start": "1465940",
    "end": "1473340"
  },
  {
    "text": "What do we think? Have we learned anything\ninteresting? Do we see anything\nin any of these--",
    "start": "1473340",
    "end": "1480480"
  },
  {
    "text": "do we think it makes sense? Remember, our goal was to\ncluster mammals based upon",
    "start": "1480480",
    "end": "1485560"
  },
  {
    "text": "what they might eat. And we can ask, do we think\nthis corresponds to that?",
    "start": "1485560",
    "end": "1490625"
  },
  {
    "text": " No. All right. Who-- somebody said--",
    "start": "1490625",
    "end": "1495950"
  },
  {
    "text": "Now, why no? Go ahead.",
    "start": "1495950",
    "end": "1501649"
  },
  {
    "text": "AUDIENCE: We've got-- like a\ndeer doesn't eat similar things as a dog. And we've got one type on the\ntop cluster and a different",
    "start": "1501650",
    "end": "1509759"
  },
  {
    "text": "kind of bat in the\nbottom cluster. Seems like they would be\neven closer together. PROFESSOR: Well, sorry. Yeah.",
    "start": "1509760",
    "end": "1516809"
  },
  {
    "text": "A deer doesn't eat what a dog\neats, and for that matter, we have humans here, and while\nsome human are by choice",
    "start": "1516810",
    "end": "1526050"
  },
  {
    "text": "vegetarians, genetically,\nhumans are essentially carnivores. We know that.",
    "start": "1526050",
    "end": "1531809"
  },
  {
    "text": "We eat meat. And here we are with a bunch\nof herbivores, typically.",
    "start": "1531810",
    "end": "1538300"
  },
  {
    "text": "Things are strange. By the way, bats might end up\nbeing in ones, because some bats eat fruit, other bat eat\ninsects, but who knows?",
    "start": "1538300",
    "end": "1547590"
  },
  {
    "text": "So I'm not very happy.",
    "start": "1547590",
    "end": "1553200"
  },
  {
    "text": "Why do you think we got this\nclustering that maybe isn't helping us very much? ",
    "start": "1553200",
    "end": "1562679"
  },
  {
    "text": "Well, let's go look at\nwhat we did here. Let's look at test 0.",
    "start": "1562680",
    "end": "1568480"
  },
  {
    "text": " So I said I wanted\ntwo clusters.",
    "start": "1568480",
    "end": "1576560"
  },
  {
    "text": "I don't want it to print all\nthe steps along the way. I'm going to print the\nhistory at the end.",
    "start": "1576560",
    "end": "1582669"
  },
  {
    "text": "And scaling is identity. ",
    "start": "1582670",
    "end": "1587900"
  },
  {
    "text": "Well, let's go back and look\nat some of the data here. ",
    "start": "1587900",
    "end": "1603500"
  },
  {
    "text": "What we can see is-- or maybe we can't see too\nquickly, looking at all this--",
    "start": "1603500",
    "end": "1609659"
  },
  {
    "text": "is some kinds of teeth have\na relatively small range.",
    "start": "1609660",
    "end": "1615570"
  },
  {
    "text": "Other kinds of teeth\nhave a big range. ",
    "start": "1615570",
    "end": "1620820"
  },
  {
    "text": "And so, at the moment, we're not\ndoing any normalization,",
    "start": "1620820",
    "end": "1625980"
  },
  {
    "text": "and maybe what we're doing is\ngetting something distorted where we're only looking at a\ncertain kind of tooth because",
    "start": "1625980",
    "end": "1632250"
  },
  {
    "text": "it has a larger dynamic range. And in fact, if we look at the\ncode, we can go back up and",
    "start": "1632250",
    "end": "1647250"
  },
  {
    "text": "let's look at Build Mammal\nPoints and Read Mammal Data.",
    "start": "1647250",
    "end": "1655820"
  },
  {
    "text": "So Build Mammal Points calls\nRead Mammal Data, and then",
    "start": "1655820",
    "end": "1661669"
  },
  {
    "text": "builds the points. So Read Mammal Data is the\ninteresting piece. And what we can see here\nis, as we read it in--",
    "start": "1661670",
    "end": "1675150"
  },
  {
    "text": "this is just simply reading\nthings in, ignoring comments, keeping track of things--",
    "start": "1675150",
    "end": "1682559"
  },
  {
    "text": "and then we come down here,\nI might do some scaling. ",
    "start": "1682560",
    "end": "1690010"
  },
  {
    "text": "So Point.Scale feature is using\nthe scaling argument.",
    "start": "1690010",
    "end": "1698160"
  },
  {
    "text": "Where's that coming from? ",
    "start": "1698160",
    "end": "1705429"
  },
  {
    "text": "If we look at Mammal Teeth, here\nfrom the mammal class, we",
    "start": "1705430",
    "end": "1716170"
  },
  {
    "text": "see that there are two ways to\nscale it, identity, where we just multiply every element\nin the vector by 1.",
    "start": "1716170",
    "end": "1722809"
  },
  {
    "text": " That doesn't change anything. Or what I've called\n1 over max.",
    "start": "1722810",
    "end": "1730220"
  },
  {
    "text": "And here, I've looked at the\nmaximum number of each kind of tooth and I'm dividing\n1 by that.",
    "start": "1730220",
    "end": "1738200"
  },
  {
    "text": "So here we could have up\nto three of those. Here we could have\nfour of those. We could have six of this kind\nof tooth, whatever it is.",
    "start": "1738200",
    "end": "1746790"
  },
  {
    "text": "And so we can see, by dividing\nby the max, I'm now putting all of the different kinds of\nteeth on the same scale.",
    "start": "1746790",
    "end": "1757610"
  },
  {
    "text": "I'm normalizing. And now we'll see, does that\nmake a difference?",
    "start": "1757610",
    "end": "1764340"
  },
  {
    "text": "Well, since we're dividing\nby 6 here and 3 here, it certainly could make\na difference.",
    "start": "1764340",
    "end": "1769810"
  },
  {
    "text": "It's a significant scaling\nfactor, 2X. So let's go and change the\ncode, or change the test.",
    "start": "1769810",
    "end": "1778385"
  },
  {
    "start": "1778385",
    "end": "1783430"
  },
  {
    "text": "And let's look at Test 0--",
    "start": "1783430",
    "end": "1790370"
  },
  {
    "text": " 0, not \"O\"-- with scale set to 1 over max.",
    "start": "1790370",
    "end": "1801700"
  },
  {
    "text": "You'll notice, by the way, that\nrather than using some obscure code, like scale equals\n12, I use strings so I",
    "start": "1801700",
    "end": "1809429"
  },
  {
    "text": "remember what they are. It's, I think, a pretty useful\nprogramming trick.",
    "start": "1809430",
    "end": "1816100"
  },
  {
    "text": "Whoops. Did I use the wrong\nname for this? Should be scaling?",
    "start": "1816100",
    "end": "1821790"
  },
  {
    "start": "1821790",
    "end": "1834360"
  },
  {
    "text": "So off it's going. ",
    "start": "1834360",
    "end": "1840190"
  },
  {
    "text": "Now we get a different set of\nthings, and as far as I know,",
    "start": "1840190",
    "end": "1847080"
  },
  {
    "text": "once we've scaled things, we\nget what I think is a much more sensible pair, where I\nthink what we essentially have",
    "start": "1847080",
    "end": "1853650"
  },
  {
    "text": "is the herbivores down here,\nand the carnivores up here. ",
    "start": "1853650",
    "end": "1866290"
  },
  {
    "text": "Ok. I don't care how much you\nknow about teeth. The point is scaling\ncan really matter.",
    "start": "1866290",
    "end": "1871470"
  },
  {
    "text": "You have to look at it, and you\nhave to think about what you're doing. And the interesting thing here\nis that without any direct",
    "start": "1871470",
    "end": "1878430"
  },
  {
    "text": "evidence about what mammals\neat, we are able to use machine learning, clustering in\nthis case, to infer a new",
    "start": "1878430",
    "end": "1886180"
  },
  {
    "text": "fact that we have some mammals\nthat are similar in what they",
    "start": "1886180",
    "end": "1891410"
  },
  {
    "text": "eat, and some mammals that are\nalso similar, some groups.",
    "start": "1891410",
    "end": "1897000"
  },
  {
    "text": "Now I can't infer from this\nherbivores versus carnivores because I didn't have any\nlabels to start with.",
    "start": "1897000",
    "end": "1903950"
  },
  {
    "text": "But what I can infer is that,\nwhatever they eat, there's something similar about these\nanimals, and something similar",
    "start": "1903950",
    "end": "1910870"
  },
  {
    "text": "about these animals. And there's a difference between\nthe groups in C1 and the groups in C0.",
    "start": "1910870",
    "end": "1917620"
  },
  {
    "text": "I can then go off and look at\nsome points in each of these and then try and figure out\nhow to label them later.",
    "start": "1917620",
    "end": "1926540"
  },
  {
    "text": "OK, let's look at a difference\ndata set, a far more",
    "start": "1926540",
    "end": "1932070"
  },
  {
    "text": "interesting one, a richer one. ",
    "start": "1932070",
    "end": "1945670"
  },
  {
    "text": "Now, let's not look at\nthat version of it. That's too hard to read. Let's look at the Excel\nspreadsheet.",
    "start": "1945670",
    "end": "1959500"
  },
  {
    "text": "So this is a database I found\nonline of every county in the United States, and a bunch of\nfeatures about that county.",
    "start": "1959500",
    "end": "1970510"
  },
  {
    "text": "So for each county\nin the United States, we have its name. ",
    "start": "1970510",
    "end": "1976890"
  },
  {
    "text": "The first part of the name\nis the state it's in. The second part of the name is\nthe name of the county, and a",
    "start": "1976890",
    "end": "1982580"
  },
  {
    "text": "bunch of things, like the\naverage value of homes, how much poverty, its population\ndensity, its population",
    "start": "1982580",
    "end": "1991040"
  },
  {
    "text": "change, how many people are\nover 65, et cetera.",
    "start": "1991040",
    "end": "1996610"
  },
  {
    "text": "So the thing I want you to\nnotice, of course, is while everything is a number, the\nscales are very different.",
    "start": "1996610",
    "end": "2003850"
  },
  {
    "text": "It's a big difference between\nthe percent of something, which will go between 0 and\n100, and the population",
    "start": "2003850",
    "end": "2013120"
  },
  {
    "text": "density, which ranges over a\nmuch larger dynamic range.",
    "start": "2013120",
    "end": "2018530"
  },
  {
    "text": "So we can immediately suspect\nthat scaling is going to be an issue here.",
    "start": "2018530",
    "end": "2024380"
  },
  {
    "text": " So we now have a bunch of code\nthat we can use that I've",
    "start": "2024380",
    "end": "2030399"
  },
  {
    "text": "written to process this. ",
    "start": "2030400",
    "end": "2036080"
  },
  {
    "text": "It uses the same clusters that\nwe have here, except I've",
    "start": "2036080",
    "end": "2047760"
  },
  {
    "text": "added a kind of Point\ncalled the County. Looks very different from a\nmammal, but the good news is I",
    "start": "2047760",
    "end": "2054429"
  },
  {
    "text": "got to reuse a lot of my code. Now let's run a test.",
    "start": "2054429",
    "end": "2061040"
  },
  {
    "text": "We'll go down here to Test 3,\nand we'll see whether we can",
    "start": "2061040",
    "end": "2066810"
  },
  {
    "text": "do hierarchical clustering\nof the counties. ",
    "start": "2066810",
    "end": "2078500"
  },
  {
    "text": "Whoops. Test 3 wants the name\nof what we're doing.",
    "start": "2078500",
    "end": "2083850"
  },
  {
    "text": "So we'll give it the name. It's Counties.Text.  I just exported the spreadsheet\nas a text file.",
    "start": "2083850",
    "end": "2092114"
  },
  {
    "text": " Well, we can wait a while for\nthis, but I'm not going to.",
    "start": "2092114",
    "end": "2100930"
  },
  {
    "text": "Let's think about what we know\nthat hierarchical clustering and how long this is\nlikely to take.",
    "start": "2100930",
    "end": "2108590"
  },
  {
    "text": "I'll give you a hint. There are approximately 3,100\ncounties in the United States.",
    "start": "2108590",
    "end": "2116870"
  },
  {
    "text": "I'll bet none of you could\nhave guessed that number. ",
    "start": "2116870",
    "end": "2122170"
  },
  {
    "text": "How many comparisons do we have\nto find the two counties that are most similar\nto each other? ",
    "start": "2122170",
    "end": "2132035"
  },
  {
    "text": "Comparing each county with every\nother county, how many comparisons is that\ngoing to be?",
    "start": "2132035",
    "end": "2138339"
  },
  {
    "text": "Yeah. AUDIENCE: It's 3,100 choose 2. PROFESSOR: Right. So that will be 3,100 squared.",
    "start": "2138340",
    "end": "2145850"
  },
  {
    "text": "Thank you. And that's just the first\nstep in the cluster.",
    "start": "2145850",
    "end": "2153076"
  },
  {
    "text": "To perform the next merge, we'll\nhave to do it again.",
    "start": "2153076",
    "end": "2158530"
  },
  {
    "text": " So in fact, as we've looked at\nlast time, it's going to be a",
    "start": "2158530",
    "end": "2166310"
  },
  {
    "text": "very long and tedious process,\nand one I'm not going to wait for.",
    "start": "2166310",
    "end": "2172260"
  },
  {
    "text": " So I'm going to interrupt and\nwe're going to look at a smaller example.",
    "start": "2172260",
    "end": "2177850"
  },
  {
    "start": "2177850",
    "end": "2182970"
  },
  {
    "text": "Here I've just got only the\ncounties in New England, a",
    "start": "2182970",
    "end": "2192700"
  },
  {
    "text": "much smaller number than\n3,100, and I'm going to cluster them using the exact\nsame clustering code we used",
    "start": "2192700",
    "end": "2200820"
  },
  {
    "text": "for the mammals. It's just that the\npoints are now counties instead of mammals.",
    "start": "2200820",
    "end": "2208190"
  },
  {
    "text": "And we got two clusters. Middlesex County in\nMassachusetts happens to be",
    "start": "2208190",
    "end": "2214550"
  },
  {
    "text": "the county in which\nMIT is located. And all the others--",
    "start": "2214550",
    "end": "2220130"
  },
  {
    "text": "well, you know, MIT is a pretty\ndistinctive place. Maybe that's what did it.",
    "start": "2220130",
    "end": "2226559"
  },
  {
    "text": "I don't quite think so. Someone got a hypothesis about\nwhy we got this rather strange",
    "start": "2226560",
    "end": "2233180"
  },
  {
    "text": "clustering? And is it because Middlesex\ncontains MIT and Harvard both?",
    "start": "2233180",
    "end": "2241700"
  },
  {
    "text": "This really surprised me, by the\nway, when I first ran it. I said, how can this be?",
    "start": "2241700",
    "end": "2247970"
  },
  {
    "text": "So I went and I started looking\nat the data, and what",
    "start": "2247970",
    "end": "2253880"
  },
  {
    "text": "I found is that Middlesex County\nhas about 600,000 more",
    "start": "2253880",
    "end": "2261130"
  },
  {
    "text": "people than any other county\nin New England. Who knew?",
    "start": "2261130",
    "end": "2266430"
  },
  {
    "text": "I would have guessed Suffolk,\nwhere Boston is, was the biggest county. But, in fact, Middlesex is\nenormous relative to every",
    "start": "2266430",
    "end": "2272550"
  },
  {
    "text": "other county in New England. And it turns out that difference\nof 600,000, when I",
    "start": "2272550",
    "end": "2278690"
  },
  {
    "text": "didn't scale things, just\nswamped everything else. And so all I'm really getting\nhere is a clustering that",
    "start": "2278690",
    "end": "2286610"
  },
  {
    "text": "depends on the population. Middlesex is big relative\nto everything else and,",
    "start": "2286610",
    "end": "2293520"
  },
  {
    "text": "therefore, that's what I get. And it ignores things like\neducation level and housing prices, and all those other\nthings because the differences",
    "start": "2293520",
    "end": "2301610"
  },
  {
    "text": "are small relative to 600,000.",
    "start": "2301610",
    "end": "2307190"
  },
  {
    "text": "Well, let's turn scaling on. To do that, I want to show you\nhow I do this scaling.",
    "start": "2307190",
    "end": "2314405"
  },
  {
    "text": " I did not, given the number\nof features and number of",
    "start": "2314405",
    "end": "2321230"
  },
  {
    "text": "counties, do what I did for\nmammals and count them by hand to see what the maximum was.",
    "start": "2321230",
    "end": "2326520"
  },
  {
    "text": "I decided it would be a lot\nfaster even at 2:00 in the morning to write\ncode to do it.",
    "start": "2326520",
    "end": "2333400"
  },
  {
    "text": "So I've got some code here.  I've got Build County Points,\njust like Build Mammal Points",
    "start": "2333400",
    "end": "2343140"
  },
  {
    "text": "and Read County Data, like\nRead Mammal Data. But the difference here is,\nalong the way, as I'm reading",
    "start": "2343140",
    "end": "2350940"
  },
  {
    "text": "in each county, I'm keeping\ntrack of the maximum for each feature.",
    "start": "2350940",
    "end": "2356670"
  },
  {
    "text": "And then I'm just going\nto just do the scaling automatically. So exactly the one over max\nscaling I did for mammals'",
    "start": "2356670",
    "end": "2363820"
  },
  {
    "text": "teeth, I'm going to do it for\ncounties, but I've just written some code to automate\nthat process because I knew I",
    "start": "2363820",
    "end": "2372359"
  },
  {
    "text": "would never be able\nto count them. All right, so now let's\nsee what happens if we run it that way.",
    "start": "2372360",
    "end": "2378610"
  },
  {
    "text": " Test 3, New England, and\nScale equals True.",
    "start": "2378610",
    "end": "2392380"
  },
  {
    "text": "I'm either scaling it or not,\nis the way I wrote this one. ",
    "start": "2392380",
    "end": "2409910"
  },
  {
    "text": "And with the scaling on\nagain, I get a very different set of clusters. What have we got?",
    "start": "2409910",
    "end": "2416020"
  },
  {
    "text": "Where's Middlesex? It's in one of these\n2 clusters. Oh, here it is.",
    "start": "2416020",
    "end": "2421130"
  },
  {
    "text": "It's C0. But it's with Fairfield,\nConnecticut and Hartford,",
    "start": "2421130",
    "end": "2426420"
  },
  {
    "text": "Connecticut and Providence,\nRhode Island. It's a different answer.",
    "start": "2426420",
    "end": "2432750"
  },
  {
    "text": "Is it a better answer? It's not a meaningful\nquestion, right? It depends what I'm trying to\ninfer, what we hope to learn",
    "start": "2432750",
    "end": "2440900"
  },
  {
    "text": "from the clustering, and that's\na question we're going to come back to on Tuesday in\nsome detail with the counties,",
    "start": "2440900",
    "end": "2448130"
  },
  {
    "text": "and look at how, by using\ndifferent kinds of scaling or different kinds of features, we\ncan learn different things",
    "start": "2448130",
    "end": "2455609"
  },
  {
    "text": "about the counties\nin this country. Before I do that, however,\nI want to move",
    "start": "2455610",
    "end": "2461460"
  },
  {
    "text": "away from New England. Remember we're focusing on New\nEngland because it took too",
    "start": "2461460",
    "end": "2467930"
  },
  {
    "text": "long to do hierarchical\nclustering of 3,100 counties. But that's what I want to do.",
    "start": "2467930",
    "end": "2474299"
  },
  {
    "text": "It's no good to just\nsay, I'm sorry. It took too long. I give up. Well, the good news is there\nare other clustering",
    "start": "2474300",
    "end": "2481770"
  },
  {
    "text": "mechanisms that are much\nmore efficient. We'll later see they, too,\nhave their own faults.",
    "start": "2481770",
    "end": "2491360"
  },
  {
    "text": "But we're going to look at\nk-means clustering, which has",
    "start": "2491360",
    "end": "2496720"
  },
  {
    "text": "the big advantage of being fast\nenough that we can run it on very big data sets.",
    "start": "2496720",
    "end": "2503750"
  },
  {
    "text": "In fact, it is roughly linear\nin the number of counties. And as we've seen before, when\nn gets very large, anything",
    "start": "2503750",
    "end": "2512730"
  },
  {
    "text": "that's worse than linear is\nlikely to be ineffective.",
    "start": "2512730",
    "end": "2518270"
  },
  {
    "text": "So let's think about\nhow k-means works. ",
    "start": "2518270",
    "end": "2523710"
  },
  {
    "text": "Step one, is you choose k. ",
    "start": "2523710",
    "end": "2531790"
  },
  {
    "text": "k is the total number of\nclusters you want to have when you're done. ",
    "start": "2531790",
    "end": "2538829"
  },
  {
    "text": "So you start by saying, I want\nto take the counties and split them into k-clusters.",
    "start": "2538830",
    "end": "2545019"
  },
  {
    "text": "2 clusters, 20 clusters, a 100\nclusters, 1,000 clusters. You have to choose k\nin the beginning.",
    "start": "2545020",
    "end": "2553859"
  },
  {
    "text": "And that it's one of the issues\nthat you have with k-means clustering is,\nhow do you choose k?",
    "start": "2553860",
    "end": "2562640"
  },
  {
    "text": "We can talk about that later. Once I've chosen k, I choose k\npoints as initial centroids.",
    "start": "2562640",
    "end": "2582630"
  },
  {
    "text": "You may remember earlier today\nwe saw this centroid method in",
    "start": "2582630",
    "end": "2590069"
  },
  {
    "text": "class cluster. So what's a centroid? ",
    "start": "2590070",
    "end": "2599400"
  },
  {
    "text": "You've got a cluster, and in\nthe clusters, you've got a bunch of points scattered\naround.",
    "start": "2599400",
    "end": "2605830"
  },
  {
    "text": " The centroid you can think of\nas, quote, \"the average",
    "start": "2605830",
    "end": "2612640"
  },
  {
    "text": "point,\" the center\nof the cluster.",
    "start": "2612640",
    "end": "2618490"
  },
  {
    "text": "The centroid need not be any of\nthe points in the cluster. ",
    "start": "2618490",
    "end": "2624690"
  },
  {
    "text": "So, again, you need\nsome metric. But let's say we're\nusing Euclidean. It's easy to see on the board.",
    "start": "2624690",
    "end": "2630670"
  },
  {
    "text": "The centroid is kind of there. ",
    "start": "2630670",
    "end": "2637440"
  },
  {
    "text": "Now let's assume that we're\ngoing to start by choosing",
    "start": "2637440",
    "end": "2646349"
  },
  {
    "text": "k-point from the initial\nset and labeling each of them as a centroid.",
    "start": "2646350",
    "end": "2651590"
  },
  {
    "text": " We often--",
    "start": "2651590",
    "end": "2656740"
  },
  {
    "text": "in fact, quite typically-- choose these at random. ",
    "start": "2656740",
    "end": "2669900"
  },
  {
    "text": "So we now have k randomly chosen\npoints, each of which we're going to call centroid.",
    "start": "2669900",
    "end": "2675360"
  },
  {
    "start": "2675360",
    "end": "2683100"
  },
  {
    "text": "The next step is to\nassign each point",
    "start": "2683100",
    "end": "2691310"
  },
  {
    "text": "to the nearest centroid. ",
    "start": "2691310",
    "end": "2700770"
  },
  {
    "text": "So we've got k-centroids. We usually choose a\nsmall k, say 50.",
    "start": "2700770",
    "end": "2707280"
  },
  {
    "text": "And now we have to compare each\nof the 3,100 counties to",
    "start": "2707280",
    "end": "2712510"
  },
  {
    "text": "each of the 50 centroids, and\nput each one in the correct thing, in the closest.",
    "start": "2712510",
    "end": "2718265"
  },
  {
    "text": " So it's 50 times 3,100, which\nis a lot smaller number than",
    "start": "2718265",
    "end": "2728349"
  },
  {
    "text": "3,100 squared. So now I've got a clustering.",
    "start": "2728350",
    "end": "2734630"
  },
  {
    "text": "Kind of strange, because what it\nlooks like depends on this random choice.",
    "start": "2734630",
    "end": "2740230"
  },
  {
    "text": "So there's no reason to expect\nthat the initial assignment",
    "start": "2740230",
    "end": "2745580"
  },
  {
    "text": "will give me anything\nvery useful. ",
    "start": "2745580",
    "end": "2751390"
  },
  {
    "text": "Step (4) is, for each\nof the k-clusters,",
    "start": "2751390",
    "end": "2760160"
  },
  {
    "text": "choose a new centroid. ",
    "start": "2760160",
    "end": "2777910"
  },
  {
    "text": "Now remember, I just chose\nat random k-centroids.",
    "start": "2777910",
    "end": "2783059"
  },
  {
    "text": "Now I actually have a cluster\nwith a bunch of points in it,",
    "start": "2783060",
    "end": "2789060"
  },
  {
    "text": "so I could, for example, take\nthe average of those and compute a centroid.",
    "start": "2789060",
    "end": "2794640"
  },
  {
    "text": " And I can either take the\naverage, or I can take the",
    "start": "2794640",
    "end": "2799930"
  },
  {
    "text": "point nearest the average. It doesn't much matter. ",
    "start": "2799930",
    "end": "2808190"
  },
  {
    "text": "And then step (5) is one we've\nlooked at before, assign each",
    "start": "2808190",
    "end": "2818859"
  },
  {
    "text": "point to nearest centroid. So now I'm going to get\na new clustering. ",
    "start": "2818860",
    "end": "2835510"
  },
  {
    "text": "And then, (6) is repeat\n(4) and (5) until",
    "start": "2835510",
    "end": "2847460"
  },
  {
    "text": "the change is small. ",
    "start": "2847460",
    "end": "2855520"
  },
  {
    "text": "So each time I do step (5), I\ncan keep track of how many",
    "start": "2855520",
    "end": "2861610"
  },
  {
    "text": "points I've moved from one\ncluster to another. Or each time I do step (4), I\ncan say how much have I moved",
    "start": "2861610",
    "end": "2872760"
  },
  {
    "text": "the centroids?  Each of those gives me a measure\nof how much change the",
    "start": "2872760",
    "end": "2879970"
  },
  {
    "text": "new iteration has produced. When I get to the point where\nthe iterations are not making",
    "start": "2879970",
    "end": "2887220"
  },
  {
    "text": "much of a change-- and we'll see what we\nmight mean by that-- we stop and say, OK, we now\nhave a good clustering.",
    "start": "2887220",
    "end": "2893210"
  },
  {
    "text": " So if we think of the complexity\neach iteration is",
    "start": "2893210",
    "end": "2901000"
  },
  {
    "text": "order k-n, where k is the number\nof clusters, and n is the number of points.",
    "start": "2901000",
    "end": "2907060"
  },
  {
    "text": "And then we do that step for\nsome number of iterations.",
    "start": "2907060",
    "end": "2912130"
  },
  {
    "text": "So if the number of iterations\nis small, it will converge quite quickly.",
    "start": "2912130",
    "end": "2918069"
  },
  {
    "text": "And as we'll see, typically for\nk-means, we don't need a lot of iterations to\nget an answer.",
    "start": "2918070",
    "end": "2927090"
  },
  {
    "text": "It's typically not proportional\nto n, in particular, which is\nvery important.",
    "start": "2927090",
    "end": "2934010"
  },
  {
    "text": "All right. Tuesday, we'll go over the code\nfor k-means clustering, and then have some fun playing\nwith counties and see what we",
    "start": "2934010",
    "end": "2941569"
  },
  {
    "text": "can learn about where we live. All right. Thanks a lot. ",
    "start": "2941570",
    "end": "2948117"
  }
]