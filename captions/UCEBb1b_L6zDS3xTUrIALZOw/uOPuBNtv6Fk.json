[
  {
    "text": " The following content is\nprovided under a Creative Commons license.",
    "start": "0",
    "end": "5300"
  },
  {
    "text": "Your support will help\nMIT OpenCourseWare continue to offer high quality\neducational resources for free.",
    "start": "5300",
    "end": "11600"
  },
  {
    "text": "To make a donation or to\nview additional materials from hundreds of MIT courses,\nvisit MIT OpenCourseWare",
    "start": "11600",
    "end": "18100"
  },
  {
    "text": "at ocw.mit.edu",
    "start": "18100",
    "end": "25260"
  },
  {
    "text": "WILLIAM GREEN: All\nright, so today we're going to keep on\nworking on stochastic.",
    "start": "25260",
    "end": "30859"
  },
  {
    "text": "And I guess maybe we start-- if you guys have questions\nfrom the homework set, since I'm sure you're thinking\nabout that a lot right now.",
    "start": "30860",
    "end": "38010"
  },
  {
    "text": "Are there any questions? ",
    "start": "38010",
    "end": "43751"
  },
  {
    "text": "Should I take this to mean\nthat you have it completely under control? ",
    "start": "43751",
    "end": "49281"
  },
  {
    "text": "That's good.  All right-- so since we\nhave Monte Carlo integration",
    "start": "49281",
    "end": "57329"
  },
  {
    "text": "metropolis totally\nunder control, let's talk about time dependent\nprobability distributions.",
    "start": "57330",
    "end": "66140"
  },
  {
    "text": "So in many situations,\nwe'd like to predict",
    "start": "66140",
    "end": "76420"
  },
  {
    "text": "what's going to happen\nin an experiment. And the fundamental\nequations of that experiment are time dependent, so we have\ndifferent things happening",
    "start": "76420",
    "end": "83590"
  },
  {
    "text": "at different times. And so we really\nwant to know what d dt of the probability\nof some observable--",
    "start": "83590",
    "end": "93178"
  },
  {
    "text": " this is going to\nequal something.",
    "start": "93178",
    "end": "99070"
  },
  {
    "text": "Let me fix the lights. ",
    "start": "99070",
    "end": "107810"
  },
  {
    "text": "All right, so we want\nsome equation like this. And then when you actually\nmade your measurement,",
    "start": "107810",
    "end": "115430"
  },
  {
    "text": "you'd be sampling from P. So probability of\nthe observables-- ",
    "start": "115430",
    "end": "122930"
  },
  {
    "text": "and so if you made\nthe measurement, you'd have a certain probability\nthat you observe something.",
    "start": "122930",
    "end": "128750"
  },
  {
    "text": "And you made a\ndifferent measurement, you'd have same probability\nif you made the measurement at this time. So this is going to be\nprobability of the observable",
    "start": "128750",
    "end": "137270"
  },
  {
    "text": "depending on the time. And you made the measurements\nat different times. So let's conceptually\nthink about this.",
    "start": "137270",
    "end": "142413"
  },
  {
    "text": "Suppose we had a box. And it had a uranium atom\nin it that's radioactive.",
    "start": "142414",
    "end": "148130"
  },
  {
    "text": "And it can decay. So we look in the box. And at time zero,\nI look in there.",
    "start": "148130",
    "end": "153650"
  },
  {
    "text": "And there's the uranium\natom sitting there nicely. And I go away for a while. They come back. And I open the box. And I look again later.",
    "start": "153650",
    "end": "159742"
  },
  {
    "text": "And there's some probability\nthat the uranium atom is still there. And there's some\nprobability that it fissioned during the time\nand it's gone, right?",
    "start": "159742",
    "end": "167930"
  },
  {
    "text": "OK so there must be\nsome kind of equation like this, how the probability\nthat the uranium atom",
    "start": "167930",
    "end": "173390"
  },
  {
    "text": "is still there in the box. Right, is this OK-- yeah? ",
    "start": "173390",
    "end": "181130"
  },
  {
    "text": "So just for that case, what\ndo we think the probability-- how does that probably behave-- any ideas?",
    "start": "181130",
    "end": "186519"
  },
  {
    "start": "186520",
    "end": "193100"
  },
  {
    "text": "So uranium has a half-life\nor something, right? You guys heard\nthis before, right? So let's just try to think\nof how this should scale.",
    "start": "193100",
    "end": "201149"
  },
  {
    "text": "Whatever it is, it probably\nshould have something to do with a time constant for\nhow fast uranium decays, yeah?",
    "start": "201149",
    "end": "208320"
  },
  {
    "text": " You guys are looking at\nme, like, so blankly.",
    "start": "208320",
    "end": "213690"
  },
  {
    "text": "This is not that hard. It's just one uranium atom. It's OK. All right, so let's just\nwrite a plausible equation.",
    "start": "213690",
    "end": "220269"
  },
  {
    "text": "Maybe it's dP dt, where\nthis is the probability that the uranium is in the box.",
    "start": "220270",
    "end": "226130"
  },
  {
    "text": " This might be the\nprobability divided by two.",
    "start": "226130",
    "end": "231983"
  },
  {
    "text": "Something like that--\nwould that be-- all right, I guess we need\na negative sign maybe.",
    "start": "231983",
    "end": "237440"
  },
  {
    "text": "So then the probability--\nthe solution to this would be that the probability\nthat uranium is still there",
    "start": "237440",
    "end": "243850"
  },
  {
    "text": "is going to be equal to\nsome initial probability e to the negative time over tau.",
    "start": "243850",
    "end": "250816"
  },
  {
    "text": "Does that look right?  Does this look very reasonable?",
    "start": "250816",
    "end": "256898"
  },
  {
    "text": "You might have seen\nthis before, yeah? Maybe you didn't think\nof it probability. Maybe you thought about it as\nnumber of uraniums in the box.",
    "start": "256899",
    "end": "263890"
  },
  {
    "text": "If I had written it as\nthe number of uraniums is equal to the original\nnumber of uraniums e",
    "start": "263890",
    "end": "270889"
  },
  {
    "text": "to the negative t\nover tau, you guys would have believed\nthat right away, right? ",
    "start": "270890",
    "end": "278400"
  },
  {
    "text": "OK, so I guess maybe this is\nhighlighting a issue here, is that we use a\nmacroscopic thinking.",
    "start": "278400",
    "end": "284810"
  },
  {
    "text": "We're used to thinking of\nthings as continuum, right? But if I only have one uranium\nthere, it's either there",
    "start": "284810",
    "end": "290389"
  },
  {
    "text": "or it's not there. It's 1 or 0. So the problem with\nthis equation--",
    "start": "290390",
    "end": "296740"
  },
  {
    "text": "if you compute this, it\ncomputes irrational numbers,",
    "start": "296740",
    "end": "302660"
  },
  {
    "text": "fractional numbers as\nthe number of uraniums. But of course, the\nnumber of uraniums, it's just either--\nit's integers, right?",
    "start": "302660",
    "end": "308336"
  },
  {
    "text": "There's one uranium atom, or\nthere's two, or there's three. So this equation is\nnot right, right? So this is incorrect.",
    "start": "308336",
    "end": "315394"
  },
  {
    "text": "So that was what you learned\nin high school, right-- that equation? But that's not right.",
    "start": "315394",
    "end": "320410"
  },
  {
    "text": "So this is really the correct\nequation, that the probability, that you have some number of\nuraniums that does something.",
    "start": "320410",
    "end": "326349"
  },
  {
    "text": "You know-- well this works\nfor one atom, anyway. ",
    "start": "326350",
    "end": "331780"
  },
  {
    "text": "So that's the equation for one. So this is probability\nI have one uranium.",
    "start": "331780",
    "end": "336852"
  },
  {
    "text": "It's the initial\nprobability that there's one uranium in a box,\nwhich is basically-- my case would be one. I know I put one in there.",
    "start": "336852",
    "end": "342580"
  },
  {
    "text": " And then it just decays. The probability decays.",
    "start": "342580",
    "end": "348862"
  },
  {
    "text": "But it doesn't mean\nuranium decays. So it means when I do-- if\nI do the experiment once, and here I have the uranium--",
    "start": "348862",
    "end": "358940"
  },
  {
    "text": "the probability of the uranium\nis a simple exponential decay-- time.",
    "start": "358940",
    "end": "364419"
  },
  {
    "text": "I know I had a\nuranium atom there when I first put it there. And at later times\nit's gone away,",
    "start": "364420",
    "end": "369826"
  },
  {
    "text": "right? 'Cause at\nlonger and longer times it's more and more likely\nit would have fissioned. They Now if I actually do this.",
    "start": "369826",
    "end": "375639"
  },
  {
    "text": "And make a-- buy\na million boxes. And put a million\nuranium atoms-- one in each one to start with.",
    "start": "375640",
    "end": "381549"
  },
  {
    "text": "And then I just keep\ncoming back once in a while and\nchecking, what I'll see, is that initially I had--",
    "start": "381549",
    "end": "389520"
  },
  {
    "text": "here's the number of uraniums. Initially I had a\nmillion uranium atoms.",
    "start": "389520",
    "end": "396550"
  },
  {
    "text": "And for some time period\nI still had a million. And then something\nhappened and one of them went away, because one of the\nfissioned, turned into lead--",
    "start": "396550",
    "end": "405360"
  },
  {
    "text": "or whatever they turn into. All right, and so now I had\na million minus one uraniums.",
    "start": "405360",
    "end": "412240"
  },
  {
    "text": "They live for a while. And then maybe\nanother one went away. And then this time,\nanother went away.",
    "start": "412240",
    "end": "418100"
  },
  {
    "text": "And that time it lasted longer-- right? This is what you really\nexpect to observe.",
    "start": "418100",
    "end": "424080"
  },
  {
    "text": "Is this OK? And so this is sampling from\nthe probability distribution",
    "start": "424080",
    "end": "433536"
  },
  {
    "text": "that you would use. Does that make sense? So I'm sampling a million times,\nso I have a million boxes.",
    "start": "433536",
    "end": "439620"
  },
  {
    "text": "This is the probability\ndistribution for one box. And so I'm able to\nfigure this out.",
    "start": "439620",
    "end": "445550"
  },
  {
    "text": "Is this OK?  All right, so we'd like to\nwrite equations like this",
    "start": "445550",
    "end": "454050"
  },
  {
    "text": "for more complicated systems. But you'll still going to\nhave the same confusion,",
    "start": "454050",
    "end": "459270"
  },
  {
    "text": "that the probability is going\nto be continuous variable. And it's going to\nbehave in ways that seem perfectly sensible to you.",
    "start": "459270",
    "end": "465300"
  },
  {
    "text": "But then every time\nyou do the experiment, different things\nwill happen in time. Because you have something at\nthe time-varying probability,",
    "start": "465300",
    "end": "471660"
  },
  {
    "text": "and each time you sample from\nthe probability distribution-- every time you do\nthe experiment, it's like a particular\ninstance of sampling",
    "start": "471660",
    "end": "477780"
  },
  {
    "text": "from that probability\ndistribution. And you might get that there\nis 87 uranium atoms left.",
    "start": "477780",
    "end": "483705"
  },
  {
    "text": "And you might get\nthat there's 93. And it's not because of\nyour measurement error.",
    "start": "483705",
    "end": "489030"
  },
  {
    "text": "It's because the intrinsic\nsystem has its own randomness to it, right?",
    "start": "489030",
    "end": "494304"
  },
  {
    "text": "You know, you look\nat one uranium atom-- some uranium atoms live\nfor a million years. And some uranium atoms might\ndecay in the next second,",
    "start": "494304",
    "end": "501129"
  },
  {
    "text": "right? And you have no idea when\nthey're going to decay. All you know is statistically,\non the average, uraniums decay",
    "start": "501130",
    "end": "507560"
  },
  {
    "text": "with a certain half-life,\nwhich is pretty long, right? ",
    "start": "507560",
    "end": "513692"
  },
  {
    "text": "All right, is this\ntotally obvious? I can't figure it out. Is this, like, totally\nobvious, or totally confusing? It's very funny-- with your\neyes and your expressions,",
    "start": "513692",
    "end": "520809"
  },
  {
    "text": "totally obvious and\ntotally confusing has the same blank expression. ",
    "start": "520809",
    "end": "527100"
  },
  {
    "text": "Can someone ask a question. Maybe that would\nhelp us to have a--",
    "start": "527100",
    "end": "532130"
  },
  {
    "text": "this is OK? All right, this is the OK. AUDIENCE: It's OK. WILLIAM GREEN: This is OK. All right, so it's\ntotally obvious-- good, hard to tell sometimes.",
    "start": "532130",
    "end": "538699"
  },
  {
    "text": "All right, so Joe Scott wrote\nsome brilliant notes trying to explain how do this\nfor chemical kinetics, OK?",
    "start": "538700",
    "end": "545122"
  },
  {
    "text": "So you should\ndefinitely read them. They're in the-- posted\nunder the materials, general section--",
    "start": "545122",
    "end": "550529"
  },
  {
    "text": "Stochastic Chemical Kinetics--\nnice 20 page long thing, something like that. It's definitely\nworthwhile to read it.",
    "start": "550530",
    "end": "556690"
  },
  {
    "text": "He was very nice at\nwriting very clear notes. So I'll try to explain\nhis notes inexpertly,",
    "start": "556690",
    "end": "563180"
  },
  {
    "text": "in a short period of time. I strongly recommend\nyou read them. So the idea is that the\nchemical kinetic equations",
    "start": "563180",
    "end": "572139"
  },
  {
    "text": "you guys have all used\nare also incorrect, right-- just like\nthis is incorrect. ",
    "start": "572140",
    "end": "579860"
  },
  {
    "text": "Because this is assuming\nthat something that's really a discrete variable\nis a continuous variable.",
    "start": "579860",
    "end": "585470"
  },
  {
    "text": "And we do this all\nthe time, right? We know that material\nis made of atoms. And so when you measure our\nmass in a certain volume,",
    "start": "585470",
    "end": "594110"
  },
  {
    "text": "there only can be\ncertain discrete values. But we always ignore that. And we always treat is a\ncontinuous variable, right?",
    "start": "594110",
    "end": "601019"
  },
  {
    "text": "So you have some flow-- some amount of liquid-- and you have some\namount of mass. And it could be any number.",
    "start": "601020",
    "end": "606570"
  },
  {
    "text": "And we treat dm dt, or\nthings like dm dx, d rho dx--",
    "start": "606570",
    "end": "611935"
  },
  {
    "text": "we write those down\nas if everything is perfectly continuous variables. And that's because that in\na lot of systems we have,",
    "start": "611935",
    "end": "618000"
  },
  {
    "text": "we have so many atoms-- and we can't measure\nthat well anyway-- that we couldn't tell if we\nwere missing one or two atoms.",
    "start": "618000",
    "end": "625680"
  },
  {
    "text": "Whether we end up with an extra\nhalf an atom in our equations or not makes no difference,\nbecause we're not that precise,",
    "start": "625680",
    "end": "631421"
  },
  {
    "text": "right? So we don't worry about it. So we use contiuum\nequations everywhere and-- but in many cases, what\nwe really should be using",
    "start": "631421",
    "end": "638930"
  },
  {
    "text": "are continuous equations\nfor probabilities. And then as going to show you\nhow you do it for chemical",
    "start": "638930",
    "end": "645070"
  },
  {
    "text": "kinetics in a minute. I'd say that this is super\nfundamental, actually. So quantum mechanics\nsays that everything",
    "start": "645070",
    "end": "651850"
  },
  {
    "text": "is wave functions,\nwhich is actually like the square root of\na probability density.",
    "start": "651850",
    "end": "657260"
  },
  {
    "text": "And the real equations are\nreally probability densities. And so that's the real\nfundamental equations.",
    "start": "657260",
    "end": "664940"
  },
  {
    "text": "Really, everything\nis probabilities. And when you make an\nexperiment, you're just sampling from\nthe probability. And all our continuum equations\nare like approximations.",
    "start": "664940",
    "end": "672800"
  },
  {
    "text": "They're only valid in, like,\nthe large number of atoms limit,",
    "start": "672800",
    "end": "679149"
  },
  {
    "text": "OK? I know this takes maybe\na change of thought, because you're so used to\nthose continuum equations",
    "start": "679150",
    "end": "686180"
  },
  {
    "text": "you start to believe\nthey're really true, right? You've probably used them a lot. And you start to feel like\nyou love those equations.",
    "start": "686180",
    "end": "693176"
  },
  {
    "text": "They're your favorite equations. You know, you have a\nrelationship with them. Some of them you might\nhate, some you love. But at least, you have a\nstrong connection with them.",
    "start": "693176",
    "end": "700130"
  },
  {
    "text": "And you just find out\nthat actually they're not even related to\nthe real equations. The real equations are\nactually something different.",
    "start": "700130",
    "end": "705256"
  },
  {
    "text": "This can be very\nannoying, but it's true. And when you get to smaller\nand smaller systems that have fewer and fewer\nmolecules in them,",
    "start": "705256",
    "end": "712801"
  },
  {
    "text": "then you get more and\nmore sensitive to the fact that the regular\nequations are incorrect. And this comes up a\nlot in small systems.",
    "start": "712801",
    "end": "720880"
  },
  {
    "text": "So many of you probably\nwill do research that has to do with biology. In biology there's cells.",
    "start": "720880",
    "end": "727040"
  },
  {
    "text": "Inside cells there's\nsubcellular structures. Inside those\nsubcellular structures, there's not very many molecules.",
    "start": "727040",
    "end": "733949"
  },
  {
    "text": "And so you often are at the\nlimit where you have, like, one molecule of a certain\ntype inside this mitochondria,",
    "start": "733950",
    "end": "740779"
  },
  {
    "text": "or something. And that's it. And so you wouldn't expect the\ncontinuum equations to work.",
    "start": "740780",
    "end": "747440"
  },
  {
    "text": "And in fact there's\na big field-- many people at\nresearch do in here-- called single\nmolecule spectroscopy,",
    "start": "747440",
    "end": "753230"
  },
  {
    "text": "where you can measure the\nmotion of one DNA molecule or something like that. And so you really see\nthe individual molecules,",
    "start": "753230",
    "end": "761870"
  },
  {
    "text": "and the effects of the\nindividuality of the molecules. And this is not only\ntrue in biology.",
    "start": "761870",
    "end": "768995"
  },
  {
    "text": " For a long time--\nthere's a field called emulsion polymerization.",
    "start": "768995",
    "end": "775040"
  },
  {
    "text": "You guys ever hear of this? So like, all the\npaint on the walls here is made by that\nprocess, where they",
    "start": "775040",
    "end": "780259"
  },
  {
    "text": "polymerize methyl methacrylate. They want to make the\nlittle beads of polymers all have a small\ndispersion as possible,",
    "start": "780259",
    "end": "787900"
  },
  {
    "text": "to make all the\nmolecules the same. So what they do is they make\na colloidal suspension-- I'm going to draw\na little picture.",
    "start": "787900",
    "end": "794050"
  },
  {
    "text": "So they have the reactor. They make little bubbles\nof the monomer that",
    "start": "794050",
    "end": "800570"
  },
  {
    "text": "are suspended in some solid. And inside each\nof these bubbles-- because the way they\nmake them, they're",
    "start": "800570",
    "end": "806465"
  },
  {
    "text": "all about the same size. So they all have\na lot of bubbles, all about the same size. And then they polymerize.",
    "start": "806465",
    "end": "811565"
  },
  {
    "text": "And they polymerize\neach of them. And they polymerize. And basically, all the\nmaterial that's there polymerizes into one molecule.",
    "start": "811565",
    "end": "818100"
  },
  {
    "text": "Now how do they\nmake that happen-- is that they introduce,\nsay, a free radical.",
    "start": "818100",
    "end": "823800"
  },
  {
    "text": "And one free radical gets\ninto one of these bubbles. And it can polymerize\nthe whole thing,",
    "start": "823800",
    "end": "828959"
  },
  {
    "text": "because the reactions\nare a radical plus monomer goes to a polymer--",
    "start": "828960",
    "end": "834840"
  },
  {
    "text": "bigger polymer, right? So polymer radical\nsize n goes to polymer",
    "start": "834840",
    "end": "841610"
  },
  {
    "text": "radical size n plus 1. That's the\npolymerization reaction. Now normally, if you\ndid this in the bulk,",
    "start": "841610",
    "end": "848910"
  },
  {
    "text": "there would be a\nlot of radicals. And some of these guys\nwould react with each other.",
    "start": "848910",
    "end": "856420"
  },
  {
    "text": " And the radical will be gone,\nbecause the two radicals would",
    "start": "856420",
    "end": "861930"
  },
  {
    "text": "react, make a new chemical bond,\nand this process would stop. And so this gives a big\ndispersion in the size",
    "start": "861930",
    "end": "869110"
  },
  {
    "text": "of the polymer chains you get. So to beat this, they do\nemulsion polymerization. And they make that number\nof radicals so small",
    "start": "869110",
    "end": "875890"
  },
  {
    "text": "that statistically, at any\ntime, any of these droplets either has zero or\none of radicals in it.",
    "start": "875890",
    "end": "882930"
  },
  {
    "text": "And there's not--\nduring the time it does the polymerization,\nthere's not enough time for a second radical to come in.",
    "start": "882930",
    "end": "889114"
  },
  {
    "text": "So it's only got one\nradical, so that one radical is going to eat up\nevery single monomer molecule in the whole thing.",
    "start": "889114",
    "end": "894524"
  },
  {
    "text": "And so it's going take\na giant polymer, that's a whole size of the emulsion. If you made the drops too big,\nyou get two radicals in there.",
    "start": "894524",
    "end": "902641"
  },
  {
    "text": "And you get some\nof this happening. And then you get a dispersion. So this is emulsion\npolymerization.",
    "start": "902642",
    "end": "909670"
  },
  {
    "text": " All right, so cells have\nsmall little volumes.",
    "start": "909670",
    "end": "918320"
  },
  {
    "text": "Colloids and emulsions\nhave small little volumes. They all have-- that the-- some of the molecules-- the\nimportant molecules are so--",
    "start": "918320",
    "end": "926696"
  },
  {
    "text": "have such low concentrations--\nthe volumes are so small, that the concentration times\nthe volume is less than 1,",
    "start": "926697",
    "end": "931850"
  },
  {
    "text": "or about 1. So that's for like-- you know,\nyour copies of DNA in you,",
    "start": "931850",
    "end": "937370"
  },
  {
    "text": "in your cells. It's the same kind of thing\nfor radicals-- free radicals",
    "start": "937370",
    "end": "942800"
  },
  {
    "text": "in a polymerization system. And similar things could\nhappen with, like, explosions-- different kinds of\nrare events, that you",
    "start": "942800",
    "end": "948860"
  },
  {
    "text": "might have a very small\nnumber of some really important molecule. And then whether or\nnot you have one or not",
    "start": "948860",
    "end": "953900"
  },
  {
    "text": "is really important, OK. All right, so we want to\nmodel those kinds of systems,",
    "start": "953900",
    "end": "960490"
  },
  {
    "text": "we have to worry\nabout the graininess. So we want to write down\nwhat the equation is dP dt. ",
    "start": "960490",
    "end": "968240"
  },
  {
    "text": "So first you've got to\nthink, well what is P? Let's do a case where I have\nthe reaction of A plus B",
    "start": "968240",
    "end": "979625"
  },
  {
    "text": "goes to C, OK? Suppose this is the\nonly reaction that can happen in our system. The only molecules we\nhave in our system are",
    "start": "979625",
    "end": "986333"
  },
  {
    "text": "A's, B's, and C's. And so our probability\ndistribution-- our probability\nthat we want to know is how many A's, how\nmany B's, how many C's do",
    "start": "986333",
    "end": "994170"
  },
  {
    "text": "we have in our system, OK? So that's the probability\nwe're interested to know.",
    "start": "994170",
    "end": "1001940"
  },
  {
    "text": "We could have 5 A's,\n2 B's, and 0 C's. We could have 3 A's, 7 B's,\n11 C's-- who knows, right--",
    "start": "1001940",
    "end": "1009720"
  },
  {
    "text": "different numbers like that. If it gets out to be 10 to\nthe 23, then there's no point. You don't have to do\nthis, because you can just",
    "start": "1009720",
    "end": "1015352"
  },
  {
    "text": "go back your continuum\nequations, right? But if you have 5, or\n3, or 2, or 1, or 0,",
    "start": "1015353",
    "end": "1020450"
  },
  {
    "text": "then you really need to\nworry about the graininess. So you want to write\ndown an equation.",
    "start": "1020450",
    "end": "1027189"
  },
  {
    "text": "So here's a probability\nof n A n B n C.",
    "start": "1027190",
    "end": "1033819"
  },
  {
    "text": "And it's going to equal to\nreactions which consume--",
    "start": "1033819",
    "end": "1040214"
  },
  {
    "text": "if I'm in this state\nthat has a certain number A's, B's, and C's,\nand I can react away,",
    "start": "1040214",
    "end": "1045670"
  },
  {
    "text": "so I only have reactions-- for example, I'm in this state. An d plus B could\nreact with each other,",
    "start": "1045670",
    "end": "1052020"
  },
  {
    "text": "and will react away. So I'll have some reaction. I'm going to write\na k, but we'll come back to what this really\nmeans exactly in a minute.",
    "start": "1052020",
    "end": "1059779"
  },
  {
    "text": "So this is the k for\nA plus B going to C.",
    "start": "1059780",
    "end": "1066040"
  },
  {
    "text": "And we think that\nthis is going to scale with the number of A's and the\nnumber of B's I've got, right?",
    "start": "1066040",
    "end": "1073370"
  },
  {
    "text": "And this depends on the\nprobability that I have A B C.",
    "start": "1073370",
    "end": "1081670"
  },
  {
    "text": "So if I'm in this state\nwith n A's n B's n C's--",
    "start": "1081670",
    "end": "1088310"
  },
  {
    "text": "that probability is\ngoing to go down, because the A's and B's can\nreact with each other, right?",
    "start": "1088310",
    "end": "1094330"
  },
  {
    "text": "Now on the other hand,\nI have plus the same k. ",
    "start": "1094330",
    "end": "1102790"
  },
  {
    "text": "And this is going to\nbe n A prime n B prime. ",
    "start": "1102790",
    "end": "1115890"
  },
  {
    "text": "If I have some other state\nthat can react so that it makes this state, then\nI'll get a plus sign,",
    "start": "1115890",
    "end": "1122730"
  },
  {
    "text": "because probability of\nthis state would increase. So for example, if n A prime\nis equal to n A plus 1.",
    "start": "1122730",
    "end": "1132700"
  },
  {
    "text": "And n B prime is\nequal to n B plus 1 and n C prime is\nequal to n C minus 1,",
    "start": "1132700",
    "end": "1142720"
  },
  {
    "text": "then that state can react\nby one of these A's and one of these B's combining together\nto make a C. That will get me",
    "start": "1142720",
    "end": "1149220"
  },
  {
    "text": "to this exact state here. Does this make sense?",
    "start": "1149220",
    "end": "1154710"
  },
  {
    "text": "All Right, so that's\nthe master equation if I have a system\nthat could only",
    "start": "1154710",
    "end": "1160710"
  },
  {
    "text": "do the irreversible reaction A\nplus B goes to C. So the only--",
    "start": "1160710",
    "end": "1165860"
  },
  {
    "text": "I can go away-- because\nthe probability density of this-- the probability\nthat this state can reduce, because that reaction occurs\nstarting from this state.",
    "start": "1165860",
    "end": "1173310"
  },
  {
    "text": "And probability this\nstate can increase, because I started from\nthis other state here-- this special state here.",
    "start": "1173310",
    "end": "1179040"
  },
  {
    "text": "And that would make\nthe state interest. All right and so I have\nequation-- this equation",
    "start": "1179040",
    "end": "1185020"
  },
  {
    "text": "over and over again, for every\npossible value of n A, n B, n C. Is this OK?",
    "start": "1185020",
    "end": "1190140"
  },
  {
    "text": " Now I have to actually--",
    "start": "1190140",
    "end": "1195200"
  },
  {
    "text": "remember for chemical\nkinetics, that whenever you have a forward reaction, you\nalso have the reverse reaction.",
    "start": "1195200",
    "end": "1201990"
  },
  {
    "text": "So there's actually\na couple more terms. So now I have another loss term.",
    "start": "1201990",
    "end": "1208010"
  },
  {
    "text": "This is C goes to A plus B. This\nis going to tell of the number of C's.",
    "start": "1208010",
    "end": "1213920"
  },
  {
    "text": "And that's P of n\nA n B n C. And then",
    "start": "1213920",
    "end": "1220100"
  },
  {
    "text": "I have another source term. ",
    "start": "1220100",
    "end": "1228210"
  },
  {
    "text": "And this is where I start\nfrom the state with one more C. Is that OK?",
    "start": "1228210",
    "end": "1250360"
  },
  {
    "text": "So this set of equations is\ncalled the kinetic master",
    "start": "1250360",
    "end": "1255370"
  },
  {
    "text": "equation. And this is the equation that\ndescribes the real system.",
    "start": "1255370",
    "end": "1260750"
  },
  {
    "text": "So this is the real probability\nof finding the system with any number of A's, B's, and C's.",
    "start": "1260750",
    "end": "1267350"
  },
  {
    "text": "And I have an equation like this\nfor every different possible number of A's, number\nof B's, number of C's.",
    "start": "1267350",
    "end": "1274630"
  },
  {
    "text": "All right? And it's not bad as\nan equation goes.",
    "start": "1274630",
    "end": "1280350"
  },
  {
    "text": "It's a linear\ndifferential equation, because it's linear\nin P's, right? There's just first--\neverything's first power in P.",
    "start": "1280350",
    "end": "1289140"
  },
  {
    "text": "So in general, I can rewrite\nthis as dP dt is the some",
    "start": "1289140",
    "end": "1298950"
  },
  {
    "text": "matrix times B. And the matrix\nentries are these prefactors--",
    "start": "1298950",
    "end": "1305730"
  },
  {
    "text": "things like this and this-- sorry, this, this.",
    "start": "1305730",
    "end": "1312550"
  },
  {
    "text": "These are the different\nelements in the matrix, m. ",
    "start": "1312550",
    "end": "1320790"
  },
  {
    "text": "So you should go ahead\nand be able to write",
    "start": "1320790",
    "end": "1326790"
  },
  {
    "text": "any kinetic equation system--\nrewrite it in this form if you want. It's called the kinetic\nmaster equation.",
    "start": "1326790",
    "end": "1332740"
  },
  {
    "start": "1332740",
    "end": "1343751"
  },
  {
    "text": "Now if I do an\nexperiment like I talked about with uranium, where I\nput one uranium atom in there.",
    "start": "1343751",
    "end": "1348980"
  },
  {
    "text": "And all uranium\natoms can react to do is fall apart to\nlead plus neutrons, or whatever the heck\nthey fall apart to.",
    "start": "1348980",
    "end": "1354382"
  },
  {
    "text": "So I can write down--\nthere's like one reaction that uranium nuclei do. And so I can write it out.",
    "start": "1354382",
    "end": "1359630"
  },
  {
    "text": "It will just be\nsomething like this. And this equation\nwill work for a case where I put one uranium\natom in there to begin with.",
    "start": "1359630",
    "end": "1365880"
  },
  {
    "text": "I could do the case where I\nput two uranium atoms in there to begin with. I could write this down. Is that all right?",
    "start": "1365880",
    "end": "1372720"
  },
  {
    "text": "OK, now if I had a case where I\nhad 27 A's, 14 B's, and 33 C's",
    "start": "1372720",
    "end": "1382230"
  },
  {
    "text": "to start with, then you\ncan see that the number of possibilities here\nmight get pretty large.",
    "start": "1382230",
    "end": "1388490"
  },
  {
    "text": "'Cause I have to consider,\nwell, I could lose one A, and lose one B,\nand get one more C.",
    "start": "1388490",
    "end": "1393540"
  },
  {
    "text": "But then I'll have an\nequation for this term which will look just like this. But it'll go to ones where\nI have lost two A's and two",
    "start": "1393540",
    "end": "1399880"
  },
  {
    "text": "B's and gained two C's. And then all the way down, until\nyou get down to one of the n's to be zero.",
    "start": "1399880",
    "end": "1406630"
  },
  {
    "text": "And so it could be quite a lot\nof possible equations, right? So the dimension-- the\nlength of the vector P",
    "start": "1406630",
    "end": "1414610"
  },
  {
    "text": "might get really long, right? So the length of P is something\nlike the max number of A's, max",
    "start": "1414610",
    "end": "1432110"
  },
  {
    "text": "number of B's,\nmax number of C's. ",
    "start": "1432110",
    "end": "1440690"
  },
  {
    "text": "All right, so if I have-- I'll allow-- consider systems\nwith up to 10 A's, 10 B's, 10",
    "start": "1440690",
    "end": "1446010"
  },
  {
    "text": "C's-- then this is 1,000-- P's a length of\napproximately 1,000.",
    "start": "1446010",
    "end": "1451492"
  },
  {
    "text": "And it might be less than\nthat, because maybe there's some of them-- some particular\nstates I can't get to.",
    "start": "1451492",
    "end": "1457159"
  },
  {
    "text": "So maybe it's less than 1,000,\nbut something like 1,000. On the other hand, if\nI allow it to a million A's, a million B's, and\nmillions C's, then I,",
    "start": "1457160",
    "end": "1464390"
  },
  {
    "text": "like, 10 to the 18 length of P.\nSo P gets pretty long, pretty fast when the number of\npossible states goes up.",
    "start": "1464390",
    "end": "1473990"
  },
  {
    "text": "Is that all right? So-- now, it's linear though.",
    "start": "1473990",
    "end": "1480780"
  },
  {
    "text": "And it's linear. And this is constant\ncoefficients. And so this is really\nnot-- and sparse. So this is really--\nit's not that bad.",
    "start": "1480780",
    "end": "1487460"
  },
  {
    "text": "And in fact Professor\nBarton's group has worked on these\nkind of problems. And he has to solves that can\nwork with P has dimension up",
    "start": "1487460",
    "end": "1494450"
  },
  {
    "text": "to 200 million. So if you can keep the number--\nsay it's 200 million or less, you can actually\nsolve this exactly.",
    "start": "1494450",
    "end": "1501360"
  },
  {
    "text": "Now solving this\nexactly is really good, because then you actually\nhave the exact probability of any observable measurement\nthat you would possibly make",
    "start": "1501360",
    "end": "1509620"
  },
  {
    "text": "at any time, all computed, OK? So that's really great.",
    "start": "1509620",
    "end": "1515010"
  },
  {
    "text": "But as I just pointed out,\nif I make these numbers, like, 10 to the 6, 10 to\nthe 6, and 10 to the 6-- this is like 10 of the 18.",
    "start": "1515010",
    "end": "1520380"
  },
  {
    "text": "That's a lot bigger\nthan 200 million. And so Professor Barton's\nnumerical methods",
    "start": "1520380",
    "end": "1527600"
  },
  {
    "text": "are going to poop\nout at some point, and not going to\nwork for you anymore. So there's a limited number\nof problems you can do.",
    "start": "1527600",
    "end": "1534770"
  },
  {
    "text": "So if your problem small enough,\nyou can just solve this-- for really small ones you can\nsolve this with OD45 or OD15s",
    "start": "1534770",
    "end": "1543620"
  },
  {
    "text": "But because it's linear, there's\nspecial solution methods. I don't know if you remember\nsolutions of linear equations",
    "start": "1543620",
    "end": "1549260"
  },
  {
    "text": "this, you can relate\nthem to the eigenvectors and eigenvalues of m. And so you can do--\nthat's one way to do it.",
    "start": "1549260",
    "end": "1556484"
  },
  {
    "text": "And then there are special\nmethods you can do. Talk to Professor Barton. If it's sparse-- and it has\ncertain kinds properties,",
    "start": "1556484",
    "end": "1562421"
  },
  {
    "text": "you can make this really-- you\ncan make quite large systems, up to 10 to the 8 kind of size.",
    "start": "1562421",
    "end": "1568820"
  },
  {
    "text": "If we get a system with more\nthan 10 to 8 possible states, that means more than 10\nto the 8 possible things could be observed or\nthe result of experiment",
    "start": "1568820",
    "end": "1576770"
  },
  {
    "text": "could have more than\n10 to 8 possibilities, then this is-- you're\nnot going to be able to solve it this way.",
    "start": "1576770",
    "end": "1581970"
  },
  {
    "text": "And so then we're\ngoing to have to use a stochastic solid solution\nmethod to try to figure-- to do-- so we're going to\ntry a sample from P of t.",
    "start": "1581970",
    "end": "1591290"
  },
  {
    "text": "So I guess I should comment,\nagain, I wrote it this way. But the thing-- P is definitely--\nit depends on time. So it's you'll have\ndifferent P for every time.",
    "start": "1591290",
    "end": "1598228"
  },
  {
    "text": " Yeah?",
    "start": "1598228",
    "end": "1603315"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]",
    "start": "1603315",
    "end": "1618167"
  },
  {
    "text": "WILLIAM GREEN: Yeah maybe\nI'll just do better to-- I can substitute it in here. ",
    "start": "1618167",
    "end": "1637250"
  },
  {
    "text": "Is that all right? AUDIENCE: So, like, if you\ntransfer all the neighbors in it, that's--?",
    "start": "1637250",
    "end": "1642750"
  },
  {
    "text": "WILLIAM GREEN: Yeah,\n'cause a key idea is that chemical kinetics\nonly does one step at a time.",
    "start": "1642750",
    "end": "1654720"
  },
  {
    "text": "So if you have a reaction\nlike this, at any instant",
    "start": "1654720",
    "end": "1661954"
  },
  {
    "text": "the probability\nthat two reactions are going to be happening\nexactly the same instant is negligible. So at any instant you're\nonly changing the numbers",
    "start": "1661954",
    "end": "1670150"
  },
  {
    "text": "of the atoms by one unit, yeah. AUDIENCE: Then shouldn't\nyou add another A minus 1",
    "start": "1670150",
    "end": "1675664"
  },
  {
    "text": "and an E minus 1?  WILLIAM GREEN: Maybe\nI got this backwards.",
    "start": "1675664",
    "end": "1681480"
  },
  {
    "text": "n A plus 1 plus 1 minus 1,\nminus 1 minus 1 plus 1--",
    "start": "1681480",
    "end": "1687679"
  },
  {
    "text": "I think got-- I\nthink this is right. So this is for the forward\nreaction that always reduces",
    "start": "1687680",
    "end": "1694600"
  },
  {
    "text": "the number of A's and B's. And this is the reverse reaction\nthat always increases them. And so I think you\ngenerally get like this.",
    "start": "1694600",
    "end": "1700117"
  },
  {
    "text": "You always get--\nfor any reaction, you'll have four terms-- so the forward and\nreverse, starting",
    "start": "1700117",
    "end": "1706649"
  },
  {
    "text": "from initial state, and\nthe forward and reverse that make your state. ",
    "start": "1706650",
    "end": "1712762"
  },
  {
    "text": "And then if you\nadd more reactions, you have a system where you've\ngot a lot more reactions. Maybe you have C's\nthat can just decompose",
    "start": "1712762",
    "end": "1718150"
  },
  {
    "text": "into B's or something--\ndifferent reactions. Then you'd have a sum\nlike this with terms",
    "start": "1718150",
    "end": "1724149"
  },
  {
    "text": "like this from every reaction. And you'd go through all your\nlist of all your reaction. ",
    "start": "1724150",
    "end": "1730647"
  },
  {
    "text": "I guess there's one funny\nthing I should point out to you about this, which is\nvery important for this emulsion",
    "start": "1730647",
    "end": "1736120"
  },
  {
    "text": "polymerization case-- Is that if you have a reaction\nof the type A plus A goes to--",
    "start": "1736120",
    "end": "1747480"
  },
  {
    "text": "I don't know-- B. That might\nbe a reaction you could have.",
    "start": "1747480",
    "end": "1754900"
  },
  {
    "text": "That when I write down\nthe equation, if I only have one A in my sample, this\nprobability of this happening",
    "start": "1754900",
    "end": "1763169"
  },
  {
    "text": "is 0, right? Because I need two A's\nfor this to happen. So really, the equation for this\ncase is n A times n A minus 1.",
    "start": "1763170",
    "end": "1775030"
  },
  {
    "text": "So it's k A plus A goes to B\ntimes n A times n A minus 1.",
    "start": "1775030",
    "end": "1781720"
  },
  {
    "text": " And this is crucial for, like,\nthe emulsion polymerization",
    "start": "1781720",
    "end": "1787140"
  },
  {
    "text": "case, 'cause the fact that I\ndon't have the second one is really important. ",
    "start": "1787140",
    "end": "1794312"
  },
  {
    "text": "Otherwise I always\nmiscompute that this radical could react with\nitself and terminate itself, which is not true. ",
    "start": "1794312",
    "end": "1801774"
  },
  {
    "text": "Is that all right? ",
    "start": "1801774",
    "end": "1809600"
  },
  {
    "text": "I commented that these\nk's are a little bit odd. So if you remember, if you\nhave a k for a unimolecular",
    "start": "1809600",
    "end": "1815840"
  },
  {
    "text": "reaction, like C goes to A plus\nB, what units would it have? ",
    "start": "1815840",
    "end": "1822550"
  },
  {
    "text": "What are the units\nfor regular kinetics? AUDIENCE: Inverse seconds. WILLIAM GREEN: Right,\ninverse seconds, right?",
    "start": "1822550",
    "end": "1828240"
  },
  {
    "text": "So you would normally\nsay this thing has units of inverse seconds. And that works fine here, right? Because I have dP dt, and\nit's in for a seconds times P,",
    "start": "1828240",
    "end": "1836760"
  },
  {
    "text": "so it's fine. However, this guy-- to make\nthe units work out, still",
    "start": "1836760",
    "end": "1842020"
  },
  {
    "text": "has to also be inverse seconds,\nbut that's not normally what you would have for\na bimolecular reaction. ",
    "start": "1842020",
    "end": "1849640"
  },
  {
    "text": "And the other thing to watch\nout for here is that I have n's. But normally you would write\nthem with concentrations,",
    "start": "1849640",
    "end": "1856270"
  },
  {
    "text": "right? You have the-- you'd\nwould write something like k times the\nconcentration of C. It's",
    "start": "1856270",
    "end": "1862490"
  },
  {
    "text": "the normal way you write your\nequations, the right equations. But this is not the same, right? This is n. This is unitless.",
    "start": "1862490",
    "end": "1871010"
  },
  {
    "text": "Now it turns out, in\nthis case, actually, you can use exactly the\nsame as k and it works.",
    "start": "1871010",
    "end": "1876029"
  },
  {
    "text": "But for the bimolecular case,\nit definitely does not work. The units are wrong. And also this\nconcentration thing",
    "start": "1876030",
    "end": "1883889"
  },
  {
    "text": "implies that we think\nthe rate really has-- suppose we have k A k B. I\ncould rewrite this as k times n",
    "start": "1883890",
    "end": "1892770"
  },
  {
    "text": "A over the volume,\nn B over the volume.",
    "start": "1892770",
    "end": "1897880"
  },
  {
    "text": "Is that all right? Actually one thing I should\nwarn you about-- that usually when I write this,\nI write moles per liter.",
    "start": "1897880",
    "end": "1905419"
  },
  {
    "text": "So I have factors of 10 to\nthe 23 between this and this, because these n's have got to\nbe the individual molecules",
    "start": "1905420",
    "end": "1911520"
  },
  {
    "text": "for this to work. So watch out. First of all, there's a 10\nto the 23 somewhere in here,",
    "start": "1911520",
    "end": "1917679"
  },
  {
    "text": "right-- Avogadro's number. And then this is what-- how we would normally write it.",
    "start": "1917680",
    "end": "1923030"
  },
  {
    "text": "But this k has the\nwrong units for us here. And so this guy here is the\nnormal k divided by the volume.",
    "start": "1923030",
    "end": "1937218"
  },
  {
    "text": " I think that's right.",
    "start": "1937218",
    "end": "1945422"
  },
  {
    "text": "Maybe it's the other way around. No, this is normal\nk times the volume.",
    "start": "1945422",
    "end": "1951489"
  },
  {
    "text": "That's right. So normally we would\nwrite units k normal--",
    "start": "1951489",
    "end": "1957450"
  },
  {
    "text": "normal kinetics, macro--\nk for A plus B reactions,",
    "start": "1957450",
    "end": "1967429"
  },
  {
    "text": "the units are centimeters\ncubed per mole second. ",
    "start": "1967430",
    "end": "1975750"
  },
  {
    "text": "But we want them\nto be units of-- ",
    "start": "1975750",
    "end": "1982180"
  },
  {
    "text": "the new k has got to\nbe units of per second.",
    "start": "1982180",
    "end": "1988227"
  },
  {
    "text": " And so the new k is equal to the\nold k new old times the volume.",
    "start": "1988227",
    "end": "2003515"
  },
  {
    "text": " Is that right-- no\ndivided by the volume. I was right the first time.",
    "start": "2003515",
    "end": "2009760"
  },
  {
    "text": "This is volume-- yeah. Thank you-- centimetres\ncubed, centimeters cubed--",
    "start": "2009760",
    "end": "2016530"
  },
  {
    "text": "yeah, right. Cancelled out,\ngood for a second. So this is k per volume normal\nk divided by n-- correct.",
    "start": "2016530",
    "end": "2026458"
  },
  {
    "text": " And you may wonder,\nwell how come it's only volume to the first power?",
    "start": "2026458",
    "end": "2033240"
  },
  {
    "text": "Before I had volume\nto the second power in the denominator. And it's because I'm using\nn's up in the numerator.",
    "start": "2033240",
    "end": "2041480"
  },
  {
    "text": "And it's just like here. I'm using n's\ninstead of n over v. So I've sort of multiplied\nthrough by v everywhere.",
    "start": "2041480",
    "end": "2047340"
  },
  {
    "text": "That's one way to look at it. All right, no questions yet?",
    "start": "2047340",
    "end": "2056248"
  },
  {
    "text": "Yeah? AUDIENCE: So when\nyou [INAUDIBLE]  WILLIAM GREEN: Yeah, so I\nneed a 10 to the 23 as well.",
    "start": "2056248",
    "end": "2063739"
  },
  {
    "text": "So there's got to be\nan Avogadro's number. And you'll have to help me where\nthe Avogadro's number goes. But it's got to be\nin there somewhere,",
    "start": "2063739",
    "end": "2070449"
  },
  {
    "text": "to get from moles to molecules. So the numbers are\na lot different.",
    "start": "2070449",
    "end": "2076054"
  },
  {
    "text": " Is this OK?",
    "start": "2076055",
    "end": "2084279"
  },
  {
    "text": "And this factor, this\nn minus 1 thing-- again, when these are\nmacroscopic numbers like 10 to the 23, this makes\nno difference, right?",
    "start": "2084280",
    "end": "2090331"
  },
  {
    "text": "Because it's minus 1. So we can fit our\ndata ignoring the 1-- It's 1.",
    "start": "2090331",
    "end": "2095399"
  },
  {
    "text": "Perfectly well, the law of\nmass action-- it works fine. So you never notice\nthis unless you get down to where n is very small.",
    "start": "2095400",
    "end": "2101079"
  },
  {
    "text": " But this is actually the truth.",
    "start": "2101080",
    "end": "2106839"
  },
  {
    "text": "This is really what the\ncorrect equation is. ",
    "start": "2106840",
    "end": "2114870"
  },
  {
    "text": "OK so now we have these--\nthe true equations for predicting how the\nprobability distribution",
    "start": "2114870",
    "end": "2120520"
  },
  {
    "text": "evolves in a reacting system. By the way, you can\nadd transport in as well if you want.",
    "start": "2120520",
    "end": "2126040"
  },
  {
    "text": "So you have control\nvolumes, and you know formulas for the rate at\nwhich stuff is transported in and out of the control volume.",
    "start": "2126040",
    "end": "2132220"
  },
  {
    "text": "You can add those\nterms in as well. And they'll affect the\nprobability distribution.",
    "start": "2132220",
    "end": "2137240"
  },
  {
    "text": "No problem, you should be able\nto do the same conversion. So just-- we've converted\nthe reaction equations.",
    "start": "2137240",
    "end": "2142381"
  },
  {
    "text": "You can write a similar thing. Once you get right the\nmacroscopic transport equation, you can figure out how\nyou would reduce it",
    "start": "2142381",
    "end": "2147860"
  },
  {
    "text": "down to a time\nconstant for transport that would work for the--",
    "start": "2147860",
    "end": "2153660"
  },
  {
    "text": "for this microscopic\nversion of the equations. So transport reaction-- you\ncan write the whole thing down as a master equation.",
    "start": "2153660",
    "end": "2158994"
  },
  {
    "text": "That's a real solution,\nthe real equation. And the problem is that the\nreal equation oftentimes",
    "start": "2158994",
    "end": "2164299"
  },
  {
    "text": "is too big, because P scales\nup so rapidly with the number of possible states.",
    "start": "2164300",
    "end": "2170562"
  },
  {
    "text": "So then we have to figure out\nhow are we going to solve it. And the way to solve it is by-- called kinetic Monte Carlo.",
    "start": "2170562",
    "end": "2176240"
  },
  {
    "start": "2176240",
    "end": "2188020"
  },
  {
    "text": "And this method was invented\nby a guy named Joe Gillespie.",
    "start": "2188020",
    "end": "2193090"
  },
  {
    "text": "And the journal paper is posted. ",
    "start": "2193090",
    "end": "2202400"
  },
  {
    "text": "And this is just like\nwith Monte Carlo-- Metropolis Monte Carlo\nthat you just did.",
    "start": "2202400",
    "end": "2207420"
  },
  {
    "text": "We're trying to\nfind a way to sample from the true\nprobability density",
    "start": "2207420",
    "end": "2213260"
  },
  {
    "text": "without ever computing the\ntrue probability density. So in the Monte\nCarlo integration",
    "start": "2213260",
    "end": "2219760"
  },
  {
    "text": "you're doing for\nhomework, you're sampling from the true\nBoltzmann probability density,",
    "start": "2219760",
    "end": "2224905"
  },
  {
    "text": "but you never actually\nsupposedly write down what that P is, right? And so we're going to\ndo the same thing here,",
    "start": "2224905",
    "end": "2231540"
  },
  {
    "text": "is we're going to-- from the differential\nequations-- from this differential\nequation system",
    "start": "2231540",
    "end": "2236730"
  },
  {
    "text": "here, we're going to try to\nsomehow never ever solve this directly, but instead just\nsample from the solution, P,",
    "start": "2236730",
    "end": "2244144"
  },
  {
    "text": "which depends on time.  And the way it's\ndone is really to try",
    "start": "2244144",
    "end": "2254070"
  },
  {
    "text": "to follow individual\ntrajectories of what could have happened, OK?",
    "start": "2254070",
    "end": "2260130"
  },
  {
    "text": "So at any time-step,\nwe have some number of A's, B's and C's.",
    "start": "2260130",
    "end": "2266510"
  },
  {
    "text": "And we're going to say,\nwell in the next time period, some small time\nperiod, what could happen?",
    "start": "2266510",
    "end": "2272700"
  },
  {
    "text": "And we're going to make\nthe time period so small that the only thing that can\nhappen is nothing happens, and A, B and C stay\nthe same, or one event",
    "start": "2272700",
    "end": "2280160"
  },
  {
    "text": "happens which will change one\nof the numbers, the A's, B's, and C's, by the same\none reaction amount, OK?",
    "start": "2280160",
    "end": "2288870"
  },
  {
    "text": "And then after we accomplish\nthat, now we have a new state--",
    "start": "2288870",
    "end": "2294330"
  },
  {
    "text": "A, B, and C with\nsome new values. And we'll do the\nsame thing again. And we just repeat\nthat over and over. So it's very brute force.",
    "start": "2294330",
    "end": "2299990"
  },
  {
    "text": "You're just doing, like, what\na single system would do.",
    "start": "2299990",
    "end": "2305250"
  },
  {
    "text": "So for example, for\nthe uranium atom case, we have one uranium\natom in there. We wait for some time\nperiod, say 20 minutes.",
    "start": "2305250",
    "end": "2312119"
  },
  {
    "text": "We compute the probability\nthat the uranium would have decayed in the last 20 minutes. It's pretty small.",
    "start": "2312120",
    "end": "2318400"
  },
  {
    "text": "And then we'll say, OK, now\nwe'll draw a random number. If the random number is\nless than that probability,",
    "start": "2318400",
    "end": "2327840"
  },
  {
    "text": "then we think that the\nuranium is still there. And if the random number is\nbigger than that probability,",
    "start": "2327840",
    "end": "2333570"
  },
  {
    "text": "then the uranium is gone. If it's still there,\nthen we'll do it again.",
    "start": "2333570",
    "end": "2339369"
  },
  {
    "text": "And we'll just keep doing\nthat over and over again. And we'll sample\nwhat could happen. The uranium atom could live\nfor 38 years and 14 minutes,",
    "start": "2339370",
    "end": "2347650"
  },
  {
    "text": "and then disappear. And that would be one example. And then we go back\nand we do it again from a different trajectory.",
    "start": "2347650",
    "end": "2353589"
  },
  {
    "text": "And we do it over and\nover and over again. And we do it over\nand over again. Those trajectories are sampling\nfrom what could happen,",
    "start": "2353590",
    "end": "2360130"
  },
  {
    "text": "with the right\nprobability density. Does this make sense? So the way Gillespie\nsays to do it",
    "start": "2360130",
    "end": "2365340"
  },
  {
    "text": "is figure out the expected time\nuntil something would happen.",
    "start": "2365340",
    "end": "2384012"
  },
  {
    "text": " We'll call this time tau. ",
    "start": "2384012",
    "end": "2393090"
  },
  {
    "text": "And we'll pull-- actually\nlet's not use tau,",
    "start": "2393090",
    "end": "2402404"
  },
  {
    "text": "because that's the\nonly one that-- I'll try to be consistent\nwith Joe's notation. He calls this thing 1/a.",
    "start": "2402404",
    "end": "2407510"
  },
  {
    "start": "2407510",
    "end": "2420925"
  },
  {
    "text": "So a is like the\nexpected rate per second. And 1/a is the expected time\nuntil something would happen.",
    "start": "2420925",
    "end": "2428869"
  },
  {
    "text": "And then we'll draw\na random number r--",
    "start": "2428870",
    "end": "2442450"
  },
  {
    "text": "he calls it r1.  So we just call\nthe rand function.",
    "start": "2442450",
    "end": "2448579"
  },
  {
    "text": "It gives me a number\nbetween 0 and 1. And I'll say that my\ntime-step, delta t--",
    "start": "2448580",
    "end": "2455430"
  },
  {
    "text": "which Joe calls tau, is\n1/a the logarithm of 1/o.",
    "start": "2455430",
    "end": "2462099"
  },
  {
    "text": " So I think there should\nbe a negative sign.",
    "start": "2462100",
    "end": "2473838"
  },
  {
    "text": "No, 1/r is positive. That's right-- positive. All right, so I choose\na random number.",
    "start": "2473838",
    "end": "2481490"
  },
  {
    "text": "Suppose it's 1/2. Then this fraction is 2-- 1 over 1/2 is 2.",
    "start": "2481490",
    "end": "2487080"
  },
  {
    "text": "Logarithm of 2 is some\nnumber bigger than 1. And I pull that. And I get some-- ",
    "start": "2487080",
    "end": "2494540"
  },
  {
    "text": "actually, some number less\nthan 1-- logarithm of 2-- anyway, some positive number. Multiply it by the expected\ntime until something happens--",
    "start": "2494540",
    "end": "2502040"
  },
  {
    "text": "and that's the time, in\nthis particular simulation, when the next thing happened. And then I repeat this\nagain, and again, and again.",
    "start": "2502040",
    "end": "2508850"
  },
  {
    "text": "And I get the period of\ntime intervals between when something happened. Now every time something\nhappened, I have to figure out,",
    "start": "2508850",
    "end": "2514940"
  },
  {
    "text": "well, what happened? So if I look at my--",
    "start": "2514940",
    "end": "2520626"
  },
  {
    "text": " plot back here when I had the\nuranium, I waited a long--",
    "start": "2520626",
    "end": "2527359"
  },
  {
    "text": " in this particular\ncase, here's my tau.",
    "start": "2527360",
    "end": "2533140"
  },
  {
    "text": "I'll call this tau 1-- the time that it took for\nthe first thing to happen.",
    "start": "2533140",
    "end": "2538232"
  },
  {
    "text": "And then, well--\nwhat could happen? The only thing can happen with\nmy single uranium atom case",
    "start": "2538232",
    "end": "2543579"
  },
  {
    "text": "is it decayed. So it went away. All right, and then I do\nthe random thing again.",
    "start": "2543580",
    "end": "2550250"
  },
  {
    "text": "And I draw. And I get a different\nnumber this time.  How long it is 'till\nsomething happened.",
    "start": "2550250",
    "end": "2555900"
  },
  {
    "text": " Now notice-- maybe\nit's not so obvious--",
    "start": "2555900",
    "end": "2562089"
  },
  {
    "text": "that in the time until something\nhappens changes as you run. So for example, if I started\nout with 100 uranium atoms",
    "start": "2562090",
    "end": "2570839"
  },
  {
    "text": "in 100 little boxes. And I'm watching them. After I've run this\nfor a long time, I only have 50\nuranium atoms left.",
    "start": "2570840",
    "end": "2577651"
  },
  {
    "text": "And that means that\nthe average time period until something\nhappens will be slower, because I don't have as many.",
    "start": "2577651",
    "end": "2582690"
  },
  {
    "text": "The more I have, the more\nrapidly something will happen. Does that make sense? So I have to compute this\na thing at each iteration.",
    "start": "2582690",
    "end": "2591450"
  },
  {
    "text": "So I compute the time\nuntil something happens. Then I'm going to\ncompute what happened.",
    "start": "2591450",
    "end": "2596950"
  },
  {
    "text": "I'll tell you what\nthat the second. In the uranium case, the\nonly thing that can happen is one of the uranium\natoms decayed.",
    "start": "2596950",
    "end": "2602310"
  },
  {
    "text": "So I took that away. Now I have to compute a again. So a is the sum of all the\nthings that can happen.",
    "start": "2602310",
    "end": "2612170"
  },
  {
    "text": "So in my case where I\nhave 100 uranium atoms, I have 100 different boxes. In each one of them, there is\na rate at which uranium atom",
    "start": "2612170",
    "end": "2619690"
  },
  {
    "text": "probability is decaying. It's like 1 over the normal\nhalf life uranium-- or something like that.",
    "start": "2619690",
    "end": "2625690"
  },
  {
    "text": "And I add them up. So a is the sum of the rates\nof everything that can happen.",
    "start": "2625690",
    "end": "2641190"
  },
  {
    "start": "2641190",
    "end": "2650016"
  },
  {
    "text": "So we just list out all\nthe different things that can happen. So in the case-- suppose\nI have two boxes--",
    "start": "2650017",
    "end": "2655330"
  },
  {
    "text": "two uranium atoms. I can have decay of uranium\natom number one or uranium atom number two.",
    "start": "2655330",
    "end": "2661630"
  },
  {
    "text": "So I have-- this thing\nwould be equal to-- so two uranium atoms-- ",
    "start": "2661630",
    "end": "2673500"
  },
  {
    "text": "a is equal to 1 over tau normal\nfor a uranium atom plus one",
    "start": "2673500",
    "end": "2680914"
  },
  {
    "text": "over tau normal. Because they're both\nnormal uranium atoms. So it's equal to 2/tau.",
    "start": "2680914",
    "end": "2687040"
  },
  {
    "text": "And so 1/a is half of\nthe normal lifetime. And that's when I would\nexpect that something",
    "start": "2687040",
    "end": "2693430"
  },
  {
    "text": "would happen by then, OK? One of them would\nprobably decay.",
    "start": "2693430",
    "end": "2700550"
  },
  {
    "text": "So that would be the a\nvalue I would use here. Draw my random\nnumber, get my tau",
    "start": "2700550",
    "end": "2707230"
  },
  {
    "text": "until something\nprobably happened, then figure out what happens. Now in the kinetics case,\nseveral different things",
    "start": "2707230",
    "end": "2713829"
  },
  {
    "text": "can happen, right? I wrote down if I'm in\nstate n A n B n C, I--",
    "start": "2713830",
    "end": "2723275"
  },
  {
    "text": "the state can change\nby two different ways. I can move out of that\nstate this way or this way.",
    "start": "2723275",
    "end": "2733330"
  },
  {
    "text": "Two different\nreactions can happen-- a forward or reverse reaction. And they would both take\nme out of the state.",
    "start": "2733330",
    "end": "2738369"
  },
  {
    "text": "So those are two different\nthings that can happen.  And so I have to\nadd those rates.",
    "start": "2738370",
    "end": "2746680"
  },
  {
    "text": "So I would add this\nnumber and this number.",
    "start": "2746680",
    "end": "2754510"
  },
  {
    "text": "And they would be the two\nthings that could happen. And that would give\nme the a value.",
    "start": "2754510",
    "end": "2759740"
  },
  {
    "text": "Now I figured out\nsomething happened. But now I'm not doing uranium.",
    "start": "2759740",
    "end": "2764940"
  },
  {
    "text": "Now doing, say, number of A's. Now I figured out\nsomething happened. But now I have to figure\nout what happened.",
    "start": "2764940",
    "end": "2770981"
  },
  {
    "text": "And the number of A's could\nhave gone up or gone down, because if it was\na forward reaction, the number of A's went down.",
    "start": "2770981",
    "end": "2776997"
  },
  {
    "text": "If it was a reverse reaction,\nthe number of A's went up. So I have to decide which\nway is going to happen.",
    "start": "2776997",
    "end": "2782540"
  },
  {
    "text": "So I could have either the\nnumber of A's went down, or the number of A's went up.",
    "start": "2782540",
    "end": "2787850"
  },
  {
    "text": "Those are two possibilities. I have to figure out\nwhich one happened. I have to figure-- draw another random\nnumber to figure out",
    "start": "2787850",
    "end": "2793670"
  },
  {
    "text": "which one probably happened. So I'll list out the list\nof all the things that can happen with their rates.",
    "start": "2793670",
    "end": "2802210"
  },
  {
    "text": "And one of them, say, is\ntwice as big as the other. So that'll be twice\nas likely to happen.",
    "start": "2802210",
    "end": "2809000"
  },
  {
    "text": "So I have to choose\na random number, and use that to\nchoose the next one. So first I figured out--",
    "start": "2809000",
    "end": "2820722"
  },
  {
    "text": "this is actually\nwhat we did first. I figured out what my rates are. Second thing is I figure out the\ntime until something happened.",
    "start": "2820722",
    "end": "2827922"
  },
  {
    "text": "Third thing is I'm going to\nfigure out what happened. ",
    "start": "2827922",
    "end": "2836029"
  },
  {
    "text": "And what I do is I say-- I draw a random\nnumber called r2.",
    "start": "2836030",
    "end": "2841290"
  },
  {
    "text": " And if there's only\ntwo possibilities",
    "start": "2841290",
    "end": "2846620"
  },
  {
    "text": "like in this case,\nthen I can say if r2 is less than the\nrate of process one divided",
    "start": "2846620",
    "end": "2863690"
  },
  {
    "text": "by the sum of the rates, which\nis the same as the a, right?",
    "start": "2863690",
    "end": "2869200"
  },
  {
    "text": "So this is-- it this is true,\nthen process one happened. ",
    "start": "2869200",
    "end": "2877769"
  },
  {
    "text": "On the other hand, if the rate--\nif the random number I chose is larger than this ratio, then\nI'll say process two happened.",
    "start": "2877769",
    "end": "2885206"
  },
  {
    "text": "And that's how I decide whether\na number of A's went up or went down. And then I would recompute the\na-- depending on what happened.",
    "start": "2885206",
    "end": "2892300"
  },
  {
    "text": "Suppose I do this. And I found out that the\nnumber of A's went up-- because I-- by drawing\nthe random number.",
    "start": "2892300",
    "end": "2899099"
  },
  {
    "text": "Then I'll go and I'll\nrecompute the A. Now the rates will all be different,\nbecause n A is bigger.",
    "start": "2899100",
    "end": "2904430"
  },
  {
    "text": "So the rate of the n\nA reaction is faster. So I recompute it. I redraw a number here, and\nget some different time, tau 2.",
    "start": "2904430",
    "end": "2913170"
  },
  {
    "text": "It's not the same as tau 1. And then something\nhappened here. I do the same process\nhere out what happened.",
    "start": "2913170",
    "end": "2919012"
  },
  {
    "text": "Maybe this time A reacted\naway and it went back down. ",
    "start": "2919012",
    "end": "2924310"
  },
  {
    "text": "And then I do it again. And this time I draw\na longer time, tau 3.",
    "start": "2924310",
    "end": "2930190"
  },
  {
    "text": "And I do-- what happened? And maybe this time, again,\nsomething reacted away. And it went down. And on, and on, and on--",
    "start": "2930190",
    "end": "2937320"
  },
  {
    "text": "and after my computer is\ndone doing that for a while, like, after a long enough\ntime, I say, OK, I'm done.",
    "start": "2937320",
    "end": "2942739"
  },
  {
    "text": "Oh-- I'm not really done. I have to go back\nand start it again, and run another\nsimulation to run",
    "start": "2942739",
    "end": "2948540"
  },
  {
    "text": "through all the possibilities. And I want to save all\nthese results of all these simulations,\nbecause these guys are",
    "start": "2948540",
    "end": "2954150"
  },
  {
    "text": "samples from the\nprobability distribution. And if I built histograms\nof stuff from those guys",
    "start": "2954150",
    "end": "2959160"
  },
  {
    "text": "I can figure out what\nreally is going to happen. All right, so it's a way to\nrepresent the P. Questions?",
    "start": "2959160",
    "end": "2966188"
  },
  {
    "text": " All right-- perfectly clear? ",
    "start": "2966188",
    "end": "2973770"
  },
  {
    "text": "All right, so what's nice\nabout this is actually, it's not that hard\nonce you do this once.",
    "start": "2973770",
    "end": "2981032"
  },
  {
    "text": "It's not hard to do it. And you can do it for\nany problem at all. And so it's like-- often cases people do\nthis even for cases",
    "start": "2981032",
    "end": "2987990"
  },
  {
    "text": "where you actually could solve-- you might be able to\nsolve this equation.",
    "start": "2987990",
    "end": "2993267"
  },
  {
    "text": "A lot times, people won't do it. They'll do this instead\njust because it's so easy. So though maybe it looks\nhard to you right now,",
    "start": "2993267",
    "end": "2999840"
  },
  {
    "text": "it's only a three step thing. And just do it over,\nand over again. You're not doing it. The computer's doing it-- no big deal.",
    "start": "2999840",
    "end": "3005579"
  },
  {
    "text": "And so this one\nyou have to, like, look at the sparsity\npattern of your m-- and some complicated stuff.",
    "start": "3005580",
    "end": "3011390"
  },
  {
    "text": "So this is actually\ndone extremely commonly. All right, see you on Friday.",
    "start": "3011390",
    "end": "3019260"
  },
  {
    "start": "3019260",
    "end": "3020659"
  }
]