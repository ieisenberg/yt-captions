[
  {
    "text": " The following content is\nprovided under a Creative Commons license. Your support will help\nMIT OpenCourseWare",
    "start": "0",
    "end": "6370"
  },
  {
    "text": "continue to offer high-quality\neducational resources for free. To make a donation or to\nview additional materials",
    "start": "6370",
    "end": "13000"
  },
  {
    "text": "from hundreds of MIT courses,\nvisit MIT OpenCourseWare at ocw.mit.edu.",
    "start": "13000",
    "end": "18321"
  },
  {
    "text": " TADGE DRYJA: OK, so today I will\ntalk about mostly fees, which",
    "start": "18322",
    "end": "26779"
  },
  {
    "text": "is an interesting and\nsomewhat contentious issue in Bitcoin and\nall these other systems.",
    "start": "26780",
    "end": "32739"
  },
  {
    "text": "So schedule for today,\nproblem set 3 description, we'll talk about fees,\nthese unknowable acronyms--",
    "start": "32740",
    "end": "39980"
  },
  {
    "text": "Child Pays for Parent,\nReplaced By Fee-- and then talk a little bit\nabout long-term incentives",
    "start": "39980",
    "end": "45290"
  },
  {
    "text": "in Bitcoin, and how\nthat relates to fees. OK, so the problem set\n3 is to grab UTXOs.",
    "start": "45290",
    "end": "51500"
  },
  {
    "text": "Hopefully it's fun. You're going to be\nmaking transactions on the real Bitcoin\ntest network.",
    "start": "51500",
    "end": "58340"
  },
  {
    "text": "So one of the parts of it\nthat hopefully is not too hard is downloading and install\nBitcoin D. So I'll put a link.",
    "start": "58340",
    "end": "66080"
  },
  {
    "text": "The current, most up-to-date\nversion is 0.16.0. I believe the next\nversion will just",
    "start": "66080",
    "end": "71600"
  },
  {
    "text": "be called 17, because a lot\nof the developers are like, this is annoying, it's\nalways starting with a zero,",
    "start": "71600",
    "end": "78350"
  },
  {
    "text": "it's like 0.1, 0.2, 0.3. And they're like,\nwell, at some point, should we get to version 1? And they're like,\nwell, everyone's",
    "start": "78350",
    "end": "84140"
  },
  {
    "text": "going to think version\n1 means it's better. Let's just call the next\nversion 17 instead of 0.17.",
    "start": "84140",
    "end": "91420"
  },
  {
    "text": "So download that, and\nthen sync up to testnet. If you just run\nit by default, it",
    "start": "91420",
    "end": "96710"
  },
  {
    "text": "will sync up to the main\nnetwork, which will download something like 170 gigabytes. You don't want that.",
    "start": "96710",
    "end": "102982"
  },
  {
    "text": "And the homework assignment\ncannot be completed on the main network. There's no free money--",
    "start": "102982",
    "end": "108650"
  },
  {
    "text": "I haven't put any free\nmoney on the main network.  However, on the test\nnetwork, it'll work.",
    "start": "108650",
    "end": "114590"
  },
  {
    "text": "And it's about 11\ngigabytes of download. So I think most\npeople, on your laptop,",
    "start": "114590",
    "end": "120920"
  },
  {
    "text": "probably have 11 gigs free. It's doable. And it's kind of fun\nto see how it works.",
    "start": "120920",
    "end": "126900"
  },
  {
    "text": "So if you don't have\naccess to 11 gigs, you can probably get an\nAthena node to do it. It's not too big.",
    "start": "126900",
    "end": "132440"
  },
  {
    "text": "You can run a tiny little\nnode with not much RAM, not much space, and it'll work. You can also sync up\non a Raspberry Pi.",
    "start": "132440",
    "end": "138380"
  },
  {
    "text": "It just takes a little longer. So I don't think it'll\nbe too hard to do. You can probably get around--",
    "start": "138380",
    "end": "144463"
  },
  {
    "text": "sort of the goal\nof the assignment is to check out the actual\nBitcoin D and Bitcoin CLI.",
    "start": "144463",
    "end": "150350"
  },
  {
    "text": "You can use a block\nexplorer if you want. I'm not going to\nsay that's cheating, but it's also not as fun. So the block explorers\nwebsites will",
    "start": "150350",
    "end": "157760"
  },
  {
    "text": "help you find a lot of\nthings, because they have different databases\nand different indexes so you can sort of\nsearch through things.",
    "start": "157760",
    "end": "163614"
  },
  {
    "text": "It's more fun if you\nwrite it yourself. But if you try this, OK, that works too.",
    "start": "163615",
    "end": "168860"
  },
  {
    "text": "Yeah, so hopefully you get\nfamiliar with the Bitcoin CLI. If you want to do your own\nscripting with Bitcoin,",
    "start": "168860",
    "end": "176069"
  },
  {
    "text": "you can use anything you want. So Bitcoin CLI is a\ncommand-line utility",
    "start": "176070",
    "end": "181080"
  },
  {
    "text": "that will let you interact\nwith the Bitcoin node. So for example--\nis this readable?",
    "start": "181080",
    "end": "187250"
  },
  {
    "text": "Kind of, right? So if I want to get peer info.",
    "start": "187250",
    "end": "193260"
  },
  {
    "text": "I want to see-- this\nis a computer down on the first floor,\nrunning Bitcoin Mainnet, I want to see, OK,\nwho's connected to me?",
    "start": "193260",
    "end": "199920"
  },
  {
    "text": "And then it'll tell me. It returns JSON, and it\ntells me all about the people I'm connected to.",
    "start": "199920",
    "end": "205930"
  },
  {
    "text": "If I want to say, get\nwallet info, it'll tell me",
    "start": "205930",
    "end": "211079"
  },
  {
    "text": "I don't have any money-- things like that.",
    "start": "211080",
    "end": "216400"
  },
  {
    "text": "And then there's, like, Help. It's weird and it's not\nsuper well documented.",
    "start": "216400",
    "end": "222250"
  },
  {
    "text": "It's fairly well\ndocumented in this stuff. There's also tons of\nundocumented hidden RPC calls",
    "start": "222250",
    "end": "228340"
  },
  {
    "text": "that are deprecated, or\nnew, or programmers put in and they don't want\npeople to use them.",
    "start": "228340",
    "end": "234520"
  },
  {
    "text": "They only want to use\nthem for themselves. So it's kind of a\nmess, but it's fun",
    "start": "234520",
    "end": "239560"
  },
  {
    "text": "to see exactly how\nthis software works. So hopefully you\ncan try that out.",
    "start": "239560",
    "end": "246090"
  },
  {
    "text": "And I will add more UTXOs to\ngrab in the next few days. So that might be fun. You could, if you wanted to be a\njerk, just steal all the money,",
    "start": "246090",
    "end": "253444"
  },
  {
    "text": "and then no one\nelse could do it. But please don't do that. I mean, this is not as\nadversarial a setting",
    "start": "253445",
    "end": "259500"
  },
  {
    "text": "as actual Bitcoin. If someone does it,\nI'll be like, OK, fine, and I'll just like\nreseed the place.",
    "start": "259500",
    "end": "265190"
  },
  {
    "text": "So hopefully we don't\nhave too many trolls trying to prevent\neveryone from having fun with this assignment.",
    "start": "265190",
    "end": "270780"
  },
  {
    "text": "That said, there is at--\naspect some of them are-- the one I put in the\nassignment last night,",
    "start": "270780",
    "end": "276210"
  },
  {
    "text": "there's five outputs\nthat you can grab. One of the sort of hints--\nthere's only five outputs.",
    "start": "276210",
    "end": "281819"
  },
  {
    "text": "So the first five people\nto grab it get the coins. So there is a little bit\nof timing stuff there.",
    "start": "281820",
    "end": "289220"
  },
  {
    "text": "Any questions? Cool?  Yeah, so if you have\nquestions about it,",
    "start": "289220",
    "end": "296160"
  },
  {
    "text": "office hours tomorrow,\nalso IRC, stuff like that. OK, so today's main topic--",
    "start": "296160",
    "end": "301830"
  },
  {
    "text": "transaction fees. So we described earlier that\nthe transaction fee is just",
    "start": "301830",
    "end": "308220"
  },
  {
    "text": "the difference between the sum\nof the input amounts and output amounts.",
    "start": "308220",
    "end": "313350"
  },
  {
    "text": "What's interesting\nis it's implicit. So if you actually\nlook at a transaction, you can't tell\nwhat the fees are.",
    "start": "313350",
    "end": "320790"
  },
  {
    "text": "You have to look\nat its ancestors to tell what the fees are. So for example, if you want\nto go through here and-- oh,",
    "start": "320790",
    "end": "327830"
  },
  {
    "text": "how am I going to do this? Jeez. If I want to say, OK, what's\nthe most current block?",
    "start": "327830",
    "end": "335970"
  },
  {
    "text": "getblockchaininfo. OK, so the most\ncurrent block is this.",
    "start": "335970",
    "end": "342840"
  },
  {
    "text": "And then I can\nsay, OK, getblock-- can I just say getblock? Yeah, I want to get that block.",
    "start": "342840",
    "end": "350120"
  },
  {
    "text": "OK, there's all the\ntransactions in this block. I can do getblock verbose\ntrue, and it'll give me",
    "start": "350120",
    "end": "355300"
  },
  {
    "text": "all the transaction data. But instead, I can just pick\none of these transactions and say getrawtransaction,\nget that thing.",
    "start": "355300",
    "end": "364430"
  },
  {
    "text": "Oh, here's another weird thing. So it'll just give\nyou hex, which is not very useful, unless you\nsomehow can read hexadecimal.",
    "start": "364430",
    "end": "373180"
  },
  {
    "text": "And then in the actual thing,\nit says, like, examples.",
    "start": "373180",
    "end": "379380"
  },
  {
    "text": "Wait, true? Did they change it? You used to have\nto do 1 at the end. Yeah. But true works too?",
    "start": "379381",
    "end": "384909"
  },
  {
    "text": " It used to not work\nif you said true, and you had to put the\nnumber 1 instead of true.",
    "start": "384910",
    "end": "391645"
  },
  {
    "text": "There is a lot of\nweird bugs in Bitcoin that have been there\nfor years, and I guess they fixed that one. The most egregious is\nprobably the multisig bug,",
    "start": "391645",
    "end": "399480"
  },
  {
    "text": "where when you're spending\nfrom a multisig output, you have to push a zero-byte\nonto the stack first,",
    "start": "399480",
    "end": "404770"
  },
  {
    "text": "or else it doesn't work. It was just a bug Satoshi had. And now it's consensus critical.",
    "start": "404770",
    "end": "410320"
  },
  {
    "text": "And people joke about\nit, like, oh, we also have to put a zero-byte\nin whatever new RPC we create, because\nthere's just, like, bugs.",
    "start": "410320",
    "end": "418920"
  },
  {
    "text": "Anyway, so for example, this\ntransaction that I just brought up, this is how it'll look.",
    "start": "418920",
    "end": "430010"
  },
  {
    "text": "Here's the TXID,\nit's 370 bytes, it's got this lock time, which--\nooh, I should mention that.",
    "start": "430010",
    "end": "436490"
  },
  {
    "text": "I'm guessing this transaction\nwas created by Bitcoin Core Wallet, not a different wallet.",
    "start": "436490",
    "end": "443110"
  },
  {
    "text": "That's a hint. It's got one input-- no, two inputs.",
    "start": "443110",
    "end": "448520"
  },
  {
    "text": "OK, so inputs are\nspecified-- this TXID input, this TXID input--",
    "start": "448520",
    "end": "455050"
  },
  {
    "text": "two inputs and one\noutput of value, 0004500.",
    "start": "455050",
    "end": "461979"
  },
  {
    "text": "We can't tell what\nthe fee is from this. No, sorry, two outputs. Here are the two outputs. So we can tell these\ntwo outputs, however,",
    "start": "461980",
    "end": "469177"
  },
  {
    "text": "we don't know what the fees are. We know the total\noutput amounts, but the input amounts\nare not encoded",
    "start": "469177",
    "end": "474860"
  },
  {
    "text": "in the transaction itself. In order to figure\nthat out, we'd have to go to this transaction\nand see what vout 0's output",
    "start": "474860",
    "end": "483380"
  },
  {
    "text": "amount is, which we can do. And it's 0052-- you know, so\nwe can add it up that way,",
    "start": "483380",
    "end": "492710"
  },
  {
    "text": "but it's not written directly,\nwhich is a little weird.",
    "start": "492710",
    "end": "498650"
  },
  {
    "text": "And the idea of the\nfee is, whoever mines that block that includes that\ntransaction gets the fee.",
    "start": "498650",
    "end": "505460"
  },
  {
    "text": "So the sum of all the inputs\nand outputs within a block do add up, modulo the new\ncoins that are created.",
    "start": "505460",
    "end": "514610"
  },
  {
    "text": "But long-term, when there's\nno coins being created, when they've all been\ncreated, you can say, OK, we can look\nat a block, add up",
    "start": "514610",
    "end": "521298"
  },
  {
    "text": "all the inputs spent in all\nthe transactions in the block, add up all the outputs created\nin all the transactions",
    "start": "521299",
    "end": "527029"
  },
  {
    "text": "in the block, and\nthose should equal. Otherwise, it's invalid. Well, they don't have to equal.",
    "start": "527030",
    "end": "532640"
  },
  {
    "text": "You're always allowed\nto destroy coins. So if the miner\nsays, hey, there's all these fees that\ncan be paid to me,",
    "start": "532640",
    "end": "538970"
  },
  {
    "text": "and I just don't grab\nthem, you can do that. So it's a less-than-or-equals\noperator that-- it's the check.",
    "start": "538970",
    "end": "547160"
  },
  {
    "text": "And people have destroyed\ncoins, usually inadvertently. There was one in\nJanuary where there",
    "start": "547160",
    "end": "553190"
  },
  {
    "text": "was a block that just had a zero\noutput for the miner reward, so all whatever, 13, 14\ncoins were just destroyed.",
    "start": "553190",
    "end": "562060"
  },
  {
    "text": "Yeah, it seemed like a bug. So that's how fees work.",
    "start": "562060",
    "end": "567319"
  },
  {
    "text": "What's interesting is,\nyou don't know who you're paying when you create the fee. You sign sort of, OK,\nhere's my transaction,",
    "start": "567320",
    "end": "574060"
  },
  {
    "text": "I sign it off, whoever confirms\nthis transaction gets $5 or whatever.",
    "start": "574060",
    "end": "579084"
  },
  {
    "text": "And you throw it out there. So it's kind of interesting. There could be legal-- I've heard there's legal\nquestions, like, well, what",
    "start": "579085",
    "end": "585967"
  },
  {
    "text": "if one of the miners\nis in Iran, now you're paying someone in Iran,\nare you in trouble for that?",
    "start": "585967",
    "end": "591320"
  },
  {
    "text": "You don't know. You can't tell who going\nto mine it beforehand. ",
    "start": "591320",
    "end": "597650"
  },
  {
    "text": "And generally, we talk\nabout fee rates, or sort of a specific fee-per-byte.",
    "start": "597650",
    "end": "604029"
  },
  {
    "text": "And it's expressed in Satoshis\nper byte, and one Satoshi being the minimum\npossible bitcoin",
    "start": "604030",
    "end": "610930"
  },
  {
    "text": "amount, which is 1, 2, 3, 4,\n1, 2, 3 zeros, so seven years.",
    "start": "610930",
    "end": "617410"
  },
  {
    "text": "There's eight digits in bitcoin. And you usually keep that.",
    "start": "617410",
    "end": "622570"
  },
  {
    "text": "So you pad it out. So even in something\nwhere it's 0.0134,",
    "start": "622570",
    "end": "631170"
  },
  {
    "text": "they put the extra four zeros. In the actual code, this is\njust a 64-bit signed integer,",
    "start": "631170",
    "end": "638279"
  },
  {
    "text": "and there is no decimal point. So it's sort of a UI thing\nto put a decimal point in so",
    "start": "638280",
    "end": "644446"
  },
  {
    "text": "that people can think of,\noh, that's two bitcoins, or that's half a bitcoin. But really, the code only\ndeals with the Satoshis,",
    "start": "644447",
    "end": "650910"
  },
  {
    "text": "and the decimal point\nis purely UI layer, which can be\nconfusing sometimes,",
    "start": "650910",
    "end": "656095"
  },
  {
    "text": "when you're dealing\nwith JSON, and when you're dealing with\ndifferent programs, tossing numbers around.",
    "start": "656095",
    "end": "661139"
  },
  {
    "text": "You can get a factor of\n100 million off, sometimes. It's a big enough factor that,\nusually, it's pretty obvious.",
    "start": "661140",
    "end": "668400"
  },
  {
    "text": "So from a miner's\npoint of view, they want to prioritize, based on\nthe TX size and the fee rate",
    "start": "668400",
    "end": "677170"
  },
  {
    "text": "because space is limited. So one of the other\nrules that's probably one of the most controversial\nand argued-about rules",
    "start": "677170",
    "end": "683440"
  },
  {
    "text": "in Bitcoin was a 1-megabyte\nblock size limit. So the idea is, OK, you can\nput all these transactions",
    "start": "683440",
    "end": "689320"
  },
  {
    "text": "in the block, but the total\nblock, when serialized, including the headers\nand everything, needs to be 1 million\nbytes or less,",
    "start": "689320",
    "end": "696269"
  },
  {
    "text": "which is now not quite\ntrue because there's ways around that. But there's still a hard\nlimit of 4 megabytes today.",
    "start": "696270",
    "end": "705220"
  },
  {
    "text": "What's also interesting is it's\ntotally unrelated to the amount of coins being transferred.",
    "start": "705220",
    "end": "710290"
  },
  {
    "text": "So in that sense,\nthe fee is flat. Whether you're sending 100\nBitcoins, or one Bitcoin,",
    "start": "710290",
    "end": "715360"
  },
  {
    "text": "or a millionth of a Bitcoin. The miner doesn't really care.",
    "start": "715360",
    "end": "721210"
  },
  {
    "text": "It's just based on space. You're paying for your\ndata usage of the network,",
    "start": "721210",
    "end": "726580"
  },
  {
    "text": "and your actual sort of\nmonetary value transferring is unrelated to that. To some extent, later on,\nyou might think, well,",
    "start": "726580",
    "end": "734860"
  },
  {
    "text": "miners might try to charge\npeople sending more money more because they're\nmore able to pay.",
    "start": "734860",
    "end": "742590"
  },
  {
    "text": "But so far, we haven't\nseen anything like that. It's mostly just the\nminers looking at, I've got a megabyte of size\nto parcel out to people,",
    "start": "742590",
    "end": "750240"
  },
  {
    "text": "I'm going to try to pack that in\nis at as high a rate as I can. And whether someone's paying\na little bit or a lot--",
    "start": "750240",
    "end": "756480"
  },
  {
    "text": "whether someone is moving\na little bit or a lot, the miners don't care. Any questions\nabout these things?",
    "start": "756480",
    "end": "761920"
  },
  {
    "text": "Yeah. AUDIENCE: I have a question\nabout actually the miners getting the fees. So how does that-- because that's not part of\nthe Coinbase transaction.",
    "start": "761920",
    "end": "769400"
  },
  {
    "text": "TADGE DRYJA: It is, it is. So if we look-- how am I going to do this? AUDIENCE: You could look\ninto the Coinbase transaction",
    "start": "769400",
    "end": "776640"
  },
  {
    "text": "in the block and find out\nwhat the fees would be. TADGE DRYJA: Well, if you\nassume that the block is valid.",
    "start": "776640",
    "end": "783899"
  },
  {
    "text": "So OK, the first\ntransaction is always the Coinbase transaction. That's little. So I'm going to do\ngetrawtransaction,",
    "start": "783900",
    "end": "790730"
  },
  {
    "text": "get this one.  And yeah, it says, Coinbase.",
    "start": "790730",
    "end": "796940"
  },
  {
    "text": "So Coinbase's arbitrary data,\nyou've got a sequence number, there is no witness here--",
    "start": "796940",
    "end": "804160"
  },
  {
    "text": "or is-- OK, anyway. Yeah, there is witness.",
    "start": "804160",
    "end": "809310"
  },
  {
    "text": "OK, so this block is-- well, two blocks have\ncome out since I first looked at it, because there's\nnow two confirmations.",
    "start": "809310",
    "end": "816520"
  },
  {
    "text": " This is SegWit-related,\nwhich I think I'm going to talk about Monday.",
    "start": "816520",
    "end": "823310"
  },
  {
    "text": "So that's sort of this\nweird opportune thing. This is the actual\nCoinbase payout",
    "start": "823310",
    "end": "828590"
  },
  {
    "text": "that the miner is\ngetting, and it's 12.79.",
    "start": "828590",
    "end": "834260"
  },
  {
    "text": "So he got almost 0.4 extra\ncoins in fees, which is what,",
    "start": "834260",
    "end": "841430"
  },
  {
    "text": "like $4,000, pretty good. It was super high\na few months ago.",
    "start": "841430",
    "end": "847720"
  },
  {
    "text": "So it all gets aggregated. 12.5 comes out of nowhere. 12.5 is the new coins\nbeing generated.",
    "start": "847720",
    "end": "854900"
  },
  {
    "text": "And then the 0.398 is the sum\nof all the fees in that block.",
    "start": "854900",
    "end": "860122"
  },
  {
    "text": "AUDIENCE: I guess you\ndon't know [INAUDIBLE] TADGE DRYJA: Well, you have to\nlook at all the transactions.",
    "start": "860122",
    "end": "865560"
  },
  {
    "text": "So if you look at\na transaction, it doesn't say in the\ntransaction itself. You have to look\nat a transaction, look up its inputs, see\nthe sum of all the inputs,",
    "start": "865560",
    "end": "874199"
  },
  {
    "text": "and then subtract\nand say, OK, I can calculate the fee\nfor this transaction, calculate the fee for all\nthese different transactions,",
    "start": "874200",
    "end": "879839"
  },
  {
    "text": "add it all up, it should equal-- and it does exactly\nequal 0.398 da da da da.",
    "start": "879840",
    "end": "887980"
  },
  {
    "text": "So for the computer,\nit's pretty quick. But yeah, it is a little\nbit weird accounting",
    "start": "887980",
    "end": "893610"
  },
  {
    "text": "to try to add it\nall up yourself. Any other questions about\nfee stuff, about this?",
    "start": "893610",
    "end": "900959"
  },
  {
    "text": "Yes. AUDIENCE: Do miners\nchoose what blocks to mine based on their [INAUDIBLE]? ",
    "start": "900960",
    "end": "907770"
  },
  {
    "text": "TADGE DRYJA: Yes, but I'm\nnot sure I'd put it that way. The miners construct\nthe block to mine.",
    "start": "907770",
    "end": "913440"
  },
  {
    "text": "So in the case of-- here, getblock head dash 30, I\ndon't want to show all of the--",
    "start": "913440",
    "end": "921339"
  },
  {
    "text": "but this is, OK, the\nminer mined this block. Here's the size, weight,\nheight, version, vertical route.",
    "start": "921340",
    "end": "930550"
  },
  {
    "text": "All these transactions\nthat get included are produced by the miner. So the miner sort of aggregates\nthe transactions themselves,",
    "start": "930550",
    "end": "938620"
  },
  {
    "text": "and then decides to mine. So I think I talk about\nthat in the next--",
    "start": "938620",
    "end": "943980"
  },
  {
    "text": "wait, do I say that? Yeah, OK. I'll talk about that\nin the next slide. So basically the fee rate is\nset by the transaction signer.",
    "start": "943980",
    "end": "952590"
  },
  {
    "text": "When you're creating\na transaction-- OK, I want to sign one Bitcoin,\nI will spend 500 Satoshis,",
    "start": "952590",
    "end": "959700"
  },
  {
    "text": "my transaction is\nabout 250 bytes, OK, that's a two-Satoshis-per-byte\nfee rate. ",
    "start": "959700",
    "end": "967470"
  },
  {
    "text": "You choose your fee rate, sign-- the way you increment and\ndecrement your fee rate is to say, OK, I've got\nsome change output,",
    "start": "967470",
    "end": "973860"
  },
  {
    "text": "I'm going to increase or\ndecrease the change output amount. If someone's saying,\nhey, pay me one coin,",
    "start": "973860",
    "end": "979020"
  },
  {
    "text": "I can't really\nchange their amount and say, like, oh, sorry\nman, there was a high fee, you didn't get a bitcoin.",
    "start": "979020",
    "end": "986300"
  },
  {
    "text": "And that's sort of a cultural--\nthat's not a software thing. If someone says, pay me a\ncoin, you need to pay the coin.",
    "start": "986300",
    "end": "993060"
  },
  {
    "text": "It's generally the sender\nwho's covering the fee. Which is different than\nin credit cards, right?",
    "start": "993060",
    "end": "999270"
  },
  {
    "text": "In credit cards, it says\n$10, I swipe my card, I get charged $10,\nand the merchant",
    "start": "999270",
    "end": "1005150"
  },
  {
    "text": "is the one absorbing the fee. And I don't even\nknow what the fee is. There's actually\ncontractual law that I'm not",
    "start": "1005150",
    "end": "1011750"
  },
  {
    "text": "allowed to hear what the fee\nis, the merchant can't tell me, things like that. But in general, in Bitcoin,\nthis fee is set by the sender.",
    "start": "1011750",
    "end": "1018320"
  },
  {
    "text": " The transactions, however,\nare chosen by the miners. So the idea is, you create\nyour transaction, set your fee,",
    "start": "1018320",
    "end": "1026349"
  },
  {
    "text": "throw it out there,\neveryone sort of broadcasts it to everyone else. And the miner then\nlooks at all these fees,",
    "start": "1026349",
    "end": "1033939"
  },
  {
    "text": "looks at all these transactions,\nand chooses the best ones. It's essentially\nan auction process",
    "start": "1033940",
    "end": "1038949"
  },
  {
    "text": "where you're bidding for us for\nspace in a future block that has not yet been created.",
    "start": "1038950",
    "end": "1044459"
  },
  {
    "text": "So the simplest miner-side\nalgorithm is, take the mempool, sort the mempool transactions\nby their fee rate,",
    "start": "1044460",
    "end": "1052190"
  },
  {
    "text": "choose the top megabyte,\nput them all in order, compute a merkle route from\nall those transaction IDs,",
    "start": "1052190",
    "end": "1059330"
  },
  {
    "text": "and then mine it. So the-- yeah, I explained\nthe merkle route stuff, right?",
    "start": "1059330",
    "end": "1065160"
  },
  {
    "text": "So you're going to pick\na couple thousand-- 5,000, maybe-- transactions,\nsort them by fee rate,",
    "start": "1065160",
    "end": "1073440"
  },
  {
    "text": "put them all in a row,\nhash it a bunch of times, and then just that 80-byte\nheader you keep mining.",
    "start": "1073440",
    "end": "1079642"
  },
  {
    "text": "However, this keeps changing. This mempool changes\nevery second. There's new transactions coming\nup multiple times a second.",
    "start": "1079642",
    "end": "1086503"
  },
  {
    "text": "And so you're going to\nre-compute that every second, probably, and say, oh, this\nnew transaction came out,",
    "start": "1086503",
    "end": "1091760"
  },
  {
    "text": "oh, the fee's really\nlow, ignore it, that doesn't meet my threshold.",
    "start": "1091760",
    "end": "1096980"
  },
  {
    "text": "Versus, new transaction\ncomes out, oh, it's got a really high fee rate,\nOK, put it in near the top,",
    "start": "1096980",
    "end": "1102980"
  },
  {
    "text": "and push out one or two\ntransactions at the bottom. And now I'm mining a block that\nwill have slightly higher fees.",
    "start": "1102980",
    "end": "1109070"
  },
  {
    "text": "So this is sort of a\nreal-time process, where this is constantly changing. The mining is even\nfaster, so you're",
    "start": "1109070",
    "end": "1115639"
  },
  {
    "text": "going to mine trillions\nand trillions of attempts for each specific merkle route.",
    "start": "1115640",
    "end": "1121018"
  },
  {
    "text": "But the merkle routes are also\ngoing to change multiple times a second. The nonce is going to change\na gazillion times a second.",
    "start": "1121018",
    "end": "1128480"
  },
  {
    "text": "Yes. AUDIENCE: How do you\nknow that you're not mining a stale transaction? TADGE DRYJA: So you know\nit's in the mempool,",
    "start": "1128480",
    "end": "1135170"
  },
  {
    "text": "you know it hasn't been-- well, you don't\nknow, you're pretty sure that it has not been\nconfirmed in a block already.",
    "start": "1135170",
    "end": "1142760"
  },
  {
    "text": "But it may be the case\nthat someone just came out with a block a few seconds\nago, and you haven't seen it, and then you are mining\na stale transaction.",
    "start": "1142760",
    "end": "1151620"
  },
  {
    "text": "The thing is, whether\nthe transaction is stale or not, even if you\nmine a block and it's",
    "start": "1151620",
    "end": "1159450"
  },
  {
    "text": "got a completely different\nset of transactions than the block you were\nunaware of, you still lose out.",
    "start": "1159450",
    "end": "1165930"
  },
  {
    "text": "Because you're pointing--\nso OK, this comes out, but you're not aware of\nit yet, and you mine this.",
    "start": "1165930",
    "end": "1172200"
  },
  {
    "text": "Even if they have a completely\ndisjoint set of transactions, it doesn't matter because\nthey're still pointing",
    "start": "1172200",
    "end": "1178780"
  },
  {
    "text": "to the same parent block. So you still, now, have two\nblocks of the same height.",
    "start": "1178780",
    "end": "1184059"
  },
  {
    "text": "You might win. If this happens, hey, maybe\nthis one gets built upon.",
    "start": "1184060",
    "end": "1189580"
  },
  {
    "text": "Generally, miners pick the first\nseen block to build off of. But you could change that.",
    "start": "1189580",
    "end": "1197800"
  },
  {
    "text": "And you can't really verify\nthat that's the case. So yeah, it is\npossible that you're mining transactions\nthat have already",
    "start": "1197800",
    "end": "1202960"
  },
  {
    "text": "been included in the block\nthat you're not aware. Yes. AUDIENCE: Because blocks are\nchanging all the time based on the transactions\nyou want to put in it,",
    "start": "1202960",
    "end": "1210190"
  },
  {
    "text": "are you kind of mining different\nblocks at the same time? So the first one, you\ntry-- have started mining,",
    "start": "1210190",
    "end": "1215799"
  },
  {
    "text": "do you keep mining\nthat one or no? TADGE DRYJA: You could. So in practice, probably yes,\nbut on a very small timescale.",
    "start": "1215800",
    "end": "1222580"
  },
  {
    "text": "So what you'll have is we'll get\nblock template, you'll have-- it's like network latency.",
    "start": "1222580",
    "end": "1228840"
  },
  {
    "text": "So you'll have, let's say, a\nbunch of different warehouses that all have thousands and\nthousands of these mining",
    "start": "1228840",
    "end": "1234659"
  },
  {
    "text": "chips. And they will connect\nin, and they'll pull every second or so, and\nget the current transaction",
    "start": "1234660",
    "end": "1242070"
  },
  {
    "text": "list to mine. And that'll get\nupdated every second. And so there may be sort of lags\nbetween different warehouses,",
    "start": "1242070",
    "end": "1249870"
  },
  {
    "text": "between different machines,\nthat are mining slightly different sets of transactions. But generally, they're\ngoing to be synchronized.",
    "start": "1249870",
    "end": "1256500"
  },
  {
    "text": "Over the same time\nscale of a few seconds, they're all going\nto be synchronized. ",
    "start": "1256500",
    "end": "1262768"
  },
  {
    "text": "They're going to be\nupdated pretty quickly. Because every time a new\ntransaction comes in, that's potentially more\nfees that you can get.",
    "start": "1262768",
    "end": "1268520"
  },
  {
    "text": "So you want to push\nthat out and update it. Let's say a transaction comes\nin that's got a nice $5.00 fee,",
    "start": "1268520",
    "end": "1274100"
  },
  {
    "text": "and you can push out some\n$4.00 fee transactions, that's an extra buck. And if you don't get it in\ntime, and mine a block anyway,",
    "start": "1274100",
    "end": "1281059"
  },
  {
    "text": "hey, you still mined a buck,\nbut that $5 fee transaction now goes to the next person\nmining the block.",
    "start": "1281060",
    "end": "1288140"
  },
  {
    "text": "So you want to minimize your\nlatency so that you get things as quickly as possible.",
    "start": "1288140",
    "end": "1293900"
  },
  {
    "text": "But there will be some skew. Yes. AUDIENCE: How does\nmining stale transactions",
    "start": "1293900",
    "end": "1299360"
  },
  {
    "text": "affect the block order and\nblock transaction fees? TADGE DRYJA: Sorry,\nmining what transactions? AUDIENCE: Stale transactions. TADGE DRYJA: If you have--",
    "start": "1299360",
    "end": "1305660"
  },
  {
    "text": "wait, wait. OK, wait. Stale transactions? A transaction that's\nalready been in a block?",
    "start": "1305660",
    "end": "1311240"
  },
  {
    "text": "AUDIENCE: Yeah. TADGE DRYJA: It just\ninvalidates the whole thing. If you have if you\nhave a transaction here that was already confirmed\nhere, this block is invalid,",
    "start": "1311240",
    "end": "1318380"
  },
  {
    "text": "and no one will-- they'll just drop it. So stale transaction\nisn't really a term.",
    "start": "1318380",
    "end": "1326900"
  },
  {
    "text": "It's a stale block. This is a stale block because,\nwell, someone made it, but it got orphaned out,\nand no one's using it.",
    "start": "1326900",
    "end": "1335330"
  },
  {
    "text": "AUDIENCE: So the answer is,\nthere's no reward for that, right? TADGE DRYJA: Worse. You lose all your--",
    "start": "1335330",
    "end": "1341270"
  },
  {
    "text": "you lose everything. So if there's\ntransaction A in here,",
    "start": "1341270",
    "end": "1346370"
  },
  {
    "text": "and you try to include\ntransaction A in here, the block itself\nis invalid, even if it has valid proof of work.",
    "start": "1346370",
    "end": "1352760"
  },
  {
    "text": "So you lose everything. The thing is, in practice,\nit's not a problem.",
    "start": "1352760",
    "end": "1359179"
  },
  {
    "text": "Because you're\npointing to this block, so you must have\nalready seen it.",
    "start": "1359180",
    "end": "1365187"
  },
  {
    "text": "So it's really easy to just\nsay, well, don't include any of the transactions in here.",
    "start": "1365187",
    "end": "1371040"
  },
  {
    "text": "OK, wait, sometimes it's\na little complicated. Sometimes you see\nthis block, and then",
    "start": "1371040",
    "end": "1376580"
  },
  {
    "text": "you immediately want to start\nmining the block on top of it. But it's a fraction of a\nsecond, and you haven't actually",
    "start": "1376580",
    "end": "1383270"
  },
  {
    "text": "validated it. And you don't even\nknow what's in it. Maybe you only have\nthe 80-byte header.",
    "start": "1383270",
    "end": "1389030"
  },
  {
    "text": "So one optimization which\nis sort of bad in a way but optimal for the\nminers is build a block",
    "start": "1389030",
    "end": "1396290"
  },
  {
    "text": "that's empty on top of it. You haven't even seen what\ntransactions are in this block. You don't even\nknow if it's valid.",
    "start": "1396290",
    "end": "1401870"
  },
  {
    "text": "But it's probably valid,\nbecause most blocks are. And so what you do is you build\non top of it, you point to it,",
    "start": "1401870",
    "end": "1407090"
  },
  {
    "text": "but since you don't know\nwhat transactions are in it, the safest thing is just to\ninclude no transactions in your so there's no overlap.",
    "start": "1407090",
    "end": "1413899"
  },
  {
    "text": "And you only do this for\na fraction of a second until you've figured out\nthe Transaction List here",
    "start": "1413900",
    "end": "1420049"
  },
  {
    "text": "and subtracted all the-- removed all those from your set.",
    "start": "1420050",
    "end": "1425150"
  },
  {
    "text": "But it saves you maybe 1/10 of\na second, 1/20, whatever it is. Which, over time,\nstatistically, you",
    "start": "1425150",
    "end": "1433010"
  },
  {
    "text": "could be mining in\nthat 1/10 of a second. You don't you want\nyour chips to not be doing anything productive\nfor those fractions of a second.",
    "start": "1433010",
    "end": "1440480"
  },
  {
    "text": "So that does happen. That is not software that's\nin the normal Bitcoin D,",
    "start": "1440480",
    "end": "1446270"
  },
  {
    "text": "but miners have written their\nown software to do that. And so you will occasionally\nsee completely empty blocks",
    "start": "1446270",
    "end": "1452120"
  },
  {
    "text": "with just a Coinbase\ntransaction. And they're almost always very\nsoon after the previous block,",
    "start": "1452120",
    "end": "1457850"
  },
  {
    "text": "where you see one that\ncomes out at 10:30 and 27 seconds, 10:30 and\n29 seconds, and it's empty.",
    "start": "1457850",
    "end": "1464690"
  },
  {
    "text": "So that does happen,\nand that can work. Although what was\nit, two years ago",
    "start": "1464690",
    "end": "1471710"
  },
  {
    "text": "that happened,\nwhere a miner mined a blocked that was invalid.",
    "start": "1471710",
    "end": "1477230"
  },
  {
    "text": "Another miner\nmined a block here, very quickly, that was empty. And then a bunch of miners\nstarted building off of it",
    "start": "1477230",
    "end": "1484240"
  },
  {
    "text": "because they're like,\nwell, this one looks valid, there's no transactions in it. And they mined like six\nor seven blocks in a row,",
    "start": "1484240",
    "end": "1489610"
  },
  {
    "text": "and the whole thing\nwas just invalid. Because they figured, the stuff\nI'm building off of must be OK.",
    "start": "1489610",
    "end": "1497290"
  },
  {
    "text": "So they lost some money there. This makes sense, right?",
    "start": "1497290",
    "end": "1502770"
  },
  {
    "text": "Sort the mempool by fee rate,\nchoose the top megabyte, compute a merkle route, mine. Why is it not this simple?",
    "start": "1502770",
    "end": "1510070"
  },
  {
    "text": "And I mean on an\nalgorithmic way. If you're just like, yeah,\nsort, choose fee rate,",
    "start": "1510070",
    "end": "1515970"
  },
  {
    "text": "sort, quick-sort\nor whatever, that's super quick, and then mine. Why is it actually,\ncomplexity-wise, not--",
    "start": "1515970",
    "end": "1524600"
  },
  {
    "text": "what is it, n log\nn for quick-sort? It's definitely not n\nlog n for the optimal.",
    "start": "1524600",
    "end": "1529662"
  },
  {
    "text": "Although, wait, quick-sort is\nworst-case scenario n-squared [INAUDIBLE] right? No, it's way worse\nthan n-squared.",
    "start": "1529662",
    "end": "1535150"
  },
  {
    "text": "Anyway, any guesses onto why\nthe algorithmic complexity is actually quite a bit worse?",
    "start": "1535150",
    "end": "1541123"
  },
  {
    "text": "AUDIENCE: Is it because the\nexample keeps on changing? TADGE DRYJA: No, I'm\nsaying, even at any-- yeah, that changes it over time.",
    "start": "1541123",
    "end": "1548190"
  },
  {
    "text": "But at any one state, let's\nsay, here's a mempool, find the optimal transaction\nset to put into your block.",
    "start": "1548190",
    "end": "1557135"
  },
  {
    "text": "AUDIENCE: Because Bitcoin\nis slow to search, so you have to go into each\ntransaction and find the fee?",
    "start": "1557135",
    "end": "1563100"
  },
  {
    "text": "TADGE DRYJA: Yeah, but\nthat's still n log n, right? Yeah, just because\nthe look-up is slower,",
    "start": "1563100",
    "end": "1568870"
  },
  {
    "text": "that doesn't change the O. AUDIENCE: The problem is\n[INAUDIBLE] because you have to find [INAUDIBLE].",
    "start": "1568870",
    "end": "1574690"
  },
  {
    "text": "TADGE DRYJA: Yeah, so\nthere's dependencies. So the thing is, there may be\na transaction-- you can't just",
    "start": "1574690",
    "end": "1580130"
  },
  {
    "text": "take all these transactions\nindependently and sort them. There may be a transaction\nwith a very high fee rate which depends on a\ntransaction with a very low fee",
    "start": "1580130",
    "end": "1588020"
  },
  {
    "text": "rate. And so you know it's spending\nan output that hasn't yet been created. So now it becomes--",
    "start": "1588020",
    "end": "1594560"
  },
  {
    "text": "it's NP-hard. In practice, the\nheuristics are fine. But it is pretty\nugly in that you're",
    "start": "1594560",
    "end": "1601850"
  },
  {
    "text": "like, well, this transaction\nhas a very low fee, I'm not going to include it. This transaction that depends\non it has a high fee rate.",
    "start": "1601850",
    "end": "1608720"
  },
  {
    "text": "Now I have to take the sort\nof mean of the two fee rates, and keep computing those things.",
    "start": "1608720",
    "end": "1614540"
  },
  {
    "text": "So it can get quite complex. In practice, it's usually OK. You have some heuristics\nin the code that sort of don't deal with that.",
    "start": "1614540",
    "end": "1620789"
  },
  {
    "text": "Also, I think you have max-- there's no hard rule, but the\nalgorithms that mine usually",
    "start": "1620790",
    "end": "1626870"
  },
  {
    "text": "have a max depth of like\nthree or four transactions, where they say, look, if\nthere's a chain of like four",
    "start": "1626870",
    "end": "1634130"
  },
  {
    "text": "dependent transactions,\nI'm not going to keep going down that path. Because you could potentially\nhave enormous chains,",
    "start": "1634130",
    "end": "1641269"
  },
  {
    "text": "where you have 100 transactions,\neach depending on another. And then the one at the very\nend has a very high fee rate,",
    "start": "1641270",
    "end": "1647090"
  },
  {
    "text": "and you're going to have\nto go through all this. So they limit their search\nto like four or something like that.",
    "start": "1647090",
    "end": "1652630"
  },
  {
    "text": "Oh, sorry. Yeah, so the TX dependencies\nmake it kind of hard. Cheap transaction which allows\nan expensive transaction",
    "start": "1652630",
    "end": "1659970"
  },
  {
    "text": "to be confirmed, we call\nthis Child Pays for Parent, in that you've got this--",
    "start": "1659970",
    "end": "1665890"
  },
  {
    "text": "in a graph, you've\na child transaction, and it's essentially paying\nfor the parent transaction by having a higher fee.",
    "start": "1665890",
    "end": "1673019"
  },
  {
    "text": "There is no Parent\nPays for Child, in that if you've got a\ntransaction with a high fee",
    "start": "1673020",
    "end": "1678600"
  },
  {
    "text": "rate, and then a descendant\ntransaction with a low fee rate, you just take the\nparent and you ignore the child and someone\nelse in a later block",
    "start": "1678600",
    "end": "1686669"
  },
  {
    "text": "can grab that child transaction. However, the\ndependency graph is, no, if you want\nin on this child,",
    "start": "1686670",
    "end": "1692070"
  },
  {
    "text": "the parent has to\nbe confirmed first. It actually has to be confirmed\nearlier in the list of TXIDs",
    "start": "1692070",
    "end": "1697740"
  },
  {
    "text": "in the block. So it's not-- so like in this,\nwhen you look at a block, the transactions are sequenced.",
    "start": "1697740",
    "end": "1704820"
  },
  {
    "text": "And this transaction can\nspend that transaction. But you need to be able\nto go in through linearly.",
    "start": "1704820",
    "end": "1712200"
  },
  {
    "text": "Update your UTXO set\nat every row here, and it should be consistent. AUDIENCE: I have a question.",
    "start": "1712200",
    "end": "1717450"
  },
  {
    "text": "TADGE DRYJA: Yes. AUDIENCE: You mentioned LVIV,\nthose are [INAUDIBLE] terms. You mentioned a\nthreshold earlier.",
    "start": "1717450",
    "end": "1723330"
  },
  {
    "text": "How is that\nthreshold determined? TADGE DRYJA: Oh, OK, so there\nisn't really a threshold.",
    "start": "1723330",
    "end": "1729817"
  },
  {
    "text": "It's just at any point, you're\nlooking, and you're like, well, my minimum fee here\nis 30 Satoshis per byte.",
    "start": "1729817",
    "end": "1737460"
  },
  {
    "text": "Given the block I'm trying to\nmine, what's my lowest fee? OK, 30 Satoshis per byte. So if I see one\nwith less than that,",
    "start": "1737460",
    "end": "1743280"
  },
  {
    "text": "I know right away\nI can ignore it. But yeah, it keeps\nchanging every time a new transaction comes in\nthat displaces an old one, now",
    "start": "1743280",
    "end": "1750940"
  },
  {
    "text": "your minimum fee changes. So that's just sort of\nan easy way to look. There is also a relay threshold\nwhich I believe most nodes now",
    "start": "1750940",
    "end": "1758740"
  },
  {
    "text": "have at one Satoshi per byte,\nwhere if you're not mining and someone gives you a\ntransaction which is less than",
    "start": "1758740",
    "end": "1764920"
  },
  {
    "text": "one-Satoshi-per-byte fee rate,\nyou will ignore it and not pass it on to your peers.",
    "start": "1764920",
    "end": "1770470"
  },
  {
    "text": "That's sort of an\nanti-spam kind of thing. And it may be too high. It's also not a\nconsensus rule, and you",
    "start": "1770470",
    "end": "1776470"
  },
  {
    "text": "can set it to whatever you\nwant in your config file. And nodes won't get mad at you.",
    "start": "1776470",
    "end": "1781600"
  },
  {
    "text": "They won't ban you if\nyou send something low. So that's sort of\nfrom the miner's side. From the miner's\npoint of view, you",
    "start": "1781600",
    "end": "1788049"
  },
  {
    "text": "keep seeing all these\ntransactions, you sort them, you have to deal with the sort\nof descendent transactions.",
    "start": "1788050",
    "end": "1794410"
  },
  {
    "text": "But you try to get a good\nblock, try to mine it. And you don't really care\nwhat people are doing, you just want to\nmake a lot of money.",
    "start": "1794410",
    "end": "1800362"
  },
  {
    "text": "You just want to\nmaximize for fees. From the person\ntransacting, on their side,",
    "start": "1800362",
    "end": "1805450"
  },
  {
    "text": "you want to minimize fees. You don't want to\npay these miners. They already make\ngazillions of dollars anyway from all the\nnew bitcoins they're",
    "start": "1805450",
    "end": "1811287"
  },
  {
    "text": "generating-- bunch of jerks. So you set your fee to\none Satoshi per byte.",
    "start": "1811287",
    "end": "1816750"
  },
  {
    "text": "So you know it'll be relayed,\nyou sign it, and you broadcast. Easy, right? So what's the problem here?",
    "start": "1816750",
    "end": "1822940"
  },
  {
    "text": " Nobody-- AUDIENCE: [INAUDIBLE] TADGE DRYJA: Doesn't confirm,\nall the miners ignore it.",
    "start": "1822940",
    "end": "1830029"
  },
  {
    "text": "This is actually a huge-- well, OK, no, probably\nthe biggest sort of UI problem in\nBitcoin is that people",
    "start": "1830030",
    "end": "1837110"
  },
  {
    "text": "have, for years\nand years, lost all of their coins due to\ntheft, or loss, or whatever. That's the big one.",
    "start": "1837110",
    "end": "1842690"
  },
  {
    "text": "But other than that, this\nis the biggest UI problem. This is the biggest problem\nin Bitcoin for users.",
    "start": "1842690",
    "end": "1848440"
  },
  {
    "text": "I made a transaction, it hasn't\nconfirmed, what the heck? And I sort of had, on\nReddit, BTC fees, WTF.",
    "start": "1848440",
    "end": "1856790"
  },
  {
    "text": "[CHUCKLING] Like, why are BTC fees so high? There's constant people\ncomplaining, what the heck,",
    "start": "1856790",
    "end": "1863150"
  },
  {
    "text": "why-- are you kidding me? Trezor says $50 in fees. Am I missing something? People get mad.",
    "start": "1863150",
    "end": "1869990"
  },
  {
    "text": "And then there's also, I\nmade a transaction last week, it hasn't confirmed.",
    "start": "1869990",
    "end": "1875300"
  },
  {
    "text": "Bitcoin doesn't work. Bitcoin sucks. I hate this thing. So huge UI problem, really\npoor user experience.",
    "start": "1875300",
    "end": "1883750"
  },
  {
    "text": "A lot of it is, also,\nthe software is bad. Wallets-- OK, a\ncouple of years ago,",
    "start": "1883750",
    "end": "1888850"
  },
  {
    "text": "wallets would always\njust set a zero fee. There weren't fees in 2012.",
    "start": "1888850",
    "end": "1893889"
  },
  {
    "text": "You just didn't pay any-- 2013, right? I never paid fees. It was awesome.",
    "start": "1893890",
    "end": "1900429"
  },
  {
    "text": "Because there was this\nblock-size limit of one megabyte. But no one was ever running\nup against that limit.",
    "start": "1900430",
    "end": "1906970"
  },
  {
    "text": "The miners would just\nsay, look, I'm not even going to sort anything\nbecause there's",
    "start": "1906970",
    "end": "1913230"
  },
  {
    "text": "200 kilobytes worth of\ntransactions in the mempool. I just mine all of them,\nwhether the fees are zero,",
    "start": "1913230",
    "end": "1918622"
  },
  {
    "text": "whether the fees are one\nSatoshi, whatever-- whatever I can get, just mine it all. Now you've got this\nconstrained space,",
    "start": "1918622",
    "end": "1924730"
  },
  {
    "text": "and so you're optimizing-- the miner is. But years ago, you weren't. And so the wallets,\na lot of times,",
    "start": "1924730",
    "end": "1931419"
  },
  {
    "text": "they would either have\nzero fee, completely, a fixed fee per\ntransaction, which",
    "start": "1931420",
    "end": "1937240"
  },
  {
    "text": "is also really\nsuboptimal-- they just say, OK, I'll pay 100 hundreds\nSatoshi per transaction. Some transactions have a lot\nof inputs, are much bigger,",
    "start": "1937240",
    "end": "1944710"
  },
  {
    "text": "so that's a highly\nvariable fee rate which the user can't control. Or they'd have a fixed fee\nrate, where they just say,",
    "start": "1944710",
    "end": "1950650"
  },
  {
    "text": "I'm going to set five\nSatoshis per byte, and that's the fee\nrate in this wallet, and you don't allow the\nuser to change it at all.",
    "start": "1950650",
    "end": "1957100"
  },
  {
    "text": "That's also really suboptimal. Once the fee market\nstarts changing and people start paying\nmore, this wallet software",
    "start": "1957100",
    "end": "1964690"
  },
  {
    "text": "will not work. Or you can have the user choose\na fee rate, which seems great, but users are\nlike, I don't know.",
    "start": "1964690",
    "end": "1971080"
  },
  {
    "text": "You're using Bitcoin,\nwhat fee rate do you want, 10 Satoshis per\nbyte, 20, 40, 70?",
    "start": "1971080",
    "end": "1977120"
  },
  {
    "text": "What's a Satoshi? What's a byte? This is not a great problem\nto hand off to the user.",
    "start": "1977120",
    "end": "1982600"
  },
  {
    "text": "How do I even determine this? There are sites, and the sites\naren't very good, either. Where was it-- yeah, here\nis what used to be 21.co,",
    "start": "1982600",
    "end": "1993310"
  },
  {
    "text": "with all the Raspberry Pi guys. And then this is\ntheir fee rate thing,",
    "start": "1993310",
    "end": "2000150"
  },
  {
    "text": "which is a really\nhard-to-understand chart. What does this mean, unconfirmed\ntransactions, transactions",
    "start": "2000150",
    "end": "2005380"
  },
  {
    "text": "today? What are these numbers? I still don't really\nunderstand this site. And at the bottom it\nsays, fastest and cheapest",
    "start": "2005380",
    "end": "2012120"
  },
  {
    "text": "transaction fee is\n50 Satoshis per byte, shown in green at the top. So I guess this, or this.",
    "start": "2012120",
    "end": "2020670"
  },
  {
    "text": "Thing is, huge overestimate. I think one Satoshi per\nbyte is probably OK today--",
    "start": "2020670",
    "end": "2027630"
  },
  {
    "text": "maybe five. This is a better\nsite-- also complex--",
    "start": "2027630",
    "end": "2032680"
  },
  {
    "text": "where you can say,\nOK, well, here's the mempool size in\nmegabytes, sorted by fee rate.",
    "start": "2032680",
    "end": "2038720"
  },
  {
    "text": "And you can see that,\nwell, at 8 o'clock, mempool was basically empty. At 8 o'clock, you\ncould have paid zero",
    "start": "2038720",
    "end": "2045280"
  },
  {
    "text": "and it would have\ngotten through, but people are paying more now. And it's also kind of crazy to\nsee that some people are paying",
    "start": "2045280",
    "end": "2051580"
  },
  {
    "text": "200 Satoshis per byte,\neven though, generally, over the course of a few\nhours, zero Satoshis per byte",
    "start": "2051580",
    "end": "2058570"
  },
  {
    "text": "will also confirm. Are they really time-sensitive? Probably not. Probably, their\nsoftware is crummy,",
    "start": "2058570",
    "end": "2064330"
  },
  {
    "text": "and their software\njust estimates 200. So it's easy to\nmake fun of people",
    "start": "2064330",
    "end": "2073979"
  },
  {
    "text": "and be like, these\nguys are idiots. It's actually not that easy to\nestimate what fee you should issue a transaction with.",
    "start": "2073979",
    "end": "2081500"
  },
  {
    "text": "It's also sort of asymmetric\nin that a lot of exchanges, someone says, I want to\nwithdraw my 10 bitcoins.",
    "start": "2081500",
    "end": "2089870"
  },
  {
    "text": "I traded, this is a lot\nof money, withdraw, click. It doesn't confirm\nfor six hours. The customer gets\nsuper mad and starts",
    "start": "2089870",
    "end": "2096560"
  },
  {
    "text": "calling customer support. Whereas if the\nexchange is like, look,",
    "start": "2096560",
    "end": "2102290"
  },
  {
    "text": "we're just going to issue\nall of our transactions with 200 Satoshis\nper byte, they always go through the next block.",
    "start": "2102290",
    "end": "2107630"
  },
  {
    "text": "Yeah, we lose money. But maybe we get the\ncustomer to pay for it. Yeah. AUDIENCE: Do you\nthink it could be",
    "start": "2107630",
    "end": "2112724"
  },
  {
    "text": "people using maybe percentage\nof their transactions, which obviously doesn't\nmake any sense, but--",
    "start": "2112724",
    "end": "2118183"
  },
  {
    "text": "TADGE DRYJA: I\ndon't think there's any software that does that AUDIENCE: --finance\nfirm, and that's just what they're used to. That's how they're used to\npaying fees, [INAUDIBLE]..",
    "start": "2118183",
    "end": "2124870"
  },
  {
    "text": "I don't think so. TADGE DRYJA: I've never seen\nany software that does that. I've seen some software\nthat does really dumb stuff",
    "start": "2124870",
    "end": "2131060"
  },
  {
    "text": "with regard to fees. I haven't seen that. That would be a new thing. So I don't think so, but maybe.",
    "start": "2131060",
    "end": "2137420"
  },
  {
    "text": "AUDIENCE: I presume that\nit's the exchanges or wallet, companies just feel like their\ncustomers are happy are happier",
    "start": "2137420",
    "end": "2143567"
  },
  {
    "text": "and they're charging\ntheir customers. It's just passing through\nthe cost to customers. But a quick question--\nwhy not just",
    "start": "2143568",
    "end": "2148730"
  },
  {
    "text": "do an algorithm that takes\nthe last six to 10 blocks,",
    "start": "2148730",
    "end": "2155130"
  },
  {
    "text": "maybe time-weights it, and\ndo an algorithm base, so an actual experience\nin the marketplace?",
    "start": "2155130",
    "end": "2162760"
  },
  {
    "text": "TADGE DRYJA: Yeah, that is\nwhat the current Bitcoin D algorithm does.",
    "start": "2162760",
    "end": "2168140"
  },
  {
    "text": "Even that can be off sometimes. And it allows sort\nof a estimate-- OK, how quickly\ndo you need this?",
    "start": "2168140",
    "end": "2173310"
  },
  {
    "text": "Do you need this\nin the next hour, do you need it in the next\nsix hours, the next half hour? So yeah, the one in\nBitcoin D is better.",
    "start": "2173310",
    "end": "2180230"
  },
  {
    "text": "But it's not-- it's easy to\nsay, oh, this should be easy.",
    "start": "2180230",
    "end": "2186230"
  },
  {
    "text": "The thing is, it's\na weird market. You're bidding for something\nthat you don't quite know--",
    "start": "2186230",
    "end": "2192563"
  },
  {
    "text": "and you don't know what\nother participants are going to pile in. Sometimes-- so something\nlike this, oh, a block",
    "start": "2192563",
    "end": "2198850"
  },
  {
    "text": "didn't come out\nfor half an hour, and a bunch of other people\ncame and submitted higher bids",
    "start": "2198850",
    "end": "2204750"
  },
  {
    "text": "after you. And so now you got out--\nin practice, well, yeah, someone who submitted a bid\nhere, a transaction here,",
    "start": "2204750",
    "end": "2211610"
  },
  {
    "text": "a block came out there, and-- let's zoom in for an example.",
    "start": "2211610",
    "end": "2217140"
  },
  {
    "text": "Well, that's too low. But I submitted something here.",
    "start": "2217140",
    "end": "2222150"
  },
  {
    "text": "I think it will get in. But then all these other\npeople came after me, and then the block\ndidn't confirm mine. It did later, another\nfew minutes later.",
    "start": "2222150",
    "end": "2229829"
  },
  {
    "text": "But it's hard-- there's\nnever any determinism in how it's going to work. Yes. AUDIENCE: So if fees\nare always lower",
    "start": "2229830",
    "end": "2235142"
  },
  {
    "text": "around 8:00 AM or 4:00 AM,\nwhy not just pool transactions for around that time? TADGE DRYJA: They're\nnot, because it's",
    "start": "2235142",
    "end": "2240623"
  },
  {
    "text": "all over the world. They do tend to be\nlower on the weekends. People don't make as many\ntransactions on the weekends.",
    "start": "2240623",
    "end": "2248020"
  },
  {
    "text": "And so, yes, sometimes\npeople will say, hey, I've got\nthese transactions. In practice, if you say, I\ndon't care how long it takes,",
    "start": "2248020",
    "end": "2255270"
  },
  {
    "text": "just set a low fee and wait. And it will stay in\nthe mempool for weeks.",
    "start": "2255270",
    "end": "2261085"
  },
  {
    "text": "So there have been people who\nsaid, I made a transaction, I put a super-low fee, it\nconfirmed a month later.",
    "start": "2261085",
    "end": "2266733"
  },
  {
    "text": "The thing is, if you-- I should go, yeah, this\nis something of a tangent.",
    "start": "2266733",
    "end": "2272520"
  },
  {
    "text": "But if you look over six months,\nit's really highly variable. It used to be sort of\nnothing, and then--",
    "start": "2272520",
    "end": "2280349"
  },
  {
    "text": "part of it is the-- it looks most dramatic here,\nbecause you're sorting by--",
    "start": "2280350",
    "end": "2286330"
  },
  {
    "text": "this shows the fee rate. It's like nothing. You don't have to deal with it.",
    "start": "2286330",
    "end": "2292300"
  },
  {
    "text": "And then like, whoa, OK. And people were\ncomplaining, hey, it's days where\nnothing confirmed. Here it was weeks, months, like\nall of December and January.",
    "start": "2292300",
    "end": "2300310"
  },
  {
    "text": "And it was correlated\nwith everyone in the media, everyone\nwanting to buy bitcoins,",
    "start": "2300310",
    "end": "2305560"
  },
  {
    "text": "the price skyrocketed. So it's very sort of peaky. And then I think interest\nhas died down a bit,",
    "start": "2305560",
    "end": "2312040"
  },
  {
    "text": "and the fees have\ngone down with it. So this is a hard\nproblem to deal with.",
    "start": "2312040",
    "end": "2318050"
  },
  {
    "text": "And it wasn't something\npeople were dealing with until a few months ago.",
    "start": "2318050",
    "end": "2323432"
  },
  {
    "text": "Most of the time, you could\nget by with just setting a low fixed fee or\nsomething, and it would work.",
    "start": "2323433",
    "end": "2328480"
  },
  {
    "text": "But now we're really seeing\nthe fee market develop. Also, people disagreed that\nthis should even be a thing.",
    "start": "2328480",
    "end": "2335840"
  },
  {
    "text": "So there's Bitcoin Cash,\nthere's all these forks, the idea of, if you start\nhitting the block-size limit,",
    "start": "2335840",
    "end": "2343550"
  },
  {
    "text": "increase the limit. Why should we have to pay fees? The miners are already getting\nplenty of money to mine with,",
    "start": "2343550",
    "end": "2349760"
  },
  {
    "text": "we should just have as much\ntransactions that we want. So there's people that say that.",
    "start": "2349760",
    "end": "2354920"
  },
  {
    "text": "Yes. AUDIENCE: Sorry, if you're\nnot getting them confirmed, you could just issue another\ntransaction with higher fees.",
    "start": "2354920",
    "end": "2361020"
  },
  {
    "text": "TADGE DRYJA: That's what\nI'm going to get to next. ",
    "start": "2361020",
    "end": "2366340"
  },
  {
    "text": "So not always. So one, your software\nmight not do that. Most software in\nthe last few years",
    "start": "2366340",
    "end": "2373410"
  },
  {
    "text": "just said, look, once\nthe transaction is sent, it's stuck. It's just like, yeah, I sent\nit, waiting for it to confirm.",
    "start": "2373410",
    "end": "2379960"
  },
  {
    "text": "And you have to\nactually code something to deal with changing\nthe transaction ID, invalidating the old one.",
    "start": "2379960",
    "end": "2385780"
  },
  {
    "text": "That's some software. So one way a wallet could\ndeal with this is to say,",
    "start": "2385780",
    "end": "2391359"
  },
  {
    "text": "OK, well I'll do\nChild Pays for Parent. This is actually a little\nbit easier, software-wise, because you don't have\nto invalidate anything.",
    "start": "2391360",
    "end": "2396547"
  },
  {
    "text": "You could just say, I'm going\nto send a transaction, spending one of those new outputs\nthat's not confirmed, with a very high fee.",
    "start": "2396547",
    "end": "2402220"
  },
  {
    "text": "Now, the average of the\ntwo will be high enough, maybe it will get in. You can also do this when\nyou're on the receiving end.",
    "start": "2402220",
    "end": "2408880"
  },
  {
    "text": "So if someone sent you a coin,\nbut they sent that transaction with a low fee.",
    "start": "2408880",
    "end": "2414520"
  },
  {
    "text": "And maybe you can't\ncontact them anymore, maybe they're unresponsive\nor they don't care. And you're like, well, I\nreally need this money,",
    "start": "2414520",
    "end": "2421690"
  },
  {
    "text": "I want it confirmed,\nI can then respend that output with a high fee\nto confirm both of them.",
    "start": "2421690",
    "end": "2427660"
  },
  {
    "text": "It's kind of annoying,\nbut possible. Downsides of this--",
    "start": "2427660",
    "end": "2433329"
  },
  {
    "text": "Child Pays for Parent\nis very inefficient. You're making an\nextra transaction. And it's exacerbating the\nproblem you're trying to solve.",
    "start": "2433330",
    "end": "2439895"
  },
  {
    "text": "The whole problem is, there's\ntoo many transactions, there's not enough space. And you're increasing\nyour priority in the queue",
    "start": "2439895",
    "end": "2447820"
  },
  {
    "text": "by wasting even more space. So if everyone does Child Pays\nfor Parent, it's really bad.",
    "start": "2447820",
    "end": "2453460"
  },
  {
    "text": "Now every transaction\nis going to take two or three transactions. And the dependency graphs\nare kind of complex.",
    "start": "2453460",
    "end": "2460030"
  },
  {
    "text": "You can have-- I don't remember exactly how. There are certain cases\nwhere Child Pays for Parent",
    "start": "2460030",
    "end": "2468600"
  },
  {
    "text": "lowers the priority\nof a transaction. I didn't understand how. But someone explained it to\nme, and I'm like, oh, shoot,",
    "start": "2468600",
    "end": "2475769"
  },
  {
    "text": "that's bad. Where someone else\nspending an output can-- if there's a whole branch\nof tons of different outputs",
    "start": "2475770",
    "end": "2482430"
  },
  {
    "text": "and tons of different\nChild Pay for Parent, there are certain\nparts where, OK, if someone makes a low fee\ntransaction, that can actually",
    "start": "2482430",
    "end": "2488940"
  },
  {
    "text": "lower the priority\nof the parents. I don't remember. Anyway, so it's kind of\na mess, it's complex,",
    "start": "2488940",
    "end": "2495069"
  },
  {
    "text": "and it's also just\nvery inefficient. OK, so another way which\nseems obvious, why don't I",
    "start": "2495070",
    "end": "2501280"
  },
  {
    "text": "just double-spend it? I made a transaction\nwith a low fee, why doesn't my wallet\njust say, look, I'm going to replace\nthat transaction with one",
    "start": "2501280",
    "end": "2507727"
  },
  {
    "text": "with a higher fee? And I just decrease the\nchange output amount.",
    "start": "2507727",
    "end": "2513369"
  },
  {
    "text": "That's simple, right? [CHUCKLING] Another problem-- the\ndefault relay behavior",
    "start": "2513370",
    "end": "2520280"
  },
  {
    "text": "is to ignore double-spends. And this is not just a\ndefault that's for fun.",
    "start": "2520280",
    "end": "2526580"
  },
  {
    "text": "This is actually-- there's\ngood reasons for it. So if you see a transaction\nspending output A, output B,",
    "start": "2526580",
    "end": "2533480"
  },
  {
    "text": "and then you see\nanother transaction over the wire, spending\none of those outputs that you've already\nseen, you will ignore it.",
    "start": "2533480",
    "end": "2541550"
  },
  {
    "text": "You won't ban-- won't get mad at\nthe person who sent it to you, but you'll just ignore it. Because you're\nlike, no, I already saw a conflicting transaction.",
    "start": "2541550",
    "end": "2548000"
  },
  {
    "text": "So the default is,\nfirst thing you see is the thing you go with. ",
    "start": "2548000",
    "end": "2554200"
  },
  {
    "text": "This is not a\nconsensus rule, right, because we're not dealing with\nanything that's in the blocks yet. But any ideas of why this is\nan important rule to have?",
    "start": "2554200",
    "end": "2561178"
  },
  {
    "text": " What are some attacks\nthat you could perform?",
    "start": "2561178",
    "end": "2566650"
  },
  {
    "text": "If you just said,\nyeah, anything-- I'm not going to stick with\nthe first-seen transaction.",
    "start": "2566650",
    "end": "2572560"
  },
  {
    "text": "I will update anytime\nI see a new one. I'll just go with the-- I'll go with the last-seen\ntransaction instead",
    "start": "2572560",
    "end": "2577600"
  },
  {
    "text": "of first-seen transaction. What would be an attack that\nwould be enabled by that?",
    "start": "2577600",
    "end": "2583412"
  },
  {
    "text": "Any ideas?  You got to think adversarially.",
    "start": "2583412",
    "end": "2588610"
  },
  {
    "text": "I'm trying to\nbring down Bitcoin. If you change your code to last\nseen instead of first seen,",
    "start": "2588610",
    "end": "2594150"
  },
  {
    "text": "how do I bring down the network? AUDIENCE: [INAUDIBLE]",
    "start": "2594150",
    "end": "2599500"
  },
  {
    "text": "TADGE DRYJA: Right, yeah, I just\nkeep spending the same outputs, 100 times a second.",
    "start": "2599500",
    "end": "2604750"
  },
  {
    "text": "And they all have\nthe same fee rate. I can just keep doing\nthat indefinitely, and I just keep\nflooding the network.",
    "start": "2604750",
    "end": "2611755"
  },
  {
    "text": "And everyone's like, oh, here's\nthis new one, oh, here's this-- total mess. However, there is a way to\nprevent that kind of flooding",
    "start": "2611755",
    "end": "2618500"
  },
  {
    "text": "attack, or at least\nsignificantly mitigate it, which is, OK, we'll relay\nconflicting transactions,",
    "start": "2618500",
    "end": "2624619"
  },
  {
    "text": "but we require an\nincrease in the fee. And the required increase is\nequal to our minimum relay fee",
    "start": "2624620",
    "end": "2631010"
  },
  {
    "text": "of one Satoshi per byte. So every time I\ncould say, OK, I'm going to replace it because\nit has a higher fee.",
    "start": "2631010",
    "end": "2638990"
  },
  {
    "text": "So now it's sort of\nconstantly incrementing. You can't keep doing\nthat indefinitely. Every time you want to\nsend a transaction out",
    "start": "2638990",
    "end": "2645613"
  },
  {
    "text": "to the network and use\neveryone's network resources, you are sort of potentially\npaying something for it.",
    "start": "2645613",
    "end": "2651970"
  },
  {
    "text": "Yeah, you will continue\nto ignore transactions with same or lower fee.",
    "start": "2651970",
    "end": "2657950"
  },
  {
    "text": "Oh, I did the why. Yeah, the why happened there. Anyway, yeah, the DDoS attack\nis make lots of transactions with the same fee,\nclog the network.",
    "start": "2657950",
    "end": "2664390"
  },
  {
    "text": "OK, so this seems simple, right? We have replace by fee. If you have a higher\ntransaction fee,",
    "start": "2664390",
    "end": "2670200"
  },
  {
    "text": "you replace the\ntransactions, wallets implement it, no problem. ",
    "start": "2670200",
    "end": "2676360"
  },
  {
    "text": "Well, people don't like it. People said, no, we don't\nlike replace by fee.",
    "start": "2676360",
    "end": "2682869"
  },
  {
    "text": "This was a controversy\naround 2015, when a bunch of the\ndevelopers were like, yeah, this seems reasonable,\nlet's put it in.",
    "start": "2682870",
    "end": "2689530"
  },
  {
    "text": "People said, no, this\nhurts the security of unconfirmed transactions. And to some extent, they\ndo have a point, right?",
    "start": "2689530",
    "end": "2695320"
  },
  {
    "text": "If every node on\nthe network says I'm going with my\nfirst-seen transaction, if there's a conflicting\ntransaction later, I ignore it.",
    "start": "2695320",
    "end": "2703480"
  },
  {
    "text": "That means it's hard\nto double-spend, even before it\ngets into a block.",
    "start": "2703480",
    "end": "2708790"
  },
  {
    "text": "You spend-- you say, OK, I'm\ngoing to send money to Alice, and here's my change output. And then you\nreplace it with, I'm",
    "start": "2708790",
    "end": "2714140"
  },
  {
    "text": "going to send money to Bob\ninstead, and my change output. You can potentially make\nit appear that someone's",
    "start": "2714140",
    "end": "2720440"
  },
  {
    "text": "going to get paid-- it\nstill says unconfirmed, but they say, yeah, you\nsent me a transaction, it'll get confirmed\nsoon, and then",
    "start": "2720440",
    "end": "2727040"
  },
  {
    "text": "switch it out and try to\nmake it so that you pay it back to yourself instead.",
    "start": "2727040",
    "end": "2732940"
  },
  {
    "text": "When everyone on the network\nignores those new transactions, it gets harder. You'd have to contact a\nminer directly and say,",
    "start": "2732940",
    "end": "2739100"
  },
  {
    "text": "hey, I have this\ntransaction on the network, here's a conflicting one, please\ninclude it in your next block,",
    "start": "2739100",
    "end": "2746020"
  },
  {
    "text": "to double-spend, to\ndefraud this person.  The thing is, in practice,\nit's not that hard to do this.",
    "start": "2746020",
    "end": "2753723"
  },
  {
    "text": "And so a lot of the\ndevelopers are like, look, unconfirmed\ntransactions really have no security with them.",
    "start": "2753723",
    "end": "2759470"
  },
  {
    "text": "And yeah, it might\nseem like we're reducing the security here,\nbut you really should not depend on unconfirmed at all.",
    "start": "2759470",
    "end": "2765765"
  },
  {
    "text": "It's not in the blockchain. There's no proof of work. The whole point of the system\nis to put the proof of work to really get consensus.",
    "start": "2765765",
    "end": "2772160"
  },
  {
    "text": "And you cannot rely on\nnetwork-level consensus, because there isn't any.",
    "start": "2772160",
    "end": "2777300"
  },
  {
    "text": "And yeah, so to\nsome extent, replace by fee does make the\ndouble-spends easier to do. That's the point.",
    "start": "2777300",
    "end": "2783470"
  },
  {
    "text": "But the thing is, it's\nnot secure anyway. So anyway, it's\nalso a UI issue--",
    "start": "2783470",
    "end": "2790560"
  },
  {
    "text": "should you even show\nunconfirmed transactions? Almost all of the wallets\ndo, even the SPV ones.",
    "start": "2790560",
    "end": "2796310"
  },
  {
    "text": "And the SPV ones have no\nidea if it's even valid or has a valid signature\nsince they can't even check signatures.",
    "start": "2796310",
    "end": "2802470"
  },
  {
    "text": "Unconfirmed transactions\nare not meaningless. If you see it on the network,\nand you're running a full node,",
    "start": "2802470",
    "end": "2807960"
  },
  {
    "text": "you see, yes, this\nis a transaction that could be confirmed. They've provided\na valid signature.",
    "start": "2807960",
    "end": "2813869"
  },
  {
    "text": "Any miner can put this in. There's no conflicts. This can work. If you're SPV and you see\nan unconfirmed transaction,",
    "start": "2813870",
    "end": "2820320"
  },
  {
    "text": "you have no idea,\nbecause you don't even know if it's spending outputs\nthat exist because you don't have a UTXO set.",
    "start": "2820320",
    "end": "2826560"
  },
  {
    "text": "You can't verify the signatures. You don't even know what\nthe keys are supposed to be. But most SPV wallets still\nshow unconfirmed transactions",
    "start": "2826560",
    "end": "2835200"
  },
  {
    "text": "because users want it. They want to know. And it's like, sometimes they'll\nput it in, like, red text,",
    "start": "2835200",
    "end": "2840359"
  },
  {
    "text": "like, hey, it's unconfirmed,\nor put a little question mark next to it. I would rather just\nnot show it at all.",
    "start": "2840360",
    "end": "2847240"
  },
  {
    "text": "I think it gives a\nmisleading sense to users. But this is an issue, right?",
    "start": "2847240",
    "end": "2852540"
  },
  {
    "text": "Users are like, I want to know\nif the sender has actually signed and sent. And then yeah, afterwards,\nit gets in the block.",
    "start": "2852540",
    "end": "2859470"
  },
  {
    "text": "Yeah, now it's\nconfirmed, now it's safe. But I want to know. So SPV can sometimes connect\nmultiple nodes and ask.",
    "start": "2859470",
    "end": "2866300"
  },
  {
    "text": "But this is a\ncontroversial thing that people have argued about. My personal opinion\nis that security",
    "start": "2866300",
    "end": "2873990"
  },
  {
    "text": "is more important than UI\nand usability in this case, and you really should\nnot rely on anything that",
    "start": "2873990",
    "end": "2880530"
  },
  {
    "text": "has unconfirmed transactions. And also, the RBF-- the\nReplace By Fee policy",
    "start": "2880530",
    "end": "2885540"
  },
  {
    "text": "is not a network\nconsensus-level rule. You don't know what\npolicy people have.",
    "start": "2885540",
    "end": "2892410"
  },
  {
    "text": "If people are running-- if\nnodes are running \"I just stick with the\nfirst-seen transaction,\" or \"I replace with\nincrementing fees,\"",
    "start": "2892410",
    "end": "2898860"
  },
  {
    "text": "or \"I replace no matter\nwhat,\" or who knows, \"I'll go with three or four\nupdates and then I'll ignore.\"",
    "start": "2898860",
    "end": "2906420"
  },
  {
    "text": "You just don't know\nwhat people are doing. So the compromise\nthat's currently in the Bitcoin software is\ncalled opt-in replace by fee.",
    "start": "2906420",
    "end": "2915970"
  },
  {
    "text": "You flag a transaction by\nchanging the sequence number in the input to not be FFFFF.",
    "start": "2915970",
    "end": "2925119"
  },
  {
    "text": "And then you indicate, hey,\nI'm flagging my transaction as this can be replaced\nwith an increasing fee.",
    "start": "2925120",
    "end": "2931990"
  },
  {
    "text": "It's kind of ugly in my opinion. It's Like-- it's not really opt-in.",
    "start": "2931990",
    "end": "2938200"
  },
  {
    "text": "You can't even opt out. It's weird to say to people,\noh, yeah, you opt into RBF.",
    "start": "2938200",
    "end": "2943510"
  },
  {
    "text": "Because there's no\nway to prevent it. You can always\ncontact the miners, or anyone can just run it.",
    "start": "2943510",
    "end": "2948579"
  },
  {
    "text": "And there's code\nout there that's a couple of lines\ndifferent that's like, here's the full\nRBF version of Bitcoin,",
    "start": "2948580",
    "end": "2954700"
  },
  {
    "text": "where it'll just\nignore this flag and treat everything the same. But we do now have the option--\nso if you run a wallet,",
    "start": "2954700",
    "end": "2963220"
  },
  {
    "text": "and I believe that\nthe Bitcoin Core Wallet, with the new\nversion last week or last month, now, by default,\nflags every transaction as",
    "start": "2963220",
    "end": "2971680"
  },
  {
    "text": "replace by fee, so that you\ncan then bump the fee later on. ",
    "start": "2971680",
    "end": "2980730"
  },
  {
    "text": "And this is a much better\nway to deal with fees. Because then you're not stuck. And then, to some\nextent, you don't even",
    "start": "2980730",
    "end": "2987359"
  },
  {
    "text": "need to look at the\nmempool and what fees everyone else is paying. You can just say, well, I can\nalso time-lock transactions,",
    "start": "2987360",
    "end": "2995090"
  },
  {
    "text": "and I can say, OK, well,\nat the current block, I'll pay one Satoshi per byte. I'll also send out\na transaction where",
    "start": "2995090",
    "end": "3001640"
  },
  {
    "text": "it's not valid until\nthe next block, and I pay two Satoshis per byte. And then the block after\nthat, I'll pay four, and block",
    "start": "3001640",
    "end": "3007022"
  },
  {
    "text": "after that, I'll pay eight, or\nwhatever sort of fee schedule you want. And then the miners now\nhave the option to look",
    "start": "3007022",
    "end": "3013760"
  },
  {
    "text": "and say, well, two Satoshis\nper byte is too little, I'm not going to take it. But then a block comes out--",
    "start": "3013760",
    "end": "3019130"
  },
  {
    "text": "OK, now it's four. OK, I'll take that one. And so that's a really nice\nsort of fire-and-forget",
    "start": "3019130",
    "end": "3025720"
  },
  {
    "text": "from the user's wallet,\nwhere I don't even know what fee I should\npay, well, look, I'll just keep incrementing it.",
    "start": "3025720",
    "end": "3032470"
  },
  {
    "text": "And hopefully it confirms\nsoon at a low rate. As it takes longer and\nlonger, my rate goes up,",
    "start": "3032470",
    "end": "3038349"
  },
  {
    "text": "and eventually I'll get it in. Yeah. AUDIENCE: Are there any limits\nto how many times you do that? TADGE DRYJA: Not really.",
    "start": "3038350",
    "end": "3044200"
  },
  {
    "text": "OK, so one limit is you\ncannot actually broadcast the transaction that is\nvalid in a future block.",
    "start": "3044200",
    "end": "3051890"
  },
  {
    "text": "The network will ignore it. It's a similar reason,\ndenial of service thing, where, hey, here's a transaction\nthat's valid next week.",
    "start": "3051890",
    "end": "3057980"
  },
  {
    "text": "Well, why'd you\ntell it to me today? So you'd have to be\nonline to do that.",
    "start": "3057980",
    "end": "3063310"
  },
  {
    "text": "But your wallet can\ndo it automatically. It can just do it\nin the background.",
    "start": "3063310",
    "end": "3069240"
  },
  {
    "text": "And in practice, I\ndon't know any wallets that do that right now. The Core Wallet will\nallow you to in the UI.",
    "start": "3069240",
    "end": "3076280"
  },
  {
    "text": "You sort of right-click\nand you say, bump-- increase fee, and then it will\nrebroadcast with an increased",
    "start": "3076280",
    "end": "3081339"
  },
  {
    "text": "fee. OK, so yeah, it's a kind of a\nmess, but it's getting there.",
    "start": "3081340",
    "end": "3089109"
  },
  {
    "text": "We're getting better at this. Any questions before\nwe have a break?",
    "start": "3089110",
    "end": "3095230"
  },
  {
    "text": "Yes. AUDIENCE: So the one\n[INAUDIBLE] they'd pay [INAUDIBLE] their own\nconfirmation of transaction.",
    "start": "3095230",
    "end": "3100842"
  },
  {
    "text": "TADGE DRYJA: Well,\neventually they will, right? AUDIENCE: [INAUDIBLE] TADGE DRYJA: Will\nthey eventually? AUDIENCE: Once it\ngets the confirmation,",
    "start": "3100842",
    "end": "3107297"
  },
  {
    "text": "but normally they\naccept transactions without confirmation. TADGE DRYJA: That's\nsilly anyway. AUDIENCE: [INAUDIBLE]",
    "start": "3107297",
    "end": "3112790"
  },
  {
    "text": "TADGE DRYJA: OK, well\nyeah, so some sites will accept zero-conf\nwithout RBF, but not with.",
    "start": "3112790",
    "end": "3121200"
  },
  {
    "text": "My thinking is they\nshouldn't be accepting zero-confirmation\ntransactions, regardless.",
    "start": "3121200",
    "end": "3126630"
  },
  {
    "text": "So whatever. But yeah, and people-- there was a thing,\nPeter Todd stole $10",
    "start": "3126630",
    "end": "3132630"
  },
  {
    "text": "from Coinbase a couple\nyears ago because he was trying to prove a point. It's so easy to double-spend\nbefore it's in a block.",
    "start": "3132630",
    "end": "3140070"
  },
  {
    "text": "And all these different\nsites are saying, oh, yeah, here's a transaction\nthat's not confirmed yet, but it will be soon.",
    "start": "3140070",
    "end": "3145620"
  },
  {
    "text": "And then they dispense\nwith the product. And then I remember Peter\nTodd was like, look, I just got $10 from you\non Steam or whatever,",
    "start": "3145620",
    "end": "3154120"
  },
  {
    "text": "do you want it back? And they didn't reply. Because it's really\nnot that hard to double-spend before\nit's in a block.",
    "start": "3154120",
    "end": "3160020"
  },
  {
    "text": "The whole point of the\nblockchain, all the mining, is to prevent the double-spend. OK, so the last part\nis going to be about--",
    "start": "3160020",
    "end": "3167096"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] TADGE DRYJA: Oh yeah,\nI already said this. One thing, though, is\nfurther research is needed.",
    "start": "3167096",
    "end": "3173330"
  },
  {
    "text": "This has all been\nchanging in the last year. If you had this talk a\nyear ago, it would sort of",
    "start": "3173330",
    "end": "3178494"
  },
  {
    "text": "be like, yeah, I guess you\ncould do replace by fee, I guess fees could\nwork this way. But we had never really had this\nsustained, long fee ramp-up.",
    "start": "3178495",
    "end": "3187640"
  },
  {
    "text": "This hadn't happened. This had never happened. There had been cases where\nsometimes blocks had been full, but we'd never\nseen this ramp-up.",
    "start": "3187640",
    "end": "3195380"
  },
  {
    "text": "It's also really\ninteresting how inelastic it was, in that\npeople started paying",
    "start": "3195380",
    "end": "3202309"
  },
  {
    "text": "thousands of Satoshis per\nbyte, $20, $30 a transaction.",
    "start": "3202310",
    "end": "3207950"
  },
  {
    "text": "And people got mad about\nit, but what was interesting is people were paying. If everyone refuses to pay\nthese rates, the rates go down.",
    "start": "3207950",
    "end": "3215779"
  },
  {
    "text": "But someone's paying that much. But a lot of it is\nexchanges and stuff.",
    "start": "3215780",
    "end": "3221180"
  },
  {
    "text": "OK, yeah, problems--\nexchanges overpay. Bitcoin D Wallets overpays.",
    "start": "3221180",
    "end": "3227599"
  },
  {
    "text": "Nobody cared for seven years. It's sort of like it's\nalso, efficiency-wise, in terms of your\ntransaction size,",
    "start": "3227600",
    "end": "3233420"
  },
  {
    "text": "it kind of reminds me of 2008\nwhen everyone was driving Hummers, and then gas\ngoes to like $4.00,",
    "start": "3233420",
    "end": "3238790"
  },
  {
    "text": "and then everyone gets a Prius. That's happening now,\nwhere it's like, OK,",
    "start": "3238790",
    "end": "3243980"
  },
  {
    "text": "let's batch our transactions. Let's use compressed pub keys.",
    "start": "3243980",
    "end": "3249290"
  },
  {
    "text": "There's all sorts of\ntechniques to reduce the size of your\ntransactions so more can fit in the block which are\nnow still being implemented.",
    "start": "3249290",
    "end": "3259460"
  },
  {
    "text": "It's sort of after the fact. It takes this, hey, you're\nspending thousands of dollars",
    "start": "3259460",
    "end": "3264980"
  },
  {
    "text": "a day on this to really kick\npeople into action to write it. I remember looking\ninto December, though,",
    "start": "3264980",
    "end": "3270410"
  },
  {
    "text": "at Coinbase's transactions\nand being like, you should hire-- you guys\nare probably losing $1 million",
    "start": "3270410",
    "end": "3275930"
  },
  {
    "text": "a day. I could fix this for you. You should-- no? OK.",
    "start": "3275930",
    "end": "3281465"
  },
  {
    "text": "[CHUCKLING] But it's sort of\nfrustrating to see. And probably, their\nsystem is a huge mess",
    "start": "3281465",
    "end": "3286898"
  },
  {
    "text": "from so many different layers\nand things on top of each other that it's hard to fix. But looking at--",
    "start": "3286898",
    "end": "3293270"
  },
  {
    "text": "Gemini also is an exchange. They use uncompressed pub keys. So the pub keys are 65\nbytes instead of 33.",
    "start": "3293270",
    "end": "3299599"
  },
  {
    "text": "There's no advantage there. It's just an extra 32 bytes. Which they've probably spent, I\ndon't know, a couple hundred K",
    "start": "3299600",
    "end": "3306160"
  },
  {
    "text": "on just that weird\naspect of their software. I don't know if they're\naware of this, even. You might want to\nbe like, hey, guys,",
    "start": "3306160",
    "end": "3312170"
  },
  {
    "text": "you're spending too much money. Because look, your transactions\nare an extra 32 bytes per input because of this.",
    "start": "3312170",
    "end": "3318530"
  },
  {
    "text": "But yeah, it's\ninteresting to see. I've also paid. I used to not pay.",
    "start": "3318530",
    "end": "3325190"
  },
  {
    "text": "Oh, one thing that used to\nbe the case, transactions had priority, which\nwas based on the age",
    "start": "3325190",
    "end": "3331550"
  },
  {
    "text": "of the outputs multiplied by\nthe amount of the outputs. That was a thing\nuntil two years ago.",
    "start": "3331550",
    "end": "3339010"
  },
  {
    "text": "And it was great because\nit meant if you were rich, you didn't pay fees. [CHUCKLING] So if you had a\nbunch of bitcoin,",
    "start": "3339010",
    "end": "3344790"
  },
  {
    "text": "it was kind of a maybe\nnot-so-great social idea that, hey, if you have an output\nthat's got 100 coins in it,",
    "start": "3344790",
    "end": "3353160"
  },
  {
    "text": "you can make a\nzero-fee transaction.",
    "start": "3353160",
    "end": "3358839"
  },
  {
    "text": "It actually worked from\na theoretical perspective because it prevented spam. Because the idea is, if\nyou have 100 coins, OK,",
    "start": "3358840",
    "end": "3365590"
  },
  {
    "text": "you can spend that every day\nor something, with no fee. If you have only\none coin, maybe have",
    "start": "3365590",
    "end": "3371740"
  },
  {
    "text": "to wait 100 days to be able\nto spend it with no fee. So there's this sort\nof priority, age-based,",
    "start": "3371740",
    "end": "3376840"
  },
  {
    "text": "to limit the velocity\nof these payments based on how big they are.",
    "start": "3376840",
    "end": "3382869"
  },
  {
    "text": "They got rid of\nthat because it made sense from a network\nlevel, \"let's protect the network from spam\" idea.",
    "start": "3382870",
    "end": "3389410"
  },
  {
    "text": "It did not make any\nsense for the miners to prioritize\nthese transactions. I'm a miner, who cares if you\nhave a bunch of old outputs",
    "start": "3389410",
    "end": "3396497"
  },
  {
    "text": "that you haven't\nspent in a long time. It does nothing for me. It does help the\nnetwork in general.",
    "start": "3396497",
    "end": "3402490"
  },
  {
    "text": "But so I was a\nlittle disappointed, because I don't\nhave a ton of coins, but they're all really\nold, so I could get away",
    "start": "3402490",
    "end": "3408587"
  },
  {
    "text": "without paying fees.  Long term though, this is\nsort of an interesting thing",
    "start": "3408587",
    "end": "3416890"
  },
  {
    "text": "to look at. I'm not sure that's-- oh, shoot, is that number right? Wait, James, do you know?",
    "start": "3416890",
    "end": "3422912"
  },
  {
    "text": "Is it 210,000? I think it is. That number might be wrong. I made a mental\nnote to confirm it.",
    "start": "3422912",
    "end": "3429765"
  },
  {
    "text": "I think it's right. Anyway, the mining reward drops\nin half, every four years, approximately.",
    "start": "3429765",
    "end": "3436590"
  },
  {
    "text": "And eventually all\nthe coins are mined. So it's dropped in half twice. First it was 50 coins\na block, then 25,",
    "start": "3436590",
    "end": "3442559"
  },
  {
    "text": "and now it's 12 and 1/2. In two years it's going\nto be 6.25 or something.",
    "start": "3442560",
    "end": "3448410"
  },
  {
    "text": "So eventually all the coins\nare gone, you mined them all. That takes 100 years. So everyone's like,\nI'll be dead--",
    "start": "3448410",
    "end": "3455099"
  },
  {
    "text": "I'll be gone, you'll be gone. But actually the rewards\nbecome negligible a lot sooner",
    "start": "3455100",
    "end": "3460980"
  },
  {
    "text": "than you think. In 20 years, there's\nway less than a coin in rewards, because it\nkeeps getting chopped",
    "start": "3460980",
    "end": "3468180"
  },
  {
    "text": "in half every four years. so yeah, there's this\nsort of long tail where you've got like 50 years\nof a couple Satoshis per block.",
    "start": "3468180",
    "end": "3475470"
  },
  {
    "text": "But it's negligible, right? So the rewards going\nto near zero actually",
    "start": "3475470",
    "end": "3481060"
  },
  {
    "text": "happens definitely within\nour lifetimes, pretty soon. And a lot of people\nlooking at Bitcoin are sort of thinking\nof it long term.",
    "start": "3481060",
    "end": "3487252"
  },
  {
    "text": " Bitcoin's only\nworth a lot of money now because people\nthink it's going",
    "start": "3487252",
    "end": "3492748"
  },
  {
    "text": "to be worth a lot of\nmoney in 20 years, right? If everyone knew it was going\nto collapse in 10 years, I think people\nwould lose interest.",
    "start": "3492748",
    "end": "3500280"
  },
  {
    "text": "So what are some weird\nlong-term problems? OK, well if there's no new\ncoins to mine, why do you mine.",
    "start": "3500280",
    "end": "3507110"
  },
  {
    "text": "Well, the title of this piece. However, it's not that simple.",
    "start": "3507110",
    "end": "3513980"
  },
  {
    "text": " There's a lot of problems\nwith the fees being",
    "start": "3513980",
    "end": "3519390"
  },
  {
    "text": "the only incentive, in that\nTX fees are very variable. Without a backlog, the fees tend\nto go to pretty close to zero.",
    "start": "3519390",
    "end": "3527910"
  },
  {
    "text": "And if the fees are zero,\nthere's no reason to mine. All the new coins\nhave been generated,",
    "start": "3527910",
    "end": "3533530"
  },
  {
    "text": "there's no fees in the\nmempool, why am I running my-- maybe you have a megabyte\nworth of zero-fee transactions",
    "start": "3533530",
    "end": "3540839"
  },
  {
    "text": "in the mempool. But as a miner, why am\nI spending electricity to mine this? I get nothing.",
    "start": "3540840",
    "end": "3546670"
  },
  {
    "text": "So the miners just turn off. That would be what\nthey should do. And you can see, yeah,\nit's super variable.",
    "start": "3546670",
    "end": "3552042"
  },
  {
    "text": "Maybe miners are like,\noh, this is great, we're making a ton of money. And then here they're\nlike, I guess wrap it up,",
    "start": "3552042",
    "end": "3557650"
  },
  {
    "text": "close down the mining facility. And that could be a problem,\neven on much shorter time",
    "start": "3557650",
    "end": "3563725"
  },
  {
    "text": "scales, such as the time\nscale of a single block. So for example,\nhere's what you do.",
    "start": "3563725",
    "end": "3571109"
  },
  {
    "text": "You're a miner. There's no fees in the mempool. There's no reward. There's no reason\nto mine, right? Turn off your chips,\nand then turn them",
    "start": "3571110",
    "end": "3577640"
  },
  {
    "text": "back on once the mempool\nstarts filling up, because it will eventually. The idea is, OK, for the\nnext couple of minutes,",
    "start": "3577640",
    "end": "3582650"
  },
  {
    "text": "I'm just idling. You could do that,\nor you can be clever",
    "start": "3582650",
    "end": "3588270"
  },
  {
    "text": "and say, well, I've\ngot all these chips, the opportunity cost,\na lot of it is CAPEX.",
    "start": "3588270",
    "end": "3593967"
  },
  {
    "text": "A lot of is the capital\nexpense of the chips and not the electricity. So if I'm just\nturning off my chips,",
    "start": "3593967",
    "end": "3599460"
  },
  {
    "text": "that's a huge loss for me. I want to run. I don't want to run\nwith an empty mempool, because I get nothing.",
    "start": "3599460",
    "end": "3605339"
  },
  {
    "text": "What should I do? What's a fun attack? ",
    "start": "3605340",
    "end": "3611120"
  },
  {
    "text": "Yeah. AUDIENCE: Could you make\na bunch of transactions where the fees are high,\nand the new people will leave when the fees are high?",
    "start": "3611120",
    "end": "3617560"
  },
  {
    "text": "TADGE DRYJA: Very good idea. I'm pretty sure miners are\ndoing that, or were in November.",
    "start": "3617560",
    "end": "3622870"
  },
  {
    "text": "That doesn't help you-- that helps you sort\nof medium-term, right? In the very short\nterm, where there's",
    "start": "3622870",
    "end": "3628450"
  },
  {
    "text": "an empty mempool, what do I do? There is another\nattack you can do. Yeah. AUDIENCE: You can just\nmine in empty blocks.",
    "start": "3628450",
    "end": "3634434"
  },
  {
    "text": "TADGE DRYJA: Yeah, but\nI don't get any money. You could, but that's\nnot a fun attack. Yeah. AUDIENCE: You could build up\na bunch of non-transactions.",
    "start": "3634435",
    "end": "3641670"
  },
  {
    "text": "TADGE DRYJA: Yeah, but\nI want to get money. I want to get paid, there's\nnothing in the mempool,",
    "start": "3641670",
    "end": "3647200"
  },
  {
    "text": "where do I go? Yeah. AUDIENCE: Output to\nanother currency. TADGE DRYJA: OK, so yes. So in Bitcoin's\ncase, the algorithm--",
    "start": "3647200",
    "end": "3655224"
  },
  {
    "text": "well now there's Bitcoin\nCash, and so there's sort of two chains that\nshare a single algorithm.",
    "start": "3655225",
    "end": "3660740"
  },
  {
    "text": "And in many alt coins, they\nshare either algorithms or they're using a GPU,\nwhich can be quickly switched",
    "start": "3660740",
    "end": "3666700"
  },
  {
    "text": "between different\nmining algorithms. In Bitcoin's case, though,\nyou're sort of stuck. It's a big one, and\nyou're using Sha256.",
    "start": "3666700",
    "end": "3674839"
  },
  {
    "text": "So OK, good. AUDIENCE: You could\nmine off the previous-- TADGE DRYJA: Yeah, you\ngo back to the past.",
    "start": "3674840",
    "end": "3680920"
  },
  {
    "text": "You mine the past transactions. OK, someone mined a bunch\nof transactions here,",
    "start": "3680920",
    "end": "3686650"
  },
  {
    "text": "and they got two bitcoins. Those are two bitcoins\nI could've mined. [CHUCKLING]",
    "start": "3686650",
    "end": "3692460"
  },
  {
    "text": "So that last block at a\ncouple of coins in fees. I'm going to remine it.",
    "start": "3692460",
    "end": "3697566"
  },
  {
    "text": "I'm not getting anything if I\nmine-- if I continue the chain and make progress,\nI get no money.",
    "start": "3697566",
    "end": "3702809"
  },
  {
    "text": "But if I try to snipe the\nlast guy's mining stuff, I might be able\nto take his money.",
    "start": "3702810",
    "end": "3709200"
  },
  {
    "text": "If you find two blocks\nin a row, which happens, you get all the fees. So that's sort of an\noptimal thing to do.",
    "start": "3709200",
    "end": "3715760"
  },
  {
    "text": "I've got all this\nmining power, maybe I turn it off because I'm\nmostly OPEX instead of CAPEX.",
    "start": "3715760",
    "end": "3721417"
  },
  {
    "text": "But if I've got all\nthis mining power, I'm going to use it no matter\nwhat, the optimal thing to do is try to take a\nreorg the blockchain",
    "start": "3721417",
    "end": "3728580"
  },
  {
    "text": "and take the last person's fees. So for example, instead\nof sequentially building,",
    "start": "3728580",
    "end": "3733930"
  },
  {
    "text": "you fight over it. So here's this blockchain. OK, Alice got two, Bob\ngot three, Carol got two,",
    "start": "3733930",
    "end": "3739059"
  },
  {
    "text": "Dave got one. These are fees within the block. And now the current\nmempool, it's zero.",
    "start": "3739060",
    "end": "3744440"
  },
  {
    "text": "Dave got it. Dave swept it. It was sort of declining,\nsort of going up. Dave completely\nemptied the mempool.",
    "start": "3744440",
    "end": "3750670"
  },
  {
    "text": "There's nothing in there. And there's no new\ncoins coming out. So I'm what, Eve,\nI'm the attacker.",
    "start": "3750670",
    "end": "3757350"
  },
  {
    "text": "Eve is always the\nbad person, right? So what's also even better, I\nsay, OK, I'm going to build--",
    "start": "3757350",
    "end": "3767089"
  },
  {
    "text": "I'm going to try\nto reorg out Carol. I can take all the fees here. I can take the two bitcoins\nhere and the one bitcoin here,",
    "start": "3767090",
    "end": "3774360"
  },
  {
    "text": "and I can mine it\ninto this block. This block is not\nvalid yet, right? This is higher. But I might build\nanother block here.",
    "start": "3774360",
    "end": "3782090"
  },
  {
    "text": "And then I might build\nanother block here. And by now there\nmight be some coins. So now I get four coins.",
    "start": "3782090",
    "end": "3787349"
  },
  {
    "text": "I could have mined here\nand gotten nothing. If this happens and I pull\nit off, \"puh-toom,\" OK,",
    "start": "3787350",
    "end": "3792820"
  },
  {
    "text": "Carol and Dave's\ncoins are now mine. So this is a-- And to some extent,\nyou might think, well,",
    "start": "3792820",
    "end": "3799910"
  },
  {
    "text": "whatever, it's a little\nmessy, but this is not the worst thing in the world. You still make progress. It's actually really bad.",
    "start": "3799910",
    "end": "3806050"
  },
  {
    "text": "Because you're now trading\nthis sort of memoryless process where everyone's competing\non a level playing ground",
    "start": "3806050",
    "end": "3811930"
  },
  {
    "text": "where whoever can mine fastest\nis always going to win here. So now if you're a miner that's\ntwice as big as the next guy,",
    "start": "3811930",
    "end": "3820318"
  },
  {
    "text": "you're always going to be\nable to do this-- not always, there's still some-- but this really\nreduces the variance",
    "start": "3820318",
    "end": "3827950"
  },
  {
    "text": "and really incentivizes\nthe miners to consolidate. And you're going to\nend up with a monopoly",
    "start": "3827950",
    "end": "3833470"
  },
  {
    "text": "in this kind of a scenario,\nbecause small players will just always get a reorged out. ",
    "start": "3833470",
    "end": "3840960"
  },
  {
    "text": "Yeah, so the question--\nis this an attack? It seems like they're just\ntrying to get paid, right? ",
    "start": "3840960",
    "end": "3847968"
  },
  {
    "text": "The whole idea is you're\nnot trusting the miners. You're just assuming\nthat they're acting in their economic interests.",
    "start": "3847968",
    "end": "3853468"
  },
  {
    "text": "To some extent, you could say,\nwell, if they keep doing this, they reduce the\nutility of Bitcoin, and so it's bad\nfor their holdings.",
    "start": "3853468",
    "end": "3860180"
  },
  {
    "text": "Yeah, maybe, but it\nlooks dangerous, right?",
    "start": "3860180",
    "end": "3865460"
  },
  {
    "text": "However, this isn't a problem. We don't see this problem today. There have actually been several\ncases where we should have,",
    "start": "3865460",
    "end": "3872770"
  },
  {
    "text": "where it would have been\noptimal for the miners. So someone made a fee\nthat was like 1,000-- no, it was 400\nbitcoins or something.",
    "start": "3872770",
    "end": "3879765"
  },
  {
    "text": "They just screwed up. They made a\ntransaction, and they were spending like\n1,000 bitcoins",
    "start": "3879765",
    "end": "3885680"
  },
  {
    "text": "and they only sent like\n600 out or something. So the fee was 400\nbitcoins, which is like, hey, that's way\nmore than a block.",
    "start": "3885680",
    "end": "3891650"
  },
  {
    "text": "That's millions of dollars. It wasn't when it was\nmillions of dollars, but it's still a ton of money. And the miners, if\nthey were rational,",
    "start": "3891650",
    "end": "3898280"
  },
  {
    "text": "they should have\nall just stopped and all tried to fight\neach other over that one block and that one\ntransaction, because it's",
    "start": "3898280",
    "end": "3903890"
  },
  {
    "text": "so much more valuable than\nprogressing the chain. However, they didn't,\nbecause they were just",
    "start": "3903890",
    "end": "3909740"
  },
  {
    "text": "running their software. They weren't anticipating\nthis kind of thing.",
    "start": "3909740",
    "end": "3915070"
  },
  {
    "text": "However, if this becomes,\nlong term, the general state of the network, they'll\ndefinitely anticipate it, and they'll write the\nsoftware to do this.",
    "start": "3915070",
    "end": "3922470"
  },
  {
    "text": "So it's not a problem\nwhen there's low reward variance from block to block. If every block-- if the\nnext block coming out",
    "start": "3922470",
    "end": "3928980"
  },
  {
    "text": "has about the same\nfees as the last one, then you just keep\nbuilding on it and you're not trying to snipe\nother people in the past.",
    "start": "3928980",
    "end": "3935580"
  },
  {
    "text": "But that means there's\ngoing to be a backlog. You need this really big\nmempool with a large backlog",
    "start": "3935580",
    "end": "3940830"
  },
  {
    "text": "of transactions\nto ensure that you have low variance in the rewards\nand to ensure that, long term,",
    "start": "3940830",
    "end": "3948640"
  },
  {
    "text": "you've got a stable system. So this is tricky. This is a hard problem.",
    "start": "3948640",
    "end": "3954800"
  },
  {
    "text": "Because you've already got\nthese sort of scalability balances in Bitcoin.",
    "start": "3954800",
    "end": "3960500"
  },
  {
    "text": "One of them is related\nto your hardware. So if you say, OK, we're going\nto make the block size really",
    "start": "3960500",
    "end": "3967460"
  },
  {
    "text": "small, we're going to make\nthe block size 10 kilobytes, so you can only have a few\ntransactions every 10 minutes,",
    "start": "3967460",
    "end": "3973490"
  },
  {
    "text": "if it's too small,\nthen very few people can actually use Bitcoin.",
    "start": "3973490",
    "end": "3978620"
  },
  {
    "text": "There's just not that many\ntransactions a second. Most people will have\nsomething like Coinbase, where someone else holds\nthe coins for them.",
    "start": "3978620",
    "end": "3984740"
  },
  {
    "text": "That's no fun. The point is to\nhave your own UTXO, so really be in control\nof your own money and have your own private keys.",
    "start": "3984740",
    "end": "3991430"
  },
  {
    "text": "However, if the\nblocks are too large, then not many people can run it. If the blocks are\na gigabyte each",
    "start": "3991430",
    "end": "3998150"
  },
  {
    "text": "and you've got these\npetabyte-sized blockchains, I can't run that.",
    "start": "3998150",
    "end": "4003190"
  },
  {
    "text": "I need a data center. And then you can't really\nverify and validate that the system is operating\nthe way you think it will.",
    "start": "4003190",
    "end": "4010390"
  },
  {
    "text": "You're just going to\nhave to trust, again, some kind of big institution\nto do it for you. So they both sort of\nturn into the same thing",
    "start": "4010390",
    "end": "4016900"
  },
  {
    "text": "when you're at the extremes. If it's too small, well, I\ncan't really own my own coins, I got to have someone\nelse do it for me.",
    "start": "4016900",
    "end": "4022570"
  },
  {
    "text": "If it's too large, I guess I\ncan own my own private keys, but I have no idea\nif they're actually-- if there's an actual\ntransaction in the blockchain",
    "start": "4022570",
    "end": "4029620"
  },
  {
    "text": "because I can't download it. So these are sort of\nbalances based on hardware.",
    "start": "4029620",
    "end": "4035440"
  },
  {
    "text": "And we're thinking, well, as\ncomputers get more powerful and networks get more\npowerful, we can sort of",
    "start": "4035440",
    "end": "4041260"
  },
  {
    "text": "get into the larger side\nand people will still be able to run it. And we have seen that.",
    "start": "4041260",
    "end": "4046480"
  },
  {
    "text": "So like with SegWit,\nthe block size has been increased\nthrough software. So it now takes a bit more\nspace and more network traffic",
    "start": "4046480",
    "end": "4053770"
  },
  {
    "text": "to use. However, the long-term\nfee sniping thing, it's not hardware related.",
    "start": "4053770",
    "end": "4060180"
  },
  {
    "text": "Even if you had\nperfect computers that were sort of like, oh,\nthis network can send any amount of data instantly,\nwe've got unlimited drive",
    "start": "4060180",
    "end": "4067559"
  },
  {
    "text": "space, these are computronium-- that's a thing, right, the\ntheoretical maximum computer.",
    "start": "4067560",
    "end": "4075549"
  },
  {
    "text": "So even if you have\nthis amazing computer and the hardware limits\nare not a limit at all, you still have to\nbalance the block size.",
    "start": "4075550",
    "end": "4083609"
  },
  {
    "text": "Because if you make your\nblock size too large, you're going to have that\nproblem long term, where there's no real fee market\nbecause there's no competition",
    "start": "4083610",
    "end": "4090600"
  },
  {
    "text": "to get into the blocks. And so the whole system kinds\nof halts, and then you've",
    "start": "4090600",
    "end": "4096600"
  },
  {
    "text": "got the largest miner\njust keep winning. So this is a mess.",
    "start": "4096600",
    "end": "4103220"
  },
  {
    "text": "There's a paper. What's it called? ",
    "start": "4103220",
    "end": "4110000"
  },
  {
    "text": "Like, Bitcoin Is Not Stable\nWithout a Fee or something. It's Princeton guys, right?",
    "start": "4110000",
    "end": "4116174"
  },
  {
    "start": "4116175",
    "end": "4125829"
  },
  {
    "text": "\"On the Instability of Bitcoin\nWithout the Block Reward.\" And to be fair--",
    "start": "4125830",
    "end": "4132189"
  },
  {
    "text": "yeah, these are Princeton guys. To be fair-- and they\nwrite about this issue.",
    "start": "4132189",
    "end": "4138929"
  },
  {
    "text": "But it's a little weird,\nbecause one of their assumptions is that--",
    "start": "4138930",
    "end": "4144060"
  },
  {
    "text": "mining strategy simulator. Anyway, one of their assumptions\nis that every miner completely",
    "start": "4144060",
    "end": "4149790"
  },
  {
    "text": "wipes out the mempool\nat every block. And it's like, wait,\nthat assumption-- given that assumption, yes,\nyou can show that it's unstable",
    "start": "4149790",
    "end": "4157202"
  },
  {
    "text": "and there's all these problems,\nlike I was sort of showing. But that assumption\nis a huge assumption.",
    "start": "4157202",
    "end": "4162330"
  },
  {
    "text": "And a lot of the people\nworking on Bitcoin are like, no, you can't\nmake that assumption. Because we're aware that there's\nthese instability problems,",
    "start": "4162330",
    "end": "4169649"
  },
  {
    "text": "and the solution, to the extent\nthat it's a solution, is always have a backlog.",
    "start": "4169649",
    "end": "4175318"
  },
  {
    "text": "There's a really big\ndemand for transactions, and there's not\nenough space, and so people have to compete\nbased on their fees.",
    "start": "4175319",
    "end": "4183450"
  },
  {
    "text": "In that case, you can have\na stable system, long term, where the miners get paid. But without it,\nthese guys show it.",
    "start": "4183450",
    "end": "4189859"
  },
  {
    "text": "And so yeah, it's true,\nbut it's sort of weird because one of\ntheir assumptions is that there are no fees,\nlong term, essentially.",
    "start": "4189859",
    "end": "4199160"
  },
  {
    "text": "So yeah, this is a weird issue,\nand it's also how, timing-wise,",
    "start": "4199160",
    "end": "4204950"
  },
  {
    "text": "do we need to worry\nabout this now? Maybe we can just punt\nthe problem for a decade and try to get lots of adoption,\nlots of people using Bitcoin,",
    "start": "4204950",
    "end": "4211520"
  },
  {
    "text": "and we'll figure it out once\nit's really well established. I don't think that works. I think it's harder and\nharder to change these systems",
    "start": "4211520",
    "end": "4217770"
  },
  {
    "text": "as more people use it. So maybe we're stuck. And it's almost certain that\none megabyte or four megabytes",
    "start": "4217770",
    "end": "4224119"
  },
  {
    "text": "is not the optimal size. We have no idea what the\noptimal size is, right? Long term-- because\nalso, long term,",
    "start": "4224120",
    "end": "4229699"
  },
  {
    "text": "how many people are\ngoing to using this, and for what, and for\nwhat kind of transactions? So it's definitely\nan open problem.",
    "start": "4229700",
    "end": "4238000"
  },
  {
    "text": "Yeah, so we're sort of\nat the dawn of the fees. A year ago, we didn't\nhave all these things.",
    "start": "4238000",
    "end": "4246177"
  },
  {
    "text": "We're starting to\nunderstand the fee markets and see how it works. What's interesting is\nthat the elasticity",
    "start": "4246177",
    "end": "4252210"
  },
  {
    "text": "seems like people really want\ntheir transactions in when they want them in, which\nI guess can make sense. If the price of Bitcoin\nspikes to $18,000,",
    "start": "4252210",
    "end": "4260505"
  },
  {
    "text": "and you're like, I want to\nsell one, it's going to crash, and you're like, yeah,\nI'll pay $50 to move it, to sell to someone, because\nI'm selling millions of dollars",
    "start": "4260505",
    "end": "4268080"
  },
  {
    "text": "worth. And so it seems\nreally inelastic. You also have people,\ncompanies, wasting millions",
    "start": "4268080",
    "end": "4275860"
  },
  {
    "text": "of dollars on fees that you can\njust be like, why'd you do-- oh, OK. You're wasting on\nspace, wasting on fees.",
    "start": "4275860",
    "end": "4283900"
  },
  {
    "text": "It is a fun research area. And it's definitely research. And so I'm like, yeah,\nI hope this works. We don't really know, long term,\nif this whole system is stable",
    "start": "4283900",
    "end": "4290950"
  },
  {
    "text": "and works.  I think it can. But it's not something to base\nthe global economy on just yet,",
    "start": "4290950",
    "end": "4300940"
  },
  {
    "text": "because we're not quite sure\nit all really works long term, but we think it does.",
    "start": "4300940",
    "end": "4307050"
  },
  {
    "text": "OK, any questions about this\nsort of long-range attack stuff? ",
    "start": "4307050",
    "end": "4314050"
  },
  {
    "text": "Yes. AUDIENCE: What's the case\nwith a bunch alt coins points that don't have full members?",
    "start": "4314050",
    "end": "4319900"
  },
  {
    "text": "TADGE DRYJA: Alt coins? AUDIENCE: The rest of\nthe cryptocurrency space that has sparse mempools.",
    "start": "4319900",
    "end": "4325360"
  },
  {
    "text": "TADGE DRYJA: They\ngenerally don't have fees, or the fees are enforced--",
    "start": "4325360",
    "end": "4330953"
  },
  {
    "text": "you can enforce a fee. You can say, hey, the consensus\nrule of this system is that every transaction has to have\na 50-Satoshis-per-byte fee.",
    "start": "4330953",
    "end": "4341989"
  },
  {
    "text": "There's problems with\nthat, because then you can have out-of-band\nfees where, if you",
    "start": "4341990",
    "end": "4347210"
  },
  {
    "text": "try to make it a consensus\nrule, it doesn't really work. It's sort of like price\ncontrols, where you can say,",
    "start": "4347210",
    "end": "4353150"
  },
  {
    "text": "hey, you have to sell\nmilk for $2 a gallon. And it's like, well, that's\nnot what the market says.",
    "start": "4353150",
    "end": "4359030"
  },
  {
    "text": "So people can go out of band. And then they're saying,\nOK, the consensus rule is I have to pay this fee, but\nreally, how about you give me",
    "start": "4359030",
    "end": "4364940"
  },
  {
    "text": "some of it back? Or-- so generally\nthe rules they put in are minimum\nfees, which you can",
    "start": "4364940",
    "end": "4370850"
  },
  {
    "text": "try to work around that way. But in general, most of\nthe other alt coins--",
    "start": "4370850",
    "end": "4376614"
  },
  {
    "text": "with the exception of\nEthereum, Ethereum definitely has similar issues-- but most of the alt\ncoins have a block size",
    "start": "4376615",
    "end": "4382490"
  },
  {
    "text": "or a network capacity\nthat exceeds their uses. So there isn't\nreally competition to get into the next block.",
    "start": "4382490",
    "end": "4388990"
  },
  {
    "text": "Ethereum, though,\nsimilar to Bitcoin, has-- well, I don't-- where did it go?",
    "start": "4388990",
    "end": "4397110"
  },
  {
    "text": "This kind of thing. I don't know, if you\ngraphed Ethereum, it probably wouldn't\nlook quite the same. But there are also\ntimes in Ethereum",
    "start": "4397110",
    "end": "4404820"
  },
  {
    "text": "where the fees skyrocket. A lot of times\nwith ICOs, everyone wants to get in their\nbids really quick,",
    "start": "4404820",
    "end": "4411199"
  },
  {
    "text": "and so the network will get\nsuper congested for a day, and no one can use it for\nanything-- for normal uses.",
    "start": "4411200",
    "end": "4417190"
  },
  {
    "text": "So Ethereum also\nhas this problem. It's not quite the same in\nthat it's not a block size, it's a gas per\nblock kind of thing,",
    "start": "4417190",
    "end": "4424079"
  },
  {
    "text": "so how much computation\nor storage it's using. But in practice it's\na similar thing.",
    "start": "4424080",
    "end": "4430595"
  },
  {
    "text": "So yeah, those are\nsort of the only two that I'm aware of that really\nhave hit this issue so far.",
    "start": "4430595",
    "end": "4436840"
  },
  {
    "text": " Any other questions about\nthis, the long term?",
    "start": "4436840",
    "end": "4442870"
  },
  {
    "text": "Yes. AUDIENCE: Could you\ncomment on blockchains that have no transaction fee,\nparticularly blockchains that",
    "start": "4442870",
    "end": "4450160"
  },
  {
    "text": "are designed for\nthings like IoT, and which pay to be able\nto handle microtransactions and transactions at face\nvalue without any fee.",
    "start": "4450160",
    "end": "4459953"
  },
  {
    "text": "TADGE DRYJA: Should I\ntake advice from counsel before commenting on this? [LAUGHTER] Yeah, so you could Google--",
    "start": "4459953",
    "end": "4466292"
  },
  {
    "text": "there's one, I\ndon't know if you're talking about it\nspecifically-- there's one called Iota that we\nlooked at last summer.",
    "start": "4466292",
    "end": "4472850"
  },
  {
    "text": "My mom tells me, if you don't\nhave anything nice to say, don't say anything. But we did say quite\na bit in our report.",
    "start": "4472850",
    "end": "4482240"
  },
  {
    "text": "That one specifically,\nI don't think it really works that well. Actually, they have a fee,\nthey just pretend they don't.",
    "start": "4482240",
    "end": "4490800"
  },
  {
    "text": "But they very much have a fee. So in Iota's case,\nthey say, you have to do work on your transaction. You have to mine\nyour transaction.",
    "start": "4490800",
    "end": "4497330"
  },
  {
    "text": "And they say that's not a fee. Well, OK, it's on a fee you're\npaying to some other miner, but you're still doing work.",
    "start": "4497330",
    "end": "4503000"
  },
  {
    "text": "That has a cost. You can say it's\na cost, not a fee. I don't know. But it feels like saying, hey,\nthis refrigerator doesn't need",
    "start": "4503000",
    "end": "4510050"
  },
  {
    "text": "electricity to run, it's just\ngot a hand crank in the back that you have to-- yeah, OK, I don't\nhave to plug it in,",
    "start": "4510050",
    "end": "4516030"
  },
  {
    "text": "but I still have\nto do all the work. So it's an anti-spam measure\nwhich you have to do work on.",
    "start": "4516030",
    "end": "4523050"
  },
  {
    "text": "So it's the same new thing. But there are some that\nhave no fee whatsoever, and they're very\nsusceptible to spamming.",
    "start": "4523050",
    "end": "4529850"
  },
  {
    "text": "If there's no fee, what stops\nme from just sending out a bazillion\ntransactions and having everyone else store them?",
    "start": "4529850",
    "end": "4535850"
  },
  {
    "text": "AUDIENCE: Generally\nwell MANO is one of them that claims to be instant\nno fees, et cetera. But what that means\nis, to get around that,",
    "start": "4535850",
    "end": "4543050"
  },
  {
    "text": "they've made it so that you\ndon't need global consensus-- until you do need global\nconsensus, at which point",
    "start": "4543050",
    "end": "4548460"
  },
  {
    "text": "you do proof of state\nand [INAUDIBLE].. But since there\nare no fees, it's free to just calls for\nstate to happen every round,",
    "start": "4548460",
    "end": "4556390"
  },
  {
    "text": "[INAUDIBLE] a bunch of\nconflicting transactions. TADGE DRYJA: Huh. Yeah, there's a lot of really\nsmart people, way smarter",
    "start": "4556390",
    "end": "4566450"
  },
  {
    "text": "than me, working\non these things. And it's a hard\nproblem, and they seem to think it's a hard problem. So I'm very skeptical\nwhen someone, especially",
    "start": "4566450",
    "end": "4574520"
  },
  {
    "text": "with a financial interest\nin getting me to believe that they've solved\nthis problem, says, hey, I've solved\nthe problem, zero fees,",
    "start": "4574520",
    "end": "4579890"
  },
  {
    "text": "infinite scalability. I'm just very skeptical\nwhen I see that. Because, OK, what did you do?",
    "start": "4579890",
    "end": "4585325"
  },
  {
    "text": "Like, we've been\nlooking at this. Maybe there's something there. But I haven't seen any\nreally great stuff.",
    "start": "4585325",
    "end": "4593873"
  },
  {
    "text": "There's Lightning Network, which\nI'll talk about in a few weeks, and I think that's pretty cool,\nand I sort of work on that.",
    "start": "4593873",
    "end": "4600740"
  },
  {
    "text": "There's other different\nways to do this. But in general, there's\ngot to be a cost.",
    "start": "4600740",
    "end": "4607683"
  },
  {
    "text": "There's no free lunch. And you're going to have to-- if you're requiring other\npeople to store a lot of data and process it, there's got to\nbe some kind of limit there.",
    "start": "4607683",
    "end": "4616059"
  }
]