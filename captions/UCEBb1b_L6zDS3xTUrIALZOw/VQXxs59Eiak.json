[
  {
    "start": "0",
    "end": "17888"
  },
  {
    "text": "[AUDIO PLAYBACK] - Good morning, class. [END PLAYBACK] MICHALE FEE: Hey, let's\ngo ahead and get started. So we're going to finish\nspectral analysis today.",
    "start": "17888",
    "end": "25150"
  },
  {
    "text": "So we are going to learn how to\nmake a graphical representation",
    "start": "25150",
    "end": "32369"
  },
  {
    "text": "like this of the spectral and\ntemporal structure of time series, or in this case,\na speech signal recorded",
    "start": "32369",
    "end": "39840"
  },
  {
    "text": "on a microphone. Well, actually let\nme just tell you exactly what it is that\nwe're looking at here.",
    "start": "39840",
    "end": "46579"
  },
  {
    "text": "So this is a spectrogram that\ndisplays the amount of power",
    "start": "46580",
    "end": "52080"
  },
  {
    "text": "in this signal as\na function of time and as a function of frequency.",
    "start": "52080",
    "end": "57430"
  },
  {
    "text": "So you remember we've been\nlearning how to construct the spectrum of a signal.",
    "start": "57430",
    "end": "64500"
  },
  {
    "text": "And today, we're\ngoing to learn how to construct a representation\nlike this, called",
    "start": "64500",
    "end": "71600"
  },
  {
    "text": "a spectrogram, that shows how\nthat spectrum varies over time. So as you recall,\nwe have learned",
    "start": "71600",
    "end": "77610"
  },
  {
    "text": "how to compute the Fourier\ntransform of a signal. This is one of the signals\nthat we actually started with.",
    "start": "77610",
    "end": "86010"
  },
  {
    "text": "So if you compute the Fourier\ntransform of this square wave, you can see that in\nthe frequency domain,",
    "start": "86010",
    "end": "92710"
  },
  {
    "text": "now we plot the amount\nof, essentially, the components of this signal\nat different frequencies.",
    "start": "92710",
    "end": "99090"
  },
  {
    "text": "So the Fourier transform\nof this square wave has a number of peaks. Each of these peaks correspond\nto a cosine contribution",
    "start": "99090",
    "end": "109350"
  },
  {
    "text": "to this time series, OK? All right.",
    "start": "109350",
    "end": "114520"
  },
  {
    "text": "And we also\ndiscussed how you can compute the power\nspectrum of a signal",
    "start": "114520",
    "end": "119890"
  },
  {
    "text": "from the Fourier transform. So here what I've done\nis I've taken the Fourier transform of this square wave.",
    "start": "119890",
    "end": "127120"
  },
  {
    "text": "And now we take the\nsquare magnitude of each of these\nvalues, and we just plot the spectrum,\nthe square magnitude",
    "start": "127120",
    "end": "134380"
  },
  {
    "text": "of just the positive\nfrequency components. For real-valued functions, the\npower spectrum is symmetric.",
    "start": "134380",
    "end": "141640"
  },
  {
    "text": "The power in each of these-- at each of these frequencies\nin the positive, half of the--",
    "start": "141640",
    "end": "148366"
  },
  {
    "text": "for the positive frequencies\nis exactly the same as the power in the\nnegative frequencies.",
    "start": "148366",
    "end": "154100"
  },
  {
    "text": "So if we plot the power\nspectrum of that square wave, we can see that there\nare multiple peaks",
    "start": "154100",
    "end": "159430"
  },
  {
    "text": "at regular intervals. Now the problem with plotting\npower spectra on a linear scale",
    "start": "159430",
    "end": "166000"
  },
  {
    "text": "here is that you often\nhave contributions-- important contributions to\nsignals that actually have",
    "start": "166000",
    "end": "171910"
  },
  {
    "text": "a very small amount of\npower when you plot them on a linear scale. And so you can barely see them.",
    "start": "171910",
    "end": "178180"
  },
  {
    "text": "You can barely see\nthose contributions at these frequencies\nhere on a linear scale.",
    "start": "178180",
    "end": "184070"
  },
  {
    "text": "But if you plot\nthis on a log scale, you can see the spectrum\nmuch more easily. So for example,\nwhat we've done here",
    "start": "184070",
    "end": "190569"
  },
  {
    "text": "is we've plotted the square\nmagnitude of the Fourier transform, taken the log\nbase 10 of that spectrum--",
    "start": "190570",
    "end": "199840"
  },
  {
    "text": "spectrum is the square magnitude\nof the Fourier transform. And now we can take the log\nbase 10 of the power spectrum",
    "start": "199840",
    "end": "208520"
  },
  {
    "text": "to get the power\nin units of bels, and multiply that by 10 to get\nthe power in units of decibels,",
    "start": "208520",
    "end": "217090"
  },
  {
    "text": "OK? So each tick mark here\nof size 10 corresponds",
    "start": "217090",
    "end": "223209"
  },
  {
    "text": "to one order of\nmagnitude in power, OK? So this peak here is about 10\ndB lower than that peak there,",
    "start": "223210",
    "end": "231400"
  },
  {
    "text": "and that corresponds to about\na factor of 10 lower in power.",
    "start": "231400",
    "end": "236959"
  },
  {
    "text": "OK, any questions about that? I want to be able-- want\nyou to understand what these units of decibels are.",
    "start": "236960",
    "end": "243130"
  },
  {
    "text": "They're going to be on the test. OK. Questions about that? You want to just\nask me right now?",
    "start": "243130",
    "end": "248925"
  },
  {
    "text": "OK. Remember this. OK.",
    "start": "248925",
    "end": "254049"
  },
  {
    "text": "And keep in mind that\nthe power in a signal is proportional to the\nsquare of the amplitude, OK?",
    "start": "254050",
    "end": "261648"
  },
  {
    "text": "So if I tell you that a signal\nhas 10 times as much amplitude, it's going to have 100\ntimes as much power.",
    "start": "261649",
    "end": "268960"
  },
  {
    "text": "100 times as much\npower is 10 to the 2",
    "start": "268960",
    "end": "275500"
  },
  {
    "text": "bels, which is 20 decibels. Does that make sense? OK.",
    "start": "275500",
    "end": "280680"
  },
  {
    "text": "All right. So we also talked about\nsome Fourier transforms of different kinds of functions.",
    "start": "280680",
    "end": "286530"
  },
  {
    "text": "So this is the Fourier\ntransform of a square pulse. So here I showed\nyou a square pulse that has a width of\n100 milliseconds.",
    "start": "286530",
    "end": "293460"
  },
  {
    "text": "The Fourier transform\nis this sinc function, and for a square pulse of\nwidth 100 milliseconds,",
    "start": "293460",
    "end": "300180"
  },
  {
    "text": "the sinc function has a half-- sorry-- has a full width\nat half height of 12 hertz.",
    "start": "300180",
    "end": "307400"
  },
  {
    "text": "If we have a square pulse\nthat's five times as long, 500 milliseconds long,\nthe Fourier transform",
    "start": "307400",
    "end": "314990"
  },
  {
    "text": "is the sinc function\nagain, but it has a width of this central\nlobe here of 2.4 hertz.",
    "start": "314990",
    "end": "321560"
  },
  {
    "text": "So you can see that the longer\nthe pulse, the shorter-- the narrower the structure\nin the frequency domain.",
    "start": "321560",
    "end": "328320"
  },
  {
    "text": "Up here, if we'd look\nat the Fourier transform of a square pulse that's\n25 milliseconds long,",
    "start": "328320",
    "end": "334639"
  },
  {
    "text": "then the Fourier transform\nis again a sinc function, and the width of that\ncentral lobe is 48 hertz.",
    "start": "334640",
    "end": "340310"
  },
  {
    "text": "So you can see that the\nwidth in the time domain and the width in the frequency\ndomain are inversely related.",
    "start": "340310",
    "end": "346830"
  },
  {
    "text": "So the product of the\nwidth in the time domain and the width in the\nfrequency domain is constant.",
    "start": "346830",
    "end": "352760"
  },
  {
    "text": "And that constant is called\nthe time-bandwidth product of that signal.",
    "start": "352760",
    "end": "358360"
  },
  {
    "text": "The time-bandwidth product\nof this square pulse and sinc function is constant.",
    "start": "358360",
    "end": "365169"
  },
  {
    "text": "It's independent of the width. The time-bandwidth product\nis a function of that. It's a characteristic\nof that functional form.",
    "start": "365170",
    "end": "376084"
  },
  {
    "text": "OK. Now we also talked about\nthe convolution theorem,",
    "start": "376084",
    "end": "381110"
  },
  {
    "text": "which relates the way signals\nget multiplied in time or convolved in\nfrequency domain.",
    "start": "381110",
    "end": "387840"
  },
  {
    "text": "So for example, if we have a\nsquare pulse in time multiplied by a cosine function in time\nto get a windowed cosine--",
    "start": "387840",
    "end": "395780"
  },
  {
    "text": "so this function\nis zero everywhere except it's cosine\nwithin this window--",
    "start": "395780",
    "end": "401760"
  },
  {
    "text": "we can compute the\nFourier transform of this windowed cosine function\nby convolving the Fourier",
    "start": "401760",
    "end": "409020"
  },
  {
    "text": "transform of the square\npulse with the Fourier transform of the cosine\nfunction, like this.",
    "start": "409020",
    "end": "414272"
  },
  {
    "text": "So the Fourier transform\nof the square pulse is, again, this sinc function. The Fourier transform\nof the cosine",
    "start": "414272",
    "end": "420860"
  },
  {
    "text": "are these two delta functions. Now if we convolve the sinc\nfunction with those two delta",
    "start": "420860",
    "end": "426680"
  },
  {
    "text": "functions, we get a copy\nof that sinc function at the location of each\nof those delta functions.",
    "start": "426680",
    "end": "433560"
  },
  {
    "text": "And that is the\nFourier transform, OK? Any questions about that? Just a quick review of things\nwe've been talking about.",
    "start": "433560",
    "end": "441770"
  },
  {
    "text": "All right. So we can look at this\nFourier transform here.",
    "start": "441770",
    "end": "446920"
  },
  {
    "text": "We can look at\nthe power spectrum of this windowed cosine\nfunction, like this.",
    "start": "446920",
    "end": "453560"
  },
  {
    "text": "So there's the windowed\ncosine function. The power spectrum--\nthe power spectrum plotted on a linear scale\nis just the square magnitude",
    "start": "453560",
    "end": "462310"
  },
  {
    "text": "of what I've plotted here. And we're just going to plot\nthe positive frequencies.",
    "start": "462310",
    "end": "467870"
  },
  {
    "text": "That's what the power\nspectrum of that signal looks like on a log scale. So you can see\nthat it has a peak",
    "start": "467870",
    "end": "474729"
  },
  {
    "text": "at 20 hertz, which\nwas the frequency of the cosine function. You see some little\nwiggles out here.",
    "start": "474730",
    "end": "481789"
  },
  {
    "text": "But if you look on\na log scale, you can see that those\nwiggles off to the side are actually quite significant.",
    "start": "481790",
    "end": "487939"
  },
  {
    "text": "The first side lobe there\nhas a power that's about 1/10 of the central peak.",
    "start": "487940",
    "end": "493840"
  },
  {
    "text": "That may not matter,\nsometimes, when you're looking at the\nspectrum of a signal, but sometimes it will matter\nbecause those side lobes",
    "start": "493840",
    "end": "501640"
  },
  {
    "text": "there will interfere. They'll mask the spectrum of\nother components of this signal",
    "start": "501640",
    "end": "508900"
  },
  {
    "text": "that you may be interested in. We also talked about\nhow this spectrum",
    "start": "508900",
    "end": "515469"
  },
  {
    "text": "depends on the function that you\nmultiply your cosine by here. So for example, if\nyou take a cosine",
    "start": "515470",
    "end": "522549"
  },
  {
    "text": "and you multiply it by\nGaussian, the power spectrum has the shape of\na Gaussian, it's",
    "start": "522549",
    "end": "529450"
  },
  {
    "text": "a Gaussian that has\na peak at 20 hertz. And if you look at the--",
    "start": "529450",
    "end": "535450"
  },
  {
    "text": "if you look at that\nspectrum on a log scale, you can see that it loses it--",
    "start": "535450",
    "end": "540580"
  },
  {
    "text": "you've lost all of these\nhigh-frequency wiggles, up here. All of those wiggles\ncome from the sharp edge",
    "start": "540580",
    "end": "548110"
  },
  {
    "text": "of this square pulse\nwindowing function, OK? So the shape of the\nspectrum that you get",
    "start": "548110",
    "end": "555430"
  },
  {
    "text": "depends a lot on how\nyou window the function that you're looking at.",
    "start": "555430",
    "end": "561630"
  },
  {
    "text": "Questions about that? Right, again, more review. OK. So we talked about estimating\nthe spectrum of a signal.",
    "start": "561630",
    "end": "569110"
  },
  {
    "text": "If you have many different\nmeasurements of some signal, you can actually just compute\nthe spectrum of each one.",
    "start": "569110",
    "end": "575380"
  },
  {
    "text": "This little hat here means\nan estimate of the spectrum. You compute some estimate\nof the spectrum of each",
    "start": "575380",
    "end": "581380"
  },
  {
    "text": "of those trials,\nsamples of your data, and you can just average\nof those together.",
    "start": "581380",
    "end": "588154"
  },
  {
    "text": "OK, now if you have a continuous\nsignal, you can also-- you could estimate\nthe spectrum just",
    "start": "588154",
    "end": "594450"
  },
  {
    "text": "by taking the Fourier\ntransform of a long recording of your signal. But it's much better to break\nyour signal into small pieces,",
    "start": "594450",
    "end": "603210"
  },
  {
    "text": "compute a spectral estimate of\neach one of those small pieces and average those together.",
    "start": "603210",
    "end": "608440"
  },
  {
    "text": "Now how do you construct a\nsmall sample of a signal? If you have a continuous\nsignal, how do you",
    "start": "608440",
    "end": "615480"
  },
  {
    "text": "take a small sample of it? Well, you can think\nabout that as taking your continuous signal\nand multiplying it",
    "start": "615480",
    "end": "621779"
  },
  {
    "text": "by a square window. Setting everything outside\nthat window to zero and just keeping the part\nthat's in that window.",
    "start": "621780",
    "end": "628993"
  },
  {
    "text": "And you know that\nwhen you take a signal and you multiply it by a square\nwindow, what have you done?",
    "start": "628993",
    "end": "634199"
  },
  {
    "text": "You've convolved the spectrum\nof this original signal with the spectrum of\nthis square pulse.",
    "start": "634200",
    "end": "641130"
  },
  {
    "text": "And that spectrum\nof the square pulse is really a nasty\nlooking thing, right? It is this what we call the\nDirichlet kernel, which is just",
    "start": "641130",
    "end": "649590"
  },
  {
    "text": "the power spectrum\nof a square pulse that we just talked about, OK? So that's called the\nDirichlet kernel.",
    "start": "649590",
    "end": "655680"
  },
  {
    "text": "And using a square pulse to\nselect out a sample of data",
    "start": "655680",
    "end": "663240"
  },
  {
    "text": "introduces two errors into\nyour spectral estimate, narrowband bias.",
    "start": "663240",
    "end": "669330"
  },
  {
    "text": "It broadens your estimate of\nthe spectrum of, let's say, sinusoidal or periodic\ncomponents in your signal.",
    "start": "669330",
    "end": "677220"
  },
  {
    "text": "And it also introduces\nthese side lobes. So the way we solve\nthat problem is",
    "start": "677220",
    "end": "683649"
  },
  {
    "text": "we break our signal\ninto little pieces, multiply each of\nthose little pieces by a smoother windowing\nfunction by something",
    "start": "683650",
    "end": "691000"
  },
  {
    "text": "that isn't a square\npulse, multiply it by something that maybe\nlooks like a Gaussian, or a--",
    "start": "691000",
    "end": "696700"
  },
  {
    "text": "or half of a cosine function. That gives us what we call\ntapered segments of our data.",
    "start": "696700",
    "end": "706620"
  },
  {
    "text": "We can estimate the spectrum\nof those tapered pieces and averaged those together, OK?",
    "start": "706620",
    "end": "712802"
  },
  {
    "text": "Any questions? OK, again, that's a review. And I showed you briefly\nwhat happens if we",
    "start": "712802",
    "end": "718310"
  },
  {
    "text": "take a little piece of signal. The blue is white\nnoise with a little bit",
    "start": "718310",
    "end": "723500"
  },
  {
    "text": "of this periodic sine\nfunction added to it.",
    "start": "723500",
    "end": "729090"
  },
  {
    "text": "And if you run\nthat analysis, you can see that there is a large\ncomponent of the spectrum",
    "start": "729090",
    "end": "734960"
  },
  {
    "text": "that's due to the white noise. That's this broadband\ncomponent here. And that sinusoidal\ncomponent there gives you",
    "start": "734960",
    "end": "742700"
  },
  {
    "text": "this peak in the spectrum, OK? And there's a--",
    "start": "742700",
    "end": "748260"
  },
  {
    "text": "I've posted-- or Daniel's\nposted a function called wspec.m that implements\nthis spectral estimate",
    "start": "748260",
    "end": "755350"
  },
  {
    "text": "like this. So now today, we're going to\nturn to estimating time varying",
    "start": "755350",
    "end": "761560"
  },
  {
    "text": "signals, estimating the spectrum\nof time varying signals. So this is a microphone\nrecording of a speech signal.",
    "start": "761560",
    "end": "768240"
  },
  {
    "text": "Let me see if I can play that. [AUDIO PLAYBACK] - Hello. [END PLAYBACK] MICHALE FEE: All right. So that's just me saying\nhello in a robotic voice.",
    "start": "768240",
    "end": "776510"
  },
  {
    "text": "OK. So that is the signal. That's basically\nvoltage recorded",
    "start": "776510",
    "end": "782890"
  },
  {
    "text": "on the output of a microphone. It's got some interesting\nstructure in it, right? So first these\nlittle pulses here,",
    "start": "782890",
    "end": "793000"
  },
  {
    "text": "you see this kind\nof periodic pulse. Those are called glottal pulses. Does anyone know what those are?",
    "start": "793000",
    "end": "799330"
  },
  {
    "text": "What produces those? No? OK, so when you\nspeak a voiced sound,",
    "start": "799330",
    "end": "808580"
  },
  {
    "text": "your vocal cords are vibrating. You have two pieces\nof flexible tissue",
    "start": "808580",
    "end": "815089"
  },
  {
    "text": "that are close to each\nother in your trachea. As air flows up\nthrough your trachea,",
    "start": "815090",
    "end": "820880"
  },
  {
    "text": "the air pressure builds up and\npushes the glottal folds apart.",
    "start": "820880",
    "end": "826250"
  },
  {
    "text": "Air begins to flow rapidly\nthrough that open space. At high velocities,\nthe velocity flowing",
    "start": "826250",
    "end": "834500"
  },
  {
    "text": "through the constriction is\nhigher than the velocity of air anywhere else in the\ntrachea because it's flowing through a tiny little space.",
    "start": "834500",
    "end": "841160"
  },
  {
    "text": "At high velocities,\nat constrictions where you have a\nhigh fluid flow,",
    "start": "841160",
    "end": "846800"
  },
  {
    "text": "the pressure actually drops. And that pulls the vocal\nfolds back together again.",
    "start": "846800",
    "end": "854660"
  },
  {
    "text": "When they snap together,\nall the airflow stops, and you have a pulse of negative\npressure above the glottis,",
    "start": "854660",
    "end": "862080"
  },
  {
    "text": "right? Imagine you have\nairflow coming up. And all of a sudden,\nyou pinch it off.",
    "start": "862080",
    "end": "867260"
  },
  {
    "text": "There's a sudden drop in the\npressure as that mass of air keeps flowing up, but there's\nnothing more coming up below.",
    "start": "867260",
    "end": "873649"
  },
  {
    "text": "So you get a sharp\ndrop in the pressure. Then the air pressure\nbuilds up again.",
    "start": "873650",
    "end": "878750"
  },
  {
    "text": "The glottal folds open,\nvelocity increases, and they snap shut again. And so that's what happens\nas you're talking, OK?",
    "start": "878750",
    "end": "886459"
  },
  {
    "text": "And so that periodic\nsignal right there, those",
    "start": "886460",
    "end": "891740"
  },
  {
    "text": "pulses in pressure--\nthe microphone is recording pressure, remember. So those pulses are due\nto your glottis snapping",
    "start": "891740",
    "end": "900199"
  },
  {
    "text": "shut each time it\ncloses during the cycle,",
    "start": "900200",
    "end": "906290"
  },
  {
    "text": "during that oscillatory cycle. The period of that--\nthose glottal pulses is about 10 milliseconds in\nmen and about 5 milliseconds",
    "start": "906290",
    "end": "916550"
  },
  {
    "text": "in women. OK. But you can see there's\na lot of other structure changes in this signal\nthat go on through time.",
    "start": "916550",
    "end": "923780"
  },
  {
    "text": "But let's start by just\nlooking at the spectrum of that whole signal. Now what might we expect?",
    "start": "923780",
    "end": "929670"
  },
  {
    "text": "So if you have periodic pulses\nat 10 millisecond period,",
    "start": "929670",
    "end": "935089"
  },
  {
    "text": "what should the\nspectrum look like? If you have a train of pulses,\nlet's say delta functions",
    "start": "935090",
    "end": "943240"
  },
  {
    "text": "with 10 millisecond period, what\nwould the spectrum of that look like?",
    "start": "943240",
    "end": "949375"
  },
  {
    "text": "Anybody remember what the\nspectrum of a train of pulses looks like? ",
    "start": "949375",
    "end": "957910"
  },
  {
    "text": "Almost, yes. There would be. But there would be\nother things as well. ",
    "start": "957910",
    "end": "964230"
  },
  {
    "text": "What would a signal\nlook like that just has a peak at 100 hertz? What is that?",
    "start": "964230",
    "end": "969350"
  },
  {
    "text": " Has one peak at 100 hertz?",
    "start": "969350",
    "end": "974390"
  },
  {
    "text": "Or let's say [INAUDIBLE]\nFourier transform would have a peak at 100 and at minus 100.",
    "start": "974390",
    "end": "982630"
  },
  {
    "text": "That's just a cosine. That's not a train of pulses. What's the Fourier transform\nof a train of pulses?",
    "start": "982630",
    "end": "989350"
  },
  {
    "text": "Those of you who are\nconcentrating on this right now are going to be really\nglad on the midterm. What's the Fourier transform\nof a train of pulses?",
    "start": "989350",
    "end": "997840"
  },
  {
    "text": "OK, let's go back to\nhere because there was a bit of a hint here at\nthe beginning of lecture.",
    "start": "997840",
    "end": "1003019"
  },
  {
    "text": "What's the Fourier\ntransform of a square wave? Any idea what happens if we\nmake these pulses narrower",
    "start": "1003020",
    "end": "1011103"
  },
  {
    "text": "and narrower? ",
    "start": "1011103",
    "end": "1016530"
  },
  {
    "text": "The pulses get more\nand more narrow, these peaks get\nbigger and bigger. And as we go to a train\nof delta functions,",
    "start": "1016530",
    "end": "1025050"
  },
  {
    "text": "you just get Fourier\ntransform of a train of delta functions\nin time, is just a train of delta\nfunctions in frequency.",
    "start": "1025050",
    "end": "1033349"
  },
  {
    "text": "The spacing between the\npeaks in frequency is just 1 over the spacing between\nthe peaks in time, right?",
    "start": "1033349",
    "end": "1041130"
  },
  {
    "text": "Make sure you know that. ",
    "start": "1041130",
    "end": "1047409"
  },
  {
    "text": "OK, so now let's go back\nto our speech signal. ",
    "start": "1047410",
    "end": "1054967"
  },
  {
    "text": "These are almost\nlike delta functions. Maybe not quite, but for\nnow, let's pretend they are.",
    "start": "1054967",
    "end": "1060150"
  },
  {
    "text": "If those are a train of\ndelta functions spaced at 10 milliseconds, what is our\nspectrum going to look like?",
    "start": "1060150",
    "end": "1065940"
  },
  {
    "start": "1065940",
    "end": "1073240"
  },
  {
    "text": "I just said it. What is it going to look like?",
    "start": "1073240",
    "end": "1078750"
  },
  {
    "text": "Yep. Spaced by? AUDIENCE: One. MICHALE FEE: Which is? ",
    "start": "1078750",
    "end": "1085560"
  },
  {
    "text": "100 hertz. Good. So here's the spectrum\nof that speech signal. What do you see?",
    "start": "1085560",
    "end": "1093088"
  },
  {
    "text": "You see a train of delta\nfunctions separated",
    "start": "1093088",
    "end": "1099150"
  },
  {
    "text": "by about 100 hertz, right? That's a kilohertz, that's\n500 hertz, that's 100 hertz.",
    "start": "1099150",
    "end": "1106210"
  },
  {
    "text": "So you get a train of\ndelta functions separated by 100 hertz, OK?",
    "start": "1106210",
    "end": "1111820"
  },
  {
    "text": "That's called a harmonic stack. OK. And the spectrum\nof a speech signal",
    "start": "1111820",
    "end": "1118410"
  },
  {
    "text": "has a harmonic stack\nbecause the signal has these short little pulses\nof pressure in them.",
    "start": "1118410",
    "end": "1128540"
  },
  {
    "text": "OK, what are these bumps here? Why is there a bump here, a\nbump here, and a bump here? Does anyone know that?",
    "start": "1128540",
    "end": "1134580"
  },
  {
    "start": "1134580",
    "end": "1141984"
  },
  {
    "text": "What is it that shapes\nthe sound as you speak?",
    "start": "1141984",
    "end": "1147830"
  },
  {
    "text": "That makes an \"ooh\" sound\ndifferent from an \"ahh?\" [INAUDIBLE] This is hello.",
    "start": "1147830",
    "end": "1158180"
  },
  {
    "text": "Sorry, I'm having\ntrouble with my pointer.  That's hello.",
    "start": "1158180",
    "end": "1164735"
  },
  {
    "text": " What is it that makes all\nthings sound different?",
    "start": "1164735",
    "end": "1172864"
  },
  {
    "text": "So the sound, those\npulses, are made down hearing your vocal tract. As those pulses propagate\nup from your glottis",
    "start": "1172864",
    "end": "1181620"
  },
  {
    "text": "to your lips, they [AUDIO OUT]\nfilter, which is your mouth. And that the shape\nof that filter",
    "start": "1181620",
    "end": "1188370"
  },
  {
    "text": "is controlled by the\nclosure of your lips, by where your tongue is, where\ndifferent parts of your tongue",
    "start": "1188370",
    "end": "1198180"
  },
  {
    "text": "are closing the\nopening in your mouth. And all of those things produce\nfilters that have peaks.",
    "start": "1198180",
    "end": "1208820"
  },
  {
    "text": "And the vocal filter\nhas three main peaks that move around as you move\nthe shape of your mouth.",
    "start": "1208820",
    "end": "1215700"
  },
  {
    "text": "And those are\ncalled formants, OK? OK. Now you can see that\nthis temporal structure,",
    "start": "1215700",
    "end": "1223850"
  },
  {
    "text": "this spectral structure\nisn't constant in time. It changes-- right--\nthroughout this word.",
    "start": "1223850",
    "end": "1229440"
  },
  {
    "text": "So what we can do is we\ncan take that signal, and we can compute the spectrum\nof little parts of it, OK?",
    "start": "1229440",
    "end": "1237180"
  },
  {
    "text": "So we can take that signal\nand multiply it by a window here, a taper here, and get\na little sample of the speech",
    "start": "1237180",
    "end": "1246429"
  },
  {
    "text": "signal and calculate\nthe spectrum of it just by Fourier\ntransforming, OK? We can do the same thing.",
    "start": "1246430",
    "end": "1252080"
  },
  {
    "text": "Shift it over a little bit\nand compute the spectrum of that signal, all right? So we're going to take a\nlittle piece of the signal that",
    "start": "1252080",
    "end": "1260210"
  },
  {
    "text": "has width in time, capital T-- OK-- that's the\nwidth of the window.",
    "start": "1260210",
    "end": "1266919"
  },
  {
    "text": "We're going to multiply it by\na taper, compute the spectrum. And we're going to\nshift that window by a smaller amount,\ndelta t, so that you",
    "start": "1266920",
    "end": "1273545"
  },
  {
    "text": "have overlapping windows. Compute the spectrum\nof each one, and then stack all of\nthose up next to each other",
    "start": "1273545",
    "end": "1281111"
  },
  {
    "text": "So now you've got a spectrum\nthat's a function of time and frequency, OK?",
    "start": "1281111",
    "end": "1289640"
  },
  {
    "text": "So each column is the\nspectrum of one little piece",
    "start": "1289640",
    "end": "1294830"
  },
  {
    "text": "of the sound at\none moment in time. Does that make sense? OK.",
    "start": "1294830",
    "end": "1299950"
  },
  {
    "text": "And that's where this\nspectrogram comes from. Here in this\nspectrogram, you can",
    "start": "1299950",
    "end": "1305340"
  },
  {
    "text": "see these horizontal striations\nare the harmonics stack",
    "start": "1305340",
    "end": "1310380"
  },
  {
    "text": "produced by the glottal pulse. This is a really\nkey way that people study the mechanisms of\nsound production and speech,",
    "start": "1310380",
    "end": "1319620"
  },
  {
    "text": "and animals vocalizations,\nand all kinds of signals, more generally, OK?",
    "start": "1319620",
    "end": "1326003"
  },
  {
    "text": "All right, any\nquestions about that? All right. Now what's really cool\nis that you can actually",
    "start": "1326004",
    "end": "1332549"
  },
  {
    "text": "focus on different\nthings in a signal, OK? So for example, if I\ncompute the spectrogram",
    "start": "1332550",
    "end": "1338549"
  },
  {
    "text": "with signals where that little\nwindow that I'm choosing is really long, then I\nhave high frequency--",
    "start": "1338550",
    "end": "1345990"
  },
  {
    "text": "high resolution and\nfrequency, and the spectrogram looks like this. But if I compute\nthe spectrograph",
    "start": "1345990",
    "end": "1353730"
  },
  {
    "text": "with little windows in\ntime that are very short, then my frequency\nresolution is very poor,",
    "start": "1353730",
    "end": "1361630"
  },
  {
    "text": "but the temporal\nresolution is very high. And now you can\nsee the spectrum. You can see these\nvertical striations.",
    "start": "1361630",
    "end": "1368520"
  },
  {
    "text": "Those vertical\nstriations correspond to pulse of the glottal pulse. And we can basically see the\nspectrum of each pulse coming",
    "start": "1368520",
    "end": "1377700"
  },
  {
    "text": "through the vocal tract. Pretty cool, right? So how you compute the\nspectrum depends on",
    "start": "1377700",
    "end": "1385200"
  },
  {
    "text": "whether you're\nactually interested in. If you want to focus\non the glottal pulses,",
    "start": "1385200",
    "end": "1391950"
  },
  {
    "text": "for example, the\npitch of the speech you look with a longtime window. If you want to focus\non the formants,",
    "start": "1391950",
    "end": "1398029"
  },
  {
    "text": "here you can see the\nperformance very nicely, you would use shorttime window. ",
    "start": "1398030",
    "end": "1405210"
  },
  {
    "text": "Any questions? So now I'm going to talk more\nabout the kinds of tapers",
    "start": "1405210",
    "end": "1414950"
  },
  {
    "text": "that you use to get the best\npossible spectral estimate.",
    "start": "1414950",
    "end": "1421690"
  },
  {
    "text": "So a perfect taper, in\na sense would give you perfect temporal resolution.",
    "start": "1421690",
    "end": "1427860"
  },
  {
    "text": " It would give you really\nfine temporal resolution.",
    "start": "1427860",
    "end": "1434559"
  },
  {
    "text": "And it would give you really\nfine frequency resolution, but because there is a\nfundamental limit on the time",
    "start": "1434560",
    "end": "1443050"
  },
  {
    "text": "bandwidth product, you can't\nmeasure frequency infinitely",
    "start": "1443050",
    "end": "1448270"
  },
  {
    "text": "well with an infinitely\nshort sample of a signal. Imagine you have a\nsine wave, and you",
    "start": "1448270",
    "end": "1454420"
  },
  {
    "text": "took like two samples\nof a sine wave. It would be really hard to\nfigure out the frequency,",
    "start": "1454420",
    "end": "1460270"
  },
  {
    "text": "whereas if you have many, many,\nmany samples of a sine wave, you can figure\nout the frequency. So there's a\nfundamental limit there.",
    "start": "1460270",
    "end": "1466870"
  },
  {
    "text": "So there's no such thing\nas a perfect taper. If I want to take a\nsample of my signal",
    "start": "1466870",
    "end": "1472270"
  },
  {
    "text": "in time, if I have a sample\nthat's limited in time,",
    "start": "1472270",
    "end": "1477850"
  },
  {
    "text": "if it goes from one\ntime to another time and a zero outside of\nthat, then in frequency,",
    "start": "1477850",
    "end": "1484830"
  },
  {
    "text": "it's spread out to infinity. And so all we can do\nis choose how it is.",
    "start": "1484830",
    "end": "1491480"
  },
  {
    "text": "We can either have\nthings look worse in time and better in frequency or\nbetter in time and worse",
    "start": "1491480",
    "end": "1497180"
  },
  {
    "text": "in frequency.  So the other problem is\nthat when we taper a signal,",
    "start": "1497180",
    "end": "1504170"
  },
  {
    "text": "we're throwing away\ndata here at the edges. But if you take a square window\nand you keep all the data",
    "start": "1504170",
    "end": "1510860"
  },
  {
    "text": "within that square\nwindow, well, you've got all the data in that window. But as soon as you\ntaper it, you're",
    "start": "1510860",
    "end": "1517520"
  },
  {
    "text": "throwing away\nstuff at the edges. So you taper it\nto make it smooth and improve the spectrum,\nthe spectral estimate,",
    "start": "1517520",
    "end": "1525740"
  },
  {
    "text": "but you're throwing away data. So you can actually\ncompute the optimal taper.",
    "start": "1525740",
    "end": "1533110"
  },
  {
    "text": "Here's how you do that. What we're going to\ndo is we're going to think of this\nas what's called",
    "start": "1533110",
    "end": "1540020"
  },
  {
    "text": "the spectral\nconcentration problem. We're going to\nfind a function W.",
    "start": "1540020",
    "end": "1545750"
  },
  {
    "text": "This is a tapering\nthat is limited in time from some\nminus T/2 to plus T/2.",
    "start": "1545750",
    "end": "1554870"
  },
  {
    "text": "So it's 0 outside of that. It concentrates\nthe maximum amount of energy in it's\nFourier Transform,",
    "start": "1554870",
    "end": "1562309"
  },
  {
    "text": "in its power spectrum within\na window that has widths 2W.",
    "start": "1562310",
    "end": "1568580"
  },
  {
    "text": "So W is this [INAUDIBLE]. Does that makes sense? We're going to find\na function w that",
    "start": "1568580",
    "end": "1575950"
  },
  {
    "text": "concentrates as much energy\nas possible in square window.",
    "start": "1575950",
    "end": "1581139"
  },
  {
    "text": " And of course, that's\ngoing to have the result",
    "start": "1581140",
    "end": "1587700"
  },
  {
    "text": "that the energy\nin the side lobes is going to be as\nsmall as possible.",
    "start": "1587700",
    "end": "1594029"
  },
  {
    "text": "And there are many\ndifferent optimizations you can do in principle. But this particular optimization\nis about getting as much",
    "start": "1594030",
    "end": "1601750"
  },
  {
    "text": "of the power as possible\ninto a central low. Here's this function of time. We simply calculate the\nFourier Transform of W.",
    "start": "1601750",
    "end": "1609850"
  },
  {
    "text": "We call that U of f. And now we just write\ndown a parameter that",
    "start": "1609850",
    "end": "1615770"
  },
  {
    "text": "says how much of that Fourier-- how much of the power in U\nis in the window from minus",
    "start": "1615770",
    "end": "1623750"
  },
  {
    "text": "w to w compared to how\nmuch power there is in U overall, overall frequencies?",
    "start": "1623750",
    "end": "1632480"
  },
  {
    "text": "So if lambda is 1,\nthen all of the power is between minus w and w.",
    "start": "1632480",
    "end": "1639679"
  },
  {
    "text": "Does that make sense? So you can actually solve this\noptimization problem, maximize",
    "start": "1639680",
    "end": "1646560"
  },
  {
    "text": "lambda, and what you find\nis that there's not just one function that gives very good\nconcentration of the power",
    "start": "1646560",
    "end": "1657490"
  },
  {
    "text": "into this band. There's actually a\nfamily of functions. There's actually k\nof these functions,",
    "start": "1657490",
    "end": "1663600"
  },
  {
    "text": "where k is twice the\nbandwidth times the duration",
    "start": "1663600",
    "end": "1668730"
  },
  {
    "text": "of the window minus 1. So there are a\nfamily of k functions called Slepian functions\nfor which lambda",
    "start": "1668730",
    "end": "1674970"
  },
  {
    "text": "is very close to 1.  There are also discrete probate\nspheroid sequence functions,",
    "start": "1674970",
    "end": "1682540"
  },
  {
    "text": "dpss. And that's the command\nthat Matlab uses to find those functions dpss.",
    "start": "1682540",
    "end": "1688970"
  },
  {
    "text": "Here's what they look like. So these are five functions\nthat give lambda close",
    "start": "1688970",
    "end": "1695000"
  },
  {
    "text": "to 1 or for a particular\nbandwidth in a particular time",
    "start": "1695000",
    "end": "1703360"
  },
  {
    "text": "window. The n equals 1 function\nis a single peak. It looks a lot like a Gaussian,\nbut it's not a Gaussian.",
    "start": "1703360",
    "end": "1710190"
  },
  {
    "text": "What's fundamentally different\nbetween this function and a Gaussian? This function goes to 0\noutside that time window,",
    "start": "1710190",
    "end": "1720070"
  },
  {
    "text": "whereas a Gaussian\ngoes on forever. The second slepian\nin this family",
    "start": "1720070",
    "end": "1727290"
  },
  {
    "text": "has a peak, a positive\npeak in the left half, a negative peak in the right.",
    "start": "1727290",
    "end": "1735630"
  },
  {
    "text": "The third one has positive,\nnegative, positive, and then goes to 0.",
    "start": "1735630",
    "end": "1741100"
  },
  {
    "text": "And the higher order functions\njust have more wiggle. They all have the property\nthat they go to 0 at the edges.",
    "start": "1741100",
    "end": "1749289"
  },
  {
    "text": "And the other\ninteresting properties that these functions are all\northogonal to each other.",
    "start": "1749290",
    "end": "1754350"
  },
  {
    "text": "That means if you multiply this\nfunction times that function and integrate, you get 0.",
    "start": "1754350",
    "end": "1761160"
  },
  {
    "text": "Multiply any two of these\nfunctions and integrate over the window\nminus T/2 to plus T/2",
    "start": "1761160",
    "end": "1767980"
  },
  {
    "text": "the integral [INAUDIBLE] What that means is that\nthe spectral estimate you",
    "start": "1767980",
    "end": "1773720"
  },
  {
    "text": "get by windowing your data\nwith each of these functions separately are\nstatistically independent.",
    "start": "1773720",
    "end": "1781280"
  },
  {
    "text": "You actually have multiple\ndifferent estimates of the spectrum from\nthe same little piece of [AUDIO OUT] The\nother cool thing is",
    "start": "1781280",
    "end": "1788269"
  },
  {
    "text": "that remember the problem\nwith windowing our [AUDIO OUT] with one peak like this\nis we were throwing away",
    "start": "1788270",
    "end": "1794899"
  },
  {
    "text": "data at the edges. Well, notice that the higher\norder slepian functions",
    "start": "1794900",
    "end": "1799940"
  },
  {
    "text": "have big peaks at the edges. And so they are actually\nmeasuring the spectrum of the parts of the signal that\nare at the edge of the window.",
    "start": "1799940",
    "end": "1808860"
  },
  {
    "text": "Now notice that those functions\nstart crashing into the edges. So you start getting sharp,\nsharp edges out here,",
    "start": "1808860",
    "end": "1816899"
  },
  {
    "text": "which is why the higher order\nfunctions have worse ripples outside that central lobe.",
    "start": "1816900",
    "end": "1824990"
  },
  {
    "text": "Any questions about that? ",
    "start": "1824990",
    "end": "1830860"
  },
  {
    "text": "It's a lot [AUDIO OUT]\nJust remember that for a given width\nof the window in time",
    "start": "1830860",
    "end": "1837390"
  },
  {
    "text": "and within frequency, there\nare multiple of these functions that put the maximum amount\nof power in this window 2W.",
    "start": "1837390",
    "end": "1847350"
  },
  {
    "start": "1847350",
    "end": "1854309"
  },
  {
    "text": "So that's great. So good question. What would you do if you're\ntrying to measure something",
    "start": "1854310",
    "end": "1860260"
  },
  {
    "text": "and you measure it\nfive different times, how would you get an estimate\nof what the actual number is?",
    "start": "1860260",
    "end": "1865410"
  },
  {
    "text": " How would you get an error bar\non how good your estimate is?",
    "start": "1865410",
    "end": "1872740"
  },
  {
    "text": " For deviation of your\nestimates, right.",
    "start": "1872740",
    "end": "1879960"
  },
  {
    "text": "And that's exactly what you do. So not only can you\nget a good estimate of the average spectrum by\naveraging all of these things",
    "start": "1879960",
    "end": "1887549"
  },
  {
    "text": "together, but you can\nactually get an error bar. And that's really cool. ",
    "start": "1887550",
    "end": "1894740"
  },
  {
    "text": "So here's the\nprocedure that you use. And this is what's in that\nlittle function W spec.m.",
    "start": "1894740",
    "end": "1901700"
  },
  {
    "text": " So you select a time window\nof a particular width.",
    "start": "1901700",
    "end": "1908220"
  },
  {
    "text": "How do you know\nwhat with to choose? ",
    "start": "1908220",
    "end": "1915630"
  },
  {
    "text": "That's part of it. The other thing is if your\nsignal is changing rapidly in time and you actually\ncare about that change,",
    "start": "1915630",
    "end": "1922050"
  },
  {
    "text": "you should choose-- you're more interested\nin temporal resolution. If your signal is\nreally constant,",
    "start": "1922050",
    "end": "1927740"
  },
  {
    "text": "like it doesn't\nchange very fast, then you can use bigger windows. ",
    "start": "1927740",
    "end": "1933210"
  },
  {
    "text": "So we're going to\nchoose a time width. Then what you're\ngoing to do is you're going to select this\nparameter p, which is just",
    "start": "1933210",
    "end": "1939630"
  },
  {
    "text": "the time-bandwidth product\nAnd if you've already chosen T, what you're doing\nis you're just choosing",
    "start": "1939630",
    "end": "1945870"
  },
  {
    "text": "the frequency resolution.  Once you compute\np and you know T,",
    "start": "1945870",
    "end": "1955090"
  },
  {
    "text": "you just stuff those numbers\ninto this Matlab function dpss, which sends back to you\nthis set of functions here.",
    "start": "1955090",
    "end": "1966279"
  },
  {
    "text": "It sends you back k of those\nfunctions that once you've chosen p, k is just 2p minus 1.",
    "start": "1966280",
    "end": "1974130"
  },
  {
    "text": "And then what do you do? You just take your\nlittle snippet of data. You multiply it by the first\ntaper, compute the spectrum,",
    "start": "1974130",
    "end": "1981520"
  },
  {
    "text": "compute the Fourier Transform. And then take your\nlittle piece of data,",
    "start": "1981520",
    "end": "1987460"
  },
  {
    "text": "multiply it by the second one,\ncompute the Fourier transform, and the power spectrum. And then you're just\ngoing to average.",
    "start": "1987460",
    "end": "1995519"
  },
  {
    "text": "This square magnitude\nshould be inside the window,",
    "start": "1995520",
    "end": "2001190"
  },
  {
    "text": "your piece of data. You Fourier transform it, square\nmagnitude, and then average all those spectra together.",
    "start": "2001190",
    "end": "2008720"
  },
  {
    "text": "I see this is Fourier\ntransform right here. This sum is the\nFourier transform that. We square magnitude that to\nget the spectral estimate",
    "start": "2008720",
    "end": "2015830"
  },
  {
    "text": "of that particular sample. Then we're going to average\nthat spectrum together",
    "start": "2015830",
    "end": "2020840"
  },
  {
    "text": "for all the different\nwindowing tapering function.",
    "start": "2020840",
    "end": "2026330"
  },
  {
    "text": "Now you get then multiple\nspectral estimates. You're going to average them\ntogether to get the mean.",
    "start": "2026330",
    "end": "2032960"
  },
  {
    "text": "And you can also\nlook at the variance to get the standard deviation. ",
    "start": "2032960",
    "end": "2044159"
  },
  {
    "text": "Questions? Let's stop there. That was that was\na lot of stuff. Let's take a breath and\n[INAUDIBLE] to see whether we",
    "start": "2044160",
    "end": "2054230"
  },
  {
    "text": "[AUDIO OUT] Questions?",
    "start": "2054230",
    "end": "2060086"
  },
  {
    "start": "2060086",
    "end": "2067394"
  },
  {
    "text": "No. ",
    "start": "2067394",
    "end": "2074560"
  },
  {
    "text": "Don't worry about it. This is representation\nof the Fourier transform.",
    "start": "2074560",
    "end": "2080669"
  },
  {
    "text": "You sum over all\nthe time samples. This, you will just do as\nfast Fourier transform.",
    "start": "2080670",
    "end": "2088260"
  },
  {
    "text": "So you'll take the\ndata, multiply it by this taper function,\nwhich is the slepian",
    "start": "2088260",
    "end": "2098150"
  },
  {
    "text": "and then do the\nFourier transform, take the square magnitude. We just want make sure that\nwe've got the basic idea.",
    "start": "2098150",
    "end": "2106010"
  },
  {
    "text": "So you've got a\nlong piece of data. You're going to lose some\ntime window, capital T. You're",
    "start": "2106010",
    "end": "2117390"
  },
  {
    "text": "going to choose a bandwidth W or\nthis time bandwidth product p.",
    "start": "2117390",
    "end": "2124940"
  },
  {
    "text": "Bend T and p to\nthis dpss function. It will send you back a bunch\nof these dpss functions that",
    "start": "2124940",
    "end": "2134410"
  },
  {
    "text": "fit in that window. Now you're going to\ntake your piece of data. You're going to break it into\nlittle windows of that length,",
    "start": "2134410",
    "end": "2140440"
  },
  {
    "text": "multiply them by each one\nof the slepian functions Do the Fourier transform of\neach one of those products.",
    "start": "2140440",
    "end": "2147570"
  },
  {
    "text": "Average them all altogether. Take the square magnitude of\neach one to get the spectrum, and then average all\nthose spectra together.",
    "start": "2147570",
    "end": "2155410"
  },
  {
    "text": "So now so what does\np do? p chooses",
    "start": "2155410",
    "end": "2160880"
  },
  {
    "text": "bandwidth of the slepian\nfunction in that window.",
    "start": "2160880",
    "end": "2166630"
  },
  {
    "text": "So if you have a window\nthat's 100 milliseconds wide-- so we're going to take\nour data and break it",
    "start": "2166630",
    "end": "2174280"
  },
  {
    "text": "into little pieces\nthat's milliseconds long. It's goes from minus 50\nto plus 50 milliseconds.",
    "start": "2174280",
    "end": "2181580"
  },
  {
    "text": "Choose a window that\nhas a narrow bandwidth,",
    "start": "2181580",
    "end": "2188290"
  },
  {
    "text": "the small p, then the\nbandwidth is narrow. The bandwidth is narrow,\nbecause the function is wide,",
    "start": "2188290",
    "end": "2195200"
  },
  {
    "text": "or you can choose\na large bandwidth. What does that mean? It's a narrower\nfunction in time.",
    "start": "2195200",
    "end": "2202560"
  },
  {
    "text": "Now if p is 5, you have\na broader bandwidth. And that means that the\nwindow, the tapering function",
    "start": "2202560",
    "end": "2209339"
  },
  {
    "text": "is narrower in time. Look at the Fourier\ntransform of each of two",
    "start": "2209340",
    "end": "2215990"
  },
  {
    "text": "different tapering functions. You can see that\nif p equals 1.5, the tapering function is broad.",
    "start": "2215990",
    "end": "2223250"
  },
  {
    "text": "But that Fourier transform,\na kernel in frequency space",
    "start": "2223250",
    "end": "2231370"
  },
  {
    "text": "is narrower. Take the p equals 5 function,\na broader bandwidth,",
    "start": "2231370",
    "end": "2238330"
  },
  {
    "text": "it's narrower in time\nand broader in frequency. Does that makes sense?",
    "start": "2238330",
    "end": "2245650"
  },
  {
    "text": "p just for a given\nsize time window tells you how many\ndifferent samples",
    "start": "2245650",
    "end": "2254610"
  },
  {
    "text": "we're going to take\nwithin that time window. ",
    "start": "2254610",
    "end": "2259780"
  },
  {
    "text": "no So let me just go back to\nthis example right here.",
    "start": "2259780",
    "end": "2264950"
  },
  {
    "text": "So I took this speech signal\nthat I just showed you that was recorded\non the microphone.",
    "start": "2264950",
    "end": "2270500"
  },
  {
    "text": "I chose a time window\nof 50 milliseconds. So I broke the\nspeech signal down into little 50\nmillisecond chunks.",
    "start": "2270500",
    "end": "2277280"
  },
  {
    "text": "I chose a bandwidth of 60 hertz. That corresponds to p\nequals 1.5 and k equals 2.",
    "start": "2277280",
    "end": "2286430"
  },
  {
    "text": "That gives me back a bunch\nof these little functions. And I computed this spectragram.",
    "start": "2286430",
    "end": "2292090"
  },
  {
    "text": "For this spectragram, I chose\na shorter time window, eight milliseconds, choose a\nbandwidth of 375 hertz, which",
    "start": "2292090",
    "end": "2301130"
  },
  {
    "text": "also corresponds to p\nequals 1.5 and k equals 2. And if you Fourier\ntransform the spectragram",
    "start": "2301130",
    "end": "2309130"
  },
  {
    "text": "with those parameters, you\nget this example right here. So in this case,\nI kept the same p,",
    "start": "2309130",
    "end": "2316839"
  },
  {
    "text": "the same time-bandwidth product,\nbut I made the time shorter.",
    "start": "2316840",
    "end": "2323190"
  },
  {
    "text": "So the best way to do this,\nwhen you're actually doing this, practically is just\nto take a signal by some of these different\nthings [INAUDIBLE]",
    "start": "2323190",
    "end": "2331040"
  },
  {
    "text": "That's really the\nbest way to do it. You can't-- I don't recommend\ntrying to think through",
    "start": "2331040",
    "end": "2338900"
  },
  {
    "text": "beforehand too much exactly what\nit's going to look like if you choose these different values\nwhen it's easier just to try",
    "start": "2338900",
    "end": "2344960"
  },
  {
    "text": "different things and\nsee what it looks like.  Yes. AUDIENCE: What are looking for?",
    "start": "2344960",
    "end": "2354020"
  },
  {
    "text": "MICHALE FEE: Well, it\ndepends on what you're trying to get out of the data. If you want to\nvisualize formants,",
    "start": "2354020",
    "end": "2361130"
  },
  {
    "text": "you can see that the\nformants are much clearer. These different windows give you\na different view on the data.",
    "start": "2361130",
    "end": "2369440"
  },
  {
    "text": "So just look through\ndifferent windows and see what looks\ninteresting in the results.",
    "start": "2369440",
    "end": "2374492"
  },
  {
    "text": "That's the best way to do it. ",
    "start": "2374492",
    "end": "2381210"
  },
  {
    "text": "So I just want to\nsay one more word about this\ntime-bandwidth product.",
    "start": "2381210",
    "end": "2388180"
  },
  {
    "text": "So the time-bandwidth product of\nany function is greater than 1.",
    "start": "2388180",
    "end": "2395319"
  },
  {
    "text": "So you can make time shorter,\nbut bandwidth is worse. The way that you\ncan think about this",
    "start": "2395320",
    "end": "2401960"
  },
  {
    "text": "as that you're sort of\nlooking at your data through a window in\ntime and frequency.",
    "start": "2401960",
    "end": "2412550"
  },
  {
    "text": "What you want is to look with\ninfinitely fine resolution in both time and\nfrequency, but really you",
    "start": "2412550",
    "end": "2419539"
  },
  {
    "text": "can't have infinite time\nand frequency resolution. You're going to be smearing\nyour view of the data",
    "start": "2419540",
    "end": "2428540"
  },
  {
    "text": "with something that\nhas a minimum area, the time-bandwidth product which\nhas a minimum of size of 1.",
    "start": "2428540",
    "end": "2437299"
  },
  {
    "text": " You can either make time small\nand stretch the bandwidth out,",
    "start": "2437300",
    "end": "2445740"
  },
  {
    "text": "or you can stretch out time\nand make the bandwidth shorter or make time short and\nmake the bandwidth long.",
    "start": "2445740",
    "end": "2452730"
  },
  {
    "text": "But you can't squeeze\nboth, because of this fundamental limit on\nthe time bandwidth product.",
    "start": "2452730",
    "end": "2460410"
  },
  {
    "text": "This all depends on\nhow you're measuring the time and the bandwidth. These are kind of\nfunny shaped functions.",
    "start": "2460410",
    "end": "2466619"
  },
  {
    "text": "So there are different\nways of measure what the bandwidth\nof a signal is or what the time\nwidth of a signal is.",
    "start": "2466620",
    "end": "2474299"
  },
  {
    "text": "Now, the windows that you're\nlooking in time and frequency with are the smallest\ntime bandwidth product.",
    "start": "2474300",
    "end": "2483340"
  },
  {
    "text": "So notice that if the\ntime-bandwidth product is small, close to 1,\nthe number of tapers",
    "start": "2483340",
    "end": "2490540"
  },
  {
    "text": "you get in this dpss, this\nfamily of functions you get is just 1.",
    "start": "2490540",
    "end": "2496190"
  },
  {
    "text": "If p is 1, then k is\n2P minus 1, which is 1. So you only get one window.",
    "start": "2496190",
    "end": "2503350"
  },
  {
    "text": "You only get one\nestimate of the spectrum, but you can also choose\nto look at your data",
    "start": "2503350",
    "end": "2511760"
  },
  {
    "text": "with worse, [AUDIO OUT] that\nhave a worse time frequency",
    "start": "2511760",
    "end": "2519170"
  },
  {
    "text": "time-bandwidth product. Why would you do that? Why would you ever\nlook at your data",
    "start": "2519170",
    "end": "2524270"
  },
  {
    "text": "with functions that have a\nworse time-bandwidth product? ",
    "start": "2524270",
    "end": "2531850"
  },
  {
    "text": "Well, notice that if the\ntime-bandwidth product is 2,",
    "start": "2531850",
    "end": "2537160"
  },
  {
    "text": "how many functions do you have? Why does that matter,\nbecause now you",
    "start": "2537160",
    "end": "2543030"
  },
  {
    "text": "have three independent estimates\nof what that spectrum is. ",
    "start": "2543030",
    "end": "2550320"
  },
  {
    "text": "So sometimes you\nwould gladly choose to have a worse resolution\nin time and frequency,",
    "start": "2550320",
    "end": "2557910"
  },
  {
    "text": "because you've got more\nindependent estimates means better. So sometimes your signal\nmight be changing very slowly.",
    "start": "2557910",
    "end": "2564090"
  },
  {
    "text": "And then you can use a big\ntime-bandwidth product. It doesn't matter.",
    "start": "2564090",
    "end": "2569780"
  },
  {
    "text": "Sometimes your signal is\nchanging very rapidly in time. And so you want to keep the\ntime-bandwidth product small.",
    "start": "2569780",
    "end": "2577680"
  },
  {
    "text": "Does that begin to [INAUDIBLE]\nbigger time-bandwidth products",
    "start": "2577680",
    "end": "2583490"
  },
  {
    "text": "and now you get even more\nindependent estimates. Most typically, you choose p's\nthat go from 1.5 to multiples",
    "start": "2583490",
    "end": "2595320"
  },
  {
    "text": "of 0.5, because then you have\nan integer number of k's. ",
    "start": "2595320",
    "end": "2602361"
  },
  {
    "text": "But usually, you choose\np equals 1.5 or higher in multiples of 0.5.",
    "start": "2602362",
    "end": "2609210"
  },
  {
    "text": "If you really care about\ntemporal resolution and frequency resolution,\nyou want that box",
    "start": "2609210",
    "end": "2616490"
  },
  {
    "text": "that's smearing\nout your spectrum to be as small as possible. Small as possible means\nit has an area of 1.",
    "start": "2616490",
    "end": "2624680"
  },
  {
    "text": "That's the minimum\narea it can have, but that only gives\nyou one taper.",
    "start": "2624680",
    "end": "2631720"
  },
  {
    "text": "But if you really care about\nboth temporal and frequency-- time and frequency\nresolution, then that's",
    "start": "2631720",
    "end": "2638498"
  },
  {
    "text": "the trade-off you have to make.  Slowly you can air out more in\ntime, maybe more in frequency,",
    "start": "2638498",
    "end": "2647890"
  },
  {
    "text": "and you can choose your\ntime-bandwidth product, in which case you get\nmore tapers and a better",
    "start": "2647890",
    "end": "2653218"
  },
  {
    "text": "estimate of the spectrum. ",
    "start": "2653218",
    "end": "2661970"
  },
  {
    "text": "So this is state of the\nart spectral estimation.",
    "start": "2661970",
    "end": "2667599"
  },
  {
    "text": "It doesn't get better than this. To put it like this, you're\ndoing it the best possible way,",
    "start": "2667600",
    "end": "2677690"
  },
  {
    "text": "a bit of digesting. ",
    "start": "2677690",
    "end": "2689809"
  },
  {
    "text": "So lets spend the\nrest of the lecture today talking about filtering.",
    "start": "2689810",
    "end": "2696260"
  },
  {
    "text": "So Matlab has a bunch of really\npowerful filtering tools. ",
    "start": "2696260",
    "end": "2701610"
  },
  {
    "text": "So here's an example\nof the kind of thing where we use filtering. So this is a [INAUDIBLE] finch\nsong recorded in the lab.",
    "start": "2701610",
    "end": "2709770"
  },
  {
    "start": "2709770",
    "end": "2720704"
  },
  {
    "text": "OK, so now I want\nyou to just listen-- so you were probably\nlistening to the song, but now listen at\nvery low frequencies.",
    "start": "2720704",
    "end": "2727690"
  },
  {
    "text": " Tell me what you hear. Listen at very low frequen--",
    "start": "2727690",
    "end": "2733490"
  },
  {
    "text": " [AUDIO PLAYBACK] [FINCH CHIRPING]",
    "start": "2733490",
    "end": "2739664"
  },
  {
    "text": "[END PLAYBACK] [HUMS]  --background, that's hum\nfrom the building's air",
    "start": "2739665",
    "end": "2746099"
  },
  {
    "text": "conditioners, air handling. It all makes this low rumbling,\nwhich adds a lot of noise",
    "start": "2746100",
    "end": "2758690"
  },
  {
    "text": "to the signal that can\nmake it hard to see where the syllables are in\nthe [AUDIO OUT] time series.",
    "start": "2758690",
    "end": "2766486"
  },
  {
    "text": "Here are the\nsyllables right here. And that's the background noise. But the background noise\nis at very low frequencies.",
    "start": "2766486",
    "end": "2773170"
  },
  {
    "text": "So sometimes you want to\njust filter stuff like that away because we don't care\nabout the air conditioner.",
    "start": "2773170",
    "end": "2779670"
  },
  {
    "text": "We care about the bird's song. OK, so we can get rid of that by\napplying-- what kind of filter",
    "start": "2779670",
    "end": "2785940"
  },
  {
    "text": "would we apply to\nthis signal to get rid of these low frequencies?",
    "start": "2785940",
    "end": "2791968"
  },
  {
    "text": "[INAUDIBLE] AUDIENCE: A high pass. MICHALE FEE: A high-pass\nfilter, very good. OK, so let's put a high\npass filter on this.",
    "start": "2791968",
    "end": "2798109"
  },
  {
    "text": "Now, in the past,\npreviously we've talked about using convolution\nto carry out a high pass",
    "start": "2798110",
    "end": "2804560"
  },
  {
    "text": "filtering function. But Matlab has all these\nvery powerful tools. So I wanted to show you\nwhat those look like",
    "start": "2804560",
    "end": "2810410"
  },
  {
    "text": "and how to use them. OK, so this is a\nlittle piece of code that implements a high-pass\nfilter on that signal.",
    "start": "2810410",
    "end": "2818069"
  },
  {
    "text": "Now, you can see that all\nof that low frequency stuff is [AUDIO OUT] You have a\nnice clean, silent background.",
    "start": "2818070",
    "end": "2824630"
  },
  {
    "text": "And now you can\nsee the syllables on top of that background. Here's the spectrogram. You can see that all of that\nlow frequency stuff is gone.",
    "start": "2824630",
    "end": "2832160"
  },
  {
    "text": "And this is a little\nbit of sample code here. I just want to point\nout a few things.",
    "start": "2832160",
    "end": "2838970"
  },
  {
    "text": "You give it the Nyquist\nfrequency, which is just the sampling rate divided by 2. I'll explain later\nwhat that means.",
    "start": "2838970",
    "end": "2845990"
  },
  {
    "text": "You set a cutoff frequency. So you tell it to cut\noff below 500 hertz.",
    "start": "2845990",
    "end": "2855660"
  },
  {
    "text": "You put the cutoff and\nNyquest frequency together, you get a ratio of\nthose two that's",
    "start": "2855660",
    "end": "2862300"
  },
  {
    "text": "basically the fraction\nof the spectral width that you're going to cut off. And then you tell it to\ngive you the parameters",
    "start": "2862300",
    "end": "2870880"
  },
  {
    "text": "for a Butterworth filter. It's just one of the kinds\nof filters that you use. Tell it whether it's a\nhigh-pass or low-pass.",
    "start": "2870880",
    "end": "2879190"
  },
  {
    "text": "Send that filter, those filter\nparameters, to this function",
    "start": "2879190",
    "end": "2884200"
  },
  {
    "text": "called filtfilt. You give it\nthese two parameters, B and A, and your data vector.",
    "start": "2884200",
    "end": "2891340"
  },
  {
    "text": "And when run that, that's what\nthe result looks like, OK? Let me play that again\nfor you after filtering.",
    "start": "2891340",
    "end": "2897924"
  },
  {
    "start": "2897924",
    "end": "2908310"
  },
  {
    "text": "All that low\nfrequency hum is gone. All right, so here's\nan example of what--",
    "start": "2908310",
    "end": "2917790"
  },
  {
    "text": "I mean, we would never\nactually do this in the lab. But this is what it would look\nlike if you wanted to emphasize",
    "start": "2917790",
    "end": "2923160"
  },
  {
    "text": "that low frequency stuff. Let's say that you're the air\nconditioner technician who",
    "start": "2923160",
    "end": "2928740"
  },
  {
    "text": "comes and wants to\nfigure out what's wrong with the air conditioner. And it turns out that the way\nit sounds really is helpful.",
    "start": "2928740",
    "end": "2934290"
  },
  {
    "text": "So you now do a low-pass filter. And you're going to keep\nthe low frequency part.",
    "start": "2934290",
    "end": "2939569"
  },
  {
    "text": "Because all those annoying\nbirds are making it hard for you to hear what's wrong\nwith the air conditioner.",
    "start": "2939570",
    "end": "2945310"
  },
  {
    "text": "OK, so here's-- ",
    "start": "2945310",
    "end": "2955991"
  },
  {
    "text": "Didn't quite get\nrid of the birds. But now you can hear the low\nfrequency stuff much better.",
    "start": "2955991",
    "end": "2961900"
  },
  {
    "text": "OK, all right, so now we\njust did that by, again, giving it the Nyquist.",
    "start": "2961900",
    "end": "2967290"
  },
  {
    "text": "The cutoff, we're going\nto cut off above 2,000, pass below 2,000.",
    "start": "2967290",
    "end": "2973210"
  },
  {
    "text": "We're going to tell it to\nuse a Butterworth filter, now low-pass.",
    "start": "2973210",
    "end": "2978610"
  },
  {
    "text": "And again, we just pass it\nthe parameters and the data. And it sends us back\nthe filtered data.",
    "start": "2978610",
    "end": "2983800"
  },
  {
    "text": " OK, you can also do a band-pass.",
    "start": "2983800",
    "end": "2991450"
  },
  {
    "text": "OK, so a band-pass does a\nhigh-pass and a low-pass",
    "start": "2991450",
    "end": "2996480"
  },
  {
    "text": "together. Now you're filtering out\neverything above some number and below some number.",
    "start": "2996480",
    "end": "3002180"
  },
  {
    "text": "And here we give it a\ncutoff with two numbers. So it's going to\ncut off everything below 4 kilohertz and\neverything above 5 kilohertz.",
    "start": "3002180",
    "end": "3011030"
  },
  {
    "text": "Again, we use the\nButterworth filter. You leave off the tag to\nget a band-pass filter.",
    "start": "3011030",
    "end": "3018234"
  },
  {
    "text": "And here's what\nthat sounds like. ",
    "start": "3018235",
    "end": "3024787"
  },
  {
    "text": "[AUDIO PLAYBACK] [BIRDS CHIRPING]",
    "start": "3024787",
    "end": "3032272"
  },
  {
    "text": "[END PLAYBACK] And thats a band-pass filter. Questions?",
    "start": "3032272",
    "end": "3038090"
  },
  {
    "start": "3038090",
    "end": "3047990"
  },
  {
    "text": "Yeah, so there are\nmany different ways to do this kind of filtering.",
    "start": "3047990",
    "end": "3053240"
  },
  {
    "text": "Daniel, do you know how filtfilt\nactually implements this? Because Matlab has a bunch of\ndifferent filtering functions.",
    "start": "3053240",
    "end": "3060350"
  },
  {
    "text": "And this is just one of them. [INAUDIBLE] how it's actually\nimplemented [AUDIO OUT]",
    "start": "3060350",
    "end": "3069200"
  },
  {
    "text": "Right, so there's\na filt function, which actually does a\nconvolution in one direction.",
    "start": "3069200",
    "end": "3074750"
  },
  {
    "text": "And filtfilt does the\nconvolution one direction and then the other direction.",
    "start": "3074750",
    "end": "3080500"
  },
  {
    "text": "And what that does\nit [AUDIO OUT] output center with respect to\nthe input, centered [AUDIO OUT]",
    "start": "3080500",
    "end": "3087140"
  },
  {
    "text": "Anyway, there are\ndifferent ways of doing it. And the nice thing about--",
    "start": "3087140",
    "end": "3092780"
  },
  {
    "text": "yeah? AUDIENCE: [INAUDIBLE]",
    "start": "3092780",
    "end": "3099468"
  },
  {
    "text": "MICHALE FEE: Well,\nfor the bird data, it doesn't necessarily\nmake all that much sense,",
    "start": "3099468",
    "end": "3106838"
  },
  {
    "text": "right, on the face of it? But there are\napplications where there's some signal at that\nparticular band.",
    "start": "3106838",
    "end": "3112400"
  },
  {
    "text": "So for example, let's say\nyou had a speech signal and you wanted to find out\nwhen the formants cross",
    "start": "3112400",
    "end": "3117500"
  },
  {
    "text": "a certain frequency. Let's say you wanted to find\nout if somebody could learn",
    "start": "3117500",
    "end": "3123990"
  },
  {
    "text": "to speak [AUDIO OUT] if you\nblocked one of their formants",
    "start": "3123990",
    "end": "3129700"
  },
  {
    "text": "whenever it comes through\na particular frequency. OK, so let's say I\nhave my second formant",
    "start": "3129700",
    "end": "3135070"
  },
  {
    "text": "and every time it\ncrosses 2 kilohertz I play a burst of noise. And I ask, can I\nunderstand if I've knocked",
    "start": "3135070",
    "end": "3141850"
  },
  {
    "text": "out that particular formant? I don't know why\nyou'd want to do that. But maybe it's fun, right?",
    "start": "3141850",
    "end": "3147880"
  },
  {
    "text": "So I don't know, it\nmight be kind of cool. So then you would run a\nband-pass filter right over 2-kilohertz band.",
    "start": "3147880",
    "end": "3154240"
  },
  {
    "text": "And now, you'd get a big signal\nwhenever that formant passed through that band, right? And then you would send\nthat to an amplifier",
    "start": "3154240",
    "end": "3160870"
  },
  {
    "text": "and play a noise burst\ninto the person's ear. All right, we do things\nlike that with birds",
    "start": "3160870",
    "end": "3167390"
  },
  {
    "text": "to find out if they can learn\nto shift the pitch of their song in response to errors.",
    "start": "3167390",
    "end": "3173510"
  },
  {
    "text": "OK, so yes, they can. Yes-- AUDIENCE: [INAUDIBLE]",
    "start": "3173510",
    "end": "3180319"
  },
  {
    "text": "MICHALE FEE: Formants\nare the peaks in the filter that's\nformed by your vocal tract",
    "start": "3180320",
    "end": "3185780"
  },
  {
    "text": "by the [AUDIO OUT] air channel\nfrom your glottis to your lips.",
    "start": "3185780",
    "end": "3191720"
  },
  {
    "start": "3191720",
    "end": "3197090"
  },
  {
    "text": "The location of those peaks\nchanges [INAUDIBLE] So ahh,",
    "start": "3197090",
    "end": "3204190"
  },
  {
    "text": "ooh, the difference\nbetween those is just the location\nof those formant peaks.",
    "start": "3204190",
    "end": "3210880"
  },
  {
    "text": "All those things just have\nformants at different location. AUDIENCE: [INAUDIBLE]",
    "start": "3210880",
    "end": "3226342"
  },
  {
    "text": "MICHALE FEE: So explain\na little bit more what you mean by analog interference.",
    "start": "3226342",
    "end": "3232230"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] MICHALE FEE: Oh,\nOK, like 60 hertz.",
    "start": "3232230",
    "end": "3238540"
  },
  {
    "text": "OK, so that's a great question. So let's say that you're\ndoing an experiment. And you [AUDIO OUT]\ncontamination",
    "start": "3238540",
    "end": "3245460"
  },
  {
    "text": "of your signal by 60 hertz\nnoise from the outlet. OK, it's really better to\nspend the time to figure out",
    "start": "3245460",
    "end": "3253349"
  },
  {
    "text": "how to get rid of that noise. But let's say that you\n[INAUDIBLE] advisor your data",
    "start": "3253350",
    "end": "3261500"
  },
  {
    "text": "[AUDIO OUT] quite figured out\nhow to get rid of the 60 hertz yet [AUDIO OUT] How would you\nget rid of the 60 hertz from",
    "start": "3261500",
    "end": "3269070"
  },
  {
    "text": "your signal? You could make what's called\na band-stop filter where",
    "start": "3269070",
    "end": "3275380"
  },
  {
    "text": "you suppress frequencies\nwithin a particular band.",
    "start": "3275380",
    "end": "3280799"
  },
  {
    "text": "Put that band-stop\nfilter at 60 hertz. The thing is, it's\nvery hard to make",
    "start": "3280800",
    "end": "3285870"
  },
  {
    "text": "a very narrow band-stop filter. So we learned this\nin the last lecture. How would you get rid of a\nparticular [AUDIO OUT] Yeah,",
    "start": "3285870",
    "end": "3300440"
  },
  {
    "text": "so take the Fourier\ntransform of your signal, that 60 hertz [AUDIO OUT] one\nparticular value of the Fourier",
    "start": "3300440",
    "end": "3307559"
  },
  {
    "text": "transform. And you can just\nset that [AUDIO OUT]",
    "start": "3307560",
    "end": "3314588"
  },
  {
    "text": "Because the filtering\nin that case would be knocking\ndown a whole band",
    "start": "3314588",
    "end": "3320930"
  },
  {
    "text": "of [AUDIO OUT] frequencies.",
    "start": "3320930",
    "end": "3326040"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]",
    "start": "3326040",
    "end": "3332322"
  },
  {
    "text": "MICHALE FEE: Well, it's\njust that with filtfilt, like I said, there are many\ndifferent ways of doing things.",
    "start": "3332322",
    "end": "3339630"
  },
  {
    "text": "filtfilt won't do that for you. But once you know this stuff\nthat we've been learning,",
    "start": "3339630",
    "end": "3346980"
  },
  {
    "text": "you can go in and do stuff. You don't have to have some\nMatlab function to do it. You just know how it\nall works and you just",
    "start": "3346980",
    "end": "3354060"
  },
  {
    "text": "write a program to do it. OK, that's pretty cool, right? All right-- oh, and here's\nthe band-stop filter.",
    "start": "3354060",
    "end": "3361059"
  },
  {
    "text": " [INAUDIBLE] that\nlag there stop, OK?",
    "start": "3361060",
    "end": "3372270"
  },
  {
    "text": "OK, let's keep going. Oh, and there's a tool\nhere that's part of Matlab. It's called a filter\nvisualization tool, FV tool.",
    "start": "3372270",
    "end": "3380820"
  },
  {
    "text": "You just run this and you\ncan select different kinds of filters that have\ndifferent kinds of roll-off",
    "start": "3380820",
    "end": "3389820"
  },
  {
    "text": "in frequency, that have\ndifferent properties in the time domain. It's kind of fun to play with.",
    "start": "3389820",
    "end": "3395310"
  },
  {
    "text": "If you have to do\nfiltering on some signal, just play around with this. Because there are a bunch of\ndifferent kind of filters that",
    "start": "3395310",
    "end": "3401910"
  },
  {
    "text": "have different weird names\nlike Butterworth and Chebyshev",
    "start": "3401910",
    "end": "3407130"
  },
  {
    "text": "and a bunch of other things\nthat have different properties. But you can actually just\nplay around with this",
    "start": "3407130",
    "end": "3412970"
  },
  {
    "text": "and design your own filter\nto meet your own [AUDIO OUT] OK, so I want to end by spending\na little bit of time talking",
    "start": "3412970",
    "end": "3420930"
  },
  {
    "text": "about some really cool things\nabout the Fourier transform and talk about the\nNyquist Shannon theorem.",
    "start": "3420930",
    "end": "3426780"
  },
  {
    "text": "This is really kind\nof mind boggling. It's pretty cool. So all right, so remember\nthat when you take the Fourier",
    "start": "3426780",
    "end": "3435120"
  },
  {
    "text": "transform-- the fast Fourier\ntransform of something-- [INAUDIBLE] take the\nFourier transform",
    "start": "3435120",
    "end": "3440390"
  },
  {
    "text": "of something analytically,\nthe Fourier transform",
    "start": "3440390",
    "end": "3445400"
  },
  {
    "text": "is defined continuously. At every value of F,\nthere's a Fourier transform.",
    "start": "3445400",
    "end": "3453980"
  },
  {
    "text": "But when we do fast\nFourier transforms, we've discretized time and we've\ndiscretized frequency, right?",
    "start": "3453980",
    "end": "3461360"
  },
  {
    "text": "So when we take the\nfast Fourier transform, we get answer back where we\nhave a value of the Fourier",
    "start": "3461360",
    "end": "3468130"
  },
  {
    "text": "transform at a bunch of\ndiscrete frequencies. So frequency is discretized.",
    "start": "3468130",
    "end": "3473450"
  },
  {
    "text": "And we have frequencies,\nlittle samples of the spectrum at\ndifferent frequencies, that are separated\nby a little delta f.",
    "start": "3473450",
    "end": "3480747"
  },
  {
    "text": "[INAUDIBLE] What does that mean?",
    "start": "3480747",
    "end": "3486760"
  },
  {
    "text": "Remember when we were\ndoing a Fourier series?",
    "start": "3486760",
    "end": "3492490"
  },
  {
    "text": "What was it that we had to have\nto write down a Fourier series",
    "start": "3492490",
    "end": "3498220"
  },
  {
    "text": "where we can write\ndown an approximation to a function as a sum of\nsine waves and multiples",
    "start": "3498220",
    "end": "3505690"
  },
  {
    "text": "of a common frequency? What was it about\nthe signal in time",
    "start": "3505690",
    "end": "3510984"
  },
  {
    "text": "that allowed us to do that? ",
    "start": "3510985",
    "end": "3520660"
  },
  {
    "text": "It's periodic. We could only do that if\nthe signal is periodic. So when we write down our fast\nFourier transform of a signal,",
    "start": "3520660",
    "end": "3532700"
  },
  {
    "text": "it's discretized in\ntime and frequency. What that means is that\nit's periodic in time.",
    "start": "3532700",
    "end": "3540309"
  },
  {
    "text": "So when we pass a signal that\nwe've sampled of some duration",
    "start": "3540310",
    "end": "3546360"
  },
  {
    "text": "and the fast Fourier transform\nalgorithm passes back a spectrum that's discreted in\nfrequency, what that means is",
    "start": "3546360",
    "end": "3553410"
  },
  {
    "text": "that you can think\nabout that signal as being periodic in time, OK?",
    "start": "3553410",
    "end": "3559280"
  },
  {
    "text": "Now, when you discretize\nthe signal in time, you've taken samples\nof that signal",
    "start": "3559280",
    "end": "3567720"
  },
  {
    "text": "in time separated by delta t. What does that tell\nyou about the spectrum?",
    "start": "3567720",
    "end": "3575680"
  },
  {
    "text": "So when we pass the\nFourier transform FFT algorithm, a signal\nthat's discretized in time,",
    "start": "3575680",
    "end": "3581580"
  },
  {
    "text": "it passes us back this\nthing here, right,",
    "start": "3581580",
    "end": "3588480"
  },
  {
    "text": "with positive frequencies\nin the first half of the vector, the negative\nfrequencies in the second half. It's really a piece--",
    "start": "3588480",
    "end": "3595650"
  },
  {
    "text": "it's one period of\na periodic spectrum. ",
    "start": "3595650",
    "end": "3601749"
  },
  {
    "text": "[AUDIO OUT] right? Mathematically, if our signal\nis discretized in time,",
    "start": "3601749",
    "end": "3608160"
  },
  {
    "text": "it means the\nspectrum is periodic. And the FFT algorithm is\npassing back one period.",
    "start": "3608160",
    "end": "3614830"
  },
  {
    "text": "And then there's a circular\nshift to get this thing. Does that makes sense?",
    "start": "3614830",
    "end": "3621920"
  },
  {
    "text": "OK, now, because these\nare real functions, this piece here is exactly\nequal to that piece.",
    "start": "3621920",
    "end": "3630460"
  },
  {
    "text": "It's symmetric. The magnitude of the\nspectrum is symmetric.",
    "start": "3630460",
    "end": "3637650"
  },
  {
    "text": "So what does that mean? What that means, if our\nsignal has some bandwidth--",
    "start": "3637650",
    "end": "3643010"
  },
  {
    "text": "if the highest frequency is\nless than some bandwidth B--",
    "start": "3643010",
    "end": "3649990"
  },
  {
    "text": "if the sampling\nrate is high enough, then you can see that the\nfrequency components here",
    "start": "3649990",
    "end": "3657330"
  },
  {
    "text": "don't interact with the\nfrequency components here. You can see that\nthey're separated.",
    "start": "3657330",
    "end": "3663180"
  },
  {
    "text": " OK, one more thing. The period of a spectrum 1 is\nover delta t [INAUDIBLE] which",
    "start": "3663180",
    "end": "3675090"
  },
  {
    "text": "is equal to the sampling rate. So when we have a signal\nthat's discretized in time,",
    "start": "3675090",
    "end": "3680700"
  },
  {
    "text": "the spectrum is periodic and\nthere are multiple copies of that spectrum,\nof this spectrum,",
    "start": "3680700",
    "end": "3687119"
  },
  {
    "text": "at intervals of\n[AUDIO OUT] rate. OK, so if the sampling\nrate is high enough,",
    "start": "3687120",
    "end": "3695230"
  },
  {
    "text": "then the positive\nfrequencies are well separated from the\nnegative frequencies",
    "start": "3695230",
    "end": "3700890"
  },
  {
    "text": "if the sampling rate is higher\nthan twice the bandwidth",
    "start": "3700890",
    "end": "3707220"
  },
  {
    "text": "[AUDIO OUT] If I sample\nthe signal at a slower",
    "start": "3707220",
    "end": "3715359"
  },
  {
    "text": "and slower rate but\nit's the same signal, you can see at some point\nthat negative frequencies are",
    "start": "3715360",
    "end": "3722250"
  },
  {
    "text": "going to start crashing into\nthe positive frequencies. So you can see that you\ndon't run into this problem",
    "start": "3722250",
    "end": "3729140"
  },
  {
    "text": "as long as the sampling rate is\ngreater than twice the highest frequency [INAUDIBLE]",
    "start": "3729140",
    "end": "3735272"
  },
  {
    "text": "So what? So who cares?",
    "start": "3735272",
    "end": "3740530"
  },
  {
    "text": "What's so bad about this? Well, it turns out\nthat if you sample",
    "start": "3740530",
    "end": "3747680"
  },
  {
    "text": "at a frequency higher than\ntwice the bandwidth, the highest frequency in the\nsignal, then you can do something really cool.",
    "start": "3747680",
    "end": "3753570"
  },
  {
    "text": " You can perfectly reconstruct\nthe original signal",
    "start": "3753570",
    "end": "3759800"
  },
  {
    "text": "even though you've sampled\nit only discretely.",
    "start": "3759800",
    "end": "3765320"
  },
  {
    "text": "Put an arbitrary signal in. You can sample it discretely. And as long as you've sampled\nit at twice the highest",
    "start": "3765320",
    "end": "3772160"
  },
  {
    "text": "frequency in the\noriginal signal, you can perfectly reconstruct\nthe original signal.",
    "start": "3772160",
    "end": "3778190"
  },
  {
    "text": "Back to this. Here's our discretely\nsampled signal. There is the spectrum.",
    "start": "3778190",
    "end": "3784820"
  },
  {
    "text": "It's periodic. Let's say that the\nsampling rate is more than twice the bandwidth.",
    "start": "3784820",
    "end": "3791420"
  },
  {
    "text": "How would I reconstruct\nthe original signal? ",
    "start": "3791420",
    "end": "3806981"
  },
  {
    "text": "But remember that the\nconvolution theorem says that by multiplying\nthe frequency domain,",
    "start": "3806981",
    "end": "3816760"
  },
  {
    "text": "I'm convolving in\nthe time domain, OK? So remember that\nthis piece right here",
    "start": "3816760",
    "end": "3825670"
  },
  {
    "text": "was the spectrum of the\noriginal signal, right?",
    "start": "3825670",
    "end": "3830970"
  },
  {
    "text": "As I sampled it in time,\nI added these [AUDIO OUT] copies at intervals\nof the sampling rate.",
    "start": "3830970",
    "end": "3838910"
  },
  {
    "text": "If I want to get the\noriginal signal back, I can just put a square\nwindow around this,",
    "start": "3838910",
    "end": "3845720"
  },
  {
    "text": "keep that, and throw\naway all the others. [INAUDIBLE]",
    "start": "3845720",
    "end": "3852030"
  },
  {
    "text": "By sampling regularly, I've\njust added these other copies. But they're far enough away\nthat I can just throw them off.",
    "start": "3852030",
    "end": "3858359"
  },
  {
    "text": "I can set them to zero. Now, when I put a square\nwindow in the frequency domain,",
    "start": "3858360",
    "end": "3865720"
  },
  {
    "text": "what am I doing in\nthe time domain? Multiply by a square\nwindow in frequency,",
    "start": "3865720",
    "end": "3871960"
  },
  {
    "text": "what am I doing in time? [INAUDIBLE] So basically what I do is I\ntake the original signal sampled",
    "start": "3871960",
    "end": "3880869"
  },
  {
    "text": "regularly in time. And I just convolve\nit with what? What's the Fourier\ntransform of a square pulse?",
    "start": "3880870",
    "end": "3886150"
  },
  {
    "text": " [INAUDIBLE] If I could just\nconvolve the time domain",
    "start": "3886150",
    "end": "3895030"
  },
  {
    "text": "[INAUDIBLE] with\na kernel, that's the Fourier transform\nof that square window. It's just the sync function.",
    "start": "3895030",
    "end": "3900080"
  },
  {
    "text": "And when I do that, I get\nback the original function. But it's actually easier to do.",
    "start": "3900080",
    "end": "3905319"
  },
  {
    "text": "Rather than convolving\nwith a sync function, it's easier just to multiply\nin the frequency domain.",
    "start": "3905320",
    "end": "3910500"
  },
  {
    "text": "So I can basically get\nback my sampled function at arbitrarily fine [AUDIO OUT]",
    "start": "3910500",
    "end": "3919540"
  },
  {
    "text": "Here's how you actually do that. That process is\ncalled zero-padding. OK, so what you can do is you\ncan take a function, Fourier",
    "start": "3919540",
    "end": "3927710"
  },
  {
    "text": "transform it, get the spectrum. And what the Fourier\ntransform hands us back is just this piece\nright here [INAUDIBLE]",
    "start": "3927710",
    "end": "3936130"
  },
  {
    "text": "But what I can do is I can just\nmove those other peaks away.",
    "start": "3936130",
    "end": "3941960"
  },
  {
    "text": "So that's what my\nFFT sends back to me. Now what am I going\nto do, I'm just going to push that away and\nadd zeros in the middle.",
    "start": "3941960",
    "end": "3952829"
  },
  {
    "text": "Now, inverse Fourier transform,\nand [INAUDIBLE] So the sampling",
    "start": "3952830",
    "end": "3961440"
  },
  {
    "text": "rate is just the number\nof frequency samples I have times delta f. And here I'm just adding a\nbunch of frequency samples",
    "start": "3961440",
    "end": "3968400"
  },
  {
    "text": "that are zero. And my new delta t is just going\nto be 1 over that new sampling",
    "start": "3968400",
    "end": "3976020"
  },
  {
    "text": "rate. Here's an example. This is a little bit\nof code that does it. Here I've taken a\nsine wave at 20 hertz.",
    "start": "3976020",
    "end": "3983010"
  },
  {
    "text": "You can see 50\nmillisecond spacing sampled four times per cycle.",
    "start": "3983010",
    "end": "3990370"
  },
  {
    "text": "I just run this little\nzero-padding algorithm. And you can see that it\nsends me back these red dots.",
    "start": "3990370",
    "end": "3998161"
  },
  {
    "text": "[INAUDIBLE] have more completely\nreconstructed the sine wave that I sampled.",
    "start": "3998161",
    "end": "4003710"
  },
  {
    "text": "OK, but you can do\nthat with any function as long as the highest frequency\nin your original signal",
    "start": "4003710",
    "end": "4012150"
  },
  {
    "text": "is less than [AUDIO OUT]\nhalf the sampling rate. ",
    "start": "4012150",
    "end": "4020090"
  },
  {
    "text": "[INAUDIBLE] So zero-padding, so\nwhat I showed you here",
    "start": "4020090",
    "end": "4027359"
  },
  {
    "text": "is that zero-padding\nin the frequency domain gives you higher\nsampling, faster sampling,",
    "start": "4027360",
    "end": "4036290"
  },
  {
    "text": "in the time domain. OK, and you can also\ndo the same thing. You can also zero-pad\nin the time domain",
    "start": "4036290",
    "end": "4044480"
  },
  {
    "text": "to give finer spacing\nin the frequency domain. FFT samples will\nbe closer together",
    "start": "4044480",
    "end": "4050800"
  },
  {
    "text": "in the frequency domain. OK, so here's how you do that. So you take a little\npiece of data.",
    "start": "4050800",
    "end": "4056830"
  },
  {
    "text": "You multiply it by\nyour DPSS taper. And then just add\na bunch of zeros.",
    "start": "4056830",
    "end": "4063840"
  },
  {
    "text": "And then take the\nFourier transform of that longer piece with\nall those zeros added to it.",
    "start": "4063840",
    "end": "4069310"
  },
  {
    "text": "And when you do that, what\nyou're going to get back is an FFT that has the\nsamples in frequency",
    "start": "4069310",
    "end": "4077550"
  },
  {
    "text": "more finely spaced. Your delta f is\ngoing to be smaller. Now, that doesn't [AUDIO OUT]\nfrequency resolution.",
    "start": "4077550",
    "end": "4083430"
  },
  {
    "text": "There's no magic getting\naround the minimum time [INAUDIBLE] product. OK?",
    "start": "4083430",
    "end": "4088590"
  },
  {
    "text": "But you have more\nsamples in frequency. All right, any questions?",
    "start": "4088590",
    "end": "4094400"
  },
  {
    "text": " [INAUDIBLE] We're going to be\nstarting a new topic next time.",
    "start": "4094400",
    "end": "4101680"
  },
  {
    "text": "We're done with\nspectral analysis. ",
    "start": "4101680",
    "end": "4111000"
  }
]