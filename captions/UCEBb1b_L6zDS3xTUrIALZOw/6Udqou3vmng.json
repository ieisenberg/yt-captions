[
  {
    "text": " The following\ncontent is provided under a Creative\nCommons license. Your support will help MIT\nOpenCourseWare continue",
    "start": "0",
    "end": "6870"
  },
  {
    "text": "to offer high quality\neducational resources for free. To make a donation or\nview additional materials",
    "start": "6870",
    "end": "13330"
  },
  {
    "text": "from hundreds of MIT courses,\nvisit MIT OpenCourseWare at ocw.mit.edu. ",
    "start": "13330",
    "end": "25625"
  },
  {
    "text": "PROFESSOR: All right. So today, we're going\nto briefly review classical sequencing and\nnext-gen or second-gen",
    "start": "25625",
    "end": "32750"
  },
  {
    "text": "sequencing, which sort of\nprovides a lot of the data that the analytical methods\nwe'll be talking about work on.",
    "start": "32750",
    "end": "42660"
  },
  {
    "text": "And we'll then introduce\nlocal alignment a la BLAST and some of\nthe statistics associated",
    "start": "42660",
    "end": "51350"
  },
  {
    "text": "with that. So just a few brief\nitems on topic one.",
    "start": "51350",
    "end": "56680"
  },
  {
    "text": "All right. So today, we're going to\ntalk about sequencing first. Conventional-- or Sanger\nsequencing-- then next-gen",
    "start": "56680",
    "end": "63350"
  },
  {
    "text": "or second-gen\nsequencing briefly. And then talk about\nlocal alignments.",
    "start": "63350",
    "end": "70280"
  },
  {
    "text": "So background for the sequencing\npart, the Metzger review",
    "start": "70280",
    "end": "75540"
  },
  {
    "text": "covers everything you'll need. And for the alignment-- we'll\ntalk about local alignment",
    "start": "75540",
    "end": "81180"
  },
  {
    "text": "today, global\nalignment on Tuesday-- then chapters four and five of\nthe text cover it pretty well.",
    "start": "81180",
    "end": "87310"
  },
  {
    "text": "So here's the text. If you haven't decided\nwhether to get it or not, I'll have it up here. You can come flip\nthrough it after class.",
    "start": "87310",
    "end": "95650"
  },
  {
    "text": " Sequencing is mostly\ndone at the level of DNA.",
    "start": "95650",
    "end": "104450"
  },
  {
    "text": "Whether the original\nmaterial was RNA or not,",
    "start": "104450",
    "end": "110201"
  },
  {
    "text": "usually convert to DNA and\nsequence at the DNA level. So we'll often think about\nDNA as sort of a string.",
    "start": "110202",
    "end": "117142"
  },
  {
    "text": "But it's important to\nremember that it actually has a three dimensional\nstructure as shown here.",
    "start": "117142",
    "end": "124229"
  },
  {
    "text": "And often, it's helpful to\nthink of it in sort of a two dimensional\nrepresentation where you",
    "start": "124230",
    "end": "129710"
  },
  {
    "text": "think about the bases and\ntheir hydrogen bonding and so forth as\nshown in the middle.",
    "start": "129710",
    "end": "138319"
  },
  {
    "text": "My mouse is not working\ntoday for some reason, but hopefully, we won't need it.",
    "start": "138320",
    "end": "144410"
  },
  {
    "text": "So the chemistry of sequencing\nis very closely related to the chemistry of\nthe individual bases.",
    "start": "144410",
    "end": "153970"
  },
  {
    "text": "And there are really\nthree main types that are going to\nbe relevant here.",
    "start": "153970",
    "end": "161390"
  },
  {
    "text": "Ribonucleotides,\ndeoxyribonucleotides, then for Sanger sequencing,\ndideoxyribonucleotides.",
    "start": "161390",
    "end": "168370"
  },
  {
    "text": "So who can tell me which\nof these structures corresponds to which\nof those names?",
    "start": "168370",
    "end": "174860"
  },
  {
    "text": "And also, please let\nme know your name and I'll attempt\nto remember some",
    "start": "174860",
    "end": "181860"
  },
  {
    "text": "of your names toward the end\nof the semester probably. So, which are which? ",
    "start": "181860",
    "end": "190470"
  },
  {
    "text": "Yes, what's your name? AUDIENCE: I'm Simona. So the ribonucleotide\nis the top right.",
    "start": "190470",
    "end": "195946"
  },
  {
    "text": "The deoxy is the one below it. And the dideoxy is\nthe one to the left. PROFESSOR: OK, so\nthat is correct.",
    "start": "195947",
    "end": "201820"
  },
  {
    "text": "So one way to keep\nthese things in mind is the numbering of the bases.",
    "start": "201820",
    "end": "208230"
  },
  {
    "text": "So the carbons in the ribo\nsugar are numbered one,",
    "start": "208230",
    "end": "213950"
  },
  {
    "text": "so carbon 1 is the one\nwhere the base is attached. Two is here, which has an OH\nin RNA and just an H in DNA.",
    "start": "213950",
    "end": "222560"
  },
  {
    "text": "And then three is\nvery important. Four, and then five.",
    "start": "222560",
    "end": "227650"
  },
  {
    "text": "So five connects\nto the phosphates, which then will connect the\nbase to the sugar phosphate",
    "start": "227650",
    "end": "232941"
  },
  {
    "text": "backbone. And three is where you extend.",
    "start": "232941",
    "end": "238720"
  },
  {
    "text": "That's where you're going to\nadd the next base in a growing chain. And so what will happen if you\ngive DNA polymerase a template",
    "start": "238720",
    "end": "248810"
  },
  {
    "text": "and some dideoxy nucleotides? ",
    "start": "248810",
    "end": "254955"
  },
  {
    "text": "It won't be able to extend\nbecause there's no 3-prime OH. And all the chemistry\nrequires the OH. And so that's the basis\nof classical or Sanger",
    "start": "254955",
    "end": "262770"
  },
  {
    "text": "sequencing, which Fred\nSanger got the Nobel Prize for in the 1980s-- I think\nit was developed in the '70s--",
    "start": "262770",
    "end": "271400"
  },
  {
    "text": "and it's really\nthe basis of most of the sequencing, or\npretty much all the DNA sequencing up until\nthe early 2000s",
    "start": "271400",
    "end": "278860"
  },
  {
    "text": "before some newer\ntechnologies came about. And it takes advantage\nof this special property",
    "start": "278860",
    "end": "285110"
  },
  {
    "text": "of dideoxy nucleotides that they\nterminate the growing chain.",
    "start": "285110",
    "end": "291860"
  },
  {
    "text": "So imagine we have\na template DNA. So this is the\nmolecule whose sequence we want to determine\nshown there in black.",
    "start": "291860",
    "end": "299290"
  },
  {
    "text": "We then have a primer. And notice the primer's\nwritten in 5-prime to 3-prime direction. The ends would be\nprimer sequences",
    "start": "299290",
    "end": "309360"
  },
  {
    "text": "and then primer complimentary\nsequences in the template. So you typically will have\nyour template cloned-- this is in conventional\nsequencing-- cloned",
    "start": "309360",
    "end": "315660"
  },
  {
    "text": "into some vector\nlike a phage vector for sequencing so you know\nthe flanking sequences.",
    "start": "315661",
    "end": "322080"
  },
  {
    "text": "And then you do four\nsequencing reactions in conventional\nSanger sequencing.",
    "start": "322080",
    "end": "328070"
  },
  {
    "text": "And I know some of you have\nprobably had this before. So let's take the first\nchemical reaction.",
    "start": "328070",
    "end": "334620"
  },
  {
    "text": "The one here with a DDGTP. So what would you\nput in that reaction?",
    "start": "334620",
    "end": "341527"
  },
  {
    "text": "What are all the\ncomponents of that reaction if you wanted to do\nconventional sequencing on, say, an acrylonitrile?",
    "start": "341527",
    "end": "349316"
  },
  {
    "text": "Anyone? What do you need and\nwhat does it accomplish?",
    "start": "349316",
    "end": "355090"
  },
  {
    "text": "Yeah, what's your name? AUDIENCE: I'm Tim. PROFESSOR: Tim? Oh yeah, I know you, Tim. OK, go ahead. AUDIENCE: So you need\nthe four nucleotides--",
    "start": "355090",
    "end": "362890"
  },
  {
    "text": "the deoxynucleotides. You will need the\ndideoxy P nucleotides.",
    "start": "362890",
    "end": "368368"
  },
  {
    "text": "In addition, you need all\nthe other [INAUDIBLE]. You need polymerase. Generally, you need a buffer\nof some sort, [INAUDIBLE],",
    "start": "368368",
    "end": "377830"
  },
  {
    "text": "to [INAUDIBLE]. PROFESSOR: Yeah,\nprimary template. Yeah. Great.",
    "start": "377830",
    "end": "384470"
  },
  {
    "text": "That's good. It sounds like Tim could\nactually do this experiment. ",
    "start": "384470",
    "end": "393750"
  },
  {
    "text": "And what ratio would you put in? So you said you're\ngoing to put in all four conventional\ndeoxynucleotides and then one",
    "start": "393750",
    "end": "400659"
  },
  {
    "text": "dideoxynucleotide. So let's say dideoxy G\njust for simplicity here.",
    "start": "400660",
    "end": "406120"
  },
  {
    "text": "So in what ratio would you\nput the dideoxynucleotide compared to the\nconventional nucleotides?",
    "start": "406120",
    "end": "411539"
  },
  {
    "text": "AUDIENCE: To lower\nthe concentration. PROFESSOR: Lower? Like how much lower? AUDIENCE: Like, a lot lower.",
    "start": "411539",
    "end": "416930"
  },
  {
    "text": "PROFESSOR: Like maybe 1%? AUDIENCE: Yeah. PROFESSOR: Something like that. You want to put it a lot lower. And why is that so important?",
    "start": "416930",
    "end": "425858"
  },
  {
    "text": "AUDIENCE: Because you want the\nthing to be able to progress.",
    "start": "425858",
    "end": "431325"
  },
  {
    "text": "Because you need enough of the\nribonucleotide concentration so that [INAUDIBLE]\nevery [INAUDIBLE]",
    "start": "431325",
    "end": "439277"
  },
  {
    "text": "equivalent or excess and you're\ngoing to terminate [INAUDIBLE]. PROFESSOR: Right.",
    "start": "439277",
    "end": "444690"
  },
  {
    "text": "So if you put equamolar\ndeoxy G and dideoxy G, then it's going to be a\n50% chance of terminating",
    "start": "444690",
    "end": "452050"
  },
  {
    "text": "every time you hit\na C in the template. So you're going to\nhave half as much of the material at the second\nG, and a quarter as much as",
    "start": "452050",
    "end": "458010"
  },
  {
    "text": "the third, and you're going to\nhave vanishingly small amounts. So you're only going\nto be able to sequence the first few C's\nin the template.",
    "start": "458010",
    "end": "465790"
  },
  {
    "text": "Exactly. So that's a very good point.  So now let's imagine you do\nthese four separate reactions.",
    "start": "465790",
    "end": "473520"
  },
  {
    "text": "You typically would\nhave radiolabeled primer so you can see your DNA. And then you would run\nit on some sort of gel.",
    "start": "473520",
    "end": "480430"
  },
  {
    "text": "This is obviously not a real\ngel, but an idealized version. And then in the lane\nwhere you put dideoxy G,",
    "start": "480430",
    "end": "490260"
  },
  {
    "text": "you would see the\nsmallest products. So you read these guys\nfrom the bottom up. And in this lane there\nis a very small product",
    "start": "490260",
    "end": "498580"
  },
  {
    "text": "that's just one base longer\nthan the primer here. And that's because there was a\nC there and it terminated there.",
    "start": "498580",
    "end": "504520"
  },
  {
    "text": "And then the next C appears\nseveral bases later. So you have sort of a gap here.",
    "start": "504520",
    "end": "510010"
  },
  {
    "text": "And so you can see that the\nfirst base in the template would be a complement\nof T, or C.",
    "start": "510010",
    "end": "515929"
  },
  {
    "text": "And the second base\nwould be, you can see,",
    "start": "515929",
    "end": "524400"
  },
  {
    "text": "the next smallest product\nin this dideoxy T lane, therefore it would\nbe A. And you just sort of snake your\nway up through the gel",
    "start": "524400",
    "end": "530970"
  },
  {
    "text": "and read out the sequence. And this works well. So what does it actually\nlook like in practice?",
    "start": "530970",
    "end": "538200"
  },
  {
    "text": "Here are some actual\nsequencing gels. So you run four lanes.",
    "start": "538200",
    "end": "543390"
  },
  {
    "text": "And on big polyacrylamide\ngels like this.",
    "start": "543390",
    "end": "550540"
  },
  {
    "text": "Torbin, you ever\nrun one of these? AUDIENCE: Yes. PROFESSOR: Yes? They're a big pain to cast.",
    "start": "550540",
    "end": "557140"
  },
  {
    "text": "Run for several hours, I think. And you get these\nbanding patterns.",
    "start": "557140",
    "end": "562360"
  },
  {
    "text": "And what limits the\nsequence read length? So we normally call\nthe sequence generated",
    "start": "562360",
    "end": "571310"
  },
  {
    "text": "from one run of a\nsequencer as a read. So that one attempt to sequence\nthe template is called a read.",
    "start": "571310",
    "end": "578640"
  },
  {
    "text": "And you can see\nit's relatively easy to read the sequence\ntoward the bottom, and then it gets\nharder as you go up.",
    "start": "578640",
    "end": "586060"
  },
  {
    "text": "And so that's really what\nfundamentally limits the read length, is that the bands get\ncloser and closer together.",
    "start": "586060",
    "end": "593170"
  },
  {
    "text": "So they'll run inversely\nproportional to size",
    "start": "593170",
    "end": "598209"
  },
  {
    "text": "with the small ones\nrunning faster. But then the difference between\na 20 base product and a 21",
    "start": "598210",
    "end": "605170"
  },
  {
    "text": "might be significant. But the difference between a\n500 base product and a 501 base product is going\nto be very small.",
    "start": "605170",
    "end": "611450"
  },
  {
    "text": "And so you basically can't\norder the lanes anymore. And therefore, that's sort of\nwhat fundamentally limits it.",
    "start": "611450",
    "end": "619330"
  },
  {
    "text": "All right. So here we had to run\nfour lanes of a gel.",
    "start": "619330",
    "end": "624410"
  },
  {
    "text": "Can anyone think of\na more efficient way of doing Sanger sequencing? Is there any way to\ndo it in one lane?",
    "start": "624410",
    "end": "630690"
  },
  {
    "text": " Yeah, what's your name? AUDIENCE: Adrian.",
    "start": "630690",
    "end": "636338"
  },
  {
    "text": "You can use four different\ntypes of the entities. Maybe like four\ndifferent colors.",
    "start": "636338",
    "end": "641590"
  },
  {
    "text": "AUDIENCE: Four different colors. OK, so instead of using radio\nlabeling on the primary, you use fluorophore on your\ndideoxy entities, for example.",
    "start": "641590",
    "end": "650399"
  },
  {
    "text": "And then you can run them. Depending where that\nstrand terminated,",
    "start": "650400",
    "end": "657170"
  },
  {
    "text": "it'll be a different color. And you can run them\nall in one lane. OK, so that looks like that. And so this was an\nimportant development",
    "start": "657170",
    "end": "664990"
  },
  {
    "text": "called terminator\nsequencing in the '90s. That was the basis of the ABI\n3700 machine, which was really",
    "start": "664990",
    "end": "674940"
  },
  {
    "text": "the workhorse of\ngenome sequencing in the late '90s\nand early 2000s. Really what enabled the\nhuman genome to be sequenced.",
    "start": "674940",
    "end": "682430"
  },
  {
    "text": "And so one of the other\ninnovations in this technology was that instead of having a\nbig gel, they shrunk the gel.",
    "start": "682430",
    "end": "691034"
  },
  {
    "text": "And then they just had\na reader at the bottom. So the gel was shrunk to as thin\nas these little capillaries.",
    "start": "691034",
    "end": "698475"
  },
  {
    "text": "I don't know if you\ncan see these guys. But basically it's like\na little thread here.",
    "start": "698475",
    "end": "703500"
  },
  {
    "text": "And so each one of these\nis effectively-- oops! Oh no. No worries, this\nis not valuable.",
    "start": "703500",
    "end": "710140"
  },
  {
    "text": "Ancient technology that I\ngot for free from somebody. So the DNA would be\nloaded at the top.",
    "start": "710140",
    "end": "720702"
  },
  {
    "text": "There would be a\nlittle gel in each of these-- it's called\ncapillary sequencing. And then it would\nrun out the bottom",
    "start": "720702",
    "end": "726060"
  },
  {
    "text": "and there would be\na detector which would detect the\nfour different flours and read out the sequence. So this basically condensed the\nvolume needed for sequencing.",
    "start": "726060",
    "end": "737010"
  },
  {
    "text": " Any questions about\nconventional sequencing?",
    "start": "737010",
    "end": "743630"
  },
  {
    "text": "Yes? AUDIENCE: Where\nare the [INAUDIBLE] where you'd put the\nfluorescent flags?",
    "start": "743630",
    "end": "748738"
  },
  {
    "text": "Like the topic from\nthe [INAUDIBLE]? PROFESSOR: Yeah,\nthat's a good question. I don't actually remember.",
    "start": "748738",
    "end": "755390"
  },
  {
    "text": "I think there are different\noptions available. And sometimes with some\nof these reactions,",
    "start": "755390",
    "end": "761459"
  },
  {
    "text": "you need to use modified\npolymerases that can tolerate these\nmodified nucleotides.",
    "start": "761460",
    "end": "768250"
  },
  {
    "text": "Yeah, so I don't remember that. It's a good question. I can look that up. So how long can a\nconventional sequencer go?",
    "start": "768250",
    "end": "776650"
  },
  {
    "text": "What's the read length? Anyone know? It's about, say, 600 or so.",
    "start": "776650",
    "end": "784060"
  },
  {
    "text": "And so that's reasonably long. How long is a typical\nmammalian mRNA?",
    "start": "784060",
    "end": "791360"
  },
  {
    "text": "Maybe two, three kb? So you have in a typical\nexon, maybe 150 bases or so. So you have a chunk.",
    "start": "791360",
    "end": "797920"
  },
  {
    "text": "You don't generally\nget full length cDNA. But you get a chunk\nof a cDNA that's say, three, four exons in length.",
    "start": "797920",
    "end": "805199"
  },
  {
    "text": "And that is actually\ngenerally sufficient to uniquely identify the gene\nlocus that that read came from.",
    "start": "805200",
    "end": "812660"
  },
  {
    "text": "And so that was the\nbasis of EST sequencing-- so-called Expressed\nSequence Tag sequencing.",
    "start": "812660",
    "end": "818060"
  },
  {
    "text": "And millions of these 600 base\nchunks of cDNA were generated",
    "start": "818060",
    "end": "823510"
  },
  {
    "text": "and they have been quite\nuseful over the years.",
    "start": "823510",
    "end": "828891"
  },
  {
    "text": "All right. So what is next-gen sequencing? So in next-gen sequencing, you\nonly read one base at a time.",
    "start": "828891",
    "end": "838980"
  },
  {
    "text": "So it's often a\nlittle bit slower.",
    "start": "838980",
    "end": "844370"
  },
  {
    "text": "But it's really\nmassively parallel. And that's the big advantage. And it's orders of\nmagnitude cheaper",
    "start": "844370",
    "end": "852000"
  },
  {
    "text": "per base than\nconventional sequencing. Like when it first\ncame out it, it was maybe two orders\nof magnitude cheaper.",
    "start": "852000",
    "end": "857360"
  },
  {
    "text": "And now it's probably another\nfour orders of magnitude. So it really blows away\nconventional sequencing",
    "start": "857360",
    "end": "864910"
  },
  {
    "text": "if the output that\nyou care about",
    "start": "864910",
    "end": "870600"
  },
  {
    "text": "is mostly proportional to\nnumber of bases sequence. If the output is proportional\nto the quality of the assembly",
    "start": "870600",
    "end": "877910"
  },
  {
    "text": "or something, then\nthere are applications where conventional\nsequencing still is very useful Because the\nnext-gen sequencing tends",
    "start": "877910",
    "end": "885547"
  },
  {
    "text": "to be shorter. But in terms of just volume, it\ngenerates much, much more bases",
    "start": "885547",
    "end": "891870"
  },
  {
    "text": "in one reaction. And so the basic ideas are\nthat you have your template DNA",
    "start": "891870",
    "end": "898700"
  },
  {
    "text": "molecules. Now typically, tens of thousands\nfor technologies like PacBio",
    "start": "898700",
    "end": "904959"
  },
  {
    "text": "or hundreds of millions for\ntechnologies like Illumina that",
    "start": "904960",
    "end": "910560"
  },
  {
    "text": "are immobilized on\nsome sort of surface-- typically a flow\ncell-- and there",
    "start": "910560",
    "end": "917960"
  },
  {
    "text": "are either single\nmolecule methods where you have a single\nmolecule of your template or there are methods that\nlocally amplify your template",
    "start": "917960",
    "end": "924950"
  },
  {
    "text": "and produce, say, hundreds\nof identical copies in little clusters. And then you use\nmodified nucleotides,",
    "start": "924950",
    "end": "932400"
  },
  {
    "text": "often with\nfluorophores attached, to interrogate the next base at\neach of your template molecules",
    "start": "932400",
    "end": "941990"
  },
  {
    "text": "for hundreds and hundreds\nof millions of them. And so there are several\ndifferent technologies. We won't talk about all of them.",
    "start": "941990",
    "end": "948133"
  },
  {
    "text": "We'll just talk\nabout two or three that are interesting\nand widely used. And they differ depending\non the DNA template, what",
    "start": "948133",
    "end": "955170"
  },
  {
    "text": "types of modified\nnucleotides are used, and to some extent, in the\nimaging and the image analysis,",
    "start": "955170",
    "end": "960209"
  },
  {
    "text": "which differs for single\nmolecule methods, for example, compared to the ones\nthat sequence a cluster.",
    "start": "960210",
    "end": "968770"
  },
  {
    "text": "So there's a table in\nthe Metzger review. And so I've just told you\nthat next-gen sequencing",
    "start": "968770",
    "end": "975970"
  },
  {
    "text": "is so cheap. But then you see how\nmuch these machines cost and you could buy lots of\nother interesting things",
    "start": "975970",
    "end": "981790"
  },
  {
    "text": "with that kind of money. And I also want to emphasize\nthat that's not even",
    "start": "981790",
    "end": "987329"
  },
  {
    "text": "the full cost. So if you were to buy an\nIllumina GA2-- this would",
    "start": "987330",
    "end": "993100"
  },
  {
    "text": "be like a couple years\nago when the GA2 was the state of the art-- for\nhalf a million dollars,",
    "start": "993100",
    "end": "998580"
  },
  {
    "text": "the reagents to run\nthat thing, if you're going to run it continuously\nthroughout the year, the reagents to run it\nwould be over a million.",
    "start": "998580",
    "end": "1007120"
  },
  {
    "text": "So this actually\nunderestimates the cost. However, the cost per\nbase is super, super low.",
    "start": "1007120",
    "end": "1014170"
  },
  {
    "text": "Because they generate\nso much data at once. All right, So we'll talk\nabout a couple of these.",
    "start": "1014170",
    "end": "1021410"
  },
  {
    "text": "The first next-gen\nsequencing technology to be published and\nstill used today",
    "start": "1021410",
    "end": "1028050"
  },
  {
    "text": "was from 454--\nnow Roche-- and it",
    "start": "1028050",
    "end": "1033869"
  },
  {
    "text": "was based on what's\ncalled emulsion PCR. So they have these little\nbeads, the little beads",
    "start": "1033869",
    "end": "1039020"
  },
  {
    "text": "have adapter DNA molecules\ncovalently attached. You incubate the beads\nwith DNA, and you actually",
    "start": "1039020",
    "end": "1049020"
  },
  {
    "text": "make an emulsion. So it's an oil water emulsion. So each bead, which\nis hydrophilic,",
    "start": "1049020",
    "end": "1054780"
  },
  {
    "text": "is in the little bubble\nof water inside oil. And the reason for that\nis so that you do it",
    "start": "1054780",
    "end": "1061030"
  },
  {
    "text": "at a template\nconcentration that's low enough that only a\nsingle molecule of template is associated with each bead.",
    "start": "1061030",
    "end": "1066630"
  },
  {
    "text": "So the oil then\nprovides a barrier so that the DNA can't get\ntransferred from one bead",
    "start": "1066630",
    "end": "1073700"
  },
  {
    "text": "to another. So each bead will have a\nunique template molecule. You do sort of a local\nPCR-like reaction",
    "start": "1073701",
    "end": "1080300"
  },
  {
    "text": "to amplify that DNA\nmolecule on the bead, and then you do sequencing\none base at a time using",
    "start": "1080300",
    "end": "1090731"
  },
  {
    "text": "a luciferase based\nmethod that I'll show you on the next slide. So Illumina technology differs\nin that instead of an emulsion,",
    "start": "1090732",
    "end": "1098410"
  },
  {
    "text": "you're doing it on the\nsurface of a flow cell. Again, you start with a\nsingle molecule of template.",
    "start": "1098410",
    "end": "1104450"
  },
  {
    "text": "Your flow cell has\nthese two types of adapters covalently attached. The template anneals to\none of these adapters.",
    "start": "1104450",
    "end": "1113080"
  },
  {
    "text": "You extend the adapter molecule\nwith dNTPs and polymerase.",
    "start": "1113080",
    "end": "1118179"
  },
  {
    "text": "Now you have the complement of\nyour template, your denature. Now you have the\ninverse complement",
    "start": "1118180",
    "end": "1124340"
  },
  {
    "text": "of your template\nmolecule covalently attached to the cell surface. And then at the other end\nthere's the other adapter.",
    "start": "1124340",
    "end": "1130220"
  },
  {
    "text": "And so what you\ncould do is what's called bridge amplification\nwhere that now complement",
    "start": "1130220",
    "end": "1136140"
  },
  {
    "text": "of the template molecule\nwill bridge over hybridized to the other\nadapter, and then you",
    "start": "1136140",
    "end": "1142300"
  },
  {
    "text": "can extend that adapter. And now you've regenerated\nyour original template. And so now you have the\ncomplementary strand,",
    "start": "1142300",
    "end": "1148210"
  },
  {
    "text": "and the original\nstrand, your denature. And then each of those molecules\ncan undergo subsequent rounds",
    "start": "1148210",
    "end": "1154140"
  },
  {
    "text": "of bridge amplification to\nmake clusters of typically several hundred\nthousand molecules.",
    "start": "1154140",
    "end": "1162197"
  },
  {
    "text": "Is that clear? Question. Yeah, what's your name? AUDIENCE: Stephanie. How do they get the adapters\nonto the template molecules?",
    "start": "1162197",
    "end": "1170737"
  },
  {
    "text": "PROFESSOR: How do\nyou get the adapters onto the template molecules? So that's typically\nby DNA ligation.",
    "start": "1170737",
    "end": "1178280"
  },
  {
    "text": "So we may cover\nthat in later steps. It depends.",
    "start": "1178280",
    "end": "1183856"
  },
  {
    "text": "There's a few\ndifferent protocol. So for example, if you're\nsequencing microRNAs, you typically would\nisolate the small RNAs",
    "start": "1183856",
    "end": "1190370"
  },
  {
    "text": "and use RNA litigation\nto get the adapters on. And then you would do\nan RT step to get DNA.",
    "start": "1190370",
    "end": "1195770"
  },
  {
    "text": "With most other applications\nlike RNA-seq or genome sequencing-- so with RNA-seq,\nyou're starting from mRNA,",
    "start": "1195770",
    "end": "1202950"
  },
  {
    "text": "you typically will isolate\ntotal RNA, do poly(A) selection, you fragment your RNA\nto reduce the effects",
    "start": "1202950",
    "end": "1208740"
  },
  {
    "text": "of secondary structure,\nyou random prime with, like, random hexamers RT enzyme. So that'll make little bits\nof cDNA 200 bases long.",
    "start": "1208740",
    "end": "1218549"
  },
  {
    "text": "You use second strand synthesis. Now you have double\nstranded cDNA fragments.",
    "start": "1218550",
    "end": "1223730"
  },
  {
    "text": "And then you do, like, blunt end\nligation to add the adapters. And then you denature so\nyou have single strand.",
    "start": "1223730",
    "end": "1231086"
  },
  {
    "text": "AUDIENCE: I guess my\nquestion is how do you make sure that the two\nends sandwiching the DNA are different as opposed to--",
    "start": "1231086",
    "end": "1238540"
  },
  {
    "text": "PROFESSOR: That the\ntwo ends are different. Yeah, that's a good question.",
    "start": "1238540",
    "end": "1243669"
  },
  {
    "text": " I'll post some stuff about--\nIt's a good question.",
    "start": "1243670",
    "end": "1251260"
  },
  {
    "text": "I don't want to sweep\nit under the rug. But I kind of want to move on. And I'll post a\nlittle bit about that.",
    "start": "1251260",
    "end": "1259500"
  },
  {
    "text": "All right so we\ndid 454 Illumina. Helicos is sort of like\nIllumina sequencing",
    "start": "1259500",
    "end": "1266050"
  },
  {
    "text": "except single molecule. So you have your\ntemplate covalently",
    "start": "1266050",
    "end": "1271670"
  },
  {
    "text": "attached to your substrate. You just anneal primer and\njust start sequencing it",
    "start": "1271670",
    "end": "1278590"
  },
  {
    "text": "And there's major pros and cons\nof single molecule sequencing,",
    "start": "1278590",
    "end": "1284679"
  },
  {
    "text": "which we can talk about. And then the PacBio\ntechnology is fundamentally",
    "start": "1284680",
    "end": "1289769"
  },
  {
    "text": "different in that the\ntemplate is not actually covalently attached\nto the surface.",
    "start": "1289770",
    "end": "1295890"
  },
  {
    "text": "The DNA polymerase is covalently\nattached to the surface and the template is sort of\nthreaded into the polymerase.",
    "start": "1295890",
    "end": "1303260"
  },
  {
    "text": "And this is a phage polymerase\nthat's highly processive and strand displacing. And the template is often\na circular molecule.",
    "start": "1303260",
    "end": "1310639"
  },
  {
    "text": "And so you can\nactually read around the template multiple\ntimes, which turns out",
    "start": "1310640",
    "end": "1316480"
  },
  {
    "text": "to be really useful in PacBio\nbecause the error rate is quite high for the sequencing.",
    "start": "1316480",
    "end": "1321850"
  },
  {
    "text": "So in the top, in\nthe 454, you're measuring luciferase\nactivity-- light.",
    "start": "1321850",
    "end": "1328040"
  },
  {
    "text": "In Illumina, you're\nmeasuring fluorescence. Four different\nfluorescent tags, sort of like the four different tags\nwe saw in Sanger sequencing.",
    "start": "1328040",
    "end": "1335029"
  },
  {
    "text": "Helicose, it's single\ntag one base at a time. And in PacBio, you actually\nhave a fluorescently",
    "start": "1335030",
    "end": "1341350"
  },
  {
    "text": "labeled dNTP that has\nthe label on-- it's",
    "start": "1341350",
    "end": "1346620"
  },
  {
    "text": "actually\nhexaphosphate-- it's got the label on the\nsixth phosphate. So the dNTP is labeled.",
    "start": "1346620",
    "end": "1353530"
  },
  {
    "text": "It enters the active site\nof the DNA polymerase. And the residence\ntime is much longer if the base is actually\ngoing to get incorporated",
    "start": "1353530",
    "end": "1361600"
  },
  {
    "text": "into that growing chain. And so you measure how much time\nyou have a fluorescent signal.",
    "start": "1361600",
    "end": "1366960"
  },
  {
    "text": "And if it's long, that\nmeans that that base must have incorporated\ninto the DNA. But then, the extension\nreaction itself",
    "start": "1366960",
    "end": "1376450"
  },
  {
    "text": "will cleave off the\nlast five phosphates and the fluorophore tag. And so you'll\nregenerate native DNA.",
    "start": "1376450",
    "end": "1383960"
  },
  {
    "text": "So that's another difference. Whereas in Illumina\nsequencing, as we'll see, there's this reversible\nterminator chemistry.",
    "start": "1383960",
    "end": "1389190"
  },
  {
    "text": "So the DNA is not native\nthat you're synthesizing. ",
    "start": "1389190",
    "end": "1394990"
  },
  {
    "text": "So this is just a\nlittle bit more on 454. Just some pretty pictures. I think I described that before.",
    "start": "1394990",
    "end": "1402030"
  },
  {
    "text": "The key chemistry here is that\nyou add one dNTP at a time.",
    "start": "1402030",
    "end": "1410080"
  },
  {
    "text": "So only a subset of the wells--\nperhaps a quarter of them-- that have that next base,\nthe complementary base",
    "start": "1410080",
    "end": "1416740"
  },
  {
    "text": "free-- as the next\none after the primer-- will undergo synthesis.",
    "start": "1416740",
    "end": "1422710"
  },
  {
    "text": "And when they undergo synthesis,\nyou release pyrophosphate. And they have these\nenzymes attached",
    "start": "1422710",
    "end": "1428580"
  },
  {
    "text": "to these little micro beads--\nthe orange beads-- sulfurylase and luciferase, that use\npyrophosphate to basically",
    "start": "1428580",
    "end": "1434680"
  },
  {
    "text": "generate light. And so then you have one of\nthese beads in each well. You look at which wells\nlit up when we added dCTP.",
    "start": "1434680",
    "end": "1444600"
  },
  {
    "text": "And they must have had G as\nthe next base and so forth. And there's no termination here.",
    "start": "1444600",
    "end": "1450019"
  },
  {
    "text": "The only termination\nis because you're only adding one base at a time. So if you have a single\ngene in the template, you'll add one base.",
    "start": "1450019",
    "end": "1455803"
  },
  {
    "text": "But if you have two Gs in the\ntemplate, you'll add two Cs. And in principle, you'll\nget twice as much light.",
    "start": "1455803",
    "end": "1461350"
  },
  {
    "text": "But then you have to sort of\ndo some analysis after the fact to say, OK how much\nlight do we have? And was that one G,\ntwo G, and so forth.",
    "start": "1461350",
    "end": "1468322"
  },
  {
    "text": "And the amount of\nlight is supposed to be linear up to\nabout five or six Gs.",
    "start": "1468322",
    "end": "1473440"
  },
  {
    "text": "But that's still a\nmore error-prone step. And the most common\ntype of error in 454",
    "start": "1473440",
    "end": "1481419"
  },
  {
    "text": "is actually insertions\nand deletions. Whereas in Illumina\nsequencing, it's substitutions.",
    "start": "1481420",
    "end": "1488970"
  },
  {
    "text": "David actually encouraged\nme to talk more about sequencing errors\nand quality scores.",
    "start": "1488970",
    "end": "1495380"
  },
  {
    "text": "And I need to do a little\nbit more background. But I may add that a little\nbit later in the semester.",
    "start": "1495380",
    "end": "1503580"
  },
  {
    "text": "OK, so in Illumina\nsequencing, you add all four dNTPs\nat the same time.",
    "start": "1503580",
    "end": "1509180"
  },
  {
    "text": "But they're non-native. They have two major\nmodifications. So one is that they're\nthree prime blocked.",
    "start": "1509180",
    "end": "1516490"
  },
  {
    "text": "That means that\nthe OH is not free, I'll show the chemical\nstructure in a moment. So you can't extend\nmore than one base.",
    "start": "1516490",
    "end": "1522025"
  },
  {
    "text": "You incorporate that one\nbase, and the polymerase can't do anything more. And they're also tagged\nwith four different fluors.",
    "start": "1522025",
    "end": "1529670"
  },
  {
    "text": "So you add all\nfour dNTPs at once. You let the polymerase\nincorporate them. And then you image\nthe whole flow cell",
    "start": "1529670",
    "end": "1537690"
  },
  {
    "text": "using two lasers\nand two filters. So basically, to\nimage the four fluors. So you have to sort of take\nfour different pictures",
    "start": "1537690",
    "end": "1544220"
  },
  {
    "text": "of each portion of the flow\ncell and then the camera moves and you scan the whole cell.",
    "start": "1544220",
    "end": "1549360"
  },
  {
    "text": "And so then, those clusters that\nincorporated a C, let's say,",
    "start": "1549360",
    "end": "1555750"
  },
  {
    "text": "they will show up in the\ngreen channel as spots. And those incorporated\nin A, and so forth. So you basically have these\nclusters, each of them",
    "start": "1555750",
    "end": "1562659"
  },
  {
    "text": "represents a distinct\ntemplate, and you read one base at a time.",
    "start": "1562660",
    "end": "1568630"
  },
  {
    "text": "So, first you read the\nfirst base after the primer. So it's sequencing\ndownwards into the template.",
    "start": "1568630",
    "end": "1573990"
  },
  {
    "text": "And you read the\nfirst base so you know what the first base\nof all your clusters is. And then you reverse\nthe termination.",
    "start": "1573990",
    "end": "1580720"
  },
  {
    "text": "You cleave off\nthat chemical group that was blocking the 3-prime\nOH so now it can extend again.",
    "start": "1580720",
    "end": "1586150"
  },
  {
    "text": "And then you add the\nfour dNTPs again, do another round of extension,\nand then image again,",
    "start": "1586150",
    "end": "1591339"
  },
  {
    "text": "and so forth. And so it takes a little while. Each round of imaging\ntakes about an hour. So if you want to do 100 base\nsingle and Illumina sequencing,",
    "start": "1591339",
    "end": "1599560"
  },
  {
    "text": "it'll be running on the machine\nfor about four days or so. Plus the time you have to\nbuild the clusters, which",
    "start": "1599560",
    "end": "1605240"
  },
  {
    "text": "might be several hours\non the day before. ",
    "start": "1605240",
    "end": "1610330"
  },
  {
    "text": "So what is this? So actually the whole idea\nof blocking termination--",
    "start": "1610330",
    "end": "1615570"
  },
  {
    "text": "basically Sanger's idea--\nis carried over here in Illumina sequencing\nwith a little twist.",
    "start": "1615570",
    "end": "1621140"
  },
  {
    "text": "And that's that you can\nreverse the termination. So if you look down\nhere at the bottom, these are two different\n3-prime terminators.",
    "start": "1621140",
    "end": "1629029"
  },
  {
    "text": "Remember your base counting. Base one, two, three.",
    "start": "1629030",
    "end": "1634130"
  },
  {
    "text": "So this was the\n3-prime OH, now it's got this methyl [INAUDIBLE],\nor whatever that is.",
    "start": "1634130",
    "end": "1639740"
  },
  {
    "text": "I'm not much of a chemist,\nso you can look that one up. And then here's another version. And this is sort\nof chemistry that",
    "start": "1639740",
    "end": "1645816"
  },
  {
    "text": "can cleave this off\nwhen you're done. And then this whole thing\nhere, hanging off the base,",
    "start": "1645816",
    "end": "1651060"
  },
  {
    "text": "is the fluor. And you cleave that off as well.",
    "start": "1651060",
    "end": "1656460"
  },
  {
    "text": "So you add this big complicated\nthing, you image it, and then you cleave\noff the fluor and cleave off\nthe 3-prime block.",
    "start": "1656460",
    "end": "1663330"
  },
  {
    "text": " These are some actual\nsequencing images you would image in\nthe four channels.",
    "start": "1663330",
    "end": "1669560"
  },
  {
    "text": "They're actually\nblack and white. These are pseudocode. And then you can merge\nthose and you can see then",
    "start": "1669560",
    "end": "1676330"
  },
  {
    "text": "all the clusters\non the flow cell. So this is from a GA2 with\nthe recommended cluster",
    "start": "1676330",
    "end": "1682070"
  },
  {
    "text": "density back in the day,\nlike a few years ago. And nowadays, the image\nnow since the software has gotten a lot better,\nso you can actually",
    "start": "1682070",
    "end": "1688709"
  },
  {
    "text": "load the clusters more\ndensely and therefore get more sequence\nout of the same area.",
    "start": "1688709",
    "end": "1694787"
  },
  {
    "text": "But imagine just\nmillions and millions of these little\nclusters like this. Notice the clusters are\nnot all the same size.",
    "start": "1694787",
    "end": "1701570"
  },
  {
    "text": " Basically, you're\ndoing PCR in situ, and so some molecules are easier\nto amplify by PCR than others.",
    "start": "1701570",
    "end": "1710970"
  },
  {
    "text": "And that probably accounts\nfor these variations in size. ",
    "start": "1710970",
    "end": "1717429"
  },
  {
    "text": "So what is the\ncurrent throughput? These data are accurate as\nof about, maybe, last year.",
    "start": "1717430",
    "end": "1723860"
  },
  {
    "text": "So the HiSeq 2000 instrument\nis the most high performance, widely used instrument.",
    "start": "1723860",
    "end": "1729010"
  },
  {
    "text": "Now there's a 2500, but I\nthink it's roughly similar. You have one flow cell. So a flow cell looks sort\nof like a glass slide,",
    "start": "1729010",
    "end": "1735220"
  },
  {
    "text": "except that it has\nthese tunnels carved in it like eight little\ntubes inside the glass slide.",
    "start": "1735220",
    "end": "1741420"
  },
  {
    "text": "And on the surfaces\nof those tubes is where the adapters\nare covalently attached.",
    "start": "1741420",
    "end": "1750544"
  },
  {
    "text": "And so you have\neight lanes and so you can sequence eight different\nthings in those eight lanes. You could do yeast genome\nin one and fly RNA-seq",
    "start": "1750544",
    "end": "1760300"
  },
  {
    "text": "in another, and so forth. And these days, a single\nlane will produce something",
    "start": "1760300",
    "end": "1767850"
  },
  {
    "text": "like 200 million reads. And this is typically routine\nto get 200 million reads",
    "start": "1767850",
    "end": "1774250"
  },
  {
    "text": "from a lane. Sometimes you can get more. You can do up to 100 bases. You can do 150 these\ndays on a MiSeq,",
    "start": "1774250",
    "end": "1780419"
  },
  {
    "text": "which is a miniature version. You can do maybe 300 or more.",
    "start": "1780420",
    "end": "1786000"
  },
  {
    "text": "And so that's a whole\nlot of sequence. So that's 160 billion bases of\nsequence from a single lane.",
    "start": "1786000",
    "end": "1793510"
  },
  {
    "text": "And that will cost you-- that\nsingle lane-- maybe $2,000 to $3,000, depending\nwhere you're doing it.",
    "start": "1793510",
    "end": "1799870"
  },
  {
    "text": "And the cost doesn't\ninclude the capital cost, that's just the reagent\ncost for running that.",
    "start": "1799870",
    "end": "1805920"
  },
  {
    "text": "So 160 billion-- the\nhuman genome is 3 billion,",
    "start": "1805920",
    "end": "1811240"
  },
  {
    "text": "so you've now sequenced the\nhuman genome over many times there.",
    "start": "1811240",
    "end": "1816440"
  },
  {
    "text": "You can do more. So you can do\npaired-end sequencing, where you sequence both\nends of your template. And that'll basically double\nthe amount of sequence you get.",
    "start": "1816440",
    "end": "1824224"
  },
  {
    "text": "And you can also,\non this machine, do two flow cells at once. So you can actually\ndouble it beyond that. And so for many applications,\n160 billion bases is overkill.",
    "start": "1824224",
    "end": "1833796"
  },
  {
    "text": "It's more than you need. Imagine you're doing\nbacterial genome sequencing. Bacterial genome might\nbe five megabases or so.",
    "start": "1833796",
    "end": "1839150"
  },
  {
    "text": "This is complete overkill. So you can do bar coding\nwhere you add little six",
    "start": "1839150",
    "end": "1845090"
  },
  {
    "text": "base tags to\ndifferent libraries,",
    "start": "1845090",
    "end": "1850720"
  },
  {
    "text": "and then mix them together,\nintroduce them to the machine, sequence the tags\nfirst or second,",
    "start": "1850720",
    "end": "1856370"
  },
  {
    "text": "and then sequence the templates. And then you effectively\nsort them out later. And then do many\nsamples in one lane.",
    "start": "1856370",
    "end": "1865280"
  },
  {
    "text": "And that's what people\nmost commonly do. ",
    "start": "1865280",
    "end": "1871590"
  },
  {
    "text": "So, questions about\nnext-gen sequencing? There's a lot more to learn. I'm happy to talk about it more. It's very relevant\nto this class.",
    "start": "1871590",
    "end": "1878169"
  },
  {
    "text": "But I'm sure it'll come up\nlater in David's sections, so I don't want to take\ntoo much time on it.",
    "start": "1878170",
    "end": "1883610"
  },
  {
    "start": "1883610",
    "end": "1889960"
  },
  {
    "text": "So, now once you generate\nreads from an Illumina instrument or some\nother instrument,",
    "start": "1889960",
    "end": "1896570"
  },
  {
    "text": "you'll want to align\nthem to the genome to determine, for\nexample, if you're doing RNA-seq mapping\nreads that come from mRNA,",
    "start": "1896570",
    "end": "1904590"
  },
  {
    "text": "you'll want to know what\ngenes they came from. So you need to map those\nreads back to the genome.",
    "start": "1904590",
    "end": "1910900"
  },
  {
    "text": "What are some other reasons you\nmight want to align sequences? Just in general, why\nis aligning sequences--",
    "start": "1910900",
    "end": "1917950"
  },
  {
    "text": "meaning, matching them up\nand finding individual bases",
    "start": "1917950",
    "end": "1923220"
  },
  {
    "text": "or amino acid residues that\nmatch-- why is that useful? Diego? AUDIENCE: You can\nassemble them if you want.",
    "start": "1923220",
    "end": "1929150"
  },
  {
    "text": "PROFESSOR: You\ncan assemble them? Yes. So if you're doing\ngenome sequencing, if you align them to\neach other and you find a whole stack that\nsort of align this way,",
    "start": "1929150",
    "end": "1936570"
  },
  {
    "text": "you can then assemble\nand infer the existence of a longer sequence. That's a good point.",
    "start": "1936570",
    "end": "1941880"
  },
  {
    "text": "Yes, your name? AUDIENCE: Julianne. Looking at homologs. PROFESSOR: Looking at homologs. Right.",
    "start": "1941880",
    "end": "1947200"
  },
  {
    "text": "So if you, for example, are\ndoing disease gene mapping, you've identified a human\ngene of unknown function",
    "start": "1947200",
    "end": "1955149"
  },
  {
    "text": "that's associated\nwith a disease. Then you might want to search\nit against, say, the mouse",
    "start": "1955150",
    "end": "1961580"
  },
  {
    "text": "database and find\na homolog in mouse and then that might be what you\nwould want to study further.",
    "start": "1961580",
    "end": "1968422"
  },
  {
    "text": "You might want to then\nknock it out in mouse or mutate it or something. So those are some good reasons.",
    "start": "1968422",
    "end": "1974570"
  },
  {
    "text": "There's others. So we're going to first talk\nabout local alignment, which is a type of alignment\nwhere you want",
    "start": "1974570",
    "end": "1981110"
  },
  {
    "text": "to find shorter stretches\nof high similarity. You don't require alignment\nof the entire sequence.",
    "start": "1981110",
    "end": "1988980"
  },
  {
    "text": " So there are certain\nsituations where",
    "start": "1988980",
    "end": "1995767"
  },
  {
    "text": "you might want to do that. So here's an example. You are studying a recently\ndiscovered human non-coding",
    "start": "1995767",
    "end": "2002020"
  },
  {
    "text": "RNA. As you can see, it's 45 bases. You want to see if\nthere's a mouse homolog.",
    "start": "2002020",
    "end": "2009250"
  },
  {
    "text": "You run it through NCBI\nBLAST, which as we said is sort of the Google search\nengine of mathematics--",
    "start": "2009250",
    "end": "2015050"
  },
  {
    "text": "and you're going get a chance\nto do it on pump set one, and you get a hit\nthat looks like this.",
    "start": "2015050",
    "end": "2022120"
  },
  {
    "text": "So notice, this is\nsort of BLAST notation. It says Q at the top. Q is for \"query,\" that's\nthe sequence you put in.",
    "start": "2022120",
    "end": "2028800"
  },
  {
    "text": "S is \"subject,\"\nthat's the database you were searching against. You have coordinates,\nso 1 to 45.",
    "start": "2028800",
    "end": "2034480"
  },
  {
    "text": "And then, in the subject, it\nhappened to be base 403 to 447 in some mouse\nchromosome or something.",
    "start": "2034480",
    "end": "2040440"
  },
  {
    "text": "And you can see that\nit's got some matching. But it also has some mismatches.",
    "start": "2040440",
    "end": "2045530"
  },
  {
    "text": "So in all, there are 40\nmatches and five mismatches in the alignment.",
    "start": "2045530",
    "end": "2051129"
  },
  {
    "text": "So is that significant?  Remember, the mouse genome\nis 2.7 billion bases long.",
    "start": "2051130",
    "end": "2058750"
  },
  {
    "text": "It's big. So would you get a match\nthis good by chance? ",
    "start": "2058750",
    "end": "2065569"
  },
  {
    "text": "So the question is really,\nshould you trust this? Is this something you\ncan confidently say,",
    "start": "2065570",
    "end": "2070980"
  },
  {
    "text": "yes mouse is a\nhomolog, and that's it? Or should you just\nbe like, well,",
    "start": "2070980",
    "end": "2076169"
  },
  {
    "text": "that's not better\nthan I get by chance so I have no\nevidence of anything? Or is it sort of\nsomewhere in between?",
    "start": "2076170",
    "end": "2082370"
  },
  {
    "text": "And how would you tell? Yeah, what's your name?",
    "start": "2082370",
    "end": "2087700"
  },
  {
    "text": "AUDIENCE: Chris. You would want to\nfigure out a scoring function for the alignment.",
    "start": "2087701",
    "end": "2093593"
  },
  {
    "text": "And then, with that\nscoring function, you would find whether or not\nyou have a significant match.",
    "start": "2093593",
    "end": "2099607"
  },
  {
    "text": "PROFESSOR: OK. So Chris says you want to\ndefine a scoring system and then use the\nscoring system to define",
    "start": "2099607",
    "end": "2105430"
  },
  {
    "text": "statistical significance. Do want to suggest\na scoring system? ",
    "start": "2105430",
    "end": "2112369"
  },
  {
    "text": "What's the simplest\none you can think of? AUDIENCE: Just if there's a\nmatch, you add a certain score.",
    "start": "2112370",
    "end": "2120460"
  },
  {
    "text": "If it's a mismatch, you\nsubtract a certain score. PROFESSOR: So let's do\nthat scoring system.",
    "start": "2120460",
    "end": "2127440"
  },
  {
    "text": " So the notation that's\noften used is Sii.",
    "start": "2127440",
    "end": "2134520"
  },
  {
    "text": "So that would be a match\nbetween nucleotide i and then another\ncopy of nucleotide i. We'll call that 1,\nplus 1 for a match.",
    "start": "2134520",
    "end": "2141890"
  },
  {
    "text": "And sij, where i\nand j are different, we'll give that\na negative score.",
    "start": "2141890",
    "end": "2147570"
  },
  {
    "text": "Minus 1. So this is i not equal to j. So that's a scoring matrix.",
    "start": "2147570",
    "end": "2154630"
  },
  {
    "text": "It's a four by four matrix\nwith 1 on the diagonal and minus 1 everywhere else.",
    "start": "2154630",
    "end": "2160539"
  },
  {
    "text": "And this is commonly\nused for DNA. And then there's a\nfew other variations on this that are also used.",
    "start": "2160540",
    "end": "2167600"
  },
  {
    "text": "So good, a scoring system. So then, how are we going\nto do the statistics? Any ideas? How do we know\nwhat's significant?",
    "start": "2167600",
    "end": "2173585"
  },
  {
    "start": "2173585",
    "end": "2180435"
  },
  {
    "text": "AUDIENCE: The higher\nscore would probably be a little more significant\nthan a lower score.",
    "start": "2180435",
    "end": "2188156"
  },
  {
    "text": "But the scale, I'm not sure-- PROFESSOR: The scale\nis not so obvious. Yes, question? AUDIENCE: My name is Andrea.",
    "start": "2188156",
    "end": "2193664"
  },
  {
    "text": "So if you shuffled the RNA,\nlike permute the sequence, then we'll get the\n[INAUDIBLE] genome",
    "start": "2193664",
    "end": "2199814"
  },
  {
    "text": "you get with that\nshuffled sequence. And the score is about\nthe same as you'd get with the non-shuffled\nsequence [INAUDIBLE]",
    "start": "2199814",
    "end": "2206948"
  },
  {
    "text": "about very significant scores. PROFESSOR: Yeah, so\nthat's a good idea. BLAST, as it turns\nout-- is pretty fast.",
    "start": "2206948",
    "end": "2212940"
  },
  {
    "text": "So you could shuffle\nyour RNA molecule, randomly permute the\nnucleotides many times, maybe even like\n1,000 times, search",
    "start": "2212940",
    "end": "2219190"
  },
  {
    "text": "each one against\nthe mouse genome, and get a distribution\nof what's the best score-- the top score-- that\nyou get against a genome,",
    "start": "2219190",
    "end": "2225505"
  },
  {
    "text": "look at that\ndistribution and say whether the score\nof the actual one is significantly higher\nthan that distribution",
    "start": "2225505",
    "end": "2230559"
  },
  {
    "text": "or just falls in the\nmiddle of that somewhere. And that's reasonable.",
    "start": "2230560",
    "end": "2235680"
  },
  {
    "text": "You can certainly do that, and\nit's not a bad thing to do. But it turns out there is\nan analytical theory here that you can use.",
    "start": "2235680",
    "end": "2241720"
  },
  {
    "text": "And so that you can determine\nsignificance more quickly without doing so\nmuch computation.",
    "start": "2241720",
    "end": "2248910"
  },
  {
    "text": "And that's what\nwe'll talk about. But another issue, before\nwe get to the statistics, is how do you actually\nfind that alignment?",
    "start": "2248910",
    "end": "2255280"
  },
  {
    "text": "How do you find the top scoring\nmatch in a mouse genome? So let's suppose\nthis guy is your RNA.",
    "start": "2255280",
    "end": "2263829"
  },
  {
    "text": "OK, of course, we're\nusing T's, but that's just because you usually\nsequences it at the DNA level.",
    "start": "2263830",
    "end": "2268990"
  },
  {
    "text": "But imagine this is your RNA. It's very short. This is like 10 or so, I think.",
    "start": "2268990",
    "end": "2274390"
  },
  {
    "text": "And this is your database. But it goes on a\nfew billion more.",
    "start": "2274390",
    "end": "2281490"
  },
  {
    "text": "Several more blackboards. And I want to come up\nwith an algorithm that",
    "start": "2281490",
    "end": "2288410"
  },
  {
    "text": "will find the highest scoring\nsegment of this query sequence against this database.",
    "start": "2288410",
    "end": "2297520"
  },
  {
    "text": "Any ideas? So this would be like\nour first algorithm. And it's not terribly\nhard, so that's",
    "start": "2297520",
    "end": "2305640"
  },
  {
    "text": "why it's a good\none to start with. Not totally obvious either. Who can think of an algorithm\nor something, some operation",
    "start": "2305640",
    "end": "2313200"
  },
  {
    "text": "that we can do on\nthis sequence compared to this sequence--\nin some way-- that will help us find the\nhighest scoring match?",
    "start": "2313200",
    "end": "2321270"
  },
  {
    "text": " I'm sorry. Yeah?",
    "start": "2321270",
    "end": "2326427"
  },
  {
    "text": "AUDIENCE: You have to consider\ninsertion and deletion. PROFESSOR: Yeah, OK. So we're going to\nkeep it simple.",
    "start": "2326427",
    "end": "2332210"
  },
  {
    "text": "That's true, in general. But we're going\nto keep it simple and just say no\ninsertions and deletions.",
    "start": "2332210",
    "end": "2337390"
  },
  {
    "text": "So we're going to look for\nan ungapped local alignment. So that's the\nalgorithm that I want.",
    "start": "2337390",
    "end": "2343480"
  },
  {
    "text": "First, no gaps. And then we'll do\ngaps on Tuesday. Tim?",
    "start": "2343480",
    "end": "2348920"
  },
  {
    "text": "AUDIENCE: You could just\ncompare your [INAUDIBLE] to [INAUDIBLE] all\nacross the database",
    "start": "2348920",
    "end": "2356270"
  },
  {
    "text": "and turn off all the\n[INAUDIBLE] on that [INAUDIBLE], and then figure out [INAUDIBLE].",
    "start": "2356270",
    "end": "2363520"
  },
  {
    "text": "PROFESSOR: Yeah, OK. Pretty much. I mean, that's\npretty much right.",
    "start": "2363520",
    "end": "2369920"
  },
  {
    "text": "Although it's not quite as\nmuch of a description as you would need if you want\nto actually code that.",
    "start": "2369920",
    "end": "2375049"
  },
  {
    "text": "Like, how would you\nactually do that? So, I want a\ndescription that is sort of more at the\nlevel of pseudocode.",
    "start": "2375049",
    "end": "2380730"
  },
  {
    "text": "Like, here's how you would\nactually organize your code. So, let's say you\nentertain the hypothesis",
    "start": "2380730",
    "end": "2388559"
  },
  {
    "text": "that the alignment can be\nin different registers.",
    "start": "2388560",
    "end": "2393690"
  },
  {
    "text": "The alignment can correspond to\nbase one of the query and base one of the subject.",
    "start": "2393690",
    "end": "2399820"
  },
  {
    "text": "Or it could be shifted. It could be an alignment\nwhere base 1 of the query matches these two, and so forth.",
    "start": "2399820",
    "end": "2405576"
  },
  {
    "text": "So there's sort of\ndifferent registers. So let's just consider\none register first. The one where base 1 matches.",
    "start": "2405576",
    "end": "2411610"
  },
  {
    "text": "So let's just look\nat the matches between corresponding bases. I'm just going to make these\nlittle angle bracket guys here.",
    "start": "2411610",
    "end": "2422150"
  },
  {
    "text": "Hopefully I won't\nmake any mistakes. ",
    "start": "2422150",
    "end": "2428680"
  },
  {
    "text": "I'm going to take this. This is sort of implementing\nTim's idea here. And then I'm going to\nlook for each of these--",
    "start": "2428680",
    "end": "2434849"
  },
  {
    "text": "so consider it going down here. Now we're sort of looking\nat an alignment here. Is this a match or a mismatch?",
    "start": "2434850",
    "end": "2442000"
  },
  {
    "text": "That's a mismatch. That's a match. That's a mismatch. That's a mismatch.",
    "start": "2442000",
    "end": "2447790"
  },
  {
    "text": "That's a match. Match Match.",
    "start": "2447790",
    "end": "2453020"
  },
  {
    "text": "Mismatch. Mismatch. Mismatch. So where is the\ntop scoring match",
    "start": "2453020",
    "end": "2461670"
  },
  {
    "text": "between the query\nand the subject? Tim? ",
    "start": "2461670",
    "end": "2471770"
  },
  {
    "text": "Anyone?  AUDIENCE: 6, 7, 8. PROFESSOR: 6, 7, 8.",
    "start": "2471770",
    "end": "2477170"
  },
  {
    "text": "Good. Oh-- AUDIENCE: 5, 6, 7. PROFESSOR: 5, 6, 7. Right. Right here.",
    "start": "2477170",
    "end": "2482869"
  },
  {
    "text": "You can see there's\nthree in a row. Well, what about this? Why can't we add\nthis to the match?",
    "start": "2482870",
    "end": "2488900"
  },
  {
    "text": " What's the reason why\nit's not 2, 3, 4, 5, 6, 7?",
    "start": "2488900",
    "end": "2496510"
  },
  {
    "text": " AUDIENCE: Because the\nscore for that is lower.",
    "start": "2496510",
    "end": "2502289"
  },
  {
    "text": "PROFESSOR: Because the\nscore for that is lower. Right. We defined top scoring segment. You sum up the scores\nacross the map. So you can have\nmismatches in there,",
    "start": "2502290",
    "end": "2508810"
  },
  {
    "text": "but this will have a score of 3. And if you wanted to\nadd these three bases,",
    "start": "2508810",
    "end": "2516550"
  },
  {
    "text": "you would be adding\nnegative 2 and plus 1, so it would reduce your score. So that would be worse.",
    "start": "2516550",
    "end": "2522340"
  },
  {
    "text": "Any ideas on how to do this in\nan automatic, algorithmic way? ",
    "start": "2522340",
    "end": "2530191"
  },
  {
    "text": "Yeah? What's your name? AUDIENCE: Simon. So if you keep shifting the\nentire database, [INAUDIBLE].",
    "start": "2530191",
    "end": "2538619"
  },
  {
    "text": "PROFESSOR: OK so you\nkeep shifting it over, and you generate\none of these lines.",
    "start": "2538620",
    "end": "2544050"
  },
  {
    "text": "But imagine my query was\nlike 1,000 or something. And my database\nis like a billion.",
    "start": "2544050",
    "end": "2549500"
  },
  {
    "text": " How do I look along here? And here it was obvious what\nthe top scoring match is.",
    "start": "2549500",
    "end": "2557000"
  },
  {
    "text": "But if I had two\nmatches here, then we",
    "start": "2557000",
    "end": "2563760"
  },
  {
    "text": "would've actually had\na longer match here. So in general, how do I\nfind that that top match?",
    "start": "2563760",
    "end": "2574610"
  },
  {
    "text": "For each of those\nregisters, if you will, you'll have a thousand\nlong diagonal here",
    "start": "2574610",
    "end": "2583240"
  },
  {
    "text": "with 1's and minus 1's on it. How do I process those scores\nto find the top scoring segment?",
    "start": "2583240",
    "end": "2590495"
  },
  {
    "start": "2590495",
    "end": "2596409"
  },
  {
    "text": "What's an algorithm to do that? ",
    "start": "2596409",
    "end": "2606916"
  },
  {
    "text": "It's kind of\nintuitively obvious, but I want to do something\nwith, you define a variable and you update it, and you\nadd to it, and subtract.",
    "start": "2606916",
    "end": "2614597"
  },
  {
    "text": "Something like that. But, like a computer\ncould actually handle. ",
    "start": "2614597",
    "end": "2621001"
  },
  {
    "text": "Yeah? What was your name? Julianne? AUDIENCE: Could you keep track\nof what the highest total",
    "start": "2621001",
    "end": "2627245"
  },
  {
    "text": "score is, and then you keep\ngoing down the diagonal, And then you update it?",
    "start": "2627246",
    "end": "2633197"
  },
  {
    "text": "PROFESSOR: OK. You keep track of what the\nhighest total score was?",
    "start": "2633197",
    "end": "2638262"
  },
  {
    "text": "AUDIENCE: Yeah. The highest test score. PROFESSOR: The\nhighest segment score?",
    "start": "2638262",
    "end": "2643320"
  },
  {
    "text": "OK. I'm going to put this up here. And we'll define max s.",
    "start": "2643320",
    "end": "2654240"
  },
  {
    "text": "That's the highest segment\nscore we've achieved to date. And we'll initialize\nthat to zero, let's say.",
    "start": "2654240",
    "end": "2661404"
  },
  {
    "text": "Because if you had\nall mismatches, zero would be the\ncorrect answer. If your query was A's\nand your subject was T's.",
    "start": "2661404",
    "end": "2668320"
  },
  {
    "text": "And then what do you do? AUDIENCE: As you go down the\ndiagonal, you keep track of--",
    "start": "2668320",
    "end": "2677126"
  },
  {
    "text": "PROFESSOR: Keep track of what? AUDIENCE: So you\nlook at 1 in 1 first.",
    "start": "2677126",
    "end": "2685609"
  },
  {
    "text": "And then you go 1 in 2, and\nyou find a score of zero. But that's higher\nthan negative 1. ",
    "start": "2685609",
    "end": "2694110"
  },
  {
    "text": "PROFESSOR: But the score of the\nmaximum segment at that point, after base 2, is not zero.",
    "start": "2694110",
    "end": "2699869"
  },
  {
    "text": "It's actually 1. Because you could have a\nsegment of one base alignment.",
    "start": "2699870",
    "end": "2705732"
  },
  {
    "text": "The cumulative score is zero.  I think you're onto something\nhere that may be also",
    "start": "2705732",
    "end": "2711230"
  },
  {
    "text": "something useful\nto keep track of. Let's do the cumulative score\nand then you tell me more.",
    "start": "2711230",
    "end": "2718279"
  },
  {
    "text": "We'll define cumulative\nscore variable. We'll initialize that to zero. And then we'll have some for\nloops that, as some of you",
    "start": "2718280",
    "end": "2726130"
  },
  {
    "text": "have said, you want to\nloop through the subject. All the possible\nregisters of the subject.",
    "start": "2726131",
    "end": "2733120"
  },
  {
    "text": "So that would be\nmaybe j equals 1 to subject length\nminus query length.",
    "start": "2733120",
    "end": "2739550"
  },
  {
    "text": "Something like that. Don't worry too much about this. Again, this is not\nreal code, obviously. It's pseudocode.",
    "start": "2739550",
    "end": "2744960"
  },
  {
    "text": "So then this will be,\nsay, 1 to query language. And so this will be\ngoing along our diagonal.",
    "start": "2744960",
    "end": "2750255"
  },
  {
    "text": "And we're going to plot\nthe cumulative score.  So here you would you have an\nupdate where cumulative score",
    "start": "2750255",
    "end": "2759250"
  },
  {
    "text": "plus equals the score\nof query position",
    "start": "2759250",
    "end": "2767760"
  },
  {
    "text": "i matched against\nsubject position j.",
    "start": "2767760",
    "end": "2773714"
  },
  {
    "text": "And update that. So that's just cumulative score. So what will it look like? So in this case, I'll\njust use this down here.",
    "start": "2773714",
    "end": "2779350"
  },
  {
    "start": "2779350",
    "end": "2786360"
  },
  {
    "text": "So you have zero, 1,\n2, minus 1, minus 2.",
    "start": "2786360",
    "end": "2795390"
  },
  {
    "text": "So you'll start at position\nzero in the sequence. At position 1 you're\ndown here at minus 1",
    "start": "2795390",
    "end": "2803400"
  },
  {
    "text": "because it was a mismatch. Then at position 2, as you\nsaid, we're back up to zero.",
    "start": "2803400",
    "end": "2809550"
  },
  {
    "text": "And then what happens? Go down to minus\n1, down to minus 2. Then we go up three times in a\nrow until we're up here to 1.",
    "start": "2809550",
    "end": "2822719"
  },
  {
    "text": "And then we go down after that.  So where is your highest scoring\nmatch in this cumulative score",
    "start": "2822719",
    "end": "2831779"
  },
  {
    "text": "plot?  People said it was from 5 to 7.",
    "start": "2831780",
    "end": "2837610"
  },
  {
    "text": "Yeah, question? AUDIENCE: So would it be\nfrom like a local minimum to a local maximum? PROFESSOR: Yeah.",
    "start": "2837610",
    "end": "2843330"
  },
  {
    "text": "Exactly. So, what do you want\nto keep track of? AUDIENCE: You want to keep track\nof the minimum and the maximum.",
    "start": "2843330",
    "end": "2849916"
  },
  {
    "text": "And look for the range which\nyou maximize to different-- PROFESSOR: Yeah, so\nthis is now sort of more",
    "start": "2849916",
    "end": "2857111"
  },
  {
    "text": "what I was looking\nfor in terms of-- so this was the local minimum,\nand that's the local maximum.",
    "start": "2857111",
    "end": "2863100"
  },
  {
    "text": "This is the score. That's your mass s there. And you also want to keep\ntrack of where that happened",
    "start": "2863100",
    "end": "2870910"
  },
  {
    "text": "in both the query\nand the subject. Does that make sense? So you would keep track of\nthis running cumulative score",
    "start": "2870910",
    "end": "2876339"
  },
  {
    "text": "variable. You keep track of\nthe last minimum.",
    "start": "2876340",
    "end": "2881920"
  },
  {
    "text": "The minimum that\nyou've achieved so far. And so that would then\nbe down here to minus 2.",
    "start": "2881920",
    "end": "2897650"
  },
  {
    "text": "And then when your cumulative\nscore got up to plus 1, you always take that\ncumulative score,",
    "start": "2897650",
    "end": "2902760"
  },
  {
    "text": "minus the last minimum\ncumulative score. That gives you a\npotential candidate",
    "start": "2902760",
    "end": "2908230"
  },
  {
    "text": "for a high scoring segment. And if that is bigger than\nyour current max high scoring segment, then you update it\nand you would update this.",
    "start": "2908230",
    "end": "2916107"
  },
  {
    "text": "And then you would\nalso have variables that would store where you are.",
    "start": "2916107",
    "end": "2921210"
  },
  {
    "text": "And also, where did\nthat last minimum occur. So I'm not spelling it all out. I'm not going to give\nyou all the variables.",
    "start": "2921210",
    "end": "2927543"
  },
  {
    "text": "But this is an algorithm that\nwould find the maximum score. Yeah, question? AUDIENCE: So you're\nkeeping track",
    "start": "2927543",
    "end": "2933745"
  },
  {
    "text": "of the global maximum,\nlocal minimum, so that you can accept the most\nrecent local minimum following",
    "start": "2933745",
    "end": "2940530"
  },
  {
    "text": "the global maximum? PROFESSOR: I'm not\nsure I got all that. But you're keeping track\nof the cumulative score.",
    "start": "2940530",
    "end": "2947800"
  },
  {
    "text": "The minimum that that\ncumulative score ever got to. And the maximum\ndifference, the maximum",
    "start": "2947800",
    "end": "2957556"
  },
  {
    "text": "that you ever in the\npast have gone up. Where you've had a\nnet increment upwards.",
    "start": "2957556",
    "end": "2967060"
  },
  {
    "text": "Like here. So this variable\nhere, this max s, it would be initialized to zero. When you got to here, your last\nminimum score would be minus 1.",
    "start": "2967060",
    "end": "2976780"
  },
  {
    "text": "Your cumulative\nscore would be zero. You would take the difference\nof those, and you'd be like, oh I've got a high scoring\nsegment of score one.",
    "start": "2976780",
    "end": "2983204"
  },
  {
    "text": "So I'm going to update that. So now, that variable\nis now 1 at this point.",
    "start": "2983204",
    "end": "2988690"
  },
  {
    "text": "Then you're going down, so\nyou're not getting anything. You're just lowering this\nminimum cumulative score down to minus 2 here.",
    "start": "2988690",
    "end": "2995070"
  },
  {
    "text": "And then when you\nget to here, now you check the cumulative score\nminus the last minimum.",
    "start": "2995070",
    "end": "3000140"
  },
  {
    "text": "It's 1. That's a tie. We won't keep track of ties. Now at here, that\ndifference is 2.",
    "start": "3000140",
    "end": "3007820"
  },
  {
    "text": "So now we've got a new record. So now we update this maximum\nscore to 2 in the locations.",
    "start": "3007820",
    "end": "3014089"
  },
  {
    "text": "And then we get here, now\nit's 3, and we update that. Does that make sense? AUDIENCE: Imagine the first\ndip-- instead of going down",
    "start": "3014090",
    "end": "3020116"
  },
  {
    "text": "to negative 1, it went\ndown to negative 3. PROFESSOR: Negative 3? AUDIENCE: That first dip.",
    "start": "3020116",
    "end": "3025284"
  },
  {
    "text": "PROFESSOR: Right here? So we started back a little bit. So back here, like this? AUDIENCE: No.",
    "start": "3025284",
    "end": "3031250"
  },
  {
    "text": "PROFESSOR: Down to negative 3? AUDIENCE: No. PROFESSOR: But how do\nwe get to negative 3? Because our scoring is this way.",
    "start": "3031250",
    "end": "3036970"
  },
  {
    "text": "You want this dip to minus 3? AUDIENCE: No PROFESSOR: This one minus 3? Imagine we are at minus 3 here?",
    "start": "3036970",
    "end": "3042367"
  },
  {
    "text": "AUDIENCE: Yeah. Imagine it dipped to minus 3. And then the next one dipped to\nhigher than that, to minus 2.",
    "start": "3042367",
    "end": "3049770"
  },
  {
    "text": "And then it went up to 1. And so, would the difference\nyou look at be negative 2 to 1, or negative 3 to 1?",
    "start": "3049770",
    "end": "3056099"
  },
  {
    "text": "PROFESSOR: Like that, right? So, minus 3, let's\nsay, minus 2, 1.",
    "start": "3056100",
    "end": "3062250"
  },
  {
    "text": "Something like that. What do people think? Anyone want to--? AUDIENCE: Minus 3 to 1.",
    "start": "3062250",
    "end": "3068480"
  },
  {
    "text": "PROFESSOR: Minus 3 to 1. It's the minimum\nthat you ever got to. This might be a stronger match,\nbut this is a higher scoring",
    "start": "3068480",
    "end": "3076120"
  },
  {
    "text": "match. And we said we want\nhigher scoring. So you would count that.",
    "start": "3076120",
    "end": "3081716"
  },
  {
    "text": "AUDIENCE: So you keep track\nof both the global minimum and the global\nmaximum, and you take the difference between them.",
    "start": "3081716",
    "end": "3087322"
  },
  {
    "text": "PROFESSOR: You keep track\nof the global minimum and the current\ncumulative score, and you take the difference. ",
    "start": "3087322",
    "end": "3095186"
  },
  {
    "text": "AUDIENCE: The global maximum-- PROFESSOR: It's not\nnecessarily global maximum",
    "start": "3095186",
    "end": "3100210"
  },
  {
    "text": "because we could be\nwell below zero here. We could do like this. ",
    "start": "3100210",
    "end": "3109549"
  },
  {
    "text": "From here to here. So this is not the\nglobal maximum. This just happens\nto be, we went up",
    "start": "3109550",
    "end": "3117270"
  },
  {
    "text": "a lot since our last minimum. So that's your high\nscoring segment. Does that make sense?",
    "start": "3117270",
    "end": "3122582"
  },
  {
    "text": " I haven't completely\nspelled it out. But I think you guys have given\nenough ideas here that there;s",
    "start": "3122582",
    "end": "3132300"
  },
  {
    "text": "sort of the core\nof an algorithm. And I encourage you to think\nthis through afterwards",
    "start": "3132300",
    "end": "3141230"
  },
  {
    "text": "and let me know if\nthere are questions. And we could add an\noptional homework",
    "start": "3141230",
    "end": "3147700"
  },
  {
    "text": "where I ask you to do\nthis, that we've sometimes had in the past. It is a useful thing to look at.",
    "start": "3147700",
    "end": "3153090"
  },
  {
    "text": "This is not exactly how\nthe BLAST algorithm works. It uses some tricks\nfor faster speed.",
    "start": "3153090",
    "end": "3158330"
  },
  {
    "text": "But this is sort of\nmorally equivalent to BLAST in the sense that it has the\nsame order of magnitude running",
    "start": "3158330",
    "end": "3166339"
  },
  {
    "text": "time. So this algorithm-- what is the\nrunning time in Big-O notation?",
    "start": "3166340",
    "end": "3174960"
  },
  {
    "text": "So just for those who\nare non-CS people, when you use this Big-O notation,\nthen you're asking,",
    "start": "3174960",
    "end": "3182840"
  },
  {
    "text": "how does the running\ntime increase in the size of the input? And so what is the input?",
    "start": "3182840",
    "end": "3188870"
  },
  {
    "text": "So we have two inputs. We have a query of length.",
    "start": "3188870",
    "end": "3194069"
  },
  {
    "text": "And let's say\nsubject of length n. So clearly, if those are bigger,\nit'll take longer to run.",
    "start": "3194070",
    "end": "3201171"
  },
  {
    "text": "But when you compare\ndifferent algorithms, you want to know how the run\ntime depends on those lengths.",
    "start": "3201171",
    "end": "3206971"
  },
  {
    "text": "Yes. What's your name? AUDIENCE: Sally. m times n. PROFESSOR: So with\nthis, this is what",
    "start": "3206971",
    "end": "3213050"
  },
  {
    "text": "you would call an\norder mn algorithm. And why is that? How can you see that?",
    "start": "3213050",
    "end": "3218220"
  },
  {
    "text": "AUDIENCE: You have two for\nloops And for each length, essentially, you're\ngoing through everything in the query.",
    "start": "3218220",
    "end": "3225094"
  },
  {
    "text": "And then, for everything that\nyou go through in the query, you would [INAUDIBLE]. ",
    "start": "3225094",
    "end": "3232970"
  },
  {
    "text": "PROFESSOR: Right. In this second for loop here,\nyou're going through the query.",
    "start": "3232970",
    "end": "3239800"
  },
  {
    "text": "And you're doing that\nnested inside of a for loop that's basically the\nlength of the subject.",
    "start": "3239800",
    "end": "3245111"
  },
  {
    "text": "And eventually\nyou're going to have to compare every\nbase in the query to every base in the subject. There's no way around that.",
    "start": "3245112",
    "end": "3250420"
  },
  {
    "text": "And that takes\nsome unit of time. And so the actual time will\nbe proportional to that.",
    "start": "3250420",
    "end": "3255900"
  },
  {
    "text": "So the bigger n gets\nand m gets, it's just proportional\nto the product. Does that make sense?",
    "start": "3255900",
    "end": "3261460"
  },
  {
    "text": "Or another way to\nthink about it is, you're clearly going to have to\ndo something on this diagonal.",
    "start": "3261460",
    "end": "3266594"
  },
  {
    "text": "And then you're going\nto have to do something on this diagonal, and\nthis one, and this one. And actually, you have to\nalso check these ones here.",
    "start": "3266594",
    "end": "3274280"
  },
  {
    "text": "And in the end, the total\nnumber of computations",
    "start": "3274280",
    "end": "3279380"
  },
  {
    "text": "there is going to\nbe this times that. You're basically doing\na rectangle's worth of computations.",
    "start": "3279380",
    "end": "3285606"
  },
  {
    "text": "Does that makes sense? So that's not bad, right? It could be worse.",
    "start": "3285606",
    "end": "3290940"
  },
  {
    "text": "It could be, like, mn squared\nor something like that. ",
    "start": "3290940",
    "end": "3297550"
  },
  {
    "text": "So that's basically\nwhy BLAST is fast. So what do these things\nlook like, in general?",
    "start": "3297550",
    "end": "3303190"
  },
  {
    "text": "And what is the condition on\nour score for this algorithm to work? ",
    "start": "3303190",
    "end": "3312460"
  },
  {
    "text": "What if I gave a score\nof plus 1 for a match, and zero for a mismatch?",
    "start": "3312460",
    "end": "3317820"
  },
  {
    "text": "Could we do this? Joe, you're shaking your head. AUDIENCE: It would\njust be going up.",
    "start": "3317820",
    "end": "3323490"
  },
  {
    "text": "PROFESSOR: Yeah. The problem is, it might\nbe flat for a while, but eventually it would go up. And it would just\ngo up and up and up.",
    "start": "3323490",
    "end": "3329143"
  },
  {
    "text": "And so your highest\nscoring segment would, most of the\ntime, be something that started very\nnear the beginning and ended very near the end.",
    "start": "3329143",
    "end": "3336720"
  },
  {
    "text": "So that doesn't work. So you have to have\na net negative drift. And the way that's formalized\nis the expected score",
    "start": "3336720",
    "end": "3342140"
  },
  {
    "text": "has to be negative. So why is the expected score\nnegative in this scoring system that has plus 1 for a match,\nand minus 1 for a mismatch?",
    "start": "3342140",
    "end": "3350379"
  },
  {
    "text": "Why does that work?  AUDIENCE: It should be wrong\nthree quarters of the time.",
    "start": "3350379",
    "end": "3356840"
  },
  {
    "text": "PROFESSOR: Yeah. You'll have a mismatch\nthree quarters of the time. So on average, you\ntend to drift down.",
    "start": "3356840",
    "end": "3364040"
  },
  {
    "text": "And then you have these\nlittle excursions upwards, and those are your\nhigh scoring segments.",
    "start": "3364040",
    "end": "3369410"
  },
  {
    "text": "Any questions about that? AUDIENCE: Question. Is there something\nbetter than m times n?",
    "start": "3369410",
    "end": "3377795"
  },
  {
    "text": "PROFESSOR: We've got some\ncomputer scientists here. David? Better than m times n?",
    "start": "3377795",
    "end": "3383110"
  },
  {
    "text": "I don't think so,\nbecause you have to do all those comparisons. And so there's no way around\nthat, so I don't think so.",
    "start": "3383110",
    "end": "3389530"
  },
  {
    "text": "All right. But the constant--\nyou can do better on the constant than\nthis algorithm thing.",
    "start": "3389530",
    "end": "3395076"
  },
  {
    "text": "AUDIENCE: With\nmultiple queries-- PROFESSOR: With\nmultiple queries, yeah. Then you can maybe\ndo some hashing",
    "start": "3395076",
    "end": "3401720"
  },
  {
    "text": "or find some-- to speed it up. OK, so what about the\nstatistics of this?",
    "start": "3401720",
    "end": "3408560"
  },
  {
    "text": "So it turns out that Karlin and\nAltschul developed some theory",
    "start": "3408560",
    "end": "3414790"
  },
  {
    "text": "for just exactly this problem. For searching a query sequence.",
    "start": "3414790",
    "end": "3420210"
  },
  {
    "text": "It can be nucleotide or protein\nas long as you have integer scores and the average-- or the\nexpected-- score is negative,",
    "start": "3420210",
    "end": "3429700"
  },
  {
    "text": "then this theory\ntells you how often the highest score of all--\nacross the entire query",
    "start": "3429700",
    "end": "3437890"
  },
  {
    "text": "database comparison--\nexceeds a cut off x using a local alignment\nalgorithm such as BLAST.",
    "start": "3437890",
    "end": "3445300"
  },
  {
    "text": "And it turns out\nthat these scores",
    "start": "3445300",
    "end": "3450380"
  },
  {
    "text": "follow what's called an extreme\nvalue or Gumbel distribution. And it has this kind of\ndouble exponential form here.",
    "start": "3450380",
    "end": "3459340"
  },
  {
    "text": "So x is some cut off. So usually x would be the\nscore that you actually observed when you searched your\nquery against the database.",
    "start": "3459340",
    "end": "3466530"
  },
  {
    "text": "That's the one you care about. And then you want\nto know, what's the probability we would've\nseen something higher than that?",
    "start": "3466530",
    "end": "3473980"
  },
  {
    "text": "Or you might do x is one less\nthan the score you observed.",
    "start": "3473980",
    "end": "3480150"
  },
  {
    "text": "So what's the chance we\nobserved something the same, as good as this, or better?",
    "start": "3480150",
    "end": "3486775"
  },
  {
    "text": "Does that make sense? And so this is going to\nbe your P value then. So the probability\nof S. The score",
    "start": "3486775",
    "end": "3493740"
  },
  {
    "text": "of the highest segment\nunder a model where you have a random query\nagainst a random database of the same length is 1\nminus e to the minus KMN",
    "start": "3493740",
    "end": "3502500"
  },
  {
    "text": "e to the minus lambda x. Where M and N are the lengths\nof the query and the database.",
    "start": "3502500",
    "end": "3510030"
  },
  {
    "text": "x is the score. And then K and lambda are\ntwo positive parameters",
    "start": "3510030",
    "end": "3515860"
  },
  {
    "text": "that depend actually on the\ndetails of your score matrix and the composition\nof your sequences.",
    "start": "3515860",
    "end": "3522990"
  },
  {
    "text": "And it turns out that lambda\nis really the one that matters. And you can see\nthat because lambda",
    "start": "3522990",
    "end": "3528940"
  },
  {
    "text": "is up there in that\nexponent multiplying x. So if you double\nlambda, that'll have a big effect on the answer.",
    "start": "3528940",
    "end": "3536660"
  },
  {
    "text": "And K, it turns\nout, you can mostly ignore it for most purposes. So as a formula, what\ndoes this thing look like?",
    "start": "3536660",
    "end": "3544839"
  },
  {
    "text": "It looks like that. Kind of a funny shape. It sort of looks like\nan umlauf a little bit,",
    "start": "3544840",
    "end": "3550210"
  },
  {
    "text": "but then has a different shape\non the right than the left.",
    "start": "3550210",
    "end": "3555540"
  },
  {
    "text": "And how do you\ncalculate this lambda? So I said that lambda is\nsort of the key to all this",
    "start": "3555540",
    "end": "3563529"
  },
  {
    "text": "because of its uniquely\nimportant place",
    "start": "3563530",
    "end": "3571630"
  },
  {
    "text": "in that formula,\nmultiplying the score. So it turns out that lambda is\nthe unique positive solution",
    "start": "3571630",
    "end": "3579230"
  },
  {
    "text": "to this equation here. So now it actually depends\non the scoring matrix.",
    "start": "3579230",
    "end": "3584990"
  },
  {
    "text": "So you see there's sij there. It depends on the\ncomposition of your query. That's the pi's.",
    "start": "3584990",
    "end": "3590540"
  },
  {
    "text": "The composition of your\nsubject, that's the rj's.",
    "start": "3590540",
    "end": "3595820"
  },
  {
    "text": "You sum over the i\nand j equal to each of the four nucleotides.",
    "start": "3595820",
    "end": "3601340"
  },
  {
    "text": "And that sum has to be 1. So there's a unique positive\nsolution to this equation.",
    "start": "3601340",
    "end": "3608830"
  },
  {
    "text": "So how would we solve\nan equation like this? First of all, what\nkind of equation is this, given that we're\ngoing to set the sij,",
    "start": "3608830",
    "end": "3617460"
  },
  {
    "text": "and we're going to just\nmeasure the pi and the rj? So those are all\nknown constants,",
    "start": "3617460",
    "end": "3623470"
  },
  {
    "text": "and lambda is what we're\ntrying to solve for here. So what kind of an\nequation is this in lambda?",
    "start": "3623470",
    "end": "3628790"
  },
  {
    "start": "3628791",
    "end": "3635850"
  },
  {
    "text": "Linear? Quadratic? Hyperbolic?",
    "start": "3635850",
    "end": "3640890"
  },
  {
    "text": "Anybody know what this is? So this is called a\ntranscendental equation",
    "start": "3640890",
    "end": "3647660"
  },
  {
    "text": "because you have\ndifferent powers. ",
    "start": "3647660",
    "end": "3655200"
  },
  {
    "text": "That sounds kind of unpleasant. You don't take a class in\ntranscendental equations",
    "start": "3655200",
    "end": "3661440"
  },
  {
    "text": "probably. So in general, they're not\npossible to solve analytically",
    "start": "3661440",
    "end": "3668270"
  },
  {
    "text": "when they get complicated. But in simple cases, you\ncan solve them analytically.",
    "start": "3668270",
    "end": "3673380"
  },
  {
    "text": "And in fact, let's just do one. So let's take the\nsimplest case, which",
    "start": "3673380",
    "end": "3679450"
  },
  {
    "text": "would be that all the\npi's are a quarter.",
    "start": "3679450",
    "end": "3685230"
  },
  {
    "text": "All the ri's are a quarter. And we'll use the scoring system\nthat we came up with before,",
    "start": "3685230",
    "end": "3691990"
  },
  {
    "text": "where sii is 1,\nand sij is minus 1.",
    "start": "3691990",
    "end": "3697710"
  },
  {
    "text": "If i does not equal j. And so when we plug those in to\nthat sum there, what do we get?",
    "start": "3697710",
    "end": "3710250"
  },
  {
    "text": "We'll get four terms that are\none quarter, times one quarter,",
    "start": "3710250",
    "end": "3716190"
  },
  {
    "text": "times e to the lambda. There's four possible\ntypes of matches, right?",
    "start": "3716190",
    "end": "3723817"
  },
  {
    "text": "They have probability one\nquarter times a quarter. That's pi and rj. And the e to the lambda\nsii is just e to the lambda",
    "start": "3723817",
    "end": "3732450"
  },
  {
    "text": "because sii is 1. And then there's 12 terms that\nare one quarter, one quarter,",
    "start": "3732450",
    "end": "3739680"
  },
  {
    "text": "e to the minus lambda. Because there's\nthe minus 1 score. And that has to equal 1.",
    "start": "3739680",
    "end": "3746609"
  },
  {
    "text": "So cancel this, we'll\nmultiply through by 4, maybe.",
    "start": "3746610",
    "end": "3752210"
  },
  {
    "text": "So now we get e to\nthe lambda plus 3.",
    "start": "3752210",
    "end": "3759720"
  },
  {
    "text": "e to the minus lambda equals 1. It's still a\ntranscendental equation,",
    "start": "3759720",
    "end": "3765050"
  },
  {
    "text": "but it's looking\na little simpler. Any ideas how to\nsolve this for lambda? ",
    "start": "3765050",
    "end": "3772140"
  },
  {
    "text": "Sally? AUDIENCE: Wouldn't the 1 be 4? PROFESSOR: I'm sorry. 4. Thank you. ",
    "start": "3772140",
    "end": "3786730"
  },
  {
    "text": "Yeah, what's your name? AUDIENCE: [INAUDIBLE] I think\n[INAUDIBLE] quadratic equation. If you multiply both sides by\n[INAUDIBLE] then [INAUDIBLE].",
    "start": "3786730",
    "end": "3794764"
  },
  {
    "text": " PROFESSOR: OK, so\nthe claim is this is basically a\nquadratic equation. So you multiply both\nsides by e to the lambda.",
    "start": "3794764",
    "end": "3801376"
  },
  {
    "text": "So then you get e to\nthe 2 lambda plus 3. And then it's going to\nmove this over and do",
    "start": "3801376",
    "end": "3806530"
  },
  {
    "text": "minus 4 e to the\nlambda equals zero.",
    "start": "3806530",
    "end": "3811580"
  },
  {
    "text": "Is that good? So how is it quadratic? What do you actually\ndo to solve this?",
    "start": "3811580",
    "end": "3817190"
  },
  {
    "text": "AUDIENCE: Well, [INAUDIBLE]. ",
    "start": "3817190",
    "end": "3822280"
  },
  {
    "text": "PROFESSOR: Change the variable,\nx equals e to the lambda. Then it's quadratic in x. Solve for x. We all know how to solve\nquadratic equations.",
    "start": "3822280",
    "end": "3828440"
  },
  {
    "text": "And then substitute\nthat for lambda. OK, everyone got that? ",
    "start": "3828440",
    "end": "3835845"
  },
  {
    "text": "If you use 16 different\nscores to represent all the different types\nof matches and mismatches, this will be very unpleasant.",
    "start": "3835845",
    "end": "3843060"
  },
  {
    "text": "It's not unsolvable,\nit's just that you have to use computational\nnumerical methods to solve it.",
    "start": "3843060",
    "end": "3848520"
  },
  {
    "text": "But in simple cases\nwhere you just have a couple different\ntypes of scores, it will often be a\nquadratic equation.",
    "start": "3848520",
    "end": "3855530"
  },
  {
    "text": "All right. So let's suppose that we have\na particular scoring system-- particular pi's, rj's-- and\nwe have a value of lambda that",
    "start": "3855530",
    "end": "3864609"
  },
  {
    "text": "satisfies those. So we've solved this\nquadratic equation for lambda. I think we get lambda\nequals natural log",
    "start": "3864610",
    "end": "3870240"
  },
  {
    "text": "3, something like that. Remember, it's a unique\npositive solution. Quadratic equations\nare two solutions,",
    "start": "3870240",
    "end": "3875369"
  },
  {
    "text": "but there's going to be\njust one positive one. And then we have that value.",
    "start": "3875370",
    "end": "3881230"
  },
  {
    "text": "It satisfies this equation. So then, what if we\ndouble the scores?",
    "start": "3881230",
    "end": "3887200"
  },
  {
    "text": "Instead of plus 1 minus\n1, we use plus 2 minus 2? ",
    "start": "3887200",
    "end": "3893020"
  },
  {
    "text": "What would then happen? You can see that the\noriginal version of lambda",
    "start": "3893020",
    "end": "3898440"
  },
  {
    "text": "wouldn't necessarily still\nsatisfy this equation. But if you think\nabout it a little bit,",
    "start": "3898440",
    "end": "3904080"
  },
  {
    "text": "you can figure out what\nnew value of lambda would satisfy this equation.",
    "start": "3904080",
    "end": "3909692"
  },
  {
    "start": "3909692",
    "end": "3914859"
  },
  {
    "text": "We've solved for the lambda\nthat solves with these scores. ",
    "start": "3914860",
    "end": "3923502"
  },
  {
    "text": "Now we're going to\nhave new scores. sii prime equals 2.",
    "start": "3923502",
    "end": "3928530"
  },
  {
    "text": "sij prime equals minus 2.",
    "start": "3928530",
    "end": "3934080"
  },
  {
    "text": "What is lambda prime? The lambda that goes\nwith these scores? ",
    "start": "3934080",
    "end": "3939850"
  },
  {
    "text": "Yeah, go ahead. AUDIENCE: Half of the original? PROFESSOR: Half of the original? Right. So you're saying that lambda\nprime equals lambda over 2.",
    "start": "3939850",
    "end": "3946974"
  },
  {
    "text": "And why is that? Can you explain? AUDIENCE: Because\nof the [INAUDIBLE].",
    "start": "3946974",
    "end": "3952506"
  },
  {
    "start": "3952506",
    "end": "3959530"
  },
  {
    "text": "PROFESSOR: Yeah, if you think\nabout these terms in the sum, the s part is all doubling.",
    "start": "3959530",
    "end": "3965940"
  },
  {
    "text": "So if you cut the lambda apart,\nand the product will equal what it did before. And we haven't changed the pi's\nand rj's, so all those terms",
    "start": "3965940",
    "end": "3973369"
  },
  {
    "text": "will be the same. So therefore, it will still\nsatisfy that equation. So that's another way\nof thinking about it.",
    "start": "3973370",
    "end": "3979900"
  },
  {
    "text": "Yes, you're correct. So if you double\nthe scores, lambda will be reduced\nby a factor of 2.",
    "start": "3979900",
    "end": "3987090"
  },
  {
    "text": "So what does that\ntell us about lambda? What is it?",
    "start": "3987090",
    "end": "3992994"
  },
  {
    "text": "What is its meaning? ",
    "start": "3992994",
    "end": "4000250"
  },
  {
    "text": "Yeah, go ahead, Jeff. AUDIENCE: Scale of\nthe distribution to the expectant score?",
    "start": "4000250",
    "end": "4005808"
  },
  {
    "text": "Or the range score? PROFESSOR: Yeah. It basically scales the scores. So we can have the\nsame equation here used",
    "start": "4005808",
    "end": "4015040"
  },
  {
    "text": "with arbitrary scoring. It just scales it. You can see the way it appears\nas a multiplicative factor in front of the score.",
    "start": "4015040",
    "end": "4020326"
  },
  {
    "text": "So if you double all\nthe scores, will that change what the highest\nscoring segment is? ",
    "start": "4020326",
    "end": "4027559"
  },
  {
    "text": "No, it won't change\nit because you'll have this cumulative thing. It just changes how\nyou label the y-axis.",
    "start": "4027560",
    "end": "4034450"
  },
  {
    "text": "It'll make it bigger, but it\nwon't change what that is.",
    "start": "4034450",
    "end": "4039505"
  },
  {
    "text": "And if you look\nat this equation, it won't change the\nstatistical significance. The x will double in value,\nbecause all the matches are now",
    "start": "4039505",
    "end": "4047619"
  },
  {
    "text": "worth twice as much as\nwhat they were before. But lambda will be half\nas big, and so the product",
    "start": "4047620",
    "end": "4053110"
  },
  {
    "text": "will be the same and therefore,\nthe final probability will be the same. So it's just a scaling factor\nfor using different scoring",
    "start": "4053110",
    "end": "4058849"
  },
  {
    "text": "systems. ",
    "start": "4058850",
    "end": "4064281"
  },
  {
    "text": "Everyone got that?  All right. So what scoring matrix\nshould we use for DNA?",
    "start": "4064281",
    "end": "4071820"
  },
  {
    "text": "How about this one? So this is now a\nslight generalization. So we're going to keep\n1 for the matches.",
    "start": "4071820",
    "end": "4080530"
  },
  {
    "text": "You don't lose any generality\nby choosing 1 here for matches, because if you use 2,\nthen lambda is just",
    "start": "4080530",
    "end": "4087500"
  },
  {
    "text": "going to be reduced\nto compensate. So 1 for matches. And then we're going to\nuse m for mismatches.",
    "start": "4087500",
    "end": "4095590"
  },
  {
    "text": "And m must be negative in\norder to satisfy this condition",
    "start": "4095590",
    "end": "4101568"
  },
  {
    "text": "for this theory to work,\nthat the average score has to be negative. Clearly, you have to have\nsome negative scores.",
    "start": "4101569",
    "end": "4107540"
  },
  {
    "text": "And the question then\nis, should we use minus 1 like we used before? Or should we use like minus 2\nor minus 5, or something else?",
    "start": "4107540",
    "end": "4117580"
  },
  {
    "text": "Any thoughts on this? ",
    "start": "4117580",
    "end": "4123230"
  },
  {
    "text": "Or does it matter? Maybe it doesn't matter. Yeah, what's your name? AUDIENCE: [INAUDIBLE]. Would it make sense to\nnot use [INAUDIBLE],",
    "start": "4123230",
    "end": "4129769"
  },
  {
    "text": "because [INAUDIBLE]. PROFESSOR: Yeah, OK. So you want to use a more\ncomplicated scoring system.",
    "start": "4129769",
    "end": "4136580"
  },
  {
    "text": "What particular\nmismatches would you want to penalize more and less?",
    "start": "4136580",
    "end": "4143080"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]\nI think [INAUDIBLE]",
    "start": "4143080",
    "end": "4149423"
  },
  {
    "text": "needs to be [INAUDIBLE]. ",
    "start": "4149424",
    "end": "4161160"
  },
  {
    "text": "PROFESSOR: Yeah, you are\ncorrect in your intuition. Maybe one of the\nbiologists wants to offer a suggestion here.",
    "start": "4161160",
    "end": "4167239"
  },
  {
    "text": "Yeah, go ahead. AUDIENCE: So it's a mismatch\nbetween purine and pyrimidine [INAUDIBLE]. ",
    "start": "4167240",
    "end": "4175348"
  },
  {
    "text": "PROFESSOR: OK so now we've\ngot purines and pyrimidines. So everyone\nremember, the purines are A and G. The\npyrimidines are C and T.",
    "start": "4175349",
    "end": "4185929"
  },
  {
    "text": "And the idea is that\nthis should be penalized, or this should be penalized\nless than changing",
    "start": "4185930",
    "end": "4194009"
  },
  {
    "text": "a purine to a pyrimidine. And why does that makes sense? AUDIENCE: Well,\nstructurally they're--",
    "start": "4194010",
    "end": "4199950"
  },
  {
    "text": "PROFESSOR: Structurally, purines\nare more similar to each other than they are to pyrimidines. And? More importantly, I think.",
    "start": "4199950",
    "end": "4207996"
  },
  {
    "text": "In evolution?  AUDIENCE: [INAUDIBLE].",
    "start": "4207997",
    "end": "4213368"
  },
  {
    "text": " PROFESSOR: I'm sorry,\ncan you speak up? AUDIENCE: C to C mutations\nhappen spontaneously",
    "start": "4213368",
    "end": "4220044"
  },
  {
    "text": "in [INAUDIBLE] chemistry. PROFESSOR: Yes. So C to C mutations\nhappen spontaneously. So basically, it's\neasier because they",
    "start": "4220044",
    "end": "4227440"
  },
  {
    "text": "look more similar structurally. The DNA polymerase is more\nlikely to make a mistake and substitute another purine.",
    "start": "4227440",
    "end": "4233970"
  },
  {
    "text": " The rate of purine,\npurine or pyrimidine,",
    "start": "4233970",
    "end": "4243940"
  },
  {
    "text": "pyrimidine to\ntransversions which switch the type is\nabout three to one,",
    "start": "4243940",
    "end": "4248970"
  },
  {
    "text": "or two to one in\ndifferent systems. So yeah, that's a good idea. But for simplicity, just\nto keep the math simple,",
    "start": "4248970",
    "end": "4254820"
  },
  {
    "text": "we're just going to go\nwith one mismatch penalty. But that is a good point. In practice, you\nmight want to do that.",
    "start": "4254820",
    "end": "4260470"
  },
  {
    "text": "So now, I'm saying\nI'm going to limit you to one mismatch penalty. But I'm going to let you\nchoose any value you want.",
    "start": "4260470",
    "end": "4267710"
  },
  {
    "text": "So what value should you choose? Or does it matter? ",
    "start": "4267710",
    "end": "4275791"
  },
  {
    "text": "Or maybe different applications? Tim, yeah? AUDIENCE: I've just\ngot a question. Does it depend on pi and ri?",
    "start": "4275791",
    "end": "4284378"
  },
  {
    "text": "For example, we could\nuse all these numbers. But if the overall\nwants to be negative,",
    "start": "4284378",
    "end": "4290342"
  },
  {
    "text": "then you couldn't\nuse negative .1. ",
    "start": "4290342",
    "end": "4297407"
  },
  {
    "text": "PROFESSOR: Right,\nthat's a good point. You can't make it too weak. It may depend on what your\nexpected fraction of matches",
    "start": "4297407",
    "end": "4305230"
  },
  {
    "text": "is, which actually\ndepends on pi and ri. So if you have very biased\nsequences, like very AT rich,",
    "start": "4305230",
    "end": "4315210"
  },
  {
    "text": "your expected fraction of\nmatches is actually higher. When you're researching\nan AT rich sequence against another\nAT rich sequence,",
    "start": "4315210",
    "end": "4320370"
  },
  {
    "text": "it's actually higher\nthan a quarter.  So even minus one might\nnot be sufficient there.",
    "start": "4320370",
    "end": "4326480"
  },
  {
    "text": "You might need to go\ndown more negative. So you may need to use a\nhigher negative value just to make sure that the\nexpected value is negative.",
    "start": "4326480",
    "end": "4334050"
  },
  {
    "text": "That's true. And yeah, you may want to adjust\nit based on the composition.",
    "start": "4334050",
    "end": "4339830"
  },
  {
    "text": "So let's just do a bit more. So it turns out that the\nKarlin and Altschul theory,",
    "start": "4339830",
    "end": "4345480"
  },
  {
    "text": "in addition to telling you what\nthe p value is of your match--",
    "start": "4345480",
    "end": "4351190"
  },
  {
    "text": "the statistical significance--\nit also tells you what the matches will\nlook like in terms",
    "start": "4351190",
    "end": "4357639"
  },
  {
    "text": "of what fraction of\nidentity they will have. And this is the so-called\ntarget frequency equation.",
    "start": "4357640",
    "end": "4365290"
  },
  {
    "text": "The theory says that if\nI search a query with one particular composition, p,\nsubject meta-composition r--",
    "start": "4365290",
    "end": "4372449"
  },
  {
    "text": "here, I've just assumed\nthey're the same, both p just for simplicity-- with a\nscoring matrix sij, which",
    "start": "4372450",
    "end": "4378250"
  },
  {
    "text": "has a corresponding of lambda. Then, when I take those\nvery high scoring matches-- the ones that are\nstatistically significant--",
    "start": "4378250",
    "end": "4385780"
  },
  {
    "text": "and I look at those\nalignments of those matches, I will get values qij,\ngiven by this formula.",
    "start": "4385780",
    "end": "4395650"
  },
  {
    "text": "So look at the formula. So it's qij. So pipj e to the lambda sij. So it's basically\nthe expected chance",
    "start": "4395650",
    "end": "4402620"
  },
  {
    "text": "that you would have base\ni matching based j just",
    "start": "4402620",
    "end": "4408970"
  },
  {
    "text": "by chance. That's pipj. But then weighted by\ne to the lambda sij. So we notice for a match,\ns will be positive,",
    "start": "4408970",
    "end": "4416560"
  },
  {
    "text": "so e to the lambda\nwill be positive. So that will be bigger than 1. And you'll have more\nmatches and you'll have correspondingly\nless mismatches",
    "start": "4416560",
    "end": "4423369"
  },
  {
    "text": "because the mismatch\nhas a negative. So get the target value score. And that also tells you that\nthe so-called natural scores",
    "start": "4423370",
    "end": "4432510"
  },
  {
    "text": "are actually determined\nby the fraction of matches that you want in your\nhigh scoring segments.",
    "start": "4432510",
    "end": "4439500"
  },
  {
    "text": "If we want 90% matches,\nwe just set qii to be 0.9, and use\nthis equation here.",
    "start": "4439500",
    "end": "4446180"
  },
  {
    "text": " Solve for sij. ",
    "start": "4446180",
    "end": "4454740"
  },
  {
    "text": "For example, if you want to\nfind regions with R% identities. Little r is just the\nr as a proportion.",
    "start": "4454740",
    "end": "4462220"
  },
  {
    "text": "qii is going to be r over 4. This assumes unbiased\nbase composition. A quarter of the\nmatches are acgt.",
    "start": "4462220",
    "end": "4468920"
  },
  {
    "text": " Qij, then, is 1 minus r over 12.",
    "start": "4468920",
    "end": "4475700"
  },
  {
    "text": "1 minus r is a fraction\nof non-matching positions. They're 12 different types.",
    "start": "4475700",
    "end": "4481360"
  },
  {
    "text": "Set sii equal to 1, that's\nwhat we said we normally do. And then you do a little\nbit of algebra here.",
    "start": "4481360",
    "end": "4488560"
  },
  {
    "text": "m is sij. And you sort of plug in\nthis equation twice here.",
    "start": "4488560",
    "end": "4494730"
  },
  {
    "text": "And you get this equation. So it says that m equals\nlog of 4 1 minus r over 3",
    "start": "4494730",
    "end": "4501350"
  },
  {
    "text": "over log 4 r. And for this to be\ntrue, this assumes that both the query\nand the database",
    "start": "4501350",
    "end": "4508780"
  },
  {
    "text": "have uniform composition\nof a quarter, and that r is between\na quarter and 1.",
    "start": "4508780",
    "end": "4516300"
  },
  {
    "text": "The proportion of matches in\nyour high scoring segment-- you want it to be\nbigger than a quarter. A quarter is what you\nwould see by chance.",
    "start": "4516300",
    "end": "4523014"
  },
  {
    "text": "There's something wrong with\nyour scoring system if you're considering those\nto be significant. So it's something above 25%.",
    "start": "4523014",
    "end": "4530280"
  },
  {
    "text": "And so it's just\nsimple algebra-- you can check my work at\nhome-- to solve for m here.",
    "start": "4530280",
    "end": "4541179"
  },
  {
    "text": "And then this equation\nthen tells you that if I want to find\n75% identical matches",
    "start": "4541180",
    "end": "4549530"
  },
  {
    "text": "in a nucleotide\nsearch, I should use a mismatch penalty of minus 1. And if I want 99%\nidentical matches,",
    "start": "4549530",
    "end": "4557160"
  },
  {
    "text": "I should use a\npenalty of minus 3. Not minus 5, but minus 3.",
    "start": "4557160",
    "end": "4562440"
  },
  {
    "text": "And I want you to think\nabout, does that make sense?",
    "start": "4562440",
    "end": "4569070"
  },
  {
    "text": "Does that not make sense? Because I'm going to ask you\nat the beginning of class",
    "start": "4569070",
    "end": "4574400"
  },
  {
    "text": "on Tuesday to\nexplain and comment on this particular phenomenon\nof how when you want higher",
    "start": "4574400",
    "end": "4583470"
  },
  {
    "text": "percent identities, you want a\nmore negative mismatch score.",
    "start": "4583470",
    "end": "4591340"
  },
  {
    "text": "Any last questions? Comments?",
    "start": "4591340",
    "end": "4596960"
  },
  {
    "start": "4596960",
    "end": "4607581"
  }
]