[
  {
    "start": "0",
    "end": "21000"
  },
  {
    "text": "The following content is\nprovided under a Creative Commons license. Your support will help\nMIT OpenCourseWare",
    "start": "0",
    "end": "6360"
  },
  {
    "text": "continue to offer high quality\neducational resources for free. To make a donation or\nview additional materials",
    "start": "6360",
    "end": "13350"
  },
  {
    "text": "from hundreds of MIT courses,\nvisit MIT OpenCourseWare at ocw.mit.edu. ",
    "start": "13350",
    "end": "22180"
  },
  {
    "start": "21000",
    "end": "59000"
  },
  {
    "text": "RUSS TEDRAKE: Welcome, back. Today we're going to break\nthe mold of these one",
    "start": "22180",
    "end": "27699"
  },
  {
    "text": "degree of freedom\nsystems in a major way. We're going to go to two\ndegree of freedom systems.",
    "start": "27700",
    "end": "34810"
  },
  {
    "text": "There are two sort of canonical\nunderactuated systems.",
    "start": "34810",
    "end": "40220"
  },
  {
    "text": "In fact, I'd say that the\nfield of underactuated robotics spends most of its\ntime thinking about",
    "start": "40220",
    "end": "45790"
  },
  {
    "text": "a few canonical\nunderactuated problems. The two we're going\nto talk about today",
    "start": "45790",
    "end": "51670"
  },
  {
    "text": "are the Acrobot and\nthe cart-pole systems. The Acrobot is a\ntwo-link robotic arm.",
    "start": "51670",
    "end": "59920"
  },
  {
    "start": "59000",
    "end": "165000"
  },
  {
    "text": "The only thing\nspecial about it-- it's operating in\nthe vertical plane. ",
    "start": "59920",
    "end": "67090"
  },
  {
    "text": "The only thing that\nmakes it special is that somebody forgot to\nput a motor at the shoulder. So you've got a motor at\nthe elbow and no motor",
    "start": "67090",
    "end": "74229"
  },
  {
    "text": "at the shoulder. It's called the Acrobot\nbecause you can-- it's a little bit like an\nacrobat on a high bar that",
    "start": "74230",
    "end": "80680"
  },
  {
    "text": "has to spin around\nand do tricks, even though they can't produce\nmuch torque with their wrist",
    "start": "80680",
    "end": "86260"
  },
  {
    "text": "and they have to do it\nall with their waist. The other one, the\ncart-pole system,",
    "start": "86260",
    "end": "92230"
  },
  {
    "text": "you've probably seen it in\nan intro controls course. In our 6003 and our\nSignals and Systems",
    "start": "92230",
    "end": "98920"
  },
  {
    "text": "course at the end of the year,\nthey bring in a cart-pole and do a little demonstration.",
    "start": "98920",
    "end": "104570"
  },
  {
    "text": "It's a cart with-- I made it a simple\npendulum, since we thought a lot about the\nsimple pendulums, on the cart.",
    "start": "104570",
    "end": "113210"
  },
  {
    "text": "You're allowed to push\nthe cart sideways. But there's only a pin joint\nhere holding the pendulum up.",
    "start": "113210",
    "end": "121690"
  },
  {
    "text": "So you have to the\nbalance the pendulum with the cart by\nmoving the cart. Now, in our intro\ncontrols courses,",
    "start": "121690",
    "end": "130179"
  },
  {
    "text": "they do linear control. At the top, they do\nsome simple modeling,",
    "start": "130180",
    "end": "135250"
  },
  {
    "text": "some pole placement in 6003. So they start it near the top. It stays near the top.",
    "start": "135250",
    "end": "140409"
  },
  {
    "text": "They actually-- they put a wine\nglass or something on the top. They put a Christmas\ntree on the top. They do all these things, but\nthey never start it from here",
    "start": "140410",
    "end": "148270"
  },
  {
    "text": "because then the\nnonlinearity kicks in. And that's why we\nneed this course. We've got to-- that's\na harder problem.",
    "start": "148270",
    "end": "155110"
  },
  {
    "text": "So we're going to do the full\nCart-Pole starting today. And we'll finish it on Thursday.",
    "start": "155110",
    "end": "160690"
  },
  {
    "text": " So the equations of\nmotion of both of those",
    "start": "160690",
    "end": "167470"
  },
  {
    "start": "165000",
    "end": "235000"
  },
  {
    "text": "are quite easy to derive. They take a half a page,\nand they're in the notes.",
    "start": "167470",
    "end": "173530"
  },
  {
    "text": "Both of them are nicely\ndescribed by the manipulator",
    "start": "173530",
    "end": "178780"
  },
  {
    "text": "equations that I introduced\nin the first lecture. So let's work in the\nmanipulator equation form.",
    "start": "178780",
    "end": "184070"
  },
  {
    "text": "So if you remember,\nI said that most of the systems we\ncare about can be",
    "start": "184070",
    "end": "189250"
  },
  {
    "text": "described by these equations. ",
    "start": "189250",
    "end": "205300"
  },
  {
    "text": "It happens that both\nof these systems are sort of trivially\nunderactuated.",
    "start": "205300",
    "end": "210940"
  },
  {
    "text": "They've got one actuator\nand one passive joint, so B turns out to be--",
    "start": "210940",
    "end": "216730"
  },
  {
    "text": "well, I've actually got it\nto be 0 and 1 for the Acrobot",
    "start": "216730",
    "end": "221800"
  },
  {
    "text": "and 1, 0 for the cart-pole. ",
    "start": "221800",
    "end": "228970"
  },
  {
    "text": "But they're both sort\nof the standard form. ",
    "start": "228970",
    "end": "235810"
  },
  {
    "start": "235000",
    "end": "465000"
  },
  {
    "text": "So the first thing I\nthink that everybody does with these systems\nand that we have to discuss",
    "start": "235810",
    "end": "242200"
  },
  {
    "text": "is, let's see if we can\nmake it balance at the top. The task in both\nof these cases is to take the system from some\narbitrary initial condition",
    "start": "242200",
    "end": "250720"
  },
  {
    "text": "and get it up to the\ntop, and balance. It turns out that, even though\nthe systems are underactuated,",
    "start": "250720",
    "end": "258010"
  },
  {
    "text": "you can do that. Just to show you the-- ",
    "start": "258010",
    "end": "263487"
  },
  {
    "text": "to help your\nintuition here, this is some Acrobot\nvideo from the web.",
    "start": "263487",
    "end": "270280"
  },
  {
    "text": " They have a belt\ndrive going down to their elbow motor\nand a big motor",
    "start": "270280",
    "end": "278560"
  },
  {
    "text": "up here, like very\nbig motor up here. [VIDEO PLAYBACK]",
    "start": "278560",
    "end": "283570"
  },
  {
    "text": "And if you're willing to\nsort of pump energy up through the second\nlink, then you can--",
    "start": "283570",
    "end": "290070"
  },
  {
    "text": "- Oh! RUSS TEDRAKE: They\nwere very excited. [LAUGHTER] Then you can\nadd energy to the system,",
    "start": "290070",
    "end": "297100"
  },
  {
    "text": "get it to swing around. And then the cool thing\nis, you can stabilize it at the top, which is\nactually pretty surprising.",
    "start": "297100",
    "end": "304919"
  },
  {
    "text": "So this one took however many\npumps, got itself the top,",
    "start": "304920",
    "end": "313000"
  },
  {
    "text": "balanced, they said, oh! So in this class, we're\ngoing to do better.",
    "start": "313000",
    "end": "319670"
  },
  {
    "text": "So this is just a teaser. But here, if you were to take\nyour optimal control tools",
    "start": "319670",
    "end": "324850"
  },
  {
    "text": "and try to solve the same\nproblem, the exact same system. Now it's in MATLAB. But we're going to do a\nlot better by thinking",
    "start": "324850",
    "end": "332110"
  },
  {
    "text": "about sort of minimum\ntime or even LQR solutions to get to the top.",
    "start": "332110",
    "end": "337330"
  },
  {
    "text": "I think that's pretty elegant. So single pump,\nand then it's up. And of course, it will depend\non your torque limits and all",
    "start": "337330",
    "end": "344500"
  },
  {
    "text": "these things, but I think we\ncan do very elegant control on these kind of problems. ",
    "start": "344500",
    "end": "352510"
  },
  {
    "text": "OK, so I want to\nstart by thinking",
    "start": "352510",
    "end": "357670"
  },
  {
    "text": "about balancing at the top. So it's not obvious, if I've\ngot a system with a motor",
    "start": "357670",
    "end": "363730"
  },
  {
    "text": "at the elbow and no\nmotor at the shoulder, that I could balance at the top.",
    "start": "363730",
    "end": "368830"
  },
  {
    "text": "You'd think that, if I\nfall with my elbow motor, I've got nothing\nimmediately to correct it. So how the heck do I stabilize\nthat fixed point at the top?",
    "start": "368830",
    "end": "378070"
  },
  {
    "text": "Well, it turns out you can. And let's look at that. You've probably seen\nlinearization before.",
    "start": "378070",
    "end": "384470"
  },
  {
    "text": "It turns out, if you're\nlinearizing things from the manipulated\nequations, it's pretty elegant.",
    "start": "384470",
    "end": "391000"
  },
  {
    "text": "So I'm going to do\nthat quickly here. ",
    "start": "391000",
    "end": "397420"
  },
  {
    "text": "So our system that we're working\nwith here is just an x dot.",
    "start": "397420",
    "end": "404800"
  },
  {
    "text": "It equals f of u in\nstate-space form. But it happens because it's\nfrom the manipulator equation,",
    "start": "404800",
    "end": "410200"
  },
  {
    "text": "that if we choose\nx to be q, q dot, like we always\ndo, then f of x, u",
    "start": "410200",
    "end": "418930"
  },
  {
    "text": "has this sort of block matrix,\na block vector form here,",
    "start": "418930",
    "end": "424310"
  },
  {
    "text": "which is-- q double dot is now H\ninverse q, Bu minus Cq",
    "start": "424310",
    "end": "432340"
  },
  {
    "text": "dot minus G. I just solve\nthat for q double dot.",
    "start": "432340",
    "end": "443470"
  },
  {
    "text": "We know that H is-- an inertial matrix, it's always\nuniformly positive definite.",
    "start": "443470",
    "end": "448625"
  },
  {
    "text": "So for all q's, it's\npositive definite. So I can take its inverse,\nand I get that solution for q double that.",
    "start": "448625",
    "end": "454620"
  },
  {
    "text": "So the derivative of x is-- this is q dot, sorry. It looks like a\nline, but it's a dot.",
    "start": "454620",
    "end": "461240"
  },
  {
    "text": " And now we want to think\nabout linearizing that system",
    "start": "461240",
    "end": "469060"
  },
  {
    "start": "465000",
    "end": "495000"
  },
  {
    "text": "around a fixed point. ",
    "start": "469060",
    "end": "495539"
  },
  {
    "start": "495000",
    "end": "595000"
  },
  {
    "text": "The way we're going\nto do that, of course, is taking a Taylor expansion. ",
    "start": "495540",
    "end": "502810"
  },
  {
    "text": "I'm going to take\nmy x dot and say it's approximately equal to\nf of x at the fixed point, u",
    "start": "502810",
    "end": "510190"
  },
  {
    "text": "of x at the fixed point,\nplus partial f, partial x,",
    "start": "510190",
    "end": "516370"
  },
  {
    "text": "with x evaluated\nat the fixed point, u evaluated at the fixed\npoint, times x minus x star,",
    "start": "516370",
    "end": "526690"
  },
  {
    "text": "plus partial f, partial u,\nevaluated at the fixed point.",
    "start": "526690",
    "end": "532480"
  },
  {
    "start": "532480",
    "end": "546560"
  },
  {
    "text": "And it turns out\nfor these equations, at a fixed point, that's really\nnot a hard thing to compute.",
    "start": "546560",
    "end": "553617"
  },
  {
    "text": "So can we do that quickly? So what's this\nterm, first of all?",
    "start": "553617",
    "end": "560020"
  },
  {
    "start": "560020",
    "end": "566950"
  },
  {
    "text": "AUDIENCE: 0. RUSS TEDRAKE: It's\ngoing to be 0, right? If we're at a fixed\npoint, then the derivative",
    "start": "566950",
    "end": "575270"
  },
  {
    "text": "at that fixed point better be 0. So this guy just disappears. ",
    "start": "575270",
    "end": "581360"
  },
  {
    "text": "Partial f, partial x\nwe'll look at real quick. Partial f, partial u turns\nout to be not too hard. Let's do a partial\nf, partial u first.",
    "start": "581360",
    "end": "588110"
  },
  {
    "text": "It's even easier. ",
    "start": "588110",
    "end": "596430"
  },
  {
    "start": "595000",
    "end": "952000"
  },
  {
    "text": "So this is a vector, right? So I'm going to end up with,\nin general, a matrix of here,",
    "start": "596430",
    "end": "605700"
  },
  {
    "text": "which contains the\nterms partial q",
    "start": "605700",
    "end": "611730"
  },
  {
    "text": "dot, roughly, partial u,\nand partial q double dot,",
    "start": "611730",
    "end": "616760"
  },
  {
    "text": "partial u. ",
    "start": "616760",
    "end": "621764"
  },
  {
    "text": "So what's partial\nq dot, partial u? ",
    "start": "621764",
    "end": "626901"
  },
  {
    "text": "AUDIENCE: 0. RUSS TEDRAKE: 0, right? ",
    "start": "626901",
    "end": "634480"
  },
  {
    "text": "Partial q double\ndot, partial u, well, that turns out to be--\neven though there's a lot of matrices\nflying around here",
    "start": "634480",
    "end": "641709"
  },
  {
    "text": "with possibly nonlinear\nthings inside, everything's linear in u.",
    "start": "641710",
    "end": "646960"
  },
  {
    "text": "So that's actually\npretty easy to write too. That turns out to be H inverse\nB. And this whole thing is",
    "start": "646960",
    "end": "659660"
  },
  {
    "text": "going to be evaluated at our-- ",
    "start": "659660",
    "end": "668029"
  },
  {
    "text": "u doesn't matter in this\ncase-- but evaluated at our fixed point. ",
    "start": "668030",
    "end": "677160"
  },
  {
    "text": "OK, what about\npartial f, partial x? ",
    "start": "677160",
    "end": "692910"
  },
  {
    "text": "So now x is a bigger thing. So I'm going to have partial\nq dot, partial q here.",
    "start": "692910",
    "end": "700430"
  },
  {
    "text": "This is sort of a block\nmatrix form I'm using here-- partial q dot,\npartial q dot here,",
    "start": "700430",
    "end": "707850"
  },
  {
    "text": "and then partial q double\ndot, partial q, partial q double dot, partial q dot.",
    "start": "707850",
    "end": "715800"
  },
  {
    "start": "715800",
    "end": "721360"
  },
  {
    "text": "What's this? AUDIENCE: 0. RUSS TEDRAKE: 0.",
    "start": "721360",
    "end": "726990"
  },
  {
    "text": "What's this one? AUDIENCE: 1. RUSS TEDRAKE: 1, or\nmore generally, I, yeah. ",
    "start": "726990",
    "end": "735840"
  },
  {
    "text": "q double dot, partial q-- ",
    "start": "735840",
    "end": "744930"
  },
  {
    "text": "we need to use our chain rule. This is, something\ndepends on q times something else\nthat depends on q.",
    "start": "744930",
    "end": "751650"
  },
  {
    "text": "So it's going to be partial\nH inverse, partial q,",
    "start": "751650",
    "end": "757710"
  },
  {
    "text": "times Bu minus Cq dot minus\nG, plus H inverse, partial",
    "start": "757710",
    "end": "766285"
  },
  {
    "text": "of that whole inside. ",
    "start": "766285",
    "end": "781250"
  },
  {
    "text": "And H is potentially\na little messy. H inverse is\nprobably more messy.",
    "start": "781250",
    "end": "787550"
  },
  {
    "text": "But it turns out this is going\nto be very simple, again, for us. So I claim that this\nterm at the fixed point",
    "start": "787550",
    "end": "797480"
  },
  {
    "text": "has also got to be 0.  Do you buy that? Yep.",
    "start": "797480",
    "end": "802843"
  },
  {
    "text": " This thing has got to\nequal H, q double dot.",
    "start": "802843",
    "end": "809440"
  },
  {
    "text": "H is positive definite. So for q double dot to be\n0, this had better be 0.",
    "start": "809440",
    "end": "817540"
  },
  {
    "text": "So that whole thing goes to 0. So this term-- or we don't\nhave to do partial H inverse,",
    "start": "817540",
    "end": "823630"
  },
  {
    "text": "partial q-- great. And this one, again, is\nactually pretty simple.",
    "start": "823630",
    "end": "829540"
  },
  {
    "text": " In the very first\nlecture, I did use B",
    "start": "829540",
    "end": "835310"
  },
  {
    "text": "as potentially a function of q. But for these examples,\nit certainly isn't. It's just a constant.",
    "start": "835310",
    "end": "841670"
  },
  {
    "text": "So this doesn't have\nany dependence on q. C does depend on q. G does depend on q.",
    "start": "841670",
    "end": "847336"
  },
  {
    "text": "But at the fixed\npoint, q dot had better be 0, if it's a fixed point.",
    "start": "847336",
    "end": "853158"
  },
  {
    "text": "So the only term that\nactually survives out of this whole potentially\nscary thing is--",
    "start": "853158",
    "end": "858460"
  },
  {
    "text": " yeah, good-- is negative H\ninverse, partial G, partial q.",
    "start": "858460",
    "end": "868670"
  },
  {
    "start": "868670",
    "end": "881980"
  },
  {
    "text": "Take the derivative\nwith respect to q dot. Again, this term is 0.",
    "start": "881980",
    "end": "887260"
  },
  {
    "text": "So no matter-- H inverse, partial q\ndot doesn't matter. And then what in here\ndepends on q dot?",
    "start": "887260",
    "end": "896139"
  },
  {
    "text": "Well, C depends on q dot,\nboth directly and internally.",
    "start": "896140",
    "end": "902110"
  },
  {
    "text": "So we end up with partial--",
    "start": "902110",
    "end": "907360"
  },
  {
    "text": "so H inverse, partial C, partial\nq dot, times q dot, plus--",
    "start": "907360",
    "end": "919149"
  },
  {
    "text": "I'll do the whole\nthing as minus here-- plus C. But again, q dot\nis 0 at the fixed point,",
    "start": "919150",
    "end": "932110"
  },
  {
    "text": "so it ends up-- this whole scary\nthing reduces to H inverse C.",
    "start": "932110",
    "end": "938110"
  },
  {
    "text": " AUDIENCE: So G is\n[INAUDIBLE] of [? theta? ?]",
    "start": "938110",
    "end": "945980"
  },
  {
    "text": "RUSS TEDRAKE:\nThat's correct, yep. Those are our\ngravitational terms, yeah. ",
    "start": "945980",
    "end": "952780"
  },
  {
    "text": "OK, so this whole potentially\nscary thing works out",
    "start": "952780",
    "end": "959640"
  },
  {
    "text": "to be 0, I, negative H\ninverse, partial G, partial q,",
    "start": "959640",
    "end": "981020"
  },
  {
    "text": "negative H inverse, C. OK?",
    "start": "981020",
    "end": "1003940"
  },
  {
    "text": " There's a lot of beauty in\nthe manipulator equations.",
    "start": "1003940",
    "end": "1009250"
  },
  {
    "start": "1006000",
    "end": "1128000"
  },
  {
    "text": "It's a very nice middle ground\nbetween sort of any arbitrary",
    "start": "1009250",
    "end": "1016570"
  },
  {
    "text": "nonlinear system, but\nit's got enough structure that you can play a lot\nof tricks like this. And often, things simplify.",
    "start": "1016570",
    "end": "1023234"
  },
  {
    "text": "So I actually think it's\na beautiful representation that we're lucky to\nhave in robotics. ",
    "start": "1023234",
    "end": "1043619"
  },
  {
    "text": "OK, now I've got this form. That's a linear\nsystem here, right?",
    "start": "1043619",
    "end": "1048990"
  },
  {
    "text": "I've got-- if I just call\nthis thing A and this thing B, then I've got x equals\nAx plus Bu here.",
    "start": "1048990",
    "end": "1059546"
  },
  {
    "text": " And if you prefer to\nreally make it linear,",
    "start": "1059546",
    "end": "1067190"
  },
  {
    "text": "then let's define x bar\nto be x minus x star,",
    "start": "1067190",
    "end": "1073909"
  },
  {
    "text": "u bar to be u minus u star,\nto put the origin at the fixed",
    "start": "1073910",
    "end": "1078920"
  },
  {
    "text": "point. Oops.  Now, x bar dot is\njust x dot minus--",
    "start": "1078920",
    "end": "1090660"
  },
  {
    "text": "this thing's-- that's\n0, so it's just x dot. So I could equally write\nthis as Ax bar plus Bu bar.",
    "start": "1090660",
    "end": "1100410"
  },
  {
    "start": "1100410",
    "end": "1113300"
  },
  {
    "text": "OK, so given the manipulator\nequations for the Acrobot, for the cart-pole, it's trivial\nto find a local approximation",
    "start": "1113300",
    "end": "1122360"
  },
  {
    "text": "of those dynamics which is\nvalid around the fixed point we're trying to stabilize. ",
    "start": "1122360",
    "end": "1129450"
  },
  {
    "text": "And if I have that, then I could\nplay some of the linear control games that we started with.",
    "start": "1129450",
    "end": "1136610"
  },
  {
    "text": "So the first thing to try,\nlet's do LQR at the top.",
    "start": "1136610",
    "end": "1142196"
  },
  {
    "text": "It turns out LQR at the\ntop just works really well. It's not too\nsurprising, I guess.",
    "start": "1142196",
    "end": "1149660"
  },
  {
    "text": "Actually, before we do\nLQR, let me take a minute and actually decide\nif we should--",
    "start": "1149660",
    "end": "1156680"
  },
  {
    "text": "if it's proper to do LQR. So there's a\ncondition in LQR that had to be met in that\nderivation that I threw at you.",
    "start": "1156680",
    "end": "1163700"
  },
  {
    "text": " If the infinite horizon cost,\nthat integral wasn't bounded,",
    "start": "1163700",
    "end": "1173450"
  },
  {
    "text": "if your system didn't\nget to the origin, then the LQR cost\nwould be infinite,",
    "start": "1173450",
    "end": "1180740"
  },
  {
    "text": "and the LQR derivation\nwould break.  If your system-- if you\ncannot, with feedback,",
    "start": "1180740",
    "end": "1189950"
  },
  {
    "text": "drive your system so that\nx is at the fixed point, then the LQR cost function\nwill accumulate cost forever",
    "start": "1189950",
    "end": "1198620"
  },
  {
    "text": "and blow up. So really, the first\nthing, before we apply LQR, we better take a\nsecond to decide",
    "start": "1198620",
    "end": "1204650"
  },
  {
    "text": "if we think the system can get\nto the origin with feedback. ",
    "start": "1204650",
    "end": "1210050"
  },
  {
    "text": "And that condition is\ncalled controllability. And controllability is\na very powerful concept.",
    "start": "1210050",
    "end": "1217737"
  },
  {
    "start": "1213000",
    "end": "1429000"
  },
  {
    "text": "And I want to make\nsure you understand the relationship\nbetween controllability and underactuation. ",
    "start": "1217737",
    "end": "1238180"
  },
  {
    "text": "So the question is-- ",
    "start": "1238180",
    "end": "1251350"
  },
  {
    "text": "for this system,\nthe question is, if I have my linear system\nand I started in some initial",
    "start": "1251350",
    "end": "1258940"
  },
  {
    "text": "conditions that are non-0-- otherwise it's not\nso interesting-- if my initial\nconditions are non-0,",
    "start": "1258940",
    "end": "1266290"
  },
  {
    "text": "can I design a feedback\nlaw, find some actions, u, that will drive my system\nto 0 in a finite time?",
    "start": "1266290",
    "end": "1273970"
  },
  {
    "text": " So more generally, the\ndefinition of controllability",
    "start": "1273970",
    "end": "1283140"
  },
  {
    "text": "says-- ",
    "start": "1283140",
    "end": "1309430"
  },
  {
    "text": "let's say, x at 0 equals\nsome initial conditions",
    "start": "1309430",
    "end": "1316480"
  },
  {
    "text": "to x at some final time to be\nsome other initial conditions,",
    "start": "1316480",
    "end": "1334799"
  },
  {
    "text": "given unbounded actions\nin a finite time.",
    "start": "1334800",
    "end": "1344940"
  },
  {
    "start": "1344940",
    "end": "1361679"
  },
  {
    "text": "So controllability\nis actually the thing we care about in life. For nonlinear systems,\ncontrollability is actually",
    "start": "1361680",
    "end": "1368910"
  },
  {
    "text": "incredibly hard to evaluate. Most systems tend\nto be controllable. But it's a hard thing to\nevaluate for nonlinear systems.",
    "start": "1368910",
    "end": "1378512"
  },
  {
    "text": "For linear systems,\nwe have all the tools we could dream of to\nevaluate the controllability of the system.",
    "start": "1378512",
    "end": "1383520"
  },
  {
    "text": " So for linear controllability,\nit's sufficient to say,",
    "start": "1383520",
    "end": "1399450"
  },
  {
    "text": "x, t final equals 0.",
    "start": "1399450",
    "end": "1405090"
  },
  {
    "text": "So a lot of times\nfor linear systems, people just ask controllable--\nsay it's controllable if I can drive my system from\nany initial conditions to 0",
    "start": "1405090",
    "end": "1412290"
  },
  {
    "text": "in a finite time. And because everything's\nnice and linear, that's actually-- that's\nequivalent to the stronger",
    "start": "1412290",
    "end": "1418890"
  },
  {
    "text": "definition for linear systems. In nonlinear systems,\nyou have to evaluate every initial condition,\nevery final condition,",
    "start": "1418890",
    "end": "1425638"
  },
  {
    "text": "if you're not careful.  So what do you think? If the system is\nunderactuated, then",
    "start": "1425638",
    "end": "1434070"
  },
  {
    "start": "1429000",
    "end": "1643000"
  },
  {
    "text": "do you think it can\nbe controllable? ",
    "start": "1434070",
    "end": "1442160"
  },
  {
    "text": "If I choose some place,\nsome state for the Acrobot,",
    "start": "1442160",
    "end": "1450380"
  },
  {
    "text": "and I choose a\nfinite time, can you design a controller, potentially\nwith really big actions,",
    "start": "1450380",
    "end": "1458840"
  },
  {
    "text": "that gets me there\nin finite time? AUDIENCE: No. ",
    "start": "1458840",
    "end": "1466206"
  },
  {
    "text": "RUSS TEDRAKE: Tell me why. Tell me why you say no. AUDIENCE: Well, it can\n[INAUDIBLE] you potentially",
    "start": "1466207",
    "end": "1472725"
  },
  {
    "text": "[INAUDIBLE] stabilize\nfor Acrobot. So regardless of the fact,\nwhich [INAUDIBLE] you",
    "start": "1472725",
    "end": "1479009"
  },
  {
    "text": "can reach that [? theta. ?] RUSS TEDRAKE: But\nthere's nothing to say I can't leave\nthat state and come back",
    "start": "1479010",
    "end": "1485550"
  },
  {
    "text": "in some very finite, very\nsmall amount of time. ",
    "start": "1485550",
    "end": "1494720"
  },
  {
    "text": "So you're saying, if\nI ask you to go here at some small amount of\ntime, and I start right here,",
    "start": "1494720",
    "end": "1499860"
  },
  {
    "text": "then I can't be there in\nsome small amount of time. But what if I put in so much\nactuation that I go like this and I'm back there?",
    "start": "1499860",
    "end": "1504972"
  },
  {
    "start": "1504972",
    "end": "1511840"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] have\nto stay in the final state? RUSS TEDRAKE: No,\nit does not have to stay in the final state.",
    "start": "1511840",
    "end": "1516970"
  },
  {
    "text": " AUDIENCE: So\nunderactuated implies that the local dimensionality\nof the reachable state-space",
    "start": "1516970",
    "end": "1524720"
  },
  {
    "text": "is lower than the\nfull dimension, right? So if you just shrink\nyour finite time to an arbitrarily\nsmall time, we won't",
    "start": "1524720",
    "end": "1533299"
  },
  {
    "text": "be able to reach states\noutside that [INAUDIBLE].. RUSS TEDRAKE: I think that--\nso this is exactly the point.",
    "start": "1533300",
    "end": "1538760"
  },
  {
    "text": "So what he said is, he says,\nthe underactuation is-- I'll use the word instantaneous. It's an instantaneous\nconstraint on what you can do.",
    "start": "1538760",
    "end": "1545955"
  },
  {
    "text": "At any incident in time, I\ncan only produce accelerations in a certain direction. So how can I possibly,\nin some-- if I",
    "start": "1545955",
    "end": "1551899"
  },
  {
    "text": "make my finite\ntime small enough, how can I possibly get there? Well, finite time is actually\ndifferent than 0 time.",
    "start": "1551900",
    "end": "1559679"
  },
  {
    "text": "And the actions can\npotentially be huge. But actually, most-- a lot\nof the underactuated systems",
    "start": "1559680",
    "end": "1565460"
  },
  {
    "text": "are controllable. So we'll see it carefully in\nthe linearization of this.",
    "start": "1565460",
    "end": "1573740"
  },
  {
    "text": "But actually, controllability--\nif you get one thing out of this lecture-- and I'm going to write\nat the end of the lecture",
    "start": "1573740",
    "end": "1579190"
  },
  {
    "text": "again on the board-- there's a difference\nbetween controllability and underactuation. A lot of the underactuated\nsystems are, in fact,",
    "start": "1579190",
    "end": "1586190"
  },
  {
    "text": "controllable. And that's what makes-- gives us a few more things\nto talk about in the class.",
    "start": "1586190",
    "end": "1591620"
  },
  {
    "text": " So let's see if I can\nmake that point to you.",
    "start": "1591620",
    "end": "1599000"
  },
  {
    "text": " So how do we talk\nabout controllability,",
    "start": "1599000",
    "end": "1605700"
  },
  {
    "text": "in a linear system even?  So what are the tools people\nuse for controllability",
    "start": "1605700",
    "end": "1612150"
  },
  {
    "text": "in a linear system? If you used them, call them out. ",
    "start": "1612150",
    "end": "1617410"
  },
  {
    "text": "Who's used\ncontrollability tools? Yeah. AUDIENCE: There's the matrix\nC times B, C times A, times B,",
    "start": "1617410",
    "end": "1626270"
  },
  {
    "text": "write it all out,\nthen find the rank. Would that be true? RUSS TEDRAKE: Good, there's\na controllability matrix. AUDIENCE: There's a\ncontrollability Gramian,",
    "start": "1626270",
    "end": "1632213"
  },
  {
    "text": "I think. RUSS TEDRAKE: Awesome, there's\na controllability Gramian, which turns out to be\nalmost exactly the--",
    "start": "1632213",
    "end": "1639470"
  },
  {
    "text": "what came out of\nour LQR derivation. Those are the two big ones.",
    "start": "1639470",
    "end": "1645027"
  },
  {
    "text": "So there are\ncontrollability matrices, controllability Gramians. I'm going to say\na minute about it. But if you care about--",
    "start": "1645027",
    "end": "1650040"
  },
  {
    "text": "we can actually-- both\nof those are a little bit unintuitive, actually. And the proofs are-- the proof\nof the Gramian's not bad,",
    "start": "1650040",
    "end": "1655790"
  },
  {
    "text": "but the proof of the-- the derivation of the\ncontrollability matrix is a little bit of black magic.",
    "start": "1655790",
    "end": "1661850"
  },
  {
    "text": "So I decided instead to\nlet's do a simpler case where we can actually understand it.",
    "start": "1661850",
    "end": "1667549"
  },
  {
    "text": "But it'll be a less\ngeneral result.",
    "start": "1667550",
    "end": "1672590"
  },
  {
    "text": "So let's look at the x dot\nequals Ax plus Bu system. ",
    "start": "1672590",
    "end": "1685320"
  },
  {
    "text": "I'm going to make\nour derivation easier by making an assumption\nthat the eigenvalues of A",
    "start": "1685320",
    "end": "1691429"
  },
  {
    "text": "are all unique. ",
    "start": "1691430",
    "end": "1709429"
  },
  {
    "text": "If you're willing to\nmake that assumption, we can see a lot of things. The more general\nderivations don't have that,",
    "start": "1709430",
    "end": "1715430"
  },
  {
    "text": "but require black magic. ",
    "start": "1715430",
    "end": "1722390"
  },
  {
    "text": "OK, so if you remember, our\neigenvalue thing, an eigenvalue",
    "start": "1722390",
    "end": "1729530"
  },
  {
    "text": "means that multiplying\nA times that is just the same as\nmultiplying a scalar times n. ",
    "start": "1729530",
    "end": "1737809"
  },
  {
    "text": "If I compose all the-- sorry, these are eigenvectors. That's an eigenvalue. If I compose them all\ninto a matrix form,",
    "start": "1737810",
    "end": "1745260"
  },
  {
    "text": "I can see A times V, where\nV has all the eigenvectors",
    "start": "1745260",
    "end": "1750710"
  },
  {
    "text": "as columns, is equivalent to-- well, let's write it\nlike V times lambda,",
    "start": "1750710",
    "end": "1757174"
  },
  {
    "text": "where lambda is a\ndiagonal matrix, which has lambda 1, lambda 2, and so on.",
    "start": "1757175",
    "end": "1763429"
  },
  {
    "start": "1763430",
    "end": "1773920"
  },
  {
    "text": "The cool thing about-- the reason we assume that\nthere's no repeated eigenvalues",
    "start": "1773920",
    "end": "1780309"
  },
  {
    "text": "is that it implies\nthat all of the--",
    "start": "1780310",
    "end": "1786760"
  },
  {
    "text": "eigenvalues are unique implies\nthat all the eigenvectors are actually unique and that\nthey span the space.",
    "start": "1786760",
    "end": "1792910"
  },
  {
    "text": "And it implies that\nV inverse exists.  As soon as you have\nrepeated eigenvalues,",
    "start": "1792910",
    "end": "1799360"
  },
  {
    "text": "you don't have that\nsimplification. You have to do repeated\nroots and things. ",
    "start": "1799360",
    "end": "1805570"
  },
  {
    "start": "1805000",
    "end": "1998000"
  },
  {
    "text": "But in that\nsimplification, we can switch to modal coordinates.",
    "start": "1805570",
    "end": "1810678"
  },
  {
    "start": "1810678",
    "end": "1822900"
  },
  {
    "text": "So let's-- if V is full\nrank, then I can just change coordinates from x through\nV inverse to some other",
    "start": "1822900",
    "end": "1831740"
  },
  {
    "text": "coordinate system r. ",
    "start": "1831740",
    "end": "1855480"
  },
  {
    "text": "Why is that a good idea? That's a good idea, because\nthen r dot is just going to be--",
    "start": "1855480",
    "end": "1862200"
  },
  {
    "text": "so V inverse times x\ndot, which is A times Vr.",
    "start": "1862200",
    "end": "1870000"
  },
  {
    "start": "1870000",
    "end": "1884260"
  },
  {
    "text": "That's just substituting\nthis into the x dot equals Ax plus Bu. But what's V inverse AV?",
    "start": "1884260",
    "end": "1891880"
  },
  {
    "text": "If you look at this, that's\njust our diagonal matrix.",
    "start": "1891880",
    "end": "1897070"
  },
  {
    "start": "1897070",
    "end": "1906440"
  },
  {
    "text": "So on the eigen-- in the modal\ndecomposition, the systems",
    "start": "1906440",
    "end": "1915990"
  },
  {
    "text": "evolve without coupling. I can write--\ncomponent-wise, I could say,",
    "start": "1915990",
    "end": "1921840"
  },
  {
    "text": "ri dot, the i-th component\nis just lambda ir,",
    "start": "1921840",
    "end": "1927390"
  },
  {
    "text": "plus some contributions\nfrom this guy. ",
    "start": "1927390",
    "end": "1961720"
  },
  {
    "text": "So now I'm looking at my--\nin these modal coordinates, I'm saying that the\nresult of applying A--",
    "start": "1961720",
    "end": "1968860"
  },
  {
    "text": "this is the same\nthing I wrote before. This is the reason we can\nmake-- in these phase plots, we can find the\neigenvectors and just",
    "start": "1968860",
    "end": "1976450"
  },
  {
    "text": "talk about the dynamics on\nthose eigenvectors, same thing. It just says that,\non the eigenvectors,",
    "start": "1976450",
    "end": "1983320"
  },
  {
    "text": "the dynamics are\njust the eigenvalues.",
    "start": "1983320",
    "end": "1990159"
  },
  {
    "text": "And then they've got\nthis impulse, this input from the control actions.",
    "start": "1990160",
    "end": "1998657"
  },
  {
    "start": "1998000",
    "end": "3180000"
  },
  {
    "text": "So now let's think\nabout what it would mean to be controllable\nin this sense. ",
    "start": "1998657",
    "end": "2012500"
  },
  {
    "text": "What kind of\nconditions would you want to say that the\nsystem is controllable?",
    "start": "2012500",
    "end": "2020454"
  },
  {
    "start": "2020454",
    "end": "2027990"
  },
  {
    "text": "Yeah. AUDIENCE: We can\nchange r dot using u.",
    "start": "2027990",
    "end": "2033120"
  },
  {
    "text": "RUSS TEDRAKE: You can\nchange r dot to do anything you want using u.",
    "start": "2033120",
    "end": "2040560"
  },
  {
    "text": "You'd like to be\nable to say, make it act like the eigenvalues were\narbitrarily fast, for instance,",
    "start": "2040560",
    "end": "2047060"
  },
  {
    "text": "or arbitrarily unstable, if you\nchose to do something so silly. ",
    "start": "2047060",
    "end": "2053638"
  },
  {
    "text": "So what is required to do that? ",
    "start": "2053639",
    "end": "2059669"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] from\nthe [? beta ?] values. There'd have to be some\nnon-0's [INAUDIBLE]..",
    "start": "2059670",
    "end": "2067000"
  },
  {
    "text": "RUSS TEDRAKE: Excellent. OK, so imagine you only have\na single thing you're trying to control and lots of inputs.",
    "start": "2067000",
    "end": "2074550"
  },
  {
    "text": "Then it should be sufficient\nthat, if any one of those betas is non-0, that should be enough.",
    "start": "2074550",
    "end": "2079739"
  },
  {
    "text": "OK, now let's say you have\nmultiple things you're trying to control.",
    "start": "2079739",
    "end": "2086888"
  },
  {
    "text": "You start having to worry\nabout whether you can use u to control eigenvector\n1 and eigenvector 2,",
    "start": "2086889",
    "end": "2093219"
  },
  {
    "text": "both at the same time. But it turns out,\nbecause we assumed",
    "start": "2093219",
    "end": "2098950"
  },
  {
    "text": "we're in the case of\ndistinct eigenvalues,",
    "start": "2098950",
    "end": "2105287"
  },
  {
    "text": "if you think really hard-- and\nI will write a little bit more about this-- but it\nturns out it's still OK to just have one thing\nthat can control you.",
    "start": "2105288",
    "end": "2114190"
  },
  {
    "text": "Because things are converging\nat different rates, it's actually sufficient\nto be able to control--",
    "start": "2114190",
    "end": "2119710"
  },
  {
    "text": "if you can control each\nof them independently, then you can actually\ncontrol them all. So the condition turns\nout to be, for all i,",
    "start": "2119710",
    "end": "2128560"
  },
  {
    "text": "there exists a j, such that\nbeta ij is not equal to 0.",
    "start": "2128560",
    "end": "2138070"
  },
  {
    "start": "2138070",
    "end": "2151770"
  },
  {
    "text": "Beta ij, again, is my B\nmatrix, but also permutated",
    "start": "2151770",
    "end": "2158250"
  },
  {
    "text": "by this V inverse. So if I was looking at whether\nthe system was underactuated,",
    "start": "2158250",
    "end": "2169920"
  },
  {
    "text": "if B wasn't full\nrank, I'd be hosed. I'd be underactuated.",
    "start": "2169920",
    "end": "2175740"
  },
  {
    "text": "But this is actually a\nmuch less strict condition. I say, I only have to have\none of my-- in my eigen modes,",
    "start": "2175740",
    "end": "2184350"
  },
  {
    "text": "I have to be able to\ncontrol each of them.  So that's our first\nsort of glimpse",
    "start": "2184350",
    "end": "2191190"
  },
  {
    "text": "at how you could imagine an\nunderactuated system being completely controllable.",
    "start": "2191190",
    "end": "2198029"
  },
  {
    "text": "AUDIENCE: Is it\nthe same as saying that, if you have\n[? any ?] dimension that you want to control,\nthen beta should have at least",
    "start": "2198030",
    "end": "2206230"
  },
  {
    "text": "n different eigenvalues? [INAUDIBLE] RUSS TEDRAKE: So excellent--\nso this actually says--",
    "start": "2206230",
    "end": "2213435"
  },
  {
    "text": "for instance, in\nthe limit, let's take the case where you\nhave 100 degrees of freedom and one actuator.",
    "start": "2213435",
    "end": "2221260"
  },
  {
    "text": "As long as Bij is non-0 for\nall of those, then it says,",
    "start": "2221260",
    "end": "2226270"
  },
  {
    "text": "with my one actuator,\nI could control-- I can drive that 100 degree of\nfreedom system to the origin.",
    "start": "2226270",
    "end": "2232690"
  },
  {
    "text": "That's a great question,\na great example.",
    "start": "2232690",
    "end": "2238250"
  },
  {
    "text": "So it does not have that\nsame rank condition on B. AUDIENCE: So as long as\nnone of your eigenvectors",
    "start": "2238250",
    "end": "2243475"
  },
  {
    "text": "are in the null\nspace [INAUDIBLE].. ",
    "start": "2243475",
    "end": "2248887"
  },
  {
    "text": "RUSS TEDRAKE: Right. ",
    "start": "2248887",
    "end": "2254010"
  },
  {
    "text": "It's the-- I have to think\nabout what V inverse is, but I think that's right.",
    "start": "2254010",
    "end": "2259330"
  },
  {
    "text": "I think that's right. He said-- so you\ndon't want B to be",
    "start": "2259330",
    "end": "2266759"
  },
  {
    "text": "in the null space\nof the inverse. ",
    "start": "2266760",
    "end": "2274540"
  },
  {
    "text": "Right.  Do I see another\nquestion over there? No?",
    "start": "2274540",
    "end": "2281430"
  },
  {
    "text": "OK, so 100 degree of\nfreedom robot, one actuator, there's a chance that\nyou can control it.",
    "start": "2281430",
    "end": "2287420"
  },
  {
    "text": " Now it doesn't say anything\nabout the trajectory you're going to take to get there.",
    "start": "2287420",
    "end": "2293505"
  },
  {
    "text": "It might be really hard. But there's a chance\nyou can control it. ",
    "start": "2293505",
    "end": "2306810"
  },
  {
    "text": "There's lots of\nways to see this. Let's leave it at that, if\npeople are satisfied with that.",
    "start": "2306810",
    "end": "2312569"
  },
  {
    "text": "Let's not-- I won't do my\nsecond derivation here. But let's get straight\nto the example.",
    "start": "2312570",
    "end": "2320230"
  },
  {
    "text": "So now, that says that,\nif I take my Ax plus Bu",
    "start": "2320230",
    "end": "2326220"
  },
  {
    "text": "representation of the Acrobot,\nB is going to be low rank.",
    "start": "2326220",
    "end": "2333570"
  },
  {
    "text": "It's going to be-- ",
    "start": "2333570",
    "end": "2338790"
  },
  {
    "text": "so I used B actually\ntwice already today. Did you notice that? Anybody catch me on that?",
    "start": "2338790",
    "end": "2343968"
  },
  {
    "text": "I used B in the\nmanipulate equations, then I used B for\nthe block form. And I swear I've lost\nsleep trying to figure out",
    "start": "2343968",
    "end": "2350550"
  },
  {
    "text": "if I could put another\nletter in there, but I'm not happy with\nany other letters, because they both-- they\nalmost mean the same thing.",
    "start": "2350550",
    "end": "2355987"
  },
  {
    "text": "But I did slip that one past. So this is B in the linear form.",
    "start": "2355987",
    "end": "2361980"
  },
  {
    "text": " So it's not just 0, 1. It's H inverse times 0, 1.",
    "start": "2361980",
    "end": "2367710"
  },
  {
    "text": " So it's going to have some 0's. ",
    "start": "2367710",
    "end": "2377108"
  },
  {
    "text": "Sorry, it doesn't-- so it's\ngoing to be a vector again.",
    "start": "2377108",
    "end": "2384517"
  },
  {
    "text": "It actually doesn't\nhave to have 0's. And in fact, it\nprobably won't have 0's. I misspoke. This is going to be H1, 1, H1,\n2 in the Acrobot case, H inverse",
    "start": "2384518",
    "end": "2395810"
  },
  {
    "text": "1, 1. ",
    "start": "2395810",
    "end": "2404300"
  },
  {
    "text": "The question is-- it's still\nlow rank because it's a column.",
    "start": "2404300",
    "end": "2409820"
  },
  {
    "text": "It's not a full matrix, so\nit's still underactuated. And can I drive that\nthing with LQR to the top?",
    "start": "2409820",
    "end": "2417740"
  },
  {
    "text": "We just said that it's possible\nthat these things are still controllable.",
    "start": "2417740",
    "end": "2422960"
  },
  {
    "text": "The tests that you can\nuse, the user's guide to controllability--",
    "start": "2422960",
    "end": "2428224"
  },
  {
    "start": "2428224",
    "end": "2435140"
  },
  {
    "text": "there's this funky\ntest which says, if I take a matrix, a\ncontrollability matrix, which",
    "start": "2435140",
    "end": "2442970"
  },
  {
    "text": "is the B matrix, AB--",
    "start": "2442970",
    "end": "2449090"
  },
  {
    "text": "these are just cascaded\nin columns here, A squared B up to\nthe A to the n, B,",
    "start": "2449090",
    "end": "2462890"
  },
  {
    "text": "where n is the number of states. ",
    "start": "2462890",
    "end": "2469742"
  },
  {
    "text": "AUDIENCE: Would it be n minus 1? [INAUDIBLE] RUSS TEDRAKE: n minus\n1-- thank you, yeah.",
    "start": "2469742",
    "end": "2476300"
  },
  {
    "start": "2476300",
    "end": "2481570"
  },
  {
    "text": "Good, yeah. It turns out that if\nthis matrix is still--",
    "start": "2481570",
    "end": "2487330"
  },
  {
    "text": "is full row rank, then the\nsystem is controllable.",
    "start": "2487330",
    "end": "2503698"
  },
  {
    "start": "2503698",
    "end": "2514755"
  },
  {
    "text": "There's actually--\nthe derivation of that is in your\nnotes that I'll post. ",
    "start": "2514755",
    "end": "2522099"
  },
  {
    "text": "It's not very hard,\nit's just a matter-- there's all these forms for e to\nthe AT, the matrix exponential.",
    "start": "2522100",
    "end": "2529780"
  },
  {
    "text": "And it involves one of the\nforms that kind of comes out of nowhere. And so I won't go through\nthe derivation on the board.",
    "start": "2529780",
    "end": "2536170"
  },
  {
    "text": "But it turns out that\nit's sufficient to check the rank of this matrix.",
    "start": "2536170",
    "end": "2542187"
  },
  {
    "text": "And that'll tell you if\nthe system's controllable. And this is sort of primal\nenough and important enough",
    "start": "2542187",
    "end": "2548770"
  },
  {
    "text": "that MATLAB has a\nfunction for it. So you can call-- I think it's ctrb, right?",
    "start": "2548770",
    "end": "2555040"
  },
  {
    "text": "Is that what it is? ",
    "start": "2555040",
    "end": "2565367"
  },
  {
    "text": "And then check the\nrank of it, and you could check if your\nsystems are controllable. ",
    "start": "2565367",
    "end": "2575400"
  },
  {
    "text": "It turns out, if you linearize\nthe dynamics of the Acrobot, you linearize the\ndynamics of the cart-pole,",
    "start": "2575400",
    "end": "2580690"
  },
  {
    "text": "you pop in the A and B, you\nget a full rank matrix out. So they're both controllable,\neven though they're",
    "start": "2580690",
    "end": "2587380"
  },
  {
    "text": "underactuated around the top. AUDIENCE: Would these\nbe in [INAUDIBLE]??",
    "start": "2587380",
    "end": "2593300"
  },
  {
    "text": "RUSS TEDRAKE: Yes.  It's the linear form.",
    "start": "2593300",
    "end": "2599020"
  },
  {
    "text": " Maybe I should call it B\nprime or something like that.",
    "start": "2599020",
    "end": "2604900"
  },
  {
    "text": "But still, it feels\nunnatural to use either-- anything else in either case. ",
    "start": "2604900",
    "end": "2623530"
  },
  {
    "text": "AUDIENCE: So these\nmatrices are calculated for every single point, or-- ",
    "start": "2623530",
    "end": "2630520"
  },
  {
    "text": "RUSS TEDRAKE: So I just do it-- I evaluate these things\nonce at the x star.",
    "start": "2630520",
    "end": "2636010"
  },
  {
    "text": "So it's partial f, partial\nx, evaluated at x star. AUDIENCE: So when\nyou say something--",
    "start": "2636010",
    "end": "2641710"
  },
  {
    "text": "a system is controllable,\nbecause when we-- RUSS TEDRAKE: All\nI mean is that--",
    "start": "2641710",
    "end": "2647260"
  },
  {
    "text": "all I can show with the rank\ncondition check in MATLAB is that the system linearized--\nthe linear system that",
    "start": "2647260",
    "end": "2653200"
  },
  {
    "text": "approximates the Acrobot\nlinearized around the top is controllable. Mm-hmm.",
    "start": "2653200",
    "end": "2658640"
  },
  {
    "text": "AUDIENCE: So controllability\nis defined [INAUDIBLE]??",
    "start": "2658640",
    "end": "2664269"
  },
  {
    "text": "RUSS TEDRAKE: No,\ncontrollability is a property of the system. The linearization,\nthe linear system",
    "start": "2664270",
    "end": "2670840"
  },
  {
    "text": "is only a relevant approximation\nof the Acrobot around a given state.",
    "start": "2670840",
    "end": "2676600"
  },
  {
    "text": "And I'm saying that\nthe linear system-- you can evaluate the\nlinear system anywhere it's controllable.",
    "start": "2676600",
    "end": "2682270"
  },
  {
    "text": "I can go from any\ninitial condition. But it's only a\nrelevant example-- it's only relevant\nto the Acrobot",
    "start": "2682270",
    "end": "2688090"
  },
  {
    "text": "if it's close to\nthe fixed point. ",
    "start": "2688090",
    "end": "2693846"
  },
  {
    "text": "AUDIENCE: So that definition\nactually is for all the states. RUSS TEDRAKE: That's right.",
    "start": "2693846",
    "end": "2700099"
  },
  {
    "text": "So yes, if I can\nsay this stronger thing for the nonlinear\nsystem, for the Acrobot,",
    "start": "2700100",
    "end": "2707060"
  },
  {
    "text": "in order to say that, I would\nhave to say, for any state, this is true. I can't say that.",
    "start": "2707060",
    "end": "2712730"
  },
  {
    "text": "I went to a weaker\nform by looking just at the linear system. Mm-hmm. ",
    "start": "2712730",
    "end": "2730830"
  },
  {
    "text": "That's pretty big. ",
    "start": "2730830",
    "end": "2738960"
  },
  {
    "text": "Is that big enough? AUDIENCE: Mm-hmm. RUSS TEDRAKE: Yeah? OK. ",
    "start": "2738960",
    "end": "2745190"
  },
  {
    "text": "So let's take our\nA and B matrices",
    "start": "2745190",
    "end": "2750200"
  },
  {
    "text": "that we got from doing the\nlinearization around the fixed point. And if you like, if it\nhelps, I can sort of",
    "start": "2750200",
    "end": "2756859"
  },
  {
    "text": "show you how that goes. ",
    "start": "2756860",
    "end": "2765110"
  },
  {
    "text": "So very literally, I take\nmy manipulator equations,",
    "start": "2765110",
    "end": "2770160"
  },
  {
    "text": "I get an H, C, G, and B. I take the gradient-- the partial G, partial\nq, I compute that.",
    "start": "2770160",
    "end": "2778490"
  },
  {
    "text": "And then my A is negative\ninverse partial G, partial q. And then the--",
    "start": "2778490",
    "end": "2784460"
  },
  {
    "text": "C happens to be 0\nfor the Acrobot. I evaluated at the top,\nbut that's not a general,",
    "start": "2784460",
    "end": "2792300"
  },
  {
    "text": "so that's why I don't have the\nnegative H inverse C there, and then my inverse H, B. So\nthat gives me an A and a B.",
    "start": "2792300",
    "end": "2803599"
  },
  {
    "text": "And I can write\nmy LQR controller",
    "start": "2803600",
    "end": "2810720"
  },
  {
    "text": "to balance it at the\ntop, by literally getting a and B from the linearized\nsystem, calling LQR.",
    "start": "2810720",
    "end": "2819960"
  },
  {
    "text": "I chose-- the LQR\nsyntax is A, B, q, r. So I chose q to be a diagonal\nmatrix, 10, 10, 1, 1,",
    "start": "2819960",
    "end": "2826769"
  },
  {
    "text": "just saying I penalize\nposition errors 10 times more than velocity\nerrors because it happens--",
    "start": "2826770",
    "end": "2833369"
  },
  {
    "text": "with units, you tend to do that. And r is 1.",
    "start": "2833370",
    "end": "2838458"
  },
  {
    "text": "And it's in a persistent loop\njust so I don't compute-- I don't call LQR every\ntime I call my function. I only call it every\ntime I start the system.",
    "start": "2838458",
    "end": "2846490"
  },
  {
    "text": "And then my control\nlaw is u equals negative k, x minus x desired. Now, you're going to do\nsort of the similar thing",
    "start": "2846490",
    "end": "2852869"
  },
  {
    "text": "to what I'm doing for\nthe Acrobot you're going to do for the cart-pole\nfor your problem set. I will bet that half of you\nwill forget to subtract out",
    "start": "2852870",
    "end": "2859020"
  },
  {
    "text": "x desired at least once. I know I do all the time. So remember the minus x desired.",
    "start": "2859020",
    "end": "2865530"
  },
  {
    "text": " If I put that at\nthe top, if I put",
    "start": "2865530",
    "end": "2872010"
  },
  {
    "text": "initial conditions near\nthe top, and I run it, look what happens.",
    "start": "2872010",
    "end": "2877590"
  },
  {
    "text": "Oops. ",
    "start": "2877590",
    "end": "2889987"
  },
  {
    "text": "OK, I'm going to\nstart it-- every time it flashes it's going to\nbe new initial condition.",
    "start": "2889987",
    "end": "2895080"
  },
  {
    "text": "It actually goes pretty far\nfrom the top and gets back.",
    "start": "2895080",
    "end": "2901680"
  },
  {
    "text": "Wow, that's a good one. If I-- I'm just choosing\nGaussian random variables",
    "start": "2901680",
    "end": "2908300"
  },
  {
    "text": "at the top. So if we watch long\nenough, we might see one fail catastrophically. So the LQR for the linear\nsystem will stabilize it",
    "start": "2908300",
    "end": "2915823"
  },
  {
    "text": "from any point because\nthe linear system is a bad approximation. For the nonlinear, if I started\nit way down at the bottom",
    "start": "2915823",
    "end": "2921480"
  },
  {
    "text": "it's just going to go nuts. Wow, that's pretty good. Now, you might notice that\nmy second link is pretty big",
    "start": "2921480",
    "end": "2928620"
  },
  {
    "text": "compared to my first link. That helps. And you'll see why\nin a few minutes.",
    "start": "2928620",
    "end": "2936119"
  },
  {
    "text": "But it's pretty good. AUDIENCE: Does it\nhave unbounded torque? RUSS TEDRAKE: It does\nhave unbounded torque.",
    "start": "2936120",
    "end": "2941470"
  },
  {
    "text": "Whoa. [LAUGHTER] That's pretty good. It does have\nunbounded torque, yep.",
    "start": "2941470",
    "end": "2946650"
  },
  {
    "text": "If I were to\nsaturate the torque, it probably wouldn't do as well.  Now, the cool thing is--",
    "start": "2946650",
    "end": "2953010"
  },
  {
    "text": "I can stop that. ",
    "start": "2953010",
    "end": "2958710"
  },
  {
    "text": "Stop.  These MATLAB timers\ndon't like to stop.",
    "start": "2958710",
    "end": "2966349"
  },
  {
    "text": "So I get these huge\nexcursions from the upright",
    "start": "2966350",
    "end": "2971470"
  },
  {
    "text": "in my balancing. But it's not actually\nbecause I started with crazy initial conditions.",
    "start": "2971470",
    "end": "2976580"
  },
  {
    "text": "If you noticed, it\nwasn't like the plot was going, oh, and starting\nover here and then coming up. It was actually going like this.",
    "start": "2976580",
    "end": "2984360"
  },
  {
    "text": "So if you look at\na time trajectory-- let's see if I got lucky. OK, almost all of\nthem are like this.",
    "start": "2984360",
    "end": "2990235"
  },
  {
    "text": "Are those lines\ndark enough to see? Yeah? The initial conditions\nare actually pretty small.",
    "start": "2990235",
    "end": "2998180"
  },
  {
    "text": "But in order to\nstabilize the system, it actually goes way\naway from the fixed point",
    "start": "2998180",
    "end": "3004900"
  },
  {
    "text": "and comes way back, big time. This is like-- this is\nthe velocity of 18 radians",
    "start": "3004900",
    "end": "3013600"
  },
  {
    "text": "per second or something. And then it finds its way back. ",
    "start": "3013600",
    "end": "3020650"
  },
  {
    "text": "So for that reason, you\nmight easily sort of, in LQR,",
    "start": "3020650",
    "end": "3026825"
  },
  {
    "text": "say, OK, my linearization\nis good here, so any initial conditions\nhere should work. But that's not actually true\nbecause your LQR might easily",
    "start": "3026825",
    "end": "3032907"
  },
  {
    "text": "drive you further away\nbefore it comes back. If you were to-- if you're\na linear controls guy,",
    "start": "3032907",
    "end": "3040480"
  },
  {
    "text": "and you were to do-- this is\na multi-input, multi-output system. But if you try to find\nthe poles and 0's, that's",
    "start": "3040480",
    "end": "3047050"
  },
  {
    "text": "what's this going to-- where are the 0's--\nis this going to be? AUDIENCE: [INAUDIBLE]",
    "start": "3047050",
    "end": "3053609"
  },
  {
    "text": "RUSS TEDRAKE: Yeah,\nthere's three 0's in the right f plane for\nthe Acrobot actually. It's a nonminimum phase system.",
    "start": "3053610",
    "end": "3059470"
  },
  {
    "text": " The cart-pole has one\n0 in the right f plane.",
    "start": "3059470",
    "end": "3064680"
  },
  {
    "text": " It's not a general property\nof underactuated systems.",
    "start": "3064680",
    "end": "3071820"
  },
  {
    "text": "But sometimes, in order to\ndo this with less actuators than you might like, you have\nto do crazy things to get back",
    "start": "3071820",
    "end": "3079440"
  },
  {
    "text": "to where you want to go. So I can get-- and I could--\nif I tightened my time limit,",
    "start": "3079440",
    "end": "3084570"
  },
  {
    "text": "the things I would do\nwould be even crazier. But I could still do it. ",
    "start": "3084570",
    "end": "3099090"
  },
  {
    "text": "It's actually-- just to say\nit, without really teaching it, but if you did care about sort\nof the basin of attraction",
    "start": "3099090",
    "end": "3107940"
  },
  {
    "text": "of these systems, if you wanted\nto do as well as you possibly",
    "start": "3107940",
    "end": "3113790"
  },
  {
    "text": "could with a linear controller\non the nonlinear system, you probably wouldn't\ndo what we just did.",
    "start": "3113790",
    "end": "3119609"
  },
  {
    "text": "There's better tools from\nrobust control, which would allow you to sort of\ndesign a linear controller",
    "start": "3119610",
    "end": "3125250"
  },
  {
    "text": "but explicitly reason about\nhow nonlinear the thing gets when you're away. And you can design\na linear controller",
    "start": "3125250",
    "end": "3131670"
  },
  {
    "text": "that has a bigger\nbasin of attraction than if you just don't reason\nabout the nonlinearities",
    "start": "3131670",
    "end": "3136830"
  },
  {
    "text": "at all. So you can put a bound on how\nnonlinear things are and do a robust control\nsynthesis, and get,",
    "start": "3136830",
    "end": "3143380"
  },
  {
    "text": "in some sense, a\nbetter controller. You would have lower\nperformance, potentially,",
    "start": "3143380",
    "end": "3149460"
  },
  {
    "text": "but it would work better\non the nonlinear system, bigger basin of attraction. AUDIENCE: [INAUDIBLE]",
    "start": "3149460",
    "end": "3158220"
  },
  {
    "text": "RUSS TEDRAKE: Oh, my fixed\npoint was pi 0, 0, 0. Or-- yeah.",
    "start": "3158220",
    "end": "3166663"
  },
  {
    "text": "So those are all going to\n0, that one's going to pi, as they should. Yep. ",
    "start": "3166663",
    "end": "3180400"
  },
  {
    "start": "3180000",
    "end": "3457000"
  },
  {
    "text": "OK, excellent. So LQR works, right? And it works-- this is actually\nsort of a problem, in my mind.",
    "start": "3180400",
    "end": "3188890"
  },
  {
    "text": "Because that works and\nit works so well And so many different\nsystems, that's why people haven't thought about\nnonlinear control enough,",
    "start": "3188890",
    "end": "3194980"
  },
  {
    "text": "in my mind. It's sort of unfortunate\nthat that works so darn well, because sometimes\nthat's all people do.",
    "start": "3194980",
    "end": "3203200"
  },
  {
    "text": "So let's think about if we're\na little bit further from the fixed point, just to-- maybe\nI should even make the point--",
    "start": "3203200",
    "end": "3212280"
  },
  {
    "text": "in other words, you'll probably\nask me if I don't do this, because you always test\nme on the limits of where",
    "start": "3212280",
    "end": "3218020"
  },
  {
    "text": "my things work here. So what if I were to start it\nfar away from the fixed point?",
    "start": "3218020",
    "end": "3223540"
  },
  {
    "text": " Let's be more dramatic.",
    "start": "3223540",
    "end": "3229010"
  },
  {
    "text": " And let's just do it once.",
    "start": "3229010",
    "end": "3235275"
  },
  {
    "text": " Oh, see, that's bad. When it takes that\nlong, that means",
    "start": "3235275",
    "end": "3240470"
  },
  {
    "text": "the integrator's choking because\nit can't simulate things right. So it's just complete\nnonsense if it's too far",
    "start": "3240470",
    "end": "3246110"
  },
  {
    "text": "from the linearization point. ",
    "start": "3246110",
    "end": "3253160"
  },
  {
    "text": "So what if we want to do control\naway from that fixed point? Then nothing I just said\nhelps if I'm too far away",
    "start": "3253160",
    "end": "3259850"
  },
  {
    "text": "from that fixed point. So what do we do? Well, you don't have to throw\nout linearization completely.",
    "start": "3259850",
    "end": "3271700"
  },
  {
    "text": "We talked about, in\nthe first lecture, how the underactuated\nsystems are the systems that",
    "start": "3271700",
    "end": "3276890"
  },
  {
    "text": "are not feedback linearizable. That's what distinguishes them. They're not feedback\nlinearizable.",
    "start": "3276890",
    "end": "3283290"
  },
  {
    "text": "I can't just turn the nonlinear\nsystem into a linear system. But they are partial\nfeedback linearizable.",
    "start": "3283290",
    "end": "3291020"
  },
  {
    "text": "So if you want to\nstick to your guns and do feedback linearization,\nyou can do half the work.",
    "start": "3291020",
    "end": "3296510"
  },
  {
    "text": "So it actually is pretty\nelegant how that works out. ",
    "start": "3296510",
    "end": "3343849"
  },
  {
    "text": "OK, to keep things fresh, let's\ndo it on the cart-pole instead of the Acrobot. We've been talking\nabout the Acrobot a lot.",
    "start": "3343850",
    "end": "3349130"
  },
  {
    "text": "But I promise I wasn't\ngoing to do the derivation of the equations of\nmotion, and I won't.",
    "start": "3349130",
    "end": "3355250"
  },
  {
    "text": "But it turns out the\nresult of the cart-pole is simple enough I can\nwrite it real quick.",
    "start": "3355250",
    "end": "3361500"
  },
  {
    "text": "The equations of motion for\nthe cart-pole are mc plus mp.",
    "start": "3361500",
    "end": "3369675"
  },
  {
    "text": " And these are in your notes.",
    "start": "3369675",
    "end": "3375240"
  },
  {
    "text": "You don't have to\nwrite these down. I want you to see where\nthe next line comes from. ",
    "start": "3375240",
    "end": "3419900"
  },
  {
    "text": "OK, well, that's\na reasonable thing we might get out of\nthe Lagrange equations. I've got a force on my cart.",
    "start": "3419900",
    "end": "3426270"
  },
  {
    "text": "I've got a 0 in\nthe other equation. You can see how this\ncould be easily separated",
    "start": "3426270",
    "end": "3432380"
  },
  {
    "text": "into the manipulator equations. But since I'm going\nto be manipulating some of these things, let\nme just sort of arbitrarily",
    "start": "3432380",
    "end": "3440420"
  },
  {
    "text": "set all the parameters to 1. Let's just-- so-- ",
    "start": "3440420",
    "end": "3456950"
  },
  {
    "text": "it's easy to repeat these\nfor the real equations. But let's just do this.",
    "start": "3456950",
    "end": "3463280"
  },
  {
    "text": "And I'll get a 2x double dot\nplus theta double dot, c,",
    "start": "3463280",
    "end": "3470210"
  },
  {
    "text": "which is cosine\ntheta-- c is enough-- minus theta dot\nsquared s equals f.",
    "start": "3470210",
    "end": "3480150"
  },
  {
    "text": "OK, and then x double dot c,\nplus theta double dot, plus x",
    "start": "3480150",
    "end": "3490609"
  },
  {
    "text": "equals 0. Now, those I can work with. ",
    "start": "3490610",
    "end": "3502202"
  },
  {
    "text": "AUDIENCE: It says G [INAUDIBLE]. RUSS TEDRAKE: Yeah, that's\njust to save my handwriting.",
    "start": "3502202",
    "end": "3507779"
  },
  {
    "text": "It's not to be\nphysically accurate. It doesn't change the\nstructure of the equations.",
    "start": "3507780",
    "end": "3514470"
  },
  {
    "text": "If you like, you could set-- I bet I could come up with\na parameterization which would keep G at around\n10 and do OK, but--",
    "start": "3514470",
    "end": "3521160"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] RUSS TEDRAKE: There\nyou go, there you go. ",
    "start": "3521160",
    "end": "3535330"
  },
  {
    "text": "OK, so given these equations,\ncan I make x double",
    "start": "3535330",
    "end": "3541300"
  },
  {
    "text": "dot and theta double\ndot do whatever I want? ",
    "start": "3541300",
    "end": "3548170"
  },
  {
    "text": "So no. We said that the feedback\nlinearization trick required",
    "start": "3548170",
    "end": "3554410"
  },
  {
    "text": "that B inverse, in general. And so we couldn't do that.",
    "start": "3554410",
    "end": "3559630"
  },
  {
    "text": " But it turns out I\ncan do something.",
    "start": "3559630",
    "end": "3565093"
  },
  {
    "text": "So what are these equations? This is a cart moving around\nwith a pendulum on it.",
    "start": "3565093",
    "end": "3571090"
  },
  {
    "text": "And I'm pushing the cart, and\nthe pendulum's dangling away. ",
    "start": "3571090",
    "end": "3576830"
  },
  {
    "text": "So what would feedback\nlinearization-- what would a partial\nfeedback linearization mean?",
    "start": "3576830",
    "end": "3581960"
  },
  {
    "text": "Well, if I know the\ndynamics of the pendulum and I know the state\nof the pendulum,",
    "start": "3581960",
    "end": "3588430"
  },
  {
    "text": "and I can control\nthe force on my cart, then it's pretty reasonable\nto think that I could--",
    "start": "3588430",
    "end": "3595030"
  },
  {
    "text": "whatever force the\npendulum was applying to push my cart around, I could\njust exactly cancel that out.",
    "start": "3595030",
    "end": "3600530"
  },
  {
    "text": "So I could turn my cart\ndynamics to sort of just do whatever I want and\njust cancel out the effect",
    "start": "3600530",
    "end": "3606580"
  },
  {
    "text": "that that pendulum's\nadding to me. That seems reasonable.",
    "start": "3606580",
    "end": "3612010"
  },
  {
    "text": "And that's called a collocated\npartial feedback linearization.",
    "start": "3612010",
    "end": "3617084"
  },
  {
    "start": "3617084",
    "end": "3634980"
  },
  {
    "text": "I'm going to write\nPFL from now on. ",
    "start": "3634980",
    "end": "3641470"
  },
  {
    "text": "It's collocated because the\nstate I'm trying to linearize is the same one where\nthe actuator is sitting.",
    "start": "3641470",
    "end": "3648070"
  },
  {
    "text": "It's collocated. The state I'm linearizing is\ncollocated with my actuators. ",
    "start": "3648070",
    "end": "3655930"
  },
  {
    "text": "So my goal is to make x double\ndot have the dynamics, whatever",
    "start": "3655930",
    "end": "3664150"
  },
  {
    "text": "dynamics I choose-- x double\ndot desired, let's say. So let's see if we can\ndo this by manipulating",
    "start": "3664150",
    "end": "3671000"
  },
  {
    "text": "the equations a little bit. OK, so I can figure out how x\ndouble dot and theta double dot",
    "start": "3671000",
    "end": "3677710"
  },
  {
    "text": "are related with\nthat second equation. So let's get rid of\ntheta double dot.",
    "start": "3677710",
    "end": "3684061"
  },
  {
    "text": "I can see theta double dot had\nbetter be negative x double dot c minus s.",
    "start": "3684061",
    "end": "3693464"
  },
  {
    "text": "And if I insert that\ninto the first equation, then I get 2x double dot\nminus x double dot, c minus s.",
    "start": "3693465",
    "end": "3705872"
  },
  {
    "text": "Oops. ",
    "start": "3705872",
    "end": "3718830"
  },
  {
    "text": "Minus sc minus theta\ndot squared s equals f.",
    "start": "3718830",
    "end": "3724695"
  },
  {
    "start": "3724695",
    "end": "3731500"
  },
  {
    "text": "That means, if I\napply the control law,",
    "start": "3731500",
    "end": "3740380"
  },
  {
    "text": "2 minus c squared, x\ndouble dot desired, minus sc minus\ntheta dot desired s,",
    "start": "3740380",
    "end": "3752950"
  },
  {
    "text": "that implies that x double dot\nequals x double dot desired, like we wanted.",
    "start": "3752950",
    "end": "3759010"
  },
  {
    "text": "And theta double dot ends\nup doing something coupled.",
    "start": "3759010",
    "end": "3764590"
  },
  {
    "text": " But that's sort of the\nresulting dynamics.",
    "start": "3764590",
    "end": "3771579"
  },
  {
    "text": "I didn't actually plan for that. That's just whatever I got out. ",
    "start": "3771580",
    "end": "3780940"
  },
  {
    "text": "Does that make sense? That's just me saying-- if you think about\nthe controller here, that's just\ntaking the terms that",
    "start": "3780940",
    "end": "3788109"
  },
  {
    "text": "Are going to be contributed to\nthe dynamics by the pendulum and canceling them\nout by applying",
    "start": "3788110",
    "end": "3794680"
  },
  {
    "text": "exactly the opposite forces. And the result is that my\nx moves exactly however I",
    "start": "3794680",
    "end": "3801550"
  },
  {
    "text": "want it to do. So feedback\nlinearization isn't dead if you have an\nunderactuated system.",
    "start": "3801550",
    "end": "3807310"
  },
  {
    "text": "But you can't feedback\nlinearize the whole system. You can do this collocated\nfeedback linearization. ",
    "start": "3807310",
    "end": "3815080"
  },
  {
    "text": "Now, the cooler thing\nis, you can actually, often, also feedback\nlinearize the passive joint.",
    "start": "3815080",
    "end": "3822309"
  },
  {
    "text": " So it's pretty\nlogical that I could",
    "start": "3822310",
    "end": "3830410"
  },
  {
    "text": "move the cart in such a way\nthat I can't allow the pendulum dynamics. It's a little less\nintuitive that I",
    "start": "3830410",
    "end": "3836470"
  },
  {
    "text": "can make the\npendulum dynamics do whatever I want with the cart. ",
    "start": "3836470",
    "end": "3845180"
  },
  {
    "text": "But you can, most of the time. ",
    "start": "3845180",
    "end": "3861330"
  },
  {
    "text": "OK, so non-collocated\nmeans I'm going to use one",
    "start": "3861330",
    "end": "3873390"
  },
  {
    "text": "of my actuators to control-- feedback linearize one\nof my passive joints.",
    "start": "3873390",
    "end": "3878820"
  },
  {
    "text": "So now let's see if we can make\ntheta double dot do whenever",
    "start": "3878820",
    "end": "3885540"
  },
  {
    "text": "we-- bend to our will. ",
    "start": "3885540",
    "end": "3891214"
  },
  {
    "text": "It turns out the manipulation\nis almost exactly the same. Algebraically,\nit's not surprising",
    "start": "3891215",
    "end": "3896880"
  },
  {
    "text": "that I can do either one. I've got my equations\nof motion here. I've got-- both x double\ndot and theta double",
    "start": "3896880",
    "end": "3902970"
  },
  {
    "text": "depend on my force. And they're coupled here. So sure, I can control\neither one of them.",
    "start": "3902970",
    "end": "3910742"
  },
  {
    "text": "Physically, it's a\nlittle less intuitive. But algebraically,\nit's just as obvious.",
    "start": "3910742",
    "end": "3915970"
  },
  {
    "text": "OK, so let's just\ndo the opposite one. So x double dot had better\nbe theta double dot,",
    "start": "3915970",
    "end": "3926054"
  },
  {
    "text": "plus s over c, that\nwhole thing negative, based on that second equation.",
    "start": "3926054",
    "end": "3931800"
  },
  {
    "text": " And so I get 2 over\nc, theta double",
    "start": "3931800",
    "end": "3945630"
  },
  {
    "text": "dot plus s, negative on\nthere, plus theta double",
    "start": "3945630",
    "end": "3950970"
  },
  {
    "text": "dot c, minus theta\ndot squared c--",
    "start": "3950970",
    "end": "3957470"
  },
  {
    "text": "oops, s-- sorry-- equals f.",
    "start": "3957470",
    "end": "3963880"
  },
  {
    "text": "Yeah, so sure, so if I apply\nf equals is the controller--",
    "start": "3963880",
    "end": "3971207"
  },
  {
    "start": "3971208",
    "end": "3976477"
  },
  {
    "text": "what's the best way to\nwrite this? c minus 2 over c, theta\ndouble dot, desired,",
    "start": "3976477",
    "end": "3985450"
  },
  {
    "text": "minus theta dot squared s. Is that right?",
    "start": "3985450",
    "end": "3990862"
  },
  {
    "text": "AUDIENCE: Minus 2 SOC from\nthe first [INAUDIBLE].. RUSS TEDRAKE: Good, yes.",
    "start": "3990862",
    "end": "3997100"
  },
  {
    "text": "Minus 2 tan theta.",
    "start": "3997100",
    "end": "4003730"
  },
  {
    "text": "Good, thank you. ",
    "start": "4003730",
    "end": "4012840"
  },
  {
    "text": "Cool. So that's a much less\nintuitive result, I think.",
    "start": "4012840",
    "end": "4019680"
  },
  {
    "text": "But it's a much\nmore powerful one. It says, if I wanted to directly\ncontrol the pendulum, I can.",
    "start": "4019680",
    "end": "4031560"
  },
  {
    "text": "I have to give up something. x double dot, then, is\ngoing to end up being--",
    "start": "4031560",
    "end": "4036869"
  },
  {
    "text": "the resulting motion of the\ncart could be a little strange. It's going to be whatever this\ntheta double dot desired plus s",
    "start": "4036870",
    "end": "4043380"
  },
  {
    "text": "over c looks like.  But who cares?",
    "start": "4043380",
    "end": "4049200"
  },
  {
    "text": "If I'm just trying to keep\nthe cart up, that's OK. In your 6003 type\ndemos, they also",
    "start": "4049200",
    "end": "4054779"
  },
  {
    "text": "worry about not running into\nthe rails, which is important. But to first order,\nthis is a good thing.",
    "start": "4054780",
    "end": "4061980"
  },
  {
    "text": "What did I gloss over? AUDIENCE: Theta\ngoes to pi over 2. RUSS TEDRAKE: Yeah, right?",
    "start": "4061980",
    "end": "4067829"
  },
  {
    "text": "So I put a cosine on the\nbottom here without being careful about that.",
    "start": "4067830",
    "end": "4074020"
  },
  {
    "text": "So what is that? What is that\nphysically related to? AUDIENCE: If your pendulum\ngoes flat, then [INAUDIBLE]..",
    "start": "4074020",
    "end": "4081733"
  },
  {
    "text": "RUSS TEDRAKE: Exactly. When my pendulum is directly\nsideways, then suddenly,",
    "start": "4081733",
    "end": "4088770"
  },
  {
    "text": "nothing I do with\nthe cart is going to control the accelerations\nof that pendulum. So instantaneously, you lose\nthe ability to control that.",
    "start": "4088770",
    "end": "4099719"
  },
  {
    "text": "If you're going to swing up\nfrom the bottom to the top, then you go through that. So who cares?",
    "start": "4099720",
    "end": "4105252"
  },
  {
    "text": "So stop doing\ncontrol for a second, and then you'll\nget back to a place where you can control it again. ",
    "start": "4105252",
    "end": "4113899"
  },
  {
    "text": "So that sort of says\neverything, I think, that your intuition should\nrelate about these things.",
    "start": "4113899",
    "end": "4121160"
  },
  {
    "text": "And then for the Acrobot, it's\nsort of similarly surprising, but I can use my elbow torque to\nfeedback linearize my shoulder",
    "start": "4121160",
    "end": "4130460"
  },
  {
    "text": "torque--  same thing.",
    "start": "4130460",
    "end": "4136560"
  },
  {
    "text": "So if I wanted to make\nit do whatever I want, really, then I can do that.",
    "start": "4136560",
    "end": "4142528"
  },
  {
    "text": "I might have to spin like\ncrazy or do something nuts. But I can make my passive\njoint do whatever I want.",
    "start": "4142529",
    "end": "4149660"
  },
  {
    "text": "It's kind of cool. In fact, just to--",
    "start": "4149660",
    "end": "4155509"
  },
  {
    "text": "I want to show the slightly\nmore general derivation of that or form of that, but\njust to make the point.",
    "start": "4155510",
    "end": "4165179"
  },
  {
    "text": "So one of the ways we've been\nplaying with Little Dog-- this is our robotic dog.",
    "start": "4165180",
    "end": "4173028"
  },
  {
    "text": "So Little Dog has actuators\nat all the internal joints. It's got-- if you're just\nlooking at it from the side,",
    "start": "4173029",
    "end": "4178520"
  },
  {
    "text": "all you care about, it's got\none in the knee, it's got, actually, two in the hip--\nbut that doesn't matter here-- two in the other\nhip, one in the knee.",
    "start": "4178520",
    "end": "4185489"
  },
  {
    "text": "But the thing we're\nabout to make it do is try to control the dynamics\naround the foot, which",
    "start": "4185490",
    "end": "4191390"
  },
  {
    "text": "is just like the Acrobot. It doesn't-- the place where\nyou might think you'd want it the most is where you\ndon't have the actuator. ",
    "start": "4191390",
    "end": "4198650"
  },
  {
    "text": "So if you want to do something\nlike this with your dog,",
    "start": "4198650",
    "end": "4208380"
  },
  {
    "text": "then you've got a reason\nabout the coupling, the inertial coupling,\nwhich is what we did here,",
    "start": "4208380",
    "end": "4214380"
  },
  {
    "text": "that allows you to decide-- the slipping at the end is ugly\nand we didn't do that right. But until the impact, we did\na pretty good job, actually,",
    "start": "4214380",
    "end": "4221280"
  },
  {
    "text": "of regulating the\nposition of the dog, just using the controlled\nactuators and where our most",
    "start": "4221280",
    "end": "4228690"
  },
  {
    "text": "essential variable was passive. It took a slightly\nmore general form, which I'm going to show you\non Thursday, to do that.",
    "start": "4228690",
    "end": "4236460"
  },
  {
    "text": "But partial feedback\nlinearization is sort of alive and well\nand useful in robotics.",
    "start": "4236460",
    "end": "4247020"
  },
  {
    "text": "Let me just-- I'll show you half of the-- or one of the slightly more\ngeneral derivations of it,",
    "start": "4247020",
    "end": "4254910"
  },
  {
    "text": "just because it's so easy with\nthis algebra manipulation. So let's say I have manipulator\nequations of the form--",
    "start": "4254910",
    "end": "4263370"
  },
  {
    "text": "I'm just going to lump C, q\ndot, and G into a single term",
    "start": "4263370",
    "end": "4269340"
  },
  {
    "text": "because they don't affect\nthe derivation at all. And let's say that\nI've stacked--",
    "start": "4269340",
    "end": "4276000"
  },
  {
    "text": "I've reordered my\nequations of motion so that all of my\npassive joints are on top",
    "start": "4276000",
    "end": "4282540"
  },
  {
    "text": "and all my actuated\njoints are on the bottom. So these are all matrices. ",
    "start": "4282540",
    "end": "4293940"
  },
  {
    "text": "Let me call q1, the\ncollection-- it's a vector of all\nthe passive joints,",
    "start": "4293940",
    "end": "4302670"
  },
  {
    "text": "and q2 all the active joints. ",
    "start": "4302670",
    "end": "4312150"
  },
  {
    "text": "Then if I break this\nup just a little bit, I can write the\nsame equation as--",
    "start": "4312150",
    "end": "4320800"
  },
  {
    "start": "4320800",
    "end": "4340110"
  },
  {
    "text": "as that. ",
    "start": "4340110",
    "end": "4352285"
  },
  {
    "text": "I left these up\nthe whole lecture thinking I was going to\npoint to them all the time-- never did. I'm going to erase them now.",
    "start": "4352285",
    "end": "4358100"
  },
  {
    "start": "4358100",
    "end": "4364740"
  },
  {
    "text": "OK, so what is my\ncollocated form?",
    "start": "4364740",
    "end": "4374880"
  },
  {
    "text": "Collocated means I'm going\nto try to control q2. So let's solve for-- q1 is going to be H1,\n1, inverse, H1, 2,",
    "start": "4374880",
    "end": "4390300"
  },
  {
    "text": "q2 double dot plus phi 1. ",
    "start": "4390300",
    "end": "4397446"
  },
  {
    "text": "Am I allowed to do\nthat, H1, 1, inverse? ",
    "start": "4397446",
    "end": "4404552"
  },
  {
    "text": "It takes a little bit of\nthinking, but it's actually OK. It's a positive\ndefinite matrix H.",
    "start": "4404552",
    "end": "4412570"
  },
  {
    "text": "So it turns out the square\ndiagonal entries are actually",
    "start": "4412570",
    "end": "4417610"
  },
  {
    "text": "also have to be\npositive definite. So maybe take my word on that.",
    "start": "4417610",
    "end": "4423489"
  },
  {
    "text": "And then I can plug that in\nand see that, if I do tau--",
    "start": "4423490",
    "end": "4429430"
  },
  {
    "text": "let's see if I can just\ndo it in the step here. Tau is going to have\nto be H2, 2, plus--",
    "start": "4429430",
    "end": "4439240"
  },
  {
    "text": "no, I missed a minus, didn't I? q1 is-- I missed\na minus in here.",
    "start": "4439240",
    "end": "4445000"
  },
  {
    "text": " Minus H1, 1, H1, 2--",
    "start": "4445000",
    "end": "4452335"
  },
  {
    "start": "4452335",
    "end": "4457400"
  },
  {
    "text": "I did that.  I should have done\nit in two steps.",
    "start": "4457400",
    "end": "4463610"
  },
  {
    "text": "It's H2, 1, H1, 1, inverse,\nH1, 2, q2 double dot desired,",
    "start": "4463610",
    "end": "4478239"
  },
  {
    "text": "plus phi 2. ",
    "start": "4478240",
    "end": "4484580"
  },
  {
    "text": "Right? ",
    "start": "4484580",
    "end": "4492290"
  },
  {
    "text": "In the non-collocated,\nwe're going",
    "start": "4492290",
    "end": "4500990"
  },
  {
    "text": "to have to solve\nfor q2 double dot.",
    "start": "4500990",
    "end": "4506460"
  },
  {
    "text": "That's going to be H1, 2,\nnegative H1, 2, inverse,",
    "start": "4506460",
    "end": "4517719"
  },
  {
    "text": "times H1, 1, q1 double\ndot, plus theta 1.",
    "start": "4517720",
    "end": "4525160"
  },
  {
    "text": "I missed my theta 1\nterm in here somewhere. That should have\nbeen also in here. ",
    "start": "4525160",
    "end": "4552449"
  },
  {
    "text": "Yeah. OK, so the first step in the\nnon-collocated, in general, is this H1, 2 inverse.",
    "start": "4552450",
    "end": "4560060"
  },
  {
    "text": "Is that one OK? AUDIENCE: [INAUDIBLE] RUSS TEDRAKE: Not necessarily. I could have had\na different number",
    "start": "4560060",
    "end": "4566158"
  },
  {
    "text": "of actuated active and\npassive degrees of freedom.",
    "start": "4566158",
    "end": "4572740"
  },
  {
    "text": "So let me write something\nthat's a little bit better, the sort of pseudo inverse.",
    "start": "4572740",
    "end": "4577780"
  },
  {
    "text": " And what matters--\nthe non-collocation,",
    "start": "4577780",
    "end": "4586713"
  },
  {
    "text": "the partial feedback\nlinearization is going to work if and only\nif that matrix is full row",
    "start": "4586713",
    "end": "4592989"
  },
  {
    "text": "rank again.  So what does that mean?",
    "start": "4592990",
    "end": "4598580"
  },
  {
    "text": "It means I can't use one\nactive degree of freedom to control two or more\npassive degrees of freedom.",
    "start": "4598580",
    "end": "4605195"
  },
  {
    "text": "I need to have at least as many\nactuators as degrees of freedom I'm going to try to control. That's reasonable.",
    "start": "4605195",
    "end": "4610989"
  },
  {
    "text": "But it's a little bit\nmore than that still. I actually have to have\nthem inertially coupled",
    "start": "4610990",
    "end": "4618370"
  },
  {
    "text": "in the right way. So if I had two\npendula on the table--",
    "start": "4618370",
    "end": "4625390"
  },
  {
    "text": "well, the table might\nhave some dynamics. If I had two pendula bolted to\ncompletely independent bases,",
    "start": "4625390",
    "end": "4632410"
  },
  {
    "text": "and I had an actuator on one and\nnot an actuator on the other, that ain't gonna work. I can't make any math that's\ngoing to make that work.",
    "start": "4632410",
    "end": "4641300"
  },
  {
    "text": "So there has to be some inertial\ncoupling between the two. So the rank condition on\nthis is the condition of--",
    "start": "4641300",
    "end": "4654700"
  },
  {
    "text": "is sometimes called\nthe condition of strong inertial coupling. ",
    "start": "4654700",
    "end": "4668500"
  },
  {
    "text": "The strong means that it's\nuniformly inertially coupled.",
    "start": "4668500",
    "end": "4680410"
  },
  {
    "text": "It's just inertially\ncoupled in some state. And if for all q this\nthing is full rank,",
    "start": "4680410",
    "end": "4686170"
  },
  {
    "text": "then it's strong\ninertial coupling. ",
    "start": "4686170",
    "end": "4693310"
  },
  {
    "text": "And there's even a\nmore general form. So in general, you can--",
    "start": "4693310",
    "end": "4699429"
  },
  {
    "text": "and what we do in\nLittle Dog is, we pick some combination of\nactuated and unactuated degrees",
    "start": "4699430",
    "end": "4705559"
  },
  {
    "text": "of freedom. And actually, what we care about\nis a virtual degree of freedom, which is the center of mass. And I'll show you at the\nbeginning of the next lecture",
    "start": "4705560",
    "end": "4714599"
  },
  {
    "text": "the most general form of this. ",
    "start": "4714600",
    "end": "4720190"
  },
  {
    "text": "But I can't put up\nthese PFL equations without spending one\nminute at the end saying,",
    "start": "4720190",
    "end": "4728530"
  },
  {
    "text": "PFL is still sort of bad, right? I don't really-- it\nworks, and I use it",
    "start": "4728530",
    "end": "4734020"
  },
  {
    "text": "because I want to\ncontrol these robots. But I don't like\nfeedback linearization.",
    "start": "4734020",
    "end": "4739270"
  },
  {
    "text": "Feedback linearization is bad. This is taking some beautiful\nnonlinear system that",
    "start": "4739270",
    "end": "4745750"
  },
  {
    "text": "has beautiful equations\nand arbitrarily pumping in some potentially\nlarge amount of energy",
    "start": "4745750",
    "end": "4754150"
  },
  {
    "text": "to squish those dynamics\nand bend them to your will. And that's good. That's the feedback way.",
    "start": "4754150",
    "end": "4760690"
  },
  {
    "text": "But it's not the only way. So we do it when we have to.",
    "start": "4760690",
    "end": "4767830"
  },
  {
    "text": "But it's better if you don't. Yeah. AUDIENCE: Wouldn't you\nhave [INAUDIBLE] errors",
    "start": "4767830",
    "end": "4772850"
  },
  {
    "text": "in the [INAUDIBLE]? RUSS TEDRAKE: It\ncould be that, if you don't have the model\nperfect, that you",
    "start": "4772850",
    "end": "4778630"
  },
  {
    "text": "could be doing bad things too. Any time you have large\ncontrol gains going around, you're going to be sensitive.",
    "start": "4778630",
    "end": "4784890"
  },
  {
    "text": " So don't always do this. But I do want you to know\nthat you can do this if you so",
    "start": "4784890",
    "end": "4791800"
  },
  {
    "text": "choose to take that path. OK, cool, so on Thursday we\nwill use these partial feedback",
    "start": "4791800",
    "end": "4800440"
  },
  {
    "text": "linearizations and\nLQR together to make the Acrobot, the cart-pole\nswing up and balance.",
    "start": "4800440",
    "end": "4805540"
  },
  {
    "text": "If all goes well and we don't\nhave any License Manager issues, then we'll\nsee it in class.",
    "start": "4805540",
    "end": "4810270"
  }
]