[
  {
    "text": "[SQUEAKING] [RUSTLING] [CLICKING]",
    "start": "0",
    "end": "6832"
  },
  {
    "text": " DAVID PERREAULT: --control.",
    "start": "6832",
    "end": "12160"
  },
  {
    "text": "And we said that we\nsaw a few phenomena.",
    "start": "12160",
    "end": "18619"
  },
  {
    "text": "So if I took, for\nexample, a boost converter as my canonical example, I\nhave V, the output voltage,",
    "start": "18620",
    "end": "38650"
  },
  {
    "text": "as one of my state variables\nbecause the capacitor C and IL is the other state variable.",
    "start": "38650",
    "end": "44920"
  },
  {
    "text": "And what we really\ncontrol here is q of t",
    "start": "44920",
    "end": "50500"
  },
  {
    "text": "or the local average of q of t,\nwhich we call the duty ratio.",
    "start": "50500",
    "end": "56230"
  },
  {
    "text": "And we said we developed\nlinearized average models",
    "start": "56230",
    "end": "62200"
  },
  {
    "text": "for this thing with the notion\nthat if I had some reference",
    "start": "62200",
    "end": "67930"
  },
  {
    "text": "voltage, and I compare\nit to the output voltage,",
    "start": "67930",
    "end": "73510"
  },
  {
    "text": "and I went into a\ncompensator GC of S, and I use that to\ngenerate duty ratio",
    "start": "73510",
    "end": "81490"
  },
  {
    "text": "and then I had my converter,\nwhich might have some IL,",
    "start": "81490",
    "end": "88360"
  },
  {
    "text": "it might have some\nV out, and I then compare that output\nto my reference,",
    "start": "88360",
    "end": "94850"
  },
  {
    "text": "I get an error voltage. And then I use that\nerror voltage to generate the duty ratio I want.",
    "start": "94850",
    "end": "100628"
  },
  {
    "text": "I stick that into my converter. And we generated some linearized\naverage models for this thing.",
    "start": "100628",
    "end": "107000"
  },
  {
    "text": "So I might think about the\nvariations in all these things",
    "start": "107000",
    "end": "113560"
  },
  {
    "text": "to linearize it. And we came up with a model\nfor our converter, H of S,",
    "start": "113560",
    "end": "119050"
  },
  {
    "text": "which basically converts\nbetween variations in duty ratio to variations in output voltage,\nand we design a converter.",
    "start": "119050",
    "end": "127000"
  },
  {
    "text": "And when we did that, we\nsaw a couple of things. First, we saw that the\ndynamics were nonlinear.",
    "start": "127000",
    "end": "134870"
  },
  {
    "text": "That's why we had to do\nthis linearization thing. Now, are they always\nnonlinear in a converter? No.",
    "start": "134870",
    "end": "141690"
  },
  {
    "text": "But many, many converters are. And in this case, why is\nthat nonlinearity there? The nonlinearity is there\nbecause what we're seeing",
    "start": "141690",
    "end": "148560"
  },
  {
    "text": "is our second order responses\nare some kind of oscillations between the inductor\nand the capacitor",
    "start": "148560",
    "end": "155520"
  },
  {
    "text": "and damped by the load resistor. And those oscillations\nare mediated through the switching or the\nmodulation of the switches,",
    "start": "155520",
    "end": "163620"
  },
  {
    "text": "which varies with time. And more to the point, the\nsteady state value of that",
    "start": "163620",
    "end": "168690"
  },
  {
    "text": "varies with DC input\nto output voltage and hence the dynamics vary.",
    "start": "168690",
    "end": "175060"
  },
  {
    "text": "Because the modulation is\nmediated by the switching, we get nonlinear behavior.",
    "start": "175060",
    "end": "180520"
  },
  {
    "text": "And what that means is that\nthe dynamics, the small signal dynamics, physically vary with\ndifferent values of, say, input",
    "start": "180520",
    "end": "187349"
  },
  {
    "text": "voltage and output voltage. So if I have a different value\nof input voltage and same value of output voltage, I should\nexpect my dynamics to vary.",
    "start": "187350",
    "end": "194470"
  },
  {
    "text": "So one, we saw\nnonlinearity which arises.",
    "start": "194470",
    "end": "202970"
  },
  {
    "text": "The other thing we saw\nwas a pole-zero map.",
    "start": "202970",
    "end": "209000"
  },
  {
    "text": "If I looked at H of S,\nwhat's going on in here, the one thing we saw was\na right-half-plane zero",
    "start": "209000",
    "end": "218239"
  },
  {
    "text": "in our transfer function. And we said that that\nright-half-plane zero",
    "start": "218240",
    "end": "223760"
  },
  {
    "text": "comes from the underlying way\nin which the converter processes energy. It's not a function of the math.",
    "start": "223760",
    "end": "230040"
  },
  {
    "text": "It's because when I\nchange what I'm doing, the dynamics it goes through\nis reflective of what",
    "start": "230040",
    "end": "235880"
  },
  {
    "text": "a right-half-plane zero does. So I'm kind of stuck with\nthis right-half-plane zero.",
    "start": "235880",
    "end": "240980"
  },
  {
    "text": "And then the other\nthing we saw was that the pole locations,\nwhich are due to the L and C",
    "start": "240980",
    "end": "247280"
  },
  {
    "text": "and how they interact\nwith the resistance, so it's a second-order system,\ntend to be very lightly damped,",
    "start": "247280",
    "end": "254050"
  },
  {
    "text": "like this, something like that. And the amount of damping\ndepends upon the load resistance",
    "start": "254050",
    "end": "259970"
  },
  {
    "text": "R. So I'm really relying\non this load resistance to damp the oscillations,\nor that makes",
    "start": "259970",
    "end": "267160"
  },
  {
    "text": "it hard to design a controller. Lightly damp poles and\na right-half-plane zero mean I'm not a very\nhappy camper in terms",
    "start": "267160",
    "end": "272920"
  },
  {
    "text": "of designing a good controller. So that's where we came to.",
    "start": "272920",
    "end": "278990"
  },
  {
    "text": "We said, well, what can I\ndo about this situation? Because this is a hard\nthing to deal with. You can deal with it.",
    "start": "278990",
    "end": "284200"
  },
  {
    "text": "You can design a GC of\nS, a compensator that will deal with that, but\nit's not very pretty.",
    "start": "284200",
    "end": "289570"
  },
  {
    "text": "One thing you can do is by\nchoosing L and C appropriately,",
    "start": "289570",
    "end": "296080"
  },
  {
    "text": "that helps you set dynamics\nthe way you'd like them. The other thing you can\ndo is change the plant.",
    "start": "296080",
    "end": "302810"
  },
  {
    "text": "So we said, oh,\nit's this resistor that's damping the poles.",
    "start": "302810",
    "end": "308090"
  },
  {
    "text": "Maybe I could go\nadd RD and CD such",
    "start": "308090",
    "end": "315440"
  },
  {
    "text": "that CD is a short circuit\nnear the corner frequency where the L and C\nare oscillating, so RD serves to damp\nit, and RD doesn't vary.",
    "start": "315440",
    "end": "323389"
  },
  {
    "text": "So by picking additions to my\nplant, by changing my converter,",
    "start": "323390",
    "end": "330070"
  },
  {
    "text": "I can help make\nthings better damped and maybe get better\npole locations here. I'd have another pole\nlocation, but maybe it",
    "start": "330070",
    "end": "336400"
  },
  {
    "text": "would be a low-order\noverdamped pole location. So that's one thing I can do.",
    "start": "336400",
    "end": "342108"
  },
  {
    "text": "I don't like to do that because\nthen I got to buy hardware. I got to buy a big capacitor\nand that kind of thing. The question is, what else can\nI do to make a better power",
    "start": "342108",
    "end": "353320"
  },
  {
    "text": "converter controller? And that's what we're\ngoing to talk about today.",
    "start": "353320",
    "end": "360550"
  },
  {
    "text": "And the basic idea is this. I have a converter that\nhas two state variables.",
    "start": "360550",
    "end": "372670"
  },
  {
    "text": "Its state variables\nare IL and VC. And yes, it has as its\ninput the input voltage.",
    "start": "372670",
    "end": "380960"
  },
  {
    "text": "And so what I've been\ndoing is taking-- between these two, I've been\nfeeding back the output voltage.",
    "start": "380960",
    "end": "390470"
  },
  {
    "text": "What a control\nperson would tell you is if you're not happy\nwith your dynamics and you have a\ncontrollable system,",
    "start": "390470",
    "end": "396200"
  },
  {
    "text": "feedback all of your states. Do full-state feedback. If you feedback\nall of your states,",
    "start": "396200",
    "end": "401300"
  },
  {
    "text": "you can place your\ndynamics much better. And we're going to\ndo a version of that",
    "start": "401300",
    "end": "407720"
  },
  {
    "text": "called current mode control. The general concept\noriginated in the 1960s.",
    "start": "407720",
    "end": "417077"
  },
  {
    "text": "The version I'm going to tell\nyou about came about in the late 1970s. And there's lots of\nversions of this idea.",
    "start": "417077",
    "end": "422918"
  },
  {
    "text": "I'm telling you\nabout what's probably the most popular one\nin DC-to-DC converters if you go out to buy\none or to design one.",
    "start": "422918",
    "end": "431720"
  },
  {
    "text": "A lot of the control\nchips use this technique. And here's the idea.",
    "start": "431720",
    "end": "437000"
  },
  {
    "text": "For the converter, we\nsaid the input was-- well, ultimately the input is q of t.",
    "start": "437000",
    "end": "442550"
  },
  {
    "text": "It's what's modulating\nthe converter. Maybe I can say, OK, let me\nfeed back the inductor current",
    "start": "442550",
    "end": "454200"
  },
  {
    "text": "and compare that to a reference. And I'm going to call\nthis reference IP. So this is a current reference.",
    "start": "454200",
    "end": "461376"
  },
  {
    "text": " And based on the\ncomparison of IL",
    "start": "461376",
    "end": "467730"
  },
  {
    "text": "with IP in a current\ncontroller, I'm",
    "start": "467730",
    "end": "474960"
  },
  {
    "text": "going to generate the\nswitching function. And then what I'm\ngoing to do is I'm going to feed back the voltage\nand compare it to a reference",
    "start": "474960",
    "end": "486840"
  },
  {
    "text": "and put that into a\ncompensator GC of S.",
    "start": "486840",
    "end": "491940"
  },
  {
    "text": "And I'm going to use GC of S to\ngenerate the current reference. So this is something\ncalled minor loop control.",
    "start": "491940",
    "end": "498920"
  },
  {
    "text": "We're going to have\na fast inner loop to control the current\nand then a slow outer loop",
    "start": "498920",
    "end": "505030"
  },
  {
    "text": "to control the voltage.  But we're going to feed back\nboth current and voltage",
    "start": "505030",
    "end": "510900"
  },
  {
    "text": "and thereby get better dynamics. That's the basic idea. Any questions about that?",
    "start": "510900",
    "end": "517510"
  },
  {
    "text": "AUDIENCE: What does\nfast and slow mean? DAVID PERREAULT: Let\nme show you the scheme, and then you'll see what\nI mean by fast and slow.",
    "start": "517510",
    "end": "523382"
  },
  {
    "text": "Remember, when we were\ntalking about our models, for our average models\nup there, they're",
    "start": "523382",
    "end": "530070"
  },
  {
    "text": "kind of good on time periods\nthat are slow compared to half the switching frequency. So maybe you can go to 0.2\nof the switching frequency.",
    "start": "530070",
    "end": "538245"
  },
  {
    "text": "There's games you can play. But pretty much, you're\nlooking at the average value. So you don't want\nyour controller,",
    "start": "538245",
    "end": "543720"
  },
  {
    "text": "GC of S in the\ntop example, to be changing your command very\nquickly, certainly not",
    "start": "543720",
    "end": "549720"
  },
  {
    "text": "within a cycle. In this scheme, what\nwe're going to do-- that will still be true of\nthis outer loop control.",
    "start": "549720",
    "end": "556449"
  },
  {
    "text": "The inner loop\ncontrol is actually going to run on a\ncycle-by-cycle basis. And that has a lot of\nfollow-on benefits.",
    "start": "556450",
    "end": "565769"
  },
  {
    "text": "So what we're going\nto do is we're going to come up with\na scheme where we",
    "start": "565770",
    "end": "570840"
  },
  {
    "text": "turn on the switch every cycle. And then I'm going to\nturn off the switch based on what the\ninductor current is",
    "start": "570840",
    "end": "576570"
  },
  {
    "text": "doing in a particular way. And I'm going to show\nyou the particular way we're going to examine. And so that's going to give us\ncontrol over what the inductor",
    "start": "576570",
    "end": "584740"
  },
  {
    "text": "current is doing. And then I'm going\nto use my outer loop to control that command\nto the inductor current.",
    "start": "584740",
    "end": "591589"
  },
  {
    "text": "So the crudest way\npeople like to think about this is I'm putting the\ninductor current inside a loop.",
    "start": "591590",
    "end": "597089"
  },
  {
    "text": "So now I just get a\ncommandable current. And then I sort of have\na first-order system.",
    "start": "597090",
    "end": "602830"
  },
  {
    "text": "Now, it's not quite that good. That's an oversimplification. I still have two\nstate variables. It's still a\nsecond-order system,",
    "start": "602830",
    "end": "608690"
  },
  {
    "text": "but it's not a bad\nway to think about it. All right, so how\ndoes this scheme work?",
    "start": "608690",
    "end": "616760"
  },
  {
    "text": "Let me show you the\nbasis of the scheme. It looks something like this.",
    "start": "616760",
    "end": "624000"
  },
  {
    "text": "What I'm going to do is\nI'm going to create-- ",
    "start": "624000",
    "end": "632557"
  },
  {
    "text": "I'm going to have a\ncurrent reference. Here's my current reference. Let me call this I peak.",
    "start": "632557",
    "end": "639800"
  },
  {
    "text": "And this is-- within\na switching cycle, this is more or less a constant\ndefined by this compensator,",
    "start": "639800",
    "end": "648110"
  },
  {
    "text": "but it's going to\nmove up and down as my outer loop tells it to. Then I'm going to create a\nslight variation off that,",
    "start": "648110",
    "end": "655820"
  },
  {
    "text": "and we'll explain why\na little bit later. But suppose this is\nmy switching period",
    "start": "655820",
    "end": "661430"
  },
  {
    "text": "T. I'm going to create\na slope with some slope. I'm going to call this minus MC.",
    "start": "661430",
    "end": "668150"
  },
  {
    "text": "This is some slope-- MC is a positive number-- which is a ramp that I\nsubtract off of my command,",
    "start": "668150",
    "end": "675470"
  },
  {
    "text": "and I'm going to do\nthat every cycle. ",
    "start": "675470",
    "end": "680550"
  },
  {
    "text": "So that's T. Here's\n2T and so forth. So I'm going to do\nthis every cycle.",
    "start": "680550",
    "end": "687970"
  },
  {
    "text": "Now, here's my inductor current. So I'm going to sense IL.",
    "start": "687970",
    "end": "695500"
  },
  {
    "text": "And what I'm going to do is at\nthe beginning of each cycle, I'm going to turn\non-- this is IL--",
    "start": "695500",
    "end": "701440"
  },
  {
    "text": "I'm going to turn on\nthe inductor current. I'm going to turn on\nthe switch, I'm sorry. And the inductor\ncurrent is going",
    "start": "701440",
    "end": "707190"
  },
  {
    "text": "to rise with some slope M1. So the beginning of\nthe cycle, I come--",
    "start": "707190",
    "end": "714480"
  },
  {
    "text": "q of t turns high,\ninductor current ramps up.",
    "start": "714480",
    "end": "719847"
  },
  {
    "text": "And what I'm going to do is I'm\ngoing to look at that inductor current, and I'm going\nto compare the inductor current to Ip minus this slope.",
    "start": "719847",
    "end": "727120"
  },
  {
    "text": "I'm going to compare\nit to this pink signal. And when I hit here, when the\ninductor current exceeds the I",
    "start": "727120",
    "end": "736815"
  },
  {
    "text": "peak minus this\ncompensating ramp slope, I'm going to turn off the switch\nand let the switch current fall",
    "start": "736815",
    "end": "744209"
  },
  {
    "text": "like this. So this is, say, DT.",
    "start": "744210",
    "end": "750450"
  },
  {
    "text": "The switch turns on at the\nbeginning of the cycle. But it turns off-- instead of me\nsetting a duty ratio explicitly,",
    "start": "750450",
    "end": "756000"
  },
  {
    "text": "I'm going to implicitly\ndetermine the duty ratio based on this peak current. And then, beginning of the next\ncycle, I do the same thing,",
    "start": "756000",
    "end": "764589"
  },
  {
    "text": "I turn the switch on,\nit rises, it falls. And I get the same kind\nof general behavior.",
    "start": "764590",
    "end": "772340"
  },
  {
    "text": "It's just that\ninstead of saying turn the do switch off\nafter some time, DT,",
    "start": "772340",
    "end": "778449"
  },
  {
    "text": "I'm going to say turn it\noff implicitly when it hits some current that I command.",
    "start": "778450",
    "end": "783750"
  },
  {
    "text": "Any questions about that? ",
    "start": "783750",
    "end": "793329"
  },
  {
    "text": "Why do I like that? Well, one thing\nwe're going to see is that we're going to get\nbetter control dynamics.",
    "start": "793330",
    "end": "799760"
  },
  {
    "text": "And I should say, by the\nway, this one, this slope, is minus M2. And why am I talking\nabout M1, M2, minus MC?",
    "start": "799760",
    "end": "808060"
  },
  {
    "text": "That's because this\nsame picture applies to any kind of converter. For the boost, M1 is just equal\nto the input voltage over L,",
    "start": "808060",
    "end": "817930"
  },
  {
    "text": "and M2 is equal to the output\nvoltage minus the input voltage over L. But I could\nhave drawn the same picture",
    "start": "817930",
    "end": "825152"
  },
  {
    "text": "if it were a buck converter\nor the same picture if it were some other converter.",
    "start": "825152",
    "end": "830970"
  },
  {
    "text": "So why am I doing this? Well, a couple of reasons. One, we're going to see it\ngives us much nicer dynamics. Why?",
    "start": "830970",
    "end": "836310"
  },
  {
    "text": "Because I'm basically\nexplicitly controlling the inductor current. And then the other\nthing that's kind of",
    "start": "836310",
    "end": "842250"
  },
  {
    "text": "nice is if I did duty\nratio control, what",
    "start": "842250",
    "end": "848900"
  },
  {
    "text": "is the inductor current doing? I don't know. If I put a small\nresistance on it, it's just going to keep\ncranking up the current",
    "start": "848900",
    "end": "854040"
  },
  {
    "text": "until it does what it wants. Here, I'm telling the\nswitch to turn off if the current gets too big.",
    "start": "854040",
    "end": "860040"
  },
  {
    "text": "So this gives me\nautomatic current control.",
    "start": "860040",
    "end": "865529"
  },
  {
    "text": "My currents can't\nget out of control. Now, in a boost converter,\nthat's not quite true because if I put a\nshort circuit on this,",
    "start": "865530",
    "end": "871770"
  },
  {
    "text": "there's nothing I'm going to do\nbecause the switch won't control the inductor current. But as long as the output\nvoltage is bigger than the input",
    "start": "871770",
    "end": "878457"
  },
  {
    "text": "voltage, by having this\npeak current reference,",
    "start": "878457",
    "end": "883649"
  },
  {
    "text": "I can always limit the amount\nof current the converter is processing and\nhence prevent it",
    "start": "883650",
    "end": "888810"
  },
  {
    "text": "from overheating, for example.  All right, so essentially,\nthis technique gives me",
    "start": "888810",
    "end": "899569"
  },
  {
    "text": "cycle-by-cycle current\ncontrol over the switch-- over the inductor current.",
    "start": "899570",
    "end": "904790"
  },
  {
    "text": "Now, I have to sense the\ninductor current because I'm controlling IL here.",
    "start": "904790",
    "end": "910510"
  },
  {
    "text": "Sometimes I do literally\nsense the inductor current. Sometimes, keep in mind, you're\nonly looking at the current",
    "start": "910510",
    "end": "917889"
  },
  {
    "text": "when the switch is on. So sometimes people will come\nand put a little resistor right here or use\nthe switch resistance",
    "start": "917890",
    "end": "924580"
  },
  {
    "text": "itself and sense the\ncurrent in the switch. It gives you the same thing\nas far as this comparison",
    "start": "924580",
    "end": "930339"
  },
  {
    "text": "is concerned. Any questions about that? ",
    "start": "930340",
    "end": "936949"
  },
  {
    "text": "Yeah. AUDIENCE: How would you\nadjust the peak current level if your load changes? DAVID PERREAULT: Ah,\nthat's a good question.",
    "start": "936950",
    "end": "943780"
  },
  {
    "text": "So what's going to happen? I'm going to do the\nsame kind of deal. If the load voltage--",
    "start": "943780",
    "end": "949980"
  },
  {
    "text": "well, let me go back to\nthe right controller.  If the load voltage\nis too low, too",
    "start": "949980",
    "end": "957370"
  },
  {
    "text": "low means below the\nreference, the error voltage gets bigger, this compensator,\nthis outer loop compensator",
    "start": "957370",
    "end": "965320"
  },
  {
    "text": "amplifies it. Maybe it integrates the error. It will make the peak\ncommand get bigger.",
    "start": "965320",
    "end": "970589"
  },
  {
    "text": "If this peak command moves up,\nso will the switching time. And then the inductor\nwill have more current,",
    "start": "970590",
    "end": "977140"
  },
  {
    "text": "and eventually the inductor\nwill feed the output, and it will bring the\noutput voltage up. So the ultimate output\nvoltage is really controlled",
    "start": "977140",
    "end": "985720"
  },
  {
    "text": "by this, looking at the error\nbetween the output voltage what I wanted, just\nlike I did before. I just have an\nintermediate value",
    "start": "985720",
    "end": "991960"
  },
  {
    "text": "where it controls the current\nat which the inductor is going to run to get there. And if you think about it,\nthe inductor current times,",
    "start": "991960",
    "end": "1000260"
  },
  {
    "text": "the input voltage is\nthe power I'm drawing. So it's in some indirect way\ncontrolling the amount of power",
    "start": "1000260",
    "end": "1006812"
  },
  {
    "text": "that I'm going to\ndraw from the input. ",
    "start": "1006812",
    "end": "1011840"
  },
  {
    "text": "All right, so one thing it gives\nus is a cycle-by-cycle current limiting.",
    "start": "1011840",
    "end": "1016920"
  },
  {
    "text": "The other thing it's going to\ngive us is better dynamics. The question is,\nhow do we analyze",
    "start": "1016920",
    "end": "1022010"
  },
  {
    "text": "the dynamics of this thing? What did I do before? The thing I did before\nwas we started-- we averaged the average circuit,\neither the circuit or the state",
    "start": "1022010",
    "end": "1029900"
  },
  {
    "text": "space model, and\ncame up with a duty-- and then we linearized\nit, and we came up with a conversion\nbetween the duty ratio",
    "start": "1029900",
    "end": "1037039"
  },
  {
    "text": "and the local average inductor\ncurrent and local average output voltage. And we could try to do\nthat for this scheme.",
    "start": "1037040",
    "end": "1045169"
  },
  {
    "text": "It's a little bit\ncomplicated, and it turns out it's mathematically\nvery difficult. You kind of walk\ninto a wall of math",
    "start": "1045170",
    "end": "1051950"
  },
  {
    "text": "if you try to play\nthis game directly. But there are clever\nways to get around it.",
    "start": "1051950",
    "end": "1058360"
  },
  {
    "text": "I've already got a model\nfor how duty ratio relates",
    "start": "1058360",
    "end": "1064360"
  },
  {
    "text": "to the local averages\nof the output voltages and the local average\nof the inductor current.",
    "start": "1064360",
    "end": "1069890"
  },
  {
    "text": "If I can relate the peak\ncurrent to the duty ratio, then I'm kind of in business.",
    "start": "1069890",
    "end": "1075280"
  },
  {
    "text": "I can just kind of swap it\nout and create a new model. And that's what people do. It's much more simple, or\nit's more or less the only way",
    "start": "1075280",
    "end": "1083410"
  },
  {
    "text": "to go about it that I know\nof that works out nicely. And so here's the idea.",
    "start": "1083410",
    "end": "1089080"
  },
  {
    "text": "This picture I drew is actually\na periodic steady state picture. I used capital D here.",
    "start": "1089080",
    "end": "1095710"
  },
  {
    "text": "I'm assuming it does\nsomething every cycle, DT.",
    "start": "1095710",
    "end": "1101049"
  },
  {
    "text": "Let's just draw a\nslightly better picture for purposes of analysis.",
    "start": "1101050",
    "end": "1107380"
  },
  {
    "text": "OK, so here we go.  Here's my waveform.",
    "start": "1107380",
    "end": "1112870"
  },
  {
    "text": "Here's my peak current, I peak.",
    "start": "1112870",
    "end": "1118510"
  },
  {
    "text": "And then I have my so-called\ncompensating ramp, which",
    "start": "1118510",
    "end": "1124600"
  },
  {
    "text": "falls with some slope minus Mc. ",
    "start": "1124600",
    "end": "1132080"
  },
  {
    "text": "And now I have my\ninductor current. Let's suppose the inductor\ncurrent starts here. It rises up with slope M1, hits\nthe intersection, that's DT.",
    "start": "1132080",
    "end": "1146120"
  },
  {
    "text": "And then it falls with\nsome slope M2 or minus M2. But I'm actually treating\nthis thing dynamically.",
    "start": "1146120",
    "end": "1155010"
  },
  {
    "text": "I'm not necessarily\nsaying this end point is the same as the starting point. So this is a dynamic picture\nof what happens over one cycle.",
    "start": "1155010",
    "end": "1165005"
  },
  {
    "text": " And what I want to do is\nI want to relate somehow",
    "start": "1165005",
    "end": "1171630"
  },
  {
    "text": "this duty ratio in this cycle\nto what the local average",
    "start": "1171630",
    "end": "1177150"
  },
  {
    "text": "of the inductor current is. ",
    "start": "1177150",
    "end": "1182510"
  },
  {
    "text": "And I'm not going to do\nthat by local averaging. What I'm going to do\nis I'm going to make a geometric approximation.",
    "start": "1182510",
    "end": "1188929"
  },
  {
    "text": "I'm going to say, OK, let\nme look over this window and say the average of this\nwaveform, which is basically",
    "start": "1188930",
    "end": "1197270"
  },
  {
    "text": "the average here, the\naverage of this current",
    "start": "1197270",
    "end": "1203600"
  },
  {
    "text": "is the local average. So I'm saying IL of\nt is approximately",
    "start": "1203600",
    "end": "1214640"
  },
  {
    "text": "equal to the average\nof IL over this window.",
    "start": "1214640",
    "end": "1221450"
  },
  {
    "text": "Strictly speaking, this is\nequal to IL of capital T,",
    "start": "1221450",
    "end": "1227059"
  },
  {
    "text": "if this is time T. And it's\nnot quite the same thing anywhere else, but\nit turns out it's",
    "start": "1227060",
    "end": "1233750"
  },
  {
    "text": "pretty-- it's not a bad\ngeometric approximation. Now, if I wanted to be really\ntheoretically pure about this,",
    "start": "1233750",
    "end": "1244820"
  },
  {
    "text": "I might actually-- instead\nof looking over this window, which is centered at 0.5T, I\nmight look at a window centered",
    "start": "1244820",
    "end": "1253100"
  },
  {
    "text": "at dT and look around here and\nit extend into the different switching cycles. But it turns out for\npractical purposes,",
    "start": "1253100",
    "end": "1260030"
  },
  {
    "text": "you really more or\nless get the same-- for most cases, you more\nor less get the same thing. So the approximation\nI'm going to make",
    "start": "1260030",
    "end": "1266929"
  },
  {
    "text": "is good enough given all\nthe other approximations in the system. So I'm just going to\naverage it over this window.",
    "start": "1266930",
    "end": "1274460"
  },
  {
    "text": "But do people see what the\nbasic idea I'm going to use? I'm going to approximate IL bar\nas the average of this waveform.",
    "start": "1274460",
    "end": "1283610"
  },
  {
    "text": "And then that's a function of\nthe duty ratio in that cycle. And then I'm going to swap that\ninto my local average duty ratio",
    "start": "1283610",
    "end": "1289550"
  },
  {
    "text": "equation. Actually, I'm going\nto linearize it first, but that's neither\nhere nor there.",
    "start": "1289550",
    "end": "1294807"
  },
  {
    "text": "So let's do that. What is my\napproximation to IL bar?",
    "start": "1294807",
    "end": "1301850"
  },
  {
    "text": "Well, let's see. The peak of this waveform\nhere is I peak minus Mc dT.",
    "start": "1301850",
    "end": "1314180"
  },
  {
    "text": "That would be, if I wanted-- if I just use this value,\nthat would be basically",
    "start": "1314180",
    "end": "1323870"
  },
  {
    "text": "if the local-- if the waveform-- if\nthe orange waveform looked like this\ngreen waveform, that",
    "start": "1323870",
    "end": "1330350"
  },
  {
    "text": "would be exactly the local\naverage in the cycle. But what I really\nneed to do is kind",
    "start": "1330350",
    "end": "1335480"
  },
  {
    "text": "of subtract off the\naverage of this area and the average of this area. And then I'll have\nthe average underneath",
    "start": "1335480",
    "end": "1344060"
  },
  {
    "text": "the inductor current curve. So if I do that, then\nI'm going to get, OK, I've got to subtract off\nthe area of this triangle here.",
    "start": "1344060",
    "end": "1355309"
  },
  {
    "text": "So that would be\nminus 1/2 the base, which is dT times the\nheight, which is dT times M1.",
    "start": "1355310",
    "end": "1365833"
  },
  {
    "start": "1365833",
    "end": "1371220"
  },
  {
    "text": "And likewise-- and by the\nway, I better divide that by T because I'm taking an average. So this is 1 over 2T.",
    "start": "1371220",
    "end": "1376760"
  },
  {
    "text": " And I better subtract off the\narea of this triangle divided",
    "start": "1376760",
    "end": "1384740"
  },
  {
    "text": "by capital T. So this\nwould be minus 1 over 2T,",
    "start": "1384740",
    "end": "1390131"
  },
  {
    "text": "1 minus d quantity\nsquared T squared M2.",
    "start": "1390131",
    "end": "1396450"
  },
  {
    "text": "So if I rewrite that, IL bar is\napproximately equal to I peak",
    "start": "1396450",
    "end": "1403049"
  },
  {
    "text": "minus Mc dT minus 1/2 d squared\nTM1 minus 1/2 1 minus d squared",
    "start": "1403050",
    "end": "1417120"
  },
  {
    "text": "TM2. And this is the substitution\nI'm going to make.",
    "start": "1417120",
    "end": "1422655"
  },
  {
    "text": " Or it's the basis of the\nsubstitution I'm going to make.",
    "start": "1422655",
    "end": "1429389"
  },
  {
    "text": "Any questions about that? So I've got a geometric\napproximation relating",
    "start": "1429390",
    "end": "1436120"
  },
  {
    "text": "the duty ratio in the cycle,\nthe peak current in the cycle, and the local\naverage in the cycle.",
    "start": "1436120",
    "end": "1443250"
  },
  {
    "text": "So let me linearize this. ",
    "start": "1443250",
    "end": "1450102"
  },
  {
    "text": "I'm going to linearize\nthis because we're going to substitute it into\nour linearized equations, and I'm going to\nsolve for d tilde.",
    "start": "1450102",
    "end": "1460210"
  },
  {
    "text": "And if I do that, the\nresult you get is--",
    "start": "1460210",
    "end": "1468851"
  },
  {
    "text": "oh, and then the last\nthing I guess I should do is let me substitute\nin, in this case, u--",
    "start": "1468851",
    "end": "1477790"
  },
  {
    "text": "I'm sorry, M1 is\nequal to u over L. And M2 is equal to\nV minus u over L.",
    "start": "1477790",
    "end": "1486640"
  },
  {
    "text": "And if I make that\nsubstitution, I do it, what I get for my boost\nconverter is d tilde is equal",
    "start": "1486640",
    "end": "1492620"
  },
  {
    "text": "to 1 over McT I peak tilde minus\nIL tilde minus D squared minus D",
    "start": "1492620",
    "end": "1504710"
  },
  {
    "text": "prime squared over 2LMC, u tilde\nminus d prime squared over 2LMC,",
    "start": "1504710",
    "end": "1518220"
  },
  {
    "text": "V tilde. So this is a linearized version\nof this guy for the boost",
    "start": "1518220",
    "end": "1526530"
  },
  {
    "text": "converter. If you wanted to do a\nbuck boost converter, you'd need different\nexpressions for M1 and M2,",
    "start": "1526530",
    "end": "1532509"
  },
  {
    "text": "and you'd do the same process,\nand you'd linearize it. You'd get a\ndifferent expression. Any questions about that?",
    "start": "1532510",
    "end": "1538570"
  },
  {
    "text": " OK, so what's the\npoint of doing this?",
    "start": "1538570",
    "end": "1544990"
  },
  {
    "text": "The point of doing\nthis is I can now substitute in for d tilde\nin my existing equations.",
    "start": "1544990",
    "end": "1552910"
  },
  {
    "text": "And remember, d tilde\nwas my control variable in all my existing state space\naveraged linearized equations.",
    "start": "1552910",
    "end": "1558590"
  },
  {
    "text": "If I substituted for d\ntilde, I get rid of d tilde.",
    "start": "1558590",
    "end": "1563940"
  },
  {
    "text": "And all this other\nstuff is already in the equations except\nfor I peak tilde.",
    "start": "1563940",
    "end": "1569855"
  },
  {
    "text": " Does that make\nsense to everybody?",
    "start": "1569855",
    "end": "1577940"
  },
  {
    "text": "So I'm going to now get a new\nset of linearized state space",
    "start": "1577940",
    "end": "1583009"
  },
  {
    "text": "equations, except instead of\ndetailed in the equations, I'm going to have a\ncontrol variable Ip tilde.",
    "start": "1583010",
    "end": "1588510"
  },
  {
    "text": "That's what I needed here. So basically, I can take\nthis out and swap it",
    "start": "1588510",
    "end": "1597700"
  },
  {
    "text": "for an H2 of S that's basically\nequal to V tilde over I",
    "start": "1597700",
    "end": "1610460"
  },
  {
    "text": "peak tilde. ",
    "start": "1610460",
    "end": "1615950"
  },
  {
    "text": "So I basically got my\nwhole inner loop going. And now if I have Ip\ntilde and V tilde,",
    "start": "1615950",
    "end": "1623460"
  },
  {
    "text": "I can now giant\ndesign my outer loop. ",
    "start": "1623460",
    "end": "1628770"
  },
  {
    "text": "What was the point of\ndoing this substitution and getting my new H2 of S? If I look at H2 of S, I look\nat that transfer function,",
    "start": "1628770",
    "end": "1637540"
  },
  {
    "text": "what am I going to find? I'm still going to find\nthe right-half-plane zero.",
    "start": "1637540",
    "end": "1643230"
  },
  {
    "text": "I can't get rid of that. That's related to how\nthe converter behaves.",
    "start": "1643230",
    "end": "1648419"
  },
  {
    "text": "If I step I peak tilde,\nI'm still going to see--",
    "start": "1648420",
    "end": "1653730"
  },
  {
    "text": "I'm still going to see funny\nbehavior in the output voltage before the output\nvoltage response. And my right-half-plane\nzero doesn't go away.",
    "start": "1653730",
    "end": "1660640"
  },
  {
    "text": "The beautiful thing\nis, however, what I will tend to see is instead of\ntwo really lightly damped poles,",
    "start": "1660640",
    "end": "1668280"
  },
  {
    "text": "I'll tend to see a dominant pole\nand then a much higher frequency pole. ",
    "start": "1668280",
    "end": "1676020"
  },
  {
    "text": "Why? Because essentially\nthe way people like to think of it is this\ninner loop is making the current",
    "start": "1676020",
    "end": "1683040"
  },
  {
    "text": "do what you want. And hence, the dominant\npole is more or less governed by how the\ncurrent from that inductor",
    "start": "1683040",
    "end": "1690920"
  },
  {
    "text": "feeds into the output capacitor\nand charges up and down the output capacitor.",
    "start": "1690920",
    "end": "1697080"
  },
  {
    "text": "So it's not that I have\na first-order system. There is a second pole here. It's just dominated by\nthis low frequency pole.",
    "start": "1697080",
    "end": "1706029"
  },
  {
    "text": "And that's a much\neasier thing to control. Any questions about that?",
    "start": "1706030",
    "end": "1711815"
  },
  {
    "text": " So right now we can\ngo design GC of S.",
    "start": "1711815",
    "end": "1717708"
  },
  {
    "text": "I still have a\nright-half-plane zero, but it's a much easier\nplan to compensate, and I can put my dynamics much\nmore nicely than I could before.",
    "start": "1717708",
    "end": "1725039"
  },
  {
    "text": "And I get free current\nlimiting in the process. And in fact, if you're designing\nmost kinds of PWM-DC converters,",
    "start": "1725040",
    "end": "1734760"
  },
  {
    "text": "most of the control\nchips on the market are going to use\ncurrent mode control. This version that\nI'm showing you",
    "start": "1734760",
    "end": "1741000"
  },
  {
    "text": "is called peak\ncurrent mode control because you're controlling the\npeak of the inductor current.",
    "start": "1741000",
    "end": "1746309"
  },
  {
    "text": "And that's the most common kind. There's also valley control. And there's a few different\nversions of this general idea,",
    "start": "1746310",
    "end": "1753060"
  },
  {
    "text": "but this is the\nmost popular one. ",
    "start": "1753060",
    "end": "1761082"
  },
  {
    "text": "So that's one trick. Any questions up to now? ",
    "start": "1761082",
    "end": "1766650"
  },
  {
    "text": "AUDIENCE: Is there an easy way\nto understand why [INAUDIBLE]?",
    "start": "1766650",
    "end": "1772350"
  },
  {
    "text": "DAVID PERREAULT:\nExcellent question. I'll cover that one next. Any other questions?",
    "start": "1772350",
    "end": "1778280"
  },
  {
    "text": " OK, yeah, why did I even bother\nwith this ramping MC signal?",
    "start": "1778280",
    "end": "1789240"
  },
  {
    "text": "Why not just use I peak? And in some cases, you can.",
    "start": "1789240",
    "end": "1795030"
  },
  {
    "text": "But here's the problem\nwith doing that. ",
    "start": "1795030",
    "end": "1802252"
  },
  {
    "text": "In some cases, if I do\nthat, this is the situation I can find myself in.",
    "start": "1802252",
    "end": "1808080"
  },
  {
    "text": "I'm going along, and\nsuppose I just have I peak, and I get rid of the\ncompensating ramp.",
    "start": "1808080",
    "end": "1816120"
  },
  {
    "text": "So I'm at the\nbeginning of my cycle. And here's my inductor current. I turn on my switch, I\ngo up, and I hit the top.",
    "start": "1816120",
    "end": "1823650"
  },
  {
    "text": "And I trip, so this is my\nduty ratio in this cycle. And I turn off.",
    "start": "1823650",
    "end": "1828720"
  },
  {
    "text": "And then I turn off till\nthe end of the cycle. And here's the end of the cycle.",
    "start": "1828720",
    "end": "1833770"
  },
  {
    "text": "Here's capital T. And now I\nturn on my inductor current on, and he ramps up.",
    "start": "1833770",
    "end": "1839190"
  },
  {
    "text": "He hits here. Here's my duty\nratio in this cycle. And then he turns off, and I\nhit the end of the cycle, 2T.",
    "start": "1839190",
    "end": "1846309"
  },
  {
    "text": "And you can see that\nI don't settle down into periodic steady state\noperation at the switching",
    "start": "1846310",
    "end": "1852510"
  },
  {
    "text": "period. In this example, it\nrepeats every other cycle.",
    "start": "1852510",
    "end": "1857929"
  },
  {
    "text": " In some examples, it\nwon't settle down at all.",
    "start": "1857930",
    "end": "1863470"
  },
  {
    "text": "It'll just bungle\naround chaotically. I mean, literally chaotically. Now, is that a problem?",
    "start": "1863470",
    "end": "1869980"
  },
  {
    "text": "Well, I mean, at the\nhighest order, it's not. I'm still controlling\nthe peak current. My output loop will still\nregulate and everything,",
    "start": "1869980",
    "end": "1877440"
  },
  {
    "text": "but it is problematic\nfrom other perspectives. One perspective is my ripple\nin this case is a heck of a lot",
    "start": "1877440",
    "end": "1885059"
  },
  {
    "text": "bigger than if I were at some\nfixed intermediate duty ratio. So I get much bigger ripple.",
    "start": "1885060",
    "end": "1893030"
  },
  {
    "text": "The control is jittery because\nit's bouncing around depending upon the operating condition.",
    "start": "1893030",
    "end": "1898940"
  },
  {
    "text": "I have lower frequency\ncontent in my output. It's bigger ripple, and\nit's lower frequencies",
    "start": "1898940",
    "end": "1904580"
  },
  {
    "text": "that can make a mess of things. So people don't\nlike this behavior. This is sometimes called\nsubharmonic oscillation.",
    "start": "1904580",
    "end": "1912850"
  },
  {
    "text": "Well, this behavior where\nit's rippling at a subharmonic",
    "start": "1912850",
    "end": "1919580"
  },
  {
    "text": "is called a subharmonic\noscillation. But as I mentioned,\nin some cases, it can actually be chaotic. ",
    "start": "1919580",
    "end": "1926120"
  },
  {
    "text": "Generally, this issue is\ncalled the ripple instability. This ripple doesn't settle\ndown into periodic steady state",
    "start": "1926120",
    "end": "1931610"
  },
  {
    "text": "behavior. And what people figured out--\nand the first paper I knew about",
    "start": "1931610",
    "end": "1937790"
  },
  {
    "text": "this was out of the\nCaltech group in the late '70s, but other people\nthought of it too--",
    "start": "1937790",
    "end": "1943549"
  },
  {
    "text": "was to stick this compensating\nramp in, which if you put enough compensating ramp in makes\nthat behavior go away,",
    "start": "1943550",
    "end": "1949519"
  },
  {
    "text": "and it'll settle down\njust like this case, to a kind of a fixed ripple.",
    "start": "1949520",
    "end": "1954919"
  },
  {
    "text": "OK. AUDIENCE: Did we cover\nhow the MC is calculated?",
    "start": "1954920",
    "end": "1960950"
  },
  {
    "text": "DAVID PERREAULT: No, but I\nwill in about 30 seconds. Excellent question.",
    "start": "1960950",
    "end": "1967640"
  },
  {
    "text": "By the way, you might say,\nwhy did they think to do this? Well, A, they were clever. But B, think about it--\nin most power converters,",
    "start": "1967640",
    "end": "1975620"
  },
  {
    "text": "you have a ramp generator\nto set your clock frequency.",
    "start": "1975620",
    "end": "1981012"
  },
  {
    "text": "That's how you get\nyour oscillator. I'm going to turn\non every cycle. How do I know what that is? I generate a ramp that\nit hits the threshold,",
    "start": "1981012",
    "end": "1987379"
  },
  {
    "text": "and that sets my clock period. So they had this ramp\nsignal sticking around. So they just basically took\na little section of that ramp",
    "start": "1987380",
    "end": "1993815"
  },
  {
    "text": "signal and added or\nsubtracted it from I peak, and they found that\nfixed their problem.",
    "start": "1993815",
    "end": "1999289"
  },
  {
    "text": "So that's how they got\nto the idea, I think. Or that's why it's-- I shouldn't say that's\nhow they got the idea.",
    "start": "1999290",
    "end": "2005720"
  },
  {
    "text": "That's why it's a\nnatural trick to play because you have the signal\naround at your disposal.",
    "start": "2005720",
    "end": "2012040"
  },
  {
    "text": "But the question\nis, how big do I have to make this MC to\nget this behavior instead",
    "start": "2012040",
    "end": "2017890"
  },
  {
    "text": "of this behavior? And let's analyze that.",
    "start": "2017890",
    "end": "2023836"
  },
  {
    "text": "So let me take--  let me analyze-- let me\nfirst start and say, OK,",
    "start": "2023836",
    "end": "2032080"
  },
  {
    "text": "what would my periodic\nsteady state behavior be? Here is I peak. ",
    "start": "2032080",
    "end": "2040210"
  },
  {
    "text": "Here is my compensating ramp. Here's period T.",
    "start": "2040210",
    "end": "2047390"
  },
  {
    "text": "So if my compensating\nramp looks like this--  this is a slope minus MC--",
    "start": "2047390",
    "end": "2055590"
  },
  {
    "text": "maybe I could say my\nperiodic steady state behavior looks like this.",
    "start": "2055590",
    "end": "2060669"
  },
  {
    "text": "I start off somewhere. I ramp up with slope M1.",
    "start": "2060670",
    "end": "2069739"
  },
  {
    "text": "Then I ramp down\nwith slope minus M2. ",
    "start": "2069739",
    "end": "2077489"
  },
  {
    "text": "And I end up exactly\nwhere I started at the beginning of the cycle. This is periodic\nsteady state behavior.",
    "start": "2077489",
    "end": "2083280"
  },
  {
    "text": "So this is what I'm\ngoing to call DT. This is the behavior--\nthis yellow waveform is",
    "start": "2083280",
    "end": "2088888"
  },
  {
    "text": "the behavior I'm looking for. Let's suppose my inductor at the\nbeginning of this cycle started",
    "start": "2088889",
    "end": "2097970"
  },
  {
    "text": "off a little bit high. So suppose he started off here. He has some error,\nsome deviation",
    "start": "2097970",
    "end": "2104540"
  },
  {
    "text": "from periodic steady state that\nI'm going to call delta I sub n. So at the beginning\nof the cycle, he starts off a little bit high.",
    "start": "2104540",
    "end": "2112490"
  },
  {
    "text": "What would happen? Well, he would ramp\nup at the same slope because the output\nvoltage is the same.",
    "start": "2112490",
    "end": "2120140"
  },
  {
    "text": "So this would still be M1. He would hit the trip\npoint here at something",
    "start": "2120140",
    "end": "2127150"
  },
  {
    "text": "I'll call d star T. It's\nnot the steady state value. And then he would fall\nat minus M2, like this.",
    "start": "2127150",
    "end": "2141800"
  },
  {
    "text": "And then he would end\nup with some error at the end of the cycle or the\nbeginning of the next cycle",
    "start": "2141800",
    "end": "2147410"
  },
  {
    "text": "that I'll call delta I n plus 1. So if he starts off here,\nhe's going to end off here.",
    "start": "2147410",
    "end": "2154720"
  },
  {
    "text": "And I have a different error\nfrom periodic steady state at the beginning\nof the next cycle. Does that make sense?",
    "start": "2154720",
    "end": "2161619"
  },
  {
    "text": "So let's see if we can\nquantify what that looks like. And again, this was done by this\ngroup, this Middlebrook group.",
    "start": "2161620",
    "end": "2171040"
  },
  {
    "text": "And by the way, it's\nin a paper that we've posted on Canvas for you. And this behavior is also\ndescribed in a book chapter",
    "start": "2171040",
    "end": "2179980"
  },
  {
    "text": "that we've also posted\non Canvas for you. Here's the idea.",
    "start": "2179980",
    "end": "2185520"
  },
  {
    "text": "Let's quantify what\ndelta I sub n is. I could write delta I sub n in\nterms of this time difference, D",
    "start": "2185520",
    "end": "2196829"
  },
  {
    "text": "minus d star T\ntimes, let's see--",
    "start": "2196830",
    "end": "2204930"
  },
  {
    "text": "I go D minus d star\nT. I go up slope M1",
    "start": "2204930",
    "end": "2210660"
  },
  {
    "text": "and then backwards,\nso up slope MC. So this is going to be D1\ntimes d1 times is M1 plus MC.",
    "start": "2210660",
    "end": "2219540"
  },
  {
    "text": "So I could write this delta\nIn because these waveforms are",
    "start": "2219540",
    "end": "2226850"
  },
  {
    "text": "parallel in terms of M1 plus\nMC times d minus d star T. Does",
    "start": "2226850",
    "end": "2233900"
  },
  {
    "text": "that make sense to everybody? I could write this difference,\ndelta In plus 1 also",
    "start": "2233900",
    "end": "2243970"
  },
  {
    "text": "in terms of D minus d star t. Why? Because these two\nlines are parallel.",
    "start": "2243970",
    "end": "2251870"
  },
  {
    "text": "And what I've really\ngot is this is M1--",
    "start": "2251870",
    "end": "2261190"
  },
  {
    "text": "oops, I'm sorry-- M1 plus MC. I could write this-- ",
    "start": "2261190",
    "end": "2269880"
  },
  {
    "text": "I could write this in terms\nof D minus d star T times MC",
    "start": "2269880",
    "end": "2279730"
  },
  {
    "text": "minus M2. ",
    "start": "2279730",
    "end": "2288060"
  },
  {
    "text": "They're both related to\nthis time difference. It's just I'm kind of running\nup and down different slopes.",
    "start": "2288060",
    "end": "2295340"
  },
  {
    "text": "Does that make\nsense to everybody? So if I take the ratio\nof these two things,",
    "start": "2295340",
    "end": "2301230"
  },
  {
    "text": "I could write this as delta\nIn plus 1 over delta In.",
    "start": "2301230",
    "end": "2306490"
  },
  {
    "text": "That's what I get\nin one cycle is just going to be this\nratio, which I can write as the bottom\nover the top here,",
    "start": "2306490",
    "end": "2313980"
  },
  {
    "text": "which is minus M2 minus MC.",
    "start": "2313980",
    "end": "2321119"
  },
  {
    "text": "Actually, I'll\nwrite it this way. It's MC minus M2\ndivided by MC plus M1.",
    "start": "2321120",
    "end": "2331295"
  },
  {
    "text": " OK, that make\nsense to everybody?",
    "start": "2331295",
    "end": "2337740"
  },
  {
    "text": "That means that if I started\noff with some error delta I0,",
    "start": "2337740",
    "end": "2346860"
  },
  {
    "text": "I could write delta In\nas that ratio, which",
    "start": "2346860",
    "end": "2355110"
  },
  {
    "text": "I could write as minus-- and I'm going to\nwrite this the way they often write it in papers--\nminus M2 minus MC over M1",
    "start": "2355110",
    "end": "2366250"
  },
  {
    "text": "plus MC to the n-th power. ",
    "start": "2366250",
    "end": "2373300"
  },
  {
    "text": "Let me make sure I've\ngotten that right. Yeah, M1 plus MC.",
    "start": "2373300",
    "end": "2379150"
  },
  {
    "text": "So can anybody tell me what\nthe condition on this factor is to make an initial\nerror delta I0 go to 0?",
    "start": "2379150",
    "end": "2388425"
  },
  {
    "text": " Yeah, this ratio--\nwhat I require--",
    "start": "2388425",
    "end": "2395190"
  },
  {
    "text": "this suggests that I need\nthe magnitude of minus M2",
    "start": "2395190",
    "end": "2400640"
  },
  {
    "text": "minus MC over M1 plus\nMC to be less than 1.",
    "start": "2400640",
    "end": "2406700"
  },
  {
    "text": "This is the-- I've got a discrete time model\nfor what's going to have--",
    "start": "2406700",
    "end": "2415580"
  },
  {
    "text": "and it's going to decay if\nthis term is less than 1.",
    "start": "2415580",
    "end": "2422070"
  },
  {
    "text": "So what that usually says\nis that if I make MC bigger,",
    "start": "2422070",
    "end": "2427680"
  },
  {
    "text": "the numerator gets smaller. And actually, the\ndenominator gets bigger. So a bigger MC will make\nthis decay more quickly.",
    "start": "2427680",
    "end": "2434820"
  },
  {
    "text": "And in fact, if I made\nMC exactly equal to M2, it would be gone in one cycle.",
    "start": "2434820",
    "end": "2441150"
  },
  {
    "text": "Does that make\nsense to everybody? So what we'll do then,\nand we can look this up.",
    "start": "2441150",
    "end": "2446730"
  },
  {
    "text": "It depends on the\nconverter, what M1 and M2 are in the converter. But we will pick this\ncompensating ramp slope",
    "start": "2446730",
    "end": "2454110"
  },
  {
    "text": "to be big enough-- MC is a positive\nnumber to be big enough",
    "start": "2454110",
    "end": "2459670"
  },
  {
    "text": "that my ripple will decay\naway in a reasonable number of cycles. Maybe I make this magnitude less\nthan 0.5 or 0.7 or something",
    "start": "2459670",
    "end": "2466802"
  },
  {
    "text": "like that, so it'll settle down. ",
    "start": "2466802",
    "end": "2471990"
  },
  {
    "text": "Any questions about that? ",
    "start": "2471990",
    "end": "2478290"
  },
  {
    "text": "Now, I should be a little bit\ncareful in what I'm saying.",
    "start": "2478290",
    "end": "2483570"
  },
  {
    "text": "And by the way, what this means\nis if I had MC equal to 0, this would be minus M2 or\nM1 for the boost converter.",
    "start": "2483570",
    "end": "2490900"
  },
  {
    "text": "What that means\nis this magnitude would be greater than 1 if\nit was d greater than 0.5.",
    "start": "2490900",
    "end": "2496230"
  },
  {
    "text": "So if you took a boost converter\nand you didn't put any slope compensation-- if you're only\nrunning at 25% duty ratio, fine,",
    "start": "2496230",
    "end": "2503838"
  },
  {
    "text": "you won't have any\nripple instability because it'll settle down. If you get near 50%\nduty ratio or above,",
    "start": "2503838",
    "end": "2508920"
  },
  {
    "text": "it'll start doing this\nsubharmonic oscillation or ripple instability stuff.",
    "start": "2508920",
    "end": "2514040"
  },
  {
    "text": "This is sometimes called\nthe compensating ramp or the stabilizing\nramp for that reason.",
    "start": "2514040",
    "end": "2519580"
  },
  {
    "text": " Now, why don't I want\nto make MC really big?",
    "start": "2519580",
    "end": "2527430"
  },
  {
    "text": "Well, keep in mind,\nif we came back to this original\nmodel, notice that MC",
    "start": "2527430",
    "end": "2542339"
  },
  {
    "text": "appears in this substitution. My local average linearized\ndynamics of my converter",
    "start": "2542340",
    "end": "2551940"
  },
  {
    "text": "are not independent of MC. And when I told you, oh,\nby the way, I get nicely--",
    "start": "2551940",
    "end": "2561089"
  },
  {
    "text": "I get a really low frequency\npole and then a high frequency pole both on the real axis,\nthat's when MC is small.",
    "start": "2561090",
    "end": "2568529"
  },
  {
    "text": "As I make MC bigger and\nbigger, what happens",
    "start": "2568530",
    "end": "2575850"
  },
  {
    "text": "is these closed-- these\nopen loop poles move. And if I make MC too big,\nI get undamped poles again.",
    "start": "2575850",
    "end": "2584670"
  },
  {
    "text": "So basically, the\nhigher this value of MC, the closer the converter\ntransfer functions",
    "start": "2584670",
    "end": "2592080"
  },
  {
    "text": "and current mode\ncontrol look like they do for duty ratio control\nor voltage mode control. ",
    "start": "2592080",
    "end": "2600274"
  },
  {
    "text": "So what do we do? We would usually do this kind\nof ripple instability analysis",
    "start": "2600274",
    "end": "2607560"
  },
  {
    "text": "and pick an MC\nthat was big enough to make this settle down\nand make me happy but not",
    "start": "2607560",
    "end": "2612900"
  },
  {
    "text": "much bigger. And then I'd use that value-- I'd plunk it into here\nin this average model",
    "start": "2612900",
    "end": "2617910"
  },
  {
    "text": "and find out where\nmy pole locations are and go on from there.",
    "start": "2617910",
    "end": "2623350"
  },
  {
    "text": "I could also make-- obviously, I could make my\ncompensating ramp slope depend",
    "start": "2623350",
    "end": "2629859"
  },
  {
    "text": "upon M1 or M2 in some way. People don't usually\ngo to that range. If you've got to\nhave your converter",
    "start": "2629860",
    "end": "2636280"
  },
  {
    "text": "operating in a\nreally wide range, maybe you start to\nplay those games. But generally, you're\njust picking some slope",
    "start": "2636280",
    "end": "2642400"
  },
  {
    "text": "and setting it with a\nresistor or something. Questions?",
    "start": "2642400",
    "end": "2648070"
  },
  {
    "start": "2648070",
    "end": "2654670"
  },
  {
    "text": "Let me summarize.  We didn't like the fact that we\nhad these very lightly damped",
    "start": "2654670",
    "end": "2661640"
  },
  {
    "text": "polls. So we did full state\nfeedback, and we feed back",
    "start": "2661640",
    "end": "2669830"
  },
  {
    "text": "current on this inner loop. And then we use the outer loop\nto set the current reference and do the outer loop.",
    "start": "2669830",
    "end": "2675119"
  },
  {
    "text": "And that's the most common\nway people do things. ",
    "start": "2675120",
    "end": "2684550"
  },
  {
    "text": "I'll show you a demonstration\nof doing this that Mansi was kind enough to set up for us.",
    "start": "2684550",
    "end": "2689990"
  },
  {
    "text": "And all I'm doing is this is\nagain our demo boost converter",
    "start": "2689990",
    "end": "2695050"
  },
  {
    "text": "here. And it's actually using\ncurrent mode control. And the notion is\nwhat we have it set up",
    "start": "2695050",
    "end": "2703000"
  },
  {
    "text": "is that we can turn on and\noff this compensating ramp.",
    "start": "2703000",
    "end": "2709550"
  },
  {
    "text": "So here we go. Let me power up the converter.",
    "start": "2709550",
    "end": "2714840"
  },
  {
    "text": " And that's pretty nice.",
    "start": "2714840",
    "end": "2721560"
  },
  {
    "text": "I got more or less periodic\nsteady state operation. There's actually a tiny bit of\njitter in the duty ratio here,",
    "start": "2721560",
    "end": "2726720"
  },
  {
    "text": "but it's basically\nswitching once per cycle and nicely settled down.",
    "start": "2726720",
    "end": "2731730"
  },
  {
    "text": "What happens if I turn\noff the compensating ramp? Every cycle is doing\nsomething different,",
    "start": "2731730",
    "end": "2738830"
  },
  {
    "text": "and I can single sequence\nthis so you can see one shot. What you can see is sometimes\nit has a long duty ratio.",
    "start": "2738830",
    "end": "2746270"
  },
  {
    "text": "Sometimes it has a\nshort duty ratio. It kind of pips\naround like this. It's not unstable in the\nsense that my converter",
    "start": "2746270",
    "end": "2752630"
  },
  {
    "text": "is going to blow up. But what it does mean\nis that the ripple is all over the place. And I should say that\nthis is a function--",
    "start": "2752630",
    "end": "2760340"
  },
  {
    "text": "if I change the\nvoltage, this tends to-- if I have low-- if I have\na low boosting ratio,",
    "start": "2760340",
    "end": "2767450"
  },
  {
    "text": "it goes away, even without\na compensating ramp. But the higher I go, because\nof that ripple instability, I get some really kind\nof funky behavior.",
    "start": "2767450",
    "end": "2775250"
  },
  {
    "text": "If I throw in my\ncompensating ramp-- ",
    "start": "2775250",
    "end": "2784990"
  },
  {
    "text": "I've just done something\nbad to my converter. ",
    "start": "2784990",
    "end": "2791600"
  },
  {
    "text": "There, I get nice\nsteady state operation.",
    "start": "2791600",
    "end": "2799144"
  },
  {
    "text": "So that is current\nmode control for you. I wanted to tell you about\nit because in the context",
    "start": "2799144",
    "end": "2804970"
  },
  {
    "text": "of DC-to-DC converters, it's\nprobably the most widely used control technique. And to analyze it, you do\neverything we talked about",
    "start": "2804970",
    "end": "2811119"
  },
  {
    "text": "so far, and you take\none more step further to get a current mode model. Any final questions\nbefore we wrap up?",
    "start": "2811120",
    "end": "2818360"
  },
  {
    "text": " So that was our very brief\nsequence on modeling and control",
    "start": "2818360",
    "end": "2825319"
  },
  {
    "text": "of power converters. We will take up a\nnew topic next class. Have a great day.",
    "start": "2825320",
    "end": "2830799"
  },
  {
    "start": "2830800",
    "end": "2835000"
  }
]