[
  {
    "start": "0",
    "end": "1100"
  },
  {
    "text": "So now we can come\nto the central topic",
    "start": "1100",
    "end": "2820"
  },
  {
    "text": "of our lecture, which describes\nthe conditions under which",
    "start": "2820",
    "end": "6200"
  },
  {
    "text": "a Markov chain\nreaches steady state.",
    "start": "6200",
    "end": "9030"
  },
  {
    "text": "The question that we\nare asking, and which",
    "start": "9030",
    "end": "11230"
  },
  {
    "text": "we motivated in the\nprevious lecture",
    "start": "11230",
    "end": "12959"
  },
  {
    "text": "by looking at an example with a\nsimple, two-state Markov chain",
    "start": "12960",
    "end": "16350"
  },
  {
    "text": "is the following-- we are\nasking whether the probability",
    "start": "16350",
    "end": "19930"
  },
  {
    "text": "of being in state j at time n,\ngiven that you started at time",
    "start": "19930",
    "end": "23880"
  },
  {
    "text": "0 in state i, converges\nto some constant, pi of j.",
    "start": "23880",
    "end": "28609"
  },
  {
    "text": "In fact, that question\nconsists of two parts.",
    "start": "28610",
    "end": "32119"
  },
  {
    "text": "Do we have convergence?",
    "start": "32119",
    "end": "34170"
  },
  {
    "text": "And is it independent of i?",
    "start": "34170",
    "end": "38570"
  },
  {
    "text": "We have seen an example where\nit is not always the case.",
    "start": "38570",
    "end": "41730"
  },
  {
    "text": "For example, in\nthis Markov chain,",
    "start": "41730",
    "end": "44690"
  },
  {
    "text": "you have two recurrent classes.",
    "start": "44690",
    "end": "47210"
  },
  {
    "text": "This is one current class here.",
    "start": "47210",
    "end": "49160"
  },
  {
    "text": "And then there's a second\nrecurrent class here.",
    "start": "49160",
    "end": "52380"
  },
  {
    "text": "And we know that if\nwe are interested",
    "start": "52380",
    "end": "54760"
  },
  {
    "text": "in the long-time probability of\nbeing in that state, assuming",
    "start": "54760",
    "end": "58379"
  },
  {
    "text": "that you started in one\nof these states here,",
    "start": "58380",
    "end": "60920"
  },
  {
    "text": "the probability will\nbe 0 to be here.",
    "start": "60920",
    "end": "62920"
  },
  {
    "text": "But if you started in\none of these two states,",
    "start": "62920",
    "end": "65378"
  },
  {
    "text": "the probability\nwould be positive.",
    "start": "65379",
    "end": "67100"
  },
  {
    "text": "So clearly here, the\ninitial conditions",
    "start": "67100",
    "end": "69799"
  },
  {
    "text": "will matter whenever you have\ntwo or more recurrent classes.",
    "start": "69800",
    "end": "74039"
  },
  {
    "text": "So what would happen if you\nhave only one recurrent class?",
    "start": "74039",
    "end": "77110"
  },
  {
    "text": "So let's remove this one and\nconsider this situation here,",
    "start": "77110",
    "end": "80960"
  },
  {
    "text": "where you have only\none recurrent class.",
    "start": "80960",
    "end": "83826"
  },
  {
    "text": "In that case, what\nwe have seen--",
    "start": "83826",
    "end": "85200"
  },
  {
    "text": "this is still not sufficient.",
    "start": "85200",
    "end": "87038"
  },
  {
    "text": "Indeed, if you look at\nthis recurrent class",
    "start": "87039",
    "end": "90080"
  },
  {
    "text": "and you are interested\nin 9 and assume",
    "start": "90080",
    "end": "91980"
  },
  {
    "text": "that you started at\n9, then at time 1,",
    "start": "91980",
    "end": "94620"
  },
  {
    "text": "you will be either here or here.",
    "start": "94620",
    "end": "96990"
  },
  {
    "text": "And at time 2, you will\nbe back at 9 for sure.",
    "start": "96990",
    "end": "100180"
  },
  {
    "text": "And in general, for time n even,\nthe probability will be one,",
    "start": "100180",
    "end": "104420"
  },
  {
    "text": "and for time n odd,\nit will be zero.",
    "start": "104420",
    "end": "107930"
  },
  {
    "text": "So that specific n-step\ntransition probability",
    "start": "107930",
    "end": "111280"
  },
  {
    "text": "in that situation here\nwill never converge.",
    "start": "111280",
    "end": "114770"
  },
  {
    "text": "It will keep oscillating\nbetween 0 and 1.",
    "start": "114770",
    "end": "118180"
  },
  {
    "text": "So the issue here is that we\nhad a periodic recurrent class,",
    "start": "118180",
    "end": "123100"
  },
  {
    "text": "and the period in\nthat case was 2.",
    "start": "123100",
    "end": "125909"
  },
  {
    "text": "So let us consider now\nthe final case where",
    "start": "125910",
    "end": "128440"
  },
  {
    "text": "you have only one\nrecurrent class.",
    "start": "128440",
    "end": "131790"
  },
  {
    "text": "And that recurrent\nclass is not periodic.",
    "start": "131790",
    "end": "137120"
  },
  {
    "text": "And how do we realize that\nthis is not periodic here?",
    "start": "137120",
    "end": "139700"
  },
  {
    "text": "Well, we have a self\ntransition here.",
    "start": "139700",
    "end": "142430"
  },
  {
    "text": "So now that we have\none recurrent class,",
    "start": "142430",
    "end": "144150"
  },
  {
    "text": "and this recurrent class is\naperiodic, the question is--",
    "start": "144150",
    "end": "147769"
  },
  {
    "text": "do you have this kind\nof convergence here?",
    "start": "147770",
    "end": "149820"
  },
  {
    "text": "And it turns out-- and this is\nthe big theory of Markov chains",
    "start": "149820",
    "end": "153200"
  },
  {
    "text": "under the name of the\nsteady-state convergence",
    "start": "153200",
    "end": "155310"
  },
  {
    "text": "theorem-- that indeed, yes.",
    "start": "155310",
    "end": "157319"
  },
  {
    "text": "The rij's do converge to a\nsteady-state limit, which",
    "start": "157320",
    "end": "161250"
  },
  {
    "text": "we call a steady-state\nprobability as",
    "start": "161250",
    "end": "164130"
  },
  {
    "text": "long as these two\nconditions are satisfied.",
    "start": "164130",
    "end": "167440"
  },
  {
    "text": "So in summary, not only\nthese two conditions",
    "start": "167440",
    "end": "170000"
  },
  {
    "text": "are necessary, like we had\nseen with our counter example,",
    "start": "170000",
    "end": "174060"
  },
  {
    "text": "but they are sufficient.",
    "start": "174060",
    "end": "176050"
  },
  {
    "text": "We're not going to\nprove this theorem here.",
    "start": "176050",
    "end": "178260"
  },
  {
    "text": "It's a little bit complicated.",
    "start": "178260",
    "end": "179810"
  },
  {
    "text": "But what is the intuitive\nidea behind this theorem?",
    "start": "179810",
    "end": "183940"
  },
  {
    "text": "Well, let us think\nintuitively as",
    "start": "183940",
    "end": "185800"
  },
  {
    "text": "to why the initial\nstate does not matter,",
    "start": "185800",
    "end": "188520"
  },
  {
    "text": "when the chain has\na single recurrent",
    "start": "188520",
    "end": "190900"
  },
  {
    "text": "class and no periodic states.",
    "start": "190900",
    "end": "193459"
  },
  {
    "text": "The technique is\npretty classical.",
    "start": "193460",
    "end": "195520"
  },
  {
    "text": "The idea is the\nfollowing-- think",
    "start": "195520",
    "end": "197560"
  },
  {
    "text": "about two independent\ncopies of that Markov chain,",
    "start": "197560",
    "end": "200819"
  },
  {
    "text": "starting at two different\ninitial conditions.",
    "start": "200820",
    "end": "203910"
  },
  {
    "text": "So for example, think\nabout a red copy.",
    "start": "203910",
    "end": "206590"
  },
  {
    "text": "And the red copy would\ninitially start at state 2.",
    "start": "206590",
    "end": "210730"
  },
  {
    "text": "And then at each unit of time\nwill jump to the next state,",
    "start": "210730",
    "end": "214537"
  },
  {
    "text": "according to the transition\nprobabilities of this Markov",
    "start": "214537",
    "end": "216870"
  },
  {
    "text": "chain.",
    "start": "216870",
    "end": "217530"
  },
  {
    "text": "So for example, so this is\nat time 0, which was here.",
    "start": "217530",
    "end": "220209"
  },
  {
    "text": "Time 1 might come here.",
    "start": "220210",
    "end": "223079"
  },
  {
    "text": "Time 2, 3, 4, 5 and so forth.",
    "start": "223079",
    "end": "233000"
  },
  {
    "text": "So this is one copy\nof the Markov chain.",
    "start": "233000",
    "end": "235220"
  },
  {
    "text": "So think about another\ncopy, the blue copy.",
    "start": "235220",
    "end": "237910"
  },
  {
    "text": "And assume that the blue\ncopy started here at time 0.",
    "start": "237910",
    "end": "242090"
  },
  {
    "text": "And again, independently\nof the other,",
    "start": "242090",
    "end": "243980"
  },
  {
    "text": "but during the\nsame unit of time,",
    "start": "243980",
    "end": "246010"
  },
  {
    "text": "it will jump from state\nto state according",
    "start": "246010",
    "end": "248599"
  },
  {
    "text": "to the transition\nprobabilities again.",
    "start": "248600",
    "end": "250350"
  },
  {
    "text": "So think that maybe\nthis one will go here.",
    "start": "250350",
    "end": "253300"
  },
  {
    "text": "Then will go here.",
    "start": "253300",
    "end": "255040"
  },
  {
    "text": "Times 2, 3 will be here,\n4 here, maybe 5 here.",
    "start": "255040",
    "end": "262660"
  },
  {
    "text": "And so forth.",
    "start": "262660",
    "end": "264670"
  },
  {
    "text": "Now look at these two\nindependent copies.",
    "start": "264670",
    "end": "267530"
  },
  {
    "text": "There will be a time and in that\ncase, for our little example",
    "start": "267530",
    "end": "270580"
  },
  {
    "text": "here, is the time 4,\nwhere for the first time",
    "start": "270580",
    "end": "273449"
  },
  {
    "text": "they collide, in\nthe sense that they",
    "start": "273450",
    "end": "275780"
  },
  {
    "text": "jump to the same state\nat the same time.",
    "start": "275780",
    "end": "278490"
  },
  {
    "text": "So at time 4, both\nof them are here.",
    "start": "278490",
    "end": "282220"
  },
  {
    "text": "Now, think a little bit\nabout the future evolution",
    "start": "282220",
    "end": "285409"
  },
  {
    "text": "of these two independent copies,\ngiven that they are in state 4",
    "start": "285409",
    "end": "289659"
  },
  {
    "text": "now.",
    "start": "289659",
    "end": "290300"
  },
  {
    "text": "And here we are using\nthe Markov property",
    "start": "290300",
    "end": "292639"
  },
  {
    "text": "to say that the future\nevolution of the blue copy",
    "start": "292640",
    "end": "295970"
  },
  {
    "text": "is independent of\nthe previous path.",
    "start": "295970",
    "end": "298310"
  },
  {
    "text": "Given that you are in state 4,\nthe fact that you started in 1",
    "start": "298310",
    "end": "301639"
  },
  {
    "text": "does not matter for the future\nevolution of that blue copy.",
    "start": "301640",
    "end": "305150"
  },
  {
    "text": "And for the red copy,\ngiven that you are in 4,",
    "start": "305150",
    "end": "308449"
  },
  {
    "text": "the fact that you\nstarted in 2 does not",
    "start": "308450",
    "end": "310890"
  },
  {
    "text": "matter to characterize\nthe future evolutions",
    "start": "310890",
    "end": "313230"
  },
  {
    "text": "of that red copy.",
    "start": "313230",
    "end": "315780"
  },
  {
    "text": "So in some sense,\nprobabilistically speaking,",
    "start": "315780",
    "end": "319389"
  },
  {
    "text": "these two copies cannot be\ndistinguished for their future",
    "start": "319390",
    "end": "323370"
  },
  {
    "text": "evolutions, given that\nthey both are at state 4.",
    "start": "323370",
    "end": "326190"
  },
  {
    "text": "So this means that the initial\nconditions for these two",
    "start": "326190",
    "end": "329680"
  },
  {
    "text": "copies, given that these two\ncopies met at a given state,",
    "start": "329680",
    "end": "334090"
  },
  {
    "text": "at a given time--\nprobabilistically speaking,",
    "start": "334090",
    "end": "336680"
  },
  {
    "text": "nothing can differentiate\nthem in the future because",
    "start": "336680",
    "end": "339780"
  },
  {
    "text": "of the Markov property.",
    "start": "339780",
    "end": "341350"
  },
  {
    "text": "That's essentially the\nhigh-level idea of this proof.",
    "start": "341350",
    "end": "344920"
  },
  {
    "text": "Now, the key thing\nhere mathematically",
    "start": "344920",
    "end": "347610"
  },
  {
    "text": "is to prove that whenever\nyou have a Markov chain that",
    "start": "347610",
    "end": "352280"
  },
  {
    "text": "has a single recurrent class and\nthis single recurrent class is",
    "start": "352280",
    "end": "356909"
  },
  {
    "text": "not periodic, and you start\nfrom any initial conditions,",
    "start": "356909",
    "end": "361040"
  },
  {
    "text": "the two copies will\neventually meet in a given",
    "start": "361040",
    "end": "363690"
  },
  {
    "text": "state at a given time\nwith probability 1.",
    "start": "363690",
    "end": "367580"
  },
  {
    "text": "OK.",
    "start": "367580",
    "end": "368080"
  },
  {
    "text": "So now let's assume\nthat the theorem holds.",
    "start": "368080",
    "end": "370530"
  },
  {
    "text": "That means that\nyes, indeed, we have",
    "start": "370530",
    "end": "372480"
  },
  {
    "text": "proved the existence of these\nsteady-state probabilities.",
    "start": "372480",
    "end": "376390"
  },
  {
    "text": "The question is now\nhow to calculate them.",
    "start": "376390",
    "end": "380840"
  },
  {
    "text": "Well, the way to do it is to\nstart from our key recursion",
    "start": "380840",
    "end": "385100"
  },
  {
    "text": "that we had for the m-state\ntransition probabilities.",
    "start": "385100",
    "end": "389190"
  },
  {
    "text": "So where we assume\nhere that we have m",
    "start": "389190",
    "end": "392000"
  },
  {
    "text": "states, and we are\ngoing to take the limits",
    "start": "392000",
    "end": "397210"
  },
  {
    "text": "on both sides of this equality.",
    "start": "397210",
    "end": "400030"
  },
  {
    "text": "So when n goes to infinity,\nwe know that rij of n",
    "start": "400030",
    "end": "403060"
  },
  {
    "text": "will go to pi of j.",
    "start": "403060",
    "end": "405110"
  },
  {
    "text": "And here, when n\ngoes to infinity,",
    "start": "405110",
    "end": "407400"
  },
  {
    "text": "in some sense n minus 1\nalso goes to infinity.",
    "start": "407400",
    "end": "411139"
  },
  {
    "text": "And so rik of n minus\n1 should go to pi of k.",
    "start": "411140",
    "end": "415960"
  },
  {
    "text": "And so we are using\nthat property.",
    "start": "415960",
    "end": "418330"
  },
  {
    "text": "And again, we take the\nlimit as n goes to infinity.",
    "start": "418330",
    "end": "422740"
  },
  {
    "text": "And we say that rij of\nn converges to here.",
    "start": "422740",
    "end": "428210"
  },
  {
    "text": "Now, the limit on\nthis side-- you",
    "start": "428210",
    "end": "429720"
  },
  {
    "text": "have a limit of a finite sum.",
    "start": "429720",
    "end": "431310"
  },
  {
    "text": "You can exchange the\nsummation and the limit.",
    "start": "431310",
    "end": "434630"
  },
  {
    "text": "And so you take\nthe limit inside.",
    "start": "434630",
    "end": "436970"
  },
  {
    "text": "The limit of rik of n minus\n1, when n goes to infinity,",
    "start": "436970",
    "end": "442110"
  },
  {
    "text": "goes to pi of k.",
    "start": "442110",
    "end": "444120"
  },
  {
    "text": "And then you have\nthe resulting term.",
    "start": "444120",
    "end": "446169"
  },
  {
    "text": "And so from that,\ntaking the limit",
    "start": "446170",
    "end": "448410"
  },
  {
    "text": "again as n goes to\ninfinity on both sides,",
    "start": "448410",
    "end": "452010"
  },
  {
    "text": "you end up with this\nequation here for j.",
    "start": "452010",
    "end": "455000"
  },
  {
    "text": "Now, you can do that for any\nof the j of your Markov chain.",
    "start": "455000",
    "end": "461850"
  },
  {
    "text": "So you have m states, so you\nend up having m equations.",
    "start": "461850",
    "end": "467150"
  },
  {
    "text": "And you have m\nunknowns, the m pi j's.",
    "start": "467150",
    "end": "473850"
  },
  {
    "text": "So this is a system of m\nequations with m unknowns.",
    "start": "473850",
    "end": "477580"
  },
  {
    "text": "Unfortunately, this\nsystem is singular",
    "start": "477580",
    "end": "480240"
  },
  {
    "text": "and it has multiple solutions.",
    "start": "480240",
    "end": "482009"
  },
  {
    "text": "And one way to see that\nis the solution pi j",
    "start": "482010",
    "end": "486430"
  },
  {
    "text": "equals 0 for all j is a\nvalid solution to the system.",
    "start": "486430",
    "end": "491190"
  },
  {
    "text": "Zero equals zero.",
    "start": "491190",
    "end": "492590"
  },
  {
    "text": "So clearly this is\nnot very informative.",
    "start": "492590",
    "end": "495600"
  },
  {
    "text": "So maybe we need\none more condition",
    "start": "495600",
    "end": "497380"
  },
  {
    "text": "to get a uniquely solvable\nsystem of linear equations.",
    "start": "497380",
    "end": "501320"
  },
  {
    "text": "It turns out that the\nsystem of equations",
    "start": "501320",
    "end": "503090"
  },
  {
    "text": "has a unique solution if you\nimpose an additional condition,",
    "start": "503090",
    "end": "506820"
  },
  {
    "text": "which is pretty natural,\nwhich means that the pi",
    "start": "506820",
    "end": "509690"
  },
  {
    "text": "j's are actually probabilities.",
    "start": "509690",
    "end": "512880"
  },
  {
    "text": "They should all sum to 1.",
    "start": "512880",
    "end": "515260"
  },
  {
    "text": "In other words, in\nthe future, if you",
    "start": "515260",
    "end": "516909"
  },
  {
    "text": "ask yourself what is the\nprobability of being in state",
    "start": "516909",
    "end": "519159"
  },
  {
    "text": "j, and you get pi\nof j, the summation",
    "start": "519159",
    "end": "521979"
  },
  {
    "text": "of all of the possible\nstates have to be 1.",
    "start": "521980",
    "end": "524399"
  },
  {
    "text": "If you consider that additional\nequation, plus that system",
    "start": "524400",
    "end": "528340"
  },
  {
    "text": "here, so if you consider\nthis extended system,",
    "start": "528340",
    "end": "532660"
  },
  {
    "text": "then you can show that\nthis has a unique solution.",
    "start": "532660",
    "end": "537819"
  },
  {
    "text": "And this unique solution\ncannot be this one.",
    "start": "537820",
    "end": "540950"
  },
  {
    "text": "And so in conclusion,\nwe can find",
    "start": "540950",
    "end": "543160"
  },
  {
    "text": "the steady-state probabilities\nof the Markov chain",
    "start": "543160",
    "end": "545730"
  },
  {
    "text": "by just solving these\nlinear equations, which",
    "start": "545730",
    "end": "548660"
  },
  {
    "text": "should be numerically a\nstraightforward procedure.",
    "start": "548660",
    "end": "552170"
  }
]