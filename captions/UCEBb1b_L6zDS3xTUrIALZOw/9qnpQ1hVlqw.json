[
  {
    "start": "0",
    "end": "21000"
  },
  {
    "text": "The following content is\nprovided under a Creative Commons license. Your support will help\nMIT OpenCourseWare",
    "start": "0",
    "end": "6330"
  },
  {
    "text": "continue to offer high quality\neducational resources for free. To make a donation or\nview additional materials",
    "start": "6330",
    "end": "13320"
  },
  {
    "text": "from hundreds of MIT courses,\nvisit MIT OpenCourseWare at ocw.mit.edu",
    "start": "13320",
    "end": "21642"
  },
  {
    "text": "RUSS TEDRAKE: OK. Welcome back. So last time we talked\nabout the cart-pole",
    "start": "21642",
    "end": "27120"
  },
  {
    "text": "and the acrobat systems. Two of the model\nsystems that are sort of the\nfundamentals of a lot",
    "start": "27120",
    "end": "34260"
  },
  {
    "text": "of the underactuated\ncontrol work in robotics. We really just talked\nabout balancing at the top,",
    "start": "34260",
    "end": "39420"
  },
  {
    "text": "showing that some of the\nlinear optimal control things we've already done\nwere consistent with balancing",
    "start": "39420",
    "end": "45420"
  },
  {
    "text": "those underactuated\nsystems at the top. And we said if we can, maybe\ntoday, design a controller",
    "start": "45420",
    "end": "51690"
  },
  {
    "text": "to get as close to the top,\nthen we could turn on something like a feedback controller\nbased on the linear quadratic regulators to catch us.",
    "start": "51690",
    "end": "60270"
  },
  {
    "text": "So we were basically able to\ndo linear control at the top. And today we're going to do the\nswing up, which is in some ways",
    "start": "60270",
    "end": "69240"
  },
  {
    "text": "easier, and in some ways harder. It turns out very\nsimple controllers will get the job done.",
    "start": "69240",
    "end": "74707"
  },
  {
    "text": "But showing that\nthey get the job done is quite another story. And really my goal for\ntoday is to give you",
    "start": "74707",
    "end": "82080"
  },
  {
    "text": "just a little glimpse into what\nthe world of nonlinear control looks like for the other\nguys, for the people who",
    "start": "82080",
    "end": "90223"
  },
  {
    "text": "really do nonlinear control. All right. We're going to mostly\nhurtle over this stuff and get to the\ncomputational versions,",
    "start": "90223",
    "end": "96670"
  },
  {
    "text": "but if you were going to be sort\nof a nonlinear robotics control guy, you'll see a\nlittle bit of that today",
    "start": "96670",
    "end": "102815"
  },
  {
    "text": "and just get a sense. I hope. And I'll finish the story\nwith PFL, the partial feedback",
    "start": "102815",
    "end": "110340"
  },
  {
    "text": "linearization, showing\nyou the most general form and what it's good for\nin the swing up phase.",
    "start": "110340",
    "end": "115590"
  },
  {
    "text": " OK. So non-linear control comes\nin a lot of varieties.",
    "start": "115590",
    "end": "124437"
  },
  {
    "text": "I'm going to make\nthis point a couple of times, but, roughly, one\nway to say what nonlinear",
    "start": "124438",
    "end": "134100"
  },
  {
    "text": "control is that end up\nlooking at your nonlinear equations of motion\nfor a long time,",
    "start": "134100",
    "end": "140130"
  },
  {
    "text": "and you try to find some tricks. So you can write down some\nnon-linear controller, and then",
    "start": "140130",
    "end": "147780"
  },
  {
    "text": "another trick just to\nprove that it works. OK. So one of the tricks\nthat is pervasive",
    "start": "147780",
    "end": "154440"
  },
  {
    "text": "in under actuated control,\nand other control, is to look at the\nenergetics of the system.",
    "start": "154440",
    "end": "161837"
  },
  {
    "text": "The energetics of-- the\ntotal energy of the system is obviously a very\nimportant quantity. You can imagine with our\nacrobat, or our cart-pole,",
    "start": "161837",
    "end": "171780"
  },
  {
    "text": "we have one motor to work\nwith, multiple state variables,",
    "start": "171780",
    "end": "177540"
  },
  {
    "text": "right. But the energy is just\na single quantity. So you can imagine with one\nmotor possibly regulating",
    "start": "177540",
    "end": "183720"
  },
  {
    "text": "the energy of the\nsystem, even if we can't regulate the entire\ntrajectory of the system.",
    "start": "183720",
    "end": "188860"
  },
  {
    "text": "OK. So that's one of the\nreasons it's important. So let's start by\njust thinking about",
    "start": "188860",
    "end": "194130"
  },
  {
    "text": "if we can regulate the energy\nof the system, what good is that going to do us. ",
    "start": "194130",
    "end": "219540"
  },
  {
    "text": "OK. And again let's start simple. Let's do the derivation\non the simple pendulum,",
    "start": "219540",
    "end": "227830"
  },
  {
    "start": "220000",
    "end": "655000"
  },
  {
    "text": "then we'll do the cart-pole and\nacrobat immediately after that. So let's remember\nthe phase portrait",
    "start": "227830",
    "end": "235030"
  },
  {
    "text": "for the simple pendulum again. ",
    "start": "235030",
    "end": "248270"
  },
  {
    "text": "Let's say with no\ntorque, no damping. ",
    "start": "248270",
    "end": "257310"
  },
  {
    "text": "We had a phase portrait-- I'm sure you remember--\nwhich looked like this. ",
    "start": "257310",
    "end": "267530"
  },
  {
    "text": "And the way I had the\ncoordinate system, we had a fixed point, unstable\nfixed point, fixed point.",
    "start": "267530",
    "end": "274940"
  },
  {
    "start": "274940",
    "end": "283370"
  },
  {
    "text": "OK. If we started the\nsystem a little bit away from the fixed\npoint, then we got these closed orbits, right.",
    "start": "283370",
    "end": "290960"
  },
  {
    "text": "For the zero torque,\nzero damping case, we got these nice orbits.",
    "start": "290960",
    "end": "297260"
  },
  {
    "text": "They were pretty circular,\nclose to the origin. They got a little\nelongated as we went out.",
    "start": "297260",
    "end": "303902"
  },
  {
    "text": "Look like an eyeball. ",
    "start": "303902",
    "end": "309439"
  },
  {
    "text": "And then there was this\nvery special orbit. I didn't dwell on\nit before, but we're going to dwell on\nit now for a second.",
    "start": "309440",
    "end": "317330"
  },
  {
    "text": "A special orbit which\nends up going right to that unstable, fixed point.",
    "start": "317330",
    "end": "325479"
  },
  {
    "text": "OK. ",
    "start": "325480",
    "end": "331100"
  },
  {
    "text": "What defines these orbits? ",
    "start": "331100",
    "end": "336230"
  },
  {
    "text": "Energy, someone said, right. These are lines of constant\nenergy in the simple pendulum,",
    "start": "336230",
    "end": "342930"
  },
  {
    "text": "right.  And there is a particular\nline of constant-- orbit",
    "start": "342930",
    "end": "349280"
  },
  {
    "text": "of constant energy here,\nwhich, if you have that energy,",
    "start": "349280",
    "end": "355375"
  },
  {
    "text": "this system we know is\ngoing to go around this way. There's no other choice. If we have that energy,\nright, then it's",
    "start": "355375",
    "end": "361730"
  },
  {
    "text": "going to find its way\nup to that fixed point. There's nothing else it can do.",
    "start": "361730",
    "end": "367700"
  },
  {
    "text": "OK. So these orbits are called\nhomoclinic orbits What's that?",
    "start": "367700",
    "end": "382280"
  },
  {
    "start": "382280",
    "end": "387820"
  },
  {
    "text": "So a homoclinic\norbit is something that goes from an\nunstable, fixed point to another unstable,\nfixed point.",
    "start": "387820",
    "end": "394180"
  },
  {
    "text": "OK. Actually, homoclinic\nmeans it goes to the same unstable,\nfixed point. Heteroclinic means it goes\nto a different one, I guess.",
    "start": "394180",
    "end": "401462"
  },
  {
    "text": " And in the simple pendulum with\nzero damping and zero actions.",
    "start": "401462",
    "end": "410090"
  },
  {
    "text": "It's sort of easy to see\nthat if we can design a trajectory which regulates\nthe energy of the system, right,",
    "start": "410090",
    "end": "417550"
  },
  {
    "text": "it's going to move. Let's say we set this as our\ndesired energy for the system. If we can regulate the\nsystem's energy up to this,",
    "start": "417550",
    "end": "423790"
  },
  {
    "text": "by applying a feedback law. That if we can get on that\nconstant energy trajectory",
    "start": "423790",
    "end": "429550"
  },
  {
    "text": "and stay there, then we're\ngoing to find ourselves getting to the unstable fixed point.",
    "start": "429550",
    "end": "434870"
  },
  {
    "text": "OK. So that's an\nimportant observation. Now, regulating the energy isn't\nactually enough to stay there.",
    "start": "434870",
    "end": "443780"
  },
  {
    "text": "Well is it? I should get to\nthe-- if I really regulate my energy\nperfectly, I should get",
    "start": "443780",
    "end": "449720"
  },
  {
    "text": "to the unstable, fixed point. But if I'm just doing\nenergy regulation,",
    "start": "449720",
    "end": "456160"
  },
  {
    "text": "then if someone were to\nknock me here, I'd be OK. I just come right back. If I knock me here, I'd\nactually go all the way around",
    "start": "456160",
    "end": "462669"
  },
  {
    "text": "to this one. So it's not actually,\ndoesn't actually stabilize. Regulating the energy doesn't\nactually stabilize this point.",
    "start": "462670",
    "end": "470500"
  },
  {
    "text": "But it could get me there. OK. So the first thing\nwe're going to do today is show that if I regulate\nthe energy of my system,",
    "start": "470500",
    "end": "480460"
  },
  {
    "text": "on the simple pendulum, to put\nmyself on the homoclinic orbit",
    "start": "480460",
    "end": "486162"
  },
  {
    "text": "then I can get myself\nto the fixed point. I turn on an LQR controller\nwhen I get there, and I've got a swing-up\nand balance controller.",
    "start": "486162",
    "end": "494379"
  },
  {
    "text": "OK. ",
    "start": "494380",
    "end": "500910"
  },
  {
    "text": "All right. How do we regulate the energy\nof the simple pendulum? ",
    "start": "500910",
    "end": "508430"
  },
  {
    "text": "Let's just remember\nfor the simple pendulum",
    "start": "508430",
    "end": "514580"
  },
  {
    "text": "our equations of\nmotion were m l squared theta dot plus m g l sin theta,\naccording to the system I used,",
    "start": "514580",
    "end": "521340"
  },
  {
    "text": "which was 0 down,\nequals my control input. ",
    "start": "521340",
    "end": "532880"
  },
  {
    "text": "And the energy is\njust 1/2 m l squared theta dot squared\nminus m g l cos theta,",
    "start": "532880",
    "end": "544597"
  },
  {
    "text": "the total energy of the system. ",
    "start": "544598",
    "end": "551350"
  },
  {
    "text": "OK. So if I find myself in some\ntheta theta dot configuration, what should I do to increase\nthe energy the system?",
    "start": "551350",
    "end": "559050"
  },
  {
    "text": " STUDENT: Push in the\ndirection of theta dot",
    "start": "559050",
    "end": "564790"
  },
  {
    "text": "RUSS TEDRAKE: Good. Yeah. Right. Whatever I want to\ndo, whatever velocity",
    "start": "564790",
    "end": "570340"
  },
  {
    "text": "I'm going at, if I push in the\ndirection of theta dot, that's going to add kinetic\nenergy to my system.",
    "start": "570340",
    "end": "576339"
  },
  {
    "text": "OK. We can see that actually\nvery explicitly, so what is the rate\nof change of e here?",
    "start": "576340",
    "end": "586209"
  },
  {
    "text": "It's 1/2 m l squared theta\ndot theta double dot--",
    "start": "586210",
    "end": "592124"
  },
  {
    "text": "this half goes away-- minus m g l theta dot sin theta.",
    "start": "592124",
    "end": "603977"
  },
  {
    "text": "I put my sin there again.  And theta double dot is\nu minus m g l sin theta",
    "start": "603978",
    "end": "615250"
  },
  {
    "text": "over m l squared. Can I do that? All right. So m l squared theta double\ndot is just u minus m g",
    "start": "615250",
    "end": "628050"
  },
  {
    "text": "l sin theta plus m g\nl sin theta theta dot.",
    "start": "628050",
    "end": "639010"
  },
  {
    "text": " All right. So that works out nice.",
    "start": "639010",
    "end": "647519"
  },
  {
    "text": "It's just u theta dot. ",
    "start": "647520",
    "end": "656600"
  },
  {
    "text": "So it's exactly what we said. If you want to increase\nthe energy of the system,",
    "start": "656600",
    "end": "664700"
  },
  {
    "text": "right, then you better make\nu the same sign as theta dot.",
    "start": "664700",
    "end": "669733"
  },
  {
    "text": "You can make it\nexactly theta dot. You can make it a constant. You can make it-- just as long as\nit's the same sign,",
    "start": "669733",
    "end": "674870"
  },
  {
    "text": "you're going to increase\nthe energy of the system. And similarly you can decrease\nthe energy of the system by pushing against theta dot.",
    "start": "674870",
    "end": "681068"
  },
  {
    "text": "And that's obvious. Really, that's just\neither damping the system with-- you're adding positive\ndamping to the system",
    "start": "681068",
    "end": "686660"
  },
  {
    "text": "or negative damping\nto the system right. OK. But seeing it out of\nthese energy derivatives",
    "start": "686660",
    "end": "692149"
  },
  {
    "text": "is the right way to see\nit if you want to do it for a more complicated system. OK.",
    "start": "692150",
    "end": "697370"
  },
  {
    "text": "So good. So I can now imagine easily\nwith my control torque",
    "start": "697370",
    "end": "706070"
  },
  {
    "text": "regulating the\nenergy the system, or increasing or decreasing it. So what do we want\nto do with it?",
    "start": "706070",
    "end": "711890"
  },
  {
    "start": "711890",
    "end": "727990"
  },
  {
    "text": "Presumably we have\nsome desired energy, e, which is the energy\non that homoclinic orbit.",
    "start": "727990",
    "end": "736210"
  },
  {
    "text": "Right. And what's that? What's the energy on\nthe homoclinic orbit? ",
    "start": "736210",
    "end": "751500"
  },
  {
    "text": "M g l. Yeah.  At the top it'll\nbe [? cos of e ?]",
    "start": "751500",
    "end": "764758"
  },
  {
    "start": "760000",
    "end": "910000"
  },
  {
    "text": "The only problem with\nthis parameterization is I have negative energy. I could have done\na little bit more",
    "start": "764758",
    "end": "769940"
  },
  {
    "text": "carefully by putting zero\npotential at the bottom, but right. This one-- still our\ndesired energy is positive",
    "start": "769940",
    "end": "777410"
  },
  {
    "text": "and it's at the top, m g l. That's the energy you'd\nhave if theta equals",
    "start": "777410",
    "end": "791480"
  },
  {
    "text": "pi and theta dot equals 0. ",
    "start": "791480",
    "end": "799500"
  },
  {
    "text": "OK. So what we care about is\nregulating the difference between our actual energy of our\nsystem and the desired energy",
    "start": "799500",
    "end": "809580"
  },
  {
    "text": "the system. ",
    "start": "809580",
    "end": "822940"
  },
  {
    "text": "The desired energy is constant. So this is just e dot. e tilde dot is just e dot,\nwhich is just e theta dot.",
    "start": "822940",
    "end": "831562"
  },
  {
    "text": " So if I know to\nchange e, I certainly",
    "start": "831562",
    "end": "837600"
  },
  {
    "text": "know how to change e tilde. OK. So the cool thing\nhere, let's choose u",
    "start": "837600",
    "end": "844920"
  },
  {
    "text": "equals negative k theta dot e\ntilde, with k always greater",
    "start": "844920",
    "end": "856260"
  },
  {
    "text": "than 0. ",
    "start": "856260",
    "end": "865950"
  },
  {
    "text": "The result then is\ne tilde is going",
    "start": "865950",
    "end": "872570"
  },
  {
    "text": "to be negative k,\nwhich is positive, theta dot squared e tilde.",
    "start": "872570",
    "end": "880100"
  },
  {
    "text": " Just a little manipulation.",
    "start": "880100",
    "end": "885748"
  },
  {
    "text": " And that gives me that, as long\nas this thing is negative--",
    "start": "885748",
    "end": "894760"
  },
  {
    "text": "it's a linear\nequation in e-- then e tilde is going to go to 0.",
    "start": "894760",
    "end": "900029"
  },
  {
    "start": "900030",
    "end": "908940"
  },
  {
    "text": "OK. And what is that? That's obvious. This is exactly the case\nof, I'm going to use u",
    "start": "908940",
    "end": "915540"
  },
  {
    "start": "910000",
    "end": "1025000"
  },
  {
    "text": "to add damping to my system. I'm going to add some\nnegative damping.",
    "start": "915540",
    "end": "922260"
  },
  {
    "text": "If e is greater than e\ndesired, then this thing",
    "start": "922260",
    "end": "928860"
  },
  {
    "text": "is positive, and the\nwhole thing I'm adding,",
    "start": "928860",
    "end": "934649"
  },
  {
    "text": "I'm going to be adding damping\nto the system to slow down. And if e is less than\ne desired, then I'm",
    "start": "934650",
    "end": "942660"
  },
  {
    "text": "going to put in sort\nof negative damping. I'm going to invert\nthe sign of this",
    "start": "942660",
    "end": "948029"
  },
  {
    "text": "and add energy to the system\nuntil e is up to e desired. And this is going to give me a\nnice first order response in e.",
    "start": "948030",
    "end": "955482"
  },
  {
    "text": "So that should\nreally do the trick. ",
    "start": "955482",
    "end": "968600"
  },
  {
    "text": "And it doesn't take\nmuch looking at this, the proof would be\na little bit harder,",
    "start": "968600",
    "end": "974050"
  },
  {
    "text": "but it doesn't take\nmuch looking at this. If I did have something\nlike bounded torque,",
    "start": "974050",
    "end": "980350"
  },
  {
    "text": "bounded control input-- let's say I saturated u\nat some control limits--",
    "start": "980350",
    "end": "986980"
  },
  {
    "text": "as long as my sign is\ncorrect, I could still add or remove damping,\naccording to the sine of tilde,",
    "start": "986980",
    "end": "995680"
  },
  {
    "text": "and have this result that e\ntilde is going to go to 0. ",
    "start": "995680",
    "end": "1000779"
  },
  {
    "text": "Yeah.  OK.",
    "start": "1000780",
    "end": "1007230"
  },
  {
    "text": "Even with bounded control\ninputs this is an OK. ",
    "start": "1007230",
    "end": "1027010"
  },
  {
    "text": "So what is the resulting\nphase portrait look like?",
    "start": "1027010",
    "end": "1032770"
  },
  {
    "text": "OK so I have here exactly\nwhat we just said.",
    "start": "1032770",
    "end": "1039220"
  },
  {
    "text": "e tilde is energy at the\ncurrent state minus energy at the desired state.",
    "start": "1039220",
    "end": "1044949"
  },
  {
    "text": "Let's just do\nnegative k theta dot times e tilde as my control,\nwith a pretty low k.",
    "start": "1044950",
    "end": "1051820"
  },
  {
    "text": "And I remember what\nI called it here. ",
    "start": "1051820",
    "end": "1068970"
  },
  {
    "text": "That didn't stabilize\nit at the top. And so any small\nintegration errors, or whatever is going to\nkeep me from the top,",
    "start": "1068970",
    "end": "1075370"
  },
  {
    "text": "is going to make me go around. But the phase portrait does\nexactly what we want it to do.",
    "start": "1075370",
    "end": "1080647"
  },
  {
    "text": "This just started from two\ndifferent initial conditions. One, that's the\nsame one I've been using for all the phase plots.",
    "start": "1080647",
    "end": "1085670"
  },
  {
    "text": "One just above the origin there. It adds energy up, goes\nto the homoclinic orbit,",
    "start": "1085670",
    "end": "1091260"
  },
  {
    "text": "just misses the fixed\npoint, goes around again. And then the other one started\nover here with too much energy,",
    "start": "1091260",
    "end": "1097679"
  },
  {
    "text": "and actually slowed down\nto the homoclinic orbit. OK. ",
    "start": "1097680",
    "end": "1104429"
  },
  {
    "text": "Simple. So for the simple pendulum,\nwe could design a nonlinear",
    "start": "1104430",
    "end": "1110429"
  },
  {
    "text": "controller with pretty simple\nreasoning about the energy. And we know it's going to\nget as close to the up right.",
    "start": "1110430",
    "end": "1117810"
  },
  {
    "text": "Does it also work for\nmore complicated systems? What would it do for the\ncart-pole or the acrobat.",
    "start": "1117810",
    "end": "1125789"
  },
  {
    "start": "1125000",
    "end": "1930000"
  },
  {
    "text": "It turns out it's a\npretty general idea. OK. ",
    "start": "1125790",
    "end": "1132375"
  },
  {
    "text": "In fact, let's do the cart-pole,\nbecause the cart-pole actually has the pendulum\ndynamics embedded in it. It just happens to be\ncoupled with the cart.",
    "start": "1132375",
    "end": "1139610"
  },
  {
    "text": "OK. So if we, for instance, use our\npartial feedback linearization",
    "start": "1139610",
    "end": "1146460"
  },
  {
    "text": "trick to decouple\nthose dynamics, then we can really just\nkeep thinking about pendula.",
    "start": "1146460",
    "end": "1152580"
  },
  {
    "text": " OK.",
    "start": "1152580",
    "end": "1157620"
  },
  {
    "text": "So here we go swing-up control-- non-linear swing-up control\nof the cart-pole system.",
    "start": "1157620",
    "end": "1162825"
  },
  {
    "start": "1162825",
    "end": "1192330"
  },
  {
    "text": "So the dynamics\nwere something I was willing to write\non the board once and then set all parameters\neven gravity to one,",
    "start": "1192330",
    "end": "1199760"
  },
  {
    "text": "and got some complaints\nbut kept going.",
    "start": "1199760",
    "end": "1204993"
  },
  {
    "text": "It turns out it would\nhave been actually trivial for me to\ncarry g around. I should have-- next time\nI'll do that next year.",
    "start": "1204993",
    "end": "1210930"
  },
  {
    "text": "So I don't even have to\nwrite that today because we know if we apply a direct--",
    "start": "1210930",
    "end": "1219680"
  },
  {
    "text": "sorry, the collocated PFL, then\nthe result of my little tricks",
    "start": "1219680",
    "end": "1236810"
  },
  {
    "text": "with the equations is\nI can command a force. The collocated means\nI'm going to use",
    "start": "1236810",
    "end": "1243620"
  },
  {
    "text": "the action to\nlinearize the state, with that action associated. So here I'm going to linearize\nthe dynamics of the cart.",
    "start": "1243620",
    "end": "1250040"
  },
  {
    "text": "And the resulting\nsystem was x double dot equals my new control input.",
    "start": "1250040",
    "end": "1255649"
  },
  {
    "text": "I could set that to\nbe whatever I'd like. And what did it\nleave us with? it left us with theta double\ndot doing something",
    "start": "1255650",
    "end": "1261860"
  },
  {
    "text": "a little funny but not too bad. ubar is sort of my\ndesired acceleration here.",
    "start": "1261860",
    "end": "1269659"
  },
  {
    "start": "1269660",
    "end": "1277860"
  },
  {
    "text": "OK so I've got some new,\nalmost, pendulum dynamics here. And I've got obviously\ngot this pendulum.",
    "start": "1277860",
    "end": "1283800"
  },
  {
    "text": "And I've got this\ncart that I can do whatever the heck I want with. Because I've mastered the cart.",
    "start": "1283800",
    "end": "1290370"
  },
  {
    "text": "So here's the idea. Let's make sure\nthat the pendulum gets on the homoclinic\norbit for the pendulum.",
    "start": "1290370",
    "end": "1296160"
  },
  {
    "text": "That'll make sure it gets\nitself up to the top. And if we've done\nthat, then we can just",
    "start": "1296160",
    "end": "1301260"
  },
  {
    "text": "do a little bit of\nextra work to make sure that the car doesn't go crazy. OK. ",
    "start": "1301260",
    "end": "1350203"
  },
  {
    "text": "OK so you guys are actually\ngoing to-- on your problem set if you haven't already-- you're going to do the swing-up\ncontroller for the cart-pole.",
    "start": "1350203",
    "end": "1357690"
  },
  {
    "text": "So I'm going to keep\nwith my all parameters happened to be one\nlingo here, which",
    "start": "1357690",
    "end": "1366090"
  },
  {
    "text": "forces you to handle\nthe terms when you go to do it for the problems set.",
    "start": "1366090",
    "end": "1372690"
  },
  {
    "text": "It's not bad, but it makes\nyou think about it I think. ",
    "start": "1372690",
    "end": "1380460"
  },
  {
    "text": "OK. In my all parameters\nequal 1 land,",
    "start": "1380460",
    "end": "1385850"
  },
  {
    "text": "the energy of the pendulum\nstill it's just 1/2 m l squared.",
    "start": "1385850",
    "end": "1395820"
  },
  {
    "text": "So it's just 1/2\ntheta dot squared minus m g l cosine theta.",
    "start": "1395820",
    "end": "1402080"
  },
  {
    "text": "Just minus cosine theta now. ",
    "start": "1402080",
    "end": "1412680"
  },
  {
    "text": "And e desired is going to be 1.",
    "start": "1412680",
    "end": "1418740"
  },
  {
    "start": "1418740",
    "end": "1427960"
  },
  {
    "text": "e tilde dot, that\ngoing to be theta dot theta double dot minus\ntheta dot sine theta.",
    "start": "1427960",
    "end": "1439250"
  },
  {
    "text": " theta double dot,\nthough, is going",
    "start": "1439250",
    "end": "1444929"
  },
  {
    "text": "to have a little bit different\nform than the simple pendulum. Because it had a few terms\nleft over from the coupling",
    "start": "1444930",
    "end": "1451860"
  },
  {
    "text": "with the cart. Right so if we stick those in\nwe get theta dot negative u",
    "start": "1451860",
    "end": "1460350"
  },
  {
    "text": "c minus s minus theta dot s",
    "start": "1460350",
    "end": "1470637"
  },
  {
    "text": "STUDENT: Is it plus theta\ndot s or minus theta dot s? RUSS TEDRAKE: Good catch. Thank you. ",
    "start": "1470637",
    "end": "1479010"
  },
  {
    "text": "Thank you.  I would have figured\nthat out in a second",
    "start": "1479010",
    "end": "1484740"
  },
  {
    "text": "when they things didn't cancel. Yeah so now this cancels leaving\nnegative ubar cosine theta dot.",
    "start": "1484740",
    "end": "1499230"
  },
  {
    "start": "1499230",
    "end": "1505130"
  },
  {
    "text": "OK. So we've got this slightly\nfunky dynamics for the pendulum,",
    "start": "1505130",
    "end": "1512125"
  },
  {
    "text": "now, because it's been\naugmented by the cart. ",
    "start": "1512125",
    "end": "1517600"
  },
  {
    "text": "But that's not too bad. So what should I do? What controller should I\nrun to regulate this thing",
    "start": "1517600",
    "end": "1523690"
  },
  {
    "text": "to the pendulum's\nhomoclinic orbit? ",
    "start": "1523690",
    "end": "1542350"
  },
  {
    "text": "OK. So what do you want? You want ubar. ",
    "start": "1542350",
    "end": "1558050"
  },
  {
    "text": "It'll give us some constant. If I just make it,\nsay, cosine theta dot.",
    "start": "1558050",
    "end": "1566390"
  },
  {
    "text": "That'll make\neverything positive. There's a lot of ways to do it,\nbut that's a pretty simple one.",
    "start": "1566390",
    "end": "1572270"
  },
  {
    "text": "Yeah and I'll keep\nthat e tilde there so that I regulate to\nthe proper energy, not just to zero energy.",
    "start": "1572270",
    "end": "1577940"
  },
  {
    "text": " And that should do it. So now e tilde dot should be\nnegative k something squared,",
    "start": "1577940",
    "end": "1589100"
  },
  {
    "text": "c theta squared e\ntilde, which means e tilde it's going to go to 0.",
    "start": "1589100",
    "end": "1597110"
  },
  {
    "text": "Which means my\npendulum's is going to get its homoclinic\norbit, and get to its unstable, fixed point.",
    "start": "1597110",
    "end": "1606240"
  },
  {
    "text": "OK. What about the cart? What's the cart going to\nbe doing during all this? ",
    "start": "1606240",
    "end": "1615770"
  },
  {
    "text": "Yeah it's going to be\ngoing back and forth. Well it depends, I\nmean, it could actually wind up or something,\ndepending on the trajectory.",
    "start": "1615770",
    "end": "1621830"
  },
  {
    "start": "1621830",
    "end": "1627210"
  },
  {
    "text": "So for this system we\nactually have a simple--",
    "start": "1627210",
    "end": "1632340"
  },
  {
    "text": "if you know Lyapunov functions-- a simple Lyapunov function you\nconstruct from these energies. They would show that the\npendulum gets to the top.",
    "start": "1632340",
    "end": "1639570"
  },
  {
    "text": "If you want the pendulum and\nthe cart to get to the origin, then we just get\na little sloppy.",
    "start": "1639570",
    "end": "1646049"
  },
  {
    "text": "And we say let's do, not u\nequals k theta e tilde c.",
    "start": "1646050",
    "end": "1658230"
  },
  {
    "text": "We're missing a c. That's the first one. But let's add an extra\nterm in minus k 2,",
    "start": "1658230",
    "end": "1667100"
  },
  {
    "text": "the position of the cart, minus\nk 3, derivative of the cart. ",
    "start": "1667100",
    "end": "1674780"
  },
  {
    "text": "OK. ",
    "start": "1674780",
    "end": "1682410"
  },
  {
    "text": "All right. So sort of a sad fact,\nthat actually doing this is what makes it work.",
    "start": "1682410",
    "end": "1687660"
  },
  {
    "text": "It's trivial that, sort\nof, that it makes it work. Experimentally, you'll\nsee it works just fine. It actually breaks\nall the proofs.",
    "start": "1687660",
    "end": "1693150"
  },
  {
    "text": "There's a proof for a\nset of parameters of k. So someone found like if k\nequals 2 and k 3 equals 3, then",
    "start": "1693150",
    "end": "1702330"
  },
  {
    "text": "I can design Lyapunov function. It's not very satisfying. OK.",
    "start": "1702330",
    "end": "1708422"
  },
  {
    "text": "But let's see how this\nworks in practice.  So you remember your\ncart-pole system now.",
    "start": "1708422",
    "end": "1715530"
  },
  {
    "start": "1715530",
    "end": "1740210"
  },
  {
    "text": "So these controllers were\ndescribed very nicely",
    "start": "1740210",
    "end": "1746480"
  },
  {
    "text": "by Mark Spong in a\npaper in '96 so that's my spot '96 controller.",
    "start": "1746480",
    "end": "1753950"
  },
  {
    "text": "Basically, you can\nsee I just check some distance between\nthe current state",
    "start": "1753950",
    "end": "1764410"
  },
  {
    "text": "and some sort of hand\ndesigned distance space there. I just see how close\nit is to the top.",
    "start": "1764410",
    "end": "1770980"
  },
  {
    "text": "If it's close enough, I do LQR. If it's farther, I'm going to\ndo this energy shaping control.",
    "start": "1770980",
    "end": "1776350"
  },
  {
    "text": " The stuff that I\ncommented out, I'm going to tell you\nabout it later.",
    "start": "1776350",
    "end": "1782265"
  },
  {
    "text": "But it turns out\nthere's actually nice sort of analytical ways\nto get the basin of attraction",
    "start": "1782265",
    "end": "1790150"
  },
  {
    "text": "using some semidefinite\nprogramming. We'll mention that\nlater in the class.",
    "start": "1790150",
    "end": "1795320"
  },
  {
    "text": "So you don't actually\nhave to guess that metric, but to be fair, I\nguess that metric as something that\nis easy to guess.",
    "start": "1795320",
    "end": "1801760"
  },
  {
    "text": "And that's good enough. OK. The LQR we did before, and the\nswing-up is just that simple.",
    "start": "1801760",
    "end": "1811260"
  },
  {
    "text": "It's the pendulum energy. Not the total energy. It's just the energy\nof the pendulum",
    "start": "1811260",
    "end": "1816490"
  },
  {
    "text": "on the system with a PD\ncontroller on the cart",
    "start": "1816490",
    "end": "1821800"
  },
  {
    "text": "and the theta dot\ncosine theta e tilde",
    "start": "1821800",
    "end": "1828990"
  },
  {
    "text": "dot controller on the pendulum. I put a saturation in there so\nit doesn't do crazy torques.",
    "start": "1828990",
    "end": "1834520"
  },
  {
    "text": "Let's see what we get. ",
    "start": "1834520",
    "end": "1853800"
  },
  {
    "text": "Now linear control is easy. OK. And the phase plots\nexactly what you'd expect.",
    "start": "1853800",
    "end": "1859919"
  },
  {
    "text": "It looks like my gains\na little high maybe. But you know it's regulated\nitself pretty quickly out to that high energy orbit.",
    "start": "1859920",
    "end": "1866970"
  },
  {
    "text": "And then it just missed its\nchance in the first one, but by the second\ntime the energy was close enough, turn on the\nbalance controller, grabbed it.",
    "start": "1866970",
    "end": "1875298"
  },
  {
    "text": "And you saw that it actually\ngrabbed it off to the side and then slowly pulled itself\nback towards the center. ",
    "start": "1875298",
    "end": "1885390"
  },
  {
    "text": "Different initial conditions. Yeah, so it works. It works well. It's easy right.",
    "start": "1885390",
    "end": "1890970"
  },
  {
    "text": " OK. The reason I wanted\nto show you this,",
    "start": "1890970",
    "end": "1901279"
  },
  {
    "text": "well first of all, it's cool. It's relevant.",
    "start": "1901280",
    "end": "1906350"
  },
  {
    "text": "But I sort of want to\ngive you a little glimpse into the world of\nnonlinear control.",
    "start": "1906350",
    "end": "1914435"
  },
  {
    "start": "1914435",
    "end": "1919520"
  },
  {
    "text": "What tends to happen,\nif you're trying to come up with clever\nnon-linear control solutions for\nsystems, is you tend",
    "start": "1919520",
    "end": "1925700"
  },
  {
    "text": "to have to examine carefully\nthe equations of motion of your system. And sometimes you end up\nwith these sort of bizarre",
    "start": "1925700",
    "end": "1932690"
  },
  {
    "start": "1930000",
    "end": "2023000"
  },
  {
    "text": "looking feedback laws that work. Because they tend to cancel\nout the terms that you",
    "start": "1932690",
    "end": "1938810"
  },
  {
    "text": "want to cancel out. So you can prove that\nsomething is always monotonically decreasing. Something like the energy\nis always monotonically",
    "start": "1938810",
    "end": "1945679"
  },
  {
    "text": "decreasing or\nsomething like that. That's actually\na pretty typical. That's a pretty representative\ncase of a nonlinear control",
    "start": "1945680",
    "end": "1952790"
  },
  {
    "text": "design. And there's lots of cool\nstuff working in that realm.",
    "start": "1952790",
    "end": "1960530"
  },
  {
    "text": "So typically to prove it\nmore carefully we'd look-- we'd design a Lyapunov function.",
    "start": "1960530",
    "end": "1967067"
  },
  {
    "text": "We're not going to use it\nright now in this class. ",
    "start": "1967067",
    "end": "1974020"
  },
  {
    "text": "But if you haven't\nseen Lyapunov functions it's a good thing to know about. Jean-Jacques Slotine teaches\nhis nonlinear control course",
    "start": "1974020",
    "end": "1981920"
  },
  {
    "text": "in mechanical engineering. He uses Lyapunov functions. But he also uses other\nmetrics to prove stability.",
    "start": "1981920",
    "end": "1988850"
  },
  {
    "text": "His favorite, I think, right\nnow is contraction analysis. ",
    "start": "1988850",
    "end": "1999550"
  },
  {
    "text": "OK.  It's worth listing those\ntwo because there's actually not a lot--",
    "start": "1999550",
    "end": "2005169"
  },
  {
    "text": "that's not really\na very long list-- there's not actually a lot more\ndifferent solution techniques",
    "start": "2005170",
    "end": "2010180"
  },
  {
    "text": "that I can put up here. There's actually only\nsort of a handful of ways people have\nto prove stability",
    "start": "2010180",
    "end": "2016700"
  },
  {
    "text": "in non-linear systems,\ncontinuous systems. OK. ",
    "start": "2016700",
    "end": "2024210"
  },
  {
    "start": "2023000",
    "end": "3599000"
  },
  {
    "text": "So that's sort of approach one. Approach two, which we're\ngoing to do in this course,",
    "start": "2024210",
    "end": "2030700"
  },
  {
    "text": "is let's not design\nspecific controllers for specific systems.",
    "start": "2030700",
    "end": "2036770"
  },
  {
    "text": "Let's turn it into an\noptimization problem and use our optimal control. OK.",
    "start": "2036770",
    "end": "2042780"
  },
  {
    "text": "Good. So we know how to do\nthe swing-up control of the cart-pole.",
    "start": "2042780",
    "end": "2047940"
  },
  {
    "text": "It's pretty simple based\non an energy argument.",
    "start": "2047940",
    "end": "2054270"
  },
  {
    "text": "What would happen if\nI didn't use the PFL? I used the PFL here to make\nthings analytically cleaner.",
    "start": "2054270",
    "end": "2060870"
  },
  {
    "text": "But essentially what it's\ndoing is the same thing as the simple pendulum. As it said, if the pendulum\nis moving this way,",
    "start": "2060870",
    "end": "2067949"
  },
  {
    "text": "I want to add energy. Then just push it in that way. If it's derivative's this\nway, then push it in that way.",
    "start": "2067949",
    "end": "2074100"
  },
  {
    "text": "There's a cosine\nwhich modifies things. Just because of the\ncoupling really I think.",
    "start": "2074100",
    "end": "2080940"
  },
  {
    "text": "Maybe the cosine's real. When you change signs\nyou actually-- when you cross the\norigin you actually have to go the opposite way.",
    "start": "2080940",
    "end": "2086546"
  },
  {
    "text": "Maybe the cosine's\nreal actually. But it's basically just\ndoing the same thing",
    "start": "2086547",
    "end": "2092669"
  },
  {
    "text": "we did-- had our intuition\nfor in the pendulum, which is push the system the\nway it's already going. ",
    "start": "2092670",
    "end": "2101070"
  },
  {
    "text": "So it turns out you can do\nthe same thing without PFL",
    "start": "2101070",
    "end": "2108450"
  },
  {
    "text": "and it probably works. To be fair, I even\nspent a minute finding different parameters.",
    "start": "2108450",
    "end": "2114603"
  },
  {
    "text": "I could've made a really\ncompelling demo using the same parameters from\nPFL which worked horribly for the other system.",
    "start": "2114603",
    "end": "2120480"
  },
  {
    "text": "But I actually found\nsome good parameters and if I do that one,\nit still gets there.",
    "start": "2120480",
    "end": "2131490"
  },
  {
    "text": "It's not going to\nbe quite as pretty. That was actually probably\nthe worst I've seen. ",
    "start": "2131490",
    "end": "2138090"
  },
  {
    "text": "Thank you. OK but it'll still work. The PFL, though, made the motion\nof that card pretty beautiful,",
    "start": "2138090",
    "end": "2145770"
  },
  {
    "text": "if you care about that. And it made the math easy\nenough that we can really derive these things. OK.",
    "start": "2145770",
    "end": "2151440"
  },
  {
    "text": "So PFL really turns out\nto be an important tool in these systems. ",
    "start": "2151440",
    "end": "2159720"
  },
  {
    "text": "Yeah, I just said basically,\nlet's put in this controller.",
    "start": "2159720",
    "end": "2165168"
  },
  {
    "text": "Forget about the-- actually\nI did the whole controller, I think. I can look. And instead of\nputting it into ubar,",
    "start": "2165168",
    "end": "2170550"
  },
  {
    "text": "which was my synthetic\ncommand through my PFL, let's just make that\nthe force on the cart.",
    "start": "2170550",
    "end": "2177690"
  },
  {
    "text": "Let's use this basic\nfeedback law as the force",
    "start": "2177690",
    "end": "2183630"
  },
  {
    "text": "directly on the cart. And forget about linearizing\nthe cart dynamics. Yeah, because the\nintuition is right.",
    "start": "2183630",
    "end": "2189330"
  },
  {
    "text": "It's just pushed that\nway to add energy. And if I add energy. I should get up near the top. And if it does work.",
    "start": "2189330",
    "end": "2195652"
  },
  {
    "text": "And the PFL just\nmakes it cleaner.  OK.",
    "start": "2195653",
    "end": "2201300"
  },
  {
    "text": "What about the acrobat? I don't spend a lot of time\nbecause it's pretty similar. What would you do\nfor the acrobat?",
    "start": "2201300",
    "end": "2206377"
  },
  {
    "start": "2206377",
    "end": "2211770"
  },
  {
    "text": "If you want to get the acrobat\nto balance, just add energy. And get itself towards the top.",
    "start": "2211770",
    "end": "2217750"
  },
  {
    "text": "It's funny. Zach, in our group, he\ntook the class last year.",
    "start": "2217750",
    "end": "2223200"
  },
  {
    "text": "He's building our\ncool acrobat now. He's the one you saw\nhim hold up the poster.",
    "start": "2223200",
    "end": "2228750"
  },
  {
    "text": "But for his first\nreaction, which I think he did on the\nreal hardware, was just do a stabilizing\ncontroller at the bottom.",
    "start": "2228750",
    "end": "2235109"
  },
  {
    "text": "And then flip the gains. So it just went kind of crazy. And I think that sort\nof worked, which is--",
    "start": "2235110",
    "end": "2240550"
  },
  {
    "text": "doesn't say a lot about\nhow hard the problem is. But there's a more\nelegant way to do it.",
    "start": "2240550",
    "end": "2245990"
  },
  {
    "text": "OK.  How would you do it? Given this sort of\nline of thinking.",
    "start": "2245990",
    "end": "2252810"
  },
  {
    "text": "We've got PFL at our disposal. We want to add energy. What would you do? ",
    "start": "2252810",
    "end": "2265240"
  },
  {
    "text": "Yeah? ",
    "start": "2265240",
    "end": "2274570"
  },
  {
    "text": "No, but you're close. Well so collocated would get-- it controls the elbow, because\nthe motors at the elbow.",
    "start": "2274570",
    "end": "2280859"
  },
  {
    "text": "Yeah.  So if you use collocated\nand you could still solve--",
    "start": "2280860",
    "end": "2287970"
  },
  {
    "text": "add energy into the first\nlink so that it swings up like a pendulum. That's the same way we\nsort of add an extra term",
    "start": "2287970",
    "end": "2294660"
  },
  {
    "text": "to keep the cart. Near zero we add an extra term\nto keep the second joint close to zero.",
    "start": "2294660",
    "end": "2299780"
  },
  {
    "text": "That's exactly what it is. OK. So I'll just write it quickly\nbecause it's that simple.",
    "start": "2299780",
    "end": "2304920"
  },
  {
    "start": "2304920",
    "end": "2342130"
  },
  {
    "text": "We're going to use\ncollocated PFL to control",
    "start": "2342130",
    "end": "2352349"
  },
  {
    "text": "theta two and energy shaping\nto drive theta 1 to up right.",
    "start": "2352350",
    "end": "2369590"
  },
  {
    "start": "2369590",
    "end": "2380990"
  },
  {
    "text": "So it turns out-- how do you add energy\nin the acrobat? if you want to add energy to\nthe theta 1, whatever direction",
    "start": "2380990",
    "end": "2390410"
  },
  {
    "text": "that one's moving,\nmake the theta 2 move in that direction too. OK.",
    "start": "2390410",
    "end": "2396290"
  },
  {
    "text": "So u bar, the command\nto your PFL controller",
    "start": "2396290",
    "end": "2402140"
  },
  {
    "text": "should be q 1 dot e\ntilde, k greater than 0",
    "start": "2402140",
    "end": "2413422"
  },
  {
    "text": "It works out to be that simple. And we're going to,\nin general, we'll add another something\nto make sure",
    "start": "2413422",
    "end": "2420510"
  },
  {
    "text": "that theta 2 doesn't deviate\ntoo far from where it went,",
    "start": "2420510",
    "end": "2425600"
  },
  {
    "text": "from straight out. ",
    "start": "2425600",
    "end": "2432700"
  },
  {
    "text": "Interestingly, the\nenergy that people use-- that Spong uses in\nhis paper is not",
    "start": "2432700",
    "end": "2438940"
  },
  {
    "text": "the energy sort of the simple\npendulum created by link one. It's actually the total\nenergy of the system",
    "start": "2438940",
    "end": "2445869"
  },
  {
    "text": "and that still works. ",
    "start": "2445870",
    "end": "2466546"
  },
  {
    "text": "STUDENT: You couldn't use the\ntotal energy of the cart-pole to try and invert that pendulum?",
    "start": "2466546",
    "end": "2472674"
  },
  {
    "text": " RUSS TEDRAKE: My guess\nis it would still work,",
    "start": "2472674",
    "end": "2479420"
  },
  {
    "text": "but the proof is based\non-- on not that. ",
    "start": "2479420",
    "end": "2494390"
  },
  {
    "text": "So I should say there is\nno proof, for the acrobat,",
    "start": "2494390",
    "end": "2499539"
  },
  {
    "text": "that it will get to the\ntop, that I know of. Spong's paper in\n'96, beautiful paper,",
    "start": "2499540",
    "end": "2506110"
  },
  {
    "text": "says, we conjecture that you\ncan show that this thing is",
    "start": "2506110",
    "end": "2511120"
  },
  {
    "text": "semiglobal stable. The other thing I didn't say\nis that this thing actually doesn't work if\nyou started at 0 0.",
    "start": "2511120",
    "end": "2520480"
  },
  {
    "text": "Because if theta\ndot zero, you're not going to actually do anything.",
    "start": "2520480",
    "end": "2526570"
  },
  {
    "text": "So it's not globally stable. It's semiglobally, so we\nneed to knock a little bit. Have Zach pull with the\nstring across through.",
    "start": "2526570",
    "end": "2533510"
  },
  {
    "text": " But they conjecture\nthat it's semiglobal,",
    "start": "2533510",
    "end": "2540050"
  },
  {
    "text": "despite the fact\nthat the energy-- that there might be\nmultiple solutions. The picture of the\nhomoclinic orbit, I'll admit,",
    "start": "2540050",
    "end": "2545660"
  },
  {
    "text": "is not as clean for the acrobat. ",
    "start": "2545660",
    "end": "2550700"
  },
  {
    "text": "But I think the intuition is\nthat if you're doing some work to keep theta 2\nnear zero, then it's",
    "start": "2550700",
    "end": "2563510"
  },
  {
    "text": "looking-- it's moving\na lot like a pendulum, and you're thinking about\nthe homoclinic orbit",
    "start": "2563510",
    "end": "2568820"
  },
  {
    "text": "of that big pendulum. And it gets up there. I think these terms\nprevent it from sort",
    "start": "2568820",
    "end": "2577280"
  },
  {
    "text": "of being in this lots of\ndifferent configurations to get to the top. ",
    "start": "2577280",
    "end": "2584300"
  },
  {
    "text": "But presumably the proof of\nsemiglobal, semiglobality, I guess, would be dependent\non kl and k2 or k2 and k3.",
    "start": "2584300",
    "end": "2592800"
  },
  {
    "text": "Good. ",
    "start": "2592800",
    "end": "2599255"
  },
  {
    "text": "People don't seem jumping out of\nyour chair excited about that, but I hope you like it\nand get it and get it.",
    "start": "2599255",
    "end": "2606789"
  },
  {
    "text": "It's an important\nclass of derivations. ",
    "start": "2606790",
    "end": "2615470"
  },
  {
    "text": "All right so in that trend. So we used PFL, now, to do--",
    "start": "2615470",
    "end": "2622040"
  },
  {
    "text": "to basically make energy\nshaping arguments simple. And to actually even\nsimplify the analytics",
    "start": "2622040",
    "end": "2627650"
  },
  {
    "text": "of those arguments. But actually PFL can\ndo a lot of things.",
    "start": "2627650",
    "end": "2632750"
  },
  {
    "text": "Disclaimer, PFL is bad. Don't use it if you care\nabout system dynamics,",
    "start": "2632750",
    "end": "2638090"
  },
  {
    "text": "but it'll do a lot\nof things for you. So let's just see\nhow much it can do.",
    "start": "2638090",
    "end": "2643400"
  },
  {
    "text": "I want to show you the slightly\nmore general form, which is not, surprisingly, is not\nas common in the literature",
    "start": "2643400",
    "end": "2675869"
  },
  {
    "text": "And just one general\nform, I guess, but this is using the\nnotion of a task space.",
    "start": "2675870",
    "end": "2682580"
  },
  {
    "text": " OK.",
    "start": "2682580",
    "end": "2688020"
  },
  {
    "text": "So last time, last\ntime we talked about using partial\nfeedback linearization",
    "start": "2688020",
    "end": "2694530"
  },
  {
    "text": "to control all of your\nactuated joints perfectly, or to control all of your\nunsaturated joints perfectly.",
    "start": "2694530",
    "end": "2700890"
  },
  {
    "text": "But naturally you'd\nlike to see a form where you could control\none unactuated joint, one",
    "start": "2700890",
    "end": "2706230"
  },
  {
    "text": "actuated joint. Maybe you don't\nactually even care about controlling a\nparticular actuators. Maybe what you care\nabout is, let's say,",
    "start": "2706230",
    "end": "2712260"
  },
  {
    "text": "controlling the end\neffector of your machine. So let's say I'm 120\ndegree of freedom robot",
    "start": "2712260",
    "end": "2718680"
  },
  {
    "text": "with a few unactuate joints. I'm not actually\nbolted to the ground. Maybe my shoulder\ndoesn't work today.",
    "start": "2718680",
    "end": "2724240"
  },
  {
    "text": "And I want to control the\nendpoint of my arm right.",
    "start": "2724240",
    "end": "2729810"
  },
  {
    "text": "We should be able\nto do that I think. And, intuitively, as\nlong as my task space",
    "start": "2729810",
    "end": "2738150"
  },
  {
    "text": "is coupled to my motors. I can have sort of 10\nactuators on this robot and try to control the\nparts of joint over there.",
    "start": "2738150",
    "end": "2745200"
  },
  {
    "text": "As long as they're coupled with\nthis inertial coupling idea. And I have sort\nof enough motors,",
    "start": "2745200",
    "end": "2750780"
  },
  {
    "text": "as many motors as I\nhave degrees of freedom of the thing I'm\ntrying to control, you'd like to think\nthat would work. ",
    "start": "2750780",
    "end": "2757740"
  },
  {
    "text": "So for the cart-pole, let's\nsay, I'd like to think I could regulate-- I can't regulate the\nendpoint of the pole",
    "start": "2757740",
    "end": "2764220"
  },
  {
    "text": "perfectly, because\nthat would be x and y. It would be the two variables\nand I've only got one motor,",
    "start": "2764220",
    "end": "2769859"
  },
  {
    "text": "but maybe I should\nbe able to regulate the y position of the endpoint. ",
    "start": "2769860",
    "end": "2776320"
  },
  {
    "text": "On the acrobat, I should\nbe able to regulate the y position of the end effector.",
    "start": "2776320",
    "end": "2782619"
  },
  {
    "text": "Or, in little dog, the\nrobot I showed you, we do regulate\nthe center of mass",
    "start": "2782620",
    "end": "2788920"
  },
  {
    "text": "of the robot using all the\ninternal joints on the machine. So let's see the slightly\nmore general form.",
    "start": "2788920",
    "end": "2796400"
  },
  {
    "text": "And then put it to use. ",
    "start": "2796400",
    "end": "2806850"
  },
  {
    "text": "OK. I'm still going to\nmake the assumption that we have joined with zero\ntorque and joints with torque.",
    "start": "2806850",
    "end": "2816600"
  },
  {
    "text": "So I can use this form. I'm sure you can\ngeneralize it further. But excuse me.",
    "start": "2816600",
    "end": "2828019"
  },
  {
    "start": "2828020",
    "end": "2850240"
  },
  {
    "text": "OK where I'm using q1 here to\nrepresent my passive joints. ",
    "start": "2850240",
    "end": "2859180"
  },
  {
    "text": "And let's say that\nthere are m of them",
    "start": "2859180",
    "end": "2865930"
  },
  {
    "text": "and q2 to represent\nmy active joints, my actuator Let's say\nthere are l of them.",
    "start": "2865930",
    "end": "2877220"
  },
  {
    "text": "And let's say the q, m, n. ",
    "start": "2877220",
    "end": "2888279"
  },
  {
    "text": "So that's my equations of\nmotion of the system I'm working on factored into\nblock matrix form based",
    "start": "2888280",
    "end": "2897640"
  },
  {
    "text": "on where the actuators are. ",
    "start": "2897640",
    "end": "2912990"
  },
  {
    "text": "So let's try to\ncontrol some subset of the actuated and\nunactuated joints.",
    "start": "2912990",
    "end": "2921150"
  },
  {
    "text": "And in general we'll do that by\ndefining some output function. ",
    "start": "2921150",
    "end": "2934200"
  },
  {
    "text": "Some function of\njust the full vector q, but we're not\nof q dot for now.",
    "start": "2934200",
    "end": "2939660"
  },
  {
    "start": "2939660",
    "end": "2945140"
  },
  {
    "text": "And let's say y lives\nin p dimensional space.",
    "start": "2945140",
    "end": "2952910"
  },
  {
    "text": "Just running out\nof letters here. OK. ",
    "start": "2952910",
    "end": "2961022"
  },
  {
    "text": "Let me tell you the answer\nfirst and then we'll make sure it works. So let's define j1 to be partial\nf partial q1, j2 to be partial",
    "start": "2961022",
    "end": "2979120"
  },
  {
    "text": "f partial q2. And j is the full thing.",
    "start": "2979120",
    "end": "2987120"
  },
  {
    "start": "2987120",
    "end": "2996750"
  },
  {
    "text": "So j1 is going to\nbe what, p by m.",
    "start": "2996750",
    "end": "3006890"
  },
  {
    "text": "And j2 is going to be p by l.",
    "start": "3006890",
    "end": "3013099"
  },
  {
    "text": "And j is going to be p by n. ",
    "start": "3013100",
    "end": "3027430"
  },
  {
    "text": "My claim is if you command the\nactuated joints to do this.",
    "start": "3027430",
    "end": "3035260"
  },
  {
    "start": "3035260",
    "end": "3092600"
  },
  {
    "text": "OK. It's a little bit of\na big pill to swallow, but I'm using this to represent\nthe right Moore-Penrose",
    "start": "3092600",
    "end": "3107260"
  },
  {
    "text": "pseudoinverse in general.",
    "start": "3107260",
    "end": "3118910"
  },
  {
    "text": "OK. And there's nothing\ntoo egregious just yet. We've got h11 is\ninvertible, we said.",
    "start": "3118910",
    "end": "3125660"
  },
  {
    "text": " So that sort of looks OK. ",
    "start": "3125660",
    "end": "3132619"
  },
  {
    "text": "We're going to have to ask\nhow invertible j bar is. It's got a j2 in there.",
    "start": "3132620",
    "end": "3138670"
  },
  {
    "text": "j2 is not square. So we're going to have to\nthink about that a little bit. That's why I have to use\nthe pseudoinverse here.",
    "start": "3138670",
    "end": "3146060"
  },
  {
    "text": " Good. So let's see if we believe that.",
    "start": "3146060",
    "end": "3153920"
  },
  {
    "text": "Oh boy.",
    "start": "3153920",
    "end": "3159470"
  },
  {
    "text": "This is subject to the\nrank of j bar equaling p.",
    "start": "3159470",
    "end": "3170748"
  },
  {
    "text": "And I don't want to write\nthat on the next board. That's got to go there. ",
    "start": "3170748",
    "end": "3186410"
  },
  {
    "text": "OK. So let's just think about\nthe dimensionality here. So j2 is p by l.",
    "start": "3186410",
    "end": "3192760"
  },
  {
    "text": "So a number of things\nI'm trying to control by the number of things\nI have to control them. ",
    "start": "3192760",
    "end": "3200500"
  },
  {
    "text": "j1, p by m, this one's\ngoing to be m by m. This is going to be m by l.",
    "start": "3200500",
    "end": "3206942"
  },
  {
    "text": "So this thing is\ngoing to work out to be p by l, as we expected.",
    "start": "3206943",
    "end": "3212900"
  },
  {
    "text": "So I'm saying that I'm going\nto write j pseudo inverse",
    "start": "3212900",
    "end": "3219099"
  },
  {
    "text": "because it's not square. But I only really want\nto run this controller if the rank of\njbar is equal to p.",
    "start": "3219100",
    "end": "3228730"
  },
  {
    "text": "It's not going to be\ngreater than p ever. Because the matrix\nhas only got p rows.",
    "start": "3228730",
    "end": "3236283"
  },
  {
    "text": "So the trivial\ncondition is I need to have at least\nas many actuators as I have things I'm\ntrying to control.",
    "start": "3236283",
    "end": "3243039"
  },
  {
    "text": "If l is at least p, that's\na necessary condition. I'm not going to get the if--",
    "start": "3243040",
    "end": "3249211"
  },
  {
    "text": "if I have less actuators than\nwhat I'm trying to control, this rank condition\nwill always fail.",
    "start": "3249211",
    "end": "3255309"
  },
  {
    "text": "If I have four actuators and two\nthings I'm trying to control, but three of the actuators\nare on a different robot,",
    "start": "3255310",
    "end": "3261430"
  },
  {
    "text": "then it's also going to fail. So it's not only the case\nthat the counting game works.",
    "start": "3261430",
    "end": "3268075"
  },
  {
    "text": " But if l is greater than p--",
    "start": "3268075",
    "end": "3273466"
  },
  {
    "text": "I'm sorry to be throwing\naround all these things-- if you have more\nactuators than things you're trying to\ncontrol, then you",
    "start": "3273467",
    "end": "3278890"
  },
  {
    "text": "should go ahead and\nuse that pseudoinverse because you have choices. At any given time, if\nyou want to produce",
    "start": "3278890",
    "end": "3284740"
  },
  {
    "text": "a certain acceleration\nin your output space, whether it's the end\neffect or whatever. There are actually\nthere's a manifold",
    "start": "3284740",
    "end": "3290422"
  },
  {
    "text": "of solutions you can\nuse to try to produce that same acceleration\nof the output.",
    "start": "3290422",
    "end": "3296569"
  },
  {
    "text": "So for those of you that\nhave used sort of Jacobians and null spaces a lot in the\nprevious robotics course,",
    "start": "3296570",
    "end": "3301994"
  },
  {
    "text": "this is perfectly\ncompatible then with sort of a null\nspace decomposition. If you wanted to say I\nhave a first priority",
    "start": "3301995",
    "end": "3309309"
  },
  {
    "text": "task in this joyed space, and\nthen a second priority task that works on the null\nspace of that controller,",
    "start": "3309310",
    "end": "3316780"
  },
  {
    "text": "that stuff all works\nin this framework. But I won't go into\nthe details there. OK so j pseudoinverse\ncould have a null space",
    "start": "3316780",
    "end": "3327549"
  },
  {
    "text": "if you have more\nactuators than things you're trying to control. ",
    "start": "3327550",
    "end": "3336760"
  },
  {
    "text": "So we quickly make sure\nwe think that works",
    "start": "3336760",
    "end": "3352072"
  },
  {
    "text": "So what do we do? We started with y is f of q.",
    "start": "3352072",
    "end": "3357790"
  },
  {
    "text": "So we want to know how that\nthing's going to change. That's going to be j of q dot.",
    "start": "3357790",
    "end": "3365225"
  },
  {
    "start": "3365225",
    "end": "3374620"
  },
  {
    "text": "And y double dot is going\nto be jdot qdot plus j,",
    "start": "3374620",
    "end": "3383590"
  },
  {
    "text": "because remember j is partial\nf partial q right, plus jq double dot, which I'm going to\nbreak apart into j1 q1 double",
    "start": "3383590",
    "end": "3396940"
  },
  {
    "text": "dot plus j2 q2 double dot. ",
    "start": "3396940",
    "end": "3406060"
  },
  {
    "text": "So I've got some\ncontribution from the effects",
    "start": "3406060",
    "end": "3411100"
  },
  {
    "text": "of my passive joint. Some from the active joints. ",
    "start": "3411100",
    "end": "3417610"
  },
  {
    "text": "We can use this\nfirst equation here to figure out what\nthe accelerations",
    "start": "3417610",
    "end": "3425020"
  },
  {
    "text": "of my passive joints\nare going to be with respect to\nthe accelerations of my active joints.",
    "start": "3425020",
    "end": "3430990"
  },
  {
    "text": "The same thing we did before. So I can easily write down here\nthat q1 double dot had better",
    "start": "3430990",
    "end": "3438279"
  },
  {
    "text": "be negative h11 inverse,\nh12 q2 double dot plus phi1.",
    "start": "3438280",
    "end": "3453140"
  },
  {
    "start": "3453140",
    "end": "3478680"
  },
  {
    "text": "If you stick that in, then\nyou end up with y double dot is jdot qdot minus\nj1 h11 inverse",
    "start": "3478680",
    "end": "3494280"
  },
  {
    "text": "h12 q2 double dot plus phi1.",
    "start": "3494280",
    "end": "3501720"
  },
  {
    "text": "I would write this down if\nit's in your notes here,",
    "start": "3501720",
    "end": "3509230"
  },
  {
    "text": "which happens to be jdot\nqdot plus jbar q2 double dot",
    "start": "3509230",
    "end": "3516630"
  },
  {
    "text": "minus j1 h11 inverse phi1.",
    "start": "3516630",
    "end": "3523230"
  },
  {
    "text": "Therefore, If I can invert jbar\nthen, where'd my control go.",
    "start": "3523230",
    "end": "3531750"
  },
  {
    "text": "If you read it off,\njbar inverse is",
    "start": "3531750",
    "end": "3536970"
  },
  {
    "text": "going to cancel out that term. I'm going to subtract\noff the jdot qdot,",
    "start": "3536970",
    "end": "3542130"
  },
  {
    "text": "and add back in the\nj1 h inverse phi1. And I'm going to be left with\ny double dot equals v. So",
    "start": "3542130",
    "end": "3554640"
  },
  {
    "text": "that works. That's not too shocking. What's cool is that this task\nspace PFL is sort of all,",
    "start": "3554640",
    "end": "3563980"
  },
  {
    "text": "you need to know. if you're willing to\nremember this one, then the collocated and the non\ncollocated come out for free.",
    "start": "3563980",
    "end": "3574349"
  },
  {
    "text": "So if I were to choose\nand do the collocated,",
    "start": "3574350",
    "end": "3585930"
  },
  {
    "text": "then that means\nmy output function is this, which one, just\nq2 which means the partial",
    "start": "3585930",
    "end": "3598220"
  },
  {
    "text": "with respect to q1 is 0. The partial with\nrespect to q2 is just i.",
    "start": "3598220",
    "end": "3604670"
  },
  {
    "text": " jdot is 0. ",
    "start": "3604670",
    "end": "3612670"
  },
  {
    "text": "jbar works out to be\ni if you look at It.",
    "start": "3612670",
    "end": "3619369"
  },
  {
    "text": "Long story short,\neverything drops out. You get exactly the\ncollocated feedback that you wanted before.",
    "start": "3619370",
    "end": "3626970"
  },
  {
    "text": "What's even cooler\nis the non-collocated does the exact same thing.",
    "start": "3626970",
    "end": "3633210"
  },
  {
    "text": "The non-collocated,\nif you make y equal q1 and you put it through\nthis task space PFL,",
    "start": "3633210",
    "end": "3641078"
  },
  {
    "text": "not only do you get\nthe same controller out that you would have gotten,\nbut this rank condition on jbar",
    "start": "3641078",
    "end": "3649050"
  },
  {
    "text": "for the collocated case,\nit's trivially true, which you'd expect. And for the\nnon-collocated case it turns exactly into the strong\ninertial coupling condition",
    "start": "3649050",
    "end": "3657000"
  },
  {
    "text": "of the other derivation. ",
    "start": "3657000",
    "end": "3662109"
  },
  {
    "text": "OK. So now we can do\nsomething interesting. I'm sorry to write\nso many symbols,",
    "start": "3662110",
    "end": "3667470"
  },
  {
    "text": "but, because you're\nall falling asleep. Let's do something\ninteresting with it. OK.",
    "start": "3667470",
    "end": "3672740"
  },
  {
    "text": "So let's do the example I said.",
    "start": "3672740",
    "end": "3678030"
  },
  {
    "text": "Let's take the\ncart-pole and make it go through some y trajectory,\na sine wave or something like.",
    "start": "3678030",
    "end": "3686430"
  },
  {
    "text": "What would it take to\nmake the cart-pole go like this for a long time?",
    "start": "3686430",
    "end": "3692180"
  },
  {
    "text": " Speeding up and slowing down,\nbut always actually moving",
    "start": "3692180",
    "end": "3698420"
  },
  {
    "text": "in one direction. So my information is not\ngoing to be too pretty. I tried to come up with a\nreally clever task space,",
    "start": "3698420",
    "end": "3704130"
  },
  {
    "text": "five minutes before class,\nthat would stay on the screen and regulate the output.",
    "start": "3704130",
    "end": "3710580"
  },
  {
    "text": "I'm going to show you that\nleaves the screen quickly, but at least plot that\nit found the output. ",
    "start": "3710580",
    "end": "3724039"
  },
  {
    "text": "OK. So if I make y equal,\nthis y, poor choice,",
    "start": "3724040",
    "end": "3729580"
  },
  {
    "text": "is just the vertical\nposition of the end point through the kinematics\nof the cart-pole.",
    "start": "3729580",
    "end": "3736120"
  },
  {
    "start": "3736120",
    "end": "3750250"
  },
  {
    "text": "Then, you could see it here. So why is just negative\nl cosine of the x2.",
    "start": "3750250",
    "end": "3760210"
  },
  {
    "text": "I think this is my y desired\nis this y underscore. d",
    "start": "3760210",
    "end": "3765680"
  },
  {
    "text": "Is my shorthand for desired. It's just some sine wave\nthat's going to go between 1/4",
    "start": "3765680",
    "end": "3773980"
  },
  {
    "text": "of the length and 1/2\nthe length, or sorry 3/4 of the length. It would be unfortunate if\nI asked it to go somewhere.",
    "start": "3773980",
    "end": "3780427"
  },
  {
    "text": "It couldn't go because\nthings would blow up. My rank condition would\nstop being satisfied, but it's nice that it would at\nleast alert me to that fact.",
    "start": "3780427",
    "end": "3787060"
  },
  {
    "text": "OK. I put those exact\nequations I just showed you",
    "start": "3787060",
    "end": "3792130"
  },
  {
    "text": "in a few lines of MATLAB. And I called it task space.",
    "start": "3792130",
    "end": "3808400"
  },
  {
    "text": " There it goes, but\nafter 10 seconds",
    "start": "3808400",
    "end": "3818690"
  },
  {
    "text": "and it's quite far away from\nanything we're going to see. I can show you that a regulator\nthat operate beautifully.",
    "start": "3818690",
    "end": "3824250"
  },
  {
    "text": "OK",
    "start": "3824250",
    "end": "3830390"
  },
  {
    "text": "If you want to see a little\nbit more of it, I can zoom out.",
    "start": "3830390",
    "end": "3837019"
  },
  {
    "text": "So it's really gone. OK.",
    "start": "3837020",
    "end": "3842150"
  },
  {
    "text": "But again the output\nregulated beautifully.",
    "start": "3842150",
    "end": "3848029"
  },
  {
    "text": "OK. So in retrospect the cart-pole\nmight not have been the way to show you the power of\npartial feedback linearization,",
    "start": "3848030",
    "end": "3856847"
  },
  {
    "text": "except for the fact that-- I mean if you really did care. Maybe you're a cart-pole\nbartender or something.",
    "start": "3856847",
    "end": "3862319"
  },
  {
    "text": "You have to really keep\nsome things steady. But, maybe, that's\nI guess it's still",
    "start": "3862320",
    "end": "3867740"
  },
  {
    "text": "bad to drive away to infinity. Where you going? ",
    "start": "3867740",
    "end": "3875960"
  },
  {
    "text": "OK. So little dog is a good example,\nwhere we could nicely regulate",
    "start": "3875960",
    "end": "3881750"
  },
  {
    "text": "the center of mass of the dog. And have it tip up and act\nlike a simple pendulum, even though it had lots\nand lots of joints,",
    "start": "3881750",
    "end": "3888110"
  },
  {
    "text": "and a passive joint\nin the middle. OK so task space are actually\na pretty fundamental concept",
    "start": "3888110",
    "end": "3893540"
  },
  {
    "text": "in robotics. And they haven't seen\nthem use that much in underactuated\nrobotics, but they work just fine if you're\ngoing to use partial feedback",
    "start": "3893540",
    "end": "3901760"
  },
  {
    "text": "linearization, which is bad. OK. ",
    "start": "3901760",
    "end": "3906859"
  },
  {
    "text": "Good. Well I was hoping to have\nan acrobat demo today, but Zach tells me were going\nto do it on Tuesday instead. And we're going to use it\nin the future throughout.",
    "start": "3906860",
    "end": "3914292"
  },
  {
    "text": "So it's the same way I\ngo back to the pendulum, we're going to go back and show\nhow the better algorithms work on the acrobat and\nthings like that.",
    "start": "3914292",
    "end": "3920790"
  },
  {
    "text": "So you will see hardware\nagain very soon. But not today.",
    "start": "3920790",
    "end": "3924940"
  }
]