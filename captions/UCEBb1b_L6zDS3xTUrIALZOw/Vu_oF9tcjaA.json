[
  {
    "text": " The following content is\nprovided under a Creative Commons license.",
    "start": "0",
    "end": "5300"
  },
  {
    "text": "Your support will help\nMIT OpenCourseWare continue to offer high-quality\neducational resources for free.",
    "start": "5300",
    "end": "11600"
  },
  {
    "text": "To make a donation, or to\nview additional materials from hundreds of MIT courses,\nvisit MIT OpenCourseWare",
    "start": "11600",
    "end": "18100"
  },
  {
    "text": "at ocw.mit.edu. ",
    "start": "18100",
    "end": "23180"
  },
  {
    "text": "OK, we're moving on. No more linear algebra. We're going to try solving\nsome more difficult problems--",
    "start": "23180",
    "end": "29980"
  },
  {
    "text": "of course, all those\nproblems will just be turned into linear\nalgebra as we move on, so your expertise now\nwith different techniques",
    "start": "29980",
    "end": "37750"
  },
  {
    "text": "from linear algebra is\ngoing to come in handy. The next section of\nthis course, we're talking about systems\nof nonlinear equations,",
    "start": "37750",
    "end": "45320"
  },
  {
    "text": "and we'll transition into\nproblems in optimization-- which, turns out, look a lot\nlike systems of nonlinear",
    "start": "45320",
    "end": "50860"
  },
  {
    "text": "equations, as well. And we'll try to\nleverage what we learn in the next few lectures\nto solve different optimization",
    "start": "50860",
    "end": "56541"
  },
  {
    "text": "problems.  Before going on, I\njust want to recap. All right, last time we\ntalked about singular value",
    "start": "56541",
    "end": "63165"
  },
  {
    "text": "decomposition-- which is like\nan eigenvalue decomposition for any matrix.",
    "start": "63165",
    "end": "69540"
  },
  {
    "text": "And associated with that\nmatrix are singular vectors, left and right singular vectors. And the singular\nvalues of that matrix.",
    "start": "69540",
    "end": "77690"
  },
  {
    "text": "Your TA, Kristen, reminded\nme that you can actually define a condition number\nfor any matrix, as well.",
    "start": "77690",
    "end": "85390"
  },
  {
    "text": "The condition we\ngave originally was associated with solving\nsquare systems of equations that actually have a solution.",
    "start": "85390",
    "end": "91730"
  },
  {
    "text": "But there is a condition number\nassociated with any matrix, and it's defined in terms\nof its singular values. So if you go back and look at\nthe definition of the two norm,",
    "start": "91730",
    "end": "99430"
  },
  {
    "text": "you try to think about the\ncondition number associated with the two norm, you'll\nsee that the conditions",
    "start": "99430",
    "end": "104700"
  },
  {
    "text": "of any matrix maybe\ncan be defined as the square root of the ratio\nof the biggest and the smallest",
    "start": "104700",
    "end": "111130"
  },
  {
    "text": "singular values of that matrix. So there's a condition number\nassociated with any matrix.",
    "start": "111130",
    "end": "116740"
  },
  {
    "text": "The condition\nnumber as an entity makes most sense\nwhen we're thinking about how we amplify errors--",
    "start": "116740",
    "end": "121990"
  },
  {
    "text": "numerical errors, solving\nsystems of equation zones. It's most easily applied to\nsquare systems that actually",
    "start": "121990",
    "end": "127608"
  },
  {
    "text": "have unique solutions,\nbut you can apply it to any system of\nequations you want. And the singular\nvalue decomposition",
    "start": "127609",
    "end": "132820"
  },
  {
    "text": "is one way to tap into that. OK, the last thing we did\ndiscussing linear algebra",
    "start": "132820",
    "end": "140110"
  },
  {
    "text": "was to talk about iterative\nsolutions, the systems of linear equations.",
    "start": "140110",
    "end": "146129"
  },
  {
    "text": "And that's actually\nour hook into solutions to systems of\nnonlinear equations. It's going to turn out\nthat exact solutions are",
    "start": "146130",
    "end": "153420"
  },
  {
    "text": "hard to come by for anything\nbut linear systems of equations. And so we're always\ngoing to have",
    "start": "153420",
    "end": "158460"
  },
  {
    "text": "these iterative algorithms,\nwhere we refine initial guesses for solutions until we\nconverge to something",
    "start": "158460",
    "end": "165240"
  },
  {
    "text": "that's a solution to the\nproblem that we wanted before. And one question\nyou should ask, when you do these sorts of\niterations, is when do I stop?",
    "start": "165240",
    "end": "175830"
  },
  {
    "text": "I don't know the exact\nsolution to this problem. I can't say I'm\nclose enough-- what does close enough even mean?",
    "start": "175830",
    "end": "182370"
  },
  {
    "text": "So how do I decide to stop? Do you have any\nideas or suggestions for how you might do that?",
    "start": "182370",
    "end": "188050"
  },
  {
    "text": "You've done some of this already\nin a homework assignment. But what do you think? How do you decide to stop? Yeah? AUDIENCE: [INAUDIBLE].",
    "start": "188050",
    "end": "194116"
  },
  {
    "text": " PROFESSOR: OK, so this\nis one suggestion--",
    "start": "194116",
    "end": "200650"
  },
  {
    "text": "look at my current iteration,\nand my next iteration, ask how far apart are\nthese two numbers?",
    "start": "200650",
    "end": "208090"
  },
  {
    "text": "If they're\nsufficiently far apart, seems like I've got some more\nsteps to make before I converge",
    "start": "208090",
    "end": "214540"
  },
  {
    "text": "to my solution. And if they're sufficiently\nclose together, the steps I'm taking\nare small enough that I might be happy\naccepting this solution",
    "start": "214540",
    "end": "222310"
  },
  {
    "text": "as a good approximation.  That's called the\nstep norm criteria-- I'll give you a formalization\nof that later-- it's",
    "start": "222310",
    "end": "228880"
  },
  {
    "text": "called the step norm criteria. How big are the steps\nthat I'm taking? And are they sufficiently\nsmall that I don't",
    "start": "228880",
    "end": "236920"
  },
  {
    "text": "care about any future steps? Another suggestion? AUDIENCE: I've got a question. PROFESSOR: Yeah?",
    "start": "236920",
    "end": "241986"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]\nabsolute [INAUDIBLE] when we did that for homework,\nI tried to do it [INAUDIBLE],,",
    "start": "241986",
    "end": "249205"
  },
  {
    "text": "and [INAUDIBLE]. PROFESSOR: Yes. I will show you a definition\nof the step norm criteria",
    "start": "249205",
    "end": "256180"
  },
  {
    "text": "that integrates both\nrelative and absolute error into the definition. And we'll see why, OK?",
    "start": "256180",
    "end": "263710"
  },
  {
    "text": "One problem may be-- what if the solution I'm\ntrying to converge to is 0?",
    "start": "263710",
    "end": "268839"
  },
  {
    "text": "How do you define the\nrelative error with respect to the number 0? There isn't one-- there is\nonly absolute error when",
    "start": "268839",
    "end": "275320"
  },
  {
    "text": "you're trying to converge to 0. So you may want to\nhave some measure of both absolute and\nrelative step size",
    "start": "275320",
    "end": "281882"
  },
  {
    "text": "in order to determine\nwhether you're converged. Is that the only way\nto do it, though?",
    "start": "281882",
    "end": "286970"
  },
  {
    "text": "Have any ideas, alternative\nproposals for deciding convergence? AUDIENCE: [INAUDIBLE]\nthe residual.",
    "start": "286970",
    "end": "292930"
  },
  {
    "text": "PROFESSOR: The residual. OK, what's the residual? AUDIENCE: [INAUDIBLE] PROFESSOR: Good, OK, so we\nasked, how good a solution--",
    "start": "292930",
    "end": "299560"
  },
  {
    "text": "we can ask how good a solution\nis this value that we've converged to by putting it\nback into the original system",
    "start": "299560",
    "end": "307660"
  },
  {
    "text": "of equations, and asking, how\nfar out of balance are we? I take my best guess for\nsolution x, and multiply it by",
    "start": "307660",
    "end": "313930"
  },
  {
    "text": "and A, and I subtract b-- we call that the residual. And is the residual\nsufficiently converged, or not?",
    "start": "313930",
    "end": "321280"
  },
  {
    "text": "If it's small\nenough in magnitude, then we would say,\nOK, maybe we're sufficiently close\nto the solution.",
    "start": "321280",
    "end": "327130"
  },
  {
    "text": "If it's too big, then we\nsay, OK, let's iterate some more until we get there. That is called the\nfunction norm criterion.",
    "start": "327130",
    "end": "333520"
  },
  {
    "text": " We're going to talk\nabout these in detail, as applied to systems\nof nonlinear equations.",
    "start": "333520",
    "end": "340100"
  },
  {
    "text": "But these same criteria apply\nto all iterative processes. Neither is preferred\nover the other.",
    "start": "340100",
    "end": "346922"
  },
  {
    "text": "You don't know the\nexact solution-- you have no way of measuring\nhow close or far away you are from the exact solution.",
    "start": "346922",
    "end": "352190"
  },
  {
    "text": "So usually you use as\nmany tools as possible to try to judge how good\nyour approximation is.",
    "start": "352190",
    "end": "357830"
  },
  {
    "text": "But you don't know for certain. What do you do, when\nthat's the case? We haven't really talked\nabout this in this class.",
    "start": "357830",
    "end": "365170"
  },
  {
    "text": "You have a problem, you\nprogram it into a computer, you get a solution. Is at the end of the story?",
    "start": "365170",
    "end": "371860"
  },
  {
    "text": "We just stop? You get a number back out,\nand that's the answer? How do you know you're right?",
    "start": "371860",
    "end": "377910"
  },
  {
    "text": " How do you know? ",
    "start": "377910",
    "end": "386400"
  },
  {
    "text": "We talked about\nnumerical error-- every calculation has\na numerical error-- how do you know you got\nthe right answer? ",
    "start": "386400",
    "end": "395950"
  },
  {
    "text": "What do you think? AUDIENCE: [INAUDIBLE] PROFESSOR: OK,\nyeah, this is true--",
    "start": "395950",
    "end": "401680"
  },
  {
    "text": "so you plug your solution\nback into the equation, you ask, how good a job\ndoes it do satisfying that?",
    "start": "401680",
    "end": "407139"
  },
  {
    "text": "But maybe this\nequation is relatively insensitive to the\nsolution you provide. Maybe many solutions\nnearby look like they also",
    "start": "407140",
    "end": "414160"
  },
  {
    "text": "satisfy the equation,\nbut those solutions are sufficiently far apart. So how do you--",
    "start": "414160",
    "end": "419328"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] PROFESSOR: OK, so that\nsort of physical reasoning",
    "start": "419329",
    "end": "425560"
  },
  {
    "text": "is a good one. In your transfer\nclass, you'll talk about doing\nasymptotic expansions,",
    "start": "425560",
    "end": "431800"
  },
  {
    "text": "or asymptotic\nsolutions to problems. Solve this complicated\nproblem in a limit",
    "start": "431800",
    "end": "437110"
  },
  {
    "text": "where it has some\nanalytical solution, and figure how the\nsolution scales, with respect to\ndifferent parameters.",
    "start": "437110",
    "end": "442960"
  },
  {
    "text": "So you can have an\nanalytical solution that you compare against\nyour numerical solution in certain limits. You have experiments\nthat you've done.",
    "start": "442960",
    "end": "450490"
  },
  {
    "text": "Experiment-- that's the reality. The computer is a fiction\nthat's trying to model reality,",
    "start": "450490",
    "end": "455590"
  },
  {
    "text": "so you can compare your\nsolution to experiments. You could also solve the problem\na bunch of different ways,",
    "start": "455590",
    "end": "461650"
  },
  {
    "text": "and see if all these answers\nconverge in the same place. So we're going to talk about\nsolving nonlinear equations--",
    "start": "461650",
    "end": "467875"
  },
  {
    "text": "we're going to need\ndifferent initial guesses for our iterative methods. We might try several\ndifferent initial guesses,",
    "start": "467875",
    "end": "473980"
  },
  {
    "text": "and see what solutions\nwe come up with. Maybe we converge all\nto the same solution, or maybe this problem has\nsome weird sensitivity in it,",
    "start": "473980",
    "end": "480970"
  },
  {
    "text": "and we get lots of\ndifferent solutions that aren't coordinated\nwith each other. One of the duties\nof someone who's",
    "start": "480970",
    "end": "487720"
  },
  {
    "text": "using numerical methods to\nsolve problems is to try to validate their result--",
    "start": "487720",
    "end": "493060"
  },
  {
    "text": "by solving it multiple\ntimes or multiple ways, or comparing against\nexperiment, or against known",
    "start": "493060",
    "end": "498490"
  },
  {
    "text": "analytical results,\nand certain limits where the answer\nshould be exact. But you can't just accept\nwhat the computer tells you--",
    "start": "498490",
    "end": "506840"
  },
  {
    "text": "you have to validate it against\nsome sort of external solution that you can compare with.",
    "start": "506840",
    "end": "512630"
  },
  {
    "text": "Sometimes it's hard to\ncome up with that solution, but it's immensely important. We know every calculation\ncan be an error.",
    "start": "512630",
    "end": "518664"
  },
  {
    "text": "And as we go on to more\ncomplicated problems, it's even more important\nto validate things. ",
    "start": "518664",
    "end": "525332"
  },
  {
    "text": "So, systems of\nnonlinear equations--",
    "start": "525332",
    "end": "531750"
  },
  {
    "text": "so these are\nproblems of a type f of x equals 0, where x is\nsome vector of unknowns,",
    "start": "531750",
    "end": "539770"
  },
  {
    "text": "and has dimension N.\nAnd f is a function that takes as input vectors\nof dimension N,",
    "start": "539770",
    "end": "546865"
  },
  {
    "text": "and gives an output a\nvector of dimension N. It's a map from R N to\nR N. But it's no longer",
    "start": "546865",
    "end": "553389"
  },
  {
    "text": "necessarily a linear map-- it\ncan be some nonlinear function of all the elements of this x.",
    "start": "553390",
    "end": "560180"
  },
  {
    "text": "And the solution\nto this equation, the particular solution\nof this equation, x-- for which f of x\nequals 0-- are called",
    "start": "560180",
    "end": "566360"
  },
  {
    "text": "the roots of this\nvector-valued function. The linear equations, then, are\njust represented in this form",
    "start": "566360",
    "end": "573290"
  },
  {
    "text": "as A x minus b, A x\nminus b equals 0-- it's the same as\nthe linear equations",
    "start": "573290",
    "end": "578750"
  },
  {
    "text": "we were solving before. So we're searching for the\nroots of these functions. Common chemical\nengineering examples",
    "start": "578750",
    "end": "585200"
  },
  {
    "text": "include equations of\nstate, often nonlinear, in terms of the variables\nwe're interested in. Energy balances have\nlots of non-linearities",
    "start": "585200",
    "end": "592310"
  },
  {
    "text": "introduced into them. Mass balances with\nnonlinear reactions.",
    "start": "592310",
    "end": "597889"
  },
  {
    "text": "Or reactions that\nare non-isothermal, so their kinetics are\nsensitive to temperature, and temperatures are\nvariable, we want to know.",
    "start": "597890",
    "end": "604464"
  },
  {
    "text": "These sorts of nonlinear\nequations crop up all over the place, and you want to\nbe able to solve them reliably.",
    "start": "604464",
    "end": "610450"
  },
  {
    "text": "Here's a simple, simple example. The Van der Waals\nequation of state-- here I've written it in terms of\nreduced pressure, temperature,",
    "start": "610450",
    "end": "618400"
  },
  {
    "text": "and molar volume. Nonetheless, this is the Van\nder Waals equation of state.",
    "start": "618400",
    "end": "623680"
  },
  {
    "text": "And somebody told you once\nthat if I plot pressure versus molar volume for\ndifferent temperatures,",
    "start": "623680",
    "end": "630190"
  },
  {
    "text": "I may see that, at\na given pressure, there could be just one root--",
    "start": "630190",
    "end": "635380"
  },
  {
    "text": "one possible molar volume\nthat satisfies the equation of state. Or there can be one, two,\nthree potential roots.",
    "start": "635380",
    "end": "644212"
  },
  {
    "text": "It turns out we don't know,\nwith nonlinear equations, how many possible\nsolutions there are. We knew, for linear\nequations, I either",
    "start": "644212",
    "end": "651190"
  },
  {
    "text": "had zero, one, or an\ninfinite number of solutions. But with nonlinear\nequations, in general, there's no way to predict them.",
    "start": "651190",
    "end": "657130"
  },
  {
    "text": "This problem can be\ntransformed into a polynomial, and polynomials are one of the\nfew nonlinear equations where",
    "start": "657130",
    "end": "662649"
  },
  {
    "text": "we know how to bound the\npossible number of solutions. ",
    "start": "662650",
    "end": "669220"
  },
  {
    "text": "So we can transform\nthis nonlinear equation to the form I showed\nyou before-- we just move 8/3 T to the other\nside of this equation.",
    "start": "669220",
    "end": "675900"
  },
  {
    "text": "We want to find the\nroots of this equation. So possibly, given pressure\nand temperature-- pressure",
    "start": "675900",
    "end": "682079"
  },
  {
    "text": "and temperature-- find\nall the molar volumes that satisfy the equation of state.",
    "start": "682080",
    "end": "688560"
  },
  {
    "text": "This is actually\noverly simplified for a particular\nphysical problem, of looking at vapor liquid\ncoexistence of the Van der",
    "start": "688560",
    "end": "695910"
  },
  {
    "text": "Waals fluid. You can't specify pressure and\ntemperature independently--",
    "start": "695910",
    "end": "701490"
  },
  {
    "text": "the saturation pressure,\nthe coexistence pressure depends on the temperature\nas the Gibbs phase rule.",
    "start": "701490",
    "end": "707400"
  },
  {
    "text": "So actually, phase equilibria\nis made up of three parts-- there's thermal equilibrium.",
    "start": "707400",
    "end": "712740"
  },
  {
    "text": "I'm going to add two\nphases, a gas and a liquid, and they have to have\nthe same temperature, otherwise they're\nnot in equilibrium. There's got to be mechanical\nequilibrium of two",
    "start": "712740",
    "end": "719399"
  },
  {
    "text": "phases, the gas and the liquid. They better have\nthe same pressure, otherwise one is going\nto be pushing harder on the other one.",
    "start": "719400",
    "end": "724690"
  },
  {
    "text": "They'll be in motion--\nthat's not in equilibrium. They've got to have the same\nchemical potential-- they have to be in chemical equilibrium.",
    "start": "724690",
    "end": "731190"
  },
  {
    "text": "So there can't be any net mass\nflux from one phase to another, otherwise, one phase\nis going to grow and the other is\ngoing to shrink.",
    "start": "731190",
    "end": "737506"
  },
  {
    "text": "They're not in equilibrium\nwith each other. So actually, the\nproblem of determining",
    "start": "737506",
    "end": "742860"
  },
  {
    "text": "vapor liquid coexistence,\nin this Van der Waals fluid, involves satisfying a number\nof different equations, some",
    "start": "742860",
    "end": "750240"
  },
  {
    "text": "of which are nonlinear,\nand are constrained by the equation of state. ",
    "start": "750240",
    "end": "756790"
  },
  {
    "text": "Given the temperature, there are\nthree unknowns-- the pressure, and the more volumes of\nthe gas and the liquid.",
    "start": "756790",
    "end": "763000"
  },
  {
    "text": "And there are three nonlinear\nequations we have to solve. Two of those are the\nequation of state, in the gas and the liquid--",
    "start": "763000",
    "end": "768490"
  },
  {
    "text": "I'll show them to\nyou in a second-- and the other is this Maxwell\nequal area construction, which essentially says that the\nchemical potential in the two",
    "start": "768490",
    "end": "775600"
  },
  {
    "text": "phases is equal. This is one way of\nrepresenting that. So we have to solve this\nsystem of nonlinear equations",
    "start": "775600",
    "end": "783520"
  },
  {
    "text": "for the saturation\npressure, the molar volume of the gas or vapor, and\nthe molar volume of the liquid.",
    "start": "783520",
    "end": "790530"
  },
  {
    "text": "And these are those equations. Here's the equation\nof state and the gas, here's the equation of\nstate in the liquid,",
    "start": "790530",
    "end": "795970"
  },
  {
    "text": "and here's the Maxwell\nequal area construction at defined values of\nP sat, V G and V L",
    "start": "795970",
    "end": "802840"
  },
  {
    "text": "that satisfy all\nthree equations. There's not going to be an\nanalytical way to do this-- it has to be done numerically.",
    "start": "802840",
    "end": "809638"
  },
  {
    "text": " Here's a simplification\nthat I can make, though.",
    "start": "809638",
    "end": "816070"
  },
  {
    "text": "So I can take that\nequal area construction, and I can solve for P sat\nin terms of V G and V L.",
    "start": "816070",
    "end": "821117"
  },
  {
    "text": "And so that reduces\nthe dimensionality of these equations\nfrom three to two. And when it's two dimensional,\nI can plot these things,",
    "start": "821117",
    "end": "827590"
  },
  {
    "text": "so that's helpful. So let's plot f 1-- the equation of state in the gas\nis a function of V G and V L.",
    "start": "827590",
    "end": "837190"
  },
  {
    "text": "Where that's equal to 0,\nthat's this black curve here. Let's plot f 2--",
    "start": "837190",
    "end": "842710"
  },
  {
    "text": "the equation of\nstate in the liquid as a function of V G and V\nL, where that's equal to 0,",
    "start": "842710",
    "end": "848079"
  },
  {
    "text": "that's this blue curve here. And the solutions are where\nthese curves intersect. So we're seeking out the\nspecific points graphically",
    "start": "848080",
    "end": "856150"
  },
  {
    "text": "where these curves intersect. First, this solution,\nand that solution aren't the solutions we're\ninterested in at all.",
    "start": "856150",
    "end": "861430"
  },
  {
    "text": "That would say that the\nmolar volume of the gas and the liquid is the same-- that's not really\nphase separation.",
    "start": "861430",
    "end": "866820"
  },
  {
    "text": "We want these heterogeneous\nsolutions out here.",
    "start": "866820",
    "end": "872530"
  },
  {
    "text": "So we need some methodology\nthat can reliably take us to those solutions. We'll see that\nthat methodology--",
    "start": "872530",
    "end": "878560"
  },
  {
    "text": "the most reliable methodology,\nand one of the ones that converges fastest\nto the solutions-- is called the\nNewton-Raphson method.",
    "start": "878560",
    "end": "885289"
  },
  {
    "text": "But even before we do\nthat, let's talk more about the structure of systems\nof nonlinear equations, and what sort of\nsolutions we can expect.",
    "start": "885289",
    "end": "892260"
  },
  {
    "text": "Does this example makes\nsense to everyone? Have you thought about\nthis before, maybe?",
    "start": "892260",
    "end": "898150"
  },
  {
    "text": "Yeah. So given a function, which\nis a map from R N to R N,",
    "start": "898150",
    "end": "904010"
  },
  {
    "text": "find the special solution, x\nstar, such that f of x star equals 0.",
    "start": "904010",
    "end": "909200"
  },
  {
    "text": "That's our task. And there could be no solutions. There can be one to\nan infinite number of locally unique\nsolutions, and there",
    "start": "909200",
    "end": "916579"
  },
  {
    "text": "can be an infinite\nnumber of solutions. A solution is to\nbe locally unique",
    "start": "916580",
    "end": "922360"
  },
  {
    "text": "if I can wrap that solution by\nsome ball of points, in which",
    "start": "922360",
    "end": "927610"
  },
  {
    "text": "there are no other solutions. That ball can be very,\nvery small, but as long as I can wrap that solution\nin some ball of points,",
    "start": "927610",
    "end": "933430"
  },
  {
    "text": "which are not solutions, we\nterm that locally unique. ",
    "start": "933430",
    "end": "939490"
  },
  {
    "text": "So consider the\nsimple function, one which depends on two\nvariables-- x1 and x2,",
    "start": "939490",
    "end": "945240"
  },
  {
    "text": "and f 2, which depends\non x1 and x2, equals 0. And I'm going to plot, in\nthe x1, x2 plane, were f 1",
    "start": "945240",
    "end": "952602"
  },
  {
    "text": "and f 2 are equal to 0,\nso that these curves here. ",
    "start": "952602",
    "end": "958279"
  },
  {
    "text": "And here, we have a\nlocally unique solution-- we see the curves cross\nat exactly one point. Here, you can see\nthese two curves",
    "start": "958280",
    "end": "964480"
  },
  {
    "text": "are tangent with each other. They could be coincident\nwith each other,",
    "start": "964480",
    "end": "969760"
  },
  {
    "text": "over some finite distance. In which case there's a\nlot of solutions that live on some locally tangent area.",
    "start": "969760",
    "end": "978370"
  },
  {
    "text": "Or they could just\ntouch in one point. So they may be tangent,\nand the solutions there are not locally unique, or\nthey may touch at one point,",
    "start": "978370",
    "end": "985300"
  },
  {
    "text": "and the solutions are-- there's one solution, and\nit's locally unique there. ",
    "start": "985300",
    "end": "993430"
  },
  {
    "text": "The reason why we talk about\nlocally unique solutions is it's going to be hard\nfor a numerical method",
    "start": "993430",
    "end": "1000790"
  },
  {
    "text": "to find anything\nthat's not locally unique in a reliable way. Locally unique solutions,\nnumerical methods",
    "start": "1000790",
    "end": "1007360"
  },
  {
    "text": "can find very reliably. But if they're not\nlocally unique? My iterative method\ncould converge",
    "start": "1007360",
    "end": "1013420"
  },
  {
    "text": "to any one of these solutions\nthat lives on this line, any of these tangent points. And I'm going to have\na hard time predicting",
    "start": "1013420",
    "end": "1019633"
  },
  {
    "text": "which one it's going to go to. That's a problem if you're\ntrying to solve something reliably over and\nover again-- if I",
    "start": "1019633",
    "end": "1026240"
  },
  {
    "text": "converge to one of these\nsolutions, or another solution, or another solution,\nthe data that comes out of that process isn't\ngoing to be easy to interpret.",
    "start": "1026240",
    "end": "1035790"
  },
  {
    "text": "There's something called the\ninverse function theorem, which says if f of x\nstar is equal to 0,",
    "start": "1035790",
    "end": "1042829"
  },
  {
    "text": "and the determinant\nof this matrix, J, which we call the Jacobian,\nevaluated at x star",
    "start": "1042829",
    "end": "1049400"
  },
  {
    "text": "is not equal to 0,\nthen x star necessarily is a locally unique solution.",
    "start": "1049400",
    "end": "1055049"
  },
  {
    "text": "So it's the inverse\nfunction theorem. The Jacobian is a matrix of\nthe partial derivatives of f,",
    "start": "1055050",
    "end": "1062795"
  },
  {
    "text": "if an elements of\nf, with respect to different elements of x.",
    "start": "1062795",
    "end": "1068029"
  },
  {
    "text": "So the first row of the\nJacobian is the derivatives of the first elements\nof f, with respect",
    "start": "1068030",
    "end": "1074180"
  },
  {
    "text": "to all the elements of\nx, and the other rows proceed accordingly. If the determinant\nof this matrix,",
    "start": "1074180",
    "end": "1081110"
  },
  {
    "text": "evaluated at the solution,\nis not equal to 0, then this solution is\nnecessarily locally unique. That's the inverse\nfunction theorem.",
    "start": "1081110",
    "end": "1087499"
  },
  {
    "text": " The Jacobian describes\nthe rate of change",
    "start": "1087499",
    "end": "1093280"
  },
  {
    "text": "of this vector-valued\nfunction with respect to all of its\nindependent variables.",
    "start": "1093280",
    "end": "1098920"
  },
  {
    "text": "And you may find that,\nfor some solutions, the determinant in the\nJacobian is equal to 0. We can't really say\nwhat's going on there--",
    "start": "1098920",
    "end": "1105250"
  },
  {
    "text": "the solution may\nbe locally unique, it may not be locally unique. I'm going to provide you\nsome examples in a second.",
    "start": "1105250",
    "end": "1111601"
  },
  {
    "text": "And most numerical\nmethods are only going to find one of these local\nunique solutions at a time. If we have some\nnon-local solutions,",
    "start": "1111602",
    "end": "1119930"
  },
  {
    "text": "that'll cause us problems. So we tend to want to work with\nfunctions that have locally unique solutions to begin with.",
    "start": "1119930",
    "end": "1127970"
  },
  {
    "text": "OK, here's an example. Oh, you have your\nnotes, so you know the formula for the Jacobian. Compute the Jacobian\nof this function.",
    "start": "1127970",
    "end": "1133383"
  },
  {
    "start": "1133383",
    "end": "1174400"
  },
  {
    "text": "So this function has a root\nat x1 equals 0, x2 equals 0.",
    "start": "1174400",
    "end": "1179790"
  },
  {
    "text": "If you think\ngraphically about what each of these little\nfunctions represents, you would agree that that\nroute is locally unique-- it's",
    "start": "1179790",
    "end": "1186240"
  },
  {
    "text": "just one point\nwhere both elements of this vector-valued\nfunction are equal to 0.",
    "start": "1186240",
    "end": "1192420"
  },
  {
    "text": "Here's what the Jacobian\nof this function should be. If you take the derivative of\nthe first element with respect",
    "start": "1192420",
    "end": "1197940"
  },
  {
    "text": "to x1, and then x2,\ntake the derivative of the second element with\nrespect to x1 and then x2--",
    "start": "1197940",
    "end": "1203950"
  },
  {
    "text": "at the solution, at the root of\nthis function, where x1 is 0, and x2 is 0, the Jacobian\nis a matrix of zeros.",
    "start": "1203950",
    "end": "1212100"
  },
  {
    "text": "Its determinant is 0. But the solution\nis locally unique. The inverse function\ntheorem only",
    "start": "1212100",
    "end": "1219330"
  },
  {
    "text": "tells us about what happens\nwhen the determinant's not equal to 0.",
    "start": "1219330",
    "end": "1224610"
  },
  {
    "text": "If the determinant's\nnot 0, then we have a locally unique solution.",
    "start": "1224610",
    "end": "1230380"
  },
  {
    "text": "Solution may be locally\nunique, its determinant may be equal to 0. Does that makes sense? You see how that plays out?",
    "start": "1230380",
    "end": "1237260"
  },
  {
    "text": "OK. There's a physical\nway to think about-- or a geometric way to think\nabout this inverse function",
    "start": "1237260",
    "end": "1243360"
  },
  {
    "text": "theorem. So think about the\nlinear equation, f of x is A x minus b.",
    "start": "1243360",
    "end": "1248754"
  },
  {
    "text": "You can show-- and you should\nactually work through this-- that the Jacobian\nof this function is just the matrix A. It says\nhow the function changes,",
    "start": "1248754",
    "end": "1258179"
  },
  {
    "text": "with respect to\nsmall changes in x. Well, that's just A-- this is a linear function.",
    "start": "1258180",
    "end": "1265090"
  },
  {
    "text": "So the equation,\nf of x equals 0, has a locally unique\nsolution when the determinant of the Jacobian-- which\nis the determinant of A--",
    "start": "1265090",
    "end": "1272400"
  },
  {
    "text": "is not equal to 0. But you already\nknew that, right? We already talked\nthrough linear algebra.",
    "start": "1272400",
    "end": "1278530"
  },
  {
    "text": "And so you know when this\nmatrix A is singular, then we can't invert\nthis system of equations",
    "start": "1278530",
    "end": "1284280"
  },
  {
    "text": "and find a unique solution\nin the first place. So the inverse function\ntheorem is nothing more",
    "start": "1284280",
    "end": "1289889"
  },
  {
    "text": "than an extension of what we\nlearned about when functions are and aren't invertible. Because a locally unique\nsolution when A is invertible.",
    "start": "1289890",
    "end": "1297390"
  },
  {
    "text": " In the neighborhood of f\nof x, in the neighborhood",
    "start": "1297390",
    "end": "1303480"
  },
  {
    "text": "of a root of f of x, we can\noften approximate the function as being linear.",
    "start": "1303480",
    "end": "1309360"
  },
  {
    "text": "We can treat it as though it's\na system of linear equations, very close to that root.",
    "start": "1309360",
    "end": "1314989"
  },
  {
    "text": "And then the things that we\nlearned from linear algebra are inherited by these\nlinearized solutions.",
    "start": "1314989",
    "end": "1321540"
  },
  {
    "text": "So here's this set of curves\nthat I showed you before. Near this root, let's zoom in--",
    "start": "1321540",
    "end": "1328920"
  },
  {
    "text": "let's zoom in. These lines look\nmostly straight. It's like the place where\ntwo planes intersect--",
    "start": "1328920",
    "end": "1336855"
  },
  {
    "text": "intersect this x1, x2 plane--\nthey each intersect at a line, and the crossing of those\nlines is the solution.",
    "start": "1336855",
    "end": "1343010"
  },
  {
    "text": "And it's locally unique. Because these two planes\nspan different subspaces.",
    "start": "1343010",
    "end": "1349880"
  },
  {
    "text": "Here's the case\nwhere we may have non-locally unique [INAUDIBLE]. Zoom in on this root, and\nvery close to this root,",
    "start": "1349880",
    "end": "1356090"
  },
  {
    "text": "well, it's hard to tell. Maybe these two planes are\ncoincident with each other, and they intersect and\nform the same line--",
    "start": "1356090",
    "end": "1362970"
  },
  {
    "text": "in which case they may\nnot be locally unique. Maybe if I zoom in close enough,\nI see, no, actually, they have a slightly different\norientation with respect",
    "start": "1362970",
    "end": "1370053"
  },
  {
    "text": "to each other, and there is a\nlocally unique solution there. It's difficult to tell here.",
    "start": "1370053",
    "end": "1376760"
  },
  {
    "text": "So these cases where the curves\ncross are easy to determine. These are the ones that\nthe inverse function theorem tells us about.",
    "start": "1376760",
    "end": "1381966"
  },
  {
    "text": "These ones are a little\nharder to work with. ",
    "start": "1381967",
    "end": "1387630"
  },
  {
    "text": "So I mentioned that you can zoom\nin, and look close to a root, and approximate the\nfunction is linear.",
    "start": "1387630",
    "end": "1394090"
  },
  {
    "text": "This is a process\ncalled linearization. You are in this\nfor 1-D functions--",
    "start": "1394090",
    "end": "1399450"
  },
  {
    "text": "f of x, at a point\nx plus delta x, is f of x plus its\nderivative times delta x.",
    "start": "1399450",
    "end": "1406815"
  },
  {
    "text": " And this'll typically be valid\nfor reasonably well-behaved",
    "start": "1406815",
    "end": "1412460"
  },
  {
    "text": "functions-- this sort\nof a linearization is going to be valid\nas delta x goes to 0. So as long as I haven't\nmoved too far away",
    "start": "1412460",
    "end": "1418640"
  },
  {
    "text": "from the point to x, I can\napproximate my function in the neighborhood of x\nusing this linearization.",
    "start": "1418640",
    "end": "1425894"
  },
  {
    "text": "You know, turns\nout the same thing is true for nonlinear functions. So f of x plus delta\nx is f of x plus--",
    "start": "1425894",
    "end": "1433070"
  },
  {
    "text": "well, I need the derivatives of\nmy function with respect to x, and those derivatives are\npartial derivatives now,",
    "start": "1433070",
    "end": "1439019"
  },
  {
    "text": "because we're in higher\ndimensional spaces. That's the Jacobian\nmultiplied by this vector",
    "start": "1439020",
    "end": "1444289"
  },
  {
    "text": "of displacements, delta x. And this will typically\nbe valid as long as the length of this\ndelta x is not too big--",
    "start": "1444290",
    "end": "1451250"
  },
  {
    "text": "as long as I haven't moved\ntoo far away from the point I'm interested in, f of x,\nthis will be a reasonably good",
    "start": "1451250",
    "end": "1456860"
  },
  {
    "text": "approximation. As long as our functions\nare well-behaved. There's an error that's incurred\nin making these approximations.",
    "start": "1456860",
    "end": "1465762"
  },
  {
    "text": "And for a general function\nthat's well-behaved, that error is going to be\nordered delta x squared-- and they're in the 1-D, or\nthe multi-dimensional case.",
    "start": "1465762",
    "end": "1473470"
  },
  {
    "text": " And this sort of\nan expansion, it's just part of a Taylor expansion\nfor each component of f of x.",
    "start": "1473470",
    "end": "1480990"
  },
  {
    "text": "So we take element I of f. I want to know its\nvalue at x plus delta x. That's its value at x.",
    "start": "1480990",
    "end": "1487650"
  },
  {
    "text": "Plus the sum of partial\nderivatives of that element, with respect to each of the\nelements of x, times delta x--",
    "start": "1487650",
    "end": "1494400"
  },
  {
    "text": "each of those delta x's. Plus, there are\nsome high order term in this Taylor expansion,\nwhich is quadratic in delta x",
    "start": "1494400",
    "end": "1501090"
  },
  {
    "text": "instead. There's a cubic term, and so on. These quadratic terms are\nwhat give rise to this order, delta x squared error.",
    "start": "1501090",
    "end": "1509100"
  },
  {
    "text": "In higher dimensions,\nwe typically don't worry about\nthese quadratic terms. We're pretty satisfied\nwith linearization",
    "start": "1509100",
    "end": "1515250"
  },
  {
    "text": "of our system of equations. Sometimes for 1-D\nnonlinear functions,",
    "start": "1515250",
    "end": "1520679"
  },
  {
    "text": "you can take\nadvantage of knowing what these quadratic terms\nare to do some funny things. But in many dimensions,\nyou usually don't use that.",
    "start": "1520680",
    "end": "1527730"
  },
  {
    "text": "Usually you just think about\nlinearizing the solution. So if I know where the solution\nis, if I know it's close,",
    "start": "1527730",
    "end": "1533440"
  },
  {
    "text": "if I can figure out points\nthat are close to the solution, then I can linearize the\nfunction in that neighborhood--",
    "start": "1533440",
    "end": "1538760"
  },
  {
    "text": "I can find the solution to the\nlinearized equation, instead. That's going to be suitably\nclose to the exact solution.",
    "start": "1538760",
    "end": "1544393"
  },
  {
    "text": "Does that makes sense? ",
    "start": "1544394",
    "end": "1549970"
  },
  {
    "text": "Nonlinear equations, like I\nsaid, are solved iteratively. Which means we make a map\nin our algorithmic map",
    "start": "1549970",
    "end": "1558309"
  },
  {
    "text": "which takes some\nvalue xy and generates some new value x plus 1, which\nis a better approximation",
    "start": "1558310",
    "end": "1565390"
  },
  {
    "text": "for the solution we're after. And we designed the map\nso that the root, x star,",
    "start": "1565390",
    "end": "1571419"
  },
  {
    "text": "is what's called a\nfixed point of the map. So if I put x star\nin on this side, I get x star in\non the other side.",
    "start": "1571420",
    "end": "1578530"
  },
  {
    "text": "By design, the root is a\nfixed point of the map. The map may converge,\nor it may not converge,",
    "start": "1578530",
    "end": "1586420"
  },
  {
    "text": "but the root is a fixed point. And we'll stop iterating\nwhen the map is sufficiently converged.",
    "start": "1586420",
    "end": "1592090"
  },
  {
    "text": "You guys came up with\ntwo different criteria for stopping. One is called the\nfunction norm criteria.",
    "start": "1592090",
    "end": "1598470"
  },
  {
    "text": "I look at how big\nmy function is-- I'm trying to find\nthe place where the function is equal to 0.",
    "start": "1598470",
    "end": "1603910"
  },
  {
    "text": "So I look at how big,\nin the norm space, my function is for my\ncurrent best solution,",
    "start": "1603910",
    "end": "1610090"
  },
  {
    "text": "and ask if it's smaller\nthan some tolerance epsilon. If it is, then I say,\nwell, my function is sufficiently close to 0--",
    "start": "1610090",
    "end": "1616480"
  },
  {
    "text": "I'm happy with this solution. The solution is close\nenough to satisfying the original equation that\nI'll accept it, and I stop.",
    "start": "1616480",
    "end": "1624899"
  },
  {
    "text": "The other criteria, it's\ncalled the step norm criteria. I look at two successive\napproximations for the solution.",
    "start": "1624899",
    "end": "1630179"
  },
  {
    "text": "I take their\ndifference, and ask, is the norm of that\ndifference smaller than either some\nabsolute tolerance,",
    "start": "1630180",
    "end": "1638679"
  },
  {
    "text": "or some relative tolerance,\nmultiplied by the norm of my current solution?",
    "start": "1638680",
    "end": "1644649"
  },
  {
    "text": "So suppose x is a large number,\nthat spacing between these x's",
    "start": "1644650",
    "end": "1651850"
  },
  {
    "text": "may be quite big, but the\nrelative spacing may actually be quite small.",
    "start": "1651850",
    "end": "1657410"
  },
  {
    "text": "And if the relative\nspacing is small enough, you might say, well, this\nis sufficiently converged. And so that's where this\nrelative error, relative error",
    "start": "1657410",
    "end": "1666100"
  },
  {
    "text": "tolerance, comes into play\nin the step norm criteria. Suppose x is a small\nnumber, close to 0 instead.",
    "start": "1666100",
    "end": "1672310"
  },
  {
    "text": "These steps may be very tiny-- these steps may be quite tiny.",
    "start": "1672310",
    "end": "1679180"
  },
  {
    "text": "They may satisfy this\nrelative criteria quite well, but you may want to put\nsome absolute tolerance",
    "start": "1679180",
    "end": "1685270"
  },
  {
    "text": "on how far these steps are\nbefore you stop instead. Because these x's may be\nsmall in and of themselves.",
    "start": "1685270",
    "end": "1692032"
  },
  {
    "text": "And so this one is\neasy to satisfy, but this one becomes harder. So you usually\nuse both of these. Sometimes you have\nsolutions that",
    "start": "1692032",
    "end": "1697690"
  },
  {
    "text": "are converging\ntoward small numbers, and then the absolute error\ntolerance becomes important. Sometimes you have\nsolutions that",
    "start": "1697690",
    "end": "1703425"
  },
  {
    "text": "are converging\ntowards large numbers, and so the relative error\ntolerance becomes important. Does that make sense?",
    "start": "1703425",
    "end": "1709480"
  },
  {
    "text": "Of course, you can't just use\nthis one, or just use that one. You typically like\nto use all of these.",
    "start": "1709480",
    "end": "1715780"
  },
  {
    "text": "Because they can fail. And if the function\nnorm criterion fail--",
    "start": "1715780",
    "end": "1721474"
  },
  {
    "text": "here's an example\nwhere I'm taking some iterations, some\napproximate solutions that are headed towards the\nactual root of this function.",
    "start": "1721474",
    "end": "1729460"
  },
  {
    "text": "And at some point, I\nfind that this solution is within epsilon of 0.",
    "start": "1729460",
    "end": "1735820"
  },
  {
    "text": "And so I'd like to\naccept this solution, but graphically\nit looks like it's very far away from the root.",
    "start": "1735820",
    "end": "1740860"
  },
  {
    "text": "So this is a case\nwhere the function has a very shallow slope. It's a very shallow slope,\nand the functional criteria,",
    "start": "1740860",
    "end": "1748690"
  },
  {
    "text": "not so good, really. I call this a solution, but it's\nquite a ways away from star.",
    "start": "1748690",
    "end": "1754425"
  },
  {
    "text": "So sometimes it's going to\nwork, but sometimes it's not going to work. Here's the step norm\ncriteria-- here,",
    "start": "1754425",
    "end": "1760230"
  },
  {
    "text": "I have a function\nnowhere near a root-- I have no idea where\nI am on this function,",
    "start": "1760230",
    "end": "1765310"
  },
  {
    "text": "I don't know what value\nthis function has, but my steps suddenly\ngot small enough",
    "start": "1765310",
    "end": "1770527"
  },
  {
    "text": "that they're smaller than\nthis absolute tolerance, or they're smaller than the\nrelative error tolerance. I might say, OK, let's stop.",
    "start": "1770527",
    "end": "1776340"
  },
  {
    "text": "I'm not taking very\nlarge steps anymore, this seems like a\ngood place to quit. But actually, my\nfunction just after this",
    "start": "1776340",
    "end": "1782792"
  },
  {
    "text": "didn't go to 0 at all, it curved\nup and went the other way. There's not even\na solution nearby. So both of these\nthings can fail,",
    "start": "1782792",
    "end": "1789810"
  },
  {
    "text": "and we try to use\nboth of them instead to evaluate whether we\nhave a reasonable solution to our nonlinear\nequation or not.",
    "start": "1789810",
    "end": "1797000"
  },
  {
    "text": "Make sense?  Are there any questions about\nthat before you I go on?",
    "start": "1797000",
    "end": "1804114"
  },
  {
    "text": "No. OK. We also talk oftentimes\nabout the rate",
    "start": "1804114",
    "end": "1809580"
  },
  {
    "text": "of convergence of the iterative\nprocess that we're using. We might say it converges\nlinearly, or quadratically.",
    "start": "1809580",
    "end": "1818239"
  },
  {
    "text": "And the rate of\nconvergence is always assessed by looking\nat the difference",
    "start": "1818239",
    "end": "1824310"
  },
  {
    "text": "between successive--\nwell, we look at the ratio of differences\nfor successive approximation.",
    "start": "1824310",
    "end": "1831550"
  },
  {
    "text": "So here's the difference between\nmy best approximation, step i plus 1 minus the\nexact solution,",
    "start": "1831550",
    "end": "1837950"
  },
  {
    "text": "normed, divided by my best\napproximation at step i, minus the exact solution normed,\nand raised to some power, q.",
    "start": "1837950",
    "end": "1846770"
  },
  {
    "text": "And as I go to very large\nnumbers of iterations, i-- this limit should\nbe i, I apologize.",
    "start": "1846770",
    "end": "1854240"
  },
  {
    "text": "I'll fix that in\nthe notes online, but this limit should be i--\nis i, the number of steps gets very large.",
    "start": "1854240",
    "end": "1860380"
  },
  {
    "text": "This ratio should\nconverge to some constant. And the ratio will\nconverge to a constant",
    "start": "1860380",
    "end": "1866254"
  },
  {
    "text": "when I choose the\nright power of q here.  So when this limit exists,\nand it doesn't go to 0,",
    "start": "1866254",
    "end": "1874491"
  },
  {
    "text": "we can identify what sort\nof convergence we get. So if q equals 1,\nand C is smaller than when we say that\nconvergence is linear,",
    "start": "1874491",
    "end": "1881544"
  },
  {
    "text": "what is that saying, really? This top step here is\nthe absolute error, an approximation i plus 1.",
    "start": "1881544",
    "end": "1887679"
  },
  {
    "text": "This bottom step here is the\nabsolute error in step i-- remember two is one\nfor linear convergence.",
    "start": "1887680",
    "end": "1894110"
  },
  {
    "text": "So the ratio of absolute errors,\nas long as that's less than 1-- I'm converging, I'm moving\nmy way towards the solution.",
    "start": "1894110",
    "end": "1902570"
  },
  {
    "text": "And we say that rate is linear. If C is 10 to the minus\n1, then each iteration",
    "start": "1902570",
    "end": "1908140"
  },
  {
    "text": "will be one digit more\naccurate than the previous one. The absolute error will\nbe 10 times smaller",
    "start": "1908140",
    "end": "1914440"
  },
  {
    "text": "in the next iteration\nversus the previous one. That would be great-- usually C isn't that small. ",
    "start": "1914440",
    "end": "1922210"
  },
  {
    "text": "If this power, for which\nthis limit exists, q, is bigger than 1, we say the\nconvergence is super linear.",
    "start": "1922210",
    "end": "1930140"
  },
  {
    "text": "If q is 2, which\nwe'll see is something that results from the\nNewton-Raphson method,",
    "start": "1930140",
    "end": "1935540"
  },
  {
    "text": "then we say convergence\nis quadratic. What that means is the number of\naccurate digits in my solution",
    "start": "1935540",
    "end": "1942169"
  },
  {
    "text": "will actually double\nwith each iteration. Linear, which equals\n10 to the minus 1,",
    "start": "1942170",
    "end": "1948320"
  },
  {
    "text": "I get one digit per iteration. Quadratic, I double the number\nof digits per iteration--",
    "start": "1948320",
    "end": "1953910"
  },
  {
    "text": "I have one digit\non one iteration, I get two the next one,\nand four the next one, and eight the next one.",
    "start": "1953910",
    "end": "1959120"
  },
  {
    "text": "So quadratic convergence\nis marvelous.",
    "start": "1959120",
    "end": "1964130"
  },
  {
    "text": "Linear convergence, that's OK. That's about the minimum\nyou'd be willing to accept.",
    "start": "1964130",
    "end": "1969210"
  },
  {
    "text": "Quadratic convergence\nis great, so we aim for methods that try\nto have these higher order convergences.",
    "start": "1969210",
    "end": "1974780"
  },
  {
    "text": "So you really quickly get\nhighly accurate solutions. You can go back and\nlook at your notes and see that the\nJacobian method,",
    "start": "1974780",
    "end": "1980980"
  },
  {
    "text": "and the Gauss-Seidel method both\nshow linear convergence rates. They're linear methods.",
    "start": "1980980",
    "end": "1987902"
  },
  {
    "text": "Does this make sense? OK. So I meant it mentioned\nNewton-Raphson. Hopefully, somebody\nat some point",
    "start": "1987902",
    "end": "1994450"
  },
  {
    "text": "told you about the\nNewton-Raphson method for solving at least\none-dimensional, nonlinear",
    "start": "1994450",
    "end": "1999789"
  },
  {
    "text": "equations. It goes like this, though. You say, I guess my solution is\nclose to this green point here.",
    "start": "1999790",
    "end": "2007440"
  },
  {
    "text": "Let me linearize my\nfunction at that point, and find where that linear\napproximation has a root--",
    "start": "2007440",
    "end": "2014830"
  },
  {
    "text": "which is this next green point. And then repeat\nthat process here. I find the linearization of\nmy function, this pink arrow.",
    "start": "2014830",
    "end": "2022320"
  },
  {
    "text": "I look for where that\nlinear function has a root, and that's my next\nbest approximation.",
    "start": "2022320",
    "end": "2027390"
  },
  {
    "text": "And I repeat this\nprocess over and over, and it will reliably-- under certain circumstances--\nconverge to the root.",
    "start": "2027390",
    "end": "2036320"
  },
  {
    "text": "What does that look like,\nin terms of the equations? So I linearized\nmy function, so I",
    "start": "2036320",
    "end": "2042420"
  },
  {
    "text": "want to approximate\nf of x at i plus 1, in terms of f of x at\ni-- so it's f of x at i,",
    "start": "2042420",
    "end": "2049050"
  },
  {
    "text": "plus the derivative, multiplied\nby the difference between x i plus 1 and x i. And I say, find the place\nwhere this approximation",
    "start": "2049050",
    "end": "2056820"
  },
  {
    "text": "is equal to 0,\nand determine what the next point that I'm going to\nuse to approximate my solution",
    "start": "2056820",
    "end": "2063679"
  },
  {
    "text": "is. So I solve for x i plus\n1, in terms of x i. How big of a step do I take\nfrom x i to x i plus 1?",
    "start": "2063679",
    "end": "2070839"
  },
  {
    "text": "It's this big, so the ratio of\nthe function to its derivative at x i.",
    "start": "2070840",
    "end": "2076838"
  },
  {
    "text": "And the derivative does the job\nof telling me which direction I",
    "start": "2076839",
    "end": "2082110"
  },
  {
    "text": "should step in. Derivative gives\nme directionality, and this ratio here tells me\nthe magnitude of the step.",
    "start": "2082110",
    "end": "2090119"
  },
  {
    "text": "The magnitudes,\nyou know, they're not very good oftentimes,\nbecause these functions that we're trying to\nsolve aren't very linear.",
    "start": "2090120",
    "end": "2097260"
  },
  {
    "text": "Usually they're\nhighly nonlinear. What's really helpful is\ngetting the direction right. You could go right, you could\ngo left-- only one of those ways",
    "start": "2097260",
    "end": "2104040"
  },
  {
    "text": "is getting you to the root. Newton-Raphson has\nthis advantage-- it always points you\nin the right direction.",
    "start": "2104040",
    "end": "2109359"
  },
  {
    "text": "OK? Of course, you can do this in\nany number of dimensions, not just one dimension.",
    "start": "2109360",
    "end": "2116040"
  },
  {
    "text": "So you can approximate\nyour function as linear-- f of x i plus\n1 is approximately 0.",
    "start": "2116040",
    "end": "2121140"
  },
  {
    "text": "And then let's take\nour linearized version of the function, and let's\nfind where it's equal to 0.",
    "start": "2121140",
    "end": "2127740"
  },
  {
    "text": "Sometimes what's\ndone is to replace this difference, x\ni plus 1, minus x i,",
    "start": "2127740",
    "end": "2133200"
  },
  {
    "text": "with an unknown vector, d i-- which is the step size. How big a step am I going to\ntake from x i to x i plus 1?",
    "start": "2133200",
    "end": "2141540"
  },
  {
    "text": "And so we solve this equation\nfor the displacement, d i. Move f to the other\nside, so you have",
    "start": "2141540",
    "end": "2146859"
  },
  {
    "text": "Jacobian times d i is minus f. And solve-- d i is\nJacobian inverse times f.",
    "start": "2146860",
    "end": "2153270"
  },
  {
    "text": "It's just a system\nof linear equations. Now we know our step size.",
    "start": "2153270",
    "end": "2158550"
  },
  {
    "text": "So x i plus 1 is x i\nplus b, or x i plus 1 is x i minus Jacobian\ninverse times f.",
    "start": "2158550",
    "end": "2167600"
  },
  {
    "text": "The inverse of the Jacobian\nplays the same role is 1 over the derivative. It's telling us what\ndirection to step in,",
    "start": "2167600",
    "end": "2173960"
  },
  {
    "text": "in this multi-dimensional space. And this solution to\nthe system of equations",
    "start": "2173960",
    "end": "2179420"
  },
  {
    "text": "is giving us a magnitude of the\nstep that's good, not great, but is taking us closer\nand closer to the root.",
    "start": "2179420",
    "end": "2186980"
  },
  {
    "text": "So this is the\nNewton-Raphson method applied to the system\nof nonlinear equations. This is really the\nway you want to solve",
    "start": "2186980",
    "end": "2192500"
  },
  {
    "text": "these sorts of problems. It doesn't always work-- things can go wrong.",
    "start": "2192500",
    "end": "2198732"
  },
  {
    "text": "What sorts of things\ngo wrong here? Can you guess? ",
    "start": "2198732",
    "end": "2204010"
  },
  {
    "text": "Yeah? AUDIENCE: [INAUDIBLE] PROFESSOR: OK, this is good. So in the 1-D problem, sometimes\nthe Newton-Raphson method",
    "start": "2204010",
    "end": "2212550"
  },
  {
    "text": "can get stuck. So it won't have good\nnecessarily global convergence",
    "start": "2212550",
    "end": "2218190"
  },
  {
    "text": "properties. If you have a bad initial guess,\nit might get stuck someplace, and the iterates will converge. That can be true.",
    "start": "2218190",
    "end": "2223920"
  },
  {
    "text": "What else can go wrong? AUDIENCE: [INAUDIBLE] PROFESSOR: Good, so\nif you're derivative is 0, that's going\nto be problematic.",
    "start": "2223920",
    "end": "2230290"
  },
  {
    "text": "What's the\nmulti-dimensional equivalent of the derivative being 0? AUDIENCE: [INAUDIBLE] PROFESSOR: What's that?",
    "start": "2230290",
    "end": "2236470"
  },
  {
    "text": "Singular Jacobian, right? So if this is J, the Jacobian,\nhas some null space associated",
    "start": "2236470",
    "end": "2242190"
  },
  {
    "text": "with it, how am I\nsupposed to figure out which direction to step in? There's some arbitrariness\nassociated with the solution",
    "start": "2242190",
    "end": "2249720"
  },
  {
    "text": "of this system of equations. So the derivative is 0 in the\n1-D example, that's a problem.",
    "start": "2249720",
    "end": "2255240"
  },
  {
    "text": "That problem gets\na little fuzzier, but it's still a\nbig problem when we try to solve for the\nstep size, or the step--",
    "start": "2255240",
    "end": "2262019"
  },
  {
    "text": "the Newton-Raphson step. They may not be able to do this. ",
    "start": "2262020",
    "end": "2267400"
  },
  {
    "text": "You don't run into\nthis very often, but you can, from time to time. One place where this\nis going to happen",
    "start": "2267400",
    "end": "2272730"
  },
  {
    "text": "is if we have a non-locally\nunique solution. When we have one of those,\nwe know the determinant",
    "start": "2272730",
    "end": "2278220"
  },
  {
    "text": "of the Jacobian at that\npoint is going to be 0. If we're close to\nthose solutions,",
    "start": "2278220",
    "end": "2284369"
  },
  {
    "text": "well the determinant\nof the Jacobian is going to be close to 0-- you might expect that the system\nof equations you have to solve",
    "start": "2284370",
    "end": "2291420"
  },
  {
    "text": "becomes ill-conditioned. So even though there\nmay be an exact solution for all the steps\nleading up to that point,",
    "start": "2291420",
    "end": "2298562"
  },
  {
    "text": "the equations may\nbecome ill-conditioned. You may not be able to\nreliably find those solutions with your computer, either.",
    "start": "2298562",
    "end": "2304290"
  },
  {
    "text": "So then these steps\nyou take, well, who knows where they're\ngoing at that point.",
    "start": "2304290",
    "end": "2309380"
  },
  {
    "text": "It's going to be crazy. There are ways of fixing\nall these problems. Let's do an example.",
    "start": "2309380",
    "end": "2316442"
  },
  {
    "text": "This is a geometry\nexample, but you can write it is a system of\nnonlinear equations, as well. So we have two circles--",
    "start": "2316442",
    "end": "2323450"
  },
  {
    "text": "circle f 1, circle f\n2 in the x1, x2 plane. They satisfy-- these\nare the locus of points,",
    "start": "2323450",
    "end": "2329450"
  },
  {
    "text": "that satisfy the equation f\n1 of x 1 and x 2 equals 0-- this is the equation\nfor one circle,",
    "start": "2329450",
    "end": "2335800"
  },
  {
    "text": "and this is the equation\nfor the other circle. And we want the\nsolution, we want the roots of this\nvector-valued function, f,",
    "start": "2335800",
    "end": "2342920"
  },
  {
    "text": "for vector-valued x. And those are the intercepts\nbetween these two circles.",
    "start": "2342920",
    "end": "2349110"
  },
  {
    "text": "You can do it using\nNewton-Raphson, so you're going to need\nto know the Jacobian.",
    "start": "2349110",
    "end": "2354990"
  },
  {
    "text": "So compute the Jacobian\nof this function. This is practice--\nmaybe most of you know how to compute a\nJacobian, but some people",
    "start": "2354990",
    "end": "2360370"
  },
  {
    "text": "haven't done it before. So it's always good to\nmake sure you remember that the first row\nof the Jacobian is the derivatives of\nthe first element of f.",
    "start": "2360370",
    "end": "2368530"
  },
  {
    "text": "And later rows are\nlater elements. You don't want the\ntranspose of the Jacobian. Then it won't work.",
    "start": "2368530",
    "end": "2373551"
  },
  {
    "start": "2373551",
    "end": "2402400"
  },
  {
    "text": "OK, so should look\nsomething like this. There's your Jacobian.",
    "start": "2402400",
    "end": "2408259"
  },
  {
    "text": "The Newton-Raphson\nprocess tells us how to take steps from one\napproximation to the next.",
    "start": "2408260",
    "end": "2414620"
  },
  {
    "text": "The step is equal to minus the\nJacobian inverse evaluated,",
    "start": "2414620",
    "end": "2421060"
  },
  {
    "text": "and my best guess for\nthe solution multiplied by the function-- evaluated at\nmy best guess of the solution.",
    "start": "2421060",
    "end": "2429080"
  },
  {
    "text": "You're never going to compute\nJacobian inverse explicitly-- that's just code for solve this\nsystem of linear equations.",
    "start": "2429080",
    "end": "2435170"
  },
  {
    "text": "So use the slash operator\nin MatLab, for example. And here you go-- I had an initial guess for\nthe solution, iterate 0",
    "start": "2435170",
    "end": "2442880"
  },
  {
    "text": "at minus 1 and 3. This is somewhere\noutside the circles-- it's pretty far away\nfrom the solutions. But I do my Newton-Raphson\nsteps, I iterate on and on.",
    "start": "2442880",
    "end": "2451180"
  },
  {
    "text": "And after four\nsteps, you can see that the step size\nin absolute value is order 10 to the minus 3.",
    "start": "2451180",
    "end": "2457539"
  },
  {
    "text": "The function norm is\norder 10 to the minus 3, as well-- and maybe\norder 10 to the minus 2, but it's getting down there.",
    "start": "2457540",
    "end": "2463800"
  },
  {
    "text": "These things are\ndecreasing pretty quickly. And I move to a\npoint that you'll see is pretty close\nto the solution.",
    "start": "2463800",
    "end": "2469240"
  },
  {
    "text": " Here's some things you need\nto know about Newton-Raphson,",
    "start": "2469240",
    "end": "2476070"
  },
  {
    "text": "you'll want to think carefully\nabout as we go forward. So it possesses a local\nconvergence property.",
    "start": "2476070",
    "end": "2484990"
  },
  {
    "text": "I'm going to illustrate\nthat graphically for you. So here, I didn't solve the\nproblem once, I solved it--",
    "start": "2484990",
    "end": "2491070"
  },
  {
    "text": "I don't know, 10,000 times. And I chose different initial\npoints to start iterating with.",
    "start": "2491070",
    "end": "2496610"
  },
  {
    "text": "Here, minus 1, 3,\nthat was one point. But I chose a whole\nbunch of them. And I asked, how\nmany iterations--",
    "start": "2496610",
    "end": "2503970"
  },
  {
    "text": "how many steps did my\nNewton-Raphson method have to take before\nI got sufficiently close to either this root\nhere, or this root there?",
    "start": "2503970",
    "end": "2513540"
  },
  {
    "text": "I don't remember what that\nconvergence criterion was-- it doesn't really matter,\nbut there was some 10 to the minus 3, or 10 to the\nminus 5 or 10 to the minus 8,",
    "start": "2513540",
    "end": "2520366"
  },
  {
    "text": "the convergence\ncriterion that I made sure the Newton-Raphson method\nhit, in both the function norm and step norm cases.",
    "start": "2520366",
    "end": "2528450"
  },
  {
    "text": "And then, if the color\non this map is blue-- the solution converged to\nthis star in the blue zone--",
    "start": "2528450",
    "end": "2534240"
  },
  {
    "text": "if the color's orange, the\nsolution converged to the star in the orange zone. And if the color is light, it\ndidn't take so many iterations",
    "start": "2534240",
    "end": "2541920"
  },
  {
    "text": "to converge. And if the color gets darker,\nit takes more and more iterations to converge.",
    "start": "2541920",
    "end": "2547080"
  },
  {
    "text": "So that's the picture-- that's this map. I solved it a bunch\nof times, and then I mapped out how\nmany iterations did",
    "start": "2547080",
    "end": "2553124"
  },
  {
    "text": "it take me to converge\nto different solutions? So you can see if I start\nclose to the solution, the color is really light.",
    "start": "2553124",
    "end": "2558390"
  },
  {
    "text": "It doesn't take very many\niterations to get there. And the further way I\nmove in this direction-- still doesn't seem like it\ntake so many iterations to get",
    "start": "2558390",
    "end": "2565710"
  },
  {
    "text": "there, either. I need a good initial guess-- I want to be close to where\nI think the solution is.",
    "start": "2565710",
    "end": "2571910"
  },
  {
    "text": "Because once I'm over here\nsomewhere, I do pretty well. And the same is true\non the other side, because this problem\nis symmetric.",
    "start": "2571910",
    "end": "2579000"
  },
  {
    "text": "There's a line down the middle\nhere, and along this line, the determinant of the\nJacobian is equal to 0.",
    "start": "2579000",
    "end": "2585585"
  },
  {
    "text": " So we talked about these points\nwith the Newton-Raphson method.",
    "start": "2585585",
    "end": "2591970"
  },
  {
    "text": "And if I pick initial\nguesses sufficiently close to this line, you can see the\ncolor gets darker and darker.",
    "start": "2591970",
    "end": "2597970"
  },
  {
    "text": "The number of iterations\nrequired to converge the solution goes way up.",
    "start": "2597970",
    "end": "2603640"
  },
  {
    "text": "Now, the Newton-Raphson method\npossesses a local convergence property.",
    "start": "2603640",
    "end": "2608740"
  },
  {
    "text": "Which means, if a\nlocally unique solution, there's always going\nto be some neighborhood",
    "start": "2608740",
    "end": "2614910"
  },
  {
    "text": "around that solution for which\nthe determinant of the Jacobian is not equal to 0. And in that neighborhood,\nI can guarantee",
    "start": "2614910",
    "end": "2622710"
  },
  {
    "text": "that this iterative process will\neventually reach the solution. That's pretty good.",
    "start": "2622710",
    "end": "2628070"
  },
  {
    "text": "That's handy. These iterates can\ngo anywhere-- how do you know you're\ngetting to the solution? Are you going to\nwaste your time, or are you going to get there?",
    "start": "2628070",
    "end": "2633300"
  },
  {
    "text": "So that's this local\nconvergence property associated with it, which is nice.",
    "start": "2633300",
    "end": "2638690"
  },
  {
    "text": "But it'll break down\nas I get to places where the determent of the\nJacobian is equal to 0.",
    "start": "2638690",
    "end": "2644450"
  },
  {
    "text": "so there could be a zone-- it's not in this one-- there\ncould be a zone, for example,",
    "start": "2644450",
    "end": "2649730"
  },
  {
    "text": "like a ring on which the\ndeterminant of the Jacobian sequence is 0. And if I take a guess\ninside that ring, who knows where that solution\nis going to go to.",
    "start": "2649730",
    "end": "2656276"
  },
  {
    "text": "Could be something\nlike Sam said, where the iterative method just\nbounces around inside that ring",
    "start": "2656276",
    "end": "2661579"
  },
  {
    "text": "and never converges. But when I have roots\nthat are locally unique,",
    "start": "2661580",
    "end": "2666800"
  },
  {
    "text": "and I start with good\nguesses close to those roots, I can guarantee the\nNewton-Raphson method will converge.",
    "start": "2666800",
    "end": "2672619"
  },
  {
    "text": "I'll show you next time that\nnot only does it converge, but it also converges\nquadratically. So you start sufficiently\nclose to the solution,",
    "start": "2672620",
    "end": "2679452"
  },
  {
    "text": "you get to double the\nnumber of accurate digits in each iteration. You can see that happening here. OK, so I have one accurate\ndigit, now I have two.",
    "start": "2679452",
    "end": "2687619"
  },
  {
    "text": "The next iteration I'll\nhave four, and so on. The number of accurate\ndigits is going to double at each iteration.",
    "start": "2687620",
    "end": "2696030"
  },
  {
    "text": "So that's going to\nconclude for today. Next time, we'll talk about\nhow to fix these problems",
    "start": "2696030",
    "end": "2701160"
  },
  {
    "text": "with the Newton-Raphson method. So there are going\nto be cases where the convergence isn't ideal,\nwhere we can improve things.",
    "start": "2701160",
    "end": "2707345"
  },
  {
    "text": "There are going\nto be cases where we don't want to\ncompute the Jacobian or the Jacobian inverse. And we can improve the method.",
    "start": "2707345",
    "end": "2713840"
  },
  {
    "text": "Thanks. ",
    "start": "2713840",
    "end": "2716175"
  }
]