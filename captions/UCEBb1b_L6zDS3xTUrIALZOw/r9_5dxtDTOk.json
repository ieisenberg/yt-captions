[
  {
    "text": "[SQUEAKING] [RUSTLING] [CLICKING]",
    "start": "0",
    "end": "5405"
  },
  {
    "text": "PROFESSOR: So you've\nalready seen a little bit of the story of forward\nmode and reverse mode from Stephen last week.",
    "start": "10276",
    "end": "17617"
  },
  {
    "text": "One version of the\nstory is that you're multiplying derivatives,\nor Jacobian matrices,",
    "start": "17617",
    "end": "24491"
  },
  {
    "text": "or something like that. And, of course,\nyou've heard Stephen say that matrix\nmultiplication is associative,",
    "start": "24491",
    "end": "31431"
  },
  {
    "text": "and so you can go left to\nright or right to left, but it matters what\norder you go in terms",
    "start": "31431",
    "end": "38638"
  },
  {
    "text": "of the complexity\nof the computation. That one order might be\nan n cubed computation, and another order might be\nan n squared computation.",
    "start": "38638",
    "end": "46246"
  },
  {
    "text": "And so you saw an\nexample of that. And in some\nfundamental sense, that",
    "start": "46246",
    "end": "51551"
  },
  {
    "text": "describes the entire story\nof forward and reverse mode. But in a way, I feel like it\nhides more than it reveals.",
    "start": "51551",
    "end": "59926"
  },
  {
    "text": "And the story is-- in some sense, the entire\nstory can be reduced to that.",
    "start": "59926",
    "end": "66533"
  },
  {
    "text": "But I feel like that's not\nenough to fully understand. And so I put together this\nexample that I used in my class",
    "start": "66533",
    "end": "75008"
  },
  {
    "text": "last semester. And I'm just going\nto pull it all out. I'm just going to grab a\nsimple example from calculus",
    "start": "75008",
    "end": "81681"
  },
  {
    "text": "and show you what's\nreally going on. And so I want to take\nthis simple example.",
    "start": "81681",
    "end": "88822"
  },
  {
    "text": "There's nothing\nspecial about it. I just randomly came\nup with it, where I'm going to just\ninput an x and a y.",
    "start": "88822",
    "end": "98865"
  },
  {
    "text": "And I'm going to have\nthree lines of code. So to speak, where\nthree computations",
    "start": "98865",
    "end": "103870"
  },
  {
    "text": "that are going to happen. I'm going to take\na to be sine x--",
    "start": "103870",
    "end": "108975"
  },
  {
    "text": "no reason whatsoever. I'm going to take to b\nto the a, divided by y. And then I like\nx and y going in,",
    "start": "108975",
    "end": "118551"
  },
  {
    "text": "and z, being the last letter,\nbeing the final output. So z, I'll have it be b plus x.",
    "start": "118551",
    "end": "124190"
  },
  {
    "text": "You could see how that kind of\nlooks like a computer program. It feels more like\na computer program",
    "start": "124190",
    "end": "130830"
  },
  {
    "text": "than mathematics, where\nyou're writing an equality. It looks like a\nsequence of steps,",
    "start": "130830",
    "end": "137036"
  },
  {
    "text": "where at every\nstep, you at least-- you have the variables\nthat came before.",
    "start": "137036",
    "end": "142742"
  },
  {
    "text": "What is a computer\nprogram in the end? It's a formula, where\non the right-hand side,",
    "start": "142742",
    "end": "148014"
  },
  {
    "text": "you know the value\nof everything. And so on the left-hand side,\nyou can define the thing. That's what a computer\nprogram basically is.",
    "start": "148014",
    "end": "157490"
  },
  {
    "text": "And one could have\na problem, like one could create this problem, which\nis, say, find the derivatives.",
    "start": "157490",
    "end": "164530"
  },
  {
    "text": "Like find dz, dx,\nor find dz, dy.",
    "start": "164531",
    "end": "171838"
  },
  {
    "text": " And this is pretty simple. You all know how to do it.",
    "start": "171838",
    "end": "178411"
  },
  {
    "text": "Let's just-- let's just\nstart with the basics.",
    "start": "178411",
    "end": "185318"
  },
  {
    "text": "So how might we do this? Well, let's see. So z is b plus x.",
    "start": "185318",
    "end": "191891"
  },
  {
    "text": "Let's just figure out\nwhat's going on here. B is a over y. So this is a over y plus x.",
    "start": "191891",
    "end": "198031"
  },
  {
    "text": "Because you want to\nget everything in terms of the x's and y's. A is sine x.",
    "start": "198031",
    "end": "203069"
  },
  {
    "text": "So we have sine\nx over y, plus x.",
    "start": "203069",
    "end": "208341"
  },
  {
    "text": "And then, now that we have\neverything in terms of x and y's-- we're all\nvery good at this--",
    "start": "208341",
    "end": "213613"
  },
  {
    "text": "dz, bx, of course-- the actual answer is\ncosine x over y, plus 1.",
    "start": "213613",
    "end": "222722"
  },
  {
    "text": "And then dz, by is-- what is it? It's a minus sine\nx over y squared.",
    "start": "222722",
    "end": "229963"
  },
  {
    "text": " No controversy to this. All simple stuff.",
    "start": "229963",
    "end": "236469"
  },
  {
    "text": "If my colleagues caught me doing\nthis to you advanced students, they would make fun of me.",
    "start": "236469",
    "end": "241874"
  },
  {
    "text": "This is just baby stuff. But let's establish\na little bit-- let's take a good look\nat what we just did.",
    "start": "241874",
    "end": "249382"
  },
  {
    "text": "Let's take a close look\nat this sort of thing. And let me introduce\na computational graph.",
    "start": "249382",
    "end": "257624"
  },
  {
    "text": "Let me try to draw a picture\nof the computation we just did with a computational graph.",
    "start": "257624",
    "end": "264597"
  },
  {
    "text": "So let's write that-- computational graph. ",
    "start": "264597",
    "end": "274307"
  },
  {
    "text": "And by the way, these\nnotes are online. I'll put a pointer up. It's a terrible\nhandwritten version.",
    "start": "274307",
    "end": "279544"
  },
  {
    "text": "One day I'll type\nthis up better. But we'll have a\ncomputational graph. The graph will be a DAG, if\nyou know what that word means--",
    "start": "279545",
    "end": "287020"
  },
  {
    "text": "Directed Acyclic\nGraph, which basically means that there are arrows\non all the edges and there",
    "start": "287020",
    "end": "292859"
  },
  {
    "text": "are no cycles. That's what a\ncomputer program is. It's how do you\nbuild a next variable",
    "start": "292859",
    "end": "299766"
  },
  {
    "text": "from a previous variable. And if you ever look\nleftward, all the data is available to you so that\nyou don't get an error.",
    "start": "299766",
    "end": "307273"
  },
  {
    "text": "And so I like to-- people\nare not completely standard as to how they draw\ncomputational graphs. It drives me crazy.",
    "start": "307273",
    "end": "313379"
  },
  {
    "text": "I'm going to take the\nconvention that I'm going to put the variables at--\nthe variable names as nodes.",
    "start": "313379",
    "end": "319751"
  },
  {
    "text": "So my input nodes are x and y. And let's see, if I look\nat step one over there,",
    "start": "319752",
    "end": "326693"
  },
  {
    "text": "the first thing I'm\ngoing to calculate is a. So that's going to be\na vertex or a node.",
    "start": "326693",
    "end": "333032"
  },
  {
    "text": "And while I'm at it, I'm going\nto draw this arrow right here.",
    "start": "333032",
    "end": "342475"
  },
  {
    "text": "And what I'm going to put\non that arrow is not--",
    "start": "342475",
    "end": "347714"
  },
  {
    "text": "I'm not going to put the-- you could draw the\ncomputation, the sine, but what I'm going\nto do is actually",
    "start": "347714",
    "end": "354120"
  },
  {
    "text": "put the derivative on the arrow. And so I'm going--\non the arrow, I'm going to put the\nfunction, cosine x.",
    "start": "354120",
    "end": "361060"
  },
  {
    "text": "So the derivative of-- oh, it's just this. The derivative--\nthe way to read this",
    "start": "361060",
    "end": "367834"
  },
  {
    "text": "is the derivative\nof a with respect to x is what's on this arrow. So this is ba, bx.",
    "start": "367834",
    "end": "375041"
  },
  {
    "text": "So let's go another step. B is a over y. So I think you've got the idea\nnow that b going to be my node.",
    "start": "375041",
    "end": "384917"
  },
  {
    "text": "And I'm going to\ncalculate db, da.",
    "start": "384917",
    "end": "390089"
  },
  {
    "text": "What is db, da? What should I put\nhere as the function?",
    "start": "390089",
    "end": "396294"
  },
  {
    "text": "I want db, da. I want the derivative-- I always want the\none-step derivative between this variable\nand this variable.",
    "start": "396295",
    "end": "401968"
  },
  {
    "text": "So I want the-- if I\nvary a little bit, what do I multiply by? What's db, da?",
    "start": "401968",
    "end": "408707"
  },
  {
    "text": "STUDENT: [INAUDIBLE] PROFESSOR: 1 over y-- good. Right. That's just-- I\nstarted with a over y, and I think we're\ngoing to switch to a.",
    "start": "408707",
    "end": "414580"
  },
  {
    "text": "So that's 1 over y. Good. But we also have a db, dy.",
    "start": "414580",
    "end": "420453"
  },
  {
    "text": "So let's put an arrow like that. And what's db, dy? Again, simple questions, but\ngot to keep you guys awake,",
    "start": "420453",
    "end": "426692"
  },
  {
    "text": "keep me awake. What's db, dy? STUDENT: Negative\na over y squared.",
    "start": "426692",
    "end": "433399"
  },
  {
    "text": "PROFESSOR: Negative\na over y squared. Good. And finally, we have a z.",
    "start": "433399",
    "end": "440306"
  },
  {
    "text": "And z depends on b. And it also depends on f.",
    "start": "440306",
    "end": "446012"
  },
  {
    "text": "So we have a dependence\nthat goes back to the beginning with z. And so let's see, what\nare dz, db, and dz, bx?",
    "start": "446012",
    "end": "454654"
  },
  {
    "text": "They're kind of the\nsame answer to both. What's dz, db,\nand what's dz, bx?",
    "start": "454654",
    "end": "461260"
  },
  {
    "text": " Come on, first grade\nquestion, really.",
    "start": "461260",
    "end": "468867"
  },
  {
    "text": "STUDENT: 1? PROFESSOR: Right,\nthey're both 1. Dz, db is 1. Db, zx is one. Because z is just b plus x.",
    "start": "468868",
    "end": "475775"
  },
  {
    "text": "So derivatives on the edges-- you get the point\nthat the derivative is labeled on the edges.",
    "start": "475775",
    "end": "481914"
  },
  {
    "text": "Derivatives on edges, just\nto write that down for you. And it's just--",
    "start": "481914",
    "end": "489856"
  },
  {
    "text": "I like to think of this\nas a one-step derivative. So it's like-- it's a\nderivative of one line of code,",
    "start": "489856",
    "end": "496962"
  },
  {
    "text": "if you like. I'm not putting in the-- I'm not putting in the\nfull long-range derivative.",
    "start": "496963",
    "end": "504203"
  },
  {
    "text": "I'm just putting in the\none-step derivative. So in other words, I'm\nnot putting in this thing,",
    "start": "504203",
    "end": "512211"
  },
  {
    "text": "which is the full derivative. It's just the one step\nthat I'm putting in.",
    "start": "512211",
    "end": "519184"
  },
  {
    "text": "I wanted to put on the\ngraph what we just did to--",
    "start": "519184",
    "end": "525725"
  },
  {
    "text": "well, let's get the answer now. So I claim that one way\nto get the actual answer",
    "start": "525725",
    "end": "533532"
  },
  {
    "text": "is to think of it graphically,\nthat you could start over here,",
    "start": "533533",
    "end": "538871"
  },
  {
    "text": "at x, and we want to head to z. And we're going to\nlook at all the paths",
    "start": "538871",
    "end": "544710"
  },
  {
    "text": "that will take us from x to z. There's one path\nthat goes like this.",
    "start": "544710",
    "end": "550550"
  },
  {
    "text": "And then there's another\npath that goes like this. So there's two paths\nthat'll take us from x to z.",
    "start": "550550",
    "end": "557256"
  },
  {
    "text": " And what I'd like to do is,\nbasically, walk along the path",
    "start": "557256",
    "end": "566866"
  },
  {
    "text": "and then write down the\nderivative I see as I go. And I'm going to write it-- I'm going to write\nit right to left.",
    "start": "566866",
    "end": "573172"
  },
  {
    "text": "So let me start walking\nfrom x to a along this path. When I go from x to a,\nI pick up a cosine x.",
    "start": "573172",
    "end": "581781"
  },
  {
    "text": "So this is step one. I pick up a cosine x. Then I have to step\nover from a to b.",
    "start": "581781",
    "end": "588588"
  },
  {
    "text": "So I pick up 1 over y. So that's my step two.",
    "start": "588588",
    "end": "594727"
  },
  {
    "text": "And then finally, when I go from\nb to z, I have a factor of 1. So that's my step three.",
    "start": "594727",
    "end": "603134"
  },
  {
    "text": "I have another path\nI have to cross. I have to take all\npossible paths. So my next path is the\none that goes from x to z.",
    "start": "603135",
    "end": "610776"
  },
  {
    "text": "And so I add the 1 over here. There's only one step to that.",
    "start": "610776",
    "end": "616915"
  },
  {
    "text": "And so that's the\nanswer, actually--",
    "start": "616916",
    "end": "623222"
  },
  {
    "text": "1 over y cosine x plus 1 is\nthe answer for derivative z with respect to x.",
    "start": "623222",
    "end": "628894"
  },
  {
    "text": "So you can view it in that\nway as all possible paths, from input to output. And then just\nmultiply as you go.",
    "start": "628894",
    "end": "636068"
  },
  {
    "text": "And, of course, with\nscalars, I could have multiplied in any order. But you can imagine--",
    "start": "636068",
    "end": "641107"
  },
  {
    "text": "I hope you can understand why\nI went from right to left. I didn't really need\nit for this problem. But I wanted to set up a good\nplan for when these are not",
    "start": "641107",
    "end": "649015"
  },
  {
    "text": "scalars, but these are vectors\nor matrix valued functions. And then the order matters.",
    "start": "649015",
    "end": "655021"
  },
  {
    "text": "And so the matrix multiply\nhas to go from right to left. In this case, it\nwouldn't have mattered.",
    "start": "655021",
    "end": "661160"
  },
  {
    "text": "So this is the correct\nanswer for db, zx. ",
    "start": "661160",
    "end": "667299"
  },
  {
    "text": "And dz, dy, similarly-- ",
    "start": "667299",
    "end": "673706"
  },
  {
    "text": "at the first step, we have\nminus a over y squared. That's step one. Step two is to multiply that by\n1, which doesn't do anything.",
    "start": "673706",
    "end": "681647"
  },
  {
    "text": "And you see, the answer is-- ",
    "start": "681647",
    "end": "687053"
  },
  {
    "text": "what is the answer? The answer is minus-- minus a over y squared,\nwhich you could substitute.",
    "start": "687053",
    "end": "694460"
  },
  {
    "text": "The computer wouldn't care. If the computer-- the\ncomputer has the value of a.",
    "start": "694460",
    "end": "699665"
  },
  {
    "text": "And a is sine x. But you might like to\nsee it in that format.",
    "start": "699665",
    "end": "705571"
  },
  {
    "text": "So this is forward mode,\nautomatic differentiation.",
    "start": "705571",
    "end": "710810"
  },
  {
    "text": "This is basically what was\ngoing on in the algorithm that I just showed you with\nthe Babylonian algorithm.",
    "start": "710810",
    "end": "716882"
  },
  {
    "text": "This is maybe the better\nway to look at it, where what's happening is as you\ntraverse through the computer",
    "start": "716882",
    "end": "724957"
  },
  {
    "text": "program, in that\norder, you can actually calculate each of these\nthings in order as well.",
    "start": "724957",
    "end": "733165"
  },
  {
    "text": "And, thereby, you can actually\naccumulate the derivatives as you go. So this is the forward mode\nview of differentiations.",
    "start": "733165",
    "end": "742208"
  },
  {
    "text": "And like I said, there's\nnothing magic about everything being a scalar here. Every one of these\ncould be a function,",
    "start": "742208",
    "end": "748748"
  },
  {
    "text": "like you've seen in this class. For example, it could have\nbeen that x was a matrix",
    "start": "748748",
    "end": "754019"
  },
  {
    "text": "and a was the square function\nor the inverse function of a matrix. This could have\nbeen a determinant",
    "start": "754019",
    "end": "763462"
  },
  {
    "text": "or this could have\nbeen a matrix and this could have been a determinant. And then in this case,\nyou've got the gradient",
    "start": "763462",
    "end": "768667"
  },
  {
    "text": "of the determinant, with respect\nto the matrix, the very thing I showed you earlier,\nwith the aggregate.",
    "start": "768667",
    "end": "774540"
  },
  {
    "text": "So the only thing that's\nrequired is the associativity. ",
    "start": "774540",
    "end": "781013"
  },
  {
    "text": "And the only thing\nthat matters is that if you ever\nbring things together,",
    "start": "781013",
    "end": "787019"
  },
  {
    "text": "you have to add the answers. So you can imagine\na computer program where there's all\nsorts of arrows",
    "start": "787019",
    "end": "792491"
  },
  {
    "text": "coming from left to right. And as long as more\nthan one arrow comes in, you just add the answers.",
    "start": "792491",
    "end": "798397"
  },
  {
    "text": "Because that's how\nderivatives work. So that's forward mode\nof differentiation.",
    "start": "798397",
    "end": "804602"
  },
  {
    "start": "804603",
    "end": "810176"
  },
  {
    "text": "There is a backward mode where\nyou follow the paths backwards.",
    "start": "810176",
    "end": "819351"
  },
  {
    "text": "So when you follow\nit backwards-- ",
    "start": "819351",
    "end": "826292"
  },
  {
    "text": "so let me just see. Here's where-- OK, I'm\nnot going to transpose it.",
    "start": "826292",
    "end": "834366"
  },
  {
    "text": "Here's where I'm\nactually using-- I'm going to use the fact\nthat it's scalars now. So this whole calculation I\njust showed you was forward.",
    "start": "834366",
    "end": "842675"
  },
  {
    "text": "So this and this\nis forward mode. I'm going to reverse\nmodes to scalars.",
    "start": "842675",
    "end": "848113"
  },
  {
    "text": "When we get to matrices, we\nmight have to transpose things. But let me just show you\nreverse mode for scalars just",
    "start": "848113",
    "end": "855421"
  },
  {
    "text": "to get that correct. ",
    "start": "855421",
    "end": "863095"
  },
  {
    "text": "So reverse mode\nfor scalars says, OK, let's start not\non the left end,",
    "start": "863095",
    "end": "872104"
  },
  {
    "text": "but let's start\non the right end. And you might\nremember a week ago,",
    "start": "872104",
    "end": "877643"
  },
  {
    "text": "I said when had\nsine of x squared--",
    "start": "877643",
    "end": "883115"
  },
  {
    "text": "how many of you-- I asked the question,\nhow many of you would-- the derivative would be the\ncosine of x squared times 2x, and how many would\nhave said 2x times",
    "start": "883115",
    "end": "889822"
  },
  {
    "text": "the cosine of x squared? It's a matter of going\ninside out or outside in. And you can go either way.",
    "start": "889822",
    "end": "895261"
  },
  {
    "text": "So for the reverse\nmode, what we're going to do is we're\ngoing to follow",
    "start": "895261",
    "end": "902301"
  },
  {
    "text": "our way from the z to the x. And, of course, there's\ntwo ways to do that. And if you do that--",
    "start": "902301",
    "end": "909742"
  },
  {
    "text": "I'm going to, again, write\nit from right to left. I'm going to start-- I'll take that first--\nthat horizontal path.",
    "start": "909742",
    "end": "916181"
  },
  {
    "text": "And I'm just going to go-- I'm going to write down the\none, as the first thing I do. And then the second\nthing I'm going to do",
    "start": "916181",
    "end": "922755"
  },
  {
    "text": "is write down the 1 over y. And then the third\nthing I'm going to do is write down the cosine x.",
    "start": "922755",
    "end": "929862"
  },
  {
    "text": "But every time, when\nI go right to left, when the path splits like\nthat, I also have to add it.",
    "start": "929862",
    "end": "935601"
  },
  {
    "text": "So I'm also going to\nhave to add a 1 as well.",
    "start": "935601",
    "end": "942942"
  },
  {
    "text": "And I'll do that on the--  I don't know when\nyou're going to do that,",
    "start": "942942",
    "end": "949048"
  },
  {
    "text": "but I'll just say you can\ndo that on step one as well. And so that's-- and here,\nagain, you're going to do the 1",
    "start": "949048",
    "end": "956956"
  },
  {
    "text": "on the first step. And the minus a over\ny squared we're now going to do in the second step.",
    "start": "956956",
    "end": "962727"
  },
  {
    "text": "And either way, we're going to\nget the solution to dz, bx dz, by. ",
    "start": "962728",
    "end": "970269"
  },
  {
    "text": "And in a sense, every\ncalculation in the world can be looked at as a DAG.",
    "start": "970269",
    "end": "976141"
  },
  {
    "text": "And it could be looked\nat as operations. And you could think of it\nas basically following paths",
    "start": "976141",
    "end": "982314"
  },
  {
    "text": "like this. ",
    "start": "982314",
    "end": "987486"
  },
  {
    "text": "So to emphasize\nthis, in a way, you",
    "start": "987486",
    "end": "993625"
  },
  {
    "text": "can embed all this in matrices,\nbut I feel like it hides.",
    "start": "993625",
    "end": "999198"
  },
  {
    "text": "Without seeing the\ngraph structure, you don't really get\nthe full feel, I think, of what-- oh, yes?",
    "start": "999198",
    "end": "1004737"
  },
  {
    "text": "STUDENT: I was\nwondering, I don't know if you're recording\nthe [INAUDIBLE].. PROFESSOR: Oh, my gosh.",
    "start": "1004737",
    "end": "1010743"
  },
  {
    "text": "I don't know-- yeah, good point. I forgot to put on the mic.",
    "start": "1010743",
    "end": "1016648"
  },
  {
    "text": "Thank you for catching that. I don't know how well it\nwill work, probably badly.",
    "start": "1016648",
    "end": "1022121"
  },
  {
    "text": "Were you able to\nhear me, Stephen? Maybe the Zoom\nrecording is not so bad. AUDIENCE: I can hear you. PROFESSOR: So we\nactually have a backup",
    "start": "1022121",
    "end": "1028359"
  },
  {
    "text": "if we know how to splice it in. But I'm going to put it on now. Thank you for catching that.",
    "start": "1028359",
    "end": "1034800"
  },
  {
    "text": "Any questions about\nnon-technical stuff, but forward and reverse-- not the audio visual stuff?",
    "start": "1034800",
    "end": "1041139"
  },
  {
    "start": "1041140",
    "end": "1056422"
  },
  {
    "text": "So let's delve in a little\nbit about how does one think about this. So there's a graph theory\nway and an implementation way",
    "start": "1056422",
    "end": "1064129"
  },
  {
    "text": "of thinking about\nthis a little bit. So the graph theory way\nof thinking about this is to think about the fact\nthat what we want to do",
    "start": "1064129",
    "end": "1073505"
  },
  {
    "text": "is really calculate the sum\nof all the path products from inputs to outputs.",
    "start": "1073505",
    "end": "1078510"
  },
  {
    "text": "So I just gave you a term. I'm going to define\na path product.",
    "start": "1078510",
    "end": "1084716"
  },
  {
    "text": " I'll define it loosely.",
    "start": "1084716",
    "end": "1090622"
  },
  {
    "text": "I hope this will be good enough. The path product will be the\nproduct of the edge weights. ",
    "start": "1090622",
    "end": "1102801"
  },
  {
    "text": "The product has to\nbe in the right order if it's associative,\nbut not commutative. But product of edge weights\nas you traverse a path.",
    "start": "1102801",
    "end": "1110342"
  },
  {
    "start": "1110342",
    "end": "1117316"
  },
  {
    "text": "So the path products\nare-- so cosine x over y is one path product,\nwith that length 3 path.",
    "start": "1117316",
    "end": "1124923"
  },
  {
    "text": "One is just that length 1 path. And so those are the\ntwo path products.",
    "start": "1124923",
    "end": "1130528"
  },
  {
    "text": "And then what\nwe're interested in is, one way or\nanother, calculating the sum of path products\nfrom inputs to outputs.",
    "start": "1130529",
    "end": "1140572"
  },
  {
    "start": "1140572",
    "end": "1148614"
  },
  {
    "text": "That's kind of the real\ngoal of doing that. And it doesn't really\nmatter whether you",
    "start": "1148614",
    "end": "1155220"
  },
  {
    "text": "go from the end of the path and\nmove your way to the other end, or if you start at the beginning\nof the path and go to the end.",
    "start": "1155220",
    "end": "1162761"
  },
  {
    "text": "And so when you\nsee it that way, I think reverse mode and forward\nmode don't seem so mysterious.",
    "start": "1162761",
    "end": "1168500"
  },
  {
    "text": "I think it's pretty clear,\nif you stand back here, the world doesn't care if\nyou go cosine x times 1 over y, times 1, or if you go 1\ntimes 1 over y, times cosine x.",
    "start": "1168500",
    "end": "1177309"
  },
  {
    "text": "And the only issue is\nif these were matrices, how would you do it? But I think you all get the\nidea that if the path products--",
    "start": "1177309",
    "end": "1186785"
  },
  {
    "text": "like, if this was A, B,\nand C-- if these were-- I'm using capital letters\nto have matrices--",
    "start": "1186785",
    "end": "1192157"
  },
  {
    "text": "then the world\ndoesn't really care if you were to calculate--\nif you traverse this way, and you saw the A first.",
    "start": "1192157",
    "end": "1198230"
  },
  {
    "text": "And then when you multiply by\nB, and then you see the C last, or if you went backwards,\nand you pick up the C first,",
    "start": "1198230",
    "end": "1205804"
  },
  {
    "text": "and you then multiply\nby B on the left, and then finally, A on the left. As long as you have an\nassociative system, right",
    "start": "1205804",
    "end": "1214479"
  },
  {
    "text": "it doesn't matter which way\nyou do those multiplies. So as long as you can\ntraverse the paths, either from forward to\nback, or back to forward.",
    "start": "1214479",
    "end": "1221820"
  },
  {
    "text": "Or by the way, you can-- not that this happens very much,\nbut you could even traverse paths from the middle outward.",
    "start": "1221820",
    "end": "1229094"
  },
  {
    "text": "And as long as you put the\nright things in the right order, there's no rule of\nthe universe that says you have to go from the\nbeginning to the end or the end",
    "start": "1229094",
    "end": "1236335"
  },
  {
    "text": "to the beginning, or you\ncan't go middle outward. The beauty of\nassociativity is these path",
    "start": "1236335",
    "end": "1241740"
  },
  {
    "text": "products will work just\nany which way you do it. So that's one way to look at\nautomatic differentiation,",
    "start": "1241740",
    "end": "1252050"
  },
  {
    "text": "both forward and reverse,\nis to think of it in terms of these\npath products that really don't care how you go.",
    "start": "1252050",
    "end": "1258289"
  },
  {
    "text": "Now as far as implementations\nare concerned-- so one thing I'll\ndo is I'll move",
    "start": "1258290",
    "end": "1263428"
  },
  {
    "text": "the laptop over a little bit\nso that Stephen has a chance of seeing what we're doing.",
    "start": "1263428",
    "end": "1269034"
  },
  {
    "text": "It might be a weird angle. But you know what, let's\ndo a little better. Let's move the whole\nlaptop so Stephen",
    "start": "1269034",
    "end": "1274906"
  },
  {
    "text": "can see it a little bit better\nif I use these boards here. ",
    "start": "1274906",
    "end": "1285150"
  },
  {
    "text": "So let's-- so let's take a\nlittle bit of a closer view",
    "start": "1285150",
    "end": "1293759"
  },
  {
    "text": "of implementation of forward\nmode now that we have this understanding of what it\nis we're trying to do.",
    "start": "1293759",
    "end": "1301333"
  },
  {
    "text": "So how would we\nimplement this thing? ",
    "start": "1301333",
    "end": "1312444"
  },
  {
    "text": "So how are we going to do this? Well, let me focus on\nbeing in the middle.",
    "start": "1312444",
    "end": "1320052"
  },
  {
    "text": "So suppose we have a lot\nof stuff have happened. I don't know what's going on. And we're at the point\nin time where we're here,",
    "start": "1320052",
    "end": "1329594"
  },
  {
    "text": "and what we want to do-- let me call this-- I'll call this x.",
    "start": "1329594",
    "end": "1335200"
  },
  {
    "text": "Just it's not an input\nat the beginning. It's just x is\nsomewhere in the middle.",
    "start": "1335200",
    "end": "1341907"
  },
  {
    "text": "And we're going to\ncalculate an output. We're going to calculate f of x. And so whatever\ncomes in here, we're",
    "start": "1341907",
    "end": "1352417"
  },
  {
    "text": "going to somehow have it go-- we're taking a path product.",
    "start": "1352417",
    "end": "1360392"
  },
  {
    "text": "And so we've come up to here. And if you just kind think-- I don't know, is this\nrecursive thinking?",
    "start": "1360392",
    "end": "1366765"
  },
  {
    "text": "Or is this just how one should\nthink about any computer program? But one way or another,\nyou've gotten to here.",
    "start": "1366765",
    "end": "1374373"
  },
  {
    "text": "And you have the path\nproduct up until here. So we start out, like maybe we\ncall it an inductive hypothesis",
    "start": "1374373",
    "end": "1381413"
  },
  {
    "text": "or whatever you'd like to say. We know the path\nproduct up to here. So if I knew the path\nproduct up to here,",
    "start": "1381413",
    "end": "1387819"
  },
  {
    "text": "and I going forward mode,\nwhat's the next path product?",
    "start": "1387819",
    "end": "1393357"
  },
  {
    "text": "Suppose I know\nthis path product. Let's call it P for product. What's the path product here?",
    "start": "1393358",
    "end": "1399264"
  },
  {
    "text": " STUDENT: [INAUDIBLE] PROFESSOR: Exactly.",
    "start": "1399264",
    "end": "1405003"
  },
  {
    "text": "It's just-- what is it the that? STUDENT: F prime. PROFESSOR: Right, f prime,\ntimes the previous-- exactly.",
    "start": "1405003",
    "end": "1411042"
  },
  {
    "text": "So one way or another, I\nneed a data structure that-- ",
    "start": "1411042",
    "end": "1417949"
  },
  {
    "text": "I need a data structure that\nwill take the value here",
    "start": "1417949",
    "end": "1422987"
  },
  {
    "text": "and the path product-- the path product,\nand it'll give me--",
    "start": "1422988",
    "end": "1429728"
  },
  {
    "text": " it'll give me f of the\nvalue if I want to run--",
    "start": "1429728",
    "end": "1437402"
  },
  {
    "text": "if I just want to\nrun the algorithm-- and I need the path\nproduct times f prime. ",
    "start": "1437402",
    "end": "1444643"
  },
  {
    "text": "And I want to multiply\nin this order. And so in some sense, this\nis what the whole dual number",
    "start": "1444643",
    "end": "1452517"
  },
  {
    "text": "system thing is doing. This is another way to\nlook at the dual numbers. So there's lots and lots of\nways to understand what I just",
    "start": "1452517",
    "end": "1458490"
  },
  {
    "text": "showed you with dual numbers. But it's really nothing more\nthan taking your path products",
    "start": "1458490",
    "end": "1464262"
  },
  {
    "text": "with the value. And you could see-- the reason why I'm showing\nyou this way is that",
    "start": "1464262",
    "end": "1470635"
  },
  {
    "text": "if you're executing\na computer program, where you want to--\nliterally, you want--",
    "start": "1470635",
    "end": "1476908"
  },
  {
    "text": "the main thing the computer\nprogram was meant to do is to calculate f of x. And now this additional extra\nthing we want it to do--",
    "start": "1476908",
    "end": "1484182"
  },
  {
    "text": "maybe we're doing gradient\ndescent, and machine learning, or who knows what we're doing. We want the derivative to\nhappen at the same time.",
    "start": "1484182",
    "end": "1491523"
  },
  {
    "text": "Then all we have to do\nis overload our program that was already happy to\ncalculate the f of the value,",
    "start": "1491523",
    "end": "1498630"
  },
  {
    "text": "and then tack along\nthe path product, and append the path product\nwith this extra multiply.",
    "start": "1498630",
    "end": "1506170"
  },
  {
    "text": "And so this is how-- this is one way of looking as\nto how the whole dual number thing is actually working.",
    "start": "1506171",
    "end": "1512544"
  },
  {
    "text": "And so in symbols,\nif I had x, comma, p,",
    "start": "1512544",
    "end": "1517982"
  },
  {
    "text": "then on the next step, I'm going\nto have f of x, and f prime",
    "start": "1517983",
    "end": "1523688"
  },
  {
    "text": "of x, times P. And so that's how\nwe can carry forward this path",
    "start": "1523688",
    "end": "1528726"
  },
  {
    "text": "product idea. ",
    "start": "1528727",
    "end": "1536167"
  },
  {
    "text": "And now let's talk about how\nto start this whole thing. So this was in the middle. How should we start?",
    "start": "1536167",
    "end": "1543408"
  },
  {
    "text": "So x, comma-- what\nshould I put here so that the first step just works?",
    "start": "1543408",
    "end": "1549648"
  },
  {
    "text": "Is it obvious what we\nshould just start with? Or another way to say\nit is, what should be--",
    "start": "1549648",
    "end": "1556855"
  },
  {
    "text": "what should be the path\nproduct of a path of length 0? ",
    "start": "1556855",
    "end": "1563628"
  },
  {
    "text": "Do people ever think\nabout these things? Like, if I asked you what is\nthe sum of the empty vector,",
    "start": "1563628",
    "end": "1569834"
  },
  {
    "text": "and I told you, there's only\none right answer to that, what's the right answer of\nthe sum of an empty vector,",
    "start": "1569834",
    "end": "1576107"
  },
  {
    "text": "a vector of length 0? 0-- it's the identity element. It's the only thing\nthat makes sense.",
    "start": "1576107",
    "end": "1582047"
  },
  {
    "text": "Why? Because you always want the\nsum from I equals 1 to k",
    "start": "1582047",
    "end": "1587252"
  },
  {
    "text": "plus 1 of xi to equal xk\nplus 1, plus the sum from I",
    "start": "1587252",
    "end": "1593825"
  },
  {
    "text": "equals 1 to k. And if you make this work\nfor k equals 0, it's perfect.",
    "start": "1593825",
    "end": "1601232"
  },
  {
    "text": "And what's the empty product? It's 1, right? Determinant of a 0 by 0\nmatrix also should be 1.",
    "start": "1601232",
    "end": "1608173"
  },
  {
    "text": "And then the Laplace\nexpansion works. So what's the empty\npath product then?",
    "start": "1608173",
    "end": "1615013"
  },
  {
    "text": "So how should we--\nin effect, how-- when you sum, if you're\nsumming up a vector,",
    "start": "1615013",
    "end": "1620885"
  },
  {
    "text": "you initialize\nthe variable to 0, and then you start\nadding in numbers. So what's the empty--",
    "start": "1620885",
    "end": "1625991"
  },
  {
    "text": "what's the empty start? 1, exactly. So there are a number of\nways to interpret this.",
    "start": "1625991",
    "end": "1632631"
  },
  {
    "text": "You could think of this\nas the slope being-- but this is not a bad\nway to think about it. Again, you could think\nof it in multiple ways.",
    "start": "1632631",
    "end": "1638570"
  },
  {
    "text": "But you start with x, comma,\n1 to see the operation. And then at every\nstep, you do this.",
    "start": "1638570",
    "end": "1644175"
  },
  {
    "text": "And at the very end,\nyou get the derivatives that you're looking for. So that's forward mode.",
    "start": "1644175",
    "end": "1652183"
  },
  {
    "text": "And it works just great. A quick check, though.",
    "start": "1652183",
    "end": "1657789"
  },
  {
    "text": "Suppose I had f of x\nas a constant, like 2. ",
    "start": "1657789",
    "end": "1664295"
  },
  {
    "text": "And then, so I feed it in x,\ncomma P, what's the output?",
    "start": "1664295",
    "end": "1671236"
  },
  {
    "text": " What are the two numbers\nthat would come out",
    "start": "1671236",
    "end": "1676975"
  },
  {
    "text": "if anywhere in the middle of my\ncalculation, I started with xP and I applied this\nconstant function?",
    "start": "1676975",
    "end": "1683848"
  },
  {
    "text": "2, 0. It doesn't even matter\nwhat the input is. That's right, because\nit's a constant function.",
    "start": "1683848",
    "end": "1688920"
  },
  {
    "text": "It doesn't care. ",
    "start": "1688920",
    "end": "1698129"
  },
  {
    "text": "So this is the one arrow\ncase in forward mode. Maybe it's worthwhile to quickly\ntalk about the multiple arrow",
    "start": "1698129",
    "end": "1709407"
  },
  {
    "text": "case. So for example, suppose I have-- let's say I had ap and bq.",
    "start": "1709407",
    "end": "1716548"
  },
  {
    "text": " And let's say I had\ntwo arrows going in.",
    "start": "1716548",
    "end": "1724656"
  },
  {
    "text": "And I had z is some\nfunction of two variables, like I did over there, maybe the\nsum, or the product, or divide,",
    "start": "1724656",
    "end": "1733465"
  },
  {
    "text": "or any function\nof two variables.",
    "start": "1733465",
    "end": "1739403"
  },
  {
    "text": "So this will be the one\nstep derivative, of course. This will be dz, da.",
    "start": "1739404",
    "end": "1748246"
  },
  {
    "text": "And this will be-- I don't know what the\nbest way to write this is, but dz, da, dz, db is\nprobably as good a way as any.",
    "start": "1748246",
    "end": "1755553"
  },
  {
    "text": "So now I'm not thinking\nof a and b as numbers, but I'm thinking of them\nas symbols for the moment. Or I'm imagining that\none way or another,",
    "start": "1755553",
    "end": "1762961"
  },
  {
    "text": "I know the derivative of this--\nat least one way or another, I know the derivative of\nthis function with respect",
    "start": "1762961",
    "end": "1769601"
  },
  {
    "text": "to this variable somehow. Just to give you a quick\nexample that this is not",
    "start": "1769601",
    "end": "1774906"
  },
  {
    "text": "so complicated. If f was the plus function--\nif this is a plus b,",
    "start": "1774906",
    "end": "1782113"
  },
  {
    "text": "what would I put here and here? Again, simple question.",
    "start": "1782113",
    "end": "1787752"
  },
  {
    "text": "1 and 1. And slightly more\ncomplicated, but not by much, if this was the product\nfunction, a times b,",
    "start": "1787752",
    "end": "1796427"
  },
  {
    "text": "what would I put here and\nwhat would I put here? STUDENT: [INAUDIBLE] PROFESSOR: Say that again.",
    "start": "1796427",
    "end": "1802100"
  },
  {
    "text": "STUDENT: B and a? B and a, perfect. So the point is for\nlots of basic functions,",
    "start": "1802100",
    "end": "1807404"
  },
  {
    "text": "it's very easy to\nknow what to put here. And so you've got these\nmultiple arrows going in.",
    "start": "1807405",
    "end": "1816714"
  },
  {
    "text": "And-- yeah, you have\nthese multiple arrows in,",
    "start": "1816714",
    "end": "1821853"
  },
  {
    "text": "and, of course, what\nwe're just going to do is we're just going\nto add the results. And so did I write it out?",
    "start": "1821853",
    "end": "1828293"
  },
  {
    "text": "In effect, yes. So let me just say that if\nthis goes in, what we really want to come out is the z, which\nis, of course, f of a and b.",
    "start": "1828293",
    "end": "1838002"
  },
  {
    "text": "And then what we want to do\nis to continue the paths--",
    "start": "1838002",
    "end": "1847044"
  },
  {
    "text": "let's see, we had-- did I write this correctly?",
    "start": "1847045",
    "end": "1853551"
  },
  {
    "text": "Let me get this right. So let's see.",
    "start": "1853551",
    "end": "1859023"
  },
  {
    "text": "So if I started with this,\nthen what-- oh, yeah,",
    "start": "1859023",
    "end": "1864795"
  },
  {
    "text": "what I have to do is take-- is this right? I have to take P-- yeah, p times dz,\nza, plus q times--",
    "start": "1864796",
    "end": "1874572"
  },
  {
    "text": "yeah, that's right-- dz, db. And that's the right thing\nto do to carry forward",
    "start": "1874572",
    "end": "1880477"
  },
  {
    "text": "the derivative. And so this is the-- because this is exactly what the\nderivative would be over here.",
    "start": "1880478",
    "end": "1888453"
  },
  {
    "text": "Or if you like, you\ncould just think of this as combining the paths,\nthe path products.",
    "start": "1888453",
    "end": "1895593"
  },
  {
    "text": "So you could think of this\nfrom a calculus point of view, that the derivative-- so the calculus viewpoint\nis that the derivative",
    "start": "1895593",
    "end": "1904369"
  },
  {
    "text": "of this, with respect to that,\nplus the derivative of this, either the first variable,\nthen times the second variable.",
    "start": "1904369",
    "end": "1909974"
  },
  {
    "text": "But the pathway, which I\nthink is almost easier to-- it all depends on whether you\nlike to think calculus first",
    "start": "1909974",
    "end": "1915914"
  },
  {
    "text": "or you like to\nthink paths first. But it's really\njust different words for what in mathematics\nis the same thing,",
    "start": "1915914",
    "end": "1921819"
  },
  {
    "text": "that we're taking this path\nproduct and this path product. And the rule is\nthat anytime things",
    "start": "1921819",
    "end": "1927759"
  },
  {
    "text": "come together, just like\nthe one you saw here, you just add them. OK, well, I've run out of time.",
    "start": "1927759",
    "end": "1933998"
  },
  {
    "text": "I've got a whole bunch of\nmore notes on reverse mode, on how do you do the same\nthing with reverse mode.",
    "start": "1933998",
    "end": "1940405"
  },
  {
    "text": "But I don't know whether-- I'm not going to see you\nbefore next week today. So you might see\nsome version of this",
    "start": "1940405",
    "end": "1947245"
  },
  {
    "text": "from Chris, or from Gaurav,\nor maybe from Stephen. Or otherwise, I'll\ngive you my own version",
    "start": "1947245",
    "end": "1954218"
  },
  {
    "text": "anyway by the end next week. All right, so I'll wish\nyou all a good weekend.",
    "start": "1954218",
    "end": "1959490"
  },
  {
    "text": "And you'll be in\ngood hands next week.",
    "start": "1959490",
    "end": "1963528"
  }
]