[
  {
    "text": "[SQUEAKING] [RUSTLING] [CLICKING]",
    "start": "0",
    "end": "6776"
  },
  {
    "text": " DAVID PERREAULT: OK. Thank you. Let's talk about control\na little bit more.",
    "start": "6776",
    "end": "16049"
  },
  {
    "text": "What I wanted to do today was\na little bit of an example just to illustrate\nthe trade-offs",
    "start": "16050",
    "end": "23759"
  },
  {
    "text": "and what you need to do\nto think about a control design for a general converter. ",
    "start": "23760",
    "end": "30720"
  },
  {
    "text": "And the example I'm going to do\nis very, very garden variety.",
    "start": "30720",
    "end": "36260"
  },
  {
    "text": "It's not very-- it's not very\nextreme in any dimension, So let's think about\nour boost converter",
    "start": "36260",
    "end": "44379"
  },
  {
    "text": "where I have some input voltage\nu, an inductor, a switch,",
    "start": "44380",
    "end": "54380"
  },
  {
    "text": "modulating with q of t, a\ndiode, an output capacitor C,",
    "start": "54380",
    "end": "59780"
  },
  {
    "text": "and a resistive load with\nthe output voltage on it.",
    "start": "59780",
    "end": "64988"
  },
  {
    "text": "And the parameters\nI chose for this are very, very simple,\nnot aggressive.",
    "start": "64988",
    "end": "73160"
  },
  {
    "text": "L is 10 microhenries. C is 50 microfarads.",
    "start": "73160",
    "end": "78746"
  },
  {
    "text": " The switching frequency\nis 100 kilohertz.",
    "start": "78746",
    "end": "84860"
  },
  {
    "text": "Pretty low. The output reference\nthat we're going to try to make this go to\nvia ref is equal to 24 volts.",
    "start": "84860",
    "end": "94590"
  },
  {
    "text": "And we said some designs,\nthat output might move around. The reference that you want to\nprogram it to might move around.",
    "start": "94590",
    "end": "100850"
  },
  {
    "text": "Here, I'm just going\nto pretend it's fixed that's about the simplest case. ",
    "start": "100850",
    "end": "106195"
  },
  {
    "text": "And what are the\nthings we said we had to deal with in\nterms of variations",
    "start": "106195",
    "end": "112750"
  },
  {
    "text": "in a practical converter? Well, one of them is\nthe input voltage. My input voltage might not\nalways be what I wanted to.",
    "start": "112750",
    "end": "119840"
  },
  {
    "text": "So we might say the u nominal,\nthe nominal input voltage",
    "start": "119840",
    "end": "125350"
  },
  {
    "text": "might be 9 volts. But we're going to design\nthis for 8 volts less than u",
    "start": "125350",
    "end": "133470"
  },
  {
    "text": "is less than 10 volts. Now that's a variable\nrange, because I want to illustrate to you the\nimpact of a variable input",
    "start": "133470",
    "end": "141660"
  },
  {
    "text": "voltage range, but that's\na pretty narrow range. I mean, many converters,\n2 to 1 is very typical.",
    "start": "141660",
    "end": "148980"
  },
  {
    "text": "4 to 1 sometimes. Depending upon the application,\neven more than that. So I don't want you to\nget the notion that this",
    "start": "148980",
    "end": "154580"
  },
  {
    "text": "is some extreme range. This is actually a\nreally narrow range. The other thing we said\nwe had to deal with",
    "start": "154580",
    "end": "161430"
  },
  {
    "text": "was variations in\nthe load resistor. ",
    "start": "161430",
    "end": "166722"
  },
  {
    "text": "And I'm going to use\na range of 2 ohms-- that's the heaviest load--",
    "start": "166722",
    "end": "171870"
  },
  {
    "text": "less than R is\nless than 10 ohms. And I'm just going to use a pure\nresistive load for simplicity.",
    "start": "171870",
    "end": "178986"
  },
  {
    "text": "So that's about-- this\nis the heavy load case. That's high power for\na given output voltage.",
    "start": "178986",
    "end": "184510"
  },
  {
    "text": "This is low-power case. This is about a\n5-to-1 power range. All right, that's a little\nbit more respectable,",
    "start": "184510",
    "end": "190239"
  },
  {
    "text": "but again, a lot\nof converters have to deal with very\nwide power ranges. And sometimes we bring\nin additional tricks",
    "start": "190240",
    "end": "196500"
  },
  {
    "text": "that I'm not going to\ndiscuss to deal with really the wide load ranges. But you'll get a notion of\nthe impact of load resistance",
    "start": "196500",
    "end": "204270"
  },
  {
    "text": "by the load range. OK All right. So that's going\nto be our example.",
    "start": "204270",
    "end": "211069"
  },
  {
    "text": "Let's step back\nand just remember what we did to model\nall this stuff.",
    "start": "211070",
    "end": "216740"
  },
  {
    "text": "We started off with the\nswitched equations of state.",
    "start": "216740",
    "end": "223210"
  },
  {
    "text": "So I'm just going to\ncopy these down just so we can see the progression. So this is the dIL dt is\nequal to u over L q plus u",
    "start": "223210",
    "end": "239560"
  },
  {
    "text": "minus v over L 1 minus q. And dV dt is equal to\nminus 1 over Rc V plus 1",
    "start": "239560",
    "end": "253570"
  },
  {
    "text": "over C IL minus 1 over\nRC V times 1 minus q.",
    "start": "253570",
    "end": "265480"
  },
  {
    "text": "And I should have\nsaid this is q of t. So in this original\nmodel, all we've done",
    "start": "265480",
    "end": "275110"
  },
  {
    "text": "is said broken this\ndown into two states and use my switching function\nto switch back and forth",
    "start": "275110",
    "end": "280600"
  },
  {
    "text": "between the states. And if I knew initial\nvalues for IL and dV and I knew q of t,\nhow it was modulating,",
    "start": "280600",
    "end": "286930"
  },
  {
    "text": "basically, at least in\ncontinuous conduction mode, I could exactly simulate\nthe actual behavior",
    "start": "286930",
    "end": "293139"
  },
  {
    "text": "of that converter. So if I did something like-- ",
    "start": "293140",
    "end": "303169"
  },
  {
    "text": "if I simulated that\nset of equations and I put a change in\nthe load at some time",
    "start": "303170",
    "end": "308360"
  },
  {
    "text": "and I put in a new R, I could\ncalculate the transient there.",
    "start": "308360",
    "end": "314360"
  },
  {
    "text": "But we said, I don't really\ncare about all this ripple.",
    "start": "314360",
    "end": "319949"
  },
  {
    "text": "I can't do anything about\nthat in my controller, so we want to get rid of that. And the thing we said\nwe were going to do",
    "start": "319950",
    "end": "325670"
  },
  {
    "text": "was apply this notion of\nstate space averaging.",
    "start": "325670",
    "end": "331580"
  },
  {
    "text": "So if we apply an\naveraging to this--",
    "start": "331580",
    "end": "338620"
  },
  {
    "text": "this is x bar is equal to\n1 over t the integral of t minus capital T to\nt of x of tau d tau.",
    "start": "338620",
    "end": "346729"
  },
  {
    "text": "I can do that to\nthe circuit or I can do that to these equations. Either way, I can generate\nan average set of equations.",
    "start": "346730",
    "end": "354430"
  },
  {
    "text": "So I get an average model. ",
    "start": "354430",
    "end": "361250"
  },
  {
    "text": "And in this case,\nit was dIL bar dt is equal to 1 over L u bar\nminus 1 over L V bar d prime.",
    "start": "361250",
    "end": "376380"
  },
  {
    "text": "And dV bar dt is equal to minus\n1 over RC V bar plus 1 over C IL",
    "start": "376380",
    "end": "392610"
  },
  {
    "text": "bar d prime. And so this is our state\nspace averaged model.",
    "start": "392610",
    "end": "399400"
  },
  {
    "text": "I could also generate a state\nspace average circuit which would have the same dynamics.",
    "start": "399400",
    "end": "405645"
  },
  {
    "text": "And that's helpful, Why? Because this thing here doesn't\nhave any switching in it at all.",
    "start": "405645",
    "end": "417350"
  },
  {
    "text": "d is how I'm varying\nduty ratio over time, not the switching function.",
    "start": "417350",
    "end": "422660"
  },
  {
    "text": "It wouldn't have any\nswitching ripple. So in fact, if I\nsimulated this model-- first of all, I apply\nthe averaging, which",
    "start": "422660",
    "end": "430240"
  },
  {
    "text": "kills the switching ripple, and\nI simulate the average model, I will get what we see\nup there, the solid lines",
    "start": "430240",
    "end": "437110"
  },
  {
    "text": "that capture the low-frequency\ndynamics and kill the ripple. And that's pretty nice.",
    "start": "437110",
    "end": "443150"
  },
  {
    "text": " That helps me.",
    "start": "443150",
    "end": "448420"
  },
  {
    "text": "If I thought about\nmy original goal",
    "start": "448420",
    "end": "453520"
  },
  {
    "text": "for building a\ncontrol system, It was along the following lines.",
    "start": "453520",
    "end": "458710"
  },
  {
    "text": "Maybe I have some\nreference voltage V REF. And what I could think about\nfrom a control modeling",
    "start": "458710",
    "end": "466210"
  },
  {
    "text": "point of view is comparing\nthat to the output voltage-- and here, I'll think about the\naverage local average output",
    "start": "466210",
    "end": "473169"
  },
  {
    "text": "voltage. I'll put that into some\ncompensator, which maybe I'll",
    "start": "473170",
    "end": "482820"
  },
  {
    "text": "call GC of s. So this is the error.",
    "start": "482820",
    "end": "489750"
  },
  {
    "text": "Maybe I think about the\nlocal average error. And then I'm going\nto get a duty ratio and then I'm going to\nput that into the model",
    "start": "489750",
    "end": "496530"
  },
  {
    "text": "for the converter. And the converter also has an\ninput u, the input voltage.",
    "start": "496530",
    "end": "503160"
  },
  {
    "text": "And out comes IL\nbar and V bar, which is the thing I want to\ncontrol, and I feed that back.",
    "start": "503160",
    "end": "510600"
  },
  {
    "text": "So I could take this set of\nequations and stick it in here,",
    "start": "510600",
    "end": "519610"
  },
  {
    "text": "and suddenly, I would have a\nmodel for my control system. ",
    "start": "519610",
    "end": "526990"
  },
  {
    "text": "The only fly in that\nointment is the fact that this average\nmodel is nonlinear.",
    "start": "526990",
    "end": "537010"
  },
  {
    "text": "And the nonlinearity really\ncomes in here and here.",
    "start": "537010",
    "end": "543940"
  },
  {
    "text": "Now that doesn't mean I\ncan't build a controller with a nonlinear model. People do that all the time. But a lot of the tools that\nyou have for control design",
    "start": "543940",
    "end": "551620"
  },
  {
    "text": "are based around the\nnotion of a linear system. That's the easiest thing to do. It's the most flexible.",
    "start": "551620",
    "end": "557720"
  },
  {
    "text": "So people generally would\nlike to have a linear model for their system.",
    "start": "557720",
    "end": "563650"
  },
  {
    "text": "AUDIENCE: So it's\nthe duty cycle that introduces the nonlinearity? DAVID PERREAULT: It is the fact\nthat the response of the system",
    "start": "563650",
    "end": "573440"
  },
  {
    "text": "has the product of the\ncompliment of the duty cycle and the voltage and\nthe complement of the duty cycle and the current.",
    "start": "573440",
    "end": "578960"
  },
  {
    "text": "So it's the fact that when\nI modulate duty cycle, I'm doing something that\nmodulates how the inductor",
    "start": "578960",
    "end": "586399"
  },
  {
    "text": "current changes. And that modulation\nis also proportional to the output voltage.",
    "start": "586400",
    "end": "593380"
  },
  {
    "text": "So it's the fact that-- you can see that in\nhere, is basically it comes time to the duty ratio\nand the output voltage effect",
    "start": "593380",
    "end": "600510"
  },
  {
    "text": "how this is coming as a product. ",
    "start": "600510",
    "end": "606380"
  },
  {
    "text": "We don't like that. We want a way around it. So what do we do?",
    "start": "606380",
    "end": "612320"
  },
  {
    "text": "We linearize. And we said, what we\ncan do is we can say, suppose this converter is\noperating at some point,",
    "start": "612320",
    "end": "619160"
  },
  {
    "text": "and all I want to know is\nif I move it a little bit away from that point, how\nwill the response wiggle?",
    "start": "619160",
    "end": "624510"
  },
  {
    "text": "I perturb the input\njust a tiny bit, the perturbation in the\nstates and the output, maybe",
    "start": "624510",
    "end": "630440"
  },
  {
    "text": "that looks close to linear. So we went through our\nlinearization process, which we did last time.",
    "start": "630440",
    "end": "639020"
  },
  {
    "text": "And here's the result we got. Now we're going to talk about--",
    "start": "639020",
    "end": "644149"
  },
  {
    "text": "instead of about\nthe average models, we're going to talk about\nperturbations, things",
    "start": "644150",
    "end": "651589"
  },
  {
    "text": "like IL tilde, which is\nequal to the difference",
    "start": "651590",
    "end": "656840"
  },
  {
    "text": "between the actual local\naverage current in the inductor and the DC current\nin the inductor.",
    "start": "656840",
    "end": "663389"
  },
  {
    "text": "So it's the deviation away\nfrom the steady state. And when we did\nthat, we said, OK,",
    "start": "663390",
    "end": "670573"
  },
  {
    "text": "here's the kind of\nequations I'm going to get. I'm going to get dIL\ntilde dt is equal to 1",
    "start": "670573",
    "end": "678190"
  },
  {
    "text": "over L u tilde minus d\nprime over L V tilde plus V",
    "start": "678190",
    "end": "691120"
  },
  {
    "text": "over L d tilde. And dV tilde dt is\nequal to minus 1",
    "start": "691120",
    "end": "702160"
  },
  {
    "text": "over RC V tilde plus D prime\nover C IL tilde minus IL",
    "start": "702160",
    "end": "712690"
  },
  {
    "text": "over C d tilde. What did I do to get this?",
    "start": "712690",
    "end": "717900"
  },
  {
    "text": "Essentially we took the\nnonlinear differential equations and we did a Taylor\nseries expansion.",
    "start": "717900",
    "end": "723690"
  },
  {
    "text": "We threw out the DC\nterms because we're only looking at variations and\nwe threw out the products",
    "start": "723690",
    "end": "728770"
  },
  {
    "text": "of small variations. So it's only valid\nin a limited range, but surprisingly, especially\nfor switching power converters",
    "start": "728770",
    "end": "736870"
  },
  {
    "text": "where the ripples are\ntriangular, it turns out, you can get pretty far away\nfrom the operating point",
    "start": "736870",
    "end": "743410"
  },
  {
    "text": "and it's still pretty good. So this model is pretty good.",
    "start": "743410",
    "end": "748690"
  },
  {
    "text": "What's important about this\nmodel from our perspective is that I have--",
    "start": "748690",
    "end": "754240"
  },
  {
    "text": "this is a pair of linear\nconstant coefficient differential equations.",
    "start": "754240",
    "end": "760610"
  },
  {
    "text": "And constant\ncoefficient in the sense that these are the\ncoefficients to the variables.",
    "start": "760610",
    "end": "769350"
  },
  {
    "text": "So now my variables\nare all small signal. These are all just constants.",
    "start": "769350",
    "end": "775290"
  },
  {
    "text": "All right. And with this, that's\na linear system. I can take a Laplace transform\nof it, get nice stuff,",
    "start": "775290",
    "end": "782530"
  },
  {
    "text": "I can make transfer\nfunctions, everything else. And the only caveat\nis that notice,",
    "start": "782530",
    "end": "793060"
  },
  {
    "text": "that these constants\nare each-- like if my-- if I decide my DC output\nvoltage changes or, for example,",
    "start": "793060",
    "end": "799360"
  },
  {
    "text": "I operate from a\ndifferent input voltage, I'm going to get a different\nsteady state duty ratio",
    "start": "799360",
    "end": "805000"
  },
  {
    "text": "D, and then, hence,\na different 1 minus D, which is D prime here. So these constants do depend\nupon the load current, the input",
    "start": "805000",
    "end": "817790"
  },
  {
    "text": "voltage, all those things. So I got to think that\nthe solution I get is only for one\npoint, and I've got",
    "start": "817790",
    "end": "824060"
  },
  {
    "text": "to go find the numerical\nvalues at different points. But nonetheless, here, I\nhave this model, which maybe",
    "start": "824060",
    "end": "834020"
  },
  {
    "text": "is even better to put in here. The difference is, here,\nI might have d tilde,",
    "start": "834020",
    "end": "839690"
  },
  {
    "text": "I might have V tilde, this is\nV error tilde, and so forth.",
    "start": "839690",
    "end": "847890"
  },
  {
    "text": "And IL tilde. So that's a better model\nto use-- or a simpler model",
    "start": "847890",
    "end": "854420"
  },
  {
    "text": "to use from a control\ndesign point of view. And then we said,\nwell, how do we mostly",
    "start": "854420",
    "end": "860870"
  },
  {
    "text": "use that kind of thing? Well, what we can\ndo is we can say, take the Laplace\ntransform of this thing.",
    "start": "860870",
    "end": "866660"
  },
  {
    "text": "This d dt's becomes s\ntimes IL and this becomes s times V. I can then\neliminate IL from the equation,",
    "start": "866660",
    "end": "875640"
  },
  {
    "text": "and I can actually come up\nwith a transfer function. And if we do that,\nwe're going to get--",
    "start": "875640",
    "end": "882120"
  },
  {
    "text": "if u is equal to u-- in other\nwords, is not changing, what I get is H of s is equal to V\ntilde of s over d tilde of s,",
    "start": "882120",
    "end": "896250"
  },
  {
    "text": "which is equal to minus\ns times V over RCD prime",
    "start": "896250",
    "end": "905730"
  },
  {
    "text": "plus VD prime over\nLC divided by s",
    "start": "905730",
    "end": "914519"
  },
  {
    "text": "squared plus 1 over RC s\nplus D prime squared over LC.",
    "start": "914520",
    "end": "923880"
  },
  {
    "text": "So this is now a\ntransfer function. And I can just\nstick H of s in here",
    "start": "923880",
    "end": "933660"
  },
  {
    "text": "and get my transfer function\nfrom d to-- d tilde to V tilde, and now I'm in a position\nto do control design.",
    "start": "933660",
    "end": "940100"
  },
  {
    "text": " Before I move on, are\nthere any questions",
    "start": "940100",
    "end": "947149"
  },
  {
    "text": "about any of these steps? These are the steps we covered\nin the last couple of lectures. ",
    "start": "947150",
    "end": "957850"
  },
  {
    "text": "OK. So I've taken my\nswitched equations-- or I've derived my\nswitch equations. And I've averaged them.",
    "start": "957850",
    "end": "963120"
  },
  {
    "text": "Then I've linearized them. And now I have a\ntransfer function. I can start to think about\nmy converter control.",
    "start": "963120",
    "end": "969629"
  },
  {
    "text": "Let's think about, what is this\ntransfer function look like? ",
    "start": "969630",
    "end": "977519"
  },
  {
    "text": "If I plotted the poles\nof this circuit-- so here's the complex plane.",
    "start": "977520",
    "end": "985080"
  },
  {
    "text": "Here's the real value of s\nand the imaginary value of s.",
    "start": "985080",
    "end": "990225"
  },
  {
    "start": "990225",
    "end": "995290"
  },
  {
    "text": "What I would see is I will\nhave one right half-plane 0 because I'll have a\npositive value of 0, which",
    "start": "995290",
    "end": "1002130"
  },
  {
    "text": "generates a 0 in the numerator. So somewhere over here,\nI'm going to have a 0.",
    "start": "1002130",
    "end": "1009540"
  },
  {
    "text": "And then if I plug values in\nhere for typical parameters like I'm going to see,\nwhat we're going to see",
    "start": "1009540",
    "end": "1015180"
  },
  {
    "text": "is we're going to have a\npair of lightly-damped poles in the left half-plane.",
    "start": "1015180",
    "end": "1021780"
  },
  {
    "text": "So this means the response\nis naturally oscillatory. That shouldn't surprise\nyou because when",
    "start": "1021780",
    "end": "1028500"
  },
  {
    "text": "we did a little\nload step there, we saw a second-order oscillatory\nresponse and settling down.",
    "start": "1028500",
    "end": "1035355"
  },
  {
    "text": "OK.  And again, where\nthese poles are,",
    "start": "1035356",
    "end": "1042159"
  },
  {
    "text": "we'll notice that there's\na D prime squared here. So where the actual\npoles are depends",
    "start": "1042160",
    "end": "1047949"
  },
  {
    "text": "upon the operating point. Depends upon what steady state\nduty ratio I'm operating at.",
    "start": "1047950",
    "end": "1054350"
  },
  {
    "text": "But it looks\nsomething like this. Now you might ask, gee,\nyou did all this math.",
    "start": "1054350",
    "end": "1063139"
  },
  {
    "text": "Is this model that's popping\nout, is that just random? And the reason you might\nwant to wonder that",
    "start": "1063140",
    "end": "1070250"
  },
  {
    "text": "is just because this system\nhas a right half-plane 0.",
    "start": "1070250",
    "end": "1076130"
  },
  {
    "text": "Now those who designed control\nsystems hate half-plane 0's.",
    "start": "1076130",
    "end": "1083340"
  },
  {
    "text": "They are very annoying. Why are they annoying? Because usually if\nI take some system.",
    "start": "1083340",
    "end": "1092150"
  },
  {
    "text": "And I put some gain-- forget about what\nthis control is. Say it's just a\nproportional gain.",
    "start": "1092150",
    "end": "1097347"
  },
  {
    "text": "And I turn up and\nI close the loop and I turn up the\ngain, what tends",
    "start": "1097347",
    "end": "1102480"
  },
  {
    "text": "to happen is the poles move. The idea is I had\nsome open loop poles, and when I put a feedback\nloop around them,",
    "start": "1102480",
    "end": "1108539"
  },
  {
    "text": "the dynamics are\ngoing to change. And what happens is that\nthe closed loop poles, when",
    "start": "1108540",
    "end": "1114860"
  },
  {
    "text": "I close that, are\nsomewhere else, but it tends to be that\nas I turn up the gain,",
    "start": "1114860",
    "end": "1122030"
  },
  {
    "text": "the open loop poles tend to\nmove towards the open loop 0.",
    "start": "1122030",
    "end": "1128080"
  },
  {
    "text": "And what that means is,\nif I took this thing and I say I put it in a\nproportional feedback loop,",
    "start": "1128080",
    "end": "1133570"
  },
  {
    "text": "the poles would tend\nto move towards the 0. Now if the poles\nmove towards the 0",
    "start": "1133570",
    "end": "1139470"
  },
  {
    "text": "and the 0's in the\nright half-plane, that means the thing\ntends to go unstable. So something with a\nright half-plane 0",
    "start": "1139470",
    "end": "1145770"
  },
  {
    "text": "is very, very easy to make. Unstable generally. So we don't like that.",
    "start": "1145770",
    "end": "1152809"
  },
  {
    "text": "But you could say, well,\nOK, you're mathematically finagling a bunch of stuff. Can't you just do a version\nof a model that's not going",
    "start": "1152810",
    "end": "1160280"
  },
  {
    "text": "to have a right half-plane 0? Like, why do we have to be-- why\ndoes life have to be difficult? And the answer is the\nmathematical model",
    "start": "1160280",
    "end": "1168990"
  },
  {
    "text": "you get actually very nicely\nreflects the physical dynamics of the system.",
    "start": "1168990",
    "end": "1174380"
  },
  {
    "text": "It's not accidental that\nthere's a right half-plane 0 in the equations. It's intrinsic to the\nbehavior of the system.",
    "start": "1174380",
    "end": "1180450"
  },
  {
    "text": "OK What does a right\nhalf-plane 0 tend to do?",
    "start": "1180450",
    "end": "1186320"
  },
  {
    "text": "If I take a system with a\nright half-plane 0 and I step",
    "start": "1186320",
    "end": "1193250"
  },
  {
    "text": "the input-- so suppose-- here's my\ninput, And I step my input",
    "start": "1193250",
    "end": "1200660"
  },
  {
    "text": "up a little bit. What I expect to do--\neventually what I want is that the response, the\noutput should go up, too.",
    "start": "1200660",
    "end": "1209410"
  },
  {
    "text": "A system with a right\nhalf-plane 0 tends to do this. I want my output to go up from--",
    "start": "1209410",
    "end": "1215710"
  },
  {
    "text": "this is the output. I want it to go up from some\nlevel to some higher level.",
    "start": "1215710",
    "end": "1221710"
  },
  {
    "text": "But what a system with a\nright half-plane 0 will do is as soon as I step the\ninput, the output will actually",
    "start": "1221710",
    "end": "1226900"
  },
  {
    "text": "go the wrong way,\nand eventually we'll settle down and go\nthe direction I want.",
    "start": "1226900",
    "end": "1234310"
  },
  {
    "text": "So right half-plane 0's\nare also considered nasty because you want it to\ngo in one direction, but before it goes\nin that direction,",
    "start": "1234310",
    "end": "1240822"
  },
  {
    "text": "it goes in some other direction. And this system's like that.",
    "start": "1240822",
    "end": "1246690"
  },
  {
    "text": "But I would argue that\nthis is like that because of the way the system behaves.",
    "start": "1246690",
    "end": "1252500"
  },
  {
    "text": "Suppose I wanted to make\nmy output voltage bigger. Forget about closing the loop.",
    "start": "1252500",
    "end": "1257970"
  },
  {
    "text": "Suppose I just want to-- I'm running at some duty ratio. Suppose my input\nvoltage is 5 volts.",
    "start": "1257970",
    "end": "1265740"
  },
  {
    "text": "I'm running at 50% duty ratio,\nand so my output voltage goes to 10 volts--",
    "start": "1265740",
    "end": "1271370"
  },
  {
    "text": "is at 10 volts. But suppose I suddenly want to\nmake my output voltage higher. What do I do?",
    "start": "1271370",
    "end": "1276414"
  },
  {
    "text": " What do I do to my duty ratio?",
    "start": "1276415",
    "end": "1282020"
  },
  {
    "text": "I increase it. So suppose at some point I said,\nno, 10 volts isn't good enough. I want to go to 20 volts.",
    "start": "1282020",
    "end": "1288390"
  },
  {
    "text": "I will step my duty ratio up.  So I was running at 50%.",
    "start": "1288390",
    "end": "1295210"
  },
  {
    "text": "Whatever's in my\ninductor current, half the time is\ngoing to the output, and that's what's\nsupplying the resistor.",
    "start": "1295210",
    "end": "1301390"
  },
  {
    "text": "Suddenly, I increased\nthe duty ratio. Now suddenly, instead of going\nto the output half the time,",
    "start": "1301390",
    "end": "1307809"
  },
  {
    "text": "the inductor currents going\nto ground half the time. So suddenly, there's less\ncurrent feeding to the output.",
    "start": "1307810",
    "end": "1316159"
  },
  {
    "text": "And so what's the output\nvoltage going to do? It's going to start to fall\nbecause you're not feeding",
    "start": "1316160",
    "end": "1322380"
  },
  {
    "text": "as much current to the output. Eventually, because I've\nturned up the duty ratio, I'm applying a positive\nvoltage across the inductor,",
    "start": "1322380",
    "end": "1329490"
  },
  {
    "text": "the inductor current\nis going to build up. And eventually, the inductor\ncurrent will catch up and it'll feed the right\ncurrent to the output.",
    "start": "1329490",
    "end": "1335860"
  },
  {
    "text": "But what you're going to get is\nexactly a behavior like this. The output is going to droop\nand then it's going to come up.",
    "start": "1335860",
    "end": "1342600"
  },
  {
    "text": "So the right half-plane 0 in my\ncontrol model, this guy here,",
    "start": "1342600",
    "end": "1353289"
  },
  {
    "text": "in fact, precisely reflects\nthe fundamental physics of how energy is going\nthrough the converter.",
    "start": "1353290",
    "end": "1361410"
  },
  {
    "text": "So you're so we're going\nto have to live with it. It's not a fiction\nof the math, it's",
    "start": "1361410",
    "end": "1366809"
  },
  {
    "text": "a fundamental physical thing. Any questions?",
    "start": "1366810",
    "end": "1372000"
  },
  {
    "text": " OK.",
    "start": "1372000",
    "end": "1378724"
  },
  {
    "text": "So now let's think about\nbuilding a controller. I want to come up here and I\nwant to build some compensator",
    "start": "1378724",
    "end": "1386150"
  },
  {
    "text": "GC of s. ",
    "start": "1386150",
    "end": "1392240"
  },
  {
    "text": "And the idea here\nis that I'm going to have some error\nbetween my reference",
    "start": "1392240",
    "end": "1397653"
  },
  {
    "text": "and my output that\ngenerates an error voltage. I amplify that such that if\nthat error voltage is positive,",
    "start": "1397653",
    "end": "1403759"
  },
  {
    "text": "d gets bigger, and my\nerror then gets smaller and I get close to what I want. So this thing, at least at\nDC, ought to have a high gain.",
    "start": "1403760",
    "end": "1411355"
  },
  {
    "text": " So let's think about this. What do my plant\npoles look like here?",
    "start": "1411355",
    "end": "1418879"
  },
  {
    "text": "My plant poles, I said, were\none half-plane 0 and two",
    "start": "1418880",
    "end": "1425870"
  },
  {
    "text": "left half-plane\nlightly-damped poles. ",
    "start": "1425870",
    "end": "1433310"
  },
  {
    "text": "All right. And there they're\ncomplex conjugates.",
    "start": "1433310",
    "end": "1439060"
  },
  {
    "text": "So what would happen\nif I made GC of s",
    "start": "1439060",
    "end": "1444160"
  },
  {
    "text": "just a proportional controller? I'm going to make\nthis a constant gain. So I'm going to get\na duty ratio that's",
    "start": "1444160",
    "end": "1450730"
  },
  {
    "text": "proportional to the error. And what I would want\nis to turn that gain up so that a tiny error\ngives me a big duty ratio",
    "start": "1450730",
    "end": "1459160"
  },
  {
    "text": "and I get a small\nsteady state error. What I told you is as I\nchange values of GC of s--",
    "start": "1459160",
    "end": "1466270"
  },
  {
    "text": "if I use one-- a first value of GC of s, if\nI use a first value of Kp,",
    "start": "1466270",
    "end": "1472720"
  },
  {
    "text": "maybe my closed-loop\npoles would move here. And if I kept a higher value\nof Kp, they'd move here.",
    "start": "1472720",
    "end": "1478653"
  },
  {
    "text": "And if you do this, you can\nform what's a root locus and say as a function,\nas I turn up Kp, where do my closed-loop poles go?",
    "start": "1478653",
    "end": "1485440"
  },
  {
    "text": "And what this thing would do is\nit would do something like this. ",
    "start": "1485440",
    "end": "1492270"
  },
  {
    "text": "And then the poles would split. And so these are for\ndifferent values of Kp.",
    "start": "1492270",
    "end": "1498570"
  },
  {
    "text": "So that's a problem\nbecause if I turn up--",
    "start": "1498570",
    "end": "1504200"
  },
  {
    "text": "I want a high cape, because\nI want the error to be small, but if I make cape too\nbig, once that pole",
    "start": "1504200",
    "end": "1509562"
  },
  {
    "text": "moves to the right\nhalf-plane, this whole thing is going to oscillate. So this is the nasty thing\nabout the right half-plane 0,",
    "start": "1509562",
    "end": "1516410"
  },
  {
    "text": "is that these-- the closed-loop\nvalues will be moved from where the open loop poles\nare somewhere into the right",
    "start": "1516410",
    "end": "1522440"
  },
  {
    "text": "half-plane. So you wouldn't want to do a\nproportional compensator on this",
    "start": "1522440",
    "end": "1529800"
  },
  {
    "text": "just because you're going to-- either you're going\nto-- either it's going to have very bad\nstability or what's",
    "start": "1529800",
    "end": "1534990"
  },
  {
    "text": "going to happen is if you your\ngain to be a really low value. That means that\nyou're going to have",
    "start": "1534990",
    "end": "1540510"
  },
  {
    "text": "to end up with\nliving with a pretty big error between the output\nvoltage you're getting and your reference voltage.",
    "start": "1540510",
    "end": "1546424"
  },
  {
    "text": "It's going to be\nvery droopy output.  So what could I do?",
    "start": "1546425",
    "end": "1552400"
  },
  {
    "text": "I could pick some\nother compensator. Now I'm not going\nto try to design a good compensator\nfor you here, that's not the topic of this class.",
    "start": "1552400",
    "end": "1558940"
  },
  {
    "text": "But what's the next\nsimplest compensator maybe I could think of that\nwould fix that problem?",
    "start": "1558940",
    "end": "1564640"
  },
  {
    "text": "And I would argue you could use\nGC of s is equal to KI over s.",
    "start": "1564640",
    "end": "1572230"
  },
  {
    "text": "This is an integral controller. 1 over s is an integrator. So what I could do is instead\nof making my d proportional",
    "start": "1572230",
    "end": "1578543"
  },
  {
    "text": "to the error\nvoltage, I could make it proportional to the inner\nintegral of the error voltage. So p and I are parts\nof PID controllers.",
    "start": "1578543",
    "end": "1585850"
  },
  {
    "text": "And the beauty of an\nintegral controller is eventually it will integrate\nup the error and leave me with 0",
    "start": "1585850",
    "end": "1591930"
  },
  {
    "text": "steady state error. So if I did that, I still\nhave my plant poles--",
    "start": "1591930",
    "end": "1598650"
  },
  {
    "text": "I have two lightly-damped plant\npoles and a right half-plane 0.",
    "start": "1598650",
    "end": "1603990"
  },
  {
    "text": "And if I did this,\nwell, I'm also going to have another\nin my forward loop.",
    "start": "1603990",
    "end": "1609789"
  },
  {
    "text": "I also have now the dynamics\nassociated with the compensator. So here's his open loop pole.",
    "start": "1609790",
    "end": "1617520"
  },
  {
    "text": "And when I start\ndialing those around, what it would look like is this.",
    "start": "1617520",
    "end": "1622582"
  },
  {
    "text": "This pole would move this way,\ntrying to cross through infinity",
    "start": "1622582",
    "end": "1627680"
  },
  {
    "text": "to come back to the 0. And then this-- these poles\nwould do something like--",
    "start": "1627680",
    "end": "1632900"
  },
  {
    "text": "they'd first swing\ninwards, and then they'd come outwards like this,\nand they do something like this.",
    "start": "1632900",
    "end": "1639840"
  },
  {
    "text": "And if you take a\ncontrol class, they'll tell you exactly how to\ncalculate all these geometries and what they do.",
    "start": "1639840",
    "end": "1646789"
  },
  {
    "text": "So this is-- if I add\na certain value of KI, maybe my poles would sit here.",
    "start": "1646790",
    "end": "1652280"
  },
  {
    "text": "If I turned up KI really big,\nmaybe my poles would be here. And I wouldn't want that because\nnow it would be oscillating.",
    "start": "1652280",
    "end": "1658650"
  },
  {
    "text": "So I can still make this\nthing unstable by using too much integral gain.",
    "start": "1658650",
    "end": "1664250"
  },
  {
    "text": "But even with a small integral\ngain, I can still get to--",
    "start": "1664250",
    "end": "1669920"
  },
  {
    "text": "0 error here gives me a duty\nratio, which gets my output, so my output voltage will\ntrack my reference even",
    "start": "1669920",
    "end": "1677029"
  },
  {
    "text": "with a small integral gain. Any questions about that?",
    "start": "1677030",
    "end": "1683780"
  },
  {
    "text": "Yeah, Lowry? AUDIENCE: How do you know\nwhich line you're on-- [INAUDIBLE] line you're on? DAVID PERREAULT: How do I\nknow which value on the line?",
    "start": "1683780",
    "end": "1692830"
  },
  {
    "text": "AUDIENCE: I guess-- oh, I see. Each of them represents\na very different pole. DAVID PERREAULT: Yeah. No, each of these--",
    "start": "1692830",
    "end": "1698549"
  },
  {
    "text": "each of these points-- these two\npoints represent one gain of KI, these two points represent\nsome bigger value of KI,",
    "start": "1698550",
    "end": "1705740"
  },
  {
    "text": "and so forth. So I can pick a value of KI that\nwould keep my poles over here. ",
    "start": "1705740",
    "end": "1716510"
  },
  {
    "text": "All right. So-- I wouldn't do\nthis in the real world, but maybe I could say,\nwell, if I'm really careful,",
    "start": "1716510",
    "end": "1723030"
  },
  {
    "text": "maybe I can get away with\nan integral controller on this thing and it'll\ndo the right thing. So now let's start thinking\nabout doing this design.",
    "start": "1723030",
    "end": "1733940"
  },
  {
    "text": "Maybe I'll use an\nintegral controller because it's the easiest\nthing I can think of. Let's start talking about\nmy open-loop poles and 0's.",
    "start": "1733940",
    "end": "1741775"
  },
  {
    "text": " Firstly, we got to remember that\nthis transfer function varies",
    "start": "1741775",
    "end": "1750440"
  },
  {
    "text": "with operating condition. So if I'm at a different\nvalue of load resistance,",
    "start": "1750440",
    "end": "1760640"
  },
  {
    "text": "I'm going to have a\ndifferent 0 location and I'm going to have a different--",
    "start": "1760640",
    "end": "1767179"
  },
  {
    "text": "this doesn't show very cleanly\nthat the pole locations will",
    "start": "1767180",
    "end": "1772340"
  },
  {
    "text": "differ, except that it's in this\nterm, which actually relates to the damping. So if I calculate this\ntransfer function's poles",
    "start": "1772340",
    "end": "1781760"
  },
  {
    "text": "and 0's for\ndifferent values of R at the nominal input\nresistance, this",
    "start": "1781760",
    "end": "1787520"
  },
  {
    "text": "is what you're going to see. The poles in the right half 0--",
    "start": "1787520",
    "end": "1793130"
  },
  {
    "text": "right half-plane,\nthese are the-- I'm sorry, the 0's in\nthe right half-plane, the location of the 0\nmoves with different values",
    "start": "1793130",
    "end": "1799090"
  },
  {
    "text": "of the load resistance. If I look at the\nlocations of the poles,",
    "start": "1799090",
    "end": "1805490"
  },
  {
    "text": "they move with the\nload resistance. And what will happen\nis as R gets bigger, this thing gets less\nand less damped.",
    "start": "1805490",
    "end": "1811960"
  },
  {
    "text": "The open-loop poles are\nmoving towards the J omega axis, which is right here.",
    "start": "1811960",
    "end": "1817660"
  },
  {
    "text": "Why does it do that? Well, if you think about back\nto the original converter, what's happening?",
    "start": "1817660",
    "end": "1823740"
  },
  {
    "text": "Essentially, L and\nC are oscillating. They slosh energy back\nand forth dynamically.",
    "start": "1823740",
    "end": "1830820"
  },
  {
    "text": "Not just directly because\nthey're not directly connected, but modulated through\nthe duty ratio.",
    "start": "1830820",
    "end": "1836066"
  },
  {
    "text": "They're still trading\nenergy back and forth, and that's the source\nof oscillation. That's why it's second-order\nand can be underdamped.",
    "start": "1836067",
    "end": "1843530"
  },
  {
    "text": "The resistor damps that. So it's some funny, modulated\nversion of the LC oscillation",
    "start": "1843530",
    "end": "1849700"
  },
  {
    "text": "with a parallel resistor. So basically, it's like\na parallel resonant tank, and the resistor is\nwhat's damping that thing.",
    "start": "1849700",
    "end": "1858000"
  },
  {
    "text": "If you make the R big,\nthe damping is small, and it oscillates more. So it shouldn't be\nsurprising that the location",
    "start": "1858000",
    "end": "1865630"
  },
  {
    "text": "of the open loop poles gets\ncloser to the J omega axis and less damped\nas R gets bigger.",
    "start": "1865630",
    "end": "1873980"
  },
  {
    "text": "So I might really have a\ntrouble if my R went to 100, but I'm only making it go to 10.",
    "start": "1873980",
    "end": "1879900"
  },
  {
    "text": "Noticing that also, things\nvary with input voltage because if I think\nabout input voltage,",
    "start": "1879900",
    "end": "1885240"
  },
  {
    "text": "D prime here is\nchanging, So that's also",
    "start": "1885240",
    "end": "1890370"
  },
  {
    "text": "changing the pole locations. In fact, very directly. And in fact, you\ncan see that here.",
    "start": "1890370",
    "end": "1896470"
  },
  {
    "text": "So this is a plot\nof what happens when I vary both R and input\nvoltage, and hence, duty ratio.",
    "start": "1896470",
    "end": "1905260"
  },
  {
    "text": "And all I did was I clunked\nthe pole locations into MATLAB and said, plot it for me.",
    "start": "1905260",
    "end": "1911250"
  },
  {
    "text": "So any questions about that?  So any compensator I'm\ngoing to have to build,",
    "start": "1911250",
    "end": "1917799"
  },
  {
    "text": "the typical thing you\ndo-- you could build a variable compensator\nthat did different things for different operating points,\nbut the most typical thing to do",
    "start": "1917800",
    "end": "1925010"
  },
  {
    "text": "in a DC converter\nis to say, I know my plant characteristics vary.",
    "start": "1925010",
    "end": "1930040"
  },
  {
    "text": "Let me design one\ncompensator that'll work for any location on that. That's the simplest\nthing you can do.",
    "start": "1930040",
    "end": "1936830"
  },
  {
    "text": "And so let's see what would\nhappen if we tried to do that. What I'm going to\ndo is let me put",
    "start": "1936830",
    "end": "1945470"
  },
  {
    "text": "this system in a closed loop. I'm going to use a compensator-- I'm going to use\nthis compensator.",
    "start": "1945470",
    "end": "1951850"
  },
  {
    "text": "I'm going to use an\nintegral controller. And I'm going to use my\nplant dynamics there.",
    "start": "1951850",
    "end": "1957320"
  },
  {
    "text": "And then for different\nvalues of KI, I'm going to take\nthe closed loop, I'm going to find the\nclosed-loop pole locations,",
    "start": "1957320",
    "end": "1964270"
  },
  {
    "text": "then I'm just\ngoing to plot them. And I'm just going to do\nthat physically in MATLAB.",
    "start": "1964270",
    "end": "1970680"
  },
  {
    "text": "Here we go. So the open-loop pole\nlocations are the ends here. And this is for a load\nresistance of 2 ohms.",
    "start": "1970680",
    "end": "1977789"
  },
  {
    "text": "This is one end\nof my load range. This is the heavy load\nend of my load range. We can see that for KI, because\nI have this integral gain of 5,",
    "start": "1977790",
    "end": "1990090"
  },
  {
    "text": "I'm going to have a pole here\nthat's due to the compensator, and then the poles that's due to\nthe plant are going to be here.",
    "start": "1990090",
    "end": "1996340"
  },
  {
    "text": "And the right half-plane\n0 is out here. So that system ought\nto at least be stable.",
    "start": "1996340",
    "end": "2002240"
  },
  {
    "text": "And I plotted this for a bunch\nof different values, increasing values of KI. So this root locus\nthat I was showing you,",
    "start": "2002240",
    "end": "2008720"
  },
  {
    "text": "I've calculated for a bunch\nof different values of KI. So you can see what will happen. If I make KI too big,\nI will get instability.",
    "start": "2008720",
    "end": "2017429"
  },
  {
    "text": " Now that's for one\nend of my load range,",
    "start": "2017430",
    "end": "2023110"
  },
  {
    "text": "but keep in mind, the\nstarting place of my poles-- my open-loop pole's dependent\nupon my load resistance.",
    "start": "2023110",
    "end": "2030230"
  },
  {
    "text": "If I started with the other\nend of my load range-- 10 ohms, light load, this\nis what it would look like.",
    "start": "2030230",
    "end": "2038090"
  },
  {
    "text": "For KI equals 5, I have\na dominant pole here.",
    "start": "2038090",
    "end": "2043559"
  },
  {
    "text": "This is the closed-loop\npole location. And this is-- I have a pair of super\nlightly-damped poles here.",
    "start": "2043560",
    "end": "2051349"
  },
  {
    "text": " And I could then say, all\nright, let me calculate",
    "start": "2051349",
    "end": "2059929"
  },
  {
    "text": "the closed-loop pole locations. That's how-- once I\nhave the feedback loop, if I kick the output,\nthat's how it'll oscillate.",
    "start": "2059929",
    "end": "2067489"
  },
  {
    "text": "With my control system in place. And I could calculate that\nfor every possible value",
    "start": "2067489",
    "end": "2073879"
  },
  {
    "text": "of R and input voltage\nthat I might deal with. And if you do that,\nthis is what you get.",
    "start": "2073880",
    "end": "2080700"
  },
  {
    "text": "So you could argue that\nno matter what here, it's",
    "start": "2080700",
    "end": "2087899"
  },
  {
    "text": "at least stable. All the poles are in\nthe left half-plane. This is the J omega\naxis on the right here.",
    "start": "2087900",
    "end": "2094799"
  },
  {
    "text": "And I'm going to have a\ndominant first-order pole, and then I'm going to have some\nlightly-damped higher-order",
    "start": "2094800",
    "end": "2101730"
  },
  {
    "text": "poles. Any questions about that?",
    "start": "2101730",
    "end": "2107160"
  },
  {
    "text": "So I could at least say I\nbuilt a stable system that won't blow up-- hopefully-- for any of the\nloads or input voltages",
    "start": "2107160",
    "end": "2114323"
  },
  {
    "text": "I'm going to put on this thing.  OK.",
    "start": "2114323",
    "end": "2120940"
  },
  {
    "text": "How stable is it? And this is where me and\nyour average control textbook",
    "start": "2120940",
    "end": "2129790"
  },
  {
    "text": "break paths in terms of\nwhat we're happy with. ",
    "start": "2129790",
    "end": "2134980"
  },
  {
    "text": "A typical measure for\nthose who do control are things either like\nthe phase margin you have or the gain margin\nyou have on your loop.",
    "start": "2134980",
    "end": "2141970"
  },
  {
    "text": "So what you do is you\nlook at the loop gain and you plot that out and you\ncan look at the open-loop loop",
    "start": "2141970",
    "end": "2148030"
  },
  {
    "text": "gain with a controller. This is what it looks like. So this would tell\nyou at 10 ohms, which",
    "start": "2148030",
    "end": "2155290"
  },
  {
    "text": "is the most lightly\ndamped point in that, this says we have\na gain margin of 17 dB",
    "start": "2155290",
    "end": "2163870"
  },
  {
    "text": "and a phase margin\nof almost 90 degrees. So any control guy will tell you\nthat's a super stable system.",
    "start": "2163870",
    "end": "2171080"
  },
  {
    "text": "You're not you're not going\nto be unstable, no worries. And they're right. The output is not\ngoing to blow up.",
    "start": "2171080",
    "end": "2178170"
  },
  {
    "text": "Whether it's acceptable or\nnot is another question, and that's what you've\ngot to think about.",
    "start": "2178170",
    "end": "2183510"
  },
  {
    "text": "And so let's look at this. Let's look at some\nload step responses. So what we do is we have\nthe closed-loop control,",
    "start": "2183510",
    "end": "2191569"
  },
  {
    "text": "and then we pick\nthe load, and we see how does the voltage\nand current respond? In this case, we're\nstepping up the--",
    "start": "2191570",
    "end": "2199970"
  },
  {
    "text": "we're stepping\ndown the resistance to see a load step from\nlight load to heavy load,",
    "start": "2199970",
    "end": "2206330"
  },
  {
    "text": "and then from heavy\nload to light load. So here's one from one\ninput end to the other.",
    "start": "2206330",
    "end": "2212119"
  },
  {
    "text": "And we can see that here's\nthe voltage response, and here's the\ncurrent response here.",
    "start": "2212120",
    "end": "2218488"
  },
  {
    "text": "And it pretty much settles out. I think this is a\nsimulation thing out here. So you could say, that's\nnot too badly damped.",
    "start": "2218488",
    "end": "2227450"
  },
  {
    "text": "I don't mind that so much. It's all right. It's not great, but it's stable.",
    "start": "2227450",
    "end": "2234485"
  },
  {
    "text": "But that's going from\nlight load to heavy load. ",
    "start": "2234485",
    "end": "2241590"
  },
  {
    "text": "What happens-- oh,\nand I should say, that's the actual\nswitch circuit model. What is the average\nmodel say will happen?",
    "start": "2241590",
    "end": "2248350"
  },
  {
    "text": "There it is. So the average model-- the\nthing I want to point out is even though that's\na pretty big load step,",
    "start": "2248350",
    "end": "2253740"
  },
  {
    "text": "the average model does a\nreally good job of capturing what goes on. So you can really\nget behind averaging",
    "start": "2253740",
    "end": "2260460"
  },
  {
    "text": "as a way to get a simple look\nat what your system is doing. And in fact, if you calculated\nwhat the oscillation dynamics",
    "start": "2260460",
    "end": "2267240"
  },
  {
    "text": "looks like, the\nsmall signal model still looks pretty darn good. ",
    "start": "2267240",
    "end": "2273690"
  },
  {
    "text": "All right. Well, what about if I go\nin the other direction? I'm going to take-- I have heavy load, a lot\nof load on the converter.",
    "start": "2273690",
    "end": "2280450"
  },
  {
    "text": "Now I'm going to\nstep the load light. Well, here we go, boom.",
    "start": "2280450",
    "end": "2285690"
  },
  {
    "text": "The first thing you'll\nnotice, by the way, is when the load went away, what\nhappens to the output voltage?",
    "start": "2285690",
    "end": "2294690"
  },
  {
    "text": "It rockets up. Why does it rocket up? Because there was\nall this current in the inductor and the load\nresistance-- the load went away.",
    "start": "2294690",
    "end": "2302890"
  },
  {
    "text": "And so all that energy\nthat was in the inductor ends up in the output capacitor. And that output\nvoltage swings way up.",
    "start": "2302890",
    "end": "2310850"
  },
  {
    "text": "And there ain't a lot\nyou can do about that. The energy in the inductor\nhas to go somewhere, and it goes into\nthe output voltage.",
    "start": "2310850",
    "end": "2318590"
  },
  {
    "text": "So in the real world, if I\ndidn't want to see a ginormous spike on my output voltage--\nlike a 10-volt spike",
    "start": "2318590",
    "end": "2325697"
  },
  {
    "text": "in my output voltage, I better\nthrow a bigger output capacitor on there, or use a\nsmaller inductor.",
    "start": "2325697",
    "end": "2332320"
  },
  {
    "text": "So when you're thinking in\nyour design projects about how to size LNC and you\nwant some cut-off,",
    "start": "2332320",
    "end": "2339609"
  },
  {
    "text": "using a 1-Henry inductor and a\npicofarad load filter capacitor is probably a bad idea because\nyou've got to eat the energy",
    "start": "2339610",
    "end": "2347650"
  },
  {
    "text": "in that inductor,\nin a load transient. So word to the wise, you got\nto you got to size those very",
    "start": "2347650",
    "end": "2353715"
  },
  {
    "text": "wisely and make sure you\nhave enough energy storage in your capacitor\nthat he's not going to be too unhappy to absorb\nthe energy from the inductor",
    "start": "2353715",
    "end": "2361310"
  },
  {
    "text": "in a transient. But, more to the point,\nwhat else goes on here?",
    "start": "2361310",
    "end": "2367330"
  },
  {
    "text": "Here's what happens to the\nenergy in the inductor. The inductor current-- this\nis the inductor current here,",
    "start": "2367330",
    "end": "2374320"
  },
  {
    "text": "it goes blam! It goes down to 0. Basically, the output\nvoltage gets big.",
    "start": "2374320",
    "end": "2380589"
  },
  {
    "text": "The converter says,\noh my god, turn--  what can I do?",
    "start": "2380590",
    "end": "2386940"
  },
  {
    "text": "The most I can do is\nturn my duty ratio to 0. And I turn my duty ratio\nto 0, and all that energy",
    "start": "2386940",
    "end": "2393960"
  },
  {
    "text": "in the inductor ends\nup in the capacitor. And then it starts\nto switch again.",
    "start": "2393960",
    "end": "2399640"
  },
  {
    "text": "But you notice here,\nthings are clipped at 0. In this time period,\nthis converter",
    "start": "2399640",
    "end": "2405640"
  },
  {
    "text": "is actually in discontinuous\nconduction mode. ",
    "start": "2405640",
    "end": "2413434"
  },
  {
    "text": "So actually, that average model\nisn't quite right anymore. Now if we simulate this,\nwe actually do pretty well,",
    "start": "2413434",
    "end": "2421990"
  },
  {
    "text": "but the simulation-- actually,\nwe stick it in a diode to keep the-- we clamped it so--",
    "start": "2421990",
    "end": "2427800"
  },
  {
    "text": "in the simulation so that it\nwouldn't have the inductor",
    "start": "2427800",
    "end": "2432960"
  },
  {
    "text": "current go negative. Why? Because this has a\nswitch in a diode in it.",
    "start": "2432960",
    "end": "2438160"
  },
  {
    "text": "Now if you had two switches,\nthis average model's perfect,",
    "start": "2438160",
    "end": "2444309"
  },
  {
    "text": "it works all the time. It is still clipped. In our system, we can never\nhave duty ratios greater than 1",
    "start": "2444310",
    "end": "2450120"
  },
  {
    "text": "or less than 0, so there is\nsome clipping that goes on. But, the other thing I\nwanted to point out--",
    "start": "2450120",
    "end": "2456990"
  },
  {
    "text": "and this is related to\nwhat we said earlier. I showed you we have\nthe gain margin of,",
    "start": "2456990",
    "end": "2462300"
  },
  {
    "text": "what, 17 db and the phase\nmargin was 90 degrees, that's",
    "start": "2462300",
    "end": "2468120"
  },
  {
    "text": "perfectly stable. Anybody would say\nthat's very stable. But look at the oscillation\nin the output voltage here.",
    "start": "2468120",
    "end": "2474760"
  },
  {
    "text": "Like, to my mind-- I'm sorry, this is the\noscillation in the current,",
    "start": "2474760",
    "end": "2479890"
  },
  {
    "text": "but there's also an\noscillation in the voltage. That's very ringy. I wouldn't like that at\nall in a real converter,",
    "start": "2479890",
    "end": "2487390"
  },
  {
    "text": "especially if I'm feeding\nsome sensitive load, and when I set the load, the\noutput voltage is going erargh.",
    "start": "2487390",
    "end": "2494580"
  },
  {
    "text": "And what you can-- and where\ndoes this oscillation come from? This oscillation comes from\nthese lightly-damped poles.",
    "start": "2494580",
    "end": "2504119"
  },
  {
    "text": "The dominant pole here\nmakes it really stable. It's not going to--\nthe output's not",
    "start": "2504120",
    "end": "2509369"
  },
  {
    "text": "going to walk off and go\nto infinity or something, so that's why the\nmodel says it's stable.",
    "start": "2509370",
    "end": "2514569"
  },
  {
    "text": "Nonetheless, these\nlightly-damped poles still cause oscillation\nin the output.",
    "start": "2514570",
    "end": "2519820"
  },
  {
    "text": "Now I chose on purpose\nan extreme example that makes it look pretty bad.",
    "start": "2519820",
    "end": "2526020"
  },
  {
    "text": "What you can see\nsometimes is that you'll have something that's\nvery, very stable, but there'll be some\nreally lightly-damped pole,",
    "start": "2526020",
    "end": "2533640"
  },
  {
    "text": "maybe not even a little\nbit down, but way down. And what you often\nsee when you do that,",
    "start": "2533640",
    "end": "2540000"
  },
  {
    "text": "if you leave this lightly-damped\npole hanging there, is that your output voltage\nwill look fine on a macro scale,",
    "start": "2540000",
    "end": "2549510"
  },
  {
    "text": "but then you zoom in on it, and\nyou find it's wobbling by 10 or 20 or 30 millivolts on\ntop of your 24-volt output,",
    "start": "2549510",
    "end": "2557369"
  },
  {
    "text": "and then you have to ask the\nquestion, is that tolerable? And maybe I don't care about\n30 millivolts of ripple",
    "start": "2557370",
    "end": "2564120"
  },
  {
    "text": "at 20 kilohertz because there's\nsome lightly-damped pole pair. I could live with that. But there's other\napplications where",
    "start": "2564120",
    "end": "2570240"
  },
  {
    "text": "they tell you, oh,\nby the way, you've got to have your output\nvoltage rock solid, and some lightly-damped\npole pair",
    "start": "2570240",
    "end": "2577200"
  },
  {
    "text": "that's going to get excited\nby noise and just womble around is probably\nnot acceptable.",
    "start": "2577200",
    "end": "2582660"
  },
  {
    "text": "So in addition to making\nyour control loops stable, I would argue you've got to\nthink about how precise does it",
    "start": "2582660",
    "end": "2591320"
  },
  {
    "text": "have to track the\noutput voltage? How much will it wiggle when\nsomething happens to it?",
    "start": "2591320",
    "end": "2596490"
  },
  {
    "text": "And is that acceptable? And in power supplies,\nvery often your job is to make the world clean,\nsolid voltage no matter what.",
    "start": "2596490",
    "end": "2604260"
  },
  {
    "text": "And in those cases, you've\ngot to think very carefully about how you want to deal\nwith the closed-loop poles.",
    "start": "2604260",
    "end": "2610530"
  },
  {
    "text": "Maybe you want to make sure\nthat no poles are super lightly damped even if\nthey're pretty far down",
    "start": "2610530",
    "end": "2617030"
  },
  {
    "text": "and not contributing\nthat much to stability, maybe they'll make your\noutput response unpleasant.",
    "start": "2617030",
    "end": "2623619"
  },
  {
    "text": "So, that was me talking a lot. Are there any questions\nabout those examples? ",
    "start": "2623620",
    "end": "2630610"
  },
  {
    "text": "AUDIENCE: What devices would\nrequire a more stable output voltage? DAVID PERREAULT: If you\nwere building a power supply",
    "start": "2630610",
    "end": "2636970"
  },
  {
    "text": "to feed a sensitive\ninstrumentation amplifier, for example, because\nif you have some instrumentation",
    "start": "2636970",
    "end": "2645279"
  },
  {
    "text": "amplifier that's picking\nup some tiny signal, I don't know, for an EKG or\nwhatever it is, that amplifier",
    "start": "2645280",
    "end": "2652359"
  },
  {
    "text": "has some power supply\nrejection ratio, meaning the output\nof the amplifier",
    "start": "2652360",
    "end": "2658240"
  },
  {
    "text": "will give you the\nresponse to the input, but there's a tiny little\nresponse to the power supply",
    "start": "2658240",
    "end": "2663940"
  },
  {
    "text": "variation. And that little\nresponse may be bad. So if your power supply\nis wiggling around,",
    "start": "2663940",
    "end": "2671700"
  },
  {
    "text": "a little bit of that\ngets into the output, and so you don't like that. If what I'm feeding is a\nresistor, maybe you don't care.",
    "start": "2671700",
    "end": "2679630"
  },
  {
    "text": "But so it depends\non the application, but a lot of the time, if it's a\npower supply for instrumentation",
    "start": "2679630",
    "end": "2686220"
  },
  {
    "text": "amplifier or for\nan RF transmitter or for a receiver or\nsomething like that, you've got to keep it very clean.",
    "start": "2686220",
    "end": "2694460"
  },
  {
    "text": "Yeah, Jack? AUDIENCE: Is there a phase\nmargin for the transfer function from D to V.",
    "start": "2694460",
    "end": "2700893"
  },
  {
    "text": "DAVID PERREAULT: Yeah. That's true, yes. AUDIENCE: That's why you showed\nus a load step that that phase",
    "start": "2700893",
    "end": "2706645"
  },
  {
    "text": "margin was different. DAVID PERREAULT: That's right. But on the other hand, from\na small signal point of view, all the pole locations are--",
    "start": "2706645",
    "end": "2714050"
  },
  {
    "text": "once I have a linear\nsystem, the pole locations are the same for\nany input to any--",
    "start": "2714050",
    "end": "2720490"
  },
  {
    "text": "for any input.  That's a good question,\nbut the phase margin--",
    "start": "2720490",
    "end": "2728340"
  },
  {
    "text": "AUDIENCE: I guess [INAUDIBLE]. DAVID PERREAULT:\nI'd have to think-- I'd have to think about\nwhether that's true. But it's also true that\nyou would still see that--",
    "start": "2728340",
    "end": "2735305"
  },
  {
    "text": "if I did a tiny\nlittle load step, you'd still see\nthat kind of thing. And if I did a\ntiny reference step",
    "start": "2735305",
    "end": "2742620"
  },
  {
    "text": "and came back to what I'm\ntreating as the input, you'd still see that. AUDIENCE: Yeah. I guess that's [INAUDIBLE]\nphase margin that's [INAUDIBLE]",
    "start": "2742620",
    "end": "2749027"
  },
  {
    "text": "is pretty [INAUDIBLE]. DAVID PERREAULT: What's that? AUDIENCE: [INAUDIBLE] 90\ndegrees is pretty [INAUDIBLE]. DAVID PERREAULT: Right, but the\nonly thing that's telling you",
    "start": "2749027",
    "end": "2756180"
  },
  {
    "text": "is what the dominant\npole is doing. It is very damped. It will-- the majority\nof the transition",
    "start": "2756180",
    "end": "2763200"
  },
  {
    "text": "will reflect that dominant pole. So the reason this\nlooks damped is",
    "start": "2763200",
    "end": "2769350"
  },
  {
    "text": "because it's dominated\nby this guy down here. Let me put on--",
    "start": "2769350",
    "end": "2774960"
  },
  {
    "text": "right? But that doesn't mean there's\nnot some small oscillations. So the small\noscillations aren't going",
    "start": "2774960",
    "end": "2781360"
  },
  {
    "text": "to make your circuit blow up. And that's why they\nsay, oh, it's great, it's very, very stable. And it's true.",
    "start": "2781360",
    "end": "2787460"
  },
  {
    "text": "The problem is, if\nthese wiggling around, even if it's very,\nvery small, might be unacceptable as a\nresponse at the output,",
    "start": "2787460",
    "end": "2795540"
  },
  {
    "text": "that's the point I\nwanted to make to make. Does that answer your question?",
    "start": "2795540",
    "end": "2800770"
  },
  {
    "text": "OK. So this is just to give you\nan idea of the way people--",
    "start": "2800770",
    "end": "2806859"
  },
  {
    "text": "first of all, the process\npeople use to get a model, and then the way they think\nabout what you might use that",
    "start": "2806860",
    "end": "2811900"
  },
  {
    "text": "model for, understanding if some\nof you have had control system design and some of you hadn't. ",
    "start": "2811900",
    "end": "2818900"
  },
  {
    "text": "You notice the question\nI dodged is, well, if this is a bad compensator\nand this is a bad compensator,",
    "start": "2818900",
    "end": "2826970"
  },
  {
    "text": "what's a good compensator? And the answer to\nthat is, there's",
    "start": "2826970",
    "end": "2835540"
  },
  {
    "text": "a lot of things you can do. One of them-- if I just\nwanted to use something",
    "start": "2835540",
    "end": "2841930"
  },
  {
    "text": "like an integral controller or\na more fancy version that's not just an integral controller, but\nsomething that was a good duty",
    "start": "2841930",
    "end": "2849849"
  },
  {
    "text": "ratio control scheme,\none thing I could do is change my plant so that\nit had friendlier dynamics.",
    "start": "2849850",
    "end": "2858757"
  },
  {
    "text": "I already said, if you don't\nwant the voltage overshoot, I'd use a bigger capacitor. I can also do things\nto the actual converter",
    "start": "2858757",
    "end": "2866970"
  },
  {
    "text": "to make it friendlier\nfor my dynamics. And what we saw as\none example was that--",
    "start": "2866970",
    "end": "2876900"
  },
  {
    "text": "well, what's really\nhappening is this resistor is damping the LC oscillation\nmodulated through the switching.",
    "start": "2876900",
    "end": "2884824"
  },
  {
    "text": "But the problem is, when R\ngets big, it's not well-damped. Well, what happens if I walk\nup to this thing and I say,",
    "start": "2884824",
    "end": "2890180"
  },
  {
    "text": "you know what? I will throw a damping\nleg on the output of this. I'll put another\nresistor in here, RD.",
    "start": "2890180",
    "end": "2896245"
  },
  {
    "text": " And here, I have see C big.",
    "start": "2896245",
    "end": "2903260"
  },
  {
    "text": " When we talk about\nfilter design, you'll also see these see\nthese kind of damping legs.",
    "start": "2903260",
    "end": "2910038"
  },
  {
    "text": "And you've seen it in\nsnubbers, too, right? The idea is, at frequencies near\nthe oscillation point with L",
    "start": "2910038",
    "end": "2918190"
  },
  {
    "text": "and C, if C looks\nlike a short circuit, then RD is in parallel\nwith R and damps this.",
    "start": "2918190",
    "end": "2925380"
  },
  {
    "text": "And then if R gets big\nor small, it always has RD in parallel with it. So if this was 2 ohms and I was\nhappy with the response I saw",
    "start": "2925380",
    "end": "2933750"
  },
  {
    "text": "for 2-ohm damping, then\nmaybe this damping leg added on to my converter\nwould satisfy me.",
    "start": "2933750",
    "end": "2943740"
  },
  {
    "text": "And I also have some\nmore big capacitance here to help me absorb larger\nvoltage transients.",
    "start": "2943740",
    "end": "2950200"
  },
  {
    "text": "So one thing I can do if\nI don't like my dynamics, and you might not, either\nbecause the overshoots are too",
    "start": "2950200",
    "end": "2955630"
  },
  {
    "text": "big or because it's not as\nwell-damped as you want, as you can do things like add\ndamping legs or other things",
    "start": "2955630",
    "end": "2962170"
  },
  {
    "text": "to the plant-- to the actual\nconverter or change the component values so\nthat it is better damped,",
    "start": "2962170",
    "end": "2968230"
  },
  {
    "text": "or that it has\nfriendlier response. Nothing wrong with that.",
    "start": "2968230",
    "end": "2973460"
  },
  {
    "text": "Do it all the time. The upside is it works. The downside is, now\nI've got to go back out",
    "start": "2973460",
    "end": "2980100"
  },
  {
    "text": "and buy an extra capacitor\nand a damping resistor-- it's more expensive.",
    "start": "2980100",
    "end": "2985520"
  },
  {
    "text": "There's some things\nyou can't change. I mean, some things you\nmust change in the plant. If I want to reduce that\namount, that voltage",
    "start": "2985520",
    "end": "2991560"
  },
  {
    "text": "is going to swing up\nwhen the load steps down, I better go get\nmore capacitance. There's no way around it\nbecause there's nowhere",
    "start": "2991560",
    "end": "2997930"
  },
  {
    "text": "else for the energy to go unless\nI'm going to somehow dump it. So sometimes you have\nto change things.",
    "start": "2997930",
    "end": "3004460"
  },
  {
    "text": "But you don't tend\nto add hardware if you can do it in control.",
    "start": "3004460",
    "end": "3010775"
  },
  {
    "text": "And the way I might think\nabout doing something like that, I'd certainly\nuse a bigger capacitor.",
    "start": "3010775",
    "end": "3016470"
  },
  {
    "text": "The other thing I would probably\ndo in this kind of converter is a different control scheme.",
    "start": "3016470",
    "end": "3021869"
  },
  {
    "text": "You notice that in\nthis control scheme, we reduced everything down\nto a transfer function",
    "start": "3021870",
    "end": "3028250"
  },
  {
    "text": "from duty ratio to voltage and\nI just ignored what the inductor current was doing. Well, it turns out\nthat control guy",
    "start": "3028250",
    "end": "3034600"
  },
  {
    "text": "will tell you, well, you should\nbe doing full-state feedback. In other words, don't just\nfeedback V, but feedback I,",
    "start": "3034600",
    "end": "3040060"
  },
  {
    "text": "and use that knowledge\nto improve the control so that you basically don't\nmake your poles worse,",
    "start": "3040060",
    "end": "3047470"
  },
  {
    "text": "but you make them better. And it turns out that just by\ndoing better control, by looking",
    "start": "3047470",
    "end": "3052690"
  },
  {
    "text": "at the inductor current\nand the voltage, I can make a better\ncontroller that",
    "start": "3052690",
    "end": "3058210"
  },
  {
    "text": "will lead to a much nicer--\nmore nicely damped response. And we will talk about that--\nthat technique is called",
    "start": "3058210",
    "end": "3065830"
  },
  {
    "text": "current mode control or\ncurrent program control, and that will be the\ntopic of next class.",
    "start": "3065830",
    "end": "3071109"
  },
  {
    "text": "Have a great day. ",
    "start": "3071110",
    "end": "3076000"
  }
]