[
  {
    "text": " The following content is\nprovided under a Creative Commons license.",
    "start": "0",
    "end": "5300"
  },
  {
    "text": "Your support will help\nMIT OpenCourseWare continue to offer high quality\neducational resources for free.",
    "start": "5300",
    "end": "11600"
  },
  {
    "text": "To make a donation or to\nview additional materials from hundreds of MIT courses,\nvisit MIT OpenCourseWare",
    "start": "11600",
    "end": "18100"
  },
  {
    "text": "at ocw.mit.edu. ",
    "start": "18100",
    "end": "23289"
  },
  {
    "text": "WILLIAM GREEN JR:\nAll right, so we're going to start a new topic today\nabout ordinary differential",
    "start": "23289",
    "end": "33260"
  },
  {
    "text": "equations initial\nvalue problems. But before I start\nto talk about that,",
    "start": "33260",
    "end": "39020"
  },
  {
    "text": "I want to remind you next\nweek's schedule is weird. So there's no classes on\nMonday, but instead we'll",
    "start": "39020",
    "end": "45830"
  },
  {
    "text": "have Monday class on Tuesday. So I'll see you next\non Tuesday morning.",
    "start": "45830",
    "end": "51950"
  },
  {
    "text": "And then we're not going to\nhave a class on Wednesday, but we have the quiz\non Wednesday night.",
    "start": "51950",
    "end": "59489"
  },
  {
    "text": "And then we'll get back\nto normal on Friday. And I would expect that\npossibly the TAs might",
    "start": "59490",
    "end": "64709"
  },
  {
    "text": "be interested in giving a help\nsession or review on Wednesday the class period.",
    "start": "64709",
    "end": "70136"
  },
  {
    "text": "AUDIENCE: We'll be here at 3:00. WILLIAM GREEN JR:\nThey'll be here. So if you want to\ncome at class period, and just ask\nquestions and stuff. AUDIENCE: And I'll have your\nPSAT graded back, if you like.",
    "start": "70137",
    "end": "78140"
  },
  {
    "text": "WILLIAM GREEN JR:\nAll right, got that? PSAT be ready as well. OK, so I'll talk\nabout today ODE-IVPs.",
    "start": "78140",
    "end": "86850"
  },
  {
    "text": "AUDIENCE: Yeah, we'll still have\noffice hours Monday [INAUDIBLE] WILLIAM GREEN JR: Can\nyou guys hear this?",
    "start": "86850",
    "end": "93170"
  },
  {
    "text": "Yes, office hours\nlike normal Monday.  And for those of you who\nwant to get your homework",
    "start": "93170",
    "end": "100130"
  },
  {
    "text": "started early, we might\neven post homework. ",
    "start": "100130",
    "end": "114290"
  },
  {
    "text": "And I'm going to focus\nexclusively on ODE-IVPs",
    "start": "114290",
    "end": "121632"
  },
  {
    "text": "you can write this way. ",
    "start": "121632",
    "end": "131599"
  },
  {
    "text": "All right, and I\nwould just comment,",
    "start": "131600",
    "end": "136807"
  },
  {
    "text": "what do these things mean? ODE means ordinary\ndifferential equation. It means that the only\ndifferentials in the problem",
    "start": "136807",
    "end": "142856"
  },
  {
    "text": "are with respect\nto one variable, so I'm going to call that t. It can be z or x or\nwhatever you want,",
    "start": "142856",
    "end": "149069"
  },
  {
    "text": "but I'm going to call it t here. And so this is not partial\ndifferential equations",
    "start": "149070",
    "end": "154220"
  },
  {
    "text": "where you have differentials\nrespect to many variables. Initial value problems mean\nthat all the initial conditions",
    "start": "154220",
    "end": "164459"
  },
  {
    "text": "are given in at a\nsingle t point where t is that the variable that\nappears in the differential.",
    "start": "164460",
    "end": "170402"
  },
  {
    "text": " All right so this is the\nform we're going to do. This is first order a\nway of writing the ODEs.",
    "start": "170402",
    "end": "179880"
  },
  {
    "text": "If you recall from homework\nzero problem number one, we showed you there how you can\nwrite higher order differential",
    "start": "179880",
    "end": "186590"
  },
  {
    "text": "equations--  convert them into the\nform of first order.",
    "start": "186590",
    "end": "192650"
  },
  {
    "text": " And I guess that's\nworthwhile to point down.",
    "start": "192650",
    "end": "201134"
  },
  {
    "text": "I would also comment\nthat I going to just talk about f of y, however\nthe ODE solvers in Matlab",
    "start": "201134",
    "end": "208170"
  },
  {
    "text": "expect f of the t\ncomma y as their from.",
    "start": "208170",
    "end": "214599"
  },
  {
    "text": "All right, so let's just explain\nall the details about this.",
    "start": "214600",
    "end": "222820"
  },
  {
    "text": "So suppose I had a differential\nequation like this.",
    "start": "222820",
    "end": "227900"
  },
  {
    "start": "227900",
    "end": "238887"
  },
  {
    "text": "All right, so this is like a\ndifferential equation you'd have for a body move moving--",
    "start": "238887",
    "end": "246260"
  },
  {
    "text": "a particle moving with\nsome friction force on it and some time varying force.",
    "start": "246260",
    "end": "251760"
  },
  {
    "text": "Yeah? AUDIENCE: Are you going to\nbe posting your notes online? WILLIAM GREEN JR: No,\nI don't have any notes. This is it. ",
    "start": "251760",
    "end": "260579"
  },
  {
    "text": "All right, so this is a\ndifferential equation.",
    "start": "260579",
    "end": "266180"
  },
  {
    "text": "What you can do is to convert\nit into the form I have above, is to write a new variable, say\nv, that's defined to be dx dt.",
    "start": "266180",
    "end": "275100"
  },
  {
    "text": "That's the velocity. And has a time\ndependence, but I told you",
    "start": "275100",
    "end": "281344"
  },
  {
    "text": "I don't like time\ndependence, so I'm not going to write it that way. So we can also define\nanother variable.",
    "start": "281344",
    "end": "287340"
  },
  {
    "text": "So we can define our new y\nvector to be x, v, and t.",
    "start": "287340",
    "end": "297949"
  },
  {
    "text": " So this is y-- the\nfirst component of y, this is the second\ncomponent of y,",
    "start": "297950",
    "end": "304266"
  },
  {
    "text": "this is the third\ncomponent of y. And then I can write\ndown what f of y is.",
    "start": "304266",
    "end": "310110"
  },
  {
    "start": "310110",
    "end": "322000"
  },
  {
    "text": "So the equation for dx dt is y2.",
    "start": "322000",
    "end": "327190"
  },
  {
    "text": "It's the second component\nof y, dx dt is equal to v.",
    "start": "327190",
    "end": "332260"
  },
  {
    "text": "The equation for the dv dt\nis given by this equation.",
    "start": "332260",
    "end": "338750"
  },
  {
    "text": "So that's f of y3\nover m minus gamma y2.",
    "start": "338750",
    "end": "353442"
  },
  {
    "text": "And the equation\ndt dt is just one. ",
    "start": "353442",
    "end": "360390"
  },
  {
    "text": "So this is my f of y. So this is f1, f2, f3.",
    "start": "360390",
    "end": "365780"
  },
  {
    "text": "Is that all right?  So this is just how\nyou can convert--",
    "start": "365780",
    "end": "371655"
  },
  {
    "text": "if somebody writes you\nan equation this way, and you want to get it into the\nstandard form that I'm going to show you here--",
    "start": "371655",
    "end": "379699"
  },
  {
    "text": "dy dt equals f of y-- this is how you convert. ",
    "start": "379700",
    "end": "385710"
  },
  {
    "text": "And a skill we haven't\nreally emphasized so far in the course, but I think\na very important skill,",
    "start": "385710",
    "end": "391830"
  },
  {
    "text": "is to be able to get like a\nchemical engineering problem and rearrange it so it\nbecomes a standard form",
    "start": "391830",
    "end": "399630"
  },
  {
    "text": "that maps up to one of the\nsolvers you know how to use. So you've got a problem has\nsome differential in it.",
    "start": "399630",
    "end": "406259"
  },
  {
    "text": "Right away you actually,\ncan I somehow rewrite it so it looks like this standard\nform-- or actually for Matlab,",
    "start": "406260",
    "end": "411710"
  },
  {
    "text": "this form. So Matlab will say f of t, y.",
    "start": "411710",
    "end": "418800"
  },
  {
    "text": "If you can do that, then you can\ngo ahead and use those Matlab solvers to solve it.",
    "start": "418800",
    "end": "424230"
  },
  {
    "text": "But your variables may not have\na letter y appearing anywhere, right? You have to figure\nout how to write it",
    "start": "424230",
    "end": "429570"
  },
  {
    "text": "into the standard form. And then once you can do\nthat, you can use the solvers. And the same thing\nwith the non-linear",
    "start": "429570",
    "end": "436110"
  },
  {
    "text": "equations solvers, with\nthe optimization software. If you can rewrite\nit into the form that matches the standard form, then\nonce you're done, you're done.",
    "start": "436110",
    "end": "443310"
  },
  {
    "text": "Then you can just go and\ncall the canned programs that work well for those forms. ",
    "start": "443310",
    "end": "452130"
  },
  {
    "text": "All right, now what do\nwe want as the output? So this is the problem. This is the problem as proposed.",
    "start": "452130",
    "end": "458840"
  },
  {
    "text": "What do we really\nwant out of this? What we're going to get out\nof it is a bunch of points y--",
    "start": "458840",
    "end": "467190"
  },
  {
    "text": "actually a matrix, right? It would be a\nvector of y-values. Typically y is a vector. And we want to know it\na bunch of time points.",
    "start": "467190",
    "end": "475220"
  },
  {
    "text": "And we would a\nlot of time points so we're getting pretty plots\nof how the components of y vary with time.",
    "start": "475220",
    "end": "481404"
  },
  {
    "text": "That's what we usually want. Sometimes we just want the\nfinal value, y time value.",
    "start": "481404",
    "end": "487480"
  },
  {
    "text": "We integrate to some point\nand then stop, and just run through the final value. But a lot of times, we actually\nwant to make pretty plots, so we really want a lot of\npoints here and making plots.",
    "start": "487480",
    "end": "495250"
  },
  {
    "text": "Now how many points do you\nneed to make a nice plot? Maybe, I don't know,\n100 points, 50 points, you can make a nice plot. So that's the kind\nnumbers you'd like.",
    "start": "495250",
    "end": "502520"
  },
  {
    "text": "And so the output\nof these programs is going to be something like\na vector of the time points,",
    "start": "502520",
    "end": "510530"
  },
  {
    "text": "and then a matrix of the\ny-values corresponding",
    "start": "510530",
    "end": "520380"
  },
  {
    "text": "to each time point. And the way it does in\nthat lab, it's reasonable. Each row of y are\nthe y-values that",
    "start": "520380",
    "end": "527870"
  },
  {
    "text": "correspond to the same time\npoint, the first time point. So the first row of y\ncorresponds to the first number",
    "start": "527870",
    "end": "534470"
  },
  {
    "text": "in the time vector. The second run is the second. Last one will be at time final.",
    "start": "534470",
    "end": "541400"
  },
  {
    "text": "And then you can plot them. OK so far? ",
    "start": "541400",
    "end": "548940"
  },
  {
    "text": "And ideally, we would like\nthese y-values that we compute,",
    "start": "548940",
    "end": "556940"
  },
  {
    "text": "these y's we get\nout, ideally one that really close to\nwhat the true solution of the true differential\nequation is.",
    "start": "556940",
    "end": "563914"
  },
  {
    "text": "But we're doing numerical\nstuff, so it's never going to be exactly the same. And so a big part of the\neffort is trying to figure out,",
    "start": "563914",
    "end": "570340"
  },
  {
    "text": "how can we get the thing\nto compute y calculated at each time point\nto be as close as possible to the truth,\nof what the true solution",
    "start": "570340",
    "end": "576750"
  },
  {
    "text": "of the equations are? And that turns out\nto be difficult, so that's a very important\nthing to worry about.",
    "start": "576750",
    "end": "584010"
  },
  {
    "text": " What else can we say about this? ",
    "start": "584010",
    "end": "592100"
  },
  {
    "text": "We specify this from t naught,\nand you typically have to input",
    "start": "592100",
    "end": "597279"
  },
  {
    "text": "your t final, how far you want\nto go away from your t naught as another input.",
    "start": "597280",
    "end": "604000"
  },
  {
    "text": "Normally, people write it where\nt naught is less than t final, and so you're like integrating\nfrom left to right.",
    "start": "604000",
    "end": "610540"
  },
  {
    "text": "But you could actually write\nthem, put a negative sign equation which corresponds\nto a negative t, change your variable\nto of t prime that",
    "start": "610540",
    "end": "617140"
  },
  {
    "text": "was equal to t final\nminus t if you wanted to, and integrate the\nother direction. And in fact in homework zero\nproblem one, we did that too.",
    "start": "617140",
    "end": "626230"
  },
  {
    "text": "So you can integrate frontwards. You can integrate backwards. If somebody tells you the\ninitial condition or condition in the center of the range,\nyou integrate forward",
    "start": "626230",
    "end": "633810"
  },
  {
    "text": "for part of the range, and\nbackwards the other way, so anything like this. So what's important\nfor this to be what's called an initial\nvalue problem is just",
    "start": "633810",
    "end": "640140"
  },
  {
    "text": "that all of the\nspecifications of y are given at the\nsame value of t. It doesn't matter exactly\nwhat value of t it is.",
    "start": "640140",
    "end": "646480"
  },
  {
    "text": "Later, we'll talk\nabout what happens if you don't know all\nthe specifications at one value of time.",
    "start": "646480",
    "end": "652470"
  },
  {
    "text": "All right, now how\nwould you approach this?",
    "start": "652470",
    "end": "661250"
  },
  {
    "text": "Probably, a bunch of you've done\nthis already as undergraduates, or maybe even high school. You can write like\na Taylor expansion,",
    "start": "661250",
    "end": "668690"
  },
  {
    "text": "y of t plus delta t-- is y of t plus delta t--",
    "start": "668690",
    "end": "676550"
  },
  {
    "text": "times dy dt. ",
    "start": "676550",
    "end": "683560"
  },
  {
    "text": "You can write that. And then I say,\nwow, I know dy dt. That's actually f, so this\nis actually equal to--",
    "start": "683560",
    "end": "690045"
  },
  {
    "start": "690045",
    "end": "707750"
  },
  {
    "text": "right? And then if I truncate\nthe Taylor expansion, now I have an update formula. So if I just forget\nthis last bit,",
    "start": "707750",
    "end": "715600"
  },
  {
    "text": "I can put in my current value of\ny, like the initial condition. The initial condition\nhere, evaluate f,",
    "start": "715600",
    "end": "721000"
  },
  {
    "text": "multiply by delta t,\nadd them together, and I'll get a new value of y.",
    "start": "721000",
    "end": "726459"
  },
  {
    "text": "And then I can repeat\nover and over again. And in fact, this is\na very famous method. It's called the\nForward Euler method.",
    "start": "726460",
    "end": "732661"
  },
  {
    "text": "Euler was a pretty smart guy, so\nit's not completely ridiculous, but as I'll show you,\nit has some problems. ",
    "start": "732661",
    "end": "741000"
  },
  {
    "text": "So the Forward Euler, another\nway to write it is y new is equal to y old plus\ndelta t times f of y old.",
    "start": "741000",
    "end": "757026"
  },
  {
    "start": "757026",
    "end": "762510"
  },
  {
    "text": "It's called Forward Euler. ",
    "start": "762510",
    "end": "773090"
  },
  {
    "text": "And we can write a little\nimplementation of this",
    "start": "773090",
    "end": "781030"
  },
  {
    "text": "pretty easily. So you can write y\nis equal to y naught, t is equal to t\nnaught for i equals 1",
    "start": "781030",
    "end": "793625"
  },
  {
    "text": "to the number of\nsteps, y is equal to y",
    "start": "793625",
    "end": "802540"
  },
  {
    "text": "plus delta t times f of y, t\nis equal to t plus delta t.",
    "start": "802540",
    "end": "810082"
  },
  {
    "text": "Somewhere up here, I\nneed to write delta t. ",
    "start": "810082",
    "end": "821540"
  },
  {
    "text": "OK, so there's your code\nfor doing Forward Euler. How many of you have\ndone this before?",
    "start": "821540",
    "end": "827700"
  },
  {
    "text": "OK, so I can skip\nover this very fast.  How many did this, and it\ndidn't work for a problem?",
    "start": "827700",
    "end": "835236"
  },
  {
    "text": " OK, so you're not doing\nhard enough problems. Well, we'll correct that.",
    "start": "835236",
    "end": "843709"
  },
  {
    "text": "All right, so I noticed\nthat this closely resembles the rectangle rule.",
    "start": "843710",
    "end": "851350"
  },
  {
    "text": "So the rectangle rule\nwould look a lot the same. However, if you're\nintegrating a function--",
    "start": "851350",
    "end": "860830"
  },
  {
    "text": "so I have I is equal to\nthe integral of f of t dt,",
    "start": "860830",
    "end": "869110"
  },
  {
    "text": "then I can notice\nthat the derivative dI dt is equal to f of t.",
    "start": "869110",
    "end": "876100"
  },
  {
    "text": " And so if I was going to\ndo the rectangle rule,",
    "start": "876100",
    "end": "882995"
  },
  {
    "text": "it would look just the same as\nthis, except this would be a t. ",
    "start": "882995",
    "end": "888330"
  },
  {
    "text": "Maybe I would pick y0 to be 0. And the final value\nof y I would get to",
    "start": "888330",
    "end": "895250"
  },
  {
    "text": "would be my integral,\nmy i value that I want. So how many of you have\ndone rectangle rule?",
    "start": "895250",
    "end": "902490"
  },
  {
    "text": "Yes? All right, so you\ndid this already. Now you remember in high school,\nwhen they took the rectangle",
    "start": "902490",
    "end": "909180"
  },
  {
    "text": "rule, they probably mentioned\nthat it's not very accurate.",
    "start": "909180",
    "end": "914639"
  },
  {
    "text": "And so then they also\ntaught you some other ones. You guys, how many of you\nlearned the trapezoid rule? How about the midpoint rule?",
    "start": "914639",
    "end": "923040"
  },
  {
    "text": "How about Simpson's rule? All right, so at least a\nhigh school math teachers",
    "start": "923040",
    "end": "930380"
  },
  {
    "text": "thought that this is\ninadequate for doing real work,",
    "start": "930380",
    "end": "936661"
  },
  {
    "text": "so they tell you all these\nother things instead. This was like your\nfirst baby thing.",
    "start": "936661",
    "end": "942019"
  },
  {
    "text": "So let's talk\nabout why was that. ",
    "start": "942020",
    "end": "959780"
  },
  {
    "text": "So let's do the Taylor\nexpansion a little bit further. So let's do it for the\nnumeric [INAUDIBLE] case.",
    "start": "959780",
    "end": "968650"
  },
  {
    "text": "So y t plus delta t is equal\nto y of t plus delta t times",
    "start": "968650",
    "end": "977670"
  },
  {
    "text": "f of t plus 1/2 delta t squared\ntimes the second derivative.",
    "start": "977670",
    "end": "986910"
  },
  {
    "start": "986910",
    "end": "992319"
  },
  {
    "text": "And so when we made\nthe approximation to do the rectangle rule, we\njust threw this term away. So that's a leading\nterm that we threw away.",
    "start": "992320",
    "end": "999400"
  },
  {
    "text": "So we made an error\norder or delta t squared. Because normally the second\nderivative is not exactly zero.",
    "start": "999400",
    "end": "1006330"
  },
  {
    "text": "So we have an error\nin each step that's",
    "start": "1006330",
    "end": "1017330"
  },
  {
    "text": "the order of delta t squared. But how many steps do we make? The number of steps is\nequal to t final minus t",
    "start": "1017330",
    "end": "1027225"
  },
  {
    "text": "naught over delta t.  So therefore, we're making\none over delta t order steps.",
    "start": "1027225",
    "end": "1036660"
  },
  {
    "text": "So the total error is going\nto be approximately the number of steps times how much\nerror you making each step.",
    "start": "1036660",
    "end": "1041699"
  },
  {
    "text": "So it's going to be something\nthe second power in delta t divided by something to\nthe first power of delta t. So the total error\nin the integral I",
    "start": "1041700",
    "end": "1053730"
  },
  {
    "text": "is going to be older of delta\nt if you do the rectangle rule.",
    "start": "1053730",
    "end": "1059080"
  },
  {
    "text": "And so order delta\nt is not very good. So you want to increase\nyour accuracy--",
    "start": "1059080",
    "end": "1065870"
  },
  {
    "text": "if you cut your\nstep size in half, that means you\ndouble your CPU time, because you have to do twice\nas many function evaluations.",
    "start": "1065870",
    "end": "1071870"
  },
  {
    "text": "But you only gain-- you reduce\nyour error by a factor of two. So if you want to, say, gain\nthree significant figures",
    "start": "1071870",
    "end": "1079510"
  },
  {
    "text": "of accuracy in your\nnumber, then you have to do 1,000 times much\nwork as you did before.",
    "start": "1079510",
    "end": "1086769"
  },
  {
    "text": "So I have some amount\nof some precision with some number of steps. I want to increase, get three\nmore significant figures.",
    "start": "1086770",
    "end": "1092270"
  },
  {
    "text": "I'll have to do 1,000\ntimes as much work. That's kind of bad scaling. If I want to get six\nmore significant figures,",
    "start": "1092270",
    "end": "1098420"
  },
  {
    "text": "I've got to do a\nmillion times more work. So at some point, this going\nto be kind of expensive.",
    "start": "1098420",
    "end": "1105000"
  },
  {
    "text": "So if you contrast it, you can\ndo things like trapezoid rule.",
    "start": "1105000",
    "end": "1111730"
  },
  {
    "text": "And as you're probably-- well let's talk about\ntrapezoid rule for a bit.",
    "start": "1111730",
    "end": "1118193"
  },
  {
    "start": "1118193",
    "end": "1128030"
  },
  {
    "text": "So the idea of this is\nyou have your function, you have some point\nt, and t plus delta t.",
    "start": "1128030",
    "end": "1136340"
  },
  {
    "text": "You're trying to\nintegrate between them. Let's say t naught, t\nnaught plus delta t.",
    "start": "1136340",
    "end": "1143384"
  },
  {
    "text": "Try to integrate. Here's the value of\nthe function at t. Here is the value of the\nfunction that t plus delta t.",
    "start": "1143384",
    "end": "1153301"
  },
  {
    "text": "If you do the rectangle\nrule, what you say is I just draw a line here\nand integrate that rectangle.",
    "start": "1153301",
    "end": "1160125"
  },
  {
    "text": "But say the real function\nreally looks like this. Then I missing that area\nthere, so that's the error.",
    "start": "1160125",
    "end": "1167559"
  },
  {
    "text": "That's why the error's so big. If I do that trapezoid\nrule, then the error--",
    "start": "1167560",
    "end": "1177140"
  },
  {
    "text": "I actually overestimate\nthe value here, but the integral\nof the difference between this dotted\nline and the solid line",
    "start": "1177140",
    "end": "1183930"
  },
  {
    "text": "is less than the integral\nbetween the solid line and that dotted line,\nso its more accurate. So that's why people\nlike the trapezoid rule",
    "start": "1183930",
    "end": "1190470"
  },
  {
    "text": "better than the rectangle rule. If you did the\nmidpoint rule, you'd evaluate this function halfway\nbetween these two points",
    "start": "1190470",
    "end": "1200320"
  },
  {
    "text": "and then draw a dotted line\nhere and a dotted line there, and integrate that guy. And it would\noverestimate for part,",
    "start": "1200320",
    "end": "1207144"
  },
  {
    "text": "and underestimate for part,\nand they would partially cancel each other out. And so that also would be\nmore accurate than doing",
    "start": "1207144",
    "end": "1213589"
  },
  {
    "text": "the rectangle rule.  So you did it before.",
    "start": "1213589",
    "end": "1218620"
  },
  {
    "start": "1218620",
    "end": "1223740"
  },
  {
    "text": "And so what we're\ngoing to try to do is, instead of\nusing this formula we did before, we're going to\nreplace this with something",
    "start": "1223740",
    "end": "1231870"
  },
  {
    "text": "else that I'm going to call g. And g is something\nthat's supposed",
    "start": "1231870",
    "end": "1237040"
  },
  {
    "text": "to be the average value\nof f over the step. Instead of just taking the\nvalue f at the starting point,",
    "start": "1237040",
    "end": "1245410"
  },
  {
    "text": "I want to get sort\nof the average. Right, because an\nintegral is related to an average over the delta t.",
    "start": "1245410",
    "end": "1251170"
  },
  {
    "text": "So g is going to be my way\nto estimate the average. And there's going to\nbe a zillion update",
    "start": "1251170",
    "end": "1256429"
  },
  {
    "text": "formulas that different\nmathematicians have proposed over the years. They give you different g's that\ntell you how to do the update.",
    "start": "1256429",
    "end": "1262250"
  },
  {
    "text": " And the key is try to find\na g that's really accurate.",
    "start": "1262250",
    "end": "1267500"
  },
  {
    "text": "You want to have one that's\nthe most accurate you can, because then your\nerrors will be less. And if your errors are\nless, than your delta t can",
    "start": "1267500",
    "end": "1273910"
  },
  {
    "text": "be bigger, which means your\nnumber of steps will be less, which means your CPU\ntime will be less.",
    "start": "1273910",
    "end": "1279700"
  },
  {
    "text": "So you might be able\nto get more accuracy and use less CPU\ntime both if you can find a really good\nformula for g, for the update.",
    "start": "1279700",
    "end": "1286575"
  },
  {
    "text": " So what's the g for\nthe trapezoid rule?",
    "start": "1286575",
    "end": "1292669"
  },
  {
    "text": " It's f of t plus f of\nt plus delta t over 2.",
    "start": "1292670",
    "end": "1306190"
  },
  {
    "text": "That was the g you used when\nyou did the trapezoid rule when you were kids.",
    "start": "1306190",
    "end": "1311440"
  },
  {
    "text": "What is the g for\nthe midpoint rule? ",
    "start": "1311440",
    "end": "1317280"
  },
  {
    "text": "It's f of t plus delta t over 2.",
    "start": "1317280",
    "end": "1322382"
  },
  {
    "text": " And so the different g's\nare called different update",
    "start": "1322382",
    "end": "1328640"
  },
  {
    "text": "formulas. And these particular\nones reduce the error",
    "start": "1328640",
    "end": "1334740"
  },
  {
    "text": "from delta t squared for\n[INAUDIBLE] step to, I think,",
    "start": "1334740",
    "end": "1340770"
  },
  {
    "text": "delta t to the cubed power. And then when you multiply\nby this 1 every delta t,",
    "start": "1340770",
    "end": "1347670"
  },
  {
    "text": "it turns out you go from\nbeing order of delta t to order of delta t squared,\nand that's a really big change.",
    "start": "1347670",
    "end": "1355840"
  },
  {
    "text": "So now if I cut the step\nsize by a factor of 10, I gain a factor of\n100 in the accuracy.",
    "start": "1355840",
    "end": "1363904"
  },
  {
    "text": "If I want to get six\nmore significant figures, I do 1,000 times more work,\nnot a million times more work.",
    "start": "1363904",
    "end": "1368909"
  },
  {
    "text": "So it's a pretty\nsignificant improvement. And then people have pushed\nthis on further and further.",
    "start": "1368910",
    "end": "1374640"
  },
  {
    "text": "And so actually very\ncommon integrators that you might use\nnowadays would go out to fourth and fifth\norder methods.",
    "start": "1374640",
    "end": "1382160"
  },
  {
    "text": "And so they have\ncomplicated update formulas that are carefully\ndesigned to cancel out all the low order delta t errors\nand just leave very high order",
    "start": "1382160",
    "end": "1389279"
  },
  {
    "text": "ones. And that's kind of the-- typical ones are like that. And then some fancy ones might\ngo even up to eighth order,",
    "start": "1389280",
    "end": "1395446"
  },
  {
    "text": "I've seen, if you're\nreally pushing it. You have really complicated\ng formulas then. ",
    "start": "1395446",
    "end": "1407260"
  },
  {
    "text": "Now, this is all\nfor the integration, but really our problem was\nthat the ODEs [INAUDIBLE]..",
    "start": "1407260",
    "end": "1415950"
  },
  {
    "text": "So we have to do\nf of y not f of t.",
    "start": "1415950",
    "end": "1421779"
  },
  {
    "text": "Let's see if I\ncan show you that. Yeah, so we did the rectangle\nrule, we had f of t.",
    "start": "1421780",
    "end": "1432139"
  },
  {
    "text": "But the real problem is\nwe have to do f of y. Now the problem\nis, we don't know",
    "start": "1432140",
    "end": "1437690"
  },
  {
    "text": "what y is, y is our unknown. So we generally\nhave a problem here.",
    "start": "1437690",
    "end": "1443880"
  },
  {
    "text": "In Forward Euler, we can get\naway with it because we just put the y old value in.",
    "start": "1443880",
    "end": "1448930"
  },
  {
    "text": "Like for example, if we\nwanted to do midpoint here,",
    "start": "1448930",
    "end": "1454450"
  },
  {
    "text": "we'd have to know f at\na different time point that we haven't computed yet,\nbecause it's forward in time.",
    "start": "1454450",
    "end": "1460259"
  },
  {
    "text": "Same thing with\ntrapezoidal rule. We have to know f at\nsome future timepoint. So it's not so easy,\nactually, to go directly",
    "start": "1460260",
    "end": "1466539"
  },
  {
    "text": "from these formulas to some\nexplicit formula like this with a g in here, where\nthe things inside g,",
    "start": "1466540",
    "end": "1473809"
  },
  {
    "text": "the y's inside g, are all\ny-values we actually know. So this is a serious problem.",
    "start": "1473810",
    "end": "1479729"
  },
  {
    "start": "1479729",
    "end": "1485600"
  },
  {
    "text": "But this didn't stop\npeople from doing it. So one idea is you could go\nback to the Taylor expansion,",
    "start": "1485600",
    "end": "1494240"
  },
  {
    "text": "and now do the Taylor expansion\nbut in terms of f of y.",
    "start": "1494240",
    "end": "1501450"
  },
  {
    "text": "So this is f of y of t.  And then over here, this\nis d squared y dt squared,",
    "start": "1501450",
    "end": "1512140"
  },
  {
    "text": "but dy dt is f, so\nthis is really df dt.",
    "start": "1512140",
    "end": "1520470"
  },
  {
    "text": "But f is actually not a function\nof t, it's a function of y, right? But we can do chain rule. So df dt is equal to\nthe sum df dyn dyn dt.",
    "start": "1520470",
    "end": "1541440"
  },
  {
    "text": " But dyn dt is f.",
    "start": "1541440",
    "end": "1548680"
  },
  {
    "text": "And this is what we call\nthe Jacobian [INAUDIBLE].. So this is really saying that\nthis is equal to J times f.",
    "start": "1548680",
    "end": "1556558"
  },
  {
    "text": " So that would be\none possibility, is you could go and write\nthe Taylor expansion",
    "start": "1556558",
    "end": "1562846"
  },
  {
    "text": "out to the next higher\norder explicitly, putting in J times f\nhere, and then just",
    "start": "1562846",
    "end": "1568580"
  },
  {
    "text": "being in the cubic terms. Now, people don't\ndo this usually. Any idea why this is not\na popular thing to do?",
    "start": "1568580",
    "end": "1575720"
  },
  {
    "text": " Yeah? AUDIENCE: It's computationally\nexpensive to [INAUDIBLE]..",
    "start": "1575720",
    "end": "1582059"
  },
  {
    "text": "WILLIAM GREEN JR: That's right. That's right. So how many function\nevaluations does it take to get the Jacobian? ",
    "start": "1582059",
    "end": "1592270"
  },
  {
    "text": "Right, so each function\nis n values, right,",
    "start": "1592270",
    "end": "1597390"
  },
  {
    "text": "because it's a vector. And you have to do at least,\nsay, forward differences",
    "start": "1597390",
    "end": "1603530"
  },
  {
    "text": "would be n function evaluations. So instead of just doing\none function evaluation",
    "start": "1603530",
    "end": "1608700"
  },
  {
    "text": "like we were doing with\nthe Forward Euler, now we have to do n plus 1,\nor something like that, function evaluations.",
    "start": "1608700",
    "end": "1614190"
  },
  {
    "text": "And actually, you probably\nwant to use center differences, so you need 2 times n plus 1.",
    "start": "1614190",
    "end": "1619260"
  },
  {
    "text": "And if you do them analytically,\nunless it's sparse, it's still going to be really\nexpensive to compute it.",
    "start": "1619260",
    "end": "1624670"
  },
  {
    "text": "So it's a lot more\neffort to do it. So you need to think, well,\nis it really worth it? And so people have found\nother formulas that basically",
    "start": "1624670",
    "end": "1631410"
  },
  {
    "text": "get rid of the delta\nt squared term that don't require so much\neffort, and so that's what people do instead.",
    "start": "1631410",
    "end": "1637224"
  },
  {
    "text": "But this is an option. You could do it. ",
    "start": "1637224",
    "end": "1645580"
  },
  {
    "text": "All right, so\ninstead, what people do is they've decided to\ngeneralize the midpoint rule",
    "start": "1645580",
    "end": "1652809"
  },
  {
    "text": "and try to figure\nout, how can we get an estimate of the midpoint\nvalue that's cheap to evaluate?",
    "start": "1652810",
    "end": "1659380"
  },
  {
    "text": "And so what they\nsay is, well, this is g midpoint for\nnumerical integration. Let's make an new g\nmidpoint that works",
    "start": "1659380",
    "end": "1665980"
  },
  {
    "text": "for when f is a function of y. So let's make it\nfunction of y evaluated",
    "start": "1665980",
    "end": "1672700"
  },
  {
    "text": "at t plus delta t over 2. ",
    "start": "1672700",
    "end": "1679787"
  },
  {
    "text": "So that's what the\nformula looks like. But then you say,\nwell, I don't know y is at t plus delta t\nover 2, because I only",
    "start": "1679787",
    "end": "1685510"
  },
  {
    "text": "know it at y of t. So then they say, well, let's\ndo Forward Euler for that. So then they say, well, let's\nsay it's approximately f of--",
    "start": "1685510",
    "end": "1694720"
  },
  {
    "text": " what's the Forward\nEuler formula?",
    "start": "1694720",
    "end": "1700380"
  },
  {
    "text": "It's y of t plus delta t\nover 2 times f of y of t.",
    "start": "1700380",
    "end": "1708442"
  },
  {
    "text": " How many parenthesis there? ",
    "start": "1708442",
    "end": "1718409"
  },
  {
    "text": "So this is the formula\nthat's actually",
    "start": "1718410",
    "end": "1723680"
  },
  {
    "text": "used in practice a lot. And this one is called\nRunge-Kutta two, second order Runge-Kutta formula.",
    "start": "1723680",
    "end": "1730030"
  },
  {
    "text": "And it's just a-- it's the midpoint rule where\nwe estimate the value of y of t",
    "start": "1730030",
    "end": "1736399"
  },
  {
    "text": "plus delta t using\nForward Euler. And the advantage of this\nis it's very cheap, right? Just evaluate-- I just have\nto evaluate one function here,",
    "start": "1736400",
    "end": "1745152"
  },
  {
    "text": "one function here, so\ntwo function calls. ",
    "start": "1745152",
    "end": "1750269"
  },
  {
    "text": "[INAUDIBLE] and that way I\ncan get an update formula.",
    "start": "1750269",
    "end": "1756860"
  },
  {
    "text": "And this one, turns out\nthat it has the nice delta t scaling that you might like. ",
    "start": "1756860",
    "end": "1764640"
  },
  {
    "text": "So that's the kind\nof thing people do. And the Runge-Kutta\nguys went crazy,",
    "start": "1764640",
    "end": "1770600"
  },
  {
    "text": "and so one of the\nmost popular solvers is called Runge-Kutta four five,\nand that's the ODE four five",
    "start": "1770600",
    "end": "1776920"
  },
  {
    "text": "program in Matlab. And what that does is the\nfourth order extension of this, and the fifth order\nextension of this.",
    "start": "1776920",
    "end": "1782840"
  },
  {
    "text": "And it uses them both,\nand it compares them, and uses the difference\nbetween an estimate the error",
    "start": "1782840",
    "end": "1787900"
  },
  {
    "text": "in the calculation. And then uses that to decide\nwhat size delta t you need, depending on what\ntolerances you demand.",
    "start": "1787900",
    "end": "1794100"
  },
  {
    "text": " And the formulas for all those--",
    "start": "1794100",
    "end": "1799352"
  },
  {
    "text": "[INAUDIBLE] formulas are\ngiven in the textbook. ",
    "start": "1799352",
    "end": "1806810"
  },
  {
    "text": "Now, this starts to\nlead the problem. So we weren't able to actually\nevaluate the true g midpoint,",
    "start": "1806810",
    "end": "1814230"
  },
  {
    "text": "which we'd like to be here. Instead, we have to use\nsome approximation in order to extrapolate\nforwards to the y.",
    "start": "1814230",
    "end": "1821480"
  },
  {
    "text": "So this is hinting\nat the whole problem. This whole problem is actually\nwe're just extrapolating.",
    "start": "1821480",
    "end": "1826610"
  },
  {
    "text": "We know the true value\nof y only at t naught, and all the rest we're doing\nis extrapolating forwards.",
    "start": "1826610",
    "end": "1834950"
  },
  {
    "text": "And we're do it\nover and over again, so we're going to\ndo it for n steps. Maybe we'll do 1,000 steps.",
    "start": "1834950",
    "end": "1840570"
  },
  {
    "text": "So you're extrapolating. And then based on\nthat extrapolation, you going to extrapolate again. And then based on extrapolation,\nyou going to extrapolate again.",
    "start": "1840570",
    "end": "1847610"
  },
  {
    "text": "And you can see that this is\nnot really the most robust thing to do, right? Because if you have\nany experience,",
    "start": "1847610",
    "end": "1854090"
  },
  {
    "text": "you're not that comfortable\nextrapolating at all. And then you have to\nextrapolate 1,000 times.",
    "start": "1854090",
    "end": "1860350"
  },
  {
    "text": "You should be a little bit\nworried about what can happen. So let's think about how\nthe error will propagate.",
    "start": "1860350",
    "end": "1865500"
  },
  {
    "text": "So we're going to have\nsome errors while we do these extrapolations. ",
    "start": "1865500",
    "end": "1878780"
  },
  {
    "text": "So we have here a t naught,\nt naught, we're happy. We know y naught.",
    "start": "1878780",
    "end": "1884810"
  },
  {
    "text": "This is exact. We're like woohoo. We know one value\nof y, really good.",
    "start": "1884810",
    "end": "1889940"
  },
  {
    "text": "All right, so now the\nquestion is the first step. Now we're going\nto get to value y1",
    "start": "1889940",
    "end": "1896360"
  },
  {
    "text": "that we compute with\none of the formulas, and it's going to be\ngood to some accuracy depending on how good or\ng is, our update formula.",
    "start": "1896360",
    "end": "1903470"
  },
  {
    "text": "And so it's going\nto have an error.  I should comment\nthat this y naught,",
    "start": "1903470",
    "end": "1910290"
  },
  {
    "text": "although we treat it as exact,\nit could have an error too. But it will probably be more\nlike a machine precision kind of error because\nwe don't really",
    "start": "1910290",
    "end": "1917010"
  },
  {
    "text": "know the initial\nconditions that well. Or might be an\nexperimental error about how well we know what\nthe initial conditions are. But I'm not going to worry\nabout that one for now.",
    "start": "1917010",
    "end": "1922590"
  },
  {
    "text": "But be aware, this is\ntrue, we don't really know initial conditions\nperfectly either.",
    "start": "1922590",
    "end": "1927700"
  },
  {
    "text": "But certainly, even if we treat\nthis as being known perfectly, we're going to have some error\nby the time we extrapolate",
    "start": "1927700",
    "end": "1933450"
  },
  {
    "text": "to y1. So now what happens at y2? So now we've added some\nmore, so now we're at t2.",
    "start": "1933450",
    "end": "1941780"
  },
  {
    "text": "And we see started from\ny1 true plus some error.",
    "start": "1941780",
    "end": "1948350"
  },
  {
    "text": "This is y-- y naught was true.  Now we're starting from y1\ntrue with some error in it,",
    "start": "1948350",
    "end": "1955520"
  },
  {
    "text": "because of a mistake\nwe made the first step. And now we see how that\nstep propagates further.",
    "start": "1955520",
    "end": "1962240"
  },
  {
    "text": "So let's see what\nthat's going to say. Well say y2 is going to\nequal y1 plus delta t times",
    "start": "1962240",
    "end": "1973400"
  },
  {
    "text": "some update formula\nwhich would depend on y1. ",
    "start": "1973400",
    "end": "1980770"
  },
  {
    "text": "But y1 was not true\nanymore, so this is actually equal to what should have\nbeen the true value of y1",
    "start": "1980770",
    "end": "1985990"
  },
  {
    "text": "if we only knew what it\nwas, but we don't know. And we have our error that\nwe don't know exactly how",
    "start": "1985990",
    "end": "1991480"
  },
  {
    "text": "big it is that we added on. And then we have another\nterm from this guy,",
    "start": "1991480",
    "end": "1998980"
  },
  {
    "text": "so it's going to\nbe delta t times g of y1 true plus delta 1.",
    "start": "1998980",
    "end": "2008520"
  },
  {
    "text": " And then we know our update\nformula's not right anyway,",
    "start": "2008520",
    "end": "2014240"
  },
  {
    "text": "so there's actually\nanother error, delta 2, just because of the error\nin the update formula.",
    "start": "2014240",
    "end": "2019621"
  },
  {
    "start": "2019621",
    "end": "2025030"
  },
  {
    "text": "Now if we had a\ngreat update formula, these deltas are kind of small. ",
    "start": "2025030",
    "end": "2032240"
  },
  {
    "text": "And if somehow, by\nluck, our delta 1 was 0,",
    "start": "2032240",
    "end": "2037844"
  },
  {
    "text": "and we had a great\nupdate formula, then we think that this error in\ny2 is going to be pretty small. ",
    "start": "2037844",
    "end": "2044440"
  },
  {
    "text": "But it's not true. So really the errors\nare pretty big. ",
    "start": "2044440",
    "end": "2050879"
  },
  {
    "text": "So let's see if we\ncan figure out-- we're going to do a\nTaylor expansion here,",
    "start": "2050880",
    "end": "2057010"
  },
  {
    "text": "so this'll be g of\ny1 true plus d dgy--",
    "start": "2057010",
    "end": "2067138"
  },
  {
    "text": "the Jacobian of g\nwith respect to y-- times the delta 1.",
    "start": "2067139",
    "end": "2073199"
  },
  {
    "text": "That's the first order\nTaylor extension. All right, so now\nlet's group the terms.",
    "start": "2073199",
    "end": "2078550"
  },
  {
    "start": "2078550",
    "end": "2088679"
  },
  {
    "text": "So y2 is equal to y1 true\nplus the update formula of y1",
    "start": "2088679",
    "end": "2098579"
  },
  {
    "text": "true plus the error\nin our update formula",
    "start": "2098580",
    "end": "2103710"
  },
  {
    "text": "if we had started\nat the true value. So this is what we--",
    "start": "2103710",
    "end": "2109780"
  },
  {
    "text": "if somebody told us what\nthe true value of y1, this is the size error we'd expect. It's to be that little\nerror we calculated before.",
    "start": "2109780",
    "end": "2117390"
  },
  {
    "text": "But then on top of it, we\nhave these other terms. We have a delta 1, because\ny1 was not the true value.",
    "start": "2117390",
    "end": "2125490"
  },
  {
    "text": "Sorry, I lost a delta t here. ",
    "start": "2125490",
    "end": "2131490"
  },
  {
    "text": "And then we have delta t\ntimes dg dy times delta 1.",
    "start": "2131490",
    "end": "2146080"
  },
  {
    "text": "And I'll emphasize\nthese are all vectors. ",
    "start": "2146080",
    "end": "2153283"
  },
  {
    "text": "I think that's it if we\nonly keep to first order. ",
    "start": "2153283",
    "end": "2160140"
  },
  {
    "text": "So what is this thing? This is a matrix, right, dg dy.",
    "start": "2160140",
    "end": "2166833"
  },
  {
    "text": "I could write it this way. It's the identity matrix plus\ndelta t times the Jacobian dg",
    "start": "2166833",
    "end": "2173980"
  },
  {
    "text": "dy times the vector d1. ",
    "start": "2173980",
    "end": "2181990"
  },
  {
    "text": "And you can see, at every\niteration when I do this, I'm going to get a\nsimilar factor like this.",
    "start": "2181990",
    "end": "2187500"
  },
  {
    "text": "And it's going to\nagain multiply delta 1. I keep on multiplying the-- errors from my\nprevious step keep",
    "start": "2187500",
    "end": "2193760"
  },
  {
    "text": "getting multiplied by\nthis kind of factor. So it's going to be\nreally important to us",
    "start": "2193760",
    "end": "2198840"
  },
  {
    "text": "about what the norm\nof this matrix is. ",
    "start": "2198840",
    "end": "2212641"
  },
  {
    "text": "What's going to happen if the\nnormal of this matrix is big? ",
    "start": "2212641",
    "end": "2218452"
  },
  {
    "text": "What's going to happen? AUDIENCE: [INAUDIBLE] WILLIAM GREEN JR: That's\nright, the error's going to get multiplied\nby some factor,",
    "start": "2218452",
    "end": "2224210"
  },
  {
    "text": "say bigger than 1,\nevery iteration. And after we go 1,000\niterations, how big is the error going to be?",
    "start": "2224210",
    "end": "2231770"
  },
  {
    "text": "Really big, right? Even if that thing is quite\nclose to 1, 1 plus something to the 1,000 power\nit's gigantic.",
    "start": "2231770",
    "end": "2238760"
  },
  {
    "text": "So what was originally\na pretty small error-- because we chose\na good g method-- is going to get multiplied by\nthis huge amplification factor.",
    "start": "2238760",
    "end": "2246019"
  },
  {
    "text": "So the key thing\nfor a method to be what is called\nnumerically stable is that the norm of this matrix\nhas got to be less than 1.",
    "start": "2246020",
    "end": "2255280"
  },
  {
    "text": "Or maybe even equal,\nequals 1 might be OK. If this is much bigger\nthan 1, you're doomed.",
    "start": "2255280",
    "end": "2260859"
  },
  {
    "text": "Your numeric order is\njust going to blow up from step to step to step.",
    "start": "2260860",
    "end": "2266094"
  },
  {
    "text": "And what's bad about it,\nis actually sometimes you might not even\nbe aware of this. So you'll get some solution,\nbecause it still will calculate",
    "start": "2266094",
    "end": "2272860"
  },
  {
    "text": "some numbers for the y's at\neach type-- y1, y2, y3, y4-- it's just running\nthrough the calculation.",
    "start": "2272860",
    "end": "2280740"
  },
  {
    "text": "But the numbers may become\nincreasingly meaningless further away from the y true as\ntime goes on, as the steps go.",
    "start": "2280740",
    "end": "2287970"
  },
  {
    "start": "2287970",
    "end": "2294275"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]",
    "start": "2294275",
    "end": "2300099"
  },
  {
    "text": "WILLIAM GREEN JR: Yes, it can. Yeah, so that's what we call a\nstable numerical method is one that, if you make an\nerror in an earlier step,",
    "start": "2300100",
    "end": "2306440"
  },
  {
    "text": "its impact diminishes\nas the steps go on. That's what you want. You can't always achieve this.",
    "start": "2306440",
    "end": "2312580"
  },
  {
    "text": "But if you can,\nthat's really great. Then that's you would call\na really stable, robust kind",
    "start": "2312580",
    "end": "2317930"
  },
  {
    "text": "of method. Even though I give you\nsome stupidity early on, my stupidity\nevaporates away, and it",
    "start": "2317930",
    "end": "2323570"
  },
  {
    "text": "goes to the true solution. That's what you want. ",
    "start": "2323570",
    "end": "2328847"
  },
  {
    "text": "OK, so let's think of\ncases where it's going to be problematic for sure. So if dg dy--",
    "start": "2328847",
    "end": "2336680"
  },
  {
    "text": "say if all it's\neigenvalues are positive and you add it to\nidentity matrix,",
    "start": "2336680",
    "end": "2343540"
  },
  {
    "text": "the thing is still going to\nhave eigenvalues bigger than 1. Can you see that?",
    "start": "2343540",
    "end": "2349349"
  },
  {
    "text": "And actually, what do we\nsay when dg dy is positive, has a positive eigenvalue? You guys have a word\nfor this already",
    "start": "2349350",
    "end": "2354599"
  },
  {
    "text": "you learn in your\ndifferential equations class. What do you call these kind\nof differential equations?",
    "start": "2354600",
    "end": "2360030"
  },
  {
    "text": "Maybe not dg dy. Back up, how about df dy? If df dy, if that Jacobian\nhas a positive eigenvalue,",
    "start": "2360030",
    "end": "2366270"
  },
  {
    "text": "what do you say? ",
    "start": "2366270",
    "end": "2374230"
  },
  {
    "text": "You guys remember this? So this is what we call\nunstable differential equations.",
    "start": "2374230",
    "end": "2379700"
  },
  {
    "text": "So if it has any\npositive eigenvalues, then two initial conditions that\ndiffer by a little differential",
    "start": "2379700",
    "end": "2389900"
  },
  {
    "text": "exponentially separate\nas time goes on as long as the difference as any\nprojection in the direction",
    "start": "2389900",
    "end": "2396049"
  },
  {
    "text": "of the bad eigenvector. So those are called\nnumerically unstable.",
    "start": "2396050",
    "end": "2401970"
  },
  {
    "text": "A lot of those actually\nexist in reality. So explosions,\nthat's because you",
    "start": "2401970",
    "end": "2408030"
  },
  {
    "text": "had some positive eigenvalue\nsomewhere for example. Amplifiers, like\nyou buy an amplifier",
    "start": "2408030",
    "end": "2414089"
  },
  {
    "text": "to crank up the music, you\nget positive feedback when-- remember Professor Swan\nwalked to some strange place,",
    "start": "2414090",
    "end": "2420359"
  },
  {
    "text": "and for some reason, he got\nthe feedback from the speakers? So he had a positive\neigenvalue going there. A little tiny noise and\nhis microphone, and it",
    "start": "2420360",
    "end": "2426716"
  },
  {
    "text": "amplified to a big squeak. So there are real systems\nlike this that amplify.",
    "start": "2426716",
    "end": "2431790"
  },
  {
    "text": "And sometimes we\nwant to model them, like explosions for examples. That's a pretty important\nfor chemical engineers.",
    "start": "2431790",
    "end": "2437820"
  },
  {
    "text": "But it's going to be really\ntough, because if it's got positive eigenvalues,\nthen this is probably going",
    "start": "2437820",
    "end": "2444990"
  },
  {
    "text": "to have a norm bigger than 1. And then whatever\nlittle errors we may get any step in\nthe whole calculation,",
    "start": "2444990",
    "end": "2450070"
  },
  {
    "text": "we're going to amplify\nand amplify and amplify. And who knows if\nwe're going to have any reality left in our solution\nby the time we get to the end.",
    "start": "2450070",
    "end": "2457109"
  },
  {
    "start": "2457110",
    "end": "2462642"
  },
  {
    "text": "All right, so that's\none kind of problem. ",
    "start": "2462642",
    "end": "2469520"
  },
  {
    "text": "So how about we have a problem\nthat's intrinsically stable. That means that\nall the eigenvalues",
    "start": "2469520",
    "end": "2476140"
  },
  {
    "text": "of the Jacobian of the\noriginal problem are negative. So the thing should\nbe perfectly stable.",
    "start": "2476140",
    "end": "2482770"
  },
  {
    "text": "From whatever initial\ncondition they started from, the whole thing should\nsort of come down to like an equilibrium point.",
    "start": "2482770",
    "end": "2488299"
  },
  {
    "text": "So that's a pretty\ncommon situation in chemical engineering too. You start from some\nstate, and it relaxes down",
    "start": "2488300",
    "end": "2494410"
  },
  {
    "text": "to like an equilibrium\nstate or a steady state. Well-behaved systems\nact like that.",
    "start": "2494410",
    "end": "2499490"
  },
  {
    "text": "So what I'm going\nto show you is that, despite the fact that the\ndf dy is well-behaved,",
    "start": "2499490",
    "end": "2508470"
  },
  {
    "text": "it's possible that this\nsum matrix might still be poorly behaved and still\nhave a norm bigger that one.",
    "start": "2508470",
    "end": "2516960"
  },
  {
    "text": "And so that means you\nstarted for a problem that was pretty well-behaved, and\nyou broke it by your choice in numerical method.",
    "start": "2516960",
    "end": "2524030"
  },
  {
    "text": "So this is a very bad one. This is the kind that can\nmake you really embarrassed",
    "start": "2524030",
    "end": "2529370"
  },
  {
    "text": "if you're working in a company. Your boss gives you a problem. He says, please tell me the time\nis going to take our reactor",
    "start": "2529370",
    "end": "2536060"
  },
  {
    "text": "to relax after a start up. the system is\nperfectly well-behaved. He gives these\nbeautiful equations",
    "start": "2536060",
    "end": "2541190"
  },
  {
    "text": "that your previous\ncoworker worked out. Everything's fine. You put it in there. You use your stupid\nnumerical solver,",
    "start": "2541190",
    "end": "2546800"
  },
  {
    "text": "and you get a wild oscillation,\nand the thing blows up. OK, and that's going to be\nbecause of a poor choice of g",
    "start": "2546800",
    "end": "2553609"
  },
  {
    "text": "so that it makes this norm of\nthis matrix bigger than one.",
    "start": "2553610",
    "end": "2559700"
  },
  {
    "text": "It's pretty easy\nfor that to happen. So you don't need a very\ncomplicated case to show it.",
    "start": "2559700",
    "end": "2564792"
  },
  {
    "start": "2564792",
    "end": "2572930"
  },
  {
    "text": "So let's just do a scalar case. ",
    "start": "2572930",
    "end": "2578150"
  },
  {
    "text": "Say dy dt is equal\nto negative 2y.  So this is a well-behaved\ndifferential equation.",
    "start": "2578150",
    "end": "2585370"
  },
  {
    "text": "What's the solution? So with a y naught y at\nt equals 0 is equal to 1.",
    "start": "2585370",
    "end": "2594335"
  },
  {
    "text": " What's the solution?",
    "start": "2594335",
    "end": "2599780"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] WILLIAM GREEN JR:\nYeah, OK, so it's",
    "start": "2599780",
    "end": "2605790"
  },
  {
    "text": "perfectly well-behaved function. And the plot when you\nplot it, here's one.",
    "start": "2605790",
    "end": "2611460"
  },
  {
    "text": "It goes [PLANE DIVING NOISE]. ",
    "start": "2611460",
    "end": "2616800"
  },
  {
    "text": "So now let's solve this with\nthe Forward Euler method. So I'm going to say\nthat y new is equal to y",
    "start": "2616800",
    "end": "2626690"
  },
  {
    "text": "plus delta t times f. ",
    "start": "2626690",
    "end": "2632570"
  },
  {
    "text": "So in this case, this is f,\nright there, negative 2y.",
    "start": "2632570",
    "end": "2638360"
  },
  {
    "text": "So for Forward\nEuler, this is just saying that this is negative 2y. ",
    "start": "2638360",
    "end": "2645350"
  },
  {
    "text": "All right, so let's\nchoose a delta t, say delta t equals\n1 to start with.",
    "start": "2645350",
    "end": "2652349"
  },
  {
    "text": "So we're going to compute. We start at t equals 0.",
    "start": "2652350",
    "end": "2657540"
  },
  {
    "text": "We're computing out to t\nequals 1. so we're out here. So we put 1 in here.",
    "start": "2657540",
    "end": "2664400"
  },
  {
    "text": "Our initial condition\nwas y was 1, so that's 1. So as 1 times negative\n2 times 1 is negative 2.",
    "start": "2664400",
    "end": "2673840"
  },
  {
    "text": "This is a 1. 1 minus 2 is negative 1.",
    "start": "2673840",
    "end": "2680770"
  },
  {
    "text": "So at the first step, it\ngoes from here down to there. ",
    "start": "2680770",
    "end": "2689379"
  },
  {
    "text": "This is not looking good.  This physical\nvariable is supposed",
    "start": "2689379",
    "end": "2695750"
  },
  {
    "text": "to be gradually\nrelaxing towards 0. Going negative is\nnot what you want. And then I think we could go\nthe next step, if you want.",
    "start": "2695750",
    "end": "2702990"
  },
  {
    "text": "So we can put in\nsuppose y is negative 1. And we're still doing\na delta t of one step.",
    "start": "2702990",
    "end": "2709640"
  },
  {
    "text": "So negative 1 times\nnegative 2 is positive 2. Plus negative 1, so this goes\nback to the starting point.",
    "start": "2709640",
    "end": "2718731"
  },
  {
    "text": "We'll get the sawtooth,\nis what you get.",
    "start": "2718731",
    "end": "2724484"
  },
  {
    "text": "And it turns out, actually,\nif you make delta t any larger than 1, then this\nsawtooth amplifies,",
    "start": "2724484",
    "end": "2730630"
  },
  {
    "text": "so you have a oscillating\nsolution that explodes. Which is a little bit different\nthan the physical solution,",
    "start": "2730630",
    "end": "2737170"
  },
  {
    "text": "which gently relaxes. ",
    "start": "2737170",
    "end": "2742230"
  },
  {
    "text": "And so this is just\na scalar equation that you guys could have\ndone in high school.",
    "start": "2742230",
    "end": "2748260"
  },
  {
    "text": "If you high school math\nteacher had been brave, he would have showed it you. But he don't want to ruin your\nfaith in the Forward Euler",
    "start": "2748260",
    "end": "2754682"
  },
  {
    "text": "method, so he just showed you\na simple one that worked out. ",
    "start": "2754682",
    "end": "2760319"
  },
  {
    "text": "Now you can make\nthis work better by making the delta t smaller. If you made the delta\nt small enough--",
    "start": "2760320",
    "end": "2767950"
  },
  {
    "text": "in this case, I think it's\ndelta t is less than half-- then this actually behaves\nsomewhat reasonably.",
    "start": "2767950",
    "end": "2775250"
  },
  {
    "text": "And so what's going on there\nis that the identity matrix",
    "start": "2775250",
    "end": "2781420"
  },
  {
    "text": "is positive. My Jacobian is negative.",
    "start": "2781420",
    "end": "2787880"
  },
  {
    "text": "And if I make delta\nt small enough, this big positive number\nis bigger than this smaller negative number, and the\nwhole thing stays positive",
    "start": "2787880",
    "end": "2794880"
  },
  {
    "text": "but less than 1, and so\nthen the normal is good. But if I make delta\nt too large, I",
    "start": "2794880",
    "end": "2801109"
  },
  {
    "text": "make this second\nterm much larger. If it gets much larger than 1,\nit overwhelms the first term.",
    "start": "2801110",
    "end": "2806390"
  },
  {
    "text": "The thing's negative, but I\nwhat do the norm it's positive.",
    "start": "2806390",
    "end": "2811480"
  },
  {
    "text": "And so it has an expansion. Then the negative is why\nwe get these oscillations. So if you ever do a numerical\ndifferential equation solution",
    "start": "2811480",
    "end": "2818290"
  },
  {
    "text": "and you start seeing\nthis kind of stuff, it's almost certainly related\nto this numerical instability",
    "start": "2818290",
    "end": "2826090"
  },
  {
    "text": "of the method. and not really a physical thing. I mean, there are\nphysical things that do this, but not too\noften in chemical engineering,",
    "start": "2826090",
    "end": "2832473"
  },
  {
    "text": "fortunately. All right, questions?",
    "start": "2832473",
    "end": "2838230"
  },
  {
    "text": "No questions, OK. So in the textbook, they\nhave a big discussion about how to evaluate\ndifferent g methods in order",
    "start": "2838230",
    "end": "2845190"
  },
  {
    "text": "to figure out if they're\nguaranteed to be stable, or under what conditions\nthey'll be stable.",
    "start": "2845190",
    "end": "2850410"
  },
  {
    "text": "And so that's worth\na look to see. And they have\ndetailed derivations",
    "start": "2850410",
    "end": "2855600"
  },
  {
    "text": "for several of them.  Questions?",
    "start": "2855600",
    "end": "2862444"
  },
  {
    "text": "All right, so for the\nhomework, homework four, you're going to have to\nwrite your own ODE solver.",
    "start": "2862444",
    "end": "2867870"
  },
  {
    "text": "So you'll do update\nformulas and compare them. When we come back\non Tuesday, I'll",
    "start": "2867870",
    "end": "2876180"
  },
  {
    "text": "show you how this\nis usually dealt with by switching to implicit\nsolvers and talk about that.",
    "start": "2876180",
    "end": "2884530"
  },
  {
    "text": "All right, have a good weekend. Enjoy the three days off. ",
    "start": "2884530",
    "end": "2890255"
  }
]