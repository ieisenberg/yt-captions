[
  {
    "text": " The following content is\nprovided under a Creative Commons license.",
    "start": "0",
    "end": "5300"
  },
  {
    "text": "Your support will help\nMIT OpenCourseWare continue to offer high quality\neducational resources for free.",
    "start": "5300",
    "end": "11600"
  },
  {
    "text": "To make a donation, or to\nview additional materials from hundreds of MIT courses,\nvisit MIT OpenCourseWare",
    "start": "11600",
    "end": "18100"
  },
  {
    "text": "at ocw.mit.edu. ",
    "start": "18100",
    "end": "23125"
  },
  {
    "text": "PROFESSOR: So today\nwe're going to talk about partial\ndifferential equations. Let me just give a quick\nreview where we are. So we're going to have\na PDE lecture today.",
    "start": "23125",
    "end": "31640"
  },
  {
    "text": "Then Professor Swan is going\nto do a review on Friday. There's no lecture on Monday,\nbut you have the quiz, too,",
    "start": "31640",
    "end": "40980"
  },
  {
    "text": "Monday night. Wednesday, next week is\nVeterans Day so it's a holiday.",
    "start": "40980",
    "end": "46452"
  },
  {
    "text": "There's no classes at MIT.  So the next time I'll\nbe lecturing to you",
    "start": "46452",
    "end": "51750"
  },
  {
    "text": "will be a week from Friday. The homework following\nthe quiz will be posted",
    "start": "51750",
    "end": "58340"
  },
  {
    "text": "and so you guys can\nget started on that. That homework involves\na COMSOL problem",
    "start": "58340",
    "end": "64140"
  },
  {
    "text": "which, for those of you who\nhad trouble with COMSOL, might take some extra\ntime, since it's the first time you're doing it. So I would suggest you at\nleast give it a try early.",
    "start": "64140",
    "end": "71940"
  },
  {
    "text": "I'm sure the TAs would\nbe very happy to help you to force COMSOL to cooperate.",
    "start": "71940",
    "end": "77190"
  },
  {
    "text": "Bend COMSOL to your will.  All right, so we're going to\ntalk about partial differential",
    "start": "77190",
    "end": "84990"
  },
  {
    "text": "equations. And, as it sounds,\nwhat's different about a partial\ndifferential equation is, it has partial\nderivatives in it.",
    "start": "84990",
    "end": "92760"
  },
  {
    "text": "And so we have a lot\nof equations like this. So for example, I work\na lot on this equation.",
    "start": "92760",
    "end": "100274"
  },
  {
    "start": "100275",
    "end": "121302"
  },
  {
    "text": "It's a poor choice, isn't it? ",
    "start": "121302",
    "end": "145770"
  },
  {
    "text": "OK, so this is the conservation\nequation for a chemical species in a reacting flow.",
    "start": "145770",
    "end": "152709"
  },
  {
    "text": "So the change in the mass\nfraction of the species z,",
    "start": "152710",
    "end": "160870"
  },
  {
    "text": "at a point, xyz at time, t. That differential is given by\na diffusion term, a convection",
    "start": "160870",
    "end": "167290"
  },
  {
    "text": "term, and a reaction term. So this is a pretty\nfamous equation. This is part of the\nNavier-Stokes equations",
    "start": "167290",
    "end": "173950"
  },
  {
    "text": "for the whole reactive\nflow system, which I hope you guys\nhave seen already, and for sure you will see,\nif you haven't seen them yet.",
    "start": "173950",
    "end": "181784"
  },
  {
    "text": "And there's a lot of other\npartial differential equations. I work a lot, also, on\nthe Schrodinger equation. That's another partial\ndifferential equation.",
    "start": "181784",
    "end": "187650"
  },
  {
    "text": "And what's special about\nthe partial differential equations is that, in this\ncase, this partial derivative is respect to time, holding all\nthe spatial coordinates fixed.",
    "start": "187650",
    "end": "195820"
  },
  {
    "text": "And these partial\nderivatives are respect to space, holding time fixed.",
    "start": "195820",
    "end": "202280"
  },
  {
    "text": "A very important thing\nabout partial derivatives, which you probably have\nencountered in 1040 already,",
    "start": "202280",
    "end": "207450"
  },
  {
    "text": "is, it really depends\nwhat you hold fixed. ",
    "start": "207450",
    "end": "212890"
  },
  {
    "text": "And you get different\nresults if you hold different things fixed. Now the implication, when you\nwrite an equation like this,",
    "start": "212890",
    "end": "218560"
  },
  {
    "text": "is that whatever\npartials you see-- When I wrote this,\nif I have this",
    "start": "218560",
    "end": "223810"
  },
  {
    "text": "and it has a term\nthat's like d squared, dx squared, is one of\nthe terms in this thing.",
    "start": "223810",
    "end": "229400"
  },
  {
    "text": "This says t. This says x.  The convention is, oh boy,\nI better hold x fixed.",
    "start": "229400",
    "end": "237019"
  },
  {
    "text": "And here must be, I\nmust hold t fixed. Because there's another\none in the same equation.",
    "start": "237020",
    "end": "242180"
  },
  {
    "text": "Now, you can change\ncoordinates however you want. Just really watch out\nthat you carefully follow the rules\nabout what you hold",
    "start": "242180",
    "end": "248660"
  },
  {
    "text": "fixed, when you change things. Otherwise you can cause\nall kinds of craziness. Now you guys probably took\nmultivariable calculus",
    "start": "248660",
    "end": "255290"
  },
  {
    "text": "at some point in\nyour distant past. And they told you very\ncarefully what the rules were.",
    "start": "255290",
    "end": "260440"
  },
  {
    "text": "So follow them. And I suppose, when you're\ndoing thermo right now? Have you started to do all\nthis partial derivative stuff?",
    "start": "260440",
    "end": "266610"
  },
  {
    "text": "Yeah, so you've seen\nhow completely confusing it can be with negative signs\nshowing up all over the place. And other things like this.",
    "start": "266610",
    "end": "272330"
  },
  {
    "text": "I don't know if you've\nencountered this yet? At least, I thought it was\nconfusing when I took it.",
    "start": "272330",
    "end": "277890"
  },
  {
    "text": "So just be aware. It's the same thing. Now, often you do want\nto change the equations.",
    "start": "277890",
    "end": "285740"
  },
  {
    "text": "So you can write down\nan equation like this. But, for example, if you\nhave a special symmetry of the problem, like it's\ncylindrical, for example,",
    "start": "285740",
    "end": "292900"
  },
  {
    "text": "then you might want to change\nthe cylindrical coordinates. And then you have\nto just be careful that you write that correct\nLaplacian and cylindrical",
    "start": "292900",
    "end": "299150"
  },
  {
    "text": "coordinates. Make sure it doesn't mess\nup anything about what you're holding fixed.",
    "start": "299150",
    "end": "305350"
  },
  {
    "text": "Sometimes you might want\nto be crafty and use some weirdo coordinates. For example, if you wanted to\nsolve the Schrodinger equation",
    "start": "305350",
    "end": "312099"
  },
  {
    "text": "for h2 plus, it\nturns out there's a special coordinate\nsystem called the elliptic coordinate system.",
    "start": "312100",
    "end": "317480"
  },
  {
    "text": "And in that coordinate system,\nthe partial differential equation is separable. And so, if you do it in\nthat coordinate system, you can actually solve\nanalytical solution,",
    "start": "317480",
    "end": "323831"
  },
  {
    "text": "which is pretty unusual for\nthe Schroedinger equation. But it's a pretty\ngoofball coordinate system",
    "start": "323831",
    "end": "329830"
  },
  {
    "text": "and you really have to\nwatch out, when you convert, to make sure you\ndo it just right.",
    "start": "329830",
    "end": "334990"
  },
  {
    "text": "But it's just the rules,\nchain rule and the rules about how to keep track of\nwhat's being held constant.",
    "start": "334990",
    "end": "340032"
  },
  {
    "text": "And when you change,\nwill tell them, how, being held constant,\nhow to change it. ",
    "start": "340032",
    "end": "346820"
  },
  {
    "text": "Now in principle,\nthis problem is like no different\nthan the ODE BBP",
    "start": "346820",
    "end": "352870"
  },
  {
    "text": "problems we were just doing. You just have a few more terms. And so, you can\nuse finite element.",
    "start": "352870",
    "end": "359740"
  },
  {
    "text": "You can use finite differences. You can use basis set methods.",
    "start": "359740",
    "end": "365230"
  },
  {
    "text": "And it's really no different. So all those methods\nbasically look the same.",
    "start": "365230",
    "end": "371409"
  },
  {
    "text": "You just get equations that\nhave more unknowns in them. Because, for example, if you're\nusing finite element methods",
    "start": "371410",
    "end": "379720"
  },
  {
    "text": "or basis set methods\nwith a local basis set, you need to put points both\nin the x direction and the y",
    "start": "379720",
    "end": "387310"
  },
  {
    "text": "direction, and in this\ncase, the z direction, and then maybe also\nin the time direction. So now you have a\nlot of mesh points",
    "start": "387310",
    "end": "393009"
  },
  {
    "text": "in all different directions. And so you get a\nlot of mesh points. And so fundamentally,\nthere's no problem,",
    "start": "393010",
    "end": "399437"
  },
  {
    "text": "but in practice,\nthere's a big problem if the number of unknowns\ngets to be so large. That's the main problem.",
    "start": "399437",
    "end": "405170"
  },
  {
    "text": " So think about it. You have some kind of\nequation like this.",
    "start": "405170",
    "end": "410620"
  },
  {
    "text": "It's in three spatial\ndimensions and in time. How many points do\nyou think you need to discretize your solution\nin the spatial coordinate?",
    "start": "410620",
    "end": "420150"
  },
  {
    "text": "There might be somewhere,\nmight be 100, I don't know, points might be enough. And so now I have x and y and z.",
    "start": "420150",
    "end": "425919"
  },
  {
    "text": "So I'll need, well, just in\nCOMSOL, you saw this on Monday.",
    "start": "425920",
    "end": "431242"
  },
  {
    "text": "Suppose I just have\ntwo dimensions. Suppose I just have x and z.",
    "start": "431242",
    "end": "436790"
  },
  {
    "text": "And I start putting points in. Well, I want to have some\npoints along this way.",
    "start": "436790",
    "end": "442043"
  },
  {
    "text": "And I want to have some\npoints along this way.  And so, I actually have an\nunknown here and an unknown",
    "start": "442044",
    "end": "449360"
  },
  {
    "text": "here, and one there\nand one there, and one there and one there. There's quite a few of them.",
    "start": "449360",
    "end": "454479"
  },
  {
    "text": "I think of how\nmany points I have. Each of those is a point where\nI have a little basis function.",
    "start": "454480",
    "end": "461470"
  },
  {
    "text": "And each one of those has a\nmagnitude of how much weight I have on that basis\nfunction, things",
    "start": "461470",
    "end": "466719"
  },
  {
    "text": "they called the d's before\nin the basis functions. And I have a lot of them. Now, it's going to be, if\nI have 100 points this way",
    "start": "466720",
    "end": "472080"
  },
  {
    "text": "and 100 points this way, I have\n10,000 of these little points. That means I have 10,000\nunknowns I have to solve for.",
    "start": "472080",
    "end": "477910"
  },
  {
    "text": "10,000 unknowns are a lot harder\nto solve for than 100 unknowns. and if you saw, on some of the\nproblems we did with the ODE",
    "start": "477910",
    "end": "483070"
  },
  {
    "text": "BBP problems, even\nwith 100 unknowns, we were having a lot\nof trouble, sometimes, to get the real solution.",
    "start": "483070",
    "end": "488379"
  },
  {
    "text": "All right? So you can just see how\nit just gets to be, like, a big numerical problem. So that's two dimensions.",
    "start": "488380",
    "end": "493891"
  },
  {
    "text": "The third dimension, you'll\nget another 100 times as many points. You might have a\nmillion unknowns. And once you get up\nto a million unknowns,",
    "start": "493891",
    "end": "500610"
  },
  {
    "text": "we're starting to talk\nserious math, now. OK? Even for your good\ncomputers that you have.",
    "start": "500610",
    "end": "507720"
  },
  {
    "text": "In addition, it's not just you\nhave the number of mesh points, but it's the number\nof mesh points",
    "start": "507720",
    "end": "514599"
  },
  {
    "text": "times the number of\nvariables at each mesh point. So in the Navier-Stokes\nequations, what variables",
    "start": "514600",
    "end": "524039"
  },
  {
    "text": "do you have? AUDIENCE: [INAUDIBLE]",
    "start": "524039",
    "end": "529250"
  },
  {
    "text": "PROFESSOR: Louder. AUDIENCE: [INAUDIBLE] PROFESSOR: Velocity\nand pressure, OK. So you have pressure. We have the different\ncomponents of velocity.",
    "start": "529250",
    "end": "537277"
  },
  {
    "text": "What else we got? ",
    "start": "537277",
    "end": "542766"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE] PROFESSOR: Sorry, what? AUDIENCE: [INAUDIBLE]",
    "start": "542766",
    "end": "547839"
  },
  {
    "text": "PROFESSOR: Yeah, though, yeah. Density or temperature. Yeah, temperature maybe, so. So maybe temperature would\nbe what you might use.",
    "start": "547840",
    "end": "554830"
  },
  {
    "text": "And then you'd have a state\nfunction maybe with these guys. What else would you have?",
    "start": "554830",
    "end": "560826"
  },
  {
    "text": "So then you'd have all\nthese species, right,? The mesh fractions\nare all the species. So you have, like,\ny, species one.",
    "start": "560826",
    "end": "566400"
  },
  {
    "text": "Mesh fraction, species two. However many you got. ",
    "start": "566400",
    "end": "571490"
  },
  {
    "text": "So that's a pretty\nbig set of variables and you need to know all\nthese numbers at each point.",
    "start": "571490",
    "end": "577279"
  },
  {
    "text": "So this might be-- how many have we've got? One, two, three, four, five,\nplus however many species",
    "start": "577280",
    "end": "582571"
  },
  {
    "text": "we have? So this is n species\nplus 5 times the mesh.",
    "start": "582571",
    "end": "589780"
  },
  {
    "text": "And I told you the mesh\nwas what, a million? So maybe I have 10\nmillion unknowns.",
    "start": "589780",
    "end": "596640"
  },
  {
    "text": " So the issue, to a large\nextent, has to do with just,",
    "start": "596640",
    "end": "605930"
  },
  {
    "text": "can I solve it? Can I solve a system\nof 10 million unknowns?",
    "start": "605930",
    "end": "611050"
  },
  {
    "text": "10 million equations,\n10 million unknowns. All right, so that's\ngoing to be one big issue. Now the other issues, we\nstill have the same problems",
    "start": "611050",
    "end": "617860"
  },
  {
    "text": "we had in ordinary\ndifferential equations, that we have to worry\nabout numerical stability. We have to worry about\nactually, is the whole problem",
    "start": "617860",
    "end": "624910"
  },
  {
    "text": "even stable to begin with? Physically? Because if it's not stable\nphysically, then probably",
    "start": "624910",
    "end": "630040"
  },
  {
    "text": "we're not going to\nget a stable solution. So you have all those\nkinds of problems",
    "start": "630040",
    "end": "635800"
  },
  {
    "text": "that we had before\nin the ODE case, and now it's just sort\nof amplified by the fact, now we have boundary conditions\nin more than one dimension.",
    "start": "635800",
    "end": "642910"
  },
  {
    "text": "So we have multiple\nchances to screw it up. And we're trying to figure\nout how to set the boundary conditions correctly.",
    "start": "642910",
    "end": "649240"
  },
  {
    "text": "And we have to worry\nabout stability in all the different directions. So those are the\ndifferent kinds of things",
    "start": "649240",
    "end": "655780"
  },
  {
    "text": "we have to worry about. But it's all the same problems\nyou had before, just amplified. ",
    "start": "655780",
    "end": "663839"
  },
  {
    "text": "Now, because of this problem\nof the very large number of unknowns,\ncurrently, if you have",
    "start": "663840",
    "end": "672900"
  },
  {
    "text": "a problem that has\ntwo dimensions, you can kind of very\nroutinely solve it.",
    "start": "672900",
    "end": "678690"
  },
  {
    "text": "And things like\nCOMSOL on your laptop, you can usually do those. When you get up to\nthree dimensions,",
    "start": "678690",
    "end": "684540"
  },
  {
    "text": "you might be able to solve it or\nmight not be able to solve it. And it could be, like, a\nreally big challenge sometimes",
    "start": "684540",
    "end": "690930"
  },
  {
    "text": "to solve it. And then in reality, we have\nproblems like the Navier-Stokes is four dimensions, right? There's time, as well.",
    "start": "690930",
    "end": "696940"
  },
  {
    "text": "So then that gets\nto be really hard. And then the\nSchrodinger equation has three times the number of\nelectrons dimensions in it.",
    "start": "696940",
    "end": "703590"
  },
  {
    "text": "So that gets impossibly hard. And so, specialized\nmethods are developed",
    "start": "703590",
    "end": "709050"
  },
  {
    "text": "to handle those systems with\na lot of dimensionality. So, like, for the\nSchrodinger equation, people almost always do\nit with basis set methods.",
    "start": "709050",
    "end": "716100"
  },
  {
    "text": "And there's been a huge\neffort, over decades, to figure out really\nclever basis sets that are really close to\nthe real solutions,",
    "start": "716100",
    "end": "722940"
  },
  {
    "text": "so that you don't need to use\ntoo many basis functions to get the good solution. So that's the way to keep\nthe number of variables down.",
    "start": "722940",
    "end": "729881"
  },
  {
    "text": " In the Navier-Stokes\nworld, I'll show you",
    "start": "729881",
    "end": "735060"
  },
  {
    "text": "what people do to try\nto deal with that.  There's many other problems.",
    "start": "735060",
    "end": "740959"
  },
  {
    "text": "I don't know all the\nproblems in the world. But in general, when you\nhave three or more dimensions",
    "start": "740959",
    "end": "746490"
  },
  {
    "text": "in your PDE system, you're\nlooking up special tricks. You're looking up, how\ndo people in this field",
    "start": "746490",
    "end": "751920"
  },
  {
    "text": "deal with this particular PDE? Special ways that are\ngood for that kind of PDE. ",
    "start": "751920",
    "end": "759265"
  },
  {
    "text": "All right, so I\nsaid, one problem was that you could have,\nthat the PDE system, itself, can be intrinsically unstable. So one example I know like\nthat is, detonation problems.",
    "start": "759265",
    "end": "768440"
  },
  {
    "text": "So if I have a system that\nhas some explosive in it, or a mixture of hydrogen\nand oxygen even,",
    "start": "768440",
    "end": "775130"
  },
  {
    "text": "and I have it in a\ntube or something, if I change my\ninitial conditions,",
    "start": "775130",
    "end": "781136"
  },
  {
    "text": "I can go from the case where\nit's stable, that it just sits there, a\nhydrogen and oxygen. Or it could turn into\na regular burning.",
    "start": "781137",
    "end": "788238"
  },
  {
    "text": "Or if I change the conditions\na little bit differently, it could change into a\ndetonation, where it actually sends a shockwave\ndown the tube faster",
    "start": "788239",
    "end": "794100"
  },
  {
    "text": "than the speed of sound,\ntotally different situation. So those kind of\nsystems can be really sensitive to the physical\ninitial conditions.",
    "start": "794100",
    "end": "802670"
  },
  {
    "text": "A very small spark can make\na really big difference in a system like that. And also, in your\nnumerical solution,",
    "start": "802670",
    "end": "809660"
  },
  {
    "text": "if the thing is\nphysically sensitive, it'll typically be sensitive\nalso to numerical noise. If you get numerical\nnoise at some point, that",
    "start": "809660",
    "end": "816050"
  },
  {
    "text": "might be enough to kick\nit over from, say, not igniting at all to\nhaving a detonation,",
    "start": "816050",
    "end": "821642"
  },
  {
    "text": "which is a completely\ndifferent solution. ",
    "start": "821642",
    "end": "828389"
  },
  {
    "text": "But another case,\nlike in biology, if you're trying to study\nthe growth of a cell culture",
    "start": "828390",
    "end": "834120"
  },
  {
    "text": "or the growth of a\ntumor, as you know, if somebody has a tumor and\none of the cancer cells mutates",
    "start": "834120",
    "end": "842521"
  },
  {
    "text": "and does something\ndifferent, it can have a really different\noutcome of what happens to the patient,\nwhat happens to the tumor.",
    "start": "842521",
    "end": "847920"
  },
  {
    "text": "The whole morphology\ncan change completely. Everything about it can change. So that's the kind\nof system, also, that",
    "start": "847920",
    "end": "853586"
  },
  {
    "text": "can be very sensitive\nto small details. A small change in one\ncell, for example, could be a really\nbig difference.",
    "start": "853586",
    "end": "860230"
  },
  {
    "text": "So this is not just\nin combustion problems you have these kinds\nof instabilities. All kinds of problems\nhave this kind of thing.",
    "start": "860230",
    "end": "866087"
  },
  {
    "text": "You can have just regular\nchemical reactors, like in multiple steady states,\nlittle tiny fluctuations can make it jump from one\nsteady state to another one.",
    "start": "866087",
    "end": "872960"
  },
  {
    "text": "That's another very\nfamous kind of problem. ",
    "start": "872960",
    "end": "878160"
  },
  {
    "text": "There's another\nclass of PDEs where it's stable in some sense,\nbut it causes a problem.",
    "start": "878160",
    "end": "885830"
  },
  {
    "text": "We call those hyperbolic. And those are like\nwave equations.",
    "start": "885830",
    "end": "891620"
  },
  {
    "text": "The solutions are\npropagating waves. So the equations of\nacoustics, the equations of electromagnetism,\nare wave equations",
    "start": "891620",
    "end": "897560"
  },
  {
    "text": "where, basically, a wave\npropagates more or less without any damping.",
    "start": "897560",
    "end": "903000"
  },
  {
    "text": "So what happens, then, is you\nhave some numerical noise that will make a little wavelet that\nwill propagate, more or less, without any damping, too.",
    "start": "903000",
    "end": "909079"
  },
  {
    "text": "And it'll keep bouncing back\nand forth inside your domain numerically. And if you keep introducing\nnumerical noise,",
    "start": "909080",
    "end": "914870"
  },
  {
    "text": "eventually the whole thing\nis just full of noise. And it doesn't\nhave much relation to the real physical solution.",
    "start": "914870",
    "end": "920240"
  },
  {
    "text": "So hyperbolic systems of\ndifferential equations need special solution methods.",
    "start": "920240",
    "end": "925490"
  },
  {
    "text": "That in the numerical\nmethod, it's carefully trying to damp out\nthat kind of propagating wave that's coming from the noise.",
    "start": "925490",
    "end": "932060"
  },
  {
    "text": "And they set them\nup a special way. I'm not going to talk about how\nyou solve them in this class, but there's a special, whole\ngroup of solution methods",
    "start": "932060",
    "end": "938570"
  },
  {
    "text": "that people use who are\nsolving acoustics equations and solving\nelectromagnetic equations.",
    "start": "938570",
    "end": "944540"
  },
  {
    "text": "If you get into solving\nshockwave equations-- I actually work for\nProfessor [? Besant. ?] He has, like, electrochemical\nshocks in some of his systems.",
    "start": "944540",
    "end": "951517"
  },
  {
    "text": "You have the same kind of thing. You have to use special\nmathematics to correctly handle that, special numerical tricks.",
    "start": "951517",
    "end": "958166"
  },
  {
    "text": "But we're not going to get\ninto that in this class. If you get into\nthose things, you should take the PDE class\nfor hyperbolic equations",
    "start": "958166",
    "end": "963760"
  },
  {
    "text": "and they'll tell you just\nall about the solvers for those kinds of things\nand special tricks. And there's journal\npapers all about it.",
    "start": "963760",
    "end": "968976"
  },
  {
    "text": " Here, what we're going\nto focus primarily on two kinds of problems:\nelliptic problems",
    "start": "968976",
    "end": "974800"
  },
  {
    "text": "and parabolic problems.  And those problems\nare ones where",
    "start": "974800",
    "end": "980260"
  },
  {
    "text": "there's some dissipation\nthat's very significant. And so, in an\nelliptic problem, you",
    "start": "980260",
    "end": "986290"
  },
  {
    "text": "introduce some numerical\nnoise and as you solve it,",
    "start": "986290",
    "end": "991750"
  },
  {
    "text": "the numerical noise\nkind of goes away. Sort of like intrinsically\nstable all throughout. Now the real definition\nof these things,",
    "start": "991750",
    "end": "998190"
  },
  {
    "text": "parabolic, hyperbolic,\nelliptic, has to do with flow of information. So in a hyperbolic\nsystem, information--",
    "start": "998190",
    "end": "1008540"
  },
  {
    "text": "there's regions of the domain\nthat you can make a change here and it doesn't make any effect\non some domain part over there.",
    "start": "1008540",
    "end": "1014460"
  },
  {
    "text": "And so that causes--\nbecause that is the real situation,\nthat also propagates",
    "start": "1014460",
    "end": "1019860"
  },
  {
    "text": "into the numerical\nsolution method. So for example, if I'm\nmodeling a shockwave that's moving faster than\nthe speed of sound,",
    "start": "1019860",
    "end": "1026459"
  },
  {
    "text": "I can introduce any\npressure fluctuation I want behind the\nshockwave, and it has no effect on the shockwave.",
    "start": "1026460",
    "end": "1032230"
  },
  {
    "text": "Because the pressure waves\nfrom that pressure fluctuation are traveling at\nthe speed of sound. They won't catch\nup to the shock.",
    "start": "1032230",
    "end": "1037410"
  },
  {
    "text": "So they will have no\neffect whatsoever. So if I was judging\nwhat was happening by looking at what's\nhappening in the shock,",
    "start": "1037410",
    "end": "1043202"
  },
  {
    "text": "I can introduce any kind of\nrandom noise I want back over,",
    "start": "1043202",
    "end": "1048830"
  },
  {
    "text": "downstream of the\nshock, I guess. Yeah? And it won't make any\ndifference at all. And so, that's part\nof the reason why I",
    "start": "1048830",
    "end": "1054836"
  },
  {
    "text": "need a special kind of solver. If I have elliptic\nequations, every point",
    "start": "1054836",
    "end": "1059900"
  },
  {
    "text": "affects every other point. A famous case for that is,\nlike, this steady state heat",
    "start": "1059900",
    "end": "1065000"
  },
  {
    "text": "equation. You have some temperature\nsource here, a heat source here,",
    "start": "1065000",
    "end": "1070310"
  },
  {
    "text": "and you have some\ncoolness source over here. And there's some heat flowing\nfrom the hot to the cold.",
    "start": "1070310",
    "end": "1077585"
  },
  {
    "text": "And the heat flow is\nkind of slow enough that everything sort of affects\neverything else, since you actually have, the heat\nis trying to flow by,",
    "start": "1077585",
    "end": "1084890"
  },
  {
    "text": "sort of, every path. And there's some insulation\nthat's resisting its flow.",
    "start": "1084890",
    "end": "1090282"
  },
  {
    "text": "And it has been in\nthe connectivity of flow a certain way. And those kinds of equations\nare called elliptic. And the methods that we\nuse for the relaxation mesh",
    "start": "1090282",
    "end": "1096830"
  },
  {
    "text": "that we showed are really good\nfor those kinds of methods, for those kind of problems. And then another kind of\nproblem that we get into a lot",
    "start": "1096830",
    "end": "1102841"
  },
  {
    "text": "is like this one. This is called parabolic. And typically, in the cases\nwe see that are parabolic,",
    "start": "1102841",
    "end": "1108230"
  },
  {
    "text": "we have time as\npart of the problem. Always what we\nthink should happen",
    "start": "1108230",
    "end": "1114374"
  },
  {
    "text": "is that what happens\nin the future depends on what happened in\nthe past, but not vice versa.",
    "start": "1114374",
    "end": "1120170"
  },
  {
    "text": "So you would expect\nthat when you're computing what's happening\nat the next time point,",
    "start": "1120170",
    "end": "1128662"
  },
  {
    "text": "it's going to depend on what\nhappened at earlier time points. But if you try to do it\nthe other way around,",
    "start": "1128662",
    "end": "1133846"
  },
  {
    "text": "it would be kind\nof weird, right? You wouldn't expect\nthat what in the future really affected\nstuff in the past.",
    "start": "1133846",
    "end": "1139210"
  },
  {
    "text": "So it naturally leads us to\nsort of pose it as an ODE IVP,",
    "start": "1139210",
    "end": "1144370"
  },
  {
    "text": "or IVP kind of problem. And we know initially,\nsome time zero something, and we're trying\nto calculate what happens at some later time.",
    "start": "1144370",
    "end": "1151660"
  },
  {
    "text": "And so those kinds of\nproblems we call parabolic. And the methods that we're\ngoing to talk about mostly are ones for solving parabolic\nand elliptic problems.",
    "start": "1151660",
    "end": "1157908"
  },
  {
    "text": " And you can read, in\nthe middle of chapter 6,",
    "start": "1157908",
    "end": "1164894"
  },
  {
    "text": "has a nice discussion. Just has the\nmathematical definitions of what these things are. ",
    "start": "1164894",
    "end": "1172659"
  },
  {
    "text": "Now, even in a\nsteady state problem, the problem can have a sort\nof directionality to it.",
    "start": "1172660",
    "end": "1179860"
  },
  {
    "text": "So if you have a problem\nthat's very convective. So you have a flow in a pipe. And you have a nice, fast\nvelocity flow down the pipe.",
    "start": "1179860",
    "end": "1186362"
  },
  {
    "text": "What's happening downwind\nis very much affected by what happened upwind,\nbut not vice versa.",
    "start": "1186362",
    "end": "1191750"
  },
  {
    "text": "So maybe you're doing\nsome reaction upwind. Say you're burning\nsome hydrogen. You're going to get\nwater vapor made upwind",
    "start": "1191750",
    "end": "1198430"
  },
  {
    "text": "and it's going to flow downwind. And you're going to\nhave steam downwind.",
    "start": "1198430",
    "end": "1203440"
  },
  {
    "text": "If I squirt a little\nmethane in downwind, it doesn't actually do anything\nto what happened upwind.",
    "start": "1203440",
    "end": "1208450"
  },
  {
    "text": "I still have a hydrogen\nand oxygen flame up there and it's been burning\nand making steam. Do you see what I mean?",
    "start": "1208450",
    "end": "1213700"
  },
  {
    "text": "So it has a directionality,\neven though I might do it as a steady state\nproblem and not have time in it at all.",
    "start": "1213700",
    "end": "1218704"
  },
  {
    "text": "And you've probably already\ndone this, where you can convert, like, a flow reactor. You can write it, sort of, as a\ntime thing or as a space thing.",
    "start": "1218704",
    "end": "1226464"
  },
  {
    "text": "Time and space are so related\nby the velocity of the flow. ",
    "start": "1226464",
    "end": "1231710"
  },
  {
    "text": "We'll have similar kinds\nof phenomenon then. It's almost like a\nparabolic time system that, if the flow\nis fast enough,",
    "start": "1231710",
    "end": "1239110"
  },
  {
    "text": "the fusion backup, anything\nmoving upstream is negligible. It's all moving from\nupstream to downstream.",
    "start": "1239110",
    "end": "1245640"
  },
  {
    "text": "And so then, you'll have\nthe same kind of issues. In fact, you may\neven try to solve it",
    "start": "1245640",
    "end": "1251059"
  },
  {
    "text": "by just starting it at the\nupstream end and competing stuff and then propagating what\nthat output from that first one",
    "start": "1251060",
    "end": "1257872"
  },
  {
    "text": "does to the next one\ndownstream, and then do them, one at a time. That would be one\npossible way to try to solve those kinds of problems\nthat are highly convective.",
    "start": "1257872",
    "end": "1265430"
  },
  {
    "text": "As you slow the velocity\ndown, then the diffusion will start to fight the\nvelocity more and more.",
    "start": "1265430",
    "end": "1270530"
  },
  {
    "text": "If you make the\nvelocity very slow, the Peclet number very\nlow, then you really have to worry about things\ndiffusing back upstream.",
    "start": "1270530",
    "end": "1277520"
  },
  {
    "text": "And then it's a\ndifferent situation. And that would be more like\nthe elliptic problems we have.",
    "start": "1277520",
    "end": "1283260"
  },
  {
    "text": "Because things downstream\nwould actually affect upstream, if the flow is really small. But typically for our\nproblems, the velocity",
    "start": "1283260",
    "end": "1288400"
  },
  {
    "text": "is always really high. Peclet numbers are really\nlarge and so not much goes from downstream to upstream.",
    "start": "1288400",
    "end": "1293600"
  },
  {
    "text": "It's almost all\nupstream to downstream. This leads to a\nfamous situation.",
    "start": "1293600",
    "end": "1301235"
  },
  {
    "text": "If you look in the textbook\nat figures 6.7, 6.8,",
    "start": "1301235",
    "end": "1310627"
  },
  {
    "text": "it's kind of a very\nfamous problem.  That if you just\ndo this problem.",
    "start": "1310627",
    "end": "1323640"
  },
  {
    "start": "1323640",
    "end": "1343619"
  },
  {
    "text": "So this is just an ODE problem. ",
    "start": "1343619",
    "end": "1349760"
  },
  {
    "text": "So I just have convection\nand diffusion, no reaction, very simple. This problem.",
    "start": "1349760",
    "end": "1355070"
  },
  {
    "text": "You'd think that I could just\nuse my finite differences, where I would put, I could\nuse the center difference",
    "start": "1355070",
    "end": "1360539"
  },
  {
    "text": "for here and here and change\nthis into this obvious looking",
    "start": "1360540",
    "end": "1367860"
  },
  {
    "text": "thing. ",
    "start": "1367860",
    "end": "1385669"
  },
  {
    "text": "You think that that would be a\nreasonable thing to do, right? And you can do\nthe same one here. You can write-- ",
    "start": "1385669",
    "end": "1397556"
  },
  {
    "text": "I'm terrible with\nminuses, sorry. ",
    "start": "1397556",
    "end": "1407620"
  },
  {
    "text": "So these, the finite\ndifference formulas. And so, you can write\nthese like this.",
    "start": "1407620",
    "end": "1414640"
  },
  {
    "text": "This stays equal to zero. And now it's just an\nalgebraic problem to solve. A system of equations,\nyou have equations",
    "start": "1414640",
    "end": "1421530"
  },
  {
    "text": "like this for every value of n. And there's the mesh points. You guys have done\nthis before, yes?",
    "start": "1421530",
    "end": "1428420"
  },
  {
    "text": "Yes. OK, so famous problem\nis, if you actually try to solve it this way, unless\nyou make delta z really tiny,",
    "start": "1428420",
    "end": "1437740"
  },
  {
    "text": "you get crazy stuff. So on figure 6.7,\nthey actually show what happens for different\nvalues of delta z, which",
    "start": "1437740",
    "end": "1448779"
  },
  {
    "text": "is different values of what they\ncall the local Peclet number. So there's a thing called\nlocal Peclet number, which is--",
    "start": "1448780",
    "end": "1458430"
  },
  {
    "start": "1458430",
    "end": "1463680"
  },
  {
    "text": "OK? If you make the local Peclet\nnumber too large, actually",
    "start": "1463680",
    "end": "1469120"
  },
  {
    "text": "anywhere bigger\nthan 2, and you try to solve this\nequation, what you get is oscillations,\nunphysical oscillations.",
    "start": "1469120",
    "end": "1475210"
  },
  {
    "text": "They'll make the\nphi go negative. It's crazy. ",
    "start": "1475210",
    "end": "1481107"
  },
  {
    "text": "It looks like the simplest\nequation in the world, right? It's a linear equation, so\nwhat's the problem with this?",
    "start": "1481107",
    "end": "1487320"
  },
  {
    "text": "But it doesn't work. And so, then you could think,\nwell, why doesn't it work?",
    "start": "1487320",
    "end": "1493590"
  },
  {
    "text": "And there's, like, multiple\nways to explain this about why this doesn't work. I think that the best\nway to think about it",
    "start": "1493590",
    "end": "1500040"
  },
  {
    "text": "is about the information flow. So if the local Peclet\nnumber is large, that means that phi is\njust flowing downwind",
    "start": "1500040",
    "end": "1508650"
  },
  {
    "text": "and diffusion is not doing much. Because the Peclet\nnumber is big. And so, you really\nshouldn't use this formula",
    "start": "1508650",
    "end": "1518140"
  },
  {
    "text": "to calculate the flow. Because what happens downwind,\nat point n plus one, I guess.",
    "start": "1518140",
    "end": "1524768"
  },
  {
    "text": "Here we have the flow this way.  So here's n minus one.",
    "start": "1524769",
    "end": "1532520"
  },
  {
    "text": "Here's my point n, n plus 1. ",
    "start": "1532520",
    "end": "1538470"
  },
  {
    "text": "I really should not\ninclude, is this right, n plus 1 in this formula.",
    "start": "1538470",
    "end": "1544991"
  },
  {
    "text": "Hope I have those signs right. I apologize if I\nhad them backwards. Because I don't think\nthat what happens",
    "start": "1544991",
    "end": "1550890"
  },
  {
    "text": "downstream should really\naffect this at all. So really, I would do better\nto change from this center",
    "start": "1550890",
    "end": "1557070"
  },
  {
    "text": "difference formula to what's\ncalled the upwind difference formula.",
    "start": "1557070",
    "end": "1562410"
  },
  {
    "start": "1562410",
    "end": "1569280"
  },
  {
    "text": "Where they would\nsay, OK, instead, let's use phi of n minus, the\nphi of n minus 1 over delta z.",
    "start": "1569280",
    "end": "1583810"
  },
  {
    "text": "Just use that instead\nof using this formula. Now, you wouldn't\nthink that that would make much difference.",
    "start": "1583810",
    "end": "1590742"
  },
  {
    "text": "But it makes a\ngigantic difference. And so if you look at\nfigure 6.8 in the textbook, you see you get perfectly stable\nsolutions when you do that.",
    "start": "1590742",
    "end": "1600180"
  },
  {
    "text": "But where you do\nthis one, you get crazy, oscillatory,\nunphysical solutions, unless you choose\ndelta z really tiny.",
    "start": "1600180",
    "end": "1607030"
  },
  {
    "text": "Now, there's other\nways to look at this. So I think this is the\ncorrect way, the best",
    "start": "1607030",
    "end": "1612320"
  },
  {
    "text": "way to think about it is, it\nhas to do with information flow. If you try to make your\nsolution depend on stuff that it doesn't\nreally depend on.",
    "start": "1612320",
    "end": "1618666"
  },
  {
    "text": "So upwind does not really\ndepend on downwind. If you force it to,\nby choosing to include that information here, you\nend up with crazy stuff.",
    "start": "1618666",
    "end": "1627049"
  },
  {
    "text": "So that's one way to look at it. Another way to look at\nit is that, if you really want to compute\nthese derivatives,",
    "start": "1627050",
    "end": "1634260"
  },
  {
    "text": "you've got to keep\ndelta z small. Because we're taking\na differential. We're turning it into\na finite difference.",
    "start": "1634260",
    "end": "1640010"
  },
  {
    "text": "And if you take your\ndelta z too big, then it's a terrible\napproximation to do this.",
    "start": "1640010",
    "end": "1647680"
  },
  {
    "text": "And you can look at it. You can see that\nwhat we're doing is, when we have this problem\nwhere the local Peclet number is getting too large,\nis we're actually choosing",
    "start": "1647680",
    "end": "1654510"
  },
  {
    "text": "delta z bigger\nthan the, sort of, the thickness of the solution. So if you look at the solution,\nthe analytical solution",
    "start": "1654510",
    "end": "1661270"
  },
  {
    "text": "of this problem, it's like this. ",
    "start": "1661270",
    "end": "1672190"
  },
  {
    "text": "Where this has a very,\nvery thin layer at the end. It's like the flow has pushed\nall your stuff to one side.",
    "start": "1672190",
    "end": "1678720"
  },
  {
    "text": "And if you choose your delta\nz to be from here to here, that's how big your delta\nz is, and then you're",
    "start": "1678720",
    "end": "1685530"
  },
  {
    "text": "computing the derivative of this\npoint halfway along from here",
    "start": "1685530",
    "end": "1691680"
  },
  {
    "text": "to where this is. You compute your\nderivative like that. It's not a very good, not a very\naccurate representation of what",
    "start": "1691680",
    "end": "1698520"
  },
  {
    "text": "the real derivative is here. And in fact, you\nreally should have a bunch of points here\nand here and here and here and here to really\nresolve the sharp edge.",
    "start": "1698520",
    "end": "1706789"
  },
  {
    "text": "And so you did\nsomething really crazy to use a big value of\ndelta z to start with. So that's another way\nto look at this problem.",
    "start": "1706789",
    "end": "1714070"
  },
  {
    "text": "Now, the fix, by doing\nthis upwind differencing, I think the best way to\nlook at this is saying,",
    "start": "1714070",
    "end": "1720020"
  },
  {
    "text": "well, I'm just going to\nmake sure I only depend, I only make the equations\ndepend on what's upwind,",
    "start": "1720020",
    "end": "1725069"
  },
  {
    "text": "with the convective term. Because there's nothing\nconvecting from downwind. So just leave that out. So that's a conceptual\nway to think about it.",
    "start": "1725069",
    "end": "1731270"
  },
  {
    "text": "Another way to think about\nit, which is in the text, is that by doing this,\nyou're introducing",
    "start": "1731270",
    "end": "1737300"
  },
  {
    "text": "another thing called\nnumerical diffusion, where you're actually, effectively\nincreasing the diffusivity.",
    "start": "1737300",
    "end": "1743120"
  },
  {
    "text": "Because this is a very\npoor approximation to the differential. This is a asymmetrical\nfinite difference formula.",
    "start": "1743120",
    "end": "1750300"
  },
  {
    "text": "It's not a very good value\nestimate of the derivative, if delta z is big.",
    "start": "1750300",
    "end": "1755930"
  },
  {
    "text": "But you can write it out\ncarefully and write this out and say, oh, this\nactually is sort of like this plus an\neffective diffusivity",
    "start": "1755930",
    "end": "1764690"
  },
  {
    "text": "chosen very carefully, so the\nterms cancel out just right. And it turns out,\nif you look at it that way, the effective\ndiffusion you've",
    "start": "1764690",
    "end": "1771650"
  },
  {
    "text": "added, by using this\ninstead of that, is just enough to make\nthe local Peclet number,",
    "start": "1771650",
    "end": "1778919"
  },
  {
    "text": "if you compute it with the\neffects of this d effective, to stay less than 2. Which is what you need\nas a condition to make",
    "start": "1778920",
    "end": "1785129"
  },
  {
    "text": "this numerically stable.  So I strongly suggest\nyou read that.",
    "start": "1785130",
    "end": "1791022"
  },
  {
    "text": "It's only two pages\nlong in the textbook. It's very clear. Just read, just look at it if\nyou haven't seen this before. ",
    "start": "1791022",
    "end": "1801346"
  },
  {
    "text": "There's a similar thing and it\nmight be relevant to the COMSOL problem that Kristyn showed\nyou on Monday, is you can--",
    "start": "1801347",
    "end": "1809780"
  },
  {
    "text": " In that case, there was a\nregion of the boundary here",
    "start": "1809780",
    "end": "1817429"
  },
  {
    "text": "that had some\nconcentration c naught, and then there was, over here,\nthe concentration was zero.",
    "start": "1817430",
    "end": "1824790"
  },
  {
    "text": "The boundary is zero. Here, it's some number,\n17, whatever number it was.",
    "start": "1824790",
    "end": "1831420"
  },
  {
    "text": "And if you think of how\nto model what's going on,",
    "start": "1831420",
    "end": "1839470"
  },
  {
    "text": "one way to look at it is, I\nhave a diffusive flux coming in from the drug patch, diffusing\nthe drug into the flow.",
    "start": "1839470",
    "end": "1848230"
  },
  {
    "text": "And I have this big, giant\nflow, flowing along here. And the flow gets slower as I\nget closer to the wall because",
    "start": "1848230",
    "end": "1860900"
  },
  {
    "text": "of the friction with the wall. And so if I looked\nsomewhere right in here,",
    "start": "1860900",
    "end": "1866290"
  },
  {
    "text": "I could just draw a\nlittle control volume, and look what's happening. I have a diffusive\nflux coming in here. I don't have any drug\nup here, so there's",
    "start": "1866290",
    "end": "1872970"
  },
  {
    "text": "no drug coming in here. But I have drug leaving. So basically, it's coming up and\nit's making a right-hand turn.",
    "start": "1872970",
    "end": "1879950"
  },
  {
    "text": "And so then I could\nthink, well, if I was going to try to\nfigure out, what's the steady state concentration\nof drug in there, I could say,",
    "start": "1879950",
    "end": "1886250"
  },
  {
    "text": "well, there's a\ncertain amount of drug entering from the\ndiffusive flux, which would be just this times dcdy. ",
    "start": "1886250",
    "end": "1894320"
  },
  {
    "text": "This is the y direction.  And then this part\nover here would",
    "start": "1894320",
    "end": "1901280"
  },
  {
    "text": "be the velocity, actually,\njust times the concentration",
    "start": "1901280",
    "end": "1906720"
  },
  {
    "text": "I have in here, right? So how much is flowing out.",
    "start": "1906720",
    "end": "1912160"
  },
  {
    "text": "And it's probably, my units\nare screwed up so there's-- Well, maybe not. That's OK. Is that all right?",
    "start": "1912160",
    "end": "1917610"
  },
  {
    "text": " Units are screwed up. You guys will get it right.",
    "start": "1917610",
    "end": "1922850"
  },
  {
    "text": " It's probably an area. Something to do with\nthis size right here.",
    "start": "1922850",
    "end": "1928770"
  },
  {
    "text": "This one here, too. ",
    "start": "1928770",
    "end": "1934640"
  },
  {
    "text": "Is that right? So you could compute\nwhat the steady state",
    "start": "1934640",
    "end": "1940747"
  },
  {
    "text": "concentration would be if it's\njust coming in and flowing out. And so, this is the\nfinite volume view of this kind of problem.",
    "start": "1940747",
    "end": "1947620"
  },
  {
    "text": "And so you can write the\nequations that way, instead. And what you really care about\nare what the velocity flows",
    "start": "1947620",
    "end": "1952880"
  },
  {
    "text": "and the diffusive fluxes\nare on these boundaries around the point. So you don't try to compute\nthings right at the point.",
    "start": "1952880",
    "end": "1958550"
  },
  {
    "text": "You compute around it. And one way to look\nat this is, we just did finite differencing. We were looking at what\nwas happening coming in.",
    "start": "1958550",
    "end": "1965750"
  },
  {
    "text": " And then, this is actually\na center difference",
    "start": "1965750",
    "end": "1972160"
  },
  {
    "text": "around this interface, which is\nhalfway between the two points. And so actually, this\nis a good approximation",
    "start": "1972160",
    "end": "1979450"
  },
  {
    "text": "for the finite\nvolume point of view. This is all right? Now, these are\nall different ways",
    "start": "1979450",
    "end": "1985809"
  },
  {
    "text": "to write down the equations. All of them are\ncorrect in the limit that delta z goes to zero.",
    "start": "1985810",
    "end": "1991694"
  },
  {
    "text": "If you have an infinite\nnumber of mesh points, all these are exactly the same. But they lead to really\ndifferent numerical properties",
    "start": "1991694",
    "end": "1998710"
  },
  {
    "text": "when delta z is large. And they're all inaccurate\nwhen delta z is large,",
    "start": "1998710",
    "end": "2003910"
  },
  {
    "text": "so it's all about what\nhappens with the inaccuracies. ",
    "start": "2003910",
    "end": "2010910"
  },
  {
    "text": "Now, we can go ahead and\ntake any problem, even really complicated 3-D problems\nor 4-D problems like this,",
    "start": "2010910",
    "end": "2018980"
  },
  {
    "text": "and we can write them\nwith relaxation methods. And what we're basically\ndoing in a problem like this is turning it\ninto some function of y",
    "start": "2018980",
    "end": "2028429"
  },
  {
    "text": "is equal to zero, where y is\nthe value of all the unknowns.",
    "start": "2028430",
    "end": "2033460"
  },
  {
    "text": " And there's a lot of equations.",
    "start": "2033460",
    "end": "2041230"
  },
  {
    "text": "So I might have 100\nmillion equations and 100 million unknowns\nthat are the values,",
    "start": "2041230",
    "end": "2048129"
  },
  {
    "text": "or every state variable at\nevery state point at all times. And I can write it down,\nby finding differences,",
    "start": "2048130",
    "end": "2054388"
  },
  {
    "text": "by finding elements,\nby finding volumes. Any way I want, I can write\ndown an expression like this.",
    "start": "2054389",
    "end": "2060239"
  },
  {
    "text": "And I know in the\nlimit, as I make the number of elements\nof y go to infinity, it will actually be\nthe real solution.",
    "start": "2060239",
    "end": "2067566"
  },
  {
    "text": "And the problem is, my\ncomputer can't handle infinite number of unknowns. In fact, it's even\ngoing to have trouble with a 100 million unknowns.",
    "start": "2067567",
    "end": "2073719"
  },
  {
    "text": "And so, I have to\nfigure out what to do. So how would I\nsolve this normally, is I would take the Jacobian\nof this and I would do,",
    "start": "2073719",
    "end": "2079570"
  },
  {
    "text": "I'd take an initial guess\nand I'd update it and have the Jacobian times my change\nfrom the initial guess",
    "start": "2079570",
    "end": "2088888"
  },
  {
    "text": "to the equal\nnegative of f, right? You guys have done\nthis a million times.",
    "start": "2088889",
    "end": "2094090"
  },
  {
    "text": "As Newton-Raphson\nis how you'd find improved from an initial guess. You have to provide\nsome initial guess.",
    "start": "2094090",
    "end": "2100300"
  },
  {
    "text": "This is actually pretty hard if\nyou have 100 million unknowns. You have to provide the value of\nthe initial guess for every one of the 100 million.",
    "start": "2100300",
    "end": "2106300"
  },
  {
    "text": "But somehow you did it. And now you want to refine\nthat guess and this is the formula for it.",
    "start": "2106300",
    "end": "2112960"
  },
  {
    "text": "And so, you just use\nbackslash, right? But the problem here is that now\nf is a 100 million long vector",
    "start": "2112960",
    "end": "2119320"
  },
  {
    "text": "and this is a 100\nmillion squared matrix. And a 100 million\nsquared is pretty big, 10 to 16th elements in it.",
    "start": "2119320",
    "end": "2126050"
  },
  {
    "text": "So I'm not going to\njust write that matrix down directly like this. Now, we cleverly chose\nlocal basis functions,",
    "start": "2126050",
    "end": "2133630"
  },
  {
    "text": "so this is going to be\nsparse, this Jacobian. So most of the numbers, are\nthose 10 to the 16th numbers",
    "start": "2133630",
    "end": "2139950"
  },
  {
    "text": "in this matrix are zero. So we don't have\nto represent them. But there still\nmight be quite a few.",
    "start": "2139950",
    "end": "2145369"
  },
  {
    "text": "Probably the diagonal\nevents are non-zero, so that's like 10 to the\n8th of them right there. And we've got, probably,\na couple of other bands.",
    "start": "2145370",
    "end": "2150930"
  },
  {
    "text": "So I don't know, might be 10\nto the 9th non-zero elements inside this thing,\nwhich is pretty nutty.",
    "start": "2150930",
    "end": "2156240"
  },
  {
    "text": "And depending on how much memory\nthey provided in the laptop they gave you, you might\nbe filling up the memory",
    "start": "2156240",
    "end": "2161370"
  },
  {
    "text": "already just to write down j. And certainly, if you tried\nto do Gaussian elimination to solve this, you're going\nto have a problem because you",
    "start": "2161370",
    "end": "2168477"
  },
  {
    "text": "get what's called fill in. Do you guys remember this? Even if you start from\na very sparse Jacobian,",
    "start": "2168477",
    "end": "2174900"
  },
  {
    "text": "as you run the Gaussian\nelimination steps the number of non-zero entries\nin the intermediate matrices gets larger and larger.",
    "start": "2174900",
    "end": "2181180"
  },
  {
    "text": "Remember this? And so, even if, initially, you\ncan write down j and store it in your computer,\nyou could easily",
    "start": "2181180",
    "end": "2186710"
  },
  {
    "text": "overwhelm it with the third\niteration or something. So you're not going to just\nuse Gaussian elimination.",
    "start": "2186710",
    "end": "2193560"
  },
  {
    "text": "So what do you have to do? You want to find a method. They're called direct. Direct methods to solve\nthis kind of problem,",
    "start": "2193560",
    "end": "2203090"
  },
  {
    "text": "in order to get your\nincrement, which is going to be your update, to\nget a better estimate of what the solution is.",
    "start": "2203090",
    "end": "2209050"
  },
  {
    "text": "And the direct methods are\nones that you don't actually store the gigantic matrix. So you're trading off\nCPU time for memory.",
    "start": "2209050",
    "end": "2217260"
  },
  {
    "text": "So you don't have enough memory\nto store the whole thing. Which we, normally you would do\nthis with Gaussian elimination",
    "start": "2217260",
    "end": "2223810"
  },
  {
    "text": "and huge steps. It would solve it\nperfectly, right? Right, Gaussian elimination's\ngreat, backslash. You guys have used\nit a few times.",
    "start": "2223810",
    "end": "2230335"
  },
  {
    "text": "It's a really nice program. It always works. It's really nice. But you're going to give up\nthat because you can't afford it",
    "start": "2230335",
    "end": "2237160"
  },
  {
    "text": "because the memory, it's\nconsuming too much memory and your cheapo department\ndidn't buy enough RAM in your computer for you.",
    "start": "2237160",
    "end": "2243940"
  },
  {
    "text": "So you're going to instead\ntry a direct method which is, so it's trading off\nCPU time versus RAM.",
    "start": "2243940",
    "end": "2257830"
  },
  {
    "text": "So you're going to reduce\nhow much memory you actually actively have, but you're\ngoing to expect that it's going to cost more CPU time.",
    "start": "2257830",
    "end": "2263920"
  },
  {
    "text": "Because otherwise, everybody\nwould do something else besides Gaussian elimination all\nthe time, and they don't. All right, so what's the\nmethod we're going to use?",
    "start": "2263920",
    "end": "2272080"
  },
  {
    "text": "It turns out that variance on\nthe conjugate gradient method turned out really well. So we mentioned this\nearlier, briefly.",
    "start": "2272080",
    "end": "2280510"
  },
  {
    "text": "What you do is, instead\nof trying to solve this,",
    "start": "2280510",
    "end": "2285920"
  },
  {
    "text": "you try to solve this. ",
    "start": "2285920",
    "end": "2306059"
  },
  {
    "text": "So you just try to\nminimize that, right? You know at the solution\nthis is going to be zero.",
    "start": "2306060",
    "end": "2312309"
  },
  {
    "text": "Right, jy plus [INAUDIBLE]\nzero when this is solved. So you try and vary\nand find the delta y",
    "start": "2312310",
    "end": "2318740"
  },
  {
    "text": "that makes this go to\nzero by minimizing it. And then this\nmethod, it turns out",
    "start": "2318740",
    "end": "2324069"
  },
  {
    "text": "that the conjugate gradient,\nif everything works great, this is guaranteed\nin n iterations",
    "start": "2324070",
    "end": "2330220"
  },
  {
    "text": "to go directly to the solution\nof this kind of problem. Now n is large, now, because\nwe have 10 to the 8th unknowns.",
    "start": "2330220",
    "end": "2336320"
  },
  {
    "text": "So that's 10 to\nthe 8th iterations. You do anything in 10\nto the 8th iterations, you're not really sure\nit's really going to work. So that's a warning.",
    "start": "2336320",
    "end": "2342133"
  },
  {
    "text": "But at least it should get,\neven after a few iterations, you should get a smaller value\nof this than you had before.",
    "start": "2342133",
    "end": "2350270"
  },
  {
    "text": "And so this is the method. And what's really nice\nabout this method, if you look into the\ndetails of how it works, it never has to store any\nintermediate matrices.",
    "start": "2350270",
    "end": "2357740"
  },
  {
    "text": "So all it needs\nis the capability to multiply your matrix\ntimes some vector.",
    "start": "2357740",
    "end": "2364730"
  },
  {
    "text": "And from that multiplication,\nit figures out a step direction.",
    "start": "2364730",
    "end": "2369970"
  },
  {
    "text": "That's the trick of this method. And because it only has to\ndo a forward multiplication,",
    "start": "2369970",
    "end": "2376422"
  },
  {
    "text": "you don't have to\nactually store j. You can just compute elements\nof j, as needed, in order to evaluate this top product.",
    "start": "2376422",
    "end": "2383240"
  },
  {
    "text": "This j times v. And you\ndon't have to ever store the whole j at once.",
    "start": "2383240",
    "end": "2388390"
  },
  {
    "text": "So it's really great for\nRAM to do this method.  Now, as I said, when you do\n10 to the 8th iterations,",
    "start": "2388390",
    "end": "2396350"
  },
  {
    "text": "things don't always\nwork out so well. And so people have found that\nwhen you go more than maybe 10 or 20 iterations\nlike this, you tend",
    "start": "2396350",
    "end": "2401844"
  },
  {
    "text": "to pick up numerical problems. And so, they've worked\nout better methods. And there's one that people\nuse a lot for these problems",
    "start": "2401844",
    "end": "2408860"
  },
  {
    "text": "called bi cg stab. Which is biconjugate\ngradient stabilized.",
    "start": "2408860",
    "end": "2416800"
  },
  {
    "text": "The applied mathematicians\nwent crazy trying to figure out better methods like this. And this is the one\nthat, I think currently,",
    "start": "2416800",
    "end": "2422450"
  },
  {
    "text": "people think is the best. Though probably, there's\na lot of research on this, so maybe there's\neven better ones now. But inside Matlab, I think\nthis is the best on they have.",
    "start": "2422450",
    "end": "2429870"
  },
  {
    "text": "And this is a method\nfor doing this. Now, it's iterative.",
    "start": "2429870",
    "end": "2435830"
  },
  {
    "text": "Now, let's remember\nwhat we're doing. We're trying to\nsolve this problem. We started with a guess. We're going to break it up into\nan iterative problem like this,",
    "start": "2435830",
    "end": "2442535"
  },
  {
    "text": "where we're going to\ndo some steps, delta y. This is now doing\niterative procedure",
    "start": "2442535",
    "end": "2447910"
  },
  {
    "text": "in order to compute delta y. So we have an interim procedure\nand another iterative procedure inside the first\niterative procedure.",
    "start": "2447910",
    "end": "2454499"
  },
  {
    "text": "So this is going to be\na lot more CPU time. So just to warn you. ",
    "start": "2454499",
    "end": "2461024"
  },
  {
    "text": "And it's also,\nit's not guaranteed like Gaussian elimination,\nto beautifully come to machine precision solution.",
    "start": "2461024",
    "end": "2466097"
  },
  {
    "text": "It's going to get you something.  But anyway, this\nis what people do.",
    "start": "2466097",
    "end": "2471740"
  },
  {
    "text": "So that's one good thing to try. Now, this whole approach is\nsort of based on Newton-Raphson.",
    "start": "2471740",
    "end": "2480860"
  },
  {
    "text": "We know that doesn't have the\ngreatest radius of convergence. So you need to provide a\npretty darn good initial guess.",
    "start": "2480860",
    "end": "2488520"
  },
  {
    "text": "So how are we going to get\na good initial guess if you have a 100 million unknowns? ",
    "start": "2488520",
    "end": "2495250"
  },
  {
    "text": "So what methods do we know? So one idea is you\ncould do things like homotopy, stuff like that. If you could somehow\ntake your PDE system,",
    "start": "2495250",
    "end": "2502830"
  },
  {
    "text": "get rid of the nonlinear terms. You're really good at solving\nlinear systems of PDEs. You start with that\nand then you gradually",
    "start": "2502830",
    "end": "2509490"
  },
  {
    "text": "turn the non-linear term on. Maybe you could coax it over. So that's one possibility, if\nyou're really good at PDEs.",
    "start": "2509490",
    "end": "2516180"
  },
  {
    "text": "Another possibility\nthat I've run into a lot is the problem you're\ntrying to solve, for example,",
    "start": "2516180",
    "end": "2523140"
  },
  {
    "text": "might be a steady state\nproblem like this. Where this is zero and\nyou try to figure out what the steady state situation is\nin a flow reactor, for example.",
    "start": "2523140",
    "end": "2531900"
  },
  {
    "text": "And so, it's actually,\nyour steady state problem came from a time\ndependent problem.",
    "start": "2531900",
    "end": "2537010"
  },
  {
    "text": "And if you think that your\ntime dependent problem really converges to the\nsteady state problem,",
    "start": "2537010",
    "end": "2542970"
  },
  {
    "text": "sort of without much\nconcern about what the initial guess\nis, then you could put any random initial\nguess in and march it along",
    "start": "2542970",
    "end": "2548550"
  },
  {
    "text": "in time enough, and\neventually, it should end up at the solution you want.",
    "start": "2548550",
    "end": "2555420"
  },
  {
    "text": "So that's the idea. So that's called a\ntime marching idea. So there's one idea, sort\nof the homotopy continuation",
    "start": "2555420",
    "end": "2560790"
  },
  {
    "text": "kind of idea. That's one idea about what\nto do for initial guesses. Another idea is the\ntime marching idea.",
    "start": "2560790",
    "end": "2566404"
  },
  {
    "text": "And the key about it is,\nyou have to really believe that, physically,\nthe system does march to the steady state you want.",
    "start": "2566405",
    "end": "2572510"
  },
  {
    "text": "If it does, then\nthis is a good idea. If it doesn't, then you're not\ngoing to end up where you want, because it's not\ngoing where you want.",
    "start": "2572510",
    "end": "2579990"
  },
  {
    "text": "And so, you have to watch out. But in some situations, this\nis true, that things work. So I do a lot of\ncombustion problems.",
    "start": "2579990",
    "end": "2587220"
  },
  {
    "text": "A lot of these things, you\nlight a spark on a stove burner. No matter how you\nlight it, it ends up",
    "start": "2587220",
    "end": "2593609"
  },
  {
    "text": "basically the same flame. So that's a good one. But I have some other ones\nwhere I light a candle",
    "start": "2593610",
    "end": "2600840"
  },
  {
    "text": "and I'm in a convective\nfield, a turbulent field, and it flickers. And no matter what,\nit always flickers.",
    "start": "2600840",
    "end": "2606755"
  },
  {
    "text": "And I never get a steady\nstate, so I'm never going to find a steady state\nsolution with that one. And so I could time\nmarch until I retire.",
    "start": "2606755",
    "end": "2614716"
  },
  {
    "text": "My computer's still burning\nCPU time all that time and it'll never get to\na steady state solution. So you really have to know\nwhat the real situation is.",
    "start": "2614717",
    "end": "2621539"
  },
  {
    "text": "But if you have one where\nit's going to converge, then this is a reasonable idea. Now let's talk about\nthe time marching.",
    "start": "2621539",
    "end": "2628900"
  },
  {
    "text": "The time marching,\nyou have, say, dy, dt is equal to some\nf of y where this",
    "start": "2628900",
    "end": "2639820"
  },
  {
    "text": "is the discretized\nspatial vergence. I took all the space\ndimensions and replaced them",
    "start": "2639820",
    "end": "2645977"
  },
  {
    "text": "with the finite\ndifference expressions for the derivatives. Or I did colocation or\nsomething to convert this",
    "start": "2645977",
    "end": "2652570"
  },
  {
    "text": "into algebraic equations. So the right-hand side is\nnow algebraic equations, no",
    "start": "2652570",
    "end": "2658120"
  },
  {
    "text": "longer differentials. And now, I'm going to time\nmarch this and I just--",
    "start": "2658120",
    "end": "2665200"
  },
  {
    "text": "This is very long. It's a 100 million. So how are we going\nto time march that?",
    "start": "2665200",
    "end": "2670720"
  },
  {
    "text": "Well there's kind of two\nschools of thought for this. One school of thought is, if\nI can use an explicit method,",
    "start": "2670720",
    "end": "2678089"
  },
  {
    "text": "an explicit ODE solver,\nthose are pretty nice. Because all I have to do\nis evaluate f and then",
    "start": "2678090",
    "end": "2684070"
  },
  {
    "text": "I can march along and I never\nhave to save any matrices. Because remember, look\nat those formulas, y,",
    "start": "2684070",
    "end": "2691630"
  },
  {
    "text": "y new, by the\nexplicit method, is equal to some\nfunction g of y old.",
    "start": "2691630",
    "end": "2700320"
  },
  {
    "text": " And this is the update formula.",
    "start": "2700320",
    "end": "2705760"
  },
  {
    "text": "It can be forward Euler. It could be RK 2. It could be whatever. But there's just some\nexplicit formula.",
    "start": "2705760",
    "end": "2710970"
  },
  {
    "text": "I plug in the old vector. I compute a new vector. I never had to do any inversions\nof matrices or anything.",
    "start": "2710970",
    "end": "2718050"
  },
  {
    "text": "So that's good. And this is, indeed, the\nway that the Navier-Stokes equations are solved currently\nby the best possible solver.",
    "start": "2718050",
    "end": "2725310"
  },
  {
    "text": "So the best solver in the\nworld discretizes in space and then does ODE IVP\nusing explicit method",
    "start": "2725310",
    "end": "2734970"
  },
  {
    "text": "for marching it. They do problems\nthat are pretty big. So they'll have like 100\nmillion mesh points and then 100",
    "start": "2734970",
    "end": "2740190"
  },
  {
    "text": "species. So they have 10 to\nthe 10th unknowns. And at each time step, you're\ncomputing another vector",
    "start": "2740190",
    "end": "2747120"
  },
  {
    "text": "that's 10 to the 10th long. So it's a pretty big problem. And they use, like, 40% of one\nof the national supercomputer",
    "start": "2747120",
    "end": "2755460"
  },
  {
    "text": "centers will be running at one\ntime for one job like this. But it works. You never have to store\nanything that's too big.",
    "start": "2755460",
    "end": "2761700"
  },
  {
    "text": "The biggest thing you have\nto store are the vectors. Which, you're\nalways going to have to store some object the\nsize of your solution,",
    "start": "2761700",
    "end": "2766988"
  },
  {
    "text": "right, if you're going\nto get your solution. So that's one possibility. Now, this is really good if an\nexplicit solver can solve it.",
    "start": "2766988",
    "end": "2776240"
  },
  {
    "text": "So that means it's just\nnot stiff, your problem. And also, if you want a\ntime accurate solution.",
    "start": "2776240",
    "end": "2784140"
  },
  {
    "text": "So in that case, they actually\nwant the time accurate solution. But suppose we're trying to\nreally solve the steady state",
    "start": "2784140",
    "end": "2789780"
  },
  {
    "text": "problem over here. Then we really don't care\nabout the time accuracy. We're not going to report\nanything about our time steps.",
    "start": "2789780",
    "end": "2796720"
  },
  {
    "text": "In the end, we're only going\nto report our steady state solution. That's all we cared about. So in that case,\nthere's no reason to try to have a really high\naccuracy, explicit formula",
    "start": "2796720",
    "end": "2804580"
  },
  {
    "text": "and try to make sure we all our\ntime steps are exactly right. We're just going to throw away\nall those time points anyway. We'll just keep the final\none as our initial guess",
    "start": "2804580",
    "end": "2811360"
  },
  {
    "text": "for a Newton-Raphson solve\nto find the steady state. So in those cases, you\nmight instead want to use--",
    "start": "2811360",
    "end": "2817839"
  },
  {
    "text": "So this is time accurate. ",
    "start": "2817840",
    "end": "2825312"
  },
  {
    "text": "There's another method. I don't know if I should\ncall it time inaccurate. If you don't care, if\nthe solution is really,",
    "start": "2825312",
    "end": "2834250"
  },
  {
    "text": "what the solution\nyft is, all you care about is where you get to,\nthen you can do other methods.",
    "start": "2834250",
    "end": "2839770"
  },
  {
    "text": "And one of them is\nthe backward Euler. So you can say, well,\ny new is equal to y old",
    "start": "2839770",
    "end": "2850380"
  },
  {
    "text": "plus delta t times f of y new.",
    "start": "2850380",
    "end": "2855660"
  },
  {
    "text": "Now, the advantage of this is,\nI can make delta t pretty large. This is guaranteed\nstable as long",
    "start": "2855660",
    "end": "2861250"
  },
  {
    "text": "as the ODE system is stable. Remember? And so, this will go to this,\ngo to the solution pretty well,",
    "start": "2861250",
    "end": "2869109"
  },
  {
    "text": "to the steady state solution. It won't go there in\nthe right amount of time because this is a very\nlow order of formula.",
    "start": "2869110",
    "end": "2874760"
  },
  {
    "text": "It's not really accurate. But it will end up to the\nreal steady state solution. This is what's\nactually used a lot.",
    "start": "2874760",
    "end": "2881220"
  },
  {
    "text": "However, the problem\nwith this is, this is now an implicit equation.",
    "start": "2881220",
    "end": "2887530"
  },
  {
    "text": "So we may have to solve\nit with some method like Newton-Raphson. But we got into this\nbecause we couldn't",
    "start": "2887530",
    "end": "2893570"
  },
  {
    "text": "solve our Newton-Raphson\nsteps because we didn't have a good initial guess. So then the question is, can\nwe find a good initial guess",
    "start": "2893570",
    "end": "2899890"
  },
  {
    "text": "for this problem? And in this case,\nyou can because you can use the explicit formulas to\nagain provide the initial guess",
    "start": "2899890",
    "end": "2907970"
  },
  {
    "text": "for this implicit formula. So that's what they do, also.",
    "start": "2907970",
    "end": "2913220"
  },
  {
    "text": "And so now, if we're doing an\niterative procedure in order to get the initial guess for\nour other iterative procedure",
    "start": "2913220",
    "end": "2918620"
  },
  {
    "text": "ever there, which\nwe're going to break up into another iterative procedure\ninside it to solve every step. ",
    "start": "2918620",
    "end": "2925910"
  },
  {
    "text": "But this is currently\nwhat people do. So you guys are smart. Maybe you can figure\na better way to do it.",
    "start": "2925910",
    "end": "2931610"
  },
  {
    "text": "The world is waiting. I think I'll stop there. ",
    "start": "2931610",
    "end": "2937880"
  },
  {
    "text": "By the way, actually\njust names-- This kind of thing is\ncalled method of lines.",
    "start": "2937880",
    "end": "2942980"
  },
  {
    "text": " And if so, if anybody ever\nsays I solved something",
    "start": "2942980",
    "end": "2949630"
  },
  {
    "text": "by method of lines,\nwhat they meant was, they discretized in\nsome of the coordinates and they kept one of the\ncoordinates as a differential.",
    "start": "2949630",
    "end": "2956680"
  },
  {
    "text": "And then they solved it with\nan ODE solver at the end. And in certain systems like\nthis, it's a smart thing to do.",
    "start": "2956680",
    "end": "2963630"
  },
  {
    "text": "You need to be kind of lucky\nthat the set up is right, so you can use it. But if you can, it\ncan be pretty good.",
    "start": "2963630",
    "end": "2969960"
  },
  {
    "text": "All right. See you on Friday. ",
    "start": "2969960",
    "end": "2973777"
  }
]