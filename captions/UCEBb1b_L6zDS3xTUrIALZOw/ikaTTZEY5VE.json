[
  {
    "text": "[SQUEAKING]\n[RUSTLING] [CLICKING]",
    "start": "0",
    "end": "5324"
  },
  {
    "text": " DAVID PERREAULT:\nSo what I wanted",
    "start": "5324",
    "end": "11120"
  },
  {
    "text": "to do for the next few lectures\nis talk a bit about control",
    "start": "11120",
    "end": "17510"
  },
  {
    "text": "of power converters. And actually, I'm more\ngoing to talk about modeling",
    "start": "17510",
    "end": "24650"
  },
  {
    "text": "of power converters than\ncontrol of power converters because I can't really teach\ncontrol theory in this class.",
    "start": "24650",
    "end": "32840"
  },
  {
    "text": "If you haven't had\na control class yet, it's really time to go out and\ntake one because no matter what",
    "start": "32840",
    "end": "38360"
  },
  {
    "text": "you're going to\ndo, you're really probably going to need to\nunderstand feedback control.",
    "start": "38360",
    "end": "43970"
  },
  {
    "text": "But what we can do in\nthis class is show you how one can model power\nconverters to put them--",
    "start": "43970",
    "end": "52520"
  },
  {
    "text": "to get a model in the format\nthat you can use it for feedback control and do basic control.",
    "start": "52520",
    "end": "58850"
  },
  {
    "text": "So let's think about\na power converter. Let's start off with our\nfriendly neighborhood boost",
    "start": "58850",
    "end": "64160"
  },
  {
    "text": "converter. So maybe I have some\ninput voltage VIN. ",
    "start": "64160",
    "end": "71880"
  },
  {
    "text": "I'll switch it with some\nswitching waveform q of t.",
    "start": "71880",
    "end": "78200"
  },
  {
    "text": "And then I'm going\nto have a diode. I will have a capacitor. And the converter ends here.",
    "start": "78200",
    "end": "83939"
  },
  {
    "text": "And then somewhere,\nwe usually show RL.",
    "start": "83940",
    "end": "89340"
  },
  {
    "text": "And I have my input voltage. And I have my output\nvoltage, VOUT. Now, I usually in my examples,\njust by way of an aside--",
    "start": "89340",
    "end": "100399"
  },
  {
    "text": "I usually show a resistive load. A lot of loads are resistive. But there's no guarantee that\nin an actual application,",
    "start": "100400",
    "end": "109220"
  },
  {
    "text": "your load looks like a resistor. It could look like whatever.",
    "start": "109220",
    "end": "114470"
  },
  {
    "text": "Maybe a lot of loads you might\nrepresent as some maybe Norton",
    "start": "114470",
    "end": "122720"
  },
  {
    "text": "equivalent where there's some\nconstant current component and some resistive\ncurrent component.",
    "start": "122720",
    "end": "129119"
  },
  {
    "text": "And I'm just doing\nthe simplified case where the Norton source\nis 0 and the resistance is RL.",
    "start": "129120",
    "end": "135920"
  },
  {
    "text": " This is just a way\nof saying in general, you would worry\nabout exactly what",
    "start": "135920",
    "end": "143159"
  },
  {
    "text": "the load looks like not just\nin terms of how much current does it draw.",
    "start": "143160",
    "end": "148470"
  },
  {
    "text": "But exactly what the load looked\nlike can affect the dynamics. But for simplicity, let's just\ntalk about resistive loads,",
    "start": "148470",
    "end": "155490"
  },
  {
    "text": "which is a very common case. ",
    "start": "155490",
    "end": "162990"
  },
  {
    "text": "What do we have to do in\na typical power converter application?",
    "start": "162990",
    "end": "168055"
  },
  {
    "text": "We want to usually\nregulate the output voltage to be something we want.",
    "start": "168055",
    "end": "173490"
  },
  {
    "text": "So we want to make VOUT go\nto some reference voltage",
    "start": "173490",
    "end": "184020"
  },
  {
    "text": "that I'll call VREF. VREF might be fixed-- it might be I want 12\nvolts output all day long--",
    "start": "184020",
    "end": "192190"
  },
  {
    "text": "or it may be something\nthat you dynamically vary based on some\nother consideration",
    "start": "192190",
    "end": "198021"
  },
  {
    "text": "that we're not\ngoing to talk about. So it could be a fixed\nor a variable reference. But for the present\ntime, let's just",
    "start": "198022",
    "end": "203370"
  },
  {
    "text": "assume I want to get my\noutput on my converter to be some fixed value\nthat I would like it to be. If I'm creating a\n12-volt power supply,",
    "start": "203370",
    "end": "210000"
  },
  {
    "text": "I want it to be 12 volts. And we have to keep\nthe output voltage",
    "start": "210000",
    "end": "215820"
  },
  {
    "text": "closer at the reference\nvoltage under a wide variety of conditions. And this is where power\nelectronics is challenging.",
    "start": "215820",
    "end": "222000"
  },
  {
    "text": "Firstly, for\nvariations in load-- ",
    "start": "222000",
    "end": "230280"
  },
  {
    "text": "so maybe I would have RLmin less\nthan what RL is less than RLmax.",
    "start": "230280",
    "end": "239700"
  },
  {
    "text": "So this would be heavy load\nbecause the lowest resistance",
    "start": "239700",
    "end": "247980"
  },
  {
    "text": "gives me the highest power. And this might be light load. ",
    "start": "247980",
    "end": "255900"
  },
  {
    "text": "I also need to keep VOUT\nnear Vreference in terms of-- for variations in VIN.",
    "start": "255900",
    "end": "268620"
  },
  {
    "text": "So maybe there's a VINmin\nless than VIN less than VINmax",
    "start": "268620",
    "end": "278040"
  },
  {
    "text": "that I've got to deal with. Why do I have to\nworry about those? Well, my load's not always\ngoing to be the same.",
    "start": "278040",
    "end": "284950"
  },
  {
    "text": "Maybe this is controlling\na voltage which goes to a bunch of\nmicroprocessors or other things",
    "start": "284950",
    "end": "290220"
  },
  {
    "text": "or actuators and they're\nturning on and off. So the effective resistance,\nthe effective power,",
    "start": "290220",
    "end": "295410"
  },
  {
    "text": "I have to supply varies,\neven at fixed voltage. And here, maybe I'm powered\nfrom a battery and the battery",
    "start": "295410",
    "end": "301169"
  },
  {
    "text": "discharges over time or\nI'm charging or whatever. So there's going to be some\ninput range, input voltage",
    "start": "301170",
    "end": "307260"
  },
  {
    "text": "range, over which this\nconverter is designed to reject that as a disturbance\nand just keep the output where",
    "start": "307260",
    "end": "312550"
  },
  {
    "text": "I want it. Now, so far, we've\nspent a lot of time",
    "start": "312550",
    "end": "320070"
  },
  {
    "text": "talking about the\nsteady-state operation. And that's usually\nalways the first thing",
    "start": "320070",
    "end": "325259"
  },
  {
    "text": "I look at because it tells\nme when things are sitting at some place, know some load\nresistance, some input voltage.",
    "start": "325260",
    "end": "333539"
  },
  {
    "text": "What's it going to Do\nAnd we said for the boost converter, what I get is VOUT\nis equal to VIN over 1 minus D.",
    "start": "333540",
    "end": "345910"
  },
  {
    "text": "So this is the\nsteady-state relationship. This is in PSS, in\nperiodic steady state.",
    "start": "345910",
    "end": "352090"
  },
  {
    "text": "Once we've settled down, this\nconverter ought to do this. So if I control the duty\nratio of my switch, q of t,",
    "start": "352090",
    "end": "360046"
  },
  {
    "text": "to this value, this\nis what I should get for an output voltage. ",
    "start": "360046",
    "end": "367085"
  },
  {
    "text": "So you might think,\nmaybe I could just",
    "start": "367085",
    "end": "372220"
  },
  {
    "text": "measure the input\nvoltage, set a duty ratio, and get the output\nvoltage I want,",
    "start": "372220",
    "end": "378620"
  },
  {
    "text": "and that's the end of the day. But there's two\nproblems with that. One this is only in\nperiodic steady state.",
    "start": "378620",
    "end": "385180"
  },
  {
    "text": "And it doesn't say how things\nwill change transiently in between periodic\nsteady-state conditions.",
    "start": "385180",
    "end": "390800"
  },
  {
    "text": "And I really care about that\nbecause if the voltage goes-- if I decide to change\nthe load, the voltage",
    "start": "390800",
    "end": "397000"
  },
  {
    "text": "goes wild until it settles down. I'm probably not\ngoing to be happy.",
    "start": "397000",
    "end": "402070"
  },
  {
    "text": "The other thing\nabout this is this is an idealized relationship. When we derived this, we\ndid it by volt-seconds",
    "start": "402070",
    "end": "409720"
  },
  {
    "text": "balanced across this inductor. I pretended the inductor\nhad no resistance. I ignored the diode drop.",
    "start": "409720",
    "end": "415310"
  },
  {
    "text": "I ignored a whole\nbunch of things which don't matter for getting\nan approximate relationship.",
    "start": "415310",
    "end": "421670"
  },
  {
    "text": "But they do matter if\nI need to control this to 12 volts plus or minus 2%.",
    "start": "421670",
    "end": "429000"
  },
  {
    "text": "The model's just\nnot good enough. I need some better way\nto get my converter",
    "start": "429000",
    "end": "434310"
  },
  {
    "text": "to get where I want it to\nbe and maintain it there under variations like this.",
    "start": "434310",
    "end": "442050"
  },
  {
    "text": "Any questions about that?  Just to illustrate\nthat, what I've got here",
    "start": "442050",
    "end": "450460"
  },
  {
    "text": "is a SPICE simulation\nof a boost converter",
    "start": "450460",
    "end": "457690"
  },
  {
    "text": "which is undergoing\na load transient. So what's happening in\nthis is here at some time,",
    "start": "457690",
    "end": "464500"
  },
  {
    "text": "at actually at 1.4\nmilliseconds, we had a 5-ohm-- we originally had a 5-ohm\nload on the converter.",
    "start": "464500",
    "end": "470830"
  },
  {
    "text": "And we put in\nanother 5-ohm load. So it's like some\nnew load has come in.",
    "start": "470830",
    "end": "477639"
  },
  {
    "text": "In this example, we're\njust holding the duty ratio of the converter constant. So we expect that, barring a\nlot of second-order effects,",
    "start": "477640",
    "end": "485470"
  },
  {
    "text": "the output voltage\nshould go back to the same thing in\nperiodic steady state. But clearly, if the output\nvoltage is going to be the same",
    "start": "485470",
    "end": "494190"
  },
  {
    "text": "and I've got smaller\nnet resistance on it because I have the\nnet resistance, the power has to go up.",
    "start": "494190",
    "end": "499500"
  },
  {
    "text": "The current has to go up. So things have to change. And that's what\nwe see happening.",
    "start": "499500",
    "end": "504750"
  },
  {
    "text": "So this trace down here\nis the input current. So the input current was sitting\non average around 12 amps.",
    "start": "504750",
    "end": "512308"
  },
  {
    "text": "I go through some transient. And I end up around 24 amps.",
    "start": "512309",
    "end": "518380"
  },
  {
    "text": "The output voltage had\nbeen sitting at 22 volts, goes through some transient,\nand I get back to 22 volts",
    "start": "518380",
    "end": "524890"
  },
  {
    "text": "because it's running\nat fixed duty ratio. So what we see here is the\nstuff we've skipped over so far.",
    "start": "524890",
    "end": "534240"
  },
  {
    "text": "We know we could calculate\nbased on periodic steady state--",
    "start": "534240",
    "end": "539990"
  },
  {
    "text": "say that the output capacitor\nvoltage and the average inductor current in both conditions.",
    "start": "539990",
    "end": "545880"
  },
  {
    "text": "But we haven't accounted\nfor how does it transiently go between those conditions.",
    "start": "545880",
    "end": "551360"
  },
  {
    "text": "And that's what we\nhave to know in order to make our system happy.",
    "start": "551360",
    "end": "559670"
  },
  {
    "text": "And so that's what\nwe're going to focus on. And I'd like you to notice\nthat this response looks",
    "start": "559670",
    "end": "571040"
  },
  {
    "text": "like a second-order system. It has a-- looks like a damped\nLC oscillation, sort of, which",
    "start": "571040",
    "end": "579470"
  },
  {
    "text": "is not surprising because\nI've got one C and one L.",
    "start": "579470",
    "end": "585500"
  },
  {
    "text": "And there's load on it. So energy has been\ntaken out of it. So maybe that's not surprising.",
    "start": "585500",
    "end": "591160"
  },
  {
    "text": "The question is, what\ndoes this thing look like?",
    "start": "591160",
    "end": "596970"
  },
  {
    "text": "So how would I control this\nthing in the real world? I'd use feedback control.",
    "start": "596970",
    "end": "602600"
  },
  {
    "text": " So what are we going to do? We're going to say I have\nsome reference voltage, VREF,",
    "start": "602600",
    "end": "613529"
  },
  {
    "text": "that I want my\nconverter to go to. And I provide that\nvoltage reference. And I'm going to compare\nthat voltage reference",
    "start": "613530",
    "end": "621569"
  },
  {
    "text": "to the output voltage, VOUT. And I'm going to generate\nan error between those two.",
    "start": "621570",
    "end": "633600"
  },
  {
    "text": "I'll take that error and feed\nit into a high-gain compensator. ",
    "start": "633600",
    "end": "641889"
  },
  {
    "text": "Maybe I could represent\nthat with a transfer function, GC of s. This might be, for example,\na PID controller or something",
    "start": "641890",
    "end": "655779"
  },
  {
    "text": "fancier-- depends on the topology. This is where having\na control class--",
    "start": "655780",
    "end": "661529"
  },
  {
    "text": "But you might think\nwhat this does is if I have error, I amplify\nthat error by some amount,",
    "start": "661530",
    "end": "667730"
  },
  {
    "text": "either proportionally or look\nat the integral of the error or something like that,\nand generate an output,",
    "start": "667730",
    "end": "674240"
  },
  {
    "text": "which I'm going to call Vd.  What is this signal?",
    "start": "674240",
    "end": "679860"
  },
  {
    "text": "This is usually a voltage,\nalthough I could represent it with a current. It's a voltage representing\nthe duty ratio I want.",
    "start": "679860",
    "end": "691675"
  },
  {
    "text": " Now I have a voltage\nrepresenting the duty ratio.",
    "start": "691675",
    "end": "698149"
  },
  {
    "text": "I have to put this into some PWM\ncircuit, pulse width modulation circuit, that's going\nto give me q of t",
    "start": "698150",
    "end": "707269"
  },
  {
    "text": "because if I look at\nup there, I'm talking about in terms of duty ratio. But the actual signal going\nto my switch is some q of t",
    "start": "707270",
    "end": "714830"
  },
  {
    "text": "or some amplified version\nof q of t from a gate drive that's turning the switch on\nand off at the right duty ratio.",
    "start": "714830",
    "end": "721530"
  },
  {
    "text": "So the input of this is some\nvalue of duty ratio I want. The output of this is some PWM\nwaveform switching at period T",
    "start": "721530",
    "end": "731520"
  },
  {
    "text": "with an on time that's dT.",
    "start": "731520",
    "end": "737180"
  },
  {
    "text": "This then goes into\nmy actual converter,",
    "start": "737180",
    "end": "745230"
  },
  {
    "text": "which also, if you think\nabout it, has inputs of VIN. And it's being affected\nby what the RL is.",
    "start": "745230",
    "end": "754214"
  },
  {
    "text": "And then its state variables\nare the inductor current and the output voltage, which\nis also the capacitor voltage,",
    "start": "754215",
    "end": "761490"
  },
  {
    "text": "VOUT. And that's what I'm\nfeeding around back here.",
    "start": "761490",
    "end": "766850"
  },
  {
    "text": "So this is a typical\nclosed-loop control system. If VOUT gets smaller than\nthe reference voltage,",
    "start": "766850",
    "end": "774830"
  },
  {
    "text": "Verror goes up. I amplify that. My duty ratio goes up. And when my duty ratio goes\nup, my output voltage goes up",
    "start": "774830",
    "end": "782000"
  },
  {
    "text": "and I close the loop. And eventually, hopefully this\nsettles to VOUT close to VREF.",
    "start": "782000",
    "end": "788543"
  },
  {
    "text": "Any questions\nabout that picture?  Just out of curiosity,\nhow many people",
    "start": "788544",
    "end": "794860"
  },
  {
    "text": "here have had either a classical\nor state space control class? ",
    "start": "794860",
    "end": "801580"
  },
  {
    "text": "Good fraction. Good. Let's make that\nfraction 100% next year because you really want to know\nthis, no matter what you do.",
    "start": "801580",
    "end": "808620"
  },
  {
    "start": "808620",
    "end": "816900"
  },
  {
    "text": "This is a standard\nfeedback system. What we need to do this--",
    "start": "816900",
    "end": "824714"
  },
  {
    "text": "if I put it in the wrong\ncompensator and I put feedback, I could make this thing\noscillate and go unstable.",
    "start": "824715",
    "end": "831290"
  },
  {
    "text": "We've all seen the\neffects of bad feedback,",
    "start": "831290",
    "end": "836967"
  },
  {
    "text": "like when you put your\nmicrophone too close to your speaker. And suddenly, the\nthing goes crazy. And you can certainly make\na power converter go crazy",
    "start": "836968",
    "end": "844100"
  },
  {
    "text": "if you're not careful. And what we need\nto know in order",
    "start": "844100",
    "end": "850010"
  },
  {
    "text": "to make this work is some model\nthat basically says, as I'm",
    "start": "850010",
    "end": "856490"
  },
  {
    "text": "changing my duty ratio\nor something else, like the load resistor, how\ndoes this dynamically vary?",
    "start": "856490",
    "end": "864954"
  },
  {
    "text": "If I know that, then I\ncan design a control loop for the thing.",
    "start": "864955",
    "end": "870530"
  },
  {
    "text": "And so what I'd\nlike to talk about is how do we build this\nmodel, this dynamic model,",
    "start": "870530",
    "end": "876610"
  },
  {
    "text": "instead of a periodic\nsteady-state model. What does the dynamic\nmodel of this thing look like from\nvariations in duty ratio,",
    "start": "876610",
    "end": "883329"
  },
  {
    "text": "for example, to the variations\nin the output voltage? And coming back to\nthis picture, we",
    "start": "883330",
    "end": "890779"
  },
  {
    "text": "can see that what we have\nhere is a bunch of switching. Here's the switching ripple,\nthe triangular ripple current",
    "start": "890780",
    "end": "897260"
  },
  {
    "text": "in the inductor. And it goes through\nsome oscillations. And then it settles\ndown, and the same thing with the capacitor voltage.",
    "start": "897260",
    "end": "903270"
  },
  {
    "text": "Well, I'm not particularly\ninterested in this switching ripple.",
    "start": "903270",
    "end": "909269"
  },
  {
    "text": "Why am I not interested\nin it is because notice that the dynamical behavior is\nat a very low frequency compared",
    "start": "909270",
    "end": "915780"
  },
  {
    "text": "to the switching ripple. And I can't really do anything\nabout the switching ripple,",
    "start": "915780",
    "end": "921440"
  },
  {
    "text": "anyways. In other words, that's\nintrinsic to the converter. I'm going to put some\nenergy in and I'm",
    "start": "921440",
    "end": "926500"
  },
  {
    "text": "going to process it through. I'm going to take it out. If I'm trying to, say, vary\nmy duty ratio on the time",
    "start": "926500",
    "end": "932810"
  },
  {
    "text": "scale of this switching,\nI'm very, very fast, I'm probably going to make the\nconverter do unhappy things.",
    "start": "932810",
    "end": "940220"
  },
  {
    "text": "My whole notion was that\nat least within a cycle, duty ratio is not something\nthat I'm swinging around wildly.",
    "start": "940220",
    "end": "948920"
  },
  {
    "text": "So I'm interested\nin the behavior of this circuit for\nfrequencies relatively low",
    "start": "948920",
    "end": "954290"
  },
  {
    "text": "compared to the\nswitching frequency. So what I want to do\nis generate models",
    "start": "954290",
    "end": "959690"
  },
  {
    "text": "that capture this\naverage behavior, like these low-frequency\noscillations,",
    "start": "959690",
    "end": "966110"
  },
  {
    "text": "and ignore the switching ripple. Everybody follow that? ",
    "start": "966110",
    "end": "975934"
  },
  {
    "text": "So let me think about this\nin a couple of pieces. Well, first of all, let's just\ntalk about this PWM block.",
    "start": "975934",
    "end": "982840"
  },
  {
    "text": "We've talked about this before. This isn't part of\nthe average model. But essentially, what would\nthe PWM block look like?",
    "start": "982840",
    "end": "989700"
  },
  {
    "text": " Basically, what I\nwould have is maybe I",
    "start": "989700",
    "end": "998529"
  },
  {
    "text": "would generate\nsome triangle wave. This could be a sawtooth,\nfor example, with a period T.",
    "start": "998530",
    "end": "1009819"
  },
  {
    "text": "And I'll just generate this. And maybe for simplicity,\nI'll just say this is a 1-volt signal.",
    "start": "1009820",
    "end": "1016860"
  },
  {
    "text": "And I will compare that\nto this duty ratio signal. So here's Vd. ",
    "start": "1016860",
    "end": "1025800"
  },
  {
    "text": "And Vd is-- maybe it's changing. But it's changing very slowly. So here's Vd.",
    "start": "1025800",
    "end": "1032939"
  },
  {
    "text": "And I'm just going to run\nthis into a comparator. I'm going to call this VTRI.",
    "start": "1032940",
    "end": "1039310"
  },
  {
    "text": "And I'll compare VTRI to\nVd and generate q of t.",
    "start": "1039310",
    "end": "1048820"
  },
  {
    "text": "So all I'm going to do is-- at\nthe beginning of each cycle, what you can see\nis if this is time,",
    "start": "1048820",
    "end": "1055750"
  },
  {
    "text": "at the beginning of\neach cycle, q of t is going to go high until the\ntriangle exceeds the V sub d,",
    "start": "1055750",
    "end": "1066470"
  },
  {
    "text": "in which case I'll go low. And then I'll go high at the\nbeginning of the next cycle.",
    "start": "1066470",
    "end": "1072350"
  },
  {
    "text": "And I'll stay high until\nI hit the end, until I hit",
    "start": "1072350",
    "end": "1077539"
  },
  {
    "text": "the comparison, and so forth-- same again in the next\ncycle, and so forth.",
    "start": "1077540",
    "end": "1087299"
  },
  {
    "text": "So by comparing my V sub d\nto a linearly rising element, I can generate something\nwhere this is--",
    "start": "1087300",
    "end": "1094490"
  },
  {
    "text": "whatever V sub d was here,\nthat's-- represents some duty ratio. That's going to be\ndT at this point.",
    "start": "1094490",
    "end": "1100235"
  },
  {
    "text": "And I'm going to have\ndT at this point, which might be different, et cetera. And each cycle, I\nget a duty ratio",
    "start": "1100235",
    "end": "1107570"
  },
  {
    "text": "that's related to V sub d during\nthat cycle assuming V sub d doesn't vary very quickly.",
    "start": "1107570",
    "end": "1114980"
  },
  {
    "text": "So this is how I build\nthe PWM generator. That's this block here.",
    "start": "1114980",
    "end": "1121220"
  },
  {
    "text": "That's not how I model it. That's just how I implement it. So from a mental\nperspective, we can",
    "start": "1121220",
    "end": "1128360"
  },
  {
    "text": "worry about going\nfrom some desired duty ratio to some response or\nthe local average duty ratio",
    "start": "1128360",
    "end": "1134210"
  },
  {
    "text": "to some response\nwhere I'm assuming that Vd is only varying\nvery slowly within any given",
    "start": "1134210",
    "end": "1139880"
  },
  {
    "text": "switching cycle. And if your compensator\nlets it very,",
    "start": "1139880",
    "end": "1145272"
  },
  {
    "text": "very quickly, you're\nprobably going to be unhappy. ",
    "start": "1145272",
    "end": "1152570"
  },
  {
    "text": "So that gives me a\nway to implement this. And I should say, by the\nway, that if I go buy a PWM",
    "start": "1152570",
    "end": "1158300"
  },
  {
    "text": "chip for a typical DC-to-DC\nconverter or controller chip, I'll usually get a reference,\nsome kind of error amplifier,",
    "start": "1158300",
    "end": "1167570"
  },
  {
    "text": "op-amp, and other things to\ngenerate the compensator. I'll get the PWM chip.",
    "start": "1167570",
    "end": "1173789"
  },
  {
    "text": "And in fact, this triangle\nalso serves as my clock. So I can set the\nclock frequency. I can set T. And then maybe\nit gives me a gate driver.",
    "start": "1173790",
    "end": "1181830"
  },
  {
    "text": "So I'll get all this\nstuff in one chip very often for a simple design.",
    "start": "1181830",
    "end": "1188430"
  },
  {
    "text": "Of course, you can also do a\nlot of this stuff digitally these days, depending upon\nwhat kind of processor you use.",
    "start": "1188430",
    "end": "1196159"
  },
  {
    "text": "But this doesn't tell me-- this tells me how did I get\nfrom duty ratio to the q of t.",
    "start": "1196160",
    "end": "1202280"
  },
  {
    "text": "But it doesn't tell me how\nI model this whole block. And that's what I'd\nlike to talk about now.",
    "start": "1202280",
    "end": "1210830"
  },
  {
    "text": "And we said we\nare not interested in this high-frequency\nripple, but only the low-frequency behavior.",
    "start": "1210830",
    "end": "1219240"
  },
  {
    "text": "And towards that end, I'd\nlike to introduce what's known as a local average.",
    "start": "1219240",
    "end": "1224350"
  },
  {
    "text": "So the local average\noperator is this.",
    "start": "1224350",
    "end": "1233065"
  },
  {
    "text": "If I had some signal\nfor any signal x of t, some time-varying waveform\nx of t-- could be a voltage,",
    "start": "1233065",
    "end": "1240080"
  },
  {
    "text": "could be a current,\nwhatever I wanted-- I can define a local\naverage x bar of t",
    "start": "1240080",
    "end": "1246990"
  },
  {
    "text": "is defined as being equal to\n1 over T integral between t",
    "start": "1246990",
    "end": "1253590"
  },
  {
    "text": "minus capital T and\nt of x of tau d tau.",
    "start": "1253590",
    "end": "1259059"
  },
  {
    "text": "This is the local\naverage of a signal. And what is this local average?",
    "start": "1259060",
    "end": "1264309"
  },
  {
    "text": "It's just a moving average. So if I'm at my signal\ntime right now at time T,",
    "start": "1264310",
    "end": "1270510"
  },
  {
    "text": "what I'm going to\ndo is I'm going to look back over 1\ncapital T and take",
    "start": "1270510",
    "end": "1277350"
  },
  {
    "text": "the average of the waveform\njust over that time. And then if I'm at another\ntime, I'll look back",
    "start": "1277350",
    "end": "1282420"
  },
  {
    "text": "and I'll take the average\nover at that time. So if I had some time-varying\nwaveform x of t and I said,",
    "start": "1282420",
    "end": "1293520"
  },
  {
    "text": "here's t1, maybe I'd go back.",
    "start": "1293520",
    "end": "1302100"
  },
  {
    "text": "And here's t1 minus\ncapital T. Maybe I would take the average of\nthis waveform over that time.",
    "start": "1302100",
    "end": "1308650"
  },
  {
    "text": "And then if I'm at some other\ntime t2, I'd go back one cycle.",
    "start": "1308650",
    "end": "1316590"
  },
  {
    "text": "And this is t minus T2-- t2 minus capital T. And I'd look\nat the average over this time",
    "start": "1316590",
    "end": "1323670"
  },
  {
    "text": "period, et cetera. So at any given point,\nI'm going to look at what I've been doing\nover the last capital T",
    "start": "1323670",
    "end": "1331740"
  },
  {
    "text": "and take that average. Why am I doing that? Well, because if I set capital\nT to be my switching period,",
    "start": "1331740",
    "end": "1339210"
  },
  {
    "text": "I can look at what the\naverage of this variable is over one switching\ncycle at any point in time.",
    "start": "1339210",
    "end": "1348929"
  },
  {
    "text": " And we can think of this\nas basically tracking",
    "start": "1348930",
    "end": "1355840"
  },
  {
    "text": "the low-frequency variations and\nrejecting the switching ripple.",
    "start": "1355840",
    "end": "1361000"
  },
  {
    "text": "And we can think about\nit qualitatively. And we can think about\nit quantitatively. Any questions about\nthe idea of what we",
    "start": "1361000",
    "end": "1367750"
  },
  {
    "text": "want to do with this operator? ",
    "start": "1367750",
    "end": "1374649"
  },
  {
    "text": "So what are the properties\nof this operator? ",
    "start": "1374650",
    "end": "1381030"
  },
  {
    "text": "The first is that it's LTI,\nlinear and time-invariant",
    "start": "1381030",
    "end": "1387880"
  },
  {
    "text": "So when I say it's linear,\nI mean the following--",
    "start": "1387880",
    "end": "1392940"
  },
  {
    "text": "that if I took a times x\nof t plus b times y of t",
    "start": "1392940",
    "end": "1400850"
  },
  {
    "text": "and then I took the local\naverage of this whole signal,",
    "start": "1400850",
    "end": "1406860"
  },
  {
    "text": "what I would get is\na times x bar of t",
    "start": "1406860",
    "end": "1412470"
  },
  {
    "text": "plus b times y bar of t. ",
    "start": "1412470",
    "end": "1418440"
  },
  {
    "text": "That's nice. It's also\ntime-invariant, by which",
    "start": "1418440",
    "end": "1425550"
  },
  {
    "text": "I mean if I took a signal x\nand shifted it by some time t0",
    "start": "1425550",
    "end": "1432930"
  },
  {
    "text": "and then I took the local\naverage of that shifted signal,",
    "start": "1432930",
    "end": "1438020"
  },
  {
    "text": "it's equal to x bar shifted.",
    "start": "1438020",
    "end": "1443660"
  },
  {
    "text": "It's equal to x bar\nof t shifted by t0. So the local\naverage of the shift is the shift of\nthe local average.",
    "start": "1443660",
    "end": "1451130"
  },
  {
    "text": "That make sense to everybody? So now why am I\nworrying that it's a linear time-invariant\noperator?",
    "start": "1451130",
    "end": "1458313"
  },
  {
    "text": "That means I can actually\nrepresent this thing with a transfer function.",
    "start": "1458313",
    "end": "1463726"
  },
  {
    "text": "As an operator, it's\nbasically a filter that I can put on my circuit. So this is just a way\nof describing a filter.",
    "start": "1463726",
    "end": "1473480"
  },
  {
    "text": "Here's what the filter\ntransfer function looks like. Here's the operator\ndefinition and time domain.",
    "start": "1473480",
    "end": "1478590"
  },
  {
    "text": "Here's what it looks like\nin the frequency domain. What we can see is that at\nlow frequencies, near DC,",
    "start": "1478590",
    "end": "1484610"
  },
  {
    "text": "it has a gain of 1. It passes through the\nlow-frequency content. But this particular\nfilter just happens",
    "start": "1484610",
    "end": "1491540"
  },
  {
    "text": "to have zero amplitudes at\nthe switching frequency, twice the switching frequency,\nthree times, et cetera.",
    "start": "1491540",
    "end": "1497580"
  },
  {
    "text": "So it very precisely keeps\nthe low-frequency stuff and murders all the\nswitching ripple. ",
    "start": "1497580",
    "end": "1505160"
  },
  {
    "text": "Now, could I pick some other\nfilter that captures this idea? Sure. But we just happened\nto pick this one",
    "start": "1505160",
    "end": "1512120"
  },
  {
    "text": "because it's a good one\nfor our purpose, which is to keep the\nlow-frequency content and get rid of the switching\nripple and its harmonics.",
    "start": "1512120",
    "end": "1518669"
  },
  {
    "text": " You'll also notice that\nthe phase of this thing",
    "start": "1518670",
    "end": "1524990"
  },
  {
    "text": "is basically representing-- it's a linear phase\nresponse-- basically, a delay of half a cycle. Why?",
    "start": "1524990",
    "end": "1530420"
  },
  {
    "text": "Because if I'm looking\nnow, I'm really asking,",
    "start": "1530420",
    "end": "1535640"
  },
  {
    "text": "what's my signal over\nthe last capital T? So I'm, on average, looking\nback half a t in duration.",
    "start": "1535640",
    "end": "1543020"
  },
  {
    "text": "If I didn't like that, I\ncould make my local average between t minus T over 2 and t\nplus T over 2, capital T over 2.",
    "start": "1543020",
    "end": "1551120"
  },
  {
    "text": "And then I wouldn't\nhave any delay in it. But I also wouldn't be causal. Now, I'm not saying\nwe're actually going",
    "start": "1551120",
    "end": "1557390"
  },
  {
    "text": "to physically build a filter. But this is an\noperator that lets",
    "start": "1557390",
    "end": "1563570"
  },
  {
    "text": "me think about how I'd process\nmy signals so that I could keep the low-frequency content\nand get rid of the switching",
    "start": "1563570",
    "end": "1570590"
  },
  {
    "text": "ripple. Any questions about that? ",
    "start": "1570590",
    "end": "1581300"
  },
  {
    "text": "So we're going to see how\nto use this kind of filter",
    "start": "1581300",
    "end": "1587030"
  },
  {
    "text": "to do interesting things.  There's a few ways\nwe can use it.",
    "start": "1587030",
    "end": "1596385"
  },
  {
    "text": "And they give similar results. But they're useful.",
    "start": "1596385",
    "end": "1602010"
  },
  {
    "text": "But let me just, lastly,\ntalk about a couple of other properties\nof this operator.",
    "start": "1602010",
    "end": "1610050"
  },
  {
    "text": "And the first that's\na very useful property is the differentiation property. ",
    "start": "1610050",
    "end": "1620970"
  },
  {
    "text": "And this is one of\nthe reasons why we picked this particular filter. If I took some signal dx dt--",
    "start": "1620970",
    "end": "1629700"
  },
  {
    "text": "so some time-varying signal-- I looked at its\nderivative, and I said, give me the local\naverage of the derivative",
    "start": "1629700",
    "end": "1635880"
  },
  {
    "text": "of this signal, It's\npretty easy to show that this is the same as the\nderivative of x bar of t.",
    "start": "1635880",
    "end": "1645900"
  },
  {
    "text": "That is, the derivative\nof the local average is the local average\nof the derivative,",
    "start": "1645900",
    "end": "1651627"
  },
  {
    "text": "or the local average\nof the derivative is the derivative of\nthe local average. Why is that true? Because basically, I'm taking\nthe derivative of this thing.",
    "start": "1651627",
    "end": "1657990"
  },
  {
    "text": "I can interchange the order of\ndifferentiation and integration. I get back the same thing.",
    "start": "1657990",
    "end": "1663490"
  },
  {
    "text": "And this property\nturns out to be a very useful one for modeling,\nas we'll see in a minute. ",
    "start": "1663490",
    "end": "1672720"
  },
  {
    "text": "So how might I use this average\nmodel or average operator?",
    "start": "1672720",
    "end": "1684640"
  },
  {
    "text": "And the way I'd like\nto show you to use it today is on a circuit itself.",
    "start": "1684640",
    "end": "1689670"
  },
  {
    "text": "So suppose I came up and I\ngave you a boost converter and I said, well, gee, could\nI apply that average model",
    "start": "1689670",
    "end": "1696910"
  },
  {
    "text": "to the boost converter\nitself, to the circuit? And let's think about\nwhat that means.",
    "start": "1696910",
    "end": "1704780"
  },
  {
    "text": "If I thought about any circuit,\nwhat defines its topology? What defines its topology?",
    "start": "1704780",
    "end": "1711110"
  },
  {
    "text": "What's connected to what? The structure of it is really\nthe set of KVL and KCL equations",
    "start": "1711110",
    "end": "1717560"
  },
  {
    "text": "that exist for that circuit. So any circuit has some set of\nKVL equations, which essentially",
    "start": "1717560",
    "end": "1729020"
  },
  {
    "text": "are the sum of Vij is equal\nto 0 around a bunch of loops.",
    "start": "1729020",
    "end": "1734613"
  },
  {
    "text": "So there's a whole bunch of\nequations that have this form. ",
    "start": "1734613",
    "end": "1740680"
  },
  {
    "text": "And likewise, there's a set\nof KCL equations, the sum of i",
    "start": "1740680",
    "end": "1746320"
  },
  {
    "text": "sub k's, that are equal to 0. So I could take any circuit and\nwrite down a list of KVL and KCL",
    "start": "1746320",
    "end": "1755690"
  },
  {
    "text": "equations that pertain\nto that circuit, one for every voltage loop,\none for every node.",
    "start": "1755690",
    "end": "1762862"
  },
  {
    "text": "And we can go back and say--\nfigure out which ones of those are independent, and so forth.",
    "start": "1762862",
    "end": "1768409"
  },
  {
    "text": "Well, what happens if\nI came up and said, let me take a KVL or KCL\nequation or, more generally,",
    "start": "1768410",
    "end": "1775970"
  },
  {
    "text": "the ones that\nrepresent my circuit and average those things?",
    "start": "1775970",
    "end": "1782299"
  },
  {
    "text": "Well, all I would do is if I\ntook this and I averaged it--",
    "start": "1782300",
    "end": "1788090"
  },
  {
    "text": "when I say average, I\nmean apply this operator--",
    "start": "1788090",
    "end": "1793730"
  },
  {
    "text": "what would I do? I'd take the local\naverage of each side. The local average of 0 is 0. This is just the local average\nof the sum, which I already",
    "start": "1793730",
    "end": "1803110"
  },
  {
    "text": "said, because of linearity, is\nthe sum of the local averages. So this gives me, if I average\nit, the sum of Vij local average",
    "start": "1803110",
    "end": "1813640"
  },
  {
    "text": "is equal to 0. And this gives me the sum of i\nsub k local average, which is 0.",
    "start": "1813640",
    "end": "1819330"
  },
  {
    "text": " So what I'm really\nsaying here is",
    "start": "1819330",
    "end": "1824400"
  },
  {
    "text": "if I have some circuit like\nmy boost converter up there, I could apply averaging to that\ncircuit or all the KVL and KCL",
    "start": "1824400",
    "end": "1834929"
  },
  {
    "text": "equations. And I could get\nanother circuit that's average that has the\nsame connections in it.",
    "start": "1834930",
    "end": "1842559"
  },
  {
    "text": "Why? Because for every KVL\nequation in this circuit, there's an identical KVL\nequation in this circuit.",
    "start": "1842560",
    "end": "1848050"
  },
  {
    "text": "And it just has\naveraged voltages. And likewise, every\nKCL in this circuit generates a new KCL circuit\njust with averaged currents.",
    "start": "1848050",
    "end": "1856500"
  },
  {
    "text": "So I can get a new circuit\nwith the same topology for which averages pertain. ",
    "start": "1856500",
    "end": "1863920"
  },
  {
    "text": "Why does this work? This is the-- similar\nto what we were saying. Remember, we talked\nabout, well, there's",
    "start": "1863920",
    "end": "1870140"
  },
  {
    "text": "average KVL and average\nKCL over all time from periodic steady state.",
    "start": "1870140",
    "end": "1875899"
  },
  {
    "text": "Well, I can also talk\nabout it over a cycle. If KVL holds\ninstantaneously, then it",
    "start": "1875900",
    "end": "1881040"
  },
  {
    "text": "ought to hold for\nthe local averages. And likewise, if KCL\ninto a circuit node holds instantaneously,\nit ought to hold",
    "start": "1881040",
    "end": "1887669"
  },
  {
    "text": "averaged over the last cycle. So it makes sense that you\nshould be able to do this. And the key point here is\nbecause these equations",
    "start": "1887670",
    "end": "1895740"
  },
  {
    "text": "have the same form\nas these equations, you get the same exact circuit\nback, the same exact circuit",
    "start": "1895740",
    "end": "1901410"
  },
  {
    "text": "topology back. What the elements in\nthat circuit topology do is another question.",
    "start": "1901410",
    "end": "1907140"
  },
  {
    "text": "We haven't said how are\nvoltages and currents of the elements related. All we've said is that the\ncircuit topology stays the same.",
    "start": "1907140",
    "end": "1916770"
  },
  {
    "text": "Any questions about that? ",
    "start": "1916770",
    "end": "1921799"
  },
  {
    "text": "Let's start talking\nabout circuit elements. What do I have in this circuit?",
    "start": "1921800",
    "end": "1928163"
  },
  {
    "text": "If I come back and look\nat my boost converter, I have inductors, capacitors,\nresistors, and then switches and sources and switches.",
    "start": "1928163",
    "end": "1936610"
  },
  {
    "text": "Well, the local\naverage of a source is just the local\naverage of a source.",
    "start": "1936610",
    "end": "1941680"
  },
  {
    "text": "So VIN would become VIN bar. But what about a resistor?",
    "start": "1941680",
    "end": "1946900"
  },
  {
    "text": "What about my load resistor? Well, if I took\nmy load resistor, what I really have is V--",
    "start": "1946900",
    "end": "1955270"
  },
  {
    "text": "I have i sub R and V sub R.\nAnd what I get is V sub R",
    "start": "1955270",
    "end": "1963130"
  },
  {
    "text": "is equal to i sub R times R. Well, what happens if I take\nthe local average of that guy?",
    "start": "1963130",
    "end": "1972350"
  },
  {
    "text": "I'm just going to take the\nlocal average of this equation. So I'll come over here. And I'll average the left.",
    "start": "1972350",
    "end": "1978050"
  },
  {
    "text": "And I'll average the right. And I can pull R\nout of the equation. So then my average element\nought to just be this.",
    "start": "1978050",
    "end": "1986630"
  },
  {
    "text": "I have V sub R bar,\ni sub R bar, and R",
    "start": "1986630",
    "end": "1992870"
  },
  {
    "text": "because my\nrelationship is simply V sub R bar is equal to i\nsub R bar R, which is exactly",
    "start": "1992870",
    "end": "2000789"
  },
  {
    "text": "the relation of a resistor. So that just says if I had a\nresistor in my original circuit",
    "start": "2000790",
    "end": "2007260"
  },
  {
    "text": "and I look at the local average\nof the constitutive relation of the two things connecting\nthe nodes, if it's a resistor,",
    "start": "2007260",
    "end": "2014220"
  },
  {
    "text": "it just stays being a resistor. That make sense?",
    "start": "2014220",
    "end": "2019539"
  },
  {
    "text": "Well, what happens if\nI have an inductor?  I have V sub L, i sub\nL. And the relationship",
    "start": "2019540",
    "end": "2029320"
  },
  {
    "text": "is V sub L is equal\nto L di sub L dt. Well, if I average\nthis guy, I'm going",
    "start": "2029320",
    "end": "2038740"
  },
  {
    "text": "to take the local average here\nand the local average here. This shouldn't have\nbeen a local average.",
    "start": "2038740",
    "end": "2044370"
  },
  {
    "text": "And this would give me what? Well, the relationship\nis V sub L bar.",
    "start": "2044370",
    "end": "2050320"
  },
  {
    "text": "Now, I can pull the L\nout because of linearity. And the local average\nof the derivative",
    "start": "2050320",
    "end": "2055899"
  },
  {
    "text": "becomes the derivative\nof the local average. I said that was my\nproperty over here. And what I get is then-- is\nequal to L d dt of iL bar, which",
    "start": "2055900",
    "end": "2066310"
  },
  {
    "text": "is just an inductor of value\nL. Does that make sense?",
    "start": "2066310",
    "end": "2076020"
  },
  {
    "text": "I could do the same\nthing with a capacitor. So the beautiful\nthing here is if I",
    "start": "2076020",
    "end": "2082780"
  },
  {
    "text": "go to average my circuit,\nthe resistors, inductors, capacitors, sources just\nbecome the local averages",
    "start": "2082780",
    "end": "2091340"
  },
  {
    "text": "of themselves.  Well, that's nice because\nwhat I'm suggesting",
    "start": "2091340",
    "end": "2099420"
  },
  {
    "text": "is I can come to this circuit\nand take its local average and come up with a new circuit\nthat does the same thing,",
    "start": "2099420",
    "end": "2105180"
  },
  {
    "text": "but without switching ripple. That make sense to everybody?",
    "start": "2105180",
    "end": "2111680"
  },
  {
    "text": "Let me see how I\nwould do this here. ",
    "start": "2111680",
    "end": "2119980"
  },
  {
    "text": "But in order to do it,\nwhat I haven't said is what happens to the switches.",
    "start": "2119980",
    "end": "2125720"
  },
  {
    "text": "And that's a little\ntrickier to think about. ",
    "start": "2125720",
    "end": "2134130"
  },
  {
    "text": "To do that, let me make\nsomething that's a little bit circuit model-friendly.",
    "start": "2134130",
    "end": "2139910"
  },
  {
    "text": "So let me come up with a\ndifferent model for my boost converter. My boost converter had an\ninput voltage, an inductor,",
    "start": "2139910",
    "end": "2150510"
  },
  {
    "text": "L of that with a current iL. And then it had a capacitor,\nC, and a resistor, R,",
    "start": "2150510",
    "end": "2161050"
  },
  {
    "text": "with an output\nvoltage VOUT on it. And then it had the\nswitch in the diode.",
    "start": "2161050",
    "end": "2168825"
  },
  {
    "text": " And I could represent everything\nwith the switch in the diode.",
    "start": "2168825",
    "end": "2174520"
  },
  {
    "text": "But maybe it would be easier\nfrom a modeling perspective if I just came back and\nmodeled the switch in diode",
    "start": "2174520",
    "end": "2180580"
  },
  {
    "text": "with equivalent\ndependent sources. And here's how I'm\ngoing to argue-- and let me-- there's a couple\nof ways I could do this.",
    "start": "2180580",
    "end": "2187785"
  },
  {
    "text": " Maybe the switch--",
    "start": "2187785",
    "end": "2192990"
  },
  {
    "text": "I have to worry about\nwhat's the voltage, Vx, here and the current,\nix, at this node.",
    "start": "2192990",
    "end": "2200260"
  },
  {
    "text": "Maybe this is Vx and this is ix. ",
    "start": "2200260",
    "end": "2205530"
  },
  {
    "text": "Maybe I would model this as\na dependent voltage source.",
    "start": "2205530",
    "end": "2212400"
  },
  {
    "text": "So what would this\nvoltage source be? I could write this voltage\nsource, dependent source,",
    "start": "2212400",
    "end": "2219840"
  },
  {
    "text": "as being 1 minus q times\nVOUT because notice",
    "start": "2219840",
    "end": "2228950"
  },
  {
    "text": "this voltage, Vx, pulsates. When the switch is on,\nwhen q is high, it's 0.",
    "start": "2228950",
    "end": "2234320"
  },
  {
    "text": "And when switch is off,\nit's equal to VOUT. So in continuous\nconduction mode, this is a perfectly\nlegitimate representation",
    "start": "2234320",
    "end": "2241900"
  },
  {
    "text": "of what the voltage\nis doing there. So I'm replacing the\nswitch with something that generates the same\nvoltage, Vx, as the switch does.",
    "start": "2241900",
    "end": "2251740"
  },
  {
    "text": "I'm going to replace\nthe current diode with a dependent current\nsource that equals id.",
    "start": "2251740",
    "end": "2259960"
  },
  {
    "text": "And that would be\n1 minus q times iL.",
    "start": "2259960",
    "end": "2265330"
  },
  {
    "text": "When the switch is\non, this current is 0 because the diode is off. When the switch is off, this\ndependent current source",
    "start": "2265330",
    "end": "2272500"
  },
  {
    "text": "is equal to iL. So I've got one\ndependent voltage source and one dependent\ncurrent source, which",
    "start": "2272500",
    "end": "2279340"
  },
  {
    "text": "impose the same\nconstraints as what's happening at this node as\nthe original switch in diode.",
    "start": "2279340",
    "end": "2287079"
  },
  {
    "text": "Any questions about that?  Yeah, Laurie?",
    "start": "2287080",
    "end": "2293096"
  },
  {
    "text": "STUDENT: So [INAUDIBLE] is\nyour choice [INAUDIBLE]?",
    "start": "2293096",
    "end": "2299010"
  },
  {
    "text": "DAVID PERREAULT: No. In fact, I could\nhave modeled this with a dependent\ncurrent source and that",
    "start": "2299010",
    "end": "2304100"
  },
  {
    "text": "with a dependent voltage source. It would have been totally fine. It would have done\nthe same thing. There's a lot of\nways I could do this.",
    "start": "2304100",
    "end": "2311390"
  },
  {
    "text": "And in fact, I don't\neven have to do it. I could operate everything I was\ngoing to say with the switches.",
    "start": "2311390",
    "end": "2318000"
  },
  {
    "text": "But really, what\nI'm interested in is, how does the\nswitch in the diode control the waveforms\nin the circuit",
    "start": "2318000",
    "end": "2324050"
  },
  {
    "text": "and cause currents to be fed\nto the capacitor and voltages to be fed to the inductor?",
    "start": "2324050",
    "end": "2329400"
  },
  {
    "text": "And this is just a\nsimpler way to get it. Does that make\nsense to everybody?",
    "start": "2329400",
    "end": "2336095"
  },
  {
    "text": "So this is still a\nswitching circuit. In fact, if I simulated this\ncircuit and I knew q of t",
    "start": "2336095",
    "end": "2343250"
  },
  {
    "text": "from some-- I ran a controller\nand I had some q of t, I could simulate this.",
    "start": "2343250",
    "end": "2348530"
  },
  {
    "text": "And it would generate exactly\nthis switching waveform. If I told you q of\nt and then q of t",
    "start": "2348530",
    "end": "2356180"
  },
  {
    "text": "is the constant duty\nratio here and I simulated this circuit with that q of t,\nI would-- and I changed the load",
    "start": "2356180",
    "end": "2363560"
  },
  {
    "text": "resistance, I would get\nexactly that response. So as long as I'm in\ncontinuous conduction mode,",
    "start": "2363560",
    "end": "2370070"
  },
  {
    "text": "this model represents\nthat circuit. But I want to get\nrid of the switching.",
    "start": "2370070",
    "end": "2377510"
  },
  {
    "text": "So let me just go\naverage this circuit. I'm going to apply that\noperator to that circuit.",
    "start": "2377510",
    "end": "2383470"
  },
  {
    "text": "And what do I know? Well, I know that if I apply\nthe operator to the circuit, the topology of the new\ncircuit doesn't change.",
    "start": "2383470",
    "end": "2391790"
  },
  {
    "text": "Why? Because when I\napply averaging, I get the same set of\nKVL and KCL equations.",
    "start": "2391790",
    "end": "2398200"
  },
  {
    "text": "So the topology\nought to be the same. And what that means is I\ncan take the same circuit.",
    "start": "2398200",
    "end": "2404529"
  },
  {
    "text": "And I can just replace VIN\nby VIN bar, iL by iL bar,",
    "start": "2404530",
    "end": "2411070"
  },
  {
    "text": "VOUT by VOUT bar. And L, C, and R\nall stay the same because I've told\nyou what happens",
    "start": "2411070",
    "end": "2417580"
  },
  {
    "text": "to the I-V characteristics\nof my linear time-invariant",
    "start": "2417580",
    "end": "2423720"
  },
  {
    "text": "components. The only thing I haven't\nsaid what happens is to these two components\nI've drawn in pink.",
    "start": "2423720",
    "end": "2431920"
  },
  {
    "text": "And so what I really have to\ndo is take the local average of the product of VOUT and\nthe switching waveform and iL",
    "start": "2431920",
    "end": "2441240"
  },
  {
    "text": "and the switching waveform. And that's ugly\nbecause now I have",
    "start": "2441240",
    "end": "2446580"
  },
  {
    "text": "the local average of a product. And I've got to go think\nabout that a little bit.",
    "start": "2446580",
    "end": "2453000"
  },
  {
    "text": "Now, let me tell you something\nabout the local average of products.",
    "start": "2453000",
    "end": "2458640"
  },
  {
    "text": "One property that this operator\ndoesn't have, in general, is that typically, if\nI have x of t y of t",
    "start": "2458640",
    "end": "2471600"
  },
  {
    "text": "and I take the local average\nof that, in general, it's not",
    "start": "2471600",
    "end": "2480840"
  },
  {
    "text": "equal to x bar of t y bar of t.",
    "start": "2480840",
    "end": "2485850"
  },
  {
    "text": "You can't just\narbitrarily do that. How can I prove it to you?",
    "start": "2485850",
    "end": "2492240"
  },
  {
    "text": "Suppose I had two signals\nthat were like this.",
    "start": "2492240",
    "end": "2498400"
  },
  {
    "text": "Here's x of t. ",
    "start": "2498400",
    "end": "2505839"
  },
  {
    "text": "Suppose x of t is just a\n50% duty ratio square wave like this. Here's 0.5t.",
    "start": "2505840",
    "end": "2511690"
  },
  {
    "text": "Here's t. This is x of t. What is x bar of\nt for that signal?",
    "start": "2511690",
    "end": "2520809"
  },
  {
    "text": "And suppose this goes on\nforever and this is of height 1.",
    "start": "2520810",
    "end": "2525907"
  },
  {
    "text": "It's just going to be 1/2. At any given time, if I\nslide a window over this and I take the\naverage, I've always",
    "start": "2525907",
    "end": "2531580"
  },
  {
    "text": "got it high half the time. So x bar of t is\njust equal to 0.5.",
    "start": "2531580",
    "end": "2540470"
  },
  {
    "text": "Well, what happens if I made\nits complement, y bar of t? ",
    "start": "2540470",
    "end": "2550119"
  },
  {
    "text": "I'm sorry, here's y of t. y of t is exactly the\ncomplement of x of t.",
    "start": "2550120",
    "end": "2555920"
  },
  {
    "text": "So what I would argue is that y\nbar of t is also equal to 0.5.",
    "start": "2555920",
    "end": "2564375"
  },
  {
    "text": "It's just-- happens\nto be out of phase.  Well, what's x of t y of t?",
    "start": "2564375",
    "end": "2570730"
  },
  {
    "start": "2570730",
    "end": "2576440"
  },
  {
    "text": "I think I heard somebody\nsay that it's 0. One of them is 0 all the time. And that's \"zip.\"",
    "start": "2576440",
    "end": "2583160"
  },
  {
    "text": "So if I took the local\naverage of x bar-- if I took the local\naverage of x times y,",
    "start": "2583160",
    "end": "2590120"
  },
  {
    "text": "that would have\nto be equal to 0. But if I took x bar y bar, that\nwould actually be equal to 0.25.",
    "start": "2590120",
    "end": "2600420"
  },
  {
    "text": "So that's proof that in\ngeneral, I can't just take the local\naverage of the product",
    "start": "2600420",
    "end": "2606110"
  },
  {
    "text": "and expect it to be the\nproduct of the local averages. That just doesn't\nwork, generally.",
    "start": "2606110",
    "end": "2612280"
  },
  {
    "text": "And I care because I\nhave this local average of a product over here. But imagine the\nreason this failed",
    "start": "2612280",
    "end": "2622240"
  },
  {
    "text": "was because when y was high,\nx was low, and vice versa. They were both\ndoing crazy stuff.",
    "start": "2622240",
    "end": "2629750"
  },
  {
    "text": "What happens if, perhaps,\none of x of t and y of t look like a constant,\nroughly speaking?",
    "start": "2629750",
    "end": "2637760"
  },
  {
    "text": "And what do I mean by constant? I mean that it has\ntwo properties. If x or y has, one,\na small ripple--",
    "start": "2637760",
    "end": "2649690"
  },
  {
    "text": " in other words, it's not varying\nfull-scale within the cycle--",
    "start": "2649690",
    "end": "2658310"
  },
  {
    "text": "and, two, slow variation,\nmeaning it's not one thing",
    "start": "2658310",
    "end": "2666140"
  },
  {
    "text": "in one cycle and jumping to some\nmassive thing in another cycle, massively different in\nanother cycle, it's just-- the two waveforms just--",
    "start": "2666140",
    "end": "2673850"
  },
  {
    "text": "one of the two\njust-- it may move, but it only moves a little bit-- ",
    "start": "2673850",
    "end": "2680312"
  },
  {
    "text": "then I can think within any\ngiven interval, one of those two",
    "start": "2680312",
    "end": "2686870"
  },
  {
    "text": "is constant and\nthen like linearity. Then I can just take the\nproduct of the local averages.",
    "start": "2686870",
    "end": "2693859"
  },
  {
    "text": "So in this case,\nI can have xy bar is approximately\nequal to x bar y bar.",
    "start": "2693860",
    "end": "2700590"
  },
  {
    "text": "So the only reason\nthis failed is because they're both flapping\nup and down in counterpoint.",
    "start": "2700590",
    "end": "2705900"
  },
  {
    "text": "If only one of them is\nflapping up and down and the other is constant,\nat least constant-- not changing that much in\na given capital T interval,",
    "start": "2705900",
    "end": "2715430"
  },
  {
    "text": "I could make that approximation. Does that make\nsense to everybody?",
    "start": "2715430",
    "end": "2721855"
  },
  {
    "text": "So this might be true of\nif x or y is an inductor",
    "start": "2721855",
    "end": "2728470"
  },
  {
    "text": "current or a capacitor voltage. We know that even in that\nexample I was showing you, yeah,",
    "start": "2728470",
    "end": "2735437"
  },
  {
    "text": "there's some ripple. But it's on top of\na big DC offset.",
    "start": "2735437",
    "end": "2741040"
  },
  {
    "text": "It's not really violating\nthat approximation very much. So here, maybe I could\nsay that 1 minus q--",
    "start": "2741040",
    "end": "2752530"
  },
  {
    "text": "the product of 1\nminus q times VOUT is approximately equal to\n1 minus q times VOUT bar",
    "start": "2752530",
    "end": "2762790"
  },
  {
    "text": "and 1 minus q times iL is\napproximately equal to 1",
    "start": "2762790",
    "end": "2768910"
  },
  {
    "text": "minus q bar times iL bar. ",
    "start": "2768910",
    "end": "2775329"
  },
  {
    "text": "Let me define d as being\nequal to q bar of t.",
    "start": "2775330",
    "end": "2781765"
  },
  {
    "text": " In any given cycle,\nif I'm assuming",
    "start": "2781765",
    "end": "2787900"
  },
  {
    "text": "my duty ratio is\nchanging slowly, it's about equal to the\nlocal average of q of t because that's what my PWM\nmodulator over there was doing.",
    "start": "2787900",
    "end": "2795579"
  },
  {
    "text": "It was giving me a duty ratio. Now, this is precisely only true\nwhen I'm looking at capital T.",
    "start": "2795580",
    "end": "2802480"
  },
  {
    "text": "And I look back. And I get d for that\ncycle is exactly here if I did my local\naverage right here.",
    "start": "2802480",
    "end": "2808100"
  },
  {
    "text": "But if d of t is\nchanging only slowly, that's a pretty good model\nto within half a cycle.",
    "start": "2808100",
    "end": "2815740"
  },
  {
    "text": "So then I could replace this. I could say 1 minus q is equal\nto 1 minus d times VOUT bar.",
    "start": "2815740",
    "end": "2827710"
  },
  {
    "text": "And this is equal to 1\nminus d times iL bar. And I can average this circuit.",
    "start": "2827710",
    "end": "2834260"
  },
  {
    "text": "And what I'm going\nto get is this. VIN bar iL bar--",
    "start": "2834260",
    "end": "2843760"
  },
  {
    "text": "this becomes a source 1\nminus d times VOUT bar.",
    "start": "2843760",
    "end": "2851500"
  },
  {
    "text": "And this becomes 1 minus d\ntimes iL bar CR VOUT bar.",
    "start": "2851500",
    "end": "2864310"
  },
  {
    "text": "This circuit has no switching. d is a continuously\nvarying variable",
    "start": "2864310",
    "end": "2871660"
  },
  {
    "text": "that my controller\nmight generate. There's no switching\nleft in this circuit.",
    "start": "2871660",
    "end": "2876970"
  },
  {
    "text": "It does vary in time. It's a dynamic circuit. It has an L and a C. And\nif d changes over time,",
    "start": "2876970",
    "end": "2882293"
  },
  {
    "text": "the voltages and currents\nin this will change. But I've killed the\nswitching ripple, essentially applying my local\naverage operator to the circuit.",
    "start": "2882293",
    "end": "2891090"
  },
  {
    "start": "2891090",
    "end": "2896110"
  },
  {
    "text": "That make sense to everybody? Let's take a look at what\nhappens if I do that.",
    "start": "2896110",
    "end": "2901840"
  },
  {
    "text": "This is a simulation\nof this exact circuit",
    "start": "2901840",
    "end": "2909480"
  },
  {
    "text": "for the same transient, except\nthat I'm simulating this thing. It's in that little box\nthat says \"average model.\"",
    "start": "2909480",
    "end": "2918390"
  },
  {
    "text": "There is a diode there. That diode is just\nproviding a constant drop because keep in mind my\napproximate models didn't really",
    "start": "2918390",
    "end": "2925080"
  },
  {
    "text": "include constant diode\ndrops or anything like that. So that diode there is\nnot doing any switching.",
    "start": "2925080",
    "end": "2930310"
  },
  {
    "text": "It's providing a\nconstant DC offset. But this is the transient\nyou get when you change the resistance in that circuit.",
    "start": "2930310",
    "end": "2937500"
  },
  {
    "text": "Here's the voltage. And here's the current. It's right up the middle.",
    "start": "2937500",
    "end": "2943380"
  },
  {
    "text": "So basically, I've got a circuit\nthat has second-order response. And it tracks the average\nvalues of my waveforms--",
    "start": "2943380",
    "end": "2952500"
  },
  {
    "text": "gotten rid of the switching. So this circuit could be--",
    "start": "2952500",
    "end": "2961420"
  },
  {
    "text": "it's not in a controller form. But it's a circuit that\ntracks this whole thing",
    "start": "2961420",
    "end": "2966910"
  },
  {
    "text": "without any switching.  Questions about that? ",
    "start": "2966910",
    "end": "2976940"
  },
  {
    "text": "Now, we're going to\ntake this up next class. But I wanted to show you\nthe basis for doing this.",
    "start": "2976940",
    "end": "2989670"
  },
  {
    "text": "I want to say this is\nreally useful for building control models for\nconverters because now I",
    "start": "2989670",
    "end": "2994725"
  },
  {
    "text": "have something that-- I've gotten rid of all the\ncomplicated switching stuff. But it still gives me the\nlow-frequency dynamics",
    "start": "2994725",
    "end": "3001750"
  },
  {
    "text": "that I want to deal\nwith my controller. I will warn you that\nthis system is nonlinear.",
    "start": "3001750",
    "end": "3009430"
  },
  {
    "text": "Why? Because you notice d is\nmy control variable here. And it multiplies\nthe output voltage.",
    "start": "3009430",
    "end": "3016900"
  },
  {
    "text": "And it multiplies\nthe inductor current. So I have a product of my\ncontrol input and my state variables. This is not a linear\nsystem from-- in terms",
    "start": "3016900",
    "end": "3024100"
  },
  {
    "text": "of going from duty\nratio to output. So I still have nonlinearity\nI have to deal with.",
    "start": "3024100",
    "end": "3029660"
  },
  {
    "text": "And that's just life. We'll talk about how\nto deal with that.",
    "start": "3029660",
    "end": "3034819"
  },
  {
    "text": "It's very good for doing\nlow-frequency controller modeling.",
    "start": "3034820",
    "end": "3040109"
  },
  {
    "text": "It's not useful\nfor other things. So for example, if I asked you\nto calculate power dissipation",
    "start": "3040110",
    "end": "3046790"
  },
  {
    "text": "of components, you\ncannot use this model. Why? Because what would the power\ndissipation in the switch be?",
    "start": "3046790",
    "end": "3053260"
  },
  {
    "text": "The power dissipation\nof the switch would be the switch\nvoltage times the switch current, both of which are\npulsing up and down together.",
    "start": "3053260",
    "end": "3059950"
  },
  {
    "text": "It violates this assumption\nI was talking about. In fact, the voltage and\ncurrent on the switch",
    "start": "3059950",
    "end": "3065789"
  },
  {
    "text": "actually look a lot like that. So I can use this average\nmodel to do things like control dynamics.",
    "start": "3065790",
    "end": "3071640"
  },
  {
    "text": "That's perfect for it. I can't use it to\nanswer questions like dissipation or\nother kinds of things.",
    "start": "3071640",
    "end": "3078930"
  },
  {
    "text": "So I am well out of time today. But we will take up the notion\nof control modeling next class.",
    "start": "3078930",
    "end": "3085440"
  },
  {
    "text": "Have a great day. ",
    "start": "3085440",
    "end": "3092000"
  }
]