[
  {
    "text": " GERBRAND CEDER: --temperature\nfinite temperature methods of which you did molecular\ndynamics earlier with Professor",
    "start": "0",
    "end": "6760"
  },
  {
    "text": "Marzari. So what we're going\nto do is sort of continue that for a bit, showing\nyou Monte Carlo simulations",
    "start": "6760",
    "end": "15070"
  },
  {
    "text": "and how you can\nessentially use it. And after that is kind of a\nseries of fairly random topics.",
    "start": "15070",
    "end": "20200"
  },
  {
    "text": " In some cases, clearly we\ndon't even know what they are.",
    "start": "20200",
    "end": "26921"
  },
  {
    "text": "Even when it says case\nstudy, that really means that the instructors don't\nhave a clue yet what they're going to be teaching about.",
    "start": "26922",
    "end": "35050"
  },
  {
    "text": "Somebody's listening in I think. OK. So I want to have a bit of a\ndiscussion on how you calculate",
    "start": "35050",
    "end": "45160"
  },
  {
    "text": "certain properties. This is a good way\nto see the difference between molecular dynamic\nsimulation and Monte Carlo.",
    "start": "45160",
    "end": "52720"
  },
  {
    "text": "So in a molecular\ndynamic simulation, one way you calculate\ncertain properties",
    "start": "52720",
    "end": "58450"
  },
  {
    "text": "is by tracking them over time. So if you can calculate\na certain property",
    "start": "58450",
    "end": "63880"
  },
  {
    "text": "for a given microscopic state,\nfor a given configuration, say the energy--",
    "start": "63880",
    "end": "70330"
  },
  {
    "text": "let's take some simple ones-- or the volume, you calculate\ntheir macroscopic averages,",
    "start": "70330",
    "end": "75920"
  },
  {
    "text": "which are their thermodynamic\nqualities, really as an integral over time.",
    "start": "75920",
    "end": "83359"
  },
  {
    "text": "So there's sort of\ntwo issues with that, that obviously in that average\nyou will only include states",
    "start": "83360",
    "end": "91900"
  },
  {
    "text": "that you can reach with the\nmolecular dynamic simulation. And so since you simulate\nover a finite time,",
    "start": "91900",
    "end": "97659"
  },
  {
    "text": "if there are\nexcitations, say, which can determine the average\nenergy in reality that",
    "start": "97660",
    "end": "103600"
  },
  {
    "text": "occur over a longer\ntimescale, you will not sample them\nin that average. The second thing is that\nif all you care about",
    "start": "103600",
    "end": "112880"
  },
  {
    "text": "are the average properties\nbut not the dynamics of how you go between them,\nthen sometimes you",
    "start": "112880",
    "end": "119150"
  },
  {
    "text": "can do simpler techniques\nthan molecular dynamics, or things that are less\ncomputing intensive.",
    "start": "119150",
    "end": "124580"
  },
  {
    "text": "You can literally just go\nand sample those averages. And so that's\nbasically what we're going to talk about this\nlecture and the next lecture,",
    "start": "124580",
    "end": "130610"
  },
  {
    "text": "talk about how you\ndo that sampling. So if you only care about the\naverages but not the dynamics",
    "start": "130610",
    "end": "136580"
  },
  {
    "text": "itself. You'll see that for\nsome models of materials you'll actually need\nto do that, because you",
    "start": "136580",
    "end": "142670"
  },
  {
    "text": "won't know the dynamics. Remember that in\nmolecular dynamics you basically assume that\nthe atoms move with Newton's",
    "start": "142670",
    "end": "149240"
  },
  {
    "text": "equation of motion. So you know the dynamic. There will be certain\nmodels for which you have",
    "start": "149240",
    "end": "154550"
  },
  {
    "text": "no idea about the dynamics. I'll give you an example,\nthe study an Ising model, which is a spin model of\nmagnetic moments sort of being",
    "start": "154550",
    "end": "163909"
  },
  {
    "text": "oriented in space. In many case you don't\nknow the spin dynamics. It's a fairly\ncomplicated problem.",
    "start": "163910",
    "end": "169769"
  },
  {
    "text": "So if all you want to know is\nthe average magnetic moment, there's no way of doing\ndynamics on the spin. You'll actually\nhave to sample them.",
    "start": "169770",
    "end": "176270"
  },
  {
    "text": " So I want to give you one\nquick example of a time scale",
    "start": "176270",
    "end": "184360"
  },
  {
    "text": "problem, because\nI'm going to use this example throughout\nthe lecture to illustrate",
    "start": "184360",
    "end": "190510"
  },
  {
    "text": "how we use Monte Carlo. Here's a binary mixture,\nsort of green and blue atoms.",
    "start": "190510",
    "end": "199239"
  },
  {
    "text": "You may want to know the\naverage energy of that system. So in any given\nconfiguration, let's",
    "start": "199240",
    "end": "204940"
  },
  {
    "text": "say you have an energy\nmethod to calculate the energy of that system. So at high temperature\nthe atoms will simply",
    "start": "204940",
    "end": "214120"
  },
  {
    "text": "sort of hop around and give\nyou some average energy. So I want to give you an\nidea of what you need--",
    "start": "214120",
    "end": "219340"
  },
  {
    "text": "do you mind passing around-- Thank you. Thank you, [INAUDIBLE]---- of\nwhat kind of timescale you need",
    "start": "219340",
    "end": "226629"
  },
  {
    "text": "to get that average right. Thanks. ",
    "start": "226630",
    "end": "232880"
  },
  {
    "text": "And you saw, from Professor\nMarzari's last lecture, the relation between\nthe diffusion constant and the root\nmean square displacement.",
    "start": "232880",
    "end": "240380"
  },
  {
    "text": "Essentially, the root mean\nsquare displacement scales",
    "start": "240380",
    "end": "246350"
  },
  {
    "text": "linear with the\ndiffusion constant, where d is the dimensionality\nof the system-- so in this case 2--",
    "start": "246350",
    "end": "252230"
  },
  {
    "text": "and so D is the\ndiffusion constant. ",
    "start": "252230",
    "end": "261220"
  },
  {
    "text": "OK. To get an idea of the kind\nof hopping rate you need,",
    "start": "261220",
    "end": "267610"
  },
  {
    "text": "you can assume for a second\nthat the atoms do a random walk. If you do a random\nwalk, then the root",
    "start": "267610",
    "end": "273550"
  },
  {
    "text": "mean square\ndisplacement you take is the number of\njumps you take-- N times the jump\ndistance squared.",
    "start": "273550",
    "end": "281260"
  },
  {
    "text": "You may remember that\nfor a random walk. So that means that\nnow we know we",
    "start": "281260",
    "end": "287199"
  },
  {
    "text": "can relate the jump rate, the\nN dt to the diffusion constant.",
    "start": "287200",
    "end": "293110"
  },
  {
    "text": "And I'll call the N dt, which\nis the jump rate, gamma. So if you know how long\nyour simulation can last,",
    "start": "293110",
    "end": "303900"
  },
  {
    "text": "you sort of know what\njump you need to see atoms jump in that simulation. So you can relate that to--",
    "start": "303900",
    "end": "310050"
  },
  {
    "text": "excuse me-- the\ndiffusivity you need. And let me sort of do\nthat on the next page. ",
    "start": "310050",
    "end": "322260"
  },
  {
    "text": "OK.  We know that the jump rate\nis some vibrational frequency",
    "start": "322260",
    "end": "332160"
  },
  {
    "text": "times a success factor. When atoms have to\njump over a barrier,",
    "start": "332160",
    "end": "338106"
  },
  {
    "text": "if Ea is the activation\nbarrier, we essentially assume that they attempt with\nsome vibrational frequency,",
    "start": "338106",
    "end": "345660"
  },
  {
    "text": "which is, you could say, the\nfrequency with which they sort of try to go up the\nhill times the success rate.",
    "start": "345660",
    "end": "350680"
  },
  {
    "text": "And the success rate is\nthat Boltzmann factor, the exponential\nminus Ea over kT.",
    "start": "350680",
    "end": "356130"
  },
  {
    "text": "If you assume that the\nvibrational frequencies of the order of 10 to the\n13 Hertz, which typically we",
    "start": "356130",
    "end": "362190"
  },
  {
    "text": "are, anywhere from 10\nto 12, 10 to the 14, let's say you want to get a\njump rate of 10 to the 10 hertz.",
    "start": "362190",
    "end": "368340"
  },
  {
    "text": "Why would we want\n10 to the 10 12? So 10 to the 10, that's one\njump or 100 picoseconds.",
    "start": "368340",
    "end": "374280"
  },
  {
    "text": "Is that right? Yeah. 0.1 jump for 0.1 nanoseconds. So if you did a\n10-nanosecond simulation,",
    "start": "374280",
    "end": "381000"
  },
  {
    "text": "you'd have about\n100 jumps per atom. Which would be reasonable\nfor some equilibration,",
    "start": "381000",
    "end": "386310"
  },
  {
    "text": "but in many cases\nstill not enough. OK. This is sort of a reasonable\njump rate to expect.",
    "start": "386310",
    "end": "392340"
  },
  {
    "text": "That means that your success\nrate, your Boltzmann factor, has to be greater than\n10 to the minus 3. So 1 out of 1,000 times the atom\nhas to jump across the barrier.",
    "start": "392340",
    "end": "401070"
  },
  {
    "text": "So you can deduce from that what\nthe activation energy should be. Essentially, the\nactivation energy should be about less than 7 kT.",
    "start": "401070",
    "end": "408810"
  },
  {
    "text": "And then you'll see\njumps of the order of once per 100 picoseconds. And just to put these\nnumbers in your head,",
    "start": "408810",
    "end": "416830"
  },
  {
    "text": "because they're sort of\nimportant to remember, at 300 k, 7 kT is 180\nmillielectronvolt--",
    "start": "416830",
    "end": "424229"
  },
  {
    "text": "that's a low barrier. If you simulate\nat 1,000 degrees, you can do much higher barriers.",
    "start": "424230",
    "end": "430289"
  },
  {
    "text": "Now, 7 kT is about\n600 millielectronvolt. Now you're starting to be in\nthe range of typical to low",
    "start": "430290",
    "end": "438270"
  },
  {
    "text": "barriers in solids. Of course, in\nliquids you'll have much, much faster transport.",
    "start": "438270",
    "end": "443940"
  },
  {
    "text": "So in liquids you'll\nhave no problem. If you do the liquid\nat 1,000 degrees, you'll have a tremendous\namount of hopping.",
    "start": "443940",
    "end": "450570"
  },
  {
    "text": "Solid barriers are anywhere\ntypically from 0.5 to 2 electronvolt. So to put--",
    "start": "450570",
    "end": "457020"
  },
  {
    "text": "it's kind of important, I think,\nthat you kind of get an idea of these scales that you need.",
    "start": "457020",
    "end": "463150"
  },
  {
    "text": "And so, like I said\nin the beginning, if the average is\nall you care about,",
    "start": "463150",
    "end": "471090"
  },
  {
    "text": "it may be better to simply\ndo a sampling technique. And that's essentially\nwhat Monte Carlo is.",
    "start": "471090",
    "end": "476220"
  },
  {
    "text": "Monte Carlo is often mistaken\nfor another form of dynamics,",
    "start": "476220",
    "end": "481350"
  },
  {
    "text": "but it is really nothing\nmore than a sampling method. So now remember\nwhat the issue is.",
    "start": "481350",
    "end": "488130"
  },
  {
    "text": "So if you want to get a sample-- this is in any\nstatistical methods-- there are two things\nyou have to decide,",
    "start": "488130",
    "end": "495240"
  },
  {
    "text": "which population\nyou sample from-- how do you set constraints\non the population of states",
    "start": "495240",
    "end": "501060"
  },
  {
    "text": "that you sample from-- and with what probability\ndo you sample them,",
    "start": "501060",
    "end": "506790"
  },
  {
    "text": "or should you sample them\nunbiased for example. So there are two issues\nthat always come up with sampling, the\nprobability or the rate",
    "start": "506790",
    "end": "513690"
  },
  {
    "text": "with which you sample a\nparticular state and the group of states, the constraints\non the states, over which you",
    "start": "513690",
    "end": "519630"
  },
  {
    "text": "sample. So before I get\ninto that, I want",
    "start": "519630",
    "end": "527520"
  },
  {
    "text": "to briefly review the\nstatistical mechanics and thermodynamics\naltogether in 15 minutes. And I know a lot of\nyou have seen that.",
    "start": "527520",
    "end": "533910"
  },
  {
    "text": "Some of you have not\nseen that so much. I sort of want to try to\nput us all on the same page.",
    "start": "533910",
    "end": "540000"
  },
  {
    "text": "You know, I find when I\nsee Monte Carlo simulation that people do, the biggest\nmistake people always",
    "start": "540000",
    "end": "545160"
  },
  {
    "text": "make is at the\noutset it has nothing to do with the technical\nimplications of Monte Carlo, it's defining the\nboundary conditions,",
    "start": "545160",
    "end": "551290"
  },
  {
    "text": "which is essentially defining\nthe constraints on the states you sample. Those constraints come from\nthe thermodynamic boundary",
    "start": "551290",
    "end": "557820"
  },
  {
    "text": "conditions you impose\non your system. I have sometimes\nreally funny stories.",
    "start": "557820",
    "end": "564870"
  },
  {
    "text": "I've seen discussions at\nmeetings where people argue strongly back and\nforth about problems,",
    "start": "564870",
    "end": "571920"
  },
  {
    "text": "and all it is a misdefining of\ntheir thermodynamic boundary conditions. About two years ago,\nI was at a meeting",
    "start": "571920",
    "end": "577830"
  },
  {
    "text": "where people had enormous\ndiscussions about where hydrogen sits on palladium. Palladium is a pretty\ngood hydrogen absorber,",
    "start": "577830",
    "end": "584700"
  },
  {
    "text": "and people would\nargue back and forth. It sits on the surface-- and somebody says, no, it's at\nsubsurface, layer subsurface.",
    "start": "584700",
    "end": "591660"
  },
  {
    "text": "All that is-- it\nactually can sit both, it's just a matter\nof thermodynamics. If your hydrogen chemical\npotential, your external field,",
    "start": "591660",
    "end": "598650"
  },
  {
    "text": "is high enough, it\nsits everywhere. Period. And so thinking about your\nthermodynamic boundary",
    "start": "598650",
    "end": "604470"
  },
  {
    "text": "conditions before you make any\nconclusions is quite important. So for those of you--",
    "start": "604470",
    "end": "614339"
  },
  {
    "text": "let me just remind\nyou of the relation between the thermodynamic\nboundary conditions and the statistical ensemble.",
    "start": "614340",
    "end": "620270"
  },
  {
    "text": "The statistical\nensemble is essentially the group of states\nover which you sample. So we're always going\nto make the relation",
    "start": "620270",
    "end": "627020"
  },
  {
    "text": "between a microscopic ensemble-- so this is the group of\nstates for which you sample.",
    "start": "627020",
    "end": "632839"
  },
  {
    "text": " You could think of it, it's\nthe boundary conditions",
    "start": "632840",
    "end": "638600"
  },
  {
    "text": "on the states over\nwhich you sample-- should you sample any\nconfiguration, should you constrain them--",
    "start": "638600",
    "end": "645560"
  },
  {
    "text": "and the macroscopic\nthermodynamics. And the relation here is made\nbetween statistical mechanics.",
    "start": "645560",
    "end": "652160"
  },
  {
    "text": "In the end, it's very easy. Any fixed thermodynamic\nvariable-- I'll come to that in the\nsecond, what they are--",
    "start": "652160",
    "end": "658220"
  },
  {
    "text": "sets a constraint on\nhow you can sample. And more particularly,\nthe constraints",
    "start": "658220",
    "end": "663470"
  },
  {
    "text": "come from what are called\nthe extensive thermodynamic variables. So remember, extensive\nthermodynamic variables are things at scale with\nsize, things like volume,",
    "start": "663470",
    "end": "673100"
  },
  {
    "text": "number of atoms of a given type. And intensive variables\nare the conjugates. Those are the ones that don't\nscale that size-- temperature,",
    "start": "673100",
    "end": "679910"
  },
  {
    "text": "pressure, chemical potential. You'll see in a second that\nthe probability with which you",
    "start": "679910",
    "end": "686630"
  },
  {
    "text": "sample depends on the\nrelevant Hamiltonian, and the macroscopic\npound counterpart of that",
    "start": "686630",
    "end": "693050"
  },
  {
    "text": "is a free energy function. So a Hamiltonian in\nmicroscopic space will correspond to a free energy\nfunction in macroscopic space.",
    "start": "693050",
    "end": "701390"
  },
  {
    "text": " OK. So here's all I'm going to say\nabout thermal is sort of one",
    "start": "701390",
    "end": "708550"
  },
  {
    "text": "slide that I think represents\npretty much all you need to know for doing sampling.",
    "start": "708550",
    "end": "715570"
  },
  {
    "text": "In thermodynamics\nvariables appear in groups, what we call conjugate pairs. And one way you can\nsee how they belong,",
    "start": "715570",
    "end": "721880"
  },
  {
    "text": "it's the couples that appear\ntogether in the first law.",
    "start": "721880",
    "end": "728000"
  },
  {
    "text": "First law tells\nyou, essentially, that the change of\ninternal energy of a system is the net energy flow\nin or out of that system.",
    "start": "728000",
    "end": "735970"
  },
  {
    "text": "And you can write that from\ndifferent contributions. TdS you could think\nof as the heat flow, pdV is the mechanical\nor volume work done,",
    "start": "735970",
    "end": "744040"
  },
  {
    "text": "mu dN as the chemical work. So if u is the\nchemical potential, N is the number of\natoms of a given type.",
    "start": "744040",
    "end": "750460"
  },
  {
    "text": "So remember, these\nare conjugate pairs. S is an extensive, T is an\nintensive, V is an extensive,",
    "start": "750460",
    "end": "757390"
  },
  {
    "text": "p is an intensive, N is an\nextensive, mu is an intensive.",
    "start": "757390",
    "end": "763318"
  },
  {
    "text": "Essentially, the\nrule is very simple. To define your\nboundary conditions, you always need to specify\none out of each pair.",
    "start": "763318",
    "end": "769464"
  },
  {
    "text": "So you need to\nsay whether you're at constant entropy or\nconstant temperature, whether you're at constant\npressure or constant volume,",
    "start": "769465",
    "end": "775295"
  },
  {
    "text": "whether you're at constant\nchemical potential or constant number of particles. You could not leave\none unspecified.",
    "start": "775295",
    "end": "784205"
  },
  {
    "text": "If you do that, you're\nactually always making an implicit assumption. OK. If you have a closed box and\nnothing can go in and out,",
    "start": "784205",
    "end": "792230"
  },
  {
    "text": "you're obviously under\nconstant number of particles. A really classic\nmistake is simulating",
    "start": "792230",
    "end": "799100"
  },
  {
    "text": "on the constant\nnumber of particles, when you're really, in reality,\nunder constant chemical field.",
    "start": "799100",
    "end": "804470"
  },
  {
    "text": "Surfaces are a really\ngood example of that. If you study a surface, you will\noften study it in simulation",
    "start": "804470",
    "end": "813302"
  },
  {
    "text": "under constant\nnumber of particles. It's sort of the\nobvious thing to do. But real surfaces are\nactually equilibrated",
    "start": "813302",
    "end": "818870"
  },
  {
    "text": "with their environment. So they're under constant\nchemical potential field",
    "start": "818870",
    "end": "824060"
  },
  {
    "text": "of the environment or under\nconstant chemical potential from their bulk.",
    "start": "824060",
    "end": "829550"
  },
  {
    "text": "And in some cases\nthat doesn't matter. But in other cases\nthat actually will. So the number of atoms\non a surface can change.",
    "start": "829550",
    "end": "836660"
  },
  {
    "text": " In statistical mechanics,\nwe tend to not use this",
    "start": "836660",
    "end": "842660"
  },
  {
    "text": "formulation of the first\nlaw, but we tend interchange the role of the internal energy\nand the entropy literally",
    "start": "842660",
    "end": "849680"
  },
  {
    "text": "by moving this to the left-hand\nside and dividing by T-- so riding the differential\nof the entropy instead.",
    "start": "849680",
    "end": "856077"
  },
  {
    "text": "And you'll see in a\nsecond that that's a much more useful\nthermodynamic notation to correlate to\nstatistical mechanics.",
    "start": "856077",
    "end": "863130"
  },
  {
    "text": "So this is called the\nentropy formulation. And in the entropy\nformulation, U and 1 over T",
    "start": "863130",
    "end": "868220"
  },
  {
    "text": "are conjugate variables. U is the extensive, 1\nover T is the intensive, V is the the extensive, p\nover T is the extensive.",
    "start": "868220",
    "end": "876560"
  },
  {
    "text": "I hope you can see\nthis is just a rewrite of the standard first law. ",
    "start": "876560",
    "end": "887149"
  },
  {
    "text": "OK.  So how do the thermodynamic\nboundary conditions",
    "start": "887150",
    "end": "893150"
  },
  {
    "text": "relate to the ensemble's\nover which you average? The ensembles are determined\nby the extensive variables",
    "start": "893150",
    "end": "901610"
  },
  {
    "text": "you keep constant. So if you think about, if\nyou go back for a second the previous slide,\nthe simplest is",
    "start": "901610",
    "end": "908540"
  },
  {
    "text": "that you keep the energy,\nthe volume, the number of particles, constant. That's all the\nextensive variables.",
    "start": "908540",
    "end": "915050"
  },
  {
    "text": " All the extensive\nvariables, that's",
    "start": "915050",
    "end": "920110"
  },
  {
    "text": "the ensemble at constant energy,\nvolume, number of particles. That's what's called the\nmicrocanonical ensemble.",
    "start": "920110",
    "end": "926470"
  },
  {
    "text": "A realization of that would\nbe if you did a system in a box, Newtonian dynamics.",
    "start": "926470",
    "end": "935330"
  },
  {
    "text": "If it's in a closed box,\nthe number of particles can't change, the\nvolume is fixed. And if you do Newtonian\ndynamics, the energy is fixed.",
    "start": "935330",
    "end": "943660"
  },
  {
    "text": "So the basic form of molecular\ndynamics, you could say, goes through a\nmicrocanonical ensemble.",
    "start": "943660",
    "end": "951050"
  },
  {
    "text": "If you start thermostating your\nenergy to fix the temperature, then you go out of the\nmicrocanonical ensemble.",
    "start": "951050",
    "end": "959450"
  },
  {
    "text": "So if you release the\nconstraint of fixed energy,",
    "start": "959450",
    "end": "965540"
  },
  {
    "text": "then you have to control\nthe average energy. And you do that with\nthe temperature. Then you end up in what's\ncalled a canonical ensemble.",
    "start": "965540",
    "end": "974139"
  },
  {
    "text": "If you release the constraint\nof fixed number of particles, again, then you have\nto take into account",
    "start": "974140",
    "end": "980649"
  },
  {
    "text": "the field that sets your\naverage number of particles. So then you have an\nensemble with T, V, and mu.",
    "start": "980650",
    "end": "987940"
  },
  {
    "text": "That's called a grand\ncanonical ensemble. You can keep on making\nother ensembles by switching",
    "start": "987940",
    "end": "994540"
  },
  {
    "text": "in intensive variables\nfor extensive, it's just that we\nrun out of names. These are three classic names--\nmicrocanonical, canonical,",
    "start": "994540",
    "end": "1001230"
  },
  {
    "text": "and grand canonical. After that, we sort of have\nno names for them anymore, but they do exist.",
    "start": "1001230",
    "end": "1006270"
  },
  {
    "start": "1006270",
    "end": "1012970"
  },
  {
    "text": "OK. So that defines the states\nfrom which you should sample.",
    "start": "1012970",
    "end": "1018760"
  },
  {
    "text": "The question is, now,\nhow do you sample? Well, first I'm going to tell\nyou how you should sample,",
    "start": "1018760",
    "end": "1024189"
  },
  {
    "text": "and then I'll tell you how\nyou really sample in practice. You should sample with\nthe correct probability.",
    "start": "1024190",
    "end": "1030380"
  },
  {
    "text": "And the probability of\na state in an ensemble is proportional to the\nexponential of minus beta,",
    "start": "1030380",
    "end": "1036459"
  },
  {
    "text": "the Hamiltonian-- again, remember,\nbeta is 1 over kT--",
    "start": "1036460",
    "end": "1041780"
  },
  {
    "text": "and then normalized\nby the sum of that over all the states, which is\ncalled the partition function, PrZ.",
    "start": "1041780",
    "end": "1046869"
  },
  {
    "text": " And the free energy\nis essentially the log",
    "start": "1046869",
    "end": "1054100"
  },
  {
    "text": "of that partition function. Now, what should\nthat Hamiltonian be? You've probably seen this kind\nof probability function a lot",
    "start": "1054100",
    "end": "1060850"
  },
  {
    "text": "already when you\nsubstitute in the energy. In more general\nterms, that should be the relevant\nmicroscopic Hamiltonian,",
    "start": "1060850",
    "end": "1069460"
  },
  {
    "text": "and it should include\nall the things that can fluctuate in your system.",
    "start": "1069460",
    "end": "1075700"
  },
  {
    "text": "Typically, the way\nI sort of remember what goes into\nHamiltonian, you think",
    "start": "1075700",
    "end": "1081460"
  },
  {
    "text": "of your thermodynamic\nboundary conditions, you take the relevant Legendre\ntransform of your entropy,",
    "start": "1081460",
    "end": "1087040"
  },
  {
    "text": "and it's essentially\nthose pieces that go in your Hamiltonian. For example, if you work\nat fixed N, V, and T,",
    "start": "1087040",
    "end": "1095620"
  },
  {
    "text": "the relevant free energy is\nthe Helmholtz free energy, which is S minus E over\nT. This is the part that",
    "start": "1095620",
    "end": "1103650"
  },
  {
    "text": "goes into your Hamiltonian. It's whatever is the Legendre\ntransform part of the entropy.",
    "start": "1103650",
    "end": "1109740"
  },
  {
    "text": "And that's what you see. In a canonical ensemble,\nyou weigh states",
    "start": "1109740",
    "end": "1115680"
  },
  {
    "text": "with the exponential of\nminus beta the energy. That's the one you're used to.",
    "start": "1115680",
    "end": "1120789"
  },
  {
    "text": "But let's say you go to a\ngrand canonical ensemble. ",
    "start": "1120790",
    "end": "1127630"
  },
  {
    "text": "So now you're at fixed\nchemical potential so the number of\nstates can fluctuate.",
    "start": "1127630",
    "end": "1132907"
  },
  {
    "text": "So now the relevant\nthermodynamic potential, the relevant Legendre\ntransform of the entropy has a minus E over T and\na plus mu over T in it.",
    "start": "1132907",
    "end": "1140730"
  },
  {
    "text": "So that's essentially\nthe part that appears in your Hamiltonian. So now you weigh\nwith minus beta times",
    "start": "1140730",
    "end": "1149290"
  },
  {
    "text": "the energy minus mu N. Just sort\nof think of that as a Legendre transform Hamiltonian almost.",
    "start": "1149290",
    "end": "1157580"
  },
  {
    "text": "And if you were to simulate\nthat constant pressure , you would have a P over T times\nV term in your Hamiltonian.",
    "start": "1157580",
    "end": "1167419"
  },
  {
    "text": "If you sort think about\nit, it makes sense that you need these terms\nin your Hamiltonian. Because if they don't\nappear in your Hamiltonian,",
    "start": "1167420",
    "end": "1174000"
  },
  {
    "text": "you have no way of controlling\nthe number of particles. OK. ",
    "start": "1174000",
    "end": "1184960"
  },
  {
    "text": "It's sort of going backwards. So this is here\nsort of the summary.",
    "start": "1184960",
    "end": "1190440"
  },
  {
    "text": " The macroscopic\nboundary conditions",
    "start": "1190440",
    "end": "1195540"
  },
  {
    "text": "are set by the constant\nextensive thermodynamic variables.",
    "start": "1195540",
    "end": "1201390"
  },
  {
    "text": "That in turn defines\nthe relevant ensemble and the probability which\nyou sample over an ensemble.",
    "start": "1201390",
    "end": "1209382"
  },
  {
    "text": "And when you do\nthat all correctly, you can get the\naverages of properties, such as the energy\nand the volume",
    "start": "1209382",
    "end": "1217930"
  },
  {
    "text": "with those probabilities. OK. ",
    "start": "1217930",
    "end": "1224350"
  },
  {
    "text": "Just one brief aside-- there's an implicit\nassumption you make in here, which is common\nto statistical mechanics.",
    "start": "1224350",
    "end": "1233289"
  },
  {
    "text": "We've essentially said that\nfollowing a system in time will give the same averages\nthen sampling over its ensemble.",
    "start": "1233290",
    "end": "1243250"
  },
  {
    "text": "The assumption in\nthere is that when you follow a system in time,\nit will reach essentially",
    "start": "1243250",
    "end": "1249490"
  },
  {
    "text": "all the states in its ensemble. Or, maybe simpler said, it will\nreach all the states it can--",
    "start": "1249490",
    "end": "1256770"
  },
  {
    "text": "it will reach all the states\nthat are within the boundary conditions. So if you put--",
    "start": "1256770",
    "end": "1263440"
  },
  {
    "text": "think about this. What you're really\nsaying is if you put a system in a box,\nfixed number of particle,",
    "start": "1263440",
    "end": "1270250"
  },
  {
    "text": "say, at constant temperature,\nnot constant energy, you're essentially saying\nthat that system will,",
    "start": "1270250",
    "end": "1276880"
  },
  {
    "text": "if you wait long enough, reach\nany possible configuration of atoms. Because that's the one that will\nbe allowed in your ensemble.",
    "start": "1276880",
    "end": "1285870"
  },
  {
    "text": "And that's called the\nergodicity principle. The ergodicity principle says\nthat if you wait long enough a system will reach,\nfinally, all its states .",
    "start": "1285870",
    "end": "1293612"
  },
  {
    "text": "Because if you know that it's\ngoing to reach all its states and you know the\nprobability of them, then you can just sum over it.",
    "start": "1293612",
    "end": "1298920"
  },
  {
    "text": "And that's what you do\nin statistical mechanics, rather than doing\nthe full dynamics.",
    "start": "1298920",
    "end": "1304710"
  },
  {
    "text": "This is where we usually\nhave to give you the caveat-- the lawyer's caveat-- that\nnot all systems are ergodic.",
    "start": "1304710",
    "end": "1311880"
  },
  {
    "text": "Most practical ones are. The examples that are often\ngiven as non-ergodic system are a bit fake.",
    "start": "1311880",
    "end": "1317309"
  },
  {
    "text": "And one that I like to bring\nup is the harmonic oscillator. If you think of a\nharmonic oscillator,",
    "start": "1317310",
    "end": "1324600"
  },
  {
    "text": "think of something,\na mass, that is",
    "start": "1324600",
    "end": "1331100"
  },
  {
    "text": "in contact with a rigid\nobject to a spring. If you think that\nthe two coordinates--",
    "start": "1331100",
    "end": "1337460"
  },
  {
    "text": "what are the two\ncoordinates of this system? Well, there's a position\ncoordinate, where this mass is,",
    "start": "1337460",
    "end": "1344480"
  },
  {
    "text": "and there's a\nvelocity coordinate. Well, because it's a\nharmonic oscillator, the two are actually correlated.",
    "start": "1344480",
    "end": "1351570"
  },
  {
    "text": "So if you think of the phase\npace of the system as-- here's the spatial coordinate,\nhere's the velocity coordinate.",
    "start": "1351570",
    "end": "1359970"
  },
  {
    "text": "The system actually\ngoes through an ellipse. It actually never goes to states\nlike this and this and this.",
    "start": "1359970",
    "end": "1366330"
  },
  {
    "text": "So people say the harmonic\noscillator is not ergodic. I'd say it's not ergodic because\nyou took a stupid phase space.",
    "start": "1366330",
    "end": "1374500"
  },
  {
    "text": "It's because you essentially\nsaid that the system has to coordinates.",
    "start": "1374500",
    "end": "1381414"
  },
  {
    "text": "So in a two-dimensional\nspace, it's not ergodic. In a one-dimensional\nspace, it is ergodic.",
    "start": "1381415",
    "end": "1386540"
  },
  {
    "text": "This system has\nonly one coordinate. That's its normal mode.",
    "start": "1386540",
    "end": "1391570"
  },
  {
    "text": "So if you write it in the\nnormal mode, it is ergodic. In one dimension, it is ergodic.",
    "start": "1391570",
    "end": "1397190"
  },
  {
    "text": "So along that trajectory, if\nyou say that's your phase space, the system is ergodic. So it's a bit of a\nmatter of definition.",
    "start": "1397190",
    "end": "1403960"
  },
  {
    "text": "In the obvious coordinate\nspace, this one is not ergodic. ",
    "start": "1403960",
    "end": "1411110"
  },
  {
    "text": "And then there are systems\nthat for practical reasons",
    "start": "1411110",
    "end": "1418070"
  },
  {
    "text": "are essentially non-ergodic. They just never get there going\nthrough all their phase spaces.",
    "start": "1418070",
    "end": "1424520"
  },
  {
    "text": "Glasses are really difficult\nto do thermodynamics on,",
    "start": "1424520",
    "end": "1431090"
  },
  {
    "text": "to integrate phase space\nover, because you really don't know over what\nregion to integrate.",
    "start": "1431090",
    "end": "1436460"
  },
  {
    "text": "If I give you atoms-- I say, give me the\nfree energy of a glass.",
    "start": "1436460",
    "end": "1442820"
  },
  {
    "text": "Really, when you\nthink about it, you don't know what ensemble\nto integrate over. Because if you say,\nwell, what is a glass?",
    "start": "1442820",
    "end": "1448550"
  },
  {
    "text": "Well, it's sort of random. So can I just average over\nall the possible positions",
    "start": "1448550",
    "end": "1456350"
  },
  {
    "text": "in the box? Then I'm actually getting\nthe free energy of a liquid.",
    "start": "1456350",
    "end": "1461680"
  },
  {
    "text": "The glass actually never samples\nall the possible positions. So you could argue that it's\na liquid that's not ergodic.",
    "start": "1461680",
    "end": "1467760"
  },
  {
    "text": "And if you sort of\nthink of it, it's a liquid that's frozen [? in. ?]",
    "start": "1467760",
    "end": "1475360"
  },
  {
    "text": "OK. So finally we're going to get\nto the Monte Carlo simulation. Before that, I want to\nintroduce one toy model.",
    "start": "1475360",
    "end": "1481090"
  },
  {
    "text": "And you'll see the relation\nwith the mixing problem. And that's the\nIsing model, which",
    "start": "1481090",
    "end": "1486679"
  },
  {
    "text": "is essentially a spin model. So we have lots of sites. At every site we can have\nan up spin or a down spin.",
    "start": "1486680",
    "end": "1495380"
  },
  {
    "text": "So there's only a binary\nvariable at every site. We'll mark that with a plus\n1 or minus 1-- say plus 1",
    "start": "1495380",
    "end": "1503659"
  },
  {
    "text": "for up and minus 1 for down. And so the simplest\nHamiltonian or energy function",
    "start": "1503660",
    "end": "1509090"
  },
  {
    "text": "you can write for\nthis system is one that counts the nearest\nneighbor bonds and associates",
    "start": "1509090",
    "end": "1515430"
  },
  {
    "text": "some interaction with them. So I and J are only nearest\nneighbors in this model.",
    "start": "1515430",
    "end": "1523000"
  },
  {
    "text": "So let's say if J\nis positive, then,",
    "start": "1523000",
    "end": "1529080"
  },
  {
    "text": "since there's a\nminus sign here, you will want to make this positive\nso you'll get a ferromagnet. That means if you have\na plus 1 somewhere,",
    "start": "1529080",
    "end": "1535140"
  },
  {
    "text": "you'll want a plus 1 next\nto it to get flow energy. If J is negative, you will want\nthe spin product sigma I sigma",
    "start": "1535140",
    "end": "1544490"
  },
  {
    "text": "J to be negative. That means if you\nyou have a plus spin, you'll want a negative\nspin next to it.",
    "start": "1544490",
    "end": "1550680"
  },
  {
    "text": "So you have antiferromagnet. So it's the simplest possible\nmagnetic model you can make. And that was Ising's PhD thesis.",
    "start": "1550680",
    "end": "1557900"
  },
  {
    "text": "And his advisors\nreally hated it. His advisor was so mad at\nhim for that PhD thesis",
    "start": "1557900",
    "end": "1563300"
  },
  {
    "text": "that Ising left science and\nhe became a businessman. So he never knew he\nbecame famous later on.",
    "start": "1563300",
    "end": "1569700"
  },
  {
    "text": " But what you're going to\nsee is that the Ising model",
    "start": "1569700",
    "end": "1574760"
  },
  {
    "text": "is sort of a conduit. It's a model I will use\nfor any two-state system. So any time you\nhave a model where",
    "start": "1574760",
    "end": "1581330"
  },
  {
    "text": "there's sort of two\npossibilities on the lattice side, we'll use this model. Because I call it\na magnetic spin.",
    "start": "1581330",
    "end": "1586850"
  },
  {
    "text": "I mean, you could\ncall it low fat, high fat cheese, whatever--\nany time you have two states.",
    "start": "1586850",
    "end": "1593880"
  },
  {
    "text": "So we're going to use it for\nbinary alloys, for example. If we have a mixture of\nA and B on a lattice, you could say the plus 1\nis A, the minus 1 is B.",
    "start": "1593880",
    "end": "1603800"
  },
  {
    "text": "So that's why it is\nsuch a useful model. ",
    "start": "1603800",
    "end": "1609900"
  },
  {
    "text": "OK. So how would you sample\na model like that? Well, let me first\ntell you a little bit",
    "start": "1609900",
    "end": "1615360"
  },
  {
    "text": "about where the ideas of\nsampling and Monte Carlo sampling came from.",
    "start": "1615360",
    "end": "1622320"
  },
  {
    "text": "It's typically\ncredited to the people at Los Alamos, Monte Carlo\nsamples, who built the ENIAC",
    "start": "1622320",
    "end": "1629460"
  },
  {
    "text": "computer, which is\nessentially, I think, the first computer or one of the\nfirst computers that was built.",
    "start": "1629460",
    "end": "1634539"
  },
  {
    "text": "One of these things\nwith vacuum tubes, and you could calculate\nfor 10 seconds and then one of the\ntubes would break.",
    "start": "1634540",
    "end": "1640020"
  },
  {
    "text": "And then you'd replace the\ntube and calculate another 10 seconds. But I believe idea of\nMonte Carlo sampling really",
    "start": "1640020",
    "end": "1647940"
  },
  {
    "text": "goes back to Fermi. People before that sort of\nhad sampling ideas already. They sort of knew how to\nuse sampling for things that",
    "start": "1647940",
    "end": "1655140"
  },
  {
    "text": "were difficult to integrate. And the first example\nthat I thought is known is",
    "start": "1655140",
    "end": "1661289"
  },
  {
    "text": "by the Comte de Buffon-- which\nI think is a beautiful name., buffon is like--",
    "start": "1661290",
    "end": "1666600"
  },
  {
    "text": "who thought of this as a method\nfor integrating functions. And the idea is very\nsimple, that if you",
    "start": "1666600",
    "end": "1674159"
  },
  {
    "text": "have this function that\nyou can't integrate, or maybe it's\nnumerically defined,",
    "start": "1674160",
    "end": "1679380"
  },
  {
    "text": "a really simple way to\nintegrate is to draw a box",
    "start": "1679380",
    "end": "1685030"
  },
  {
    "text": "and throw darts in that box. Randomly take\npoints in that box, and you'll hit here once in\na while, and here, and here,",
    "start": "1685030",
    "end": "1691750"
  },
  {
    "text": "and here. And if you think about it, if\nyou track the number of times",
    "start": "1691750",
    "end": "1697179"
  },
  {
    "text": "that you're below\nthe curve, that's telling you something about\nthat integral under the curve.",
    "start": "1697180",
    "end": "1703330"
  },
  {
    "text": "Because the number of times\nbelow the curve is the integral",
    "start": "1703330",
    "end": "1716980"
  },
  {
    "text": "divided by the total area.  So the area of the\nsquare is the total area,",
    "start": "1716980",
    "end": "1725970"
  },
  {
    "text": "and the integral is\na fraction of that. And so that fraction\nis the probability",
    "start": "1725970",
    "end": "1731429"
  },
  {
    "text": "that you hit below the curve. So by just knowing how many\ntimes you're below the curve, you have a reasonable\nestimate of the integral.",
    "start": "1731430",
    "end": "1738343"
  },
  {
    "text": "And if you do this\nwith a lot of points, you'll get a good\napproximation to the integral.",
    "start": "1738343",
    "end": "1744522"
  },
  {
    "text": "This is how kids in\nschool learn to integrate. My daughter's in third\ngrade, and the way they learn to integrate is\nby putting grids on this",
    "start": "1744522",
    "end": "1752580"
  },
  {
    "text": "and counting how many grid\npoints are below the curve. Which you could say is a\nsampling method-- it's just",
    "start": "1752580",
    "end": "1759060"
  },
  {
    "text": "not a random sampling methods. You use sample with a fixed grid\nrather than with a random grid.",
    "start": "1759060",
    "end": "1764640"
  },
  {
    "text": " So I was going to give\nyou an assignment. ",
    "start": "1764640",
    "end": "1773120"
  },
  {
    "text": "This is one of these\nassignments for when you're sitting in a boring lecture-- which is not this one, but\nanother boring lecture--",
    "start": "1773120",
    "end": "1780100"
  },
  {
    "text": "or you're sitting on an\nairplane and they hold you for two hours on the tarmac\nwith nowhere to go and no food.",
    "start": "1780100",
    "end": "1786760"
  },
  {
    "text": "You should try to determine pi. And here's a way\nof determining pi.",
    "start": "1786760",
    "end": "1792700"
  },
  {
    "text": "You know that pi\nessentially relates to the ratio of the\narea of a circle divided",
    "start": "1792700",
    "end": "1800800"
  },
  {
    "text": "by the area of the square\nthat's circumscribed.",
    "start": "1800800",
    "end": "1806200"
  },
  {
    "text": "Because this area\nhere, if you just take, say, a quadrant of this,\nis 1 over 4 pi r squared.",
    "start": "1806200",
    "end": "1816059"
  },
  {
    "text": "And the area of the\nsquare is r squared. So the ratio of those\ntwo is 1/4 times pi.",
    "start": "1816060",
    "end": "1824750"
  },
  {
    "text": "So if you throw darts randomly\nat this thing, if you count",
    "start": "1824750",
    "end": "1830650"
  },
  {
    "text": "the fraction of the times\nyou're within the circle divided by the total number of points,\nyou'll get an estimate for pi.",
    "start": "1830650",
    "end": "1838070"
  },
  {
    "text": "So you should try\nthis, like throw darts. You can't bring darts anymore\nin an airplane unfortunately,",
    "start": "1838070",
    "end": "1843500"
  },
  {
    "text": "so you'll have to kind of\nlike hold your pen randomly. And you should see once\nhow quickly or slowly you",
    "start": "1843500",
    "end": "1849950"
  },
  {
    "text": "actually approach pi. You get the first few\ndigits pretty quickly actually-- not so bad. But then, after that, of\ncourse, it goes really slowly.",
    "start": "1849950",
    "end": "1857120"
  },
  {
    "text": "Because, essentially,\nto get the third digit, you're going to have to\nalmost do 1,000 points.",
    "start": "1857120",
    "end": "1863929"
  },
  {
    "text": "But when you're bored,\nit's not a bad thing to do. ",
    "start": "1863930",
    "end": "1871830"
  },
  {
    "text": "So let's talk more\nabout sampling. There are essentially\nmany ways of sampling,",
    "start": "1871830",
    "end": "1879090"
  },
  {
    "text": "but I'm going to give\nyou two extremes. One is called simple sampling. One is called\nimportance sampling.",
    "start": "1879090",
    "end": "1884940"
  },
  {
    "text": "Later, in one of\nthe later lectures, I'll sort of show you that\nyou could kind of do anything in between as well.",
    "start": "1884940",
    "end": "1891490"
  },
  {
    "text": "So what is simple sampling? It's kind of what these\nprevious methods were.",
    "start": "1891490",
    "end": "1896940"
  },
  {
    "text": "You would randomly pick\npoints in your phase space.",
    "start": "1896940",
    "end": "1902159"
  },
  {
    "text": "So if you randomly pick points,\nthat means now states of atoms or whatever the states\nof your system are,",
    "start": "1902160",
    "end": "1908790"
  },
  {
    "text": "you have to weigh them with\nthe correct probability. But you could do that. So you could\nrandomly pick states.",
    "start": "1908790",
    "end": "1916580"
  },
  {
    "text": "Let's say the state is new here. The property in the\nstate is A. So the way",
    "start": "1916580",
    "end": "1922370"
  },
  {
    "text": "you get the average\nof A is by weighing that A with the\nprobability of that state. And we know how to\ncalculate the probability.",
    "start": "1922370",
    "end": "1929432"
  },
  {
    "text": "Probability we know\nis proportional to that exponential of minus\nbeta of the Hamiltonian. What I don't know is\nthe partition function",
    "start": "1929432",
    "end": "1936950"
  },
  {
    "text": "that I have to normalize with. But what I can do\nis after I sampled a bunch of states\nI can literally",
    "start": "1936950",
    "end": "1942410"
  },
  {
    "text": "define an approximation\nto my partition function as the sum of that exponential\nover all the states that I've",
    "start": "1942410",
    "end": "1947990"
  },
  {
    "text": "sampled [INAUDIBLE]. And I need that, because\nI need to normalize my probabilities to 1.",
    "start": "1947990",
    "end": "1953390"
  },
  {
    "text": " Simple sampling, it's called\nsimple because, as I said,",
    "start": "1953390",
    "end": "1961549"
  },
  {
    "text": "economists use it.  That was a joke, but, you know.",
    "start": "1961550",
    "end": "1969169"
  },
  {
    "text": "It works for small spaces-- small phase spaces. It does not work at all\nfor materials for a reason",
    "start": "1969170",
    "end": "1974809"
  },
  {
    "text": "I'll tell you in a second. And you think that's obvious.",
    "start": "1974810",
    "end": "1979850"
  },
  {
    "text": "Did you think that was obvious\nthat simple sampling does not work for materials?",
    "start": "1979850",
    "end": "1985010"
  },
  {
    "text": "Who thought that was obvious? Nobody. So it's not obvious. Good.",
    "start": "1985010",
    "end": "1990990"
  },
  {
    "text": "Because otherwise, it\nwas a trick question. I'll show you in a second\nthat it's not obvious.",
    "start": "1990990",
    "end": "1996630"
  },
  {
    "text": "But why does it not work? ",
    "start": "1996630",
    "end": "2002710"
  },
  {
    "text": "You essentially,\nwith simple sampling, pick states in proportion\nto their degeneracy.",
    "start": "2002710",
    "end": "2012150"
  },
  {
    "text": "So if you think of\nyour spin model, let's say you're spinning\nat a low temperature",
    "start": "2012150",
    "end": "2018830"
  },
  {
    "text": "where this thing wants to\nbe a ferromagnet with all the spins aligned. How would you pick spins?",
    "start": "2018830",
    "end": "2026030"
  },
  {
    "text": "Well, if you pick\nthem randomly, you would never end up with a\nferromagnetic configuration. Because you picked the spin\nhere up, here down, here up,",
    "start": "2026030",
    "end": "2033320"
  },
  {
    "text": "here down. So you would sample a lot\nof states in the phase space but never the relevant one.",
    "start": "2033320",
    "end": "2039370"
  },
  {
    "text": "OK. And typically you pick\nstates with higher entropy.",
    "start": "2039370",
    "end": "2046180"
  },
  {
    "text": "And you know that, because\nthe entropy is essentially the log of the multiplicity.",
    "start": "2046180",
    "end": "2052719"
  },
  {
    "text": "The entropy at a given\nenergy is the log of the number of\nstates of that energy.",
    "start": "2052719",
    "end": "2057940"
  },
  {
    "text": "So remember, if you\ndo simple sampling, you're going to pick states\nproportional to omega.",
    "start": "2057940",
    "end": "2064388"
  },
  {
    "text": "So you're always going to\npick states with high energy, because we know that d log dE is\n1 over kT is a positive number.",
    "start": "2064389",
    "end": "2071239"
  },
  {
    "text": "So that means the number of\nstates with a given energy is an increasing\nfunction of energy.",
    "start": "2071239",
    "end": "2077899"
  },
  {
    "text": " So that means that\nif you simple sample",
    "start": "2077900",
    "end": "2084427"
  },
  {
    "text": "you're almost never\ngoing to pick down here, because there are\nalmost no states. You're always going\nto pick up here,",
    "start": "2084427",
    "end": "2089590"
  },
  {
    "text": "because there are a\nlot of states there. See the parallel with\nyour spin model is--",
    "start": "2089590",
    "end": "2094980"
  },
  {
    "text": "see, these are the\nferromagnetic states. You have low energy,\neverything's nicely lined up. These are all the random\nstates, the paramagnetic states.",
    "start": "2094980",
    "end": "2102970"
  },
  {
    "text": "In reality, your system\nlives somewhere in between. ",
    "start": "2102970",
    "end": "2108550"
  },
  {
    "text": "At some temperature it\nhas some average energy, and then it has a fluctuation\nof energy around it.",
    "start": "2108550",
    "end": "2115090"
  },
  {
    "text": "So your real system\nkind of samples these states, and you're\nalways hanging out here--",
    "start": "2115090",
    "end": "2120775"
  },
  {
    "text": "you're always sampling\nthe wrong thing. ",
    "start": "2120775",
    "end": "2128490"
  },
  {
    "text": "If you had said that this was\nobvious that it wouldn't work, I would have thrown this at you. Here's a paper from\na famous physicist",
    "start": "2128490",
    "end": "2135280"
  },
  {
    "text": "that I respect very well,\nbut he was so wrong. ",
    "start": "2135280",
    "end": "2140930"
  },
  {
    "text": "This was somebody\nwho's been great in density functional theory. He has done beautiful work\nin it and at some point tried",
    "start": "2140930",
    "end": "2146013"
  },
  {
    "text": "to do a phase diagram. And realize, of\ncourse, I blanked out the name out of respect.",
    "start": "2146013",
    "end": "2151810"
  },
  {
    "text": "But of course you\ncould find out. ",
    "start": "2151810",
    "end": "2158480"
  },
  {
    "text": "They were really good at\ndoing quantum mechanics and getting energies of states. And they wanted to\nget free energies now",
    "start": "2158480",
    "end": "2164660"
  },
  {
    "text": "at finite temperature. This was on the\naluminum lithium system. I mean this is 1988. This was like if there was\nany heydays ever of aluminum",
    "start": "2164660",
    "end": "2171590"
  },
  {
    "text": "lithium, this was it. Everybody was working\non aluminum lithium, because everybody thought that\nwas the alloy of the future.",
    "start": "2171590",
    "end": "2177560"
  },
  {
    "text": "Because lithium is\nthe lightest metal. It's the lightest solid\nin the periodic table. So any atom you can\nreplace by lithium",
    "start": "2177560",
    "end": "2185720"
  },
  {
    "text": "will make your alloys lighter. So that was a big dream. You could make really light\nairplanes and whatever.",
    "start": "2185720",
    "end": "2191880"
  },
  {
    "text": "And [INAUDIBLE] built\nanomalous capacity for making aluminum\nlithium alloys, et cetera, and it never panned out.",
    "start": "2191880",
    "end": "2198180"
  },
  {
    "text": "Turned out you couldn't\nweld them very well, and they have really\nbad fatigue resistance. So you really don't want to\nmake an airplane out of them.",
    "start": "2198180",
    "end": "2204420"
  },
  {
    "text": "Ironically, they make the\ndoors of airplanes out of them. I never know how to\nfigure that one out. And the seat frames,\nthere's aluminum.",
    "start": "2204420",
    "end": "2213000"
  },
  {
    "text": "But the seat is supported on\nis out of aluminum lithium. But the doors always scares\nme, when I sit by the door",
    "start": "2213000",
    "end": "2218520"
  },
  {
    "text": "and I know this is\naluminum lithium, which has poor fatigue\nresistance and very poor welding characteristics.",
    "start": "2218520",
    "end": "2223920"
  },
  {
    "text": "But anyway, everybody\nworked on aluminum lithium. And so these guys were good\nat doing quantum mechanics.",
    "start": "2223920",
    "end": "2231309"
  },
  {
    "text": "So how did they get\nthe phase diagram? That they actually took a box\nof atoms and randomly made up",
    "start": "2231310",
    "end": "2239440"
  },
  {
    "text": "configurations and then\ncalculated the energy along with quantum mechanics. So this was essentially\nsimple sampling.",
    "start": "2239440",
    "end": "2246520"
  },
  {
    "text": "And then they summed that and\ngot the partition function. If you have the\npartition functioning, you have the free energy.",
    "start": "2246520",
    "end": "2251522"
  },
  {
    "text": "And this was the phase diagram\nthat came out to the right. It sort of violates all\nkinds of phase rules,",
    "start": "2251522",
    "end": "2257109"
  },
  {
    "text": "and it's completely wrong. And so it's not that\nobvious that simple sampling",
    "start": "2257110",
    "end": "2263330"
  },
  {
    "text": "doesn't work, because even\nthe best people have done it. ",
    "start": "2263330",
    "end": "2274680"
  },
  {
    "text": "I like this example. This comes out of a great book. This is the book\nby Franklin Smith. And I'll show you a list\nof references at the end.",
    "start": "2274680",
    "end": "2281022"
  },
  {
    "text": "This is a great\nbook on Monte Carlo if you want to delve\ndeeper into it. They have this great\nanalogy of simple sample",
    "start": "2281022",
    "end": "2287039"
  },
  {
    "text": "versus importance sampling. The question is, how do you\nmeasure the average depth",
    "start": "2287040",
    "end": "2293880"
  },
  {
    "text": "of the Nile River? And simple sampling\nis essentially, well, you know the Nile is in Africa,\nso you just walk around Africa",
    "start": "2293880",
    "end": "2302070"
  },
  {
    "text": "with a dipstick and you sort of\nmeasure how deep the Nile is. So of course, most of the\ntime you're not in the Nile,",
    "start": "2302070",
    "end": "2309819"
  },
  {
    "text": "so you get a lot of zeros. So what's a smarter\nway to do it? Well, a smarter ways\nto first find the Nile.",
    "start": "2309820",
    "end": "2318340"
  },
  {
    "text": "That's putting a\nbias on your sample. You really want to\nget to the Nile. And then once\nyou're in the Nile,",
    "start": "2318340",
    "end": "2323770"
  },
  {
    "text": "you want to stay in the Nile. So that means you still want to\nhave some amount of randomness to walk around in the\nNile, otherwise you're",
    "start": "2323770",
    "end": "2330490"
  },
  {
    "text": "not getting the average\ndepth of the Nile. But you want to be\nbiased, so you stay in it.",
    "start": "2330490",
    "end": "2336810"
  },
  {
    "text": "And that's the idea of\nimportance sampling. Remember, what is\nimportance sampling? You want to sample\nthe important states.",
    "start": "2336810",
    "end": "2343560"
  },
  {
    "text": "Those are the ones\nwith low energy. If you want to set up a\nthermodynamically-relevant",
    "start": "2343560",
    "end": "2350430"
  },
  {
    "text": "ensemble, obviously you\nknow that your system spends most of its time in\nthe states with low energy and then fluctuates around it.",
    "start": "2350430",
    "end": "2356610"
  },
  {
    "text": "So you want to get to the low\nenergy and stay around it. So you want a sample\nwith bias and then",
    "start": "2356610",
    "end": "2361830"
  },
  {
    "text": "correct your probabilities\nfor that bias. That's the whole idea. ",
    "start": "2361830",
    "end": "2371950"
  },
  {
    "text": "OK. So here's the idea of\nimportance sampling.",
    "start": "2371950",
    "end": "2378789"
  },
  {
    "text": "Remember, in a random\nsample, you pick randomly. And to average a\nproperty, you weigh",
    "start": "2378790",
    "end": "2386650"
  },
  {
    "text": "the property in each state\nwith the correct probability. Now, if you think about\nit, maybe the best",
    "start": "2386650",
    "end": "2393480"
  },
  {
    "text": "sample we could make-- couldn't we sample right\naway with that probability?",
    "start": "2393480",
    "end": "2399519"
  },
  {
    "text": "So could we sample with\na probability that's directly proportional to the\nreal probability the state",
    "start": "2399520",
    "end": "2405270"
  },
  {
    "text": "should have in the ensemble? So if you do that, if you\ncould sample these states",
    "start": "2405270",
    "end": "2410430"
  },
  {
    "text": "with the propr probability,\nthen their average is just determined by summing\nthem, by a trivial average.",
    "start": "2410430",
    "end": "2418317"
  },
  {
    "text": "So does everybody\nsee the difference? In simple sampling, you\nrandomly pick things. In importance sampling,\nyou right away",
    "start": "2418318",
    "end": "2423380"
  },
  {
    "text": "try to shoot for getting them\nwith the proper probability so the low energy state's a\nlot more than the high energy",
    "start": "2423380",
    "end": "2428559"
  },
  {
    "text": "state. Keep that in mind. There will be properties\nwhere you need the high energy states.",
    "start": "2428560",
    "end": "2434260"
  },
  {
    "text": "And then you're going to have\nto adjust your Monte Carlo sampling algorithm to go there.",
    "start": "2434260",
    "end": "2439360"
  },
  {
    "text": "Because in some cases\nmaybe some properties are determined by extreme\nin your distribution.",
    "start": "2439360",
    "end": "2445750"
  },
  {
    "text": "Maybe when it gets\nto a certain energy your system does\nsomething weird. If you want to\nsee that, then you",
    "start": "2445750",
    "end": "2451720"
  },
  {
    "text": "should bias your\nsystem towards there. But if we're interested in\njust thermodynamic behavior, we want to sample around\nthe energy minimum.",
    "start": "2451720",
    "end": "2460000"
  },
  {
    "text": "So there are various\nways that you can construct the\nprobability-weighted sample.",
    "start": "2460000",
    "end": "2467740"
  },
  {
    "text": "A common way is what's called\na metropolis algorithm. And this is the one\nwe'll use pretty much",
    "start": "2467740",
    "end": "2473500"
  },
  {
    "text": "exclusively in the [INAUDIBLE]. And the idea is\nthat you construct what's called a Markov\nchain, which is really",
    "start": "2473500",
    "end": "2480309"
  },
  {
    "text": "just a sequence of states,\nwhere, over a long time, if you",
    "start": "2480310",
    "end": "2486100"
  },
  {
    "text": "do it long enough,\nyou visit each state with the proper probability. So I'm going to\ndefine two quantities,",
    "start": "2486100",
    "end": "2492310"
  },
  {
    "text": "and then I'm going to tell you\nwhat rules they should obey. So obviously you have to\nstart with some state.",
    "start": "2492310",
    "end": "2498190"
  },
  {
    "text": "Well, in a metropolis\nalgorithm you can pick that state randomly. So I call that state i.",
    "start": "2498190",
    "end": "2503500"
  },
  {
    "text": "Then you have to pick a\nnew state called j from i.",
    "start": "2503500",
    "end": "2509050"
  },
  {
    "text": "And the rate at which\nwe pick that state I call omega 0 i to j.",
    "start": "2509050",
    "end": "2516880"
  },
  {
    "text": "But you don't always\naccept that state. You accept that with some\nprobability p i going to j.",
    "start": "2516880",
    "end": "2522940"
  },
  {
    "text": "So the total transfer rate, how\nmany times you pick j from i,",
    "start": "2522940",
    "end": "2528010"
  },
  {
    "text": "and put it in the Markov\nchain is determined by the product of these two. It's times you actually pick\nit as a possible transfer",
    "start": "2528010",
    "end": "2535780"
  },
  {
    "text": "state times the success\nrate in getting there. That's p i j. ",
    "start": "2535780",
    "end": "2555079"
  },
  {
    "text": "The two conditions that\na metropolis algorithm has to satisfy are\ntypically these two.",
    "start": "2555080",
    "end": "2560363"
  },
  {
    "text": "The first one isn't\nactually a real condition, it's just sort of a\npractical one to work with.",
    "start": "2560363",
    "end": "2565790"
  },
  {
    "text": "Usually people look\nfor what's called equal a priori probabilities.",
    "start": "2565790",
    "end": "2571220"
  },
  {
    "text": "What that means is that the\nrate at which you pick j froim i should be the same as the rate\nat which you pick i from j.",
    "start": "2571220",
    "end": "2578150"
  },
  {
    "text": "That's actually not\nabsolutely necessary. But if you don't satisfy this,\nyou have to correct later on.",
    "start": "2578150",
    "end": "2583820"
  },
  {
    "text": "And we'll do that two\nlectures from now-- we'll give you an example of that. But it's easiest to work with\nequal a priori probabilities.",
    "start": "2583820",
    "end": "2591650"
  },
  {
    "text": "In most this is a\ncondition that's amazingly easily satisfied. You'll see that.",
    "start": "2591650",
    "end": "2597230"
  },
  {
    "text": "Next lecture, we'll do some\nexamples of complicated Monte Carlo moves, and it's\nhard to violate this one.",
    "start": "2597230",
    "end": "2603530"
  },
  {
    "text": "You have to work on it. But it does happen. The more important one is\nwhat's called detailed balance.",
    "start": "2603530",
    "end": "2609620"
  },
  {
    "text": "Detailed balance is that the\nrate at which you actually transfer from i to jay and\nthe rate at which you transfer",
    "start": "2609620",
    "end": "2617210"
  },
  {
    "text": "from j to i has to be inversely\nproportional to the probability that you're in\nthe initial state.",
    "start": "2617210",
    "end": "2623280"
  },
  {
    "text": "So essentially the\nrate at which you go from i to j over the rate\nat which you go from j to i",
    "start": "2623280",
    "end": "2629570"
  },
  {
    "text": "has to equal p j over p i, or\nthese are the probabilities",
    "start": "2629570",
    "end": "2634820"
  },
  {
    "text": "that you are in that state. It's actually fairly\neasy to convince yourself that if that's true\nyou're going to end up",
    "start": "2634820",
    "end": "2643910"
  },
  {
    "text": "with a correct\nprobability distribution. I mean, think about it. If you look at this carefully,\nwhat is this really saying?",
    "start": "2643910",
    "end": "2651710"
  },
  {
    "text": "That if you were doing a lot\nof samplings in parallel,",
    "start": "2651710",
    "end": "2657440"
  },
  {
    "text": "this gives you a steady\nstate distribution of states. Because if you look\nat the left-hand side",
    "start": "2657440",
    "end": "2662660"
  },
  {
    "text": "of the green box, that's\nthe number of times you're going out if i into j.",
    "start": "2662660",
    "end": "2669480"
  },
  {
    "text": "Because it's the probability\nthat you're in i times the rate at which\nyou transfer to j.",
    "start": "2669480",
    "end": "2675580"
  },
  {
    "text": "And the right-hand\nside is the probability at the rate at which\nyou go from j to i.",
    "start": "2675580",
    "end": "2681740"
  },
  {
    "text": "Which is, first of all,\nyou have to be in j-- otherwise you can't\ngo from j to i-- times the rate W j i, the rate\nat which you go from j to i.",
    "start": "2681740",
    "end": "2692640"
  },
  {
    "text": "So when these two are\nequal, you sort of have a net zero flow\nof probability density.",
    "start": "2692640",
    "end": "2698890"
  },
  {
    "text": "So you have a steady\nstate distribution. If this holds for all\npair of states i j,",
    "start": "2698890",
    "end": "2704182"
  },
  {
    "text": "your probability distribution\nisn't changing anymore. So you end up with a\nsteady state distribution.",
    "start": "2704182",
    "end": "2709599"
  },
  {
    "start": "2709600",
    "end": "2725460"
  },
  {
    "text": "You can be fairly\ncreative about how you make metropolis algorithms.",
    "start": "2725460",
    "end": "2731910"
  },
  {
    "text": "But here's a very simple\none, which you'll often see a lot in a Monte Carlo codes.",
    "start": "2731910",
    "end": "2737760"
  },
  {
    "text": "So you first have to design some\npick rate, some rate at which",
    "start": "2737760",
    "end": "2745320"
  },
  {
    "text": "you choose new states for i. So that's omega 0.",
    "start": "2745320",
    "end": "2750390"
  },
  {
    "text": "So you have to\nhave some mechanism for picking potential moves.",
    "start": "2750390",
    "end": "2756109"
  },
  {
    "text": "So omega 0 i to j. And then you have to have\nan acceptance criteria.",
    "start": "2756110",
    "end": "2762140"
  },
  {
    "text": "And a typical\nacceptance criteria is that you accept the\nprobability from i to j is 1.",
    "start": "2762140",
    "end": "2768140"
  },
  {
    "text": "That means you definitely accept\nwhen the energy goes down-- so when the new state\nhas lower energy than i,",
    "start": "2768140",
    "end": "2774020"
  },
  {
    "text": "than the previous state. And if the new state has higher\nenergy than the initial state,",
    "start": "2774020",
    "end": "2780260"
  },
  {
    "text": "then you accept with\na Boltzmann factor. So then you accept with\na certain probability.",
    "start": "2780260",
    "end": "2787340"
  },
  {
    "text": "You can easily show that this\nsatisfies detailed balance. Because if you-- let's see if\nI can squeeze this in here.",
    "start": "2787340",
    "end": "2793220"
  },
  {
    "text": "Detailed balances that\nessentially p i p i to j",
    "start": "2793220",
    "end": "2798830"
  },
  {
    "text": "has to equal p j\np j to I. Well p i",
    "start": "2798830",
    "end": "2810710"
  },
  {
    "text": "is the exponential of minus beta\ni over the partition function.",
    "start": "2810710",
    "end": "2821670"
  },
  {
    "text": "p i to J, let's assume that i is\nthe state with low energy is 1. That has to equal p j,\nwhich is the exponential.",
    "start": "2821670",
    "end": "2830950"
  },
  {
    "text": "Sorry for my poor writing here. This pen is displaced\nfrom where I see it.",
    "start": "2830950",
    "end": "2838849"
  },
  {
    "text": "This is exponential\nminus beta E j over z,",
    "start": "2838850",
    "end": "2843920"
  },
  {
    "text": "times p i j, which\nis the exponential. I'm going to write\nit below here.",
    "start": "2843920",
    "end": "2849950"
  },
  {
    "text": "The exponential of\nminus beta Ei minus Ej.",
    "start": "2849950",
    "end": "2856280"
  },
  {
    "text": " This Ej cancels with\nthis one, and so you",
    "start": "2856280",
    "end": "2863430"
  },
  {
    "text": "get that the exponential\nis minus beta Ei equals the exponential minus beta Ei. So this set of transfer rates\nsatisfies detailed balance",
    "start": "2863430",
    "end": "2874150"
  },
  {
    "text": "in an almost trivial way.  So how would you\npractically implement",
    "start": "2874150",
    "end": "2880369"
  },
  {
    "text": "a metropolis algorithm\nfor sampling phase space? You would start with some\nconfiguration you would choose",
    "start": "2880370",
    "end": "2887300"
  },
  {
    "text": "a perturbation of the system. So that's essentially\ndetermine your mechanism for picking omega 0 i j.",
    "start": "2887300",
    "end": "2893660"
  },
  {
    "text": "You compute the energy\nfor that perturbation. If the change is negative,\nyou accept the perturbation.",
    "start": "2893660",
    "end": "2900880"
  },
  {
    "text": "If it's positive, you accept\nit with some probability. And then you go on and you\nchoose the next perturbation.",
    "start": "2900880",
    "end": "2907330"
  },
  {
    "text": "And so you essentially\ncycle this. So you build up a\nsequence of states. This is your sample.",
    "start": "2907330",
    "end": "2912880"
  },
  {
    "start": "2912880",
    "end": "2937170"
  },
  {
    "text": "This must be a Pentium 286.",
    "start": "2937170",
    "end": "2945430"
  },
  {
    "text": "It's checking the equations. That's-- OK.",
    "start": "2945430",
    "end": "2951190"
  },
  {
    "text": "So what you will get\nthen is some property as a function of sample\nsize or sampling,",
    "start": "2951190",
    "end": "2957980"
  },
  {
    "text": "which is often called\nMonte Carlo time. Which is very confusing,\nbecause this is not",
    "start": "2957980",
    "end": "2963340"
  },
  {
    "text": "a dynamical trajectory. You could think of it as a\ntrajectory through phase space,",
    "start": "2963340",
    "end": "2969700"
  },
  {
    "text": "but there's nothing\nhere that says that it's a dynamical trajectory. I'm going to later\nconfuse you even more",
    "start": "2969700",
    "end": "2975190"
  },
  {
    "text": "and talk about what's called\nkinetic Monte Carlo, which is a way of mimicking\ndynamics with Monte Carlo.",
    "start": "2975190",
    "end": "2981520"
  },
  {
    "text": "But standard Monte\nCarlo simply has nothing to do with kinetics. It's an efficient way\nto sample phase space.",
    "start": "2981520",
    "end": "2988160"
  },
  {
    "text": "So you'll go through\nsome property, and then you just essentially\ntrack the average.",
    "start": "2988160",
    "end": "2995740"
  },
  {
    "text": "Typically what people\ndo is they often, just for practical\nconsideration, cut off the first\npart and remove it.",
    "start": "2995740",
    "end": "3002280"
  },
  {
    "text": "Because, remember, you\nstarted with a random state. You may be very far away\nfrom the low energy state.",
    "start": "3002280",
    "end": "3009869"
  },
  {
    "text": "And so by cutting that off,\nthe first part, you often get a much faster\nrelaxation of the average.",
    "start": "3009870",
    "end": "3017580"
  },
  {
    "text": "Because the initial\nstate may have really very high energy and\nthereby some weird property.",
    "start": "3017580",
    "end": "3024330"
  },
  {
    "text": "And so you only start\nsampling after the system has relaxed towards the minimum.",
    "start": "3024330",
    "end": "3030360"
  },
  {
    "text": "So you often talk about,\nin Monte Carlo, people using a certain amount\nof equilibration passes",
    "start": "3030360",
    "end": "3035550"
  },
  {
    "text": "and after a certain\namount of sampling passes. And you only average\nover the sampling pass. ",
    "start": "3035550",
    "end": "3044520"
  },
  {
    "text": "So let's go through this for\nthe very simple magnetic model. How will you do it in a magnetic\nmodel, in a simple Ising model?",
    "start": "3044520",
    "end": "3052280"
  },
  {
    "text": "You could randomly\ninitialize the spin. You could start with that. You could also start with a\nferromagnetic configuration.",
    "start": "3052280",
    "end": "3058170"
  },
  {
    "text": "The closer you start to\nyour equilibrium state, the faster this is going to go.",
    "start": "3058170",
    "end": "3063180"
  },
  {
    "text": "An obvious perturbation\nis you pick a spin and you flip it over. So if it was up,\nyou make it down.",
    "start": "3063180",
    "end": "3069599"
  },
  {
    "text": "If it was down, you make it up. Calculate the energy\nfor perturbation. If it goes down, you accept it.",
    "start": "3069600",
    "end": "3075369"
  },
  {
    "text": "If it doesn't, you accept\nit with a certain Boltzman probability and you go back. And as you can see, you\ncan do this very fast.",
    "start": "3075370",
    "end": "3082610"
  },
  {
    "text": "If you think of computer\ncode now, how you write this, these are trivial operations.",
    "start": "3082610",
    "end": "3088099"
  },
  {
    "text": "You have to calculate\na random number to randomly pick a\nspin in the lattice, or two if it's a\ntwo dimensional.",
    "start": "3088100",
    "end": "3094298"
  },
  {
    "text": "You have to compute the\nenergy, but your Hamiltonian is just like j sigma i sigma j. That goes really fast.",
    "start": "3094298",
    "end": "3099720"
  },
  {
    "text": "It's like multiplying\na few numbers. And then you have to compute\nthat exponential also.",
    "start": "3099720",
    "end": "3105090"
  },
  {
    "text": "So you can cycle this through\nliterally millions of times per second on a modern computer.",
    "start": "3105090",
    "end": "3112109"
  },
  {
    "text": "Even on a very basic\ncomputer, if you did just this\ntwo-dimensional Ising model, if you coded it well, you\ncould do probably 50 million",
    "start": "3112110",
    "end": "3119400"
  },
  {
    "text": "of these per second. So that's how fast you can\nsample through your ensemble. ",
    "start": "3119400",
    "end": "3127980"
  },
  {
    "text": "So here's what comes out. Here's real output. So this is the 2D square\nlattice model I showed you.",
    "start": "3127980",
    "end": "3136589"
  },
  {
    "text": "The temperature is in\nunits of j over k-- so the interaction constant\nor the Boltzmann constant.",
    "start": "3136590",
    "end": "3142270"
  },
  {
    "text": "So kT over j equals 2, that's\nactually below the period temperature of this model.",
    "start": "3142270",
    "end": "3147670"
  },
  {
    "text": "So this is a\nferromagnetic model. And so if you heat it up,\nit would go paramagnetic",
    "start": "3147670",
    "end": "3153420"
  },
  {
    "text": "at some point. This is still below that\ntemperature, but it's not far. The transition temperature\nwould be about 2.23",
    "start": "3153420",
    "end": "3161010"
  },
  {
    "text": "or something like that,\n2.24 in this model. So you're below the paramagnetic\ntransition temperature,",
    "start": "3161010",
    "end": "3166180"
  },
  {
    "text": "but not much. So I started it up\nrandomly I think.",
    "start": "3166180",
    "end": "3171900"
  },
  {
    "text": "And so the energy\nis sort of high. It kind of fluctuates\nfor a while and then starts going down.",
    "start": "3171900",
    "end": "3177700"
  },
  {
    "text": "And here it seems to\nhave relaxed fairly well, and then it just kind of\nfluctuates around the average.",
    "start": "3177700",
    "end": "3184920"
  },
  {
    "text": "And you average this and\nyou'd get the energy. If you want to know\nthe magnetization,",
    "start": "3184920",
    "end": "3192089"
  },
  {
    "text": "well, you would keep track\nof the magnetization, which is sort of the difference\nbetween how much up spin do I have and how much\ndown spin do I have.",
    "start": "3192090",
    "end": "3198390"
  },
  {
    "text": "You track that, and\nthis is that quantity as a function of\ntemperature, and see it's clearly ferromagnetic.",
    "start": "3198390",
    "end": "3204299"
  },
  {
    "text": "You have preferred up spin. It slowly goes down\nwith temperature.",
    "start": "3204300",
    "end": "3209860"
  },
  {
    "text": "And then this is the\ntransition temperature. It's the paramagnetic\ntransition temperature, beautiful second-order\ntransition.",
    "start": "3209860",
    "end": "3217990"
  },
  {
    "text": "So just to give an idea,\ndoing this with Monte Carlo is a one-page code without\nthe bells and whistles.",
    "start": "3217990",
    "end": "3224830"
  },
  {
    "text": "And it runs before you blink. I mean, it's so fast that\nyou would sample this.",
    "start": "3224830",
    "end": "3232730"
  },
  {
    "text": "OK. How do you detect\nphase transitions?",
    "start": "3232730",
    "end": "3238170"
  },
  {
    "text": "This is sort of a critical\nissue in any simulation method to be honest.",
    "start": "3238170",
    "end": "3243720"
  },
  {
    "text": "Whether you do Monte Carlo\nor molecular dynamics, it's one thing to\nlook at the atoms, and it's another thing to figure\nout exactly what they're doing.",
    "start": "3243720",
    "end": "3252270"
  },
  {
    "text": "You may have seen that\nif you try to do things like melting with\nmolecular dynamics, it's not trivial to exactly\nfind where the atoms melt.",
    "start": "3252270",
    "end": "3259621"
  },
  {
    "text": "Because what do you do? You just stare at them. But it seems kind of a fairly\nrandom decision about--",
    "start": "3259622",
    "end": "3266130"
  },
  {
    "text": "let's say I gave you\nthis lattice model, and I asked you, where\ndoes it become disordered?",
    "start": "3266130",
    "end": "3273050"
  },
  {
    "text": "Where is the paramagnetic\ntransition temperature? You could just\nstare at the spins.",
    "start": "3273050",
    "end": "3278070"
  },
  {
    "text": "But I'll tell you, when you're\nclose to that transition, just below and just above,\nit looks pretty similar. And one is still the\nferromagnetic phase.",
    "start": "3278070",
    "end": "3284640"
  },
  {
    "text": "The other one's the\nantiferromagnetic phase. So you need a more\nsystematic way of looking at phase transitions.",
    "start": "3284640",
    "end": "3289930"
  },
  {
    "text": "And the beauty is\nyou can do that through the thermodynamic\nquantities you sampled. If you sample the\nenergy, you typically",
    "start": "3289930",
    "end": "3297619"
  },
  {
    "text": "use the fact that the\nenergy is discontinuous at first-order transitions. It's not so at\nsecond-order transitions.",
    "start": "3297620",
    "end": "3305050"
  },
  {
    "text": "If you work at constant\nchemical potential-- and I'll come to that later. It's often a useful thing\nto do in Monte Carlo.",
    "start": "3305050",
    "end": "3310440"
  },
  {
    "text": "it tends to equilibrate faster-- you will have concentration\ndiscontinuities at first-order transition.",
    "start": "3310440",
    "end": "3316625"
  },
  {
    "text": " Another thing to usually\ntrack is the heat capacity",
    "start": "3316625",
    "end": "3322460"
  },
  {
    "text": "of the system. The heat capacity is the\nfluctuation of the energy.",
    "start": "3322460",
    "end": "3327800"
  },
  {
    "text": "If you go back-- can I go back? ",
    "start": "3327800",
    "end": "3333730"
  },
  {
    "text": "The heat capacity is\nessentially a measure of how much you fluctuate\naround the average.",
    "start": "3333730",
    "end": "3339280"
  },
  {
    "text": "It's your sigma squared. ",
    "start": "3339280",
    "end": "3344457"
  },
  {
    "text": "So the heat capacity is\ndefined as the fluctuation of the energy-- so E\nsquared average minus E average squared.",
    "start": "3344457",
    "end": "3351640"
  },
  {
    "text": "That tends to show singularities\nat second-order transitions. But it's even useful often to\nspot first-order transitions,",
    "start": "3351640",
    "end": "3358300"
  },
  {
    "text": "even though it's a\nlittle harder to. I'll show you a lot of sort\nof case studies and examples on more complicated\nsystems later on.",
    "start": "3358300",
    "end": "3365411"
  },
  {
    "text": "But for example, here's\nthe heat capacity of that 2D model as a function\nof normalized temperature.",
    "start": "3365412",
    "end": "3372360"
  },
  {
    "text": "So notice how the heat\ncapacity the transition is here of course,\nabout 2.24 or so.",
    "start": "3372360",
    "end": "3378180"
  },
  {
    "text": "[INAUDIBLE] has a\nbeautiful singularity. This is actually a logarithmic\ndivergence to infinity.",
    "start": "3378180",
    "end": "3383800"
  },
  {
    "text": "So you can't miss\nthis transition. Even if you tried,\nyou wouldn't miss it.",
    "start": "3383800",
    "end": "3389800"
  },
  {
    "text": " There's a great Java\nprogram on the web that",
    "start": "3389800",
    "end": "3397069"
  },
  {
    "text": "does two-dimensional\nlattice files if you want to play with it. And you can literally type in\ntemperatures and interaction",
    "start": "3397070",
    "end": "3403130"
  },
  {
    "text": "strength, and it just\nsimulates on the screen for you and plots like\nthermodynamic quantities.",
    "start": "3403130",
    "end": "3408960"
  },
  {
    "text": "Pretty cool.  OK. ",
    "start": "3408960",
    "end": "3416559"
  },
  {
    "text": "So in the last\nbit of time I want to go through some variants\nof this lattice model, how",
    "start": "3416560",
    "end": "3423220"
  },
  {
    "text": "we use it for other fields. And then, in the next\nlecture, I'll pick up on that. ",
    "start": "3423220",
    "end": "3430150"
  },
  {
    "text": "Like I said before, you\ncan use this for anything that has essentially two\nstates on a fixed topology.",
    "start": "3430150",
    "end": "3438920"
  },
  {
    "text": "So like I said, you could use it\nfor A and B atoms on a lattice. It's very often used for\nsurface absorption as well.",
    "start": "3438920",
    "end": "3446420"
  },
  {
    "text": "If you say you have a surface-- let's say this is a\ntriangular lattice,",
    "start": "3446420",
    "end": "3451888"
  },
  {
    "text": "so that could be the\nsurface sites on a 1 1 1 FCC metal, like\nplatinum or palladium.",
    "start": "3451888",
    "end": "3458710"
  },
  {
    "text": "If stuff can absorb\non the lattice side-- now you can really see that\nmy pen is miscalibrated.",
    "start": "3458710",
    "end": "3467049"
  },
  {
    "text": "I'm drawing on\nthe latest points. So if you want to\nknow if stuff absorbs,",
    "start": "3467050",
    "end": "3473250"
  },
  {
    "text": "well, you see that\nbecomes a binary problem. At each site you want\nto know, is there an absorbent there or not?",
    "start": "3473250",
    "end": "3479440"
  },
  {
    "text": "So you can define a binary\nvariable and whether it's plus or minus 1 doesn't matter. People often write things\nin not spin variables",
    "start": "3479440",
    "end": "3488160"
  },
  {
    "text": "but occupation variables,\nwhich are maybe a little more natural. They're mathematically\nless elegant,",
    "start": "3488160",
    "end": "3494460"
  },
  {
    "text": "but you could say the\noccupation variable is 1 when the side is occupied\nand is 0 when the side is not.",
    "start": "3494460",
    "end": "3500490"
  },
  {
    "text": "The advantage then is that\nyou only get interaction when two things are occupied.",
    "start": "3500490",
    "end": "3507930"
  },
  {
    "text": "So one occupied side\nwith one occupied side gives you no contribution\nto the Hamiltonian,",
    "start": "3507930",
    "end": "3513780"
  },
  {
    "text": "because one of the p i's is 0. Whereas if you use spins,\nthen this is a plus 1,",
    "start": "3513780",
    "end": "3520060"
  },
  {
    "text": "and this is minus 1. So it gives you a contribution\nto the Hamiltonian. Mathematically it all\nworks out, but it's",
    "start": "3520060",
    "end": "3525520"
  },
  {
    "text": "a little more confusing.  So you can even write that\nout for a binary alloy.",
    "start": "3525520",
    "end": "3533570"
  },
  {
    "text": "You can sum over the probability\nthat you have A B bonds on i j and multiply with\nthe A B interaction.",
    "start": "3533570",
    "end": "3540530"
  },
  {
    "text": "You can get the\nprobability that it's A A and multiply it with\nthe AA interaction,",
    "start": "3540530",
    "end": "3546380"
  },
  {
    "text": "and you get the probability\nthat it's B B and multiply with the B B interaction. ",
    "start": "3546380",
    "end": "3556630"
  },
  {
    "text": "OK.  I think the coolest\nthing about Monte Carlo",
    "start": "3556630",
    "end": "3562890"
  },
  {
    "text": "is that you have anomalous\ndegrees of freedom about the moves you do.",
    "start": "3562890",
    "end": "3568704"
  },
  {
    "text": "These are essentially\nthe perturbations you attempt to get to the next\nstate in the Markov chain.",
    "start": "3568705",
    "end": "3574870"
  },
  {
    "text": "And the one thing\nyou should never do is let yourself be guided\nthere or constrained",
    "start": "3574870",
    "end": "3580450"
  },
  {
    "text": "by physical principles. People often do moves that\nthey think are physical.",
    "start": "3580450",
    "end": "3586990"
  },
  {
    "text": "But remember, it's not the\npoint to do a physical move. The point is to efficiently\nsample phase space.",
    "start": "3586990",
    "end": "3593270"
  },
  {
    "text": "And so on the spin\nmodel, well, you think, a spin going\nfrom up to down or vice versa is\na physical move.",
    "start": "3593270",
    "end": "3599710"
  },
  {
    "text": "Spins flip up and\ndown all the time. But in some cases,\nfor example, it's much more efficient to flip\nover whole patches of spin.",
    "start": "3599710",
    "end": "3607300"
  },
  {
    "text": "When you're near a second-order\ntransition in a material, the fluctuations in the\nsystem are very long range.",
    "start": "3607300",
    "end": "3614260"
  },
  {
    "text": "So it's sort of like\nthe wind blowing to a wheat field or something. There are whole patches of\nspin that move together.",
    "start": "3614260",
    "end": "3621230"
  },
  {
    "text": "So you'll get much\nbetter convergence there if you flip whole\npatches of spin. So rather than\nattempting one at a time,",
    "start": "3621230",
    "end": "3626980"
  },
  {
    "text": "you could say I'm going to\nattempt 10 at a time close to each other.",
    "start": "3626980",
    "end": "3632900"
  },
  {
    "text": "So you can always\npick your dynamic. So I've given you an example. Here's an example of\ntwo types of dynamics.",
    "start": "3632900",
    "end": "3638560"
  },
  {
    "text": "Let's say you have A and\nB atoms on a lattice. ",
    "start": "3638560",
    "end": "3644170"
  },
  {
    "text": "So if you want to\nequilibrate that, you could pick the\nobvious dynamics. You could interchange A and\nB. So if you have a lot of us",
    "start": "3644170",
    "end": "3652750"
  },
  {
    "text": "and you have A here and B here,\nyou could interchange them. That could be a possible move.",
    "start": "3652750",
    "end": "3660010"
  },
  {
    "text": "And it's sort of\nan obvious move, because it sort of\nmimics diffusion. Atoms interchange and\nequilibrate like that.",
    "start": "3660010",
    "end": "3666700"
  },
  {
    "text": "That's called Glauber\ndynamics on the lattice model. Turns out that that's useful,\nbut a much faster move",
    "start": "3666700",
    "end": "3676119"
  },
  {
    "text": "to equilibrate is\nactually exchanging the identity of the atoms. So rather than interchanging A\nand B at different positions,",
    "start": "3676120",
    "end": "3683380"
  },
  {
    "text": "you take an atom, and if it's\nA, you try to turn it into B. And if it's B,\nyou try to turn it into A. That's called\nKawasaki dynamics.",
    "start": "3683380",
    "end": "3693520"
  },
  {
    "text": "Now, you see that if you\ndo Kawasaki dynamics, you will need some kind\nof chemical potential.",
    "start": "3693520",
    "end": "3699660"
  },
  {
    "text": "Because in Glauber\ndynamics, you constrain-- the composition is fixed. You just interchange the\npositions of the A and B,",
    "start": "3699660",
    "end": "3706700"
  },
  {
    "text": "but you're not changing\nthe number of A or B. You conserve the concentration.",
    "start": "3706700",
    "end": "3712580"
  },
  {
    "text": "In Kawasaki dynamics, you don't\nchange the number of particles, but you do change the\nconcentration of the A and B",
    "start": "3712580",
    "end": "3719210"
  },
  {
    "text": "species. Because whenever I flip A to B,\nI'm changing the concentration. So you will need some kind\nof chemical potential term",
    "start": "3719210",
    "end": "3725480"
  },
  {
    "text": "in your Hamiltonian, and\nthat chemical potential term is the difference in chemical\npotentials of A and B.",
    "start": "3725480",
    "end": "3731120"
  },
  {
    "text": "So that difference will\ndrive the concentration. So it's essentially\nmultiplied with--",
    "start": "3731120",
    "end": "3736220"
  },
  {
    "text": "this is essentially\nthe concentration. It's the sum of the probability\nthat you have A on each side.",
    "start": "3736220",
    "end": "3741800"
  },
  {
    "text": "That's essentially\nthe concentration. OK. You'll find that Kawasaki\ndynamics equilibrates 100 times",
    "start": "3741800",
    "end": "3750190"
  },
  {
    "text": "faster easily in many cases. The reason is that, if you\nthink about it, if you started",
    "start": "3750190",
    "end": "3756850"
  },
  {
    "text": "with a situation where you had\ntoo much A in one area and too",
    "start": "3756850",
    "end": "3762640"
  },
  {
    "text": "much B in another, if\nyou do Glauber dynamics, you can really only\nequilibrate that system by slowly diffusing these.",
    "start": "3762640",
    "end": "3769710"
  },
  {
    "text": "A has to go this way,\nB has to go that way. In Kawasaki dynamics, the\nA here feels right away",
    "start": "3769710",
    "end": "3776901"
  },
  {
    "text": "that there's too\nmuch of it, and it starts turning to B. The B\nhere starts turning to A, and you're done.",
    "start": "3776902",
    "end": "3782860"
  },
  {
    "text": "So it tends to be a\nmuch more efficient way. This is sort of a generic thing. Open systems tend to equilibrate\nfaster than closed systems.",
    "start": "3782860",
    "end": "3793220"
  },
  {
    "text": "So if you can at all\nmake your system open and end up with the same end\nresult, it'll go much faster.",
    "start": "3793220",
    "end": "3799970"
  },
  {
    "text": "And it's essentially because\nyou give open systems more degrees of freedom.",
    "start": "3799970",
    "end": "3805220"
  },
  {
    "text": "You can change the\nchemistry of them. ",
    "start": "3805220",
    "end": "3810250"
  },
  {
    "text": "Yes. AUDIENCE: I mean, principally\n[INAUDIBLE] complexity of the system. First of all, you're\ngetting [INAUDIBLE]..",
    "start": "3810250",
    "end": "3817702"
  },
  {
    "text": "GERBRAND CEDER: Not in\nthe thermodynamic limit. That's sort of an idea\nof statistical mechanics is that you get\nthe same averages.",
    "start": "3817702",
    "end": "3824754"
  },
  {
    "text": "AUDIENCE: [INAUDIBLE]. ",
    "start": "3824754",
    "end": "3831250"
  },
  {
    "text": "GERBRAND CEDER: You can. But but you still-- so that'll definitely\nmake it go faster if you do random exchanges,\nbut you still lose efficiency.",
    "start": "3831250",
    "end": "3841790"
  },
  {
    "text": "I'll tell you why. First of all, you have to\npick a dissimilar pair.",
    "start": "3841790",
    "end": "3848430"
  },
  {
    "text": "So if you think about\nit, half of the time you'll pick a similar pair. So you will pick\nA here and A here,",
    "start": "3848430",
    "end": "3854463"
  },
  {
    "text": "and so you have to\ngive up on that move, because it's not\ngoing to do anything. So that's one thing. That's not a major thing.",
    "start": "3854463",
    "end": "3861900"
  },
  {
    "text": "But the fact that you can\nfluctuate the concentration of your system\nwill in many cases",
    "start": "3861900",
    "end": "3867090"
  },
  {
    "text": "still allow you to\nequilibrate faster. OK. And usually this is not--",
    "start": "3867090",
    "end": "3876348"
  },
  {
    "text": "it's a good thing\nyou pointed it out, because I haven't\ntalked about it. ",
    "start": "3876348",
    "end": "3881779"
  },
  {
    "text": "The choice of the\nensemble should not matter for thermodynamic\nproperties.",
    "start": "3881780",
    "end": "3889220"
  },
  {
    "text": "So any time you're\ndoing something with periodic\nboundary conditions and your objective is to\nstudy the bulk of something,",
    "start": "3889220",
    "end": "3895970"
  },
  {
    "text": "you're OK. When you go to finite systems-- you're studying, I don't\nknow, the thermodynamics",
    "start": "3895970",
    "end": "3901600"
  },
  {
    "text": "of nanoparticles-- then\nthe ensembles do matter. ",
    "start": "3901600",
    "end": "3907010"
  },
  {
    "text": "The problem that\nyou run into there is that it's not obvious\nwhat the right ensemble is. Like if you study a\nnanoparticle, now you have to--",
    "start": "3907010",
    "end": "3915730"
  },
  {
    "text": "there is essentially\nno thermodynamic limit of a nanoparticle. It's a finite system\nby definition.",
    "start": "3915730",
    "end": "3921063"
  },
  {
    "text": "And you just have to\nsort of figure out, can it exchange things within\nthe environment or not.",
    "start": "3921063",
    "end": "3926400"
  },
  {
    "text": "But in general, the choice of\nthe ensemble doesn't matter. Let me sort of skip this. ",
    "start": "3926400",
    "end": "3935830"
  },
  {
    "text": "I've given you examples on\na lattice model right now. But you can, of course, do\noff-lattice Monte Carlo.",
    "start": "3935830",
    "end": "3943360"
  },
  {
    "text": "For example, this the\nexample of a liquid. Let's say a liquid is a\nbunch of atoms in a box.",
    "start": "3943360",
    "end": "3948579"
  },
  {
    "text": "And again you could study the\nelectrodynamics and track them. You could also get their\nthermodynamic averages just by sampling all\nthe possible positions",
    "start": "3948580",
    "end": "3955480"
  },
  {
    "text": "of the atoms.  So which perturbations\nwould you pick?",
    "start": "3955480",
    "end": "3961289"
  },
  {
    "text": "Again, anything that's\nconsistent with the degrees of freedom of your\nensemble is fine.",
    "start": "3961290",
    "end": "3967100"
  },
  {
    "text": "So here an obvious way to do\nthis would be pick an atom and you then pick a random\ndisplacement vector.",
    "start": "3967100",
    "end": "3975579"
  },
  {
    "text": "So you say, I'm going to pick\na random displacement vector, and that's my perturbation. I calculate the energy,\nit goes down, I accept.",
    "start": "3975580",
    "end": "3982900"
  },
  {
    "text": "If it doesn't, I\ndon't accept it. OK. The question is, do you truly\npick this displacement vector",
    "start": "3982900",
    "end": "3993180"
  },
  {
    "text": "random? But what about its magnitude? You probably pick its\norientation random,",
    "start": "3993180",
    "end": "3998890"
  },
  {
    "text": "but what about its magnitude? Do you pick it out of\nthe whole box length?",
    "start": "3998890",
    "end": "4004070"
  },
  {
    "text": "Do you pick it out of\na very small length? So typically you'll\ndo it somehow, like you pick a delta\nx-coordinate out of range--",
    "start": "4004070",
    "end": "4013550"
  },
  {
    "text": "call it minus a over\n2 to plus a over 2,",
    "start": "4013550",
    "end": "4020560"
  },
  {
    "text": "and then the same\nfor a delta y and z-- and then you randomly\npick a coordinate",
    "start": "4020560",
    "end": "4026410"
  },
  {
    "text": "in that range for x, y, and z. But the question is,\nwhat do you take A?",
    "start": "4026410",
    "end": "4033410"
  },
  {
    "text": "If you take A really\nbig, you're not going to accept a lot\nof your perturbations.",
    "start": "4033410",
    "end": "4038869"
  },
  {
    "text": "Because if you take A of\nthe order of the box length, then many times if\nthis is a dense liquid",
    "start": "4038870",
    "end": "4044510"
  },
  {
    "text": "your atoms is going\nto end up very much on top of something else. The density of liquids is what?",
    "start": "4044510",
    "end": "4051080"
  },
  {
    "text": "In many cases, 10%\nless than a solid. At best they're still dense. So most space is\nfilled by atoms.",
    "start": "4051080",
    "end": "4059830"
  },
  {
    "text": "So if you take A\nvery big, you're going to sort of\nequilibrate in principle",
    "start": "4059830",
    "end": "4065850"
  },
  {
    "text": "the composition easily-- I mean the density-- but you're not going to\naccept a lot of your moves.",
    "start": "4065850",
    "end": "4072180"
  },
  {
    "text": "So you say, well then, the\nsolution is I pick A small. But if you pick A too small,\nthen you're probably going--",
    "start": "4072180",
    "end": "4080120"
  },
  {
    "text": "you have a high acceptance rate. So if you just displace A-- if A is like 100 of an\nAngstrom, then you're",
    "start": "4080120",
    "end": "4088470"
  },
  {
    "text": "atom is just moving\na very little bit. So most time, you're\ngoing to accept it. But what's the problem now\nis you have high degree",
    "start": "4088470",
    "end": "4094349"
  },
  {
    "text": "of correlation in your average. Essentially all the states\nyou put in your Markov chain look all the same.",
    "start": "4094350",
    "end": "4100790"
  },
  {
    "text": "If you barely this place your\natom, they all look the same. So it's going to take a really\nlong time to get good averages.",
    "start": "4100790",
    "end": "4106880"
  },
  {
    "text": "Actually, you could almost\nthink of Monte Carlo with very small perturbations\non the system,",
    "start": "4106880",
    "end": "4112818"
  },
  {
    "text": "it's almost like\nmolecular dynamics. It's like the atoms\nsort of move slowly",
    "start": "4112819",
    "end": "4117950"
  },
  {
    "text": "with a kind of random\nforce, but they still move slowly along trajectories\nand are real trajectories, but they don't wildly\ngo through phase space.",
    "start": "4117950",
    "end": "4126368"
  },
  {
    "text": "The nice thing about\nmodels like this is that you can actually,\nduring the simulation, adjust A.",
    "start": "4126368",
    "end": "4131930"
  },
  {
    "text": "And this is often what's done. Often people will adjust\nit so that they get a reasonable acceptance rate.",
    "start": "4131930",
    "end": "4138049"
  },
  {
    "text": "If you set A too big, then\nyou get low acceptance rate. If you set A too small, you get\na high acceptance rate people.",
    "start": "4138050",
    "end": "4145009"
  },
  {
    "text": "Typically shoot for\nanywhere from 0.3 to 0.5 acceptance rate. So you want to be somewhere\nwhere the order of a 1/3 to 1/2",
    "start": "4145010",
    "end": "4152810"
  },
  {
    "text": "of the moves you\ntry are accepted. Because if they\ndon't get accepted, you're wasting all your\neffort calculating energies.",
    "start": "4152810",
    "end": "4160200"
  },
  {
    "text": "And this depends a\nlittle bit on the cost of your energy function. If you're doing this\nwith quantum mechanics,",
    "start": "4160200",
    "end": "4167337"
  },
  {
    "text": "then you really want to\noptimize your Monte Carlo moves, because any energy evaluation\ncosts you a lot of time.",
    "start": "4167337",
    "end": "4173729"
  },
  {
    "text": "If you're doing this with\nmaybe some simple hard sphere model or something, you can\nafford to have a lot of moves--",
    "start": "4173729",
    "end": "4180720"
  },
  {
    "text": "calculate a lot of energies\non which you don't execute. ",
    "start": "4180720",
    "end": "4195770"
  },
  {
    "text": "So the last thing\nI want to say is, how do you pick random numbers? How do you implement\nprobabilities?",
    "start": "4195770",
    "end": "4203120"
  },
  {
    "text": "Because it's sort of not\nobvious in a computer. Computers are not probabilistic.",
    "start": "4203120",
    "end": "4208640"
  },
  {
    "text": "And that's done by\nrandom number generation. Sort of maybe obvious, but\nI want to show it anyway.",
    "start": "4208640",
    "end": "4216469"
  },
  {
    "text": "So remember, what\nyou want to do is you want to implement a move\nwith a given probability",
    "start": "4216470",
    "end": "4222410"
  },
  {
    "text": "with this Boltzmann factor. Remember, if delta\nE is positive, that Boltzmann factor\nis between 0 and 1.",
    "start": "4222410",
    "end": "4229160"
  },
  {
    "text": "So let's say this is the value. Well, what you do is you pick\nrandom numbers between 0 and 1.",
    "start": "4229160",
    "end": "4234770"
  },
  {
    "text": " And what's the probability\nthat the random number",
    "start": "4234770",
    "end": "4240490"
  },
  {
    "text": "is less than this exponential? Well, that probability is that\nexponential of minus beta E i.",
    "start": "4240490",
    "end": "4247540"
  },
  {
    "text": "We'll call this p i. If you take a random\nnumber and the probability",
    "start": "4247540",
    "end": "4253020"
  },
  {
    "text": "that that random number\nis below p i is p i.",
    "start": "4253020",
    "end": "4258140"
  },
  {
    "text": "So you pick the random number\nif it's below that exponential.",
    "start": "4258140",
    "end": "4263880"
  },
  {
    "text": "You execute. If it's above that\nexponential, you don't execute. So you execute now with\nthe correct probability.",
    "start": "4263880",
    "end": "4269430"
  },
  {
    "text": "So random numbers give you a way\nof implementing probabilities.",
    "start": "4269430",
    "end": "4275570"
  },
  {
    "text": "There's a few caveats. A lot of cheap random\nnumber generators are not at all random.",
    "start": "4275570",
    "end": "4282050"
  },
  {
    "text": "I used to not believe\nthis until I tried it. I always thought that was kind\nof like people write books",
    "start": "4282050",
    "end": "4287540"
  },
  {
    "text": "and they just talk about\nit because it's kind of cool to say how non-random. They actually are\nvery non-random.",
    "start": "4287540",
    "end": "4294560"
  },
  {
    "text": "You will often find\nthat if you plot the density of random\nnumbers you generate,",
    "start": "4294560",
    "end": "4301250"
  },
  {
    "text": "that there are\ndiscrete holes where you have very little coverage. And it's because of the sort\nof fractional algorithms",
    "start": "4301250",
    "end": "4307678"
  },
  {
    "text": "by which they work. In many cases, that\nreally doesn't matter. For a lot of practical\nthings, it doesn't matter.",
    "start": "4307678",
    "end": "4314650"
  },
  {
    "text": "I'll tell you where\nI've seen it matter. It matters when you're in this\nregime here, really close to 0.",
    "start": "4314650",
    "end": "4323230"
  },
  {
    "text": "Because essentially,\na random number generator, the way it generates\nrandom numbers between 0 and 1--",
    "start": "4323230",
    "end": "4328420"
  },
  {
    "text": "it doesn't do it\nbetween 0 and 1. It generates between 0-- or is it-- between 0 or 1.",
    "start": "4328420",
    "end": "4334943"
  },
  {
    "text": "No, between 1 and some integer. No, sorry, between 0 and\nsome maximum integer, like 2",
    "start": "4334943",
    "end": "4339969"
  },
  {
    "text": "to the 16 or\nsomething like that. And then it divides by 2 to 16.",
    "start": "4339970",
    "end": "4344980"
  },
  {
    "text": "And that's how you get\nit between 0 and 1. But that means your\nset is discretized.",
    "start": "4344980",
    "end": "4351130"
  },
  {
    "text": "So often what's important\nis the spacing between 0",
    "start": "4351130",
    "end": "4356409"
  },
  {
    "text": "and the smallest random number. Because if you work\nwith very high energy",
    "start": "4356410",
    "end": "4363520"
  },
  {
    "text": "barriers, very high\nenergy excitations, they fall in that first gap.",
    "start": "4363520",
    "end": "4368590"
  },
  {
    "text": "And so you have a completely\ndiscretized probability there.",
    "start": "4368590",
    "end": "4374230"
  },
  {
    "text": "And there are problems. It's the kind of thing I\nthought I'd never run into, and I've actually run\ninto several times",
    "start": "4374230",
    "end": "4380830"
  },
  {
    "text": "within that\n[INAUDIBLE] research.  If your system is\nstuck and it doesn't",
    "start": "4380830",
    "end": "4387760"
  },
  {
    "text": "have a lot of low\nenergy excitations left, it tends to execute high\nenergy excitations with a way",
    "start": "4387760",
    "end": "4393430"
  },
  {
    "text": "too higher probability. Because think about it-- if the biggest number\nis 2 to the 16th,",
    "start": "4393430",
    "end": "4399330"
  },
  {
    "text": "your random number hits 0\nwith a probability of 1 over 2",
    "start": "4399330",
    "end": "4404630"
  },
  {
    "text": "to the 16th. That's way too high. It should be 1 over infinity.",
    "start": "4404630",
    "end": "4410190"
  },
  {
    "text": "You should hit 0 with a\nrate of 1 over infinity if you had a perfect\ncontinue of random numbers,",
    "start": "4410190",
    "end": "4416340"
  },
  {
    "text": "but you hit 0 with a\nrate 1 over 2 to the 16. That means if you hit\nthat random number you",
    "start": "4416340",
    "end": "4423120"
  },
  {
    "text": "execute any move, even\nif it's 100 electronvolt above the ground state.",
    "start": "4423120",
    "end": "4429139"
  },
  {
    "text": "Because that\nexponential is not 0. It's small, but it's not\n0, So you will execute.",
    "start": "4429140",
    "end": "4434540"
  },
  {
    "text": "And you'd be surprised how\noften this is a problem, especially if you\nhave a wild phase space in which you can go.",
    "start": "4434540",
    "end": "4441470"
  },
  {
    "text": "So how do you solve this? We solve it in a trivial way. We add a small epsilon\nto a random number.",
    "start": "4441470",
    "end": "4449050"
  },
  {
    "text": "Which is so, trivial but\nyou have to know it I. I've never seen this\nin books actually. But see you should not hit 0.",
    "start": "4449050",
    "end": "4457130"
  },
  {
    "text": "Because when you hit 0,\nyou execute everything. OK.",
    "start": "4457130",
    "end": "4462190"
  },
  {
    "text": "OK. So I'm going to stop here. And let's see, today's Thursday. So yeah, I'll see you on Tuesday\nfor the rest of Monte Carlo.",
    "start": "4462190",
    "end": "4470060"
  },
  {
    "start": "4470060",
    "end": "4471465"
  }
]