[
  {
    "start": "0",
    "end": "820"
  },
  {
    "text": "Let's now go through\nanother example,",
    "start": "820",
    "end": "3610"
  },
  {
    "text": "which will be a little\nmore challenging.",
    "start": "3610",
    "end": "6770"
  },
  {
    "text": "We're going to revisit\nan old problem.",
    "start": "6770",
    "end": "9040"
  },
  {
    "text": "We have a coin that has\nan unknown bias, Theta.",
    "start": "9040",
    "end": "12535"
  },
  {
    "text": "And we have a prior\ndistribution on this Theta.",
    "start": "12535",
    "end": "15700"
  },
  {
    "text": "We fix some positive\ninteger, n, we flip a coin",
    "start": "15700",
    "end": "18960"
  },
  {
    "text": "n times, that has\nthis unknown bias.",
    "start": "18960",
    "end": "21750"
  },
  {
    "text": "And we record the\nnumber of heads.",
    "start": "21750",
    "end": "24180"
  },
  {
    "text": "On the basis of the number of\nheads that have been observed,",
    "start": "24180",
    "end": "27090"
  },
  {
    "text": "we wish to estimate the\nbias, Theta, of the coin.",
    "start": "27090",
    "end": "31850"
  },
  {
    "text": "To make things more\nconcrete, we're",
    "start": "31850",
    "end": "33360"
  },
  {
    "text": "going to assume a prior\ndistribution on Theta that",
    "start": "33360",
    "end": "36080"
  },
  {
    "text": "is uniform on the unit interval.",
    "start": "36080",
    "end": "39120"
  },
  {
    "text": "Now, this is a problem we\nhave considered before.",
    "start": "39120",
    "end": "42500"
  },
  {
    "text": "We have calculated the expected\nvalue of Theta given X.",
    "start": "42500",
    "end": "47800"
  },
  {
    "text": "And we did find that\nthe expected value takes",
    "start": "47800",
    "end": "51309"
  },
  {
    "text": "this particular form.",
    "start": "51310",
    "end": "52920"
  },
  {
    "text": "Now, notice that this is\na linear function of X.",
    "start": "52920",
    "end": "56800"
  },
  {
    "text": "And if it turns out the\nleast mean squares estimator",
    "start": "56800",
    "end": "60180"
  },
  {
    "text": "is a linear function\nof X, then we're",
    "start": "60180",
    "end": "63010"
  },
  {
    "text": "guaranteed, since\nthis is the best,",
    "start": "63010",
    "end": "65580"
  },
  {
    "text": "that this is also the\nbest within the class",
    "start": "65580",
    "end": "68020"
  },
  {
    "text": "of linear estimators.",
    "start": "68020",
    "end": "70619"
  },
  {
    "text": "So we immediately\nhave the conclusion",
    "start": "70620",
    "end": "73120"
  },
  {
    "text": "that the linear\nleast mean squares",
    "start": "73120",
    "end": "75220"
  },
  {
    "text": "estimator is this\nparticular function of X.",
    "start": "75220",
    "end": "78900"
  },
  {
    "text": "So there's not much left to do.",
    "start": "78900",
    "end": "82350"
  },
  {
    "text": "On the other hand,\njust for practice,",
    "start": "82350",
    "end": "84700"
  },
  {
    "text": "let us derive this answer\ndirectly from the formulas",
    "start": "84700",
    "end": "89030"
  },
  {
    "text": "that we have for the linear\nleast mean squares estimator,",
    "start": "89030",
    "end": "92330"
  },
  {
    "text": "and see whether we're going\nto get the same answer.",
    "start": "92330",
    "end": "95910"
  },
  {
    "text": "So we want to use this formula.",
    "start": "95910",
    "end": "97930"
  },
  {
    "text": "And in order to apply this\nformula, all that we have to do",
    "start": "97930",
    "end": "101259"
  },
  {
    "text": "is to calculate these expected\nvalues, this variance,",
    "start": "101259",
    "end": "104979"
  },
  {
    "text": "and this covariance.",
    "start": "104979",
    "end": "107109"
  },
  {
    "text": "So now let's move on to this\nparticular calculational",
    "start": "107110",
    "end": "110539"
  },
  {
    "text": "exercise.",
    "start": "110539",
    "end": "113030"
  },
  {
    "text": "Let's start by\nwriting down what we",
    "start": "113030",
    "end": "115190"
  },
  {
    "text": "know about the random variables\ninvolved in this problem.",
    "start": "115190",
    "end": "118759"
  },
  {
    "text": "About Theta, we know\nthat it is uniform.",
    "start": "118759",
    "end": "121180"
  },
  {
    "text": "And so it has a mean of\n1/2 and a variance of 1/12.",
    "start": "121180",
    "end": "126470"
  },
  {
    "text": "About X, what we know\nis the following.",
    "start": "126470",
    "end": "129460"
  },
  {
    "text": "If you fix the bias of\nthe coin, then the number",
    "start": "129460",
    "end": "133760"
  },
  {
    "text": "of heads you're going\nto obtain in n flips",
    "start": "133760",
    "end": "136400"
  },
  {
    "text": "has a binomial distribution,\nwith parameters n and Theta.",
    "start": "136400",
    "end": "140670"
  },
  {
    "text": "But of course, Theta itself\nis a random variable.",
    "start": "140670",
    "end": "143740"
  },
  {
    "text": "So for this reason, this is\na conditional distribution.",
    "start": "143740",
    "end": "147220"
  },
  {
    "text": "But within the\nconditional universe,",
    "start": "147220",
    "end": "149440"
  },
  {
    "text": "we know the mean and the\nvariance of a binomial,",
    "start": "149440",
    "end": "152460"
  },
  {
    "text": "and they are as follows.",
    "start": "152460",
    "end": "154079"
  },
  {
    "text": "The mean of a binomial is n\ntimes the bias of the coin.",
    "start": "154079",
    "end": "158000"
  },
  {
    "text": "But because we're talking\nabout the conditional universe,",
    "start": "158000",
    "end": "160910"
  },
  {
    "text": "this is a conditional\nexpectation.",
    "start": "160910",
    "end": "162960"
  },
  {
    "text": "And it's a random\nvariable, because it's",
    "start": "162960",
    "end": "165010"
  },
  {
    "text": "affected by the value of\nthe random variable Theta.",
    "start": "165010",
    "end": "168349"
  },
  {
    "text": "And similarly, for\nthe variance, it's",
    "start": "168350",
    "end": "170180"
  },
  {
    "text": "the usual formula for the\nvariance of a binomial,",
    "start": "170180",
    "end": "173879"
  },
  {
    "text": "except that now the bias\nitself is a random variable.",
    "start": "173880",
    "end": "178780"
  },
  {
    "text": "So now let's continue with the\ncalculation of the quantities",
    "start": "178780",
    "end": "182250"
  },
  {
    "text": "that we need for the\nformula for our estimator.",
    "start": "182250",
    "end": "186060"
  },
  {
    "text": "Let's start with the\nexpected value of X.",
    "start": "186060",
    "end": "189120"
  },
  {
    "text": "Since we know the\nconditional expectation of X,",
    "start": "189120",
    "end": "192049"
  },
  {
    "text": "we can use the law of\niterated expectations.",
    "start": "192050",
    "end": "195460"
  },
  {
    "text": "The unconditional expectation\nis the expected value",
    "start": "195460",
    "end": "199650"
  },
  {
    "text": "of the conditional expectation,\nwhich is n times Theta.",
    "start": "199650",
    "end": "205200"
  },
  {
    "text": "And since the mean of Theta\nis 1/2, we obtain n/2.",
    "start": "205200",
    "end": "209480"
  },
  {
    "start": "209480",
    "end": "212629"
  },
  {
    "text": "Let us now continue with the\ncalculation of the variance.",
    "start": "212630",
    "end": "216250"
  },
  {
    "text": "There are different ways\nthat we can calculate it.",
    "start": "216250",
    "end": "218720"
  },
  {
    "text": "One could be the law\nof total variance.",
    "start": "218720",
    "end": "221850"
  },
  {
    "text": "But we will take the\nalternative approach,",
    "start": "221850",
    "end": "224620"
  },
  {
    "text": "which is to use the general\nformula for the variance,",
    "start": "224620",
    "end": "228010"
  },
  {
    "text": "that the variance is\nequal to the expected",
    "start": "228010",
    "end": "230140"
  },
  {
    "text": "value of the square\nof a random variable,",
    "start": "230140",
    "end": "232740"
  },
  {
    "text": "minus the square of\nthe expected value.",
    "start": "232740",
    "end": "237900"
  },
  {
    "text": "We know the expected value of X.",
    "start": "237900",
    "end": "239970"
  },
  {
    "text": "So all that's left\nis to calculate",
    "start": "239970",
    "end": "241870"
  },
  {
    "text": "the expected value of X squared.",
    "start": "241870",
    "end": "244540"
  },
  {
    "text": "How are we going calculate it?",
    "start": "244540",
    "end": "247480"
  },
  {
    "text": "Well, we know the conditional\ndistribution of X.",
    "start": "247480",
    "end": "251110"
  },
  {
    "text": "So it should be\neasy to calculate",
    "start": "251110",
    "end": "253800"
  },
  {
    "text": "the conditional\nexpectation of X squared",
    "start": "253800",
    "end": "257820"
  },
  {
    "text": "in the conditional\nuniverse, and then",
    "start": "257820",
    "end": "261190"
  },
  {
    "text": "use the law of\niterated expectations",
    "start": "261190",
    "end": "264120"
  },
  {
    "text": "to obtain the\nunconditional expectation.",
    "start": "264120",
    "end": "267460"
  },
  {
    "text": "So now, we need to calculate\nthis conditional expectation",
    "start": "267460",
    "end": "270740"
  },
  {
    "text": "here.",
    "start": "270740",
    "end": "272330"
  },
  {
    "text": "How do we do it?",
    "start": "272330",
    "end": "274229"
  },
  {
    "text": "The expected value of a\nsquare of a random variable",
    "start": "274230",
    "end": "276780"
  },
  {
    "text": "is always equal to the variance\nof that random variable",
    "start": "276780",
    "end": "280370"
  },
  {
    "text": "plus the square of\nthe expected value.",
    "start": "280370",
    "end": "283800"
  },
  {
    "text": "We're going to\nuse this property,",
    "start": "283800",
    "end": "285530"
  },
  {
    "text": "but we're going to use it\nin the conditional universe.",
    "start": "285530",
    "end": "288340"
  },
  {
    "text": "So in the conditional\nuniverse, this",
    "start": "288340",
    "end": "290580"
  },
  {
    "text": "is going to be equal\nto the variance,",
    "start": "290580",
    "end": "292900"
  },
  {
    "text": "in the conditional universe,\nwhich is n times Theta times 1",
    "start": "292900",
    "end": "297669"
  },
  {
    "text": "minus Theta, plus the square\nof the expected value of X,",
    "start": "297670",
    "end": "304020"
  },
  {
    "text": "but the expected value in the\nconditional universe, which",
    "start": "304020",
    "end": "307300"
  },
  {
    "text": "is this quantity--\nn times Theta.",
    "start": "307300",
    "end": "310050"
  },
  {
    "text": "So we obtain another term--\nn squared, Theta squared.",
    "start": "310050",
    "end": "316210"
  },
  {
    "text": "So now we can go back to\nour previous calculation,",
    "start": "316210",
    "end": "319330"
  },
  {
    "text": "and right here,\nthe expected value",
    "start": "319330",
    "end": "322430"
  },
  {
    "text": "of this expression,\nwhich is n times Theta.",
    "start": "322430",
    "end": "326690"
  },
  {
    "start": "326690",
    "end": "331210"
  },
  {
    "text": "And then we have some\nTheta squared terms.",
    "start": "331210",
    "end": "334930"
  },
  {
    "text": "One is n squared.",
    "start": "334930",
    "end": "336570"
  },
  {
    "text": "The other is a minus n.",
    "start": "336570",
    "end": "339159"
  },
  {
    "text": "So we obtain plus n squared\nminus n Theta squared.",
    "start": "339159",
    "end": "346880"
  },
  {
    "start": "346880",
    "end": "351380"
  },
  {
    "text": "The expected value\nof n times Theta",
    "start": "351380",
    "end": "354409"
  },
  {
    "text": "is n times the expected\nvalue of Theta, which is 1/2.",
    "start": "354409",
    "end": "358699"
  },
  {
    "text": "So we obtain a factor of n/2.",
    "start": "358700",
    "end": "361715"
  },
  {
    "start": "361715",
    "end": "364460"
  },
  {
    "text": "But then we have this\nadditional term here.",
    "start": "364460",
    "end": "368270"
  },
  {
    "text": "We need the expected\nvalue of Theta squared.",
    "start": "368270",
    "end": "371120"
  },
  {
    "text": "What is it?",
    "start": "371120",
    "end": "372180"
  },
  {
    "text": "Well, since we know the mean\nand the variance of Theta,",
    "start": "372180",
    "end": "375759"
  },
  {
    "text": "we can calculate the expected\nvalue of Theta squared.",
    "start": "375760",
    "end": "378470"
  },
  {
    "text": "It is equal to the variance\nplus the square of the mean.",
    "start": "378470",
    "end": "386410"
  },
  {
    "text": "And this evaluates to 1/3.",
    "start": "386410",
    "end": "390630"
  },
  {
    "text": "So from here, we're\ngoing to obtain",
    "start": "390630",
    "end": "393880"
  },
  {
    "text": "plus n squared minus\nn divided by 3.",
    "start": "393880",
    "end": "401540"
  },
  {
    "text": "And you can rewrite this\nterm in a different way",
    "start": "401540",
    "end": "405450"
  },
  {
    "text": "by collecting first the\nn terms, n/2 minus n/3.",
    "start": "405450",
    "end": "412380"
  },
  {
    "text": "This gives us n/6.",
    "start": "412380",
    "end": "413815"
  },
  {
    "start": "413815",
    "end": "416510"
  },
  {
    "text": "And then there's\nthe n squared term,",
    "start": "416510",
    "end": "418540"
  },
  {
    "text": "which is n squared over 3.",
    "start": "418540",
    "end": "421170"
  },
  {
    "start": "421170",
    "end": "423850"
  },
  {
    "text": "Now that we found the\nexpected value of X squared,",
    "start": "423850",
    "end": "426590"
  },
  {
    "text": "we can go back to\nthis calculation.",
    "start": "426590",
    "end": "429260"
  },
  {
    "text": "We have n/6 plus\nn squared over 3",
    "start": "429260",
    "end": "437850"
  },
  {
    "text": "minus the square of the\nexpected value of X,",
    "start": "437850",
    "end": "440970"
  },
  {
    "text": "which is this expression here.",
    "start": "440970",
    "end": "442600"
  },
  {
    "text": "So we obtain minus\nn squared over 4.",
    "start": "442600",
    "end": "446480"
  },
  {
    "text": "1/3 minus 1/4-- that makes 1/12.",
    "start": "446480",
    "end": "451130"
  },
  {
    "text": "So we obtain n/6 plus\nn squared over 12.",
    "start": "451130",
    "end": "462170"
  },
  {
    "text": "Or another way of writing this\nis n times n plus 2 over 12.",
    "start": "462170",
    "end": "469270"
  },
  {
    "start": "469270",
    "end": "471879"
  },
  {
    "text": "And this completes\nthe calculation",
    "start": "471880",
    "end": "473840"
  },
  {
    "text": "of the variance of X.",
    "start": "473840",
    "end": "476470"
  },
  {
    "text": "The last quantity that's\nleft for us to calculate",
    "start": "476470",
    "end": "479290"
  },
  {
    "text": "is the covariance\nof Theta with X.",
    "start": "479290",
    "end": "483080"
  },
  {
    "text": "We're going to calculate it\nusing the alternative formula",
    "start": "483080",
    "end": "486639"
  },
  {
    "text": "for the covariance, which is\nthe expectation of the product",
    "start": "486640",
    "end": "491320"
  },
  {
    "text": "minus the product\nof the expectations.",
    "start": "491320",
    "end": "493206"
  },
  {
    "start": "493206",
    "end": "496960"
  },
  {
    "text": "We have the expectations,\nbut we do not",
    "start": "496960",
    "end": "499300"
  },
  {
    "text": "have the expectation\nof the product.",
    "start": "499300",
    "end": "501539"
  },
  {
    "text": "So we need to calculate it.",
    "start": "501540",
    "end": "503950"
  },
  {
    "text": "Once more, it's going\nto be the same trick.",
    "start": "503950",
    "end": "506160"
  },
  {
    "text": "We're going to\ncondition on Theta,",
    "start": "506160",
    "end": "508800"
  },
  {
    "text": "and then use the law of\niterated expectations.",
    "start": "508800",
    "end": "513070"
  },
  {
    "text": "So the law of\niterated expectations,",
    "start": "513070",
    "end": "515349"
  },
  {
    "text": "when you condition on\nTheta, takes this form.",
    "start": "515350",
    "end": "518789"
  },
  {
    "text": "And to continue\nhere, we need to find",
    "start": "518789",
    "end": "521229"
  },
  {
    "text": "this conditional\nexpectation in the inside.",
    "start": "521230",
    "end": "525220"
  },
  {
    "text": "This conditional\nexpectation-- what is it?",
    "start": "525220",
    "end": "529029"
  },
  {
    "text": "If I give you Theta,\nthen you know Theta.",
    "start": "529030",
    "end": "531630"
  },
  {
    "text": "It is becoming now a constant.",
    "start": "531630",
    "end": "533470"
  },
  {
    "text": "There's nothing\nrandom to it, so it",
    "start": "533470",
    "end": "535410"
  },
  {
    "text": "can be pulled outside\nthe expectation.",
    "start": "535410",
    "end": "538600"
  },
  {
    "text": "And we obtain Theta times the\nconditional expectation of X.",
    "start": "538600",
    "end": "543779"
  },
  {
    "text": "We know what the conditional\nexpectation of X is.",
    "start": "543780",
    "end": "546740"
  },
  {
    "text": "It's n times Theta.",
    "start": "546740",
    "end": "548070"
  },
  {
    "text": "So from here, we obtain overall,\na term n times Theta squared.",
    "start": "548070",
    "end": "553330"
  },
  {
    "text": "So now we can go back here.",
    "start": "553330",
    "end": "555940"
  },
  {
    "text": "We have the expected value.",
    "start": "555940",
    "end": "557780"
  },
  {
    "text": "And the term in the\ninside-- we just found it.",
    "start": "557780",
    "end": "560890"
  },
  {
    "text": "It's n times Theta squared.",
    "start": "560890",
    "end": "563390"
  },
  {
    "text": "And since the expected\nvalue of Theta squared",
    "start": "563390",
    "end": "565750"
  },
  {
    "text": "is 1/3, from here,\nwe obtain n/3.",
    "start": "565750",
    "end": "568695"
  },
  {
    "start": "568695",
    "end": "572670"
  },
  {
    "text": "And now we can go back,\nfinally, to the calculation",
    "start": "572670",
    "end": "576040"
  },
  {
    "text": "of the covariance.",
    "start": "576040",
    "end": "577329"
  },
  {
    "text": "It's going to be n/3, minus\nthe expected value of Theta,",
    "start": "577330",
    "end": "583160"
  },
  {
    "text": "which is 1/2, times the expected\nvalue of X, which is n/2.",
    "start": "583160",
    "end": "588350"
  },
  {
    "text": "So it's minus n over four.",
    "start": "588350",
    "end": "592310"
  },
  {
    "text": "And this evaluates to n/12.",
    "start": "592310",
    "end": "594330"
  },
  {
    "start": "594330",
    "end": "597880"
  },
  {
    "text": "So we have succeeded in\ncalculating all the quantities",
    "start": "597880",
    "end": "601240"
  },
  {
    "text": "that are needed in the\nformula for the linear least",
    "start": "601240",
    "end": "604830"
  },
  {
    "text": "mean squares estimator.",
    "start": "604830",
    "end": "606045"
  },
  {
    "start": "606045",
    "end": "608709"
  },
  {
    "text": "We can now take those values\nthat we have just found",
    "start": "608710",
    "end": "612540"
  },
  {
    "text": "and substitute them\ninto this formula.",
    "start": "612540",
    "end": "615620"
  },
  {
    "text": "And after a little bit of\nalgebra and moving terms",
    "start": "615620",
    "end": "618650"
  },
  {
    "text": "around, everything simplifies\nto this expression.",
    "start": "618650",
    "end": "622820"
  },
  {
    "text": "Just to verify that\nthis makes sense,",
    "start": "622820",
    "end": "625670"
  },
  {
    "text": "what is the\ncoefficient next to X?",
    "start": "625670",
    "end": "628122"
  },
  {
    "text": "It's the covariance\ndivided by the variance.",
    "start": "628122",
    "end": "630820"
  },
  {
    "text": "n/12 divided by\nthis expression--",
    "start": "630820",
    "end": "634320"
  },
  {
    "text": "this n cancels that n.",
    "start": "634320",
    "end": "636050"
  },
  {
    "text": "This 12 cancels that 12.",
    "start": "636050",
    "end": "637410"
  },
  {
    "text": "We're left with an n plus\n2 in the denominator.",
    "start": "637410",
    "end": "640459"
  },
  {
    "text": "And indeed, the coefficient\nthat multiplies X",
    "start": "640460",
    "end": "643520"
  },
  {
    "text": "is the term n plus 2\nin the denominator.",
    "start": "643520",
    "end": "647960"
  },
  {
    "text": "And you can similarly verify\nthat the constant term as well",
    "start": "647960",
    "end": "651280"
  },
  {
    "text": "is the correct one.",
    "start": "651280",
    "end": "653870"
  },
  {
    "text": "So of course, this answer is\nwhat we had found in the past",
    "start": "653870",
    "end": "658400"
  },
  {
    "text": "to be the optimal,\nthe least mean squares",
    "start": "658400",
    "end": "662160"
  },
  {
    "text": "estimator of X. As we discussed\nearlier, when this is linear",
    "start": "662160",
    "end": "668310"
  },
  {
    "text": "in X, it has to be the same as\nthe linear least mean squares",
    "start": "668310",
    "end": "671970"
  },
  {
    "text": "estimator.",
    "start": "671970",
    "end": "673050"
  },
  {
    "text": "So this answer is\nnot a surprise,",
    "start": "673050",
    "end": "675529"
  },
  {
    "text": "but it was an interesting\nand perhaps useful",
    "start": "675530",
    "end": "677930"
  },
  {
    "text": "exercise to go through the\ndetails of this calculation",
    "start": "677930",
    "end": "681440"
  },
  {
    "text": "to see what it\ntakes to figure out",
    "start": "681440",
    "end": "684030"
  },
  {
    "text": "the different terms\nin this formula.",
    "start": "684030",
    "end": "687360"
  },
  {
    "start": "687360",
    "end": "688424"
  }
]