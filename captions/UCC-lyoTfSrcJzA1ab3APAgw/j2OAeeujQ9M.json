[
  {
    "text": "hey this is Lance L chain we seem very",
    "start": "840",
    "end": "2879"
  },
  {
    "text": "high interest in building llm agents",
    "start": "2879",
    "end": "5040"
  },
  {
    "text": "using open source llms and so we wanted",
    "start": "5040",
    "end": "7439"
  },
  {
    "text": "to talk through how to do that from",
    "start": "7439",
    "end": "8679"
  },
  {
    "text": "scratch using llama 3 so first what is",
    "start": "8679",
    "end": "11559"
  },
  {
    "text": "an agent so lilan Wang is a very nice",
    "start": "11559",
    "end": "14480"
  },
  {
    "text": "blog post that laid out the central",
    "start": "14480",
    "end": "16160"
  },
  {
    "text": "components of Agents being planning",
    "start": "16160",
    "end": "18279"
  },
  {
    "text": "memory and Tool use so I want to walk",
    "start": "18279",
    "end": "20880"
  },
  {
    "text": "through these components individually",
    "start": "20880",
    "end": "22519"
  },
  {
    "text": "and how I can use them with llama 3 so",
    "start": "22519",
    "end": "25199"
  },
  {
    "text": "first let's talk about tool use I'm",
    "start": "25199",
    "end": "27240"
  },
  {
    "text": "going to copy over some code and we're",
    "start": "27240",
    "end": "28880"
  },
  {
    "text": "going to walk through it so I this",
    "start": "28880",
    "end": "30000"
  },
  {
    "text": "notebook done a few pip installs set a",
    "start": "30000",
    "end": "32000"
  },
  {
    "text": "few API Keys we'll use grock as our LM",
    "start": "32000",
    "end": "34719"
  },
  {
    "text": "we'll use Tav uh for web search as one",
    "start": "34719",
    "end": "37040"
  },
  {
    "text": "of our tools and we'll use lsmith for",
    "start": "37040",
    "end": "39239"
  },
  {
    "text": "tracing but that's all I've done here",
    "start": "39239",
    "end": "41120"
  },
  {
    "text": "okay and I'm going to kind of have this",
    "start": "41120",
    "end": "43399"
  },
  {
    "text": "image side by side so we can look at it",
    "start": "43399",
    "end": "45760"
  },
  {
    "text": "so first tool use what's the big idea",
    "start": "45760",
    "end": "48039"
  },
  {
    "text": "here the big idea is simply this I want",
    "start": "48039",
    "end": "50640"
  },
  {
    "text": "to take an llm give it awareness of some",
    "start": "50640",
    "end": "53559"
  },
  {
    "text": "external tool that exists and have the",
    "start": "53559",
    "end": "55960"
  },
  {
    "text": "llm return the payload necessary to",
    "start": "55960",
    "end": "58039"
  },
  {
    "text": "invoke that tool that's really all",
    "start": "58039",
    "end": "59600"
  },
  {
    "text": "that's going going on now this is often",
    "start": "59600",
    "end": "61600"
  },
  {
    "text": "kind of confused and I wanted to kind of",
    "start": "61600",
    "end": "63399"
  },
  {
    "text": "zoom in and explain this exactly so",
    "start": "63399",
    "end": "65518"
  },
  {
    "text": "let's say I have a function called Magic",
    "start": "65519",
    "end": "67000"
  },
  {
    "text": "function which which takes an input and",
    "start": "67000",
    "end": "68600"
  },
  {
    "text": "adds two to it I want to give an llm the",
    "start": "68600",
    "end": "71560"
  },
  {
    "text": "ability to recognize whether not or not",
    "start": "71560",
    "end": "74360"
  },
  {
    "text": "to invoke this function and to return",
    "start": "74360",
    "end": "77159"
  },
  {
    "text": "the payload necessary to run the",
    "start": "77159",
    "end": "79320"
  },
  {
    "text": "function given the user input so here's",
    "start": "79320",
    "end": "81320"
  },
  {
    "text": "exactly what I want to have happen I",
    "start": "81320",
    "end": "83119"
  },
  {
    "text": "want to take that function somehow bind",
    "start": "83119",
    "end": "85240"
  },
  {
    "text": "it to my llm and give it an input then",
    "start": "85240",
    "end": "89200"
  },
  {
    "text": "return both the function name itself and",
    "start": "89200",
    "end": "92920"
  },
  {
    "text": "the arguments necessary to run the",
    "start": "92920",
    "end": "94320"
  },
  {
    "text": "function remember llms are just string",
    "start": "94320",
    "end": "96200"
  },
  {
    "text": "to string right it doesn't have the",
    "start": "96200",
    "end": "97600"
  },
  {
    "text": "magic ability to call that function",
    "start": "97600",
    "end": "99360"
  },
  {
    "text": "natively but what it can do is return",
    "start": "99360",
    "end": "101960"
  },
  {
    "text": "okay I've seen this function I know it",
    "start": "101960",
    "end": "104119"
  },
  {
    "text": "exists and I'm going to give you exactly",
    "start": "104119",
    "end": "106079"
  },
  {
    "text": "like the input format necessary or the",
    "start": "106079",
    "end": "107719"
  },
  {
    "text": "payload to run the function as well as",
    "start": "107719",
    "end": "110000"
  },
  {
    "text": "the name of the function okay so that's",
    "start": "110000",
    "end": "111680"
  },
  {
    "text": "really all that's going on so first this",
    "start": "111680",
    "end": "116200"
  },
  {
    "text": "tool decorator in Lang chain allows you",
    "start": "116200",
    "end": "117920"
  },
  {
    "text": "to take any arbitrary function just turn",
    "start": "117920",
    "end": "119439"
  },
  {
    "text": "it into a tool and let's just kick this",
    "start": "119439",
    "end": "121759"
  },
  {
    "text": "off so here's my magic function and",
    "start": "121759",
    "end": "123520"
  },
  {
    "text": "here's a web search function so these",
    "start": "123520",
    "end": "124960"
  },
  {
    "text": "are two things that I want to kind of",
    "start": "124960",
    "end": "126560"
  },
  {
    "text": "turn into tools and I can do that right",
    "start": "126560",
    "end": "129000"
  },
  {
    "text": "here so we can run this now if I look at",
    "start": "129000",
    "end": "131720"
  },
  {
    "text": "Magic function now it's a structured",
    "start": "131720",
    "end": "133640"
  },
  {
    "text": "tool it has a name it has a",
    "start": "133640",
    "end": "136280"
  },
  {
    "text": "description and um it also has that",
    "start": "136280",
    "end": "139360"
  },
  {
    "text": "input or arguments as uh captured as a",
    "start": "139360",
    "end": "142760"
  },
  {
    "text": "pantic schema okay so all this",
    "start": "142760",
    "end": "145000"
  },
  {
    "text": "information can be passed directly to",
    "start": "145000",
    "end": "146400"
  },
  {
    "text": "our llm that's the key point so this",
    "start": "146400",
    "end": "148680"
  },
  {
    "text": "allows us to go from arbitrary functions",
    "start": "148680",
    "end": "151200"
  },
  {
    "text": "to tools that can be bound to an llm",
    "start": "151200",
    "end": "153440"
  },
  {
    "text": "okay so that's kind of step one now step",
    "start": "153440",
    "end": "155680"
  },
  {
    "text": "two this is where things are kind of",
    "start": "155680",
    "end": "157400"
  },
  {
    "text": "interesting I'm going to use grock here",
    "start": "157400",
    "end": "161000"
  },
  {
    "text": "and I'm going to use a prompt I'm",
    "start": "161000",
    "end": "162120"
  },
  {
    "text": "basically going to say you're helpful",
    "start": "162120",
    "end": "163200"
  },
  {
    "text": "assistant with two tools web search and",
    "start": "163200",
    "end": "165959"
  },
  {
    "text": "a custom function use web search for",
    "start": "165959",
    "end": "168120"
  },
  {
    "text": "current events use the magic function if",
    "start": "168120",
    "end": "170560"
  },
  {
    "text": "the user directly asked for it otherwise",
    "start": "170560",
    "end": "172360"
  },
  {
    "text": "just answer directly okay so that's kind",
    "start": "172360",
    "end": "173959"
  },
  {
    "text": "of my prompt and let's test this in two",
    "start": "173959",
    "end": "177159"
  },
  {
    "text": "cases to explain exactly how this works",
    "start": "177159",
    "end": "179560"
  },
  {
    "text": "okay so all I'm doing I'm using chat",
    "start": "179560",
    "end": "181159"
  },
  {
    "text": "grock setting llama",
    "start": "181159",
    "end": "182879"
  },
  {
    "text": "370b and I'm creating this uh runnable",
    "start": "182879",
    "end": "185720"
  },
  {
    "text": "this is kind of a lang chain primitive",
    "start": "185720",
    "end": "187239"
  },
  {
    "text": "for it basically invoking llm so that's",
    "start": "187239",
    "end": "189080"
  },
  {
    "text": "all I've done now here's what's",
    "start": "189080",
    "end": "190959"
  },
  {
    "text": "interesting this is piping the prompt to",
    "start": "190959",
    "end": "193440"
  },
  {
    "text": "an llm and I've bound my tools to the LM",
    "start": "193440",
    "end": "196360"
  },
  {
    "text": "so this is automatically taking those",
    "start": "196360",
    "end": "197920"
  },
  {
    "text": "tools we defined and it's basically",
    "start": "197920",
    "end": "200159"
  },
  {
    "text": "giving them to the LM such that it's",
    "start": "200159",
    "end": "201959"
  },
  {
    "text": "aware of them so it's that's basically",
    "start": "201959",
    "end": "204159"
  },
  {
    "text": "represented in this red box here you",
    "start": "204159",
    "end": "206239"
  },
  {
    "text": "take external tools and you basically",
    "start": "206239",
    "end": "208200"
  },
  {
    "text": "bind them to LM so the is aware that",
    "start": "208200",
    "end": "210720"
  },
  {
    "text": "they exist that's kind of step one now",
    "start": "210720",
    "end": "213319"
  },
  {
    "text": "here's step two I can basically take a",
    "start": "213319",
    "end": "216360"
  },
  {
    "text": "question so I'm going to ask what is",
    "start": "216360",
    "end": "218840"
  },
  {
    "text": "Magic function 3 I'm going to invoke my",
    "start": "218840",
    "end": "220840"
  },
  {
    "text": "runnable or my chain right with this and",
    "start": "220840",
    "end": "224319"
  },
  {
    "text": "let's see what happens I'm going to run",
    "start": "224319",
    "end": "226560"
  },
  {
    "text": "this now here's what's interesting that",
    "start": "226560",
    "end": "228959"
  },
  {
    "text": "payload contains an object tool calls",
    "start": "228959",
    "end": "231319"
  },
  {
    "text": "which contains the name of the function",
    "start": "231319",
    "end": "233439"
  },
  {
    "text": "and the arguments that's it so that's",
    "start": "233439",
    "end": "236400"
  },
  {
    "text": "the key thing and I can look at the raw",
    "start": "236400",
    "end": "238760"
  },
  {
    "text": "payload as well so the raw payload is",
    "start": "238760",
    "end": "240480"
  },
  {
    "text": "just simply this AI message it contains",
    "start": "240480",
    "end": "243280"
  },
  {
    "text": "you know a bunch of information but",
    "start": "243280",
    "end": "244560"
  },
  {
    "text": "here's the main thing it contains",
    "start": "244560",
    "end": "246200"
  },
  {
    "text": "basically um the name of the function to",
    "start": "246200",
    "end": "249040"
  },
  {
    "text": "call and the arguments pass to the",
    "start": "249040",
    "end": "251040"
  },
  {
    "text": "function so again that's exactly",
    "start": "251040",
    "end": "252680"
  },
  {
    "text": "represented here all that's happening is",
    "start": "252680",
    "end": "254840"
  },
  {
    "text": "I've taken a function I've turned it",
    "start": "254840",
    "end": "256720"
  },
  {
    "text": "into a tool I've bound it to my llm I",
    "start": "256720",
    "end": "259440"
  },
  {
    "text": "can ask a question natural language and",
    "start": "259440",
    "end": "261079"
  },
  {
    "text": "the llm can respond directly with the L",
    "start": "261079",
    "end": "264880"
  },
  {
    "text": "the function to call or the tool to use",
    "start": "264880",
    "end": "267520"
  },
  {
    "text": "and the input argument to use based upon",
    "start": "267520",
    "end": "270600"
  },
  {
    "text": "the user input that's the key point and",
    "start": "270600",
    "end": "272520"
  },
  {
    "text": "that's really all that's happening",
    "start": "272520",
    "end": "273680"
  },
  {
    "text": "function calling that's all I need you",
    "start": "273680",
    "end": "275639"
  },
  {
    "text": "to know okay so here's the other key",
    "start": "275639",
    "end": "277680"
  },
  {
    "text": "thing what if I just ask a question",
    "start": "277680",
    "end": "279600"
  },
  {
    "text": "about the United States based on my",
    "start": "279600",
    "end": "281000"
  },
  {
    "text": "prompt it should not try to invoke any",
    "start": "281000",
    "end": "282639"
  },
  {
    "text": "of these tools now now let's test that I",
    "start": "282639",
    "end": "284720"
  },
  {
    "text": "run this good and so this payload tool",
    "start": "284720",
    "end": "287000"
  },
  {
    "text": "calls empty I can look at the raw",
    "start": "287000",
    "end": "289039"
  },
  {
    "text": "payload and yeah now it's just a chat",
    "start": "289039",
    "end": "291800"
  },
  {
    "text": "response right the capital of the US is",
    "start": "291800",
    "end": "293800"
  },
  {
    "text": "Washington DC great okay so that's it so",
    "start": "293800",
    "end": "296919"
  },
  {
    "text": "hopefully now you understand how tool",
    "start": "296919",
    "end": "298720"
  },
  {
    "text": "use works and now remember this requires",
    "start": "298720",
    "end": "300520"
  },
  {
    "text": "an LM that's actually been fine-tuned or",
    "start": "300520",
    "end": "302360"
  },
  {
    "text": "prompted or otherwise is compatible with",
    "start": "302360",
    "end": "305280"
  },
  {
    "text": "tool use and this is a very important",
    "start": "305280",
    "end": "306800"
  },
  {
    "text": "Point uh we talked to the folks at Croc",
    "start": "306800",
    "end": "309080"
  },
  {
    "text": "they have kind of an an a proprietary",
    "start": "309080",
    "end": "311360"
  },
  {
    "text": "implementation for how they do this um",
    "start": "311360",
    "end": "314160"
  },
  {
    "text": "which we don't know fully but it is",
    "start": "314160",
    "end": "316240"
  },
  {
    "text": "reported that works very well with llama",
    "start": "316240",
    "end": "317759"
  },
  {
    "text": "70b llama 370b and that in my experience",
    "start": "317759",
    "end": "320400"
  },
  {
    "text": "I've seen it to indeed work quite well",
    "start": "320400",
    "end": "322840"
  },
  {
    "text": "so in any case the key point is this I",
    "start": "322840",
    "end": "325600"
  },
  {
    "text": "can take any arbitrary functions I want",
    "start": "325600",
    "end": "327800"
  },
  {
    "text": "I can turn them into tools I can then",
    "start": "327800",
    "end": "330280"
  },
  {
    "text": "pass those tools to an llm I can bind",
    "start": "330280",
    "end": "332479"
  },
  {
    "text": "them and then you can see right here",
    "start": "332479",
    "end": "335080"
  },
  {
    "text": "when I invoke my llm with a question the",
    "start": "335080",
    "end": "338240"
  },
  {
    "text": "LM makes decision to use one of the",
    "start": "338240",
    "end": "341080"
  },
  {
    "text": "tools and if it does it's going to",
    "start": "341080",
    "end": "342639"
  },
  {
    "text": "return to you the name of the tool it",
    "start": "342639",
    "end": "344000"
  },
  {
    "text": "wants to use and the input argument",
    "start": "344000",
    "end": "346319"
  },
  {
    "text": "that's the key Point okay so that is",
    "start": "346319",
    "end": "350120"
  },
  {
    "text": "really what uh you need to know about",
    "start": "350120",
    "end": "352880"
  },
  {
    "text": "tool use now we get to the fun stuff",
    "start": "352880",
    "end": "355720"
  },
  {
    "text": "we're going to build the agent and for",
    "start": "355720",
    "end": "357360"
  },
  {
    "text": "this I'm going to use Lang graph and I'm",
    "start": "357360",
    "end": "358680"
  },
  {
    "text": "going to explain kind of how this works",
    "start": "358680",
    "end": "360039"
  },
  {
    "text": "over time but first the way to think",
    "start": "360039",
    "end": "361919"
  },
  {
    "text": "about L graph is basically it's a way to",
    "start": "361919",
    "end": "363560"
  },
  {
    "text": "lay out",
    "start": "363560",
    "end": "364560"
  },
  {
    "text": "flows and flows in particular with L",
    "start": "364560",
    "end": "367199"
  },
  {
    "text": "graph are often characterized by Cycles",
    "start": "367199",
    "end": "369160"
  },
  {
    "text": "so the ability to kind of do feedback",
    "start": "369160",
    "end": "371479"
  },
  {
    "text": "and that's really relevant for agents",
    "start": "371479",
    "end": "373080"
  },
  {
    "text": "and we'll explain why here shortly so L",
    "start": "373080",
    "end": "375880"
  },
  {
    "text": "graph basically takes a state which can",
    "start": "375880",
    "end": "377560"
  },
  {
    "text": "live over the course of your graph or",
    "start": "377560",
    "end": "379199"
  },
  {
    "text": "flow and it can be accessed by all kind",
    "start": "379199",
    "end": "381840"
  },
  {
    "text": "of what we're going to call nodes in",
    "start": "381840",
    "end": "383599"
  },
  {
    "text": "your graph okay so first as state I'm",
    "start": "383599",
    "end": "386319"
  },
  {
    "text": "just going to find a set of messages and",
    "start": "386319",
    "end": "388280"
  },
  {
    "text": "don't worry too much about this for now",
    "start": "388280",
    "end": "389800"
  },
  {
    "text": "this will all make sense in about a",
    "start": "389800",
    "end": "391319"
  },
  {
    "text": "minute okay now here's where things are",
    "start": "391319",
    "end": "394000"
  },
  {
    "text": "going to get interesting I'm going to",
    "start": "394000",
    "end": "395919"
  },
  {
    "text": "Define an agent that contains two nodes",
    "start": "395919",
    "end": "399680"
  },
  {
    "text": "okay so",
    "start": "399680",
    "end": "403360"
  },
  {
    "text": "first first we're going to take our",
    "start": "403360",
    "end": "406160"
  },
  {
    "text": "input again it's a human message we pass",
    "start": "406160",
    "end": "408680"
  },
  {
    "text": "that to our LM which has the bound tools",
    "start": "408680",
    "end": "410759"
  },
  {
    "text": "the llm is going to make a decision to",
    "start": "410759",
    "end": "412880"
  },
  {
    "text": "use a tool or not and we just walk",
    "start": "412880",
    "end": "414360"
  },
  {
    "text": "through this that's the step one that's",
    "start": "414360",
    "end": "415879"
  },
  {
    "text": "this thing we've already seen right now",
    "start": "415879",
    "end": "418280"
  },
  {
    "text": "what we're going to do in Lang graph is",
    "start": "418280",
    "end": "419639"
  },
  {
    "text": "is we're going to add basic what we're",
    "start": "419639",
    "end": "421440"
  },
  {
    "text": "going to call an a conditional Edge so",
    "start": "421440",
    "end": "423120"
  },
  {
    "text": "this Edge is going to all it's going to",
    "start": "423120",
    "end": "424639"
  },
  {
    "text": "do is say was there a tool call or not",
    "start": "424639",
    "end": "427960"
  },
  {
    "text": "if there was a tool call I'm going to",
    "start": "427960",
    "end": "430039"
  },
  {
    "text": "route that over to a separate node that",
    "start": "430039",
    "end": "432319"
  },
  {
    "text": "basically runs the tool so let's walk",
    "start": "432319",
    "end": "434560"
  },
  {
    "text": "through with our example we just did um",
    "start": "434560",
    "end": "437199"
  },
  {
    "text": "what is Magic function of",
    "start": "437199",
    "end": "439120"
  },
  {
    "text": "three the llm made the decision to",
    "start": "439120",
    "end": "441520"
  },
  {
    "text": "invoke the magic function and it gave it",
    "start": "441520",
    "end": "443479"
  },
  {
    "text": "had the it gave us the payload right we",
    "start": "443479",
    "end": "445319"
  },
  {
    "text": "just saw that so that's arguments input",
    "start": "445319",
    "end": "447400"
  },
  {
    "text": "is three name is Magic function those",
    "start": "447400",
    "end": "450199"
  },
  {
    "text": "get plumbed over to what we're going to",
    "start": "450199",
    "end": "452199"
  },
  {
    "text": "call tool node which actually invokes",
    "start": "452199",
    "end": "455080"
  },
  {
    "text": "the necessary tool so it's going to",
    "start": "455080",
    "end": "456879"
  },
  {
    "text": "basically take in this name magic",
    "start": "456879",
    "end": "458639"
  },
  {
    "text": "function it's going to look up magic",
    "start": "458639",
    "end": "461000"
  },
  {
    "text": "function itself and it's basically just",
    "start": "461000",
    "end": "463160"
  },
  {
    "text": "going to run that function with this",
    "start": "463160",
    "end": "464919"
  },
  {
    "text": "input payload and then it's going to",
    "start": "464919",
    "end": "466960"
  },
  {
    "text": "return that as a tool message to the llm",
    "start": "466960",
    "end": "470159"
  },
  {
    "text": "that's all it's going to go on llm is",
    "start": "470159",
    "end": "472080"
  },
  {
    "text": "going to see that tool message it's",
    "start": "472080",
    "end": "473599"
  },
  {
    "text": "going to make a decision about what to",
    "start": "473599",
    "end": "474800"
  },
  {
    "text": "do next and eventually this is going to",
    "start": "474800",
    "end": "477280"
  },
  {
    "text": "keep running until there's a natural",
    "start": "477280",
    "end": "478720"
  },
  {
    "text": "language response",
    "start": "478720",
    "end": "480280"
  },
  {
    "text": "and this in this kind of toy example the",
    "start": "480280",
    "end": "482360"
  },
  {
    "text": "tool message would return with the",
    "start": "482360",
    "end": "483680"
  },
  {
    "text": "result of five that would be returned to",
    "start": "483680",
    "end": "485720"
  },
  {
    "text": "the LM the LM would see that and say",
    "start": "485720",
    "end": "487319"
  },
  {
    "text": "okay the result is five and then you",
    "start": "487319",
    "end": "489199"
  },
  {
    "text": "would exit so that's like the toy",
    "start": "489199",
    "end": "491120"
  },
  {
    "text": "example we want to we want to see now we",
    "start": "491120",
    "end": "493400"
  },
  {
    "text": "can implement this all in line graph",
    "start": "493400",
    "end": "494800"
  },
  {
    "text": "really easily and let's actually just",
    "start": "494800",
    "end": "496039"
  },
  {
    "text": "talk through that quickly I've copied",
    "start": "496039",
    "end": "497800"
  },
  {
    "text": "over the code here so all basic we've",
    "start": "497800",
    "end": "499919"
  },
  {
    "text": "defined here is we have this assistant",
    "start": "499919",
    "end": "501879"
  },
  {
    "text": "so this is basically just wrapping the",
    "start": "501879",
    "end": "504560"
  },
  {
    "text": "chain that we defined up here this",
    "start": "504560",
    "end": "505960"
  },
  {
    "text": "assistant runnable we just wrap that and",
    "start": "505960",
    "end": "508479"
  },
  {
    "text": "basically all doing here is we're adding",
    "start": "508479",
    "end": "510960"
  },
  {
    "text": "a",
    "start": "510960",
    "end": "511680"
  },
  {
    "text": "retry so basically if a tool is if a",
    "start": "511680",
    "end": "515200"
  },
  {
    "text": "tool is called then we're good that's",
    "start": "515200",
    "end": "517599"
  },
  {
    "text": "valid if it has meaningful text we're",
    "start": "517599",
    "end": "519839"
  },
  {
    "text": "good but otherwise we do reprompt it",
    "start": "519839",
    "end": "522518"
  },
  {
    "text": "that's all we're doing here right we're",
    "start": "522519",
    "end": "523919"
  },
  {
    "text": "just making sure that the llm actually",
    "start": "523919",
    "end": "525600"
  },
  {
    "text": "return to valid response so that's",
    "start": "525600",
    "end": "527399"
  },
  {
    "text": "really all to worry about here there um",
    "start": "527399",
    "end": "530040"
  },
  {
    "text": "we're also creating this tool node so",
    "start": "530040",
    "end": "532040"
  },
  {
    "text": "this tool node basically just will try",
    "start": "532040",
    "end": "533720"
  },
  {
    "text": "to invoke the tool um and it'll",
    "start": "533720",
    "end": "536560"
  },
  {
    "text": "basically have a little um we're going",
    "start": "536560",
    "end": "538560"
  },
  {
    "text": "to add a little thing to handle errors",
    "start": "538560",
    "end": "540440"
  },
  {
    "text": "in the feedback that this is all these",
    "start": "540440",
    "end": "542160"
  },
  {
    "text": "are just like utility functions so don't",
    "start": "542160",
    "end": "543600"
  },
  {
    "text": "really worry too much about them now",
    "start": "543600",
    "end": "545600"
  },
  {
    "text": "here's kind of the interesting bit we're",
    "start": "545600",
    "end": "547079"
  },
  {
    "text": "just going to build the graph and it's",
    "start": "547079",
    "end": "548240"
  },
  {
    "text": "going to look exactly like we show here",
    "start": "548240",
    "end": "550920"
  },
  {
    "text": "so what we're going to do is we're going",
    "start": "550920",
    "end": "552600"
  },
  {
    "text": "to add a node for our assistant right",
    "start": "552600",
    "end": "555160"
  },
  {
    "text": "we're going to add a node for our tool",
    "start": "555160",
    "end": "556640"
  },
  {
    "text": "node and that's kind of this piece and",
    "start": "556640",
    "end": "559040"
  },
  {
    "text": "this piece that's our tool node um and",
    "start": "559040",
    "end": "561600"
  },
  {
    "text": "then we're going to add this conditional",
    "start": "561600",
    "end": "562720"
  },
  {
    "text": "Edge which is a tools condition which is",
    "start": "562720",
    "end": "565040"
  },
  {
    "text": "all it's going to be is this piece it's",
    "start": "565040",
    "end": "566399"
  },
  {
    "text": "basically going to take the result from",
    "start": "566399",
    "end": "568120"
  },
  {
    "text": "the LM is a tool called if yes go to the",
    "start": "568120",
    "end": "571279"
  },
  {
    "text": "tool node if no end and we we can",
    "start": "571279",
    "end": "573720"
  },
  {
    "text": "Implement that right here um so this",
    "start": "573720",
    "end": "576200"
  },
  {
    "text": "tools condition that's all it's going to",
    "start": "576200",
    "end": "577480"
  },
  {
    "text": "do it's basically going to return either",
    "start": "577480",
    "end": "579079"
  },
  {
    "text": "a tool is invoked or end um and then we",
    "start": "579079",
    "end": "582720"
  },
  {
    "text": "go from tools back to the assistant now",
    "start": "582720",
    "end": "584320"
  },
  {
    "text": "let's run all this and we can see what's",
    "start": "584320",
    "end": "586200"
  },
  {
    "text": "nice about Lang graph is we actually",
    "start": "586200",
    "end": "588160"
  },
  {
    "text": "it'll automatically lay this out as a",
    "start": "588160",
    "end": "589560"
  },
  {
    "text": "graph for us we can visualize it here so",
    "start": "589560",
    "end": "591200"
  },
  {
    "text": "what's going to happen is we're going to",
    "start": "591200",
    "end": "592640"
  },
  {
    "text": "start we're going to invoke our",
    "start": "592640",
    "end": "594240"
  },
  {
    "text": "assistant um our assistant will in some",
    "start": "594240",
    "end": "597760"
  },
  {
    "text": "cases um ask to use a tool it'll go then",
    "start": "597760",
    "end": "601320"
  },
  {
    "text": "go to the tool node the tool will be",
    "start": "601320",
    "end": "602680"
  },
  {
    "text": "invoked that'll return to the assistant",
    "start": "602680",
    "end": "604600"
  },
  {
    "text": "and that will continue until there's",
    "start": "604600",
    "end": "606079"
  },
  {
    "text": "natural language response and then we'll",
    "start": "606079",
    "end": "607920"
  },
  {
    "text": "end that's it nice and easy so let's",
    "start": "607920",
    "end": "611600"
  },
  {
    "text": "actually test this",
    "start": "611600",
    "end": "613120"
  },
  {
    "text": "out",
    "start": "613120",
    "end": "614640"
  },
  {
    "text": "um and I'm going to go ahead let's ask a",
    "start": "614640",
    "end": "618279"
  },
  {
    "text": "super simple question so let's look at",
    "start": "618279",
    "end": "619720"
  },
  {
    "text": "we I have kind of two questions was",
    "start": "619720",
    "end": "621399"
  },
  {
    "text": "magic function 3 and was the weather and",
    "start": "621399",
    "end": "623079"
  },
  {
    "text": "SF let's ask question the first question",
    "start": "623079",
    "end": "625360"
  },
  {
    "text": "what's Magic function 3 boom so we're",
    "start": "625360",
    "end": "627399"
  },
  {
    "text": "going to run this now now like i' like",
    "start": "627399",
    "end": "629440"
  },
  {
    "text": "to go over to lsmith and look at the",
    "start": "629440",
    "end": "630680"
  },
  {
    "text": "result here so let's actually just walk",
    "start": "630680",
    "end": "632839"
  },
  {
    "text": "through this this basically allows us to",
    "start": "632839",
    "end": "635600"
  },
  {
    "text": "say we basically started we went to our",
    "start": "635600",
    "end": "637839"
  },
  {
    "text": "assistant and these are the functions",
    "start": "637839",
    "end": "640000"
  },
  {
    "text": "available to our assistant so that's",
    "start": "640000",
    "end": "641920"
  },
  {
    "text": "kind of know we gave it magic function",
    "start": "641920",
    "end": "643160"
  },
  {
    "text": "we gave it web search you know here's",
    "start": "643160",
    "end": "644839"
  },
  {
    "text": "the prompt what's Magic function 3 and",
    "start": "644839",
    "end": "646920"
  },
  {
    "text": "what we get as an output is again the",
    "start": "646920",
    "end": "649160"
  },
  {
    "text": "function to use and the payload to pass",
    "start": "649160",
    "end": "652279"
  },
  {
    "text": "to the function so again remember this",
    "start": "652279",
    "end": "654079"
  },
  {
    "text": "is kind of always a little bit of a",
    "start": "654079",
    "end": "655480"
  },
  {
    "text": "confusing thing an llm can't magically",
    "start": "655480",
    "end": "658040"
  },
  {
    "text": "call functions an is typed string to",
    "start": "658040",
    "end": "660360"
  },
  {
    "text": "string it can return strings um and it",
    "start": "660360",
    "end": "663120"
  },
  {
    "text": "ingests strings so that's fine all it's",
    "start": "663120",
    "end": "665880"
  },
  {
    "text": "going to return in this particular case",
    "start": "665880",
    "end": "667040"
  },
  {
    "text": "is just the payload to run the function",
    "start": "667040",
    "end": "669320"
  },
  {
    "text": "as well as the function name but that's",
    "start": "669320",
    "end": "671120"
  },
  {
    "text": "it that's all the LM is responsible for",
    "start": "671120",
    "end": "673480"
  },
  {
    "text": "then what we need to do is we have this",
    "start": "673480",
    "end": "675279"
  },
  {
    "text": "tools node see that's here that will",
    "start": "675279",
    "end": "678120"
  },
  {
    "text": "then invoke our function and so you can",
    "start": "678120",
    "end": "681120"
  },
  {
    "text": "see the input is just the argument the",
    "start": "681120",
    "end": "683079"
  },
  {
    "text": "output is you know 3 + uh 3 + 2 5 great",
    "start": "683079",
    "end": "687440"
  },
  {
    "text": "now this goes back to our llm",
    "start": "687440",
    "end": "690079"
  },
  {
    "text": "and then our llm just simply sees okay",
    "start": "690079",
    "end": "693079"
  },
  {
    "text": "it sees this tool message that the",
    "start": "693079",
    "end": "695079"
  },
  {
    "text": "function was called here's the output of",
    "start": "695079",
    "end": "696519"
  },
  {
    "text": "five and it returns natural language the",
    "start": "696519",
    "end": "698399"
  },
  {
    "text": "result of magic function is five and",
    "start": "698399",
    "end": "700680"
  },
  {
    "text": "then we end that's it nice and simple",
    "start": "700680",
    "end": "702800"
  },
  {
    "text": "and we can see that also kind of laid",
    "start": "702800",
    "end": "704160"
  },
  {
    "text": "out here here's our human message this",
    "start": "704160",
    "end": "706560"
  },
  {
    "text": "is the AI message um so basically the AI",
    "start": "706560",
    "end": "709279"
  },
  {
    "text": "makes a decision to invoke the tool and",
    "start": "709279",
    "end": "711240"
  },
  {
    "text": "it gives you the input payload then",
    "start": "711240",
    "end": "713399"
  },
  {
    "text": "here's the output tool message saying I",
    "start": "713399",
    "end": "715399"
  },
  {
    "text": "ran the tool here's the output the llm",
    "start": "715399",
    "end": "718440"
  },
  {
    "text": "gets that back and basically gives you",
    "start": "718440",
    "end": "720040"
  },
  {
    "text": "natural language and then based upon our",
    "start": "720040",
    "end": "722320"
  },
  {
    "text": "condition here this tools condition if",
    "start": "722320",
    "end": "724560"
  },
  {
    "text": "it's natural language it ends if it's a",
    "start": "724560",
    "end": "726519"
  },
  {
    "text": "tool invocation it goes back to the tool",
    "start": "726519",
    "end": "728920"
  },
  {
    "text": "node right so that goes to here um so in",
    "start": "728920",
    "end": "732040"
  },
  {
    "text": "this particular case it went back to the",
    "start": "732040",
    "end": "733800"
  },
  {
    "text": "assistant and now it's a natural",
    "start": "733800",
    "end": "735560"
  },
  {
    "text": "language response which means we just",
    "start": "735560",
    "end": "737040"
  },
  {
    "text": "end that's",
    "start": "737040",
    "end": "738720"
  },
  {
    "text": "it so that's kind of a nice and simple",
    "start": "738720",
    "end": "741880"
  },
  {
    "text": "example now if we go let's try something",
    "start": "741880",
    "end": "744360"
  },
  {
    "text": "light slight more complicated let's try",
    "start": "744360",
    "end": "746360"
  },
  {
    "text": "our other tool so let's like try what's",
    "start": "746360",
    "end": "748360"
  },
  {
    "text": "the weather and SF right now um so we're",
    "start": "748360",
    "end": "751560"
  },
  {
    "text": "going to try to run that and cool we can",
    "start": "751560",
    "end": "754199"
  },
  {
    "text": "actually see that it's going to call our",
    "start": "754199",
    "end": "756199"
  },
  {
    "text": "web search endpoint that's great it gets",
    "start": "756199",
    "end": "759040"
  },
  {
    "text": "this this kind of raw tool message back",
    "start": "759040",
    "end": "760800"
  },
  {
    "text": "from the endpoint and then the AI will",
    "start": "760800",
    "end": "763199"
  },
  {
    "text": "synthesize that into uh you know the",
    "start": "763199",
    "end": "765800"
  },
  {
    "text": "weather is 60° right now with mist okay",
    "start": "765800",
    "end": "768639"
  },
  {
    "text": "so that's really it this explains how",
    "start": "768639",
    "end": "770880"
  },
  {
    "text": "you can lay out arbitrary agents with",
    "start": "770880",
    "end": "773480"
  },
  {
    "text": "llama 3 open source llm uh we use chat",
    "start": "773480",
    "end": "777000"
  },
  {
    "text": "grock to do that grock has been uh",
    "start": "777000",
    "end": "780000"
  },
  {
    "text": "adapted for Tool use and that's the kind",
    "start": "780000",
    "end": "781959"
  },
  {
    "text": "of main important thing you need to",
    "start": "781959",
    "end": "783320"
  },
  {
    "text": "recognize that you need an LM that",
    "start": "783320",
    "end": "785160"
  },
  {
    "text": "actually has tool use enabled via",
    "start": "785160",
    "end": "786839"
  },
  {
    "text": "prompting or fine tuning or",
    "start": "786839",
    "end": "788560"
  },
  {
    "text": "otherwise um and what you can see is if",
    "start": "788560",
    "end": "792240"
  },
  {
    "text": "we kind of go back to the",
    "start": "792240",
    "end": "794000"
  },
  {
    "text": "diagram what we've done here is we're",
    "start": "794000",
    "end": "797279"
  },
  {
    "text": "using linecraft to kind of orchestrate",
    "start": "797279",
    "end": "798760"
  },
  {
    "text": "this process and what's going to happen",
    "start": "798760",
    "end": "800760"
  },
  {
    "text": "is you take a question in our L makes",
    "start": "800760",
    "end": "803959"
  },
  {
    "text": "the decision based on the question to",
    "start": "803959",
    "end": "805560"
  },
  {
    "text": "invoke a tool and then this conditional",
    "start": "805560",
    "end": "808880"
  },
  {
    "text": "Ed Ed will determine hey if a tool is is",
    "start": "808880",
    "end": "811880"
  },
  {
    "text": "kind of invoked then go to the tool node",
    "start": "811880",
    "end": "813920"
  },
  {
    "text": "and actually execute the tool the tool",
    "start": "813920",
    "end": "816199"
  },
  {
    "text": "is executed you get a tool message back",
    "start": "816199",
    "end": "818720"
  },
  {
    "text": "with the tool output send that back to",
    "start": "818720",
    "end": "820639"
  },
  {
    "text": "the LM LM reasons again and it could",
    "start": "820639",
    "end": "823639"
  },
  {
    "text": "make a decision to call another tool but",
    "start": "823639",
    "end": "825279"
  },
  {
    "text": "in our particular case in both cases the",
    "start": "825279",
    "end": "827639"
  },
  {
    "text": "tool message output was returned to the",
    "start": "827639",
    "end": "830600"
  },
  {
    "text": "LM the LM then responds in natural",
    "start": "830600",
    "end": "833320"
  },
  {
    "text": "language here is the solution and",
    "start": "833320",
    "end": "835279"
  },
  {
    "text": "because of that we end and that's it",
    "start": "835279",
    "end": "837759"
  },
  {
    "text": "that's kind of how to build an agent",
    "start": "837759",
    "end": "838839"
  },
  {
    "text": "from scratch using an open source llm",
    "start": "838839",
    "end": "841040"
  },
  {
    "text": "llama 3 with Lang Lang graph to",
    "start": "841040",
    "end": "843120"
  },
  {
    "text": "orchestrate it hopefully um from kind of",
    "start": "843120",
    "end": "846120"
  },
  {
    "text": "kind of very simple components and first",
    "start": "846120",
    "end": "847959"
  },
  {
    "text": "principles and again the key thing here",
    "start": "847959",
    "end": "850639"
  },
  {
    "text": "really is the ability or the ability for",
    "start": "850639",
    "end": "853240"
  },
  {
    "text": "an LM to reliably invoke tool so we",
    "start": "853240",
    "end": "856480"
  },
  {
    "text": "talked through the case of adding two",
    "start": "856480",
    "end": "857959"
  },
  {
    "text": "tools magic function and web search to",
    "start": "857959",
    "end": "860160"
  },
  {
    "text": "our agent now let's say we wanted to",
    "start": "860160",
    "end": "861959"
  },
  {
    "text": "make this a little bit more complicated",
    "start": "861959",
    "end": "863480"
  },
  {
    "text": "and try some additional tools so",
    "start": "863480",
    "end": "865959"
  },
  {
    "text": "replicate is a service allows you to to",
    "start": "865959",
    "end": "867920"
  },
  {
    "text": "access many different uh models which is",
    "start": "867920",
    "end": "870000"
  },
  {
    "text": "really convenient and I'm going to go",
    "start": "870000",
    "end": "872120"
  },
  {
    "text": "ahead and use it uh to augment llama 3",
    "start": "872120",
    "end": "875480"
  },
  {
    "text": "with a few multimodal capabilities so",
    "start": "875480",
    "end": "878160"
  },
  {
    "text": "all I've done is I've set my replicate",
    "start": "878160",
    "end": "879440"
  },
  {
    "text": "API key so I've actually already done",
    "start": "879440",
    "end": "881040"
  },
  {
    "text": "that I've import replicate and I'm going",
    "start": "881040",
    "end": "883040"
  },
  {
    "text": "to use a few different things here so",
    "start": "883040",
    "end": "884399"
  },
  {
    "text": "I'm going to do a text toer text to",
    "start": "884399",
    "end": "886360"
  },
  {
    "text": "image tool which is going to call this",
    "start": "886360",
    "end": "887880"
  },
  {
    "text": "particular model which is basically an",
    "start": "887880",
    "end": "889800"
  },
  {
    "text": "open doly model which will go text to",
    "start": "889800",
    "end": "891959"
  },
  {
    "text": "image um I'm going to create again",
    "start": "891959",
    "end": "894600"
  },
  {
    "text": "another tool image to text in this case",
    "start": "894600",
    "end": "896720"
  },
  {
    "text": "take an image in it'll use a lot laa uh",
    "start": "896720",
    "end": "899800"
  },
  {
    "text": "a version of lava to then produce text",
    "start": "899800",
    "end": "901839"
  },
  {
    "text": "from the image and text of speech this",
    "start": "901839",
    "end": "904320"
  },
  {
    "text": "is another option so really all you need",
    "start": "904320",
    "end": "907199"
  },
  {
    "text": "to do here is very simply just again use",
    "start": "907199",
    "end": "909160"
  },
  {
    "text": "this tool decorator with a function",
    "start": "909160",
    "end": "910759"
  },
  {
    "text": "definition that invokes the model of",
    "start": "910759",
    "end": "912880"
  },
  {
    "text": "choice so now the question is how do we",
    "start": "912880",
    "end": "915320"
  },
  {
    "text": "add these as tools to our agent so again",
    "start": "915320",
    "end": "917839"
  },
  {
    "text": "it's kind of like before all we need to",
    "start": "917839",
    "end": "919320"
  },
  {
    "text": "do is just update our tools list to",
    "start": "919320",
    "end": "922519"
  },
  {
    "text": "include some of our new functions here",
    "start": "922519",
    "end": "925240"
  },
  {
    "text": "that's it pretty simple now that tools",
    "start": "925240",
    "end": "927839"
  },
  {
    "text": "list is already bound to our our uh our",
    "start": "927839",
    "end": "931240"
  },
  {
    "text": "agent here so let's just go ahead and",
    "start": "931240",
    "end": "933319"
  },
  {
    "text": "kind of rerun everything just to make",
    "start": "933319",
    "end": "934839"
  },
  {
    "text": "sure this all works and I'm going to do",
    "start": "934839",
    "end": "937360"
  },
  {
    "text": "here is just update my question list to",
    "start": "937360",
    "end": "939480"
  },
  {
    "text": "include a few new questions that related",
    "start": "939480",
    "end": "941360"
  },
  {
    "text": "to my new tools and let's go ahead and",
    "start": "941360",
    "end": "943199"
  },
  {
    "text": "try one so let's say I want to try um my",
    "start": "943199",
    "end": "948279"
  },
  {
    "text": "index 2 question so questions two and",
    "start": "948279",
    "end": "951079"
  },
  {
    "text": "this is going to be my question related",
    "start": "951079",
    "end": "952399"
  },
  {
    "text": "to um image to uh this is going to be",
    "start": "952399",
    "end": "955680"
  },
  {
    "text": "text to image so let's basically say",
    "start": "955680",
    "end": "957759"
  },
  {
    "text": "I'll kick this off and I'll go back can",
    "start": "957759",
    "end": "959240"
  },
  {
    "text": "show you um so this is going to",
    "start": "959240",
    "end": "962440"
  },
  {
    "text": "basically uh in hopefully invoke the",
    "start": "962440",
    "end": "965680"
  },
  {
    "text": "text image tool based on this prompt a",
    "start": "965680",
    "end": "968480"
  },
  {
    "text": "yellow a yellow puppy uh running through",
    "start": "968480",
    "end": "971120"
  },
  {
    "text": "running free with wild flowers in the",
    "start": "971120",
    "end": "973920"
  },
  {
    "text": "mountains behind so that's our prompt",
    "start": "973920",
    "end": "976519"
  },
  {
    "text": "we're going to pass it to um our text",
    "start": "976519",
    "end": "979600"
  },
  {
    "text": "image",
    "start": "979600",
    "end": "980800"
  },
  {
    "text": "tool and it looks like that has been",
    "start": "980800",
    "end": "983279"
  },
  {
    "text": "called correctly so that's great now we",
    "start": "983279",
    "end": "985440"
  },
  {
    "text": "can also go over to",
    "start": "985440",
    "end": "986880"
  },
  {
    "text": "lsmith I can check my projects",
    "start": "986880",
    "end": "989600"
  },
  {
    "text": "here uh cool here's my agent here it is",
    "start": "989600",
    "end": "993000"
  },
  {
    "text": "running so we can also look at the trace",
    "start": "993000",
    "end": "994560"
  },
  {
    "text": "to confirm that everything's working so",
    "start": "994560",
    "end": "996880"
  },
  {
    "text": "cool so it looks like it is calling text",
    "start": "996880",
    "end": "999319"
  },
  {
    "text": "image tool so that's fantastic that's",
    "start": "999319",
    "end": "1001240"
  },
  {
    "text": "running right",
    "start": "1001240",
    "end": "1003800"
  },
  {
    "text": "now great so our tool ran now we can",
    "start": "1004680",
    "end": "1007319"
  },
  {
    "text": "check our image here and look at that",
    "start": "1007319",
    "end": "1009800"
  },
  {
    "text": "very nice so again this is just showing",
    "start": "1009800",
    "end": "1012319"
  },
  {
    "text": "you the ability to create agents that",
    "start": "1012319",
    "end": "1015079"
  },
  {
    "text": "have many different types of tools again",
    "start": "1015079",
    "end": "1017680"
  },
  {
    "text": "previously we only had covered uh kind",
    "start": "1017680",
    "end": "1019800"
  },
  {
    "text": "of two very simple tools a magic",
    "start": "1019800",
    "end": "1021319"
  },
  {
    "text": "function web search but we can actually",
    "start": "1021319",
    "end": "1022959"
  },
  {
    "text": "do pretty interesting things so this",
    "start": "1022959",
    "end": "1024319"
  },
  {
    "text": "actually shows how you can take",
    "start": "1024319",
    "end": "1025558"
  },
  {
    "text": "replicate for example and basically",
    "start": "1025559",
    "end": "1028000"
  },
  {
    "text": "invoke many different llms hosted by",
    "start": "1028000",
    "end": "1029959"
  },
  {
    "text": "replicate or or know not just llms but",
    "start": "1029959",
    "end": "1032720"
  },
  {
    "text": "different types of models so this is a",
    "start": "1032720",
    "end": "1034280"
  },
  {
    "text": "text image model image of text and so",
    "start": "1034280",
    "end": "1036240"
  },
  {
    "text": "forth text of speech basically to",
    "start": "1036240",
    "end": "1038280"
  },
  {
    "text": "augment llama 3 and give it multimodal",
    "start": "1038280",
    "end": "1040000"
  },
  {
    "text": "capabilities so in any case it's a",
    "start": "1040000",
    "end": "1042079"
  },
  {
    "text": "really nice kind of illustration of the",
    "start": "1042079",
    "end": "1043839"
  },
  {
    "text": "fact that um agents are very general and",
    "start": "1043839",
    "end": "1047319"
  },
  {
    "text": "tools can be composed of many different",
    "start": "1047319",
    "end": "1049720"
  },
  {
    "text": "kinds of things in this particular case",
    "start": "1049720",
    "end": "1051440"
  },
  {
    "text": "different models through replicate which",
    "start": "1051440",
    "end": "1053520"
  },
  {
    "text": "we can attach to llama 3 to augments",
    "start": "1053520",
    "end": "1056000"
  },
  {
    "text": "capabilities thanks",
    "start": "1056000",
    "end": "1060000"
  }
]