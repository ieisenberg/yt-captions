[
  {
    "start": "0",
    "end": "131000"
  },
  {
    "text": "[Music]",
    "start": "2550",
    "end": "10170"
  },
  {
    "text": "good afternoon and um welcome to my talk about um dismantling Android apps um",
    "start": "11320",
    "end": "17600"
  },
  {
    "text": "before I start that's the usual slide from the conference organizers so please do rate this talk if you think it was",
    "start": "17600",
    "end": "22960"
  },
  {
    "text": "the most awesome talk ever rate it if you think it was the crappiest talk ever rate it um this is very helpful",
    "start": "22960",
    "end": "29439"
  },
  {
    "text": "information for both the conference organizers and me um before I dive into",
    "start": "29439",
    "end": "34640"
  },
  {
    "text": "the topic of um what code inspect is all about and why I think all your code belongs to us so me and my colleagues um",
    "start": "34640",
    "end": "42200"
  },
  {
    "text": "I'll give you a short introduction about uh myself and the research group I come from so uh I come from technicial",
    "start": "42200",
    "end": "48920"
  },
  {
    "text": "University at damad which is a university in Germany about 30 kilom south of Frankfurt and we do uh security",
    "start": "48920",
    "end": "57000"
  },
  {
    "text": "research um so the subgroup I'm in mostly on um applying program analysis",
    "start": "57000",
    "end": "63600"
  },
  {
    "text": "to uh Android for security reasons who of you knows about program",
    "start": "63600",
    "end": "69439"
  },
  {
    "text": "analysis okay that's a few um for the others program analysis is creating",
    "start": "69439",
    "end": "75080"
  },
  {
    "text": "algorithms and programs that reason about other programs so you developers you write a program and my programs take",
    "start": "75080",
    "end": "82680"
  },
  {
    "text": "that program as input that you give me and say okay this is a potential security vulnerability this is an",
    "start": "82680",
    "end": "89320"
  },
  {
    "text": "inconsistent see here you don't have this Access Control check that you had over there or that say okay this is a",
    "start": "89320",
    "end": "95040"
  },
  {
    "text": "potential null pointer exception that might be flying around uh at runtime and um this is especially",
    "start": "95040",
    "end": "102680"
  },
  {
    "text": "helpful for uh security as we will see and uh if you're interested in uh",
    "start": "102680",
    "end": "109119"
  },
  {
    "text": "what we do in the group then you can also visit our blog so we occasionally publish um uh vulnerabilities we",
    "start": "109119",
    "end": "116360"
  },
  {
    "text": "detected in the Android operating system we already had a couple uh of them that were also acknowledged and fixed by",
    "start": "116360",
    "end": "122039"
  },
  {
    "text": "Google and if you're looking for tools that's also the right place to go and now without further Ado let's dive into",
    "start": "122039",
    "end": "129399"
  },
  {
    "text": "the content um I think all of you know that uh Google Play Store who of you has",
    "start": "129399",
    "end": "135200"
  },
  {
    "start": "131000",
    "end": "191000"
  },
  {
    "text": "already published an app on the Play store okay majority that's great that",
    "start": "135200",
    "end": "140239"
  },
  {
    "text": "means I'm in the right room um so normally when you uh think",
    "start": "140239",
    "end": "145319"
  },
  {
    "text": "about publishing apps on the Play Store um you have a certain model in mind",
    "start": "145319",
    "end": "150480"
  },
  {
    "text": "this model consists of a developer and a user and usually your idea is that um",
    "start": "150480",
    "end": "155720"
  },
  {
    "text": "you as a developer you're the one in power you have the mighty source code this means that you can create the app",
    "start": "155720",
    "end": "162840"
  },
  {
    "text": "you can modify it you can reason about the app and you're the only one and the",
    "start": "162840",
    "end": "168120"
  },
  {
    "text": "user on the other side just gets the binary code so all he can do is run the app and nothing",
    "start": "168120",
    "end": "174640"
  },
  {
    "text": "else but what I will show you is um or what I will talk about is how easy is it",
    "start": "174640",
    "end": "180480"
  },
  {
    "text": "for the user to actually gain more power and to dismantle that Android app and",
    "start": "180480",
    "end": "185560"
  },
  {
    "text": "say okay I want to behave like a developer I want to know what's going in on inside this app and this is a",
    "start": "185560",
    "end": "192200"
  },
  {
    "start": "191000",
    "end": "250000"
  },
  {
    "text": "question not only I am asking because if you look at stack Overflow you find this quite a number of times so for instance",
    "start": "192200",
    "end": "199159"
  },
  {
    "text": "here's a guy um who said that okay I've heard that it's very easy to um pirate",
    "start": "199159",
    "end": "204560"
  },
  {
    "text": "Android apps is there anything I can do about it to make it harder for people or",
    "start": "204560",
    "end": "210360"
  },
  {
    "text": "here's another guy um they complained that only about 5% of um all",
    "start": "210360",
    "end": "216200"
  },
  {
    "text": "installations of that game were actually paid for and the other ones were from some uh Shady places on the net and were",
    "start": "216200",
    "end": "222879"
  },
  {
    "text": "not being paid for or even another one this guy's also",
    "start": "222879",
    "end": "228640"
  },
  {
    "text": "asking okay if there's someone determined to Pirate my app exploit security vulnerabilities do any strange",
    "start": "228640",
    "end": "235519"
  },
  {
    "text": "stuff with it how easy is it for him so even if he has not doesn't have the",
    "start": "235519",
    "end": "241120"
  },
  {
    "text": "source codee um can he do um bad things to my app can he know what I did in",
    "start": "241120",
    "end": "246799"
  },
  {
    "text": "terms of protection and undo it and this is exactly what I'm talking about I'm talking about how we can break",
    "start": "246799",
    "end": "254400"
  },
  {
    "start": "250000",
    "end": "445000"
  },
  {
    "text": "into your app so the stuff you do for a living I'm uh telling you how to break it and um for that I'll introduce a new",
    "start": "254400",
    "end": "261680"
  },
  {
    "text": "tool called code inspect which is a binary analysis framework for Android so",
    "start": "261680",
    "end": "267639"
  },
  {
    "text": "again the model is that you have the developer that has the source code and the user only has the binary code but",
    "start": "267639",
    "end": "275039"
  },
  {
    "text": "we're doing what we're doing here is we um give him a tool that allows him to",
    "start": "275039",
    "end": "280400"
  },
  {
    "text": "act as if he had the source code do the very same stuff inject code remove code",
    "start": "280400",
    "end": "286400"
  },
  {
    "text": "modify code debug the app understand what's going on",
    "start": "286400",
    "end": "291800"
  },
  {
    "text": "there and so what's your first thought when you hear that usually people ask me",
    "start": "291960",
    "end": "298759"
  },
  {
    "text": "but why I mean I'm standing here I'm not um trying to run away from the police so",
    "start": "298759",
    "end": "304520"
  },
  {
    "text": "why should I kind of um break into other people's apps one answer because I can",
    "start": "304520",
    "end": "310160"
  },
  {
    "text": "second answer is um there's actually a good reason for it because there are legitimate apps where there is usually",
    "start": "310160",
    "end": "317199"
  },
  {
    "text": "no reason to break into and there is mware on the Play store or on the some",
    "start": "317199",
    "end": "322560"
  },
  {
    "text": "other stores so for instance in China you have app stores that have um apps of about onethird that are melbour so one",
    "start": "322560",
    "end": "330919"
  },
  {
    "text": "out of three apps is actually something you don't want and um for these things you also",
    "start": "330919",
    "end": "336560"
  },
  {
    "text": "only get the app but you want to know what these guys are doing you want to find out is this app for which I only",
    "start": "336560",
    "end": "343120"
  },
  {
    "text": "have the binary code is this malware and if so are they stealing my credit card",
    "start": "343120",
    "end": "348280"
  },
  {
    "text": "data are they running some premium SMS scam so sending SMS messages to premium",
    "start": "348280",
    "end": "353800"
  },
  {
    "text": "rate numbers at my cost or um are they actually trying to uh en trip my phone",
    "start": "353800",
    "end": "360120"
  },
  {
    "text": "and get some ransom for me so what is this guy and there it makes sense to kind of break into the um into the",
    "start": "360120",
    "end": "368120"
  },
  {
    "text": "malare and this is the the usual process that for instance um AV companies do",
    "start": "368120",
    "end": "374240"
  },
  {
    "text": "antivirus vendors here just replace the developer by the fraudster and replace",
    "start": "374240",
    "end": "380400"
  },
  {
    "text": "the uh user by the investigator and then you exactly have the have this scenario",
    "start": "380400",
    "end": "386160"
  },
  {
    "text": "where someone needs to go the development cycle the other way around and reverse engineer an Android",
    "start": "386160",
    "end": "392880"
  },
  {
    "text": "app and that's in the end what it's all about making it easier for the reverse engineer to understand but also to",
    "start": "392880",
    "end": "401919"
  },
  {
    "text": "manipulate question why manipulate because sometimes if you just read code",
    "start": "401919",
    "end": "407440"
  },
  {
    "text": "you don't directly understand what it's all about but if you're for instance able to inject a monitor inside there",
    "start": "407440",
    "end": "413960"
  },
  {
    "text": "that gives you runtime information or if you're able to um inject additional uh",
    "start": "413960",
    "end": "419599"
  },
  {
    "text": "debugging and logging this makes it way easier so as a Mel analyst I sometimes",
    "start": "419599",
    "end": "424840"
  },
  {
    "text": "also want to change the Mel or if there's specific protection in there that tries to hinder me from inspecting",
    "start": "424840",
    "end": "431680"
  },
  {
    "text": "the melbar like only do the malicious behavior if you run on a phone located in southern China I want to get rid of",
    "start": "431680",
    "end": "439039"
  },
  {
    "text": "that I don't want to fly to Southern China just to inspect that",
    "start": "439039",
    "end": "443720"
  },
  {
    "text": "melbour and um this is a quick glimpse of the of the tool so the idea is that",
    "start": "444759",
    "end": "450599"
  },
  {
    "text": "you have something that looks just like the development environment with the only difference that it's an analyst's",
    "start": "450599",
    "end": "457759"
  },
  {
    "text": "environment let me quickly go into the over the details here so um who of you",
    "start": "457759",
    "end": "463919"
  },
  {
    "text": "knows the the old Android developer tools for Eclipse okay quite a few I know that",
    "start": "463919",
    "end": "471639"
  },
  {
    "text": "Android has switched to intellig J but our environment is still based on uh on Eclipse because we started when ADT was",
    "start": "471639",
    "end": "478120"
  },
  {
    "text": "still for um for clipse with the first version of that code so what you do is you can import your binary application",
    "start": "478120",
    "end": "485759"
  },
  {
    "text": "in into the tool you get the packages and the class names in your normal",
    "start": "485759",
    "end": "491680"
  },
  {
    "text": "hierarchy just like the developer had you can look at things like the",
    "start": "491680",
    "end": "498400"
  },
  {
    "text": "Manifest file to see which components there are you can look at the assets see if there is anything hidden so some",
    "start": "498400",
    "end": "505159"
  },
  {
    "text": "mware applications for instance they give you a secondary Dex or APK file",
    "start": "505159",
    "end": "510360"
  },
  {
    "text": "hidden in the original one so that if you just look at the outer thing you don't find the malicious code but the",
    "start": "510360",
    "end": "515959"
  },
  {
    "text": "malicious code is somewhere else sometimes it's even in something called a JPEG file that is not actually a JPEG",
    "start": "515959",
    "end": "522399"
  },
  {
    "text": "but that is code and this is also something you can see here and I'll show a live demo about that in a",
    "start": "522399",
    "end": "528320"
  },
  {
    "text": "minute of course you have the code now um this code might not look too familiar",
    "start": "528320",
    "end": "534519"
  },
  {
    "text": "to you if you look at it this code is not Java code and it's not assembly code either in the uh instead it's a language",
    "start": "534519",
    "end": "543000"
  },
  {
    "text": "called jimple jimple stands somewhere between assembly and normal Java code",
    "start": "543000",
    "end": "549240"
  },
  {
    "text": "jimple is like Java but simple and the idea is that if you have a malware developer he'll try all sorts of stuff",
    "start": "549240",
    "end": "556800"
  },
  {
    "text": "to try and prevent this reverse engineering so he will uh Jack code that",
    "start": "556800",
    "end": "562839"
  },
  {
    "text": "you cannot easily get back to to Java code for instance in Java there is a quite clear semantics to what a loop is",
    "start": "562839",
    "end": "569519"
  },
  {
    "text": "on bite code I can create Loops that jump everywhere in the code on certain conditions this is not possible in Java",
    "start": "569519",
    "end": "576320"
  },
  {
    "text": "so I I can't uh possibly get Java code back from such an off fiscated app and this is why we instead rely on this",
    "start": "576320",
    "end": "583560"
  },
  {
    "text": "intermediate representation instead of just going back to to",
    "start": "583560",
    "end": "589399"
  },
  {
    "text": "Java then as usual for these um for the uh Eclipse base tool there is the the",
    "start": "589519",
    "end": "595519"
  },
  {
    "text": "code outline so you actually see what this consists of you see the Fields you see the methods and so",
    "start": "595519",
    "end": "603120"
  },
  {
    "text": "on you have the usual thing like syntax errors because I can also change this code representation if I want to if I do",
    "start": "604079",
    "end": "611160"
  },
  {
    "text": "something wrong I want to get alerted about it I see the output from the lock cat so what the application writes back",
    "start": "611160",
    "end": "618000"
  },
  {
    "text": "to me as an analyst and of course I can search through it and this whole thing just",
    "start": "618000",
    "end": "624279"
  },
  {
    "text": "looks and feels like eclipse for the analyst this means that it's not too hard to get started reverse",
    "start": "624279",
    "end": "630360"
  },
  {
    "text": "engineering Android apps so you can just obtain the tool and look at your first",
    "start": "630360",
    "end": "635760"
  },
  {
    "text": "malware but for you as a developer this also means that every guy from the street can just use a tool like this or",
    "start": "635760",
    "end": "642560"
  },
  {
    "start": "636000",
    "end": "738000"
  },
  {
    "text": "one of the other competitor tools and say okay I take your app that you develop and I reverse engineer it and so",
    "start": "642560",
    "end": "650440"
  },
  {
    "text": "protection um against reverse engineering or against um all sorts of",
    "start": "650440",
    "end": "656120"
  },
  {
    "text": "attacks is more important than ever and as we have heard in one of the previous talks there are ways to to protect apps",
    "start": "656120",
    "end": "663680"
  },
  {
    "text": "as I'll show you it's it's a bit harder um or it's it's getting harder and harder because um some of the",
    "start": "663680",
    "end": "669519"
  },
  {
    "text": "protections we've heard in the previous talks like um checking the signature or doing an emulator check or root check",
    "start": "669519",
    "end": "676760"
  },
  {
    "text": "can actually be bypassed pretty easily but we'll we'll see that in the",
    "start": "676760",
    "end": "682760"
  },
  {
    "text": "in the live demo and the most important thing is",
    "start": "682760",
    "end": "690000"
  },
  {
    "text": "with a with uh these tools you can also debug because just looking at a disassembly will not give you the the",
    "start": "690000",
    "end": "696639"
  },
  {
    "text": "full information about what this uh what this app does what you instead can do",
    "start": "696639",
    "end": "702240"
  },
  {
    "text": "here is you can just at any position set a breakpoint and say okay I want to know what this binary application is doing",
    "start": "702240",
    "end": "708240"
  },
  {
    "text": "here you have the normal stack trays you have the variables view you have all the things you know from um from normal Java",
    "start": "708240",
    "end": "716360"
  },
  {
    "text": "debugging lockhead console all that stuff",
    "start": "716360",
    "end": "723519"
  },
  {
    "text": "um so the these features are are just those that you that you as a developer are known to um that is available to",
    "start": "723519",
    "end": "731920"
  },
  {
    "text": "everyone who just has the APK file um so that was a short short intro",
    "start": "731920",
    "end": "738680"
  },
  {
    "start": "738000",
    "end": "1178000"
  },
  {
    "text": "over the tool let me just quickly go over the architecture I know that this this architecture thingy is maybe",
    "start": "738680",
    "end": "744399"
  },
  {
    "text": "slightly boring but um I'll do it quickly and then go into the live demo because I think that will be much more",
    "start": "744399",
    "end": "750399"
  },
  {
    "text": "interesting uh doing live hacking than just going over boring architecture slides um anyway so um to build a tool",
    "start": "750399",
    "end": "758880"
  },
  {
    "text": "like this um what kind of foundation can you use so this is built on um the open",
    "start": "758880",
    "end": "764920"
  },
  {
    "text": "source compiler construction framework suit does anybody know it okay so at research conferences",
    "start": "764920",
    "end": "772160"
  },
  {
    "text": "usually there are a couple of fans when I mentioned suit um this was originally started at McGill University and used",
    "start": "772160",
    "end": "779199"
  },
  {
    "text": "used to um to optimize Java code and has more recently evolved into um into a",
    "start": "779199",
    "end": "786680"
  },
  {
    "text": "compiler and optimization instrumentation framework also for Android the idea is you have uh input",
    "start": "786680",
    "end": "794040"
  },
  {
    "text": "formats that can be Dex files APK files Java source code files uh Java class",
    "start": "794040",
    "end": "799519"
  },
  {
    "text": "files and you can input and output those so I can easily say let's take a DEX",
    "start": "799519",
    "end": "805040"
  },
  {
    "text": "file put it into suit come back with a um with a java Cloud class file or take",
    "start": "805040",
    "end": "810920"
  },
  {
    "text": "a Java class file and merge it into an APK so I can just add code to an",
    "start": "810920",
    "end": "816480"
  },
  {
    "text": "existing APK and besides uh being such a translator the suit framework also offer",
    "start": "816480",
    "end": "822920"
  },
  {
    "text": "things like um giving you a call graph so showing you for every method call",
    "start": "822920",
    "end": "828920"
  },
  {
    "text": "where this goes to or where this can come from um so all the interaction between the methods can uh just be um",
    "start": "828920",
    "end": "836519"
  },
  {
    "text": "put into one concise graph by that tool or um you can also do um code synthesis",
    "start": "836519",
    "end": "843839"
  },
  {
    "text": "so if you for instance want to say let's put in uh put a lock at print after uh",
    "start": "843839",
    "end": "849040"
  },
  {
    "text": "each uh statement that accesses my device ID that's something that you can do with this compiler framework and",
    "start": "849040",
    "end": "855360"
  },
  {
    "text": "since we built on top of the compiler framework um the um the code inspect tool can um can use all the the",
    "start": "855360",
    "end": "863720"
  },
  {
    "text": "expressiveness of the of that framework which makes it uh possible to um",
    "start": "863720",
    "end": "869920"
  },
  {
    "text": "not only have something like small or buck small that you might know which just is a translator but to also have",
    "start": "869920",
    "end": "876199"
  },
  {
    "text": "things like powerful visualizations and so on by the way who of you know SMY bu",
    "start": "876199",
    "end": "881360"
  },
  {
    "text": "SMY uh quite a few so um this is just uh a translator from uh Dex to some umum",
    "start": "881360",
    "end": "888320"
  },
  {
    "text": "readable code and back to Dex and we're going beyond that and this whole suit framework has been under development uh",
    "start": "888320",
    "end": "895560"
  },
  {
    "text": "by research groups around the world for more than 10 years",
    "start": "895560",
    "end": "900600"
  },
  {
    "text": "um quickly I told you about that intermediate rep presentation called gimple so um the idea here is that you",
    "start": "900800",
    "end": "907759"
  },
  {
    "text": "have something that is close enough to bite code that you can represent all the weird stuff that people can do in bite",
    "start": "907759",
    "end": "912800"
  },
  {
    "text": "code but also be still human readable which is not the case with um things or",
    "start": "912800",
    "end": "918759"
  },
  {
    "text": "not that easily the case with things like uh like smly code that is just",
    "start": "918759",
    "end": "923920"
  },
  {
    "text": "plain hard to read and um this language can can also be used for for",
    "start": "923920",
    "end": "930560"
  },
  {
    "text": "manipulation uh just a quick um just uh quickly going over that so this is an",
    "start": "930560",
    "end": "936720"
  },
  {
    "text": "actual piece of melor this comes from um from the Korea banking Trojan I'll also",
    "start": "936720",
    "end": "941759"
  },
  {
    "text": "use for the live demo and which I'll go into the details on uh in just a minute",
    "start": "941759",
    "end": "948040"
  },
  {
    "text": "and um what you see here is that um this mware actually takes some uh APK file",
    "start": "948040",
    "end": "954680"
  },
  {
    "text": "from the SD card and later on installs it and this um AP K file was originally",
    "start": "954680",
    "end": "960880"
  },
  {
    "text": "downloaded from a server so there is a command control infrastructure here where the um the server tells the tells",
    "start": "960880",
    "end": "968240"
  },
  {
    "text": "the mware I've got a new version or some code that you need to execute the mware downloads the code puts it on the SD",
    "start": "968240",
    "end": "974360"
  },
  {
    "text": "card reads it in installs it and deletes the file from the SD card and the",
    "start": "974360",
    "end": "979399"
  },
  {
    "text": "interesting thing about um these mon class of tools for which code inspect is an example is that um they will give you",
    "start": "979399",
    "end": "987600"
  },
  {
    "text": "something that that has the constant strings here so even if this originally wasn't a constant but this was computed",
    "start": "987600",
    "end": "993360"
  },
  {
    "text": "somehow there is a so-called uh constant propagator and folder running through it",
    "start": "993360",
    "end": "998519"
  },
  {
    "text": "that will make sure that even if this was originally concatenation of SD card and test somewhere up there that you",
    "start": "998519",
    "end": "1004600"
  },
  {
    "text": "will get the string the full string here and you as an analyst can easily see it um another uh advantage of of these",
    "start": "1004600",
    "end": "1013600"
  },
  {
    "text": "modern kinds of tools is that um you actually have a type language so if you look at things like like small e code or",
    "start": "1013600",
    "end": "1019959"
  },
  {
    "text": "like disassembly that you get from things like Ida Pro you only get registers here you have actual variable",
    "start": "1019959",
    "end": "1026240"
  },
  {
    "text": "names that are typed as you see on top so RB is actually a bite and this is a",
    "start": "1026240",
    "end": "1031520"
  },
  {
    "text": "file output stream so it's very easy to read this um if you've just if you know",
    "start": "1031520",
    "end": "1036839"
  },
  {
    "text": "Java and you spend like 10 minutes going through that code you have the usual style of first",
    "start": "1036839",
    "end": "1044199"
  },
  {
    "text": "your method declaration then um the variable declarations and then just the",
    "start": "1044199",
    "end": "1049760"
  },
  {
    "text": "implementation of um the method um actually this um cheat sheet",
    "start": "1049760",
    "end": "1056880"
  },
  {
    "text": "that describes the full language that we use here if you print it out it fits on 1 A4 page um for PowerPoint I had to to",
    "start": "1056880",
    "end": "1065160"
  },
  {
    "text": "um split it up onto uh three slides in total um but what I want to show here is",
    "start": "1065160",
    "end": "1070720"
  },
  {
    "text": "simply that this is um something that gives you quite a lot of information along the way so for a field you see the",
    "start": "1070720",
    "end": "1078400"
  },
  {
    "text": "modif iers you see the type you see the field name um for a class you also see",
    "start": "1078400",
    "end": "1083840"
  },
  {
    "text": "the modifier you see what it extends whether it implements an interface so um",
    "start": "1083840",
    "end": "1089080"
  },
  {
    "text": "you get all this information um directly like you had in Java and for the code um the the biggest",
    "start": "1089080",
    "end": "1098520"
  },
  {
    "text": "difference to normal Java that you will notice is that um the method calls are a bit different so on uh on the bite code",
    "start": "1098520",
    "end": "1106559"
  },
  {
    "text": "level which we're talking here so where we where this originally comes from you don't just have a method call but you",
    "start": "1106559",
    "end": "1112200"
  },
  {
    "text": "have kind of four different method calls and the three most important ones is",
    "start": "1112200",
    "end": "1117840"
  },
  {
    "text": "that it distinguishes between um whether you call an interface the static method",
    "start": "1117840",
    "end": "1123480"
  },
  {
    "text": "or kind of the normal normal virtual call but again this is um if you just",
    "start": "1123480",
    "end": "1128600"
  },
  {
    "text": "want to read the code and this is still fairly simple and one other thing we need to to",
    "start": "1128600",
    "end": "1134919"
  },
  {
    "text": "take care of when we're talking about um about something close to bite code there",
    "start": "1134919",
    "end": "1140159"
  },
  {
    "text": "are no blocks so there is no if then else instead ifs just as in bite code",
    "start": "1140159",
    "end": "1146840"
  },
  {
    "text": "are um represented by if this condition holds then go to there which is a jump",
    "start": "1146840",
    "end": "1152559"
  },
  {
    "text": "instruction if not fall through same story for Loop a loop is just a go-to with an if and so these",
    "start": "1152559",
    "end": "1161320"
  },
  {
    "text": "three things um Loops conditions and um and the uh split up uh invoke",
    "start": "1161320",
    "end": "1168120"
  },
  {
    "text": "Expressions they are the biggest difference to to normal Java",
    "start": "1168120",
    "end": "1173600"
  },
  {
    "text": "code okay so enough of the boring stuff uh I think half of the the room is asleep um so let's go to something more",
    "start": "1177720",
    "end": "1185480"
  },
  {
    "start": "1178000",
    "end": "1508000"
  },
  {
    "text": "interesting um that is not just academic stuff but but the real deal um we have",
    "start": "1185480",
    "end": "1192840"
  },
  {
    "text": "analyzed a piece of malware coming from Korea so um if you're looking for for funny malware don't St in Europe um the",
    "start": "1192840",
    "end": "1200280"
  },
  {
    "text": "the much more funny maware you get from places like Russia Korea China um there",
    "start": "1200280",
    "end": "1206840"
  },
  {
    "text": "are actually M uh play stores as I told you play store equivalents that serve you onethird malware so just download 10",
    "start": "1206840",
    "end": "1214400"
  },
  {
    "text": "apps uh usually you get three melbour apps by just picking randomly not good",
    "start": "1214400",
    "end": "1219960"
  },
  {
    "text": "if you want to use them on your productive phone if you're trying to analyze mware there you go um this one",
    "start": "1219960",
    "end": "1227080"
  },
  {
    "text": "um they had an app on the um on the market that um told you it you would get a preview",
    "start": "1227080",
    "end": "1235000"
  },
  {
    "text": "version of the the interview movie and that was before the movie was out so people downloaded that and said hey I",
    "start": "1235000",
    "end": "1241280"
  },
  {
    "text": "get the movie before my neighbor gets it and I get it for free and this is all because they are nice people and and",
    "start": "1241280",
    "end": "1248480"
  },
  {
    "text": "there were a lot of users that didn't really think that there might be something slightly wrong with it and um",
    "start": "1248480",
    "end": "1255640"
  },
  {
    "text": "well actually there is something wrong with it because um this was by no means",
    "start": "1255640",
    "end": "1260679"
  },
  {
    "text": "the the interview movie this was just a plain old piece of malware and um this",
    "start": "1260679",
    "end": "1266890"
  },
  {
    "text": "[Music] um infected over 20,000 phones so there were apparently a lot of people that",
    "start": "1266890",
    "end": "1272640"
  },
  {
    "text": "were keen on getting the movie if you look at this this Mel it's",
    "start": "1272640",
    "end": "1277880"
  },
  {
    "text": "actually a fairly complex piece so from the users's point what this does is it",
    "start": "1277880",
    "end": "1283159"
  },
  {
    "text": "first checks whether um you have um a certain number of Korean Bank apps",
    "start": "1283159",
    "end": "1289000"
  },
  {
    "text": "installed on your um device if not it will just don't do anything uh if you have these apps",
    "start": "1289000",
    "end": "1295640"
  },
  {
    "text": "installed it will impersonate them so if you're um a customer of Bank a and have",
    "start": "1295640",
    "end": "1301039"
  },
  {
    "text": "their app installed this Mala will just look like the user interface of banking app a if you have B installed it will",
    "start": "1301039",
    "end": "1307440"
  },
  {
    "text": "look just like banking app B and they had this implemented for 10 or 12 apps so someone was actually putting real",
    "start": "1307440",
    "end": "1313840"
  },
  {
    "text": "effort in that not in getting the movie but in getting your bank data and um this malel then had um depending",
    "start": "1313840",
    "end": "1322799"
  },
  {
    "text": "on the bank they had emulated the security features of the bank so if your bank had a special let's say um password",
    "start": "1322799",
    "end": "1329720"
  },
  {
    "text": "for a certificate you had on your phone for accessing your bank account then this mware would know that and ask you",
    "start": "1329720",
    "end": "1336000"
  },
  {
    "text": "for the password to that certificate if you're a customer of another bank where you don't need a password for a certificate it won't ask you for a",
    "start": "1336000",
    "end": "1342640"
  },
  {
    "text": "password for a certificate so if people have been in the talks here at go toon",
    "start": "1342640",
    "end": "1348000"
  },
  {
    "text": "about user interface design those guys got it right because they knew what to steal from",
    "start": "1348000",
    "end": "1355000"
  },
  {
    "text": "you and um so what did they do they showed the the banking API asked for",
    "start": "1355720",
    "end": "1362919"
  },
  {
    "text": "username password bank account number the certificate password if required and",
    "start": "1362919",
    "end": "1368320"
  },
  {
    "text": "a lot of other stuff and in the background they had um a command and control interface running so actually a",
    "start": "1368320",
    "end": "1374840"
  },
  {
    "text": "server could send additional commands to the mare to activate extra features",
    "start": "1374840",
    "end": "1380159"
  },
  {
    "text": "so for instance update the stuff that's great we have learned about continuous delivery at gotoon these guys do it um",
    "start": "1380159",
    "end": "1388159"
  },
  {
    "text": "Additionally the command and control server can send an uh SMS message to that uh mare to um activate uh SMS",
    "start": "1388159",
    "end": "1397039"
  },
  {
    "text": "message interception so whatever SMS message you get it's leaked to the attacker this is not because the",
    "start": "1397039",
    "end": "1403400"
  },
  {
    "text": "attacker wants to know what your grandmother's telling you about her birthday this is because you get transaction numbers from your bank Via",
    "start": "1403400",
    "end": "1409640"
  },
  {
    "text": "SMS and that's what the attackers are interested in and they are also able if people get",
    "start": "1409640",
    "end": "1417080"
  },
  {
    "text": "suspicious or if police are hunting after them to disable that again and um",
    "start": "1417080",
    "end": "1422159"
  },
  {
    "text": "then the application will just will hide its icon from the launcher and more or",
    "start": "1422159",
    "end": "1427880"
  },
  {
    "text": "less be gone another story that we see here for all this this data exfiltration um they",
    "start": "1427880",
    "end": "1435919"
  },
  {
    "text": "use two channels so um for stealing your SMS messages they will send it out via",
    "start": "1435919",
    "end": "1442240"
  },
  {
    "text": "HTTP but at the same time they will send it out via email because they want to do",
    "start": "1442240",
    "end": "1448039"
  },
  {
    "text": "resilient programming if something goes wrong you don't want to disturb the user experience right or the Mel experience",
    "start": "1448039",
    "end": "1454799"
  },
  {
    "text": "because if police is taking down your HTTP server why stop stealing the stuff just go via email and um I think",
    "start": "1454799",
    "end": "1463480"
  },
  {
    "text": "sometimes we as as normal programmers can learn quite a bit from Mela developers when com to things like user",
    "start": "1463480",
    "end": "1469399"
  },
  {
    "text": "interfaces resilience and so on so um where did we get this piece of",
    "start": "1469399",
    "end": "1475320"
  },
  {
    "text": "Mel from that was an ongoing collaboration with mffi the antivirus company um from the pretest they knew",
    "start": "1475320",
    "end": "1482200"
  },
  {
    "text": "that this was going on so there's some emails sent and there's some HTTP connection but the big question was um",
    "start": "1482200",
    "end": "1489840"
  },
  {
    "text": "where is this data sent to so what is the email address there and hopefully if we get a password we can then give this",
    "start": "1489840",
    "end": "1496399"
  },
  {
    "text": "password also um to the uh to the police so that they can check whether there is still stolen",
    "start": "1496399",
    "end": "1502200"
  },
  {
    "text": "data inside the account and now the big question is how do you do that and this is the the",
    "start": "1502200",
    "end": "1508840"
  },
  {
    "start": "1508000",
    "end": "1590000"
  },
  {
    "text": "content of the live demo so what you usually what you usually do is um you",
    "start": "1508840",
    "end": "1515880"
  },
  {
    "text": "first have to import the the APK file what I can do is I can just put the APK",
    "start": "1515880",
    "end": "1521399"
  },
  {
    "text": "or I can attach my phone and import the APK file from the phone I'm not so keen on running mware on my real phone so",
    "start": "1521399",
    "end": "1527880"
  },
  {
    "text": "I'll just just import the file and just in like in normal development environments I can specify a",
    "start": "1527880",
    "end": "1533799"
  },
  {
    "text": "project name and um the file since the import takes a while I've already done",
    "start": "1533799",
    "end": "1539559"
  },
  {
    "text": "that for you because I want to waste your time um on the left side here you",
    "start": "1539559",
    "end": "1544760"
  },
  {
    "text": "see that this is the um the contents of this um of this piece of malware so um",
    "start": "1544760",
    "end": "1552200"
  },
  {
    "text": "what you see here is let's go through it you see the assets oh interesting there's another APK file so they don't",
    "start": "1552200",
    "end": "1558039"
  },
  {
    "text": "want to see us want us to see all the code they put a second APK file and somewhere inside that mware they",
    "start": "1558039",
    "end": "1564320"
  },
  {
    "text": "actually loading that additional code interesting you see that there is some",
    "start": "1564320",
    "end": "1570520"
  },
  {
    "text": "um Native code inside there so apparently they're trying to to hide stuff if we decompile the the dovic part",
    "start": "1570520",
    "end": "1577600"
  },
  {
    "text": "or the the Android part and hide it inside native code or another interesting thing is if",
    "start": "1577600",
    "end": "1584720"
  },
  {
    "text": "you look into the resources they actually um they're actually uh",
    "start": "1584720",
    "end": "1591520"
  },
  {
    "start": "1590000",
    "end": "1651000"
  },
  {
    "text": "rather good developers because what they do is they don't just put the the um user interface strings as um as normal",
    "start": "1591520",
    "end": "1598440"
  },
  {
    "text": "strings they use the strings.xml as an abstraction and they put it all into resources maybe in case they want late",
    "start": "1598440",
    "end": "1604720"
  },
  {
    "text": "to later translate their MW to Russian or whatnot so for things like enter",
    "start": "1604720",
    "end": "1610279"
  },
  {
    "text": "password enter account um they even have proper error messages like hey you entered in an",
    "start": "1610279",
    "end": "1616320"
  },
  {
    "text": "invalid password that's too short I don't speak Korean but if you put this into Google translate it will tell you",
    "start": "1616320",
    "end": "1621840"
  },
  {
    "text": "something like that so that's also an interesting um story this melur actually checks whether",
    "start": "1621840",
    "end": "1628320"
  },
  {
    "text": "the data you enter makes sense if you enter an account number that is not valid for the for the bank that um you",
    "start": "1628320",
    "end": "1634559"
  },
  {
    "text": "originally that was originally detected on your phone they tell you hey you mistyped your account number I'm not going to steal that well they're not",
    "start": "1634559",
    "end": "1640640"
  },
  {
    "text": "showing you the the second part of the sentence but they're showing you hey check what you",
    "start": "1640640",
    "end": "1646039"
  },
  {
    "text": "entered so um that's all interesting now let's let's look into the Manifest um we",
    "start": "1646039",
    "end": "1652000"
  },
  {
    "start": "1651000",
    "end": "1705000"
  },
  {
    "text": "see another story that is um quite normal for melur so you see that they uh",
    "start": "1652000",
    "end": "1657799"
  },
  {
    "text": "request one or another permission and these are like I wouldn't say harmful but let's say interesting",
    "start": "1657799",
    "end": "1664880"
  },
  {
    "text": "permissions like read SMS Read contacts uh call phone read call lock",
    "start": "1664880",
    "end": "1672480"
  },
  {
    "text": "um also very interesting uh receive boot completed because just because the user rebooted his phone you don't want to",
    "start": "1672480",
    "end": "1678519"
  },
  {
    "text": "stop your scam keep the business",
    "start": "1678519",
    "end": "1683000"
  },
  {
    "text": "going and ah there's also kill background processes because if you detect the original banking app you of",
    "start": "1685679",
    "end": "1691080"
  },
  {
    "text": "course don't want the user to use the original banking app but you want him to use the",
    "start": "1691080",
    "end": "1696360"
  },
  {
    "text": "mware um and if you go through that let's just see where to start because usually um these apps are are rather",
    "start": "1696440",
    "end": "1703960"
  },
  {
    "text": "large um so let's see if we have something like main here",
    "start": "1703960",
    "end": "1709559"
  },
  {
    "start": "1705000",
    "end": "1778000"
  },
  {
    "text": "or n even better let's let's go for what is in the launcher right and you find something that is called main activity",
    "start": "1709559",
    "end": "1716120"
  },
  {
    "text": "that is good and never mind the package name um this was chosen by the Mel developers they are funny people they",
    "start": "1716120",
    "end": "1721840"
  },
  {
    "text": "name packages like this now let's go to um the definition",
    "start": "1721840",
    "end": "1727240"
  },
  {
    "text": "and uh there's an oncreate uh let's look into this for a second so um first of all you will see",
    "start": "1727240",
    "end": "1736480"
  },
  {
    "text": "that um there's actually a lot of code but this there's already something interesting right there is something",
    "start": "1736480",
    "end": "1742799"
  },
  {
    "text": "called get Banks info so as I told you they're checking which bank your customer of they don't want to scam the",
    "start": "1742799",
    "end": "1748760"
  },
  {
    "text": "wrong bank they have things like the bank",
    "start": "1748760",
    "end": "1754480"
  },
  {
    "text": "URL and oops here we go there is something that is that looks like a",
    "start": "1754559",
    "end": "1759840"
  },
  {
    "text": "username and a password here um so this is our first candidate for that um for",
    "start": "1759840",
    "end": "1765679"
  },
  {
    "text": "that email access remember they were stealing your data all of our email and we were interested in getting the username password for",
    "start": "1765679",
    "end": "1772279"
  },
  {
    "text": "that so probably we should set a breakpoint inside this method and see what's happening",
    "start": "1772279",
    "end": "1777799"
  },
  {
    "text": "here let's just do that um yeah this is the normal debug configuration thingy",
    "start": "1777799",
    "end": "1784080"
  },
  {
    "start": "1778000",
    "end": "2008000"
  },
  {
    "text": "from from Eclipse only thing is I'm debugging on on a binary now not on source code and I",
    "start": "1784080",
    "end": "1791399"
  },
  {
    "text": "want to use my emulator here I could also start a new emulator or a real device but running on real devices is a",
    "start": "1791399",
    "end": "1799279"
  },
  {
    "text": "rather bad idea so I won't do it so waiting for debugger to settle aha it's",
    "start": "1799279",
    "end": "1804559"
  },
  {
    "text": "asking me whether I want to open the debug perspective sure I",
    "start": "1804559",
    "end": "1809518"
  },
  {
    "text": "do okay so um this is essentially a super call that's nothing too",
    "start": "1810039",
    "end": "1815200"
  },
  {
    "text": "interesting let's go further now they call a method that is called um is e and",
    "start": "1815200",
    "end": "1821600"
  },
  {
    "text": "they store the result in something called z0 and the result is true what we see",
    "start": "1821600",
    "end": "1828120"
  },
  {
    "text": "here is if Z 0er is true we go to label three let's see what label three is oops",
    "start": "1828120",
    "end": "1834440"
  },
  {
    "text": "that's killing the app so um the question is why does the the melber just try to kill my",
    "start": "1834440",
    "end": "1841840"
  },
  {
    "text": "app and um so let's just look into this is because apparently is e made the app",
    "start": "1844440",
    "end": "1851039"
  },
  {
    "text": "kill itself and if you look in here that's interesting they get the mobile",
    "start": "1851039",
    "end": "1856080"
  },
  {
    "text": "info and the phone State and then they check whether this contains strings such as goldfish",
    "start": "1856080",
    "end": "1861840"
  },
  {
    "text": "SDK Android does anyone have a have a clue",
    "start": "1861840",
    "end": "1866880"
  },
  {
    "text": "what this could be yeah this is an emulator detector so",
    "start": "1866880",
    "end": "1873240"
  },
  {
    "text": "um we saw that this um the return value was true of course because I'm running on emulator but I don't want the app to",
    "start": "1873240",
    "end": "1880440"
  },
  {
    "text": "die because I want to continue my investigation here so let's just fix",
    "start": "1880440",
    "end": "1885960"
  },
  {
    "text": "that there should be should be we should be ah Z zero okay nah I'm not running on",
    "start": "1885960",
    "end": "1891919"
  },
  {
    "text": "an emulator sorry y here we go Z zero is false jump",
    "start": "1891919",
    "end": "1899840"
  },
  {
    "text": "over it no it's not an emulator these aren't the draws you're looking for",
    "start": "1899840",
    "end": "1904919"
  },
  {
    "text": "um okay let's let's just um go over all the garbage here um we were interested",
    "start": "1904919",
    "end": "1911320"
  },
  {
    "text": "in whatever they were doing with that password or username or what business",
    "start": "1911320",
    "end": "1918440"
  },
  {
    "text": "okay so what they do is they call a method called string user here just give",
    "start": "1921240",
    "end": "1927000"
  },
  {
    "text": "it a try and see see where this comes from oh this actually comes from native so this is exactly what this native",
    "start": "1927000",
    "end": "1933279"
  },
  {
    "text": "library was for because this string user and string password these were Native",
    "start": "1933279",
    "end": "1938600"
  },
  {
    "text": "functions so they're trying to hide the username and password from us by just putting it in Native but we're in a",
    "start": "1938600",
    "end": "1945120"
  },
  {
    "text": "debugger so let's say this variable string is the outcome of this call so they put",
    "start": "1945120",
    "end": "1951279"
  },
  {
    "text": "it in Native but it's not of not much use because I can just see the value here and um this has been taken down now",
    "start": "1951279",
    "end": "1959320"
  },
  {
    "text": "so don't try to steal the account data and sell it on the black market it's",
    "start": "1959320",
    "end": "1964480"
  },
  {
    "text": "down same story if we step on and look for the password here we",
    "start": "1964480",
    "end": "1971960"
  },
  {
    "text": "go so even if you put things into native code they're not gone they're simply",
    "start": "1971960",
    "end": "1977360"
  },
  {
    "text": "there put a debugger and that's it now",
    "start": "1977360",
    "end": "1983559"
  },
  {
    "text": "um before we go on let me just make one change because I know that I will forget",
    "start": "1983559",
    "end": "1989320"
  },
  {
    "text": "this emulator check at some point during the demo so let's let's get rid of it for",
    "start": "1989320",
    "end": "1995799"
  },
  {
    "text": "good I just commanded out save the project it says building workspace here we go emulator check is completely gone",
    "start": "1995799",
    "end": "2002600"
  },
  {
    "text": "so I don't have to fiddle around with this no I'm not an emulator thingy",
    "start": "2002600",
    "end": "2007960"
  },
  {
    "text": "now what we haven't found yet is um where they actually sent this email right um what we can do here is um at",
    "start": "2007960",
    "end": "2018399"
  },
  {
    "start": "2008000",
    "end": "2436000"
  },
  {
    "text": "some point these guys um steal SMS messages right so um we can see whether",
    "start": "2018399",
    "end": "2025240"
  },
  {
    "text": "they um where they actually use this um receive",
    "start": "2025240",
    "end": "2031840"
  },
  {
    "text": "SMS ah here we go so this is an intern filter for SM received let's just see",
    "start": "2033399",
    "end": "2039720"
  },
  {
    "text": "where this goes yeah there's this is an internet",
    "start": "2039720",
    "end": "2044799"
  },
  {
    "text": "filter for a hell of a lot of stuff never mind let's go into that once again Melba",
    "start": "2044799",
    "end": "2052240"
  },
  {
    "text": "developers are interesting people they they seem to like four",
    "start": "2052240",
    "end": "2058638"
  },
  {
    "text": "letter words I don't know why um okay so there is an onreceive",
    "start": "2058639",
    "end": "2065240"
  },
  {
    "text": "method and once again what I can do here is um I can simply set a",
    "start": "2065240",
    "end": "2072399"
  },
  {
    "text": "breakpoint so uh I need to run my app again yeah same old",
    "start": "2073879",
    "end": "2081200"
  },
  {
    "text": "emulator yeah installing launching connecting",
    "start": "2081200",
    "end": "2086559"
  },
  {
    "text": "debugger oh okay I forgot to put out the breako in oncreate in",
    "start": "2086800",
    "end": "2092720"
  },
  {
    "text": "main okay and now uh of course this is inter accepting SMS messages so let's do",
    "start": "2093720",
    "end": "2100079"
  },
  {
    "text": "send it an SMS message let's say it's coming from 4242 and it's an SMS",
    "start": "2100079",
    "end": "2106920"
  },
  {
    "text": "saying hello go toon let's just send",
    "start": "2106920",
    "end": "2112800"
  },
  {
    "text": "it that is ah yeah okay I didn't activate it um so the interesting thing",
    "start": "2114160",
    "end": "2121920"
  },
  {
    "text": "about this is oops this is that um as I told you",
    "start": "2121920",
    "end": "2127359"
  },
  {
    "text": "there is a feature that enables you to activate and deactivate the SMS stealing if we um go back into the code we can",
    "start": "2127359",
    "end": "2134320"
  },
  {
    "text": "see that pretty pretty simply um this this activation and",
    "start": "2134320",
    "end": "2139760"
  },
  {
    "text": "deactivation thingy is um is controlled by by getting the uh",
    "start": "2139760",
    "end": "2146680"
  },
  {
    "text": "first the phone number so this will only accept phone numbers that start with 86 or 82 which are the uh country codes for",
    "start": "2146680",
    "end": "2154560"
  },
  {
    "text": "Korea and China and then they do some some funny parsing here and",
    "start": "2154560",
    "end": "2161000"
  },
  {
    "text": "um what they do is where are we um yeah",
    "start": "2161000",
    "end": "2167520"
  },
  {
    "text": "they they check for a command called ak-40 don't ask me why they named it this one and um if you send a message uh",
    "start": "2167520",
    "end": "2175599"
  },
  {
    "text": "with a correct telephone number so plus 46 or plus 42 something and ak-40 1 it",
    "start": "2175599",
    "end": "2181880"
  },
  {
    "text": "will enable the SMS stealing ak-40 0 it will disable the SMS stealing",
    "start": "2181880",
    "end": "2188359"
  },
  {
    "text": "and in case the the app gets restarted it's good practice to save it right persistent state so they just use shed",
    "start": "2188359",
    "end": "2195040"
  },
  {
    "text": "preferences and save it as SMS status don't make the attacker send the",
    "start": "2195040",
    "end": "2200880"
  },
  {
    "text": "status twice that's a bad user experience you want to avoid",
    "start": "2200880",
    "end": "2206160"
  },
  {
    "text": "this so now let's",
    "start": "2206160",
    "end": "2210480"
  },
  {
    "text": "just start that one again and send it the the magic activ",
    "start": "2213079",
    "end": "2219520"
  },
  {
    "text": "SMS message yeah uh by the way you might be",
    "start": "2219960",
    "end": "2226960"
  },
  {
    "text": "wondering why there isn't an error coming through this is a pretty simple thing because it says unknown host exception",
    "start": "2226960",
    "end": "2233560"
  },
  {
    "text": "cannot resolve Host this one um first of all I'm in an emulator so this has no",
    "start": "2233560",
    "end": "2238920"
  },
  {
    "text": "internet connection and secondly police tend to take down malware hosts so um this is just not resolvable",
    "start": "2238920",
    "end": "2246359"
  },
  {
    "text": "anymore that's that's also one of the things you have to deal with when looking into mare um sometimes these",
    "start": "2246359",
    "end": "2252200"
  },
  {
    "text": "hosts are not reachable anymore or there is some other funny Behavior going",
    "start": "2252200",
    "end": "2258760"
  },
  {
    "text": "on okay for for this one we were looking for",
    "start": "2260760",
    "end": "2266480"
  },
  {
    "text": "um plus 82 right plus 82 so let's just do plus",
    "start": "2266680",
    "end": "2273599"
  },
  {
    "text": "82 I'll just send this here",
    "start": "2275119",
    "end": "2279440"
  },
  {
    "text": "oops",
    "start": "2286359",
    "end": "2289359"
  },
  {
    "text": "oh okay yeah that's that's apparently a new one anyway so um this will usually uh",
    "start": "2297319",
    "end": "2305880"
  },
  {
    "text": "just make the debugger hit that break p and uh show you the incoming SMS message and they will write this value into",
    "start": "2305880",
    "end": "2312119"
  },
  {
    "text": "shared preferences um also interesting is that you find calls to abort",
    "start": "2312119",
    "end": "2318680"
  },
  {
    "text": "broadcast um what this does is um if this message is actually coming from",
    "start": "2318680",
    "end": "2324160"
  },
  {
    "text": "your bank um they want to um or now make it differently if you want to contact",
    "start": "2324160",
    "end": "2330480"
  },
  {
    "text": "your bank uh and say hey I think there's something wrong or if your bank wants to contact you and say okay your account",
    "start": "2330480",
    "end": "2335920"
  },
  {
    "text": "has been hacked you want want to disable this because you don't want the people to um be warned about the mware so what",
    "start": "2335920",
    "end": "2342640"
  },
  {
    "text": "the developers actually did here the mware writers they aborted incoming phone calls and SMS messages coming from",
    "start": "2342640",
    "end": "2348760"
  },
  {
    "text": "the bank um so that people aren't warned um interestingly there was a bug",
    "start": "2348760",
    "end": "2354440"
  },
  {
    "text": "inside there so um the original version of the mware they aborted uh also incoming phone calls from other people",
    "start": "2354440",
    "end": "2361079"
  },
  {
    "text": "not only from the bank um this is a bit unfortunate but",
    "start": "2361079",
    "end": "2366319"
  },
  {
    "text": "you see that sometimes Melba developers aren't good developers either so um I guess they should have put in more",
    "start": "2366319",
    "end": "2372240"
  },
  {
    "text": "testing some regression tests some junit tests should have fixed the stuff uh so",
    "start": "2372240",
    "end": "2377280"
  },
  {
    "text": "if there are Mela developers among you um do test your code before roll out uh",
    "start": "2377280",
    "end": "2382640"
  },
  {
    "text": "that might actually hinder your scam if you're doing it wrong um now let's just quickly go into",
    "start": "2382640",
    "end": "2390400"
  },
  {
    "text": "the in the interest of time let's just quickly go into",
    "start": "2390400",
    "end": "2395880"
  },
  {
    "text": "the um into the the actual scamming Parts um you see this call here to to",
    "start": "2395880",
    "end": "2402319"
  },
  {
    "text": "post Json so this is doing the HTTP sending part and um I think it was inide",
    "start": "2402319",
    "end": "2410599"
  },
  {
    "text": "three there is the actual mail send and if I set a breakpoint here and run the app once again which I won't do in the",
    "start": "2410599",
    "end": "2416480"
  },
  {
    "text": "interest of time you will see that this was the very password that we saw when we debug the the",
    "start": "2416480",
    "end": "2422440"
  },
  {
    "text": "oncreate and um you also see the contents of your incoming SMS messages",
    "start": "2422440",
    "end": "2427760"
  },
  {
    "text": "being stolen here um I think that's that's enough for",
    "start": "2427760",
    "end": "2433079"
  },
  {
    "text": "the live demo let me just go back to to the slides so you have seen that the tools like this can be very helpful for",
    "start": "2433079",
    "end": "2439800"
  },
  {
    "text": "inspecting mware if you're a mware writer times are getting harder for you but also for software development uh",
    "start": "2439800",
    "end": "2447119"
  },
  {
    "text": "sometimes you have a library of which you only have the the binary code but not the source code but something's crashing in your app when you use the",
    "start": "2447119",
    "end": "2453160"
  },
  {
    "text": "library with these tools you can just debug inside the library and see what the real cause is and how you can get",
    "start": "2453160",
    "end": "2459079"
  },
  {
    "text": "that fixed you can look for security vulnerabilities inside these",
    "start": "2459079",
    "end": "2464760"
  },
  {
    "text": "libraries and you can uh see what happens under the hood so you can understand these libraries",
    "start": "2464760",
    "end": "2470400"
  },
  {
    "text": "better of course don't be evil so um copyright laws still apply these tools",
    "start": "2470400",
    "end": "2475640"
  },
  {
    "start": "2471000",
    "end": "2518000"
  },
  {
    "text": "can be used to um steal intellectual property from other people's apps for",
    "start": "2475640",
    "end": "2481520"
  },
  {
    "text": "instance uh a nice algorithm reverse engineered copy it possible but illegal",
    "start": "2481520",
    "end": "2488000"
  },
  {
    "text": "um or you remove licensing checks assume you have an app in the Play Store that is free but if you want to let's say",
    "start": "2488000",
    "end": "2494040"
  },
  {
    "text": "play more than three levels in the game you have to pay for it uh if this is simply a check hey if I'm paid I can",
    "start": "2494040",
    "end": "2501280"
  },
  {
    "text": "command it out takes me about a minute still it's illegal but possible",
    "start": "2501280",
    "end": "2507280"
  },
  {
    "text": "and if you want to protect your app keep that in mind so simple checks like the emulator in the melbour example they",
    "start": "2507280",
    "end": "2513359"
  },
  {
    "text": "won't do it anymore",
    "start": "2513359",
    "end": "2516880"
  },
  {
    "start": "2518000",
    "end": "2555000"
  },
  {
    "text": "um I guess we talked about most of that um so my claim is all your code belongs",
    "start": "2518720",
    "end": "2523800"
  },
  {
    "text": "to us so all apps are essentially open source in one way or another as we have",
    "start": "2523800",
    "end": "2528880"
  },
  {
    "text": "seen um never hide secrets in the app code so credentials for for backends",
    "start": "2528880",
    "end": "2534240"
  },
  {
    "text": "encryption Keys just don't hide it there because it's visible to everybody and if you release an app it's",
    "start": "2534240",
    "end": "2541559"
  },
  {
    "text": "totally simple to to piggy back melbour inside there you have seen the code you have seen that I could change the code",
    "start": "2541559",
    "end": "2548119"
  },
  {
    "text": "I could have also injected melbour it's simple and cracking paid apps is also",
    "start": "2548119",
    "end": "2553200"
  },
  {
    "text": "rather simple um one more concrete thing um we have conducted a study on backend as a",
    "start": "2553200",
    "end": "2560000"
  },
  {
    "start": "2555000",
    "end": "2664000"
  },
  {
    "text": "service providers so um you know what backend as a service is okay so there are people that don't",
    "start": "2560000",
    "end": "2566480"
  },
  {
    "text": "run their own backends they rent it off Amazon or whatnot um we have looked into",
    "start": "2566480",
    "end": "2571760"
  },
  {
    "text": "how people access these backends and usually they hard code their username and password we will present present",
    "start": "2571760",
    "end": "2577400"
  },
  {
    "text": "that study at blackhead in Europe in Amsterdam in November interesting is we",
    "start": "2577400",
    "end": "2582599"
  },
  {
    "text": "found in total uh over 80 million records um and uh more than 56 million",
    "start": "2582599",
    "end": "2589880"
  },
  {
    "text": "individual data items that were accessible just through the credentials",
    "start": "2589880",
    "end": "2595800"
  },
  {
    "text": "that were openly available inside apps we conducted that study together with the respective um providers so we are in",
    "start": "2595800",
    "end": "2602400"
  },
  {
    "text": "contact with Amazon or um Facebook who owns parse.com so this is not just some shady hecky",
    "start": "2602400",
    "end": "2609280"
  },
  {
    "text": "business we do on the side um we cooperate with the with the vendors to close these",
    "start": "2609280",
    "end": "2614480"
  },
  {
    "text": "gaps and um these are not just gaps in these are not gaps in the back ends these are things that developers got",
    "start": "2614480",
    "end": "2620640"
  },
  {
    "text": "wrong they threw their credentials to the World by putting them into the M or yeah we have seen mware but also goodw",
    "start": "2620640",
    "end": "2628200"
  },
  {
    "text": "with these vulnerabilities what we got there these records there were email addresses",
    "start": "2628200",
    "end": "2633920"
  },
  {
    "text": "health records employee databases customer Port databases we have seen",
    "start": "2633920",
    "end": "2639040"
  },
  {
    "text": "full server backups residing there or also voice records of car crashes so",
    "start": "2639040",
    "end": "2645280"
  },
  {
    "text": "please if you store sensitive data privacy sensitive data whatever do not put your credentials inside the app or",
    "start": "2645280",
    "end": "2651920"
  },
  {
    "text": "else the data is just gone uh and we've seen cases where aner could actually manipulate the data so um",
    "start": "2651920",
    "end": "2659720"
  },
  {
    "text": "increase you on salary or whatever you want counter measures um in one of the",
    "start": "2659720",
    "end": "2665800"
  },
  {
    "start": "2664000",
    "end": "2746000"
  },
  {
    "text": "previous talks we've heard of you so string encryption",
    "start": "2665800",
    "end": "2672240"
  },
  {
    "text": "um doesn't help too much because um you can still use the debugger and when the string is used it has to be decrypted in",
    "start": "2672359",
    "end": "2679240"
  },
  {
    "text": "memory uh for string encryption when the string is finally used it still has to um be available in memory so then just",
    "start": "2679240",
    "end": "2687119"
  },
  {
    "text": "set a breakpoint and run off with a string a code encryption well at some",
    "start": "2687119",
    "end": "2692920"
  },
  {
    "text": "point the code must be decrypted put a break point and access the file before it's load",
    "start": "2692920",
    "end": "2698520"
  },
  {
    "text": "loed hide calls and reflection well I might not be seeing from the code where this call is going because it's a",
    "start": "2698520",
    "end": "2705040"
  },
  {
    "text": "reflective call with a weird string but I can use the step into feature and",
    "start": "2705040",
    "end": "2710160"
  },
  {
    "text": "arrive in the right method or debugger detection just like the emulator detection in the mware we",
    "start": "2710160",
    "end": "2716880"
  },
  {
    "text": "patch it out uh I think I only got a couple of minutes left so um one thing I want to",
    "start": "2716880",
    "end": "2724000"
  },
  {
    "text": "to show is the the plugin system so um one of the plugins we have for this tool",
    "start": "2724000",
    "end": "2729599"
  },
  {
    "text": "is data flow analyzer so this will automatically tell you which data is red",
    "start": "2729599",
    "end": "2734800"
  },
  {
    "text": "and where the data is sent to and this can also help you analyze such a piece of malware by saying okay this reads",
    "start": "2734800",
    "end": "2740359"
  },
  {
    "text": "from here and rites to here um yeah um for instance in that case you",
    "start": "2740359",
    "end": "2748760"
  },
  {
    "start": "2746000",
    "end": "2781000"
  },
  {
    "text": "see that this is the source this is a sync method and the data is Flowing along the",
    "start": "2748760",
    "end": "2754839"
  },
  {
    "text": "arrows and in the in the Cod ECT UI this is just um a list of the data flows and",
    "start": "2754839",
    "end": "2761440"
  },
  {
    "text": "the propagation path along which the data is is shown uh in the program for instance here this you see",
    "start": "2761440",
    "end": "2768760"
  },
  {
    "text": "the source method you click on it you see all the statements involved in propagating the",
    "start": "2768760",
    "end": "2774839"
  },
  {
    "text": "data and you can jump to the code where this happens and this is also one of the things we can use for looking into",
    "start": "2774839",
    "end": "2781520"
  },
  {
    "start": "2781000",
    "end": "2821000"
  },
  {
    "text": "melver we were working on more plugins like um automatic deop case",
    "start": "2781520",
    "end": "2787880"
  },
  {
    "text": "um reconstructing encrypted runtime values fully automatically and much",
    "start": "2787880",
    "end": "2793440"
  },
  {
    "text": "more maybe I can show you this in a future edition of go to call um one",
    "start": "2793440",
    "end": "2798559"
  },
  {
    "text": "thing that might be interesting for a few of you is how you can get the tool um we're currently looking into",
    "start": "2798559",
    "end": "2805240"
  },
  {
    "text": "commercializing the product so with University which means that the basic technology is is free and open source",
    "start": "2805240",
    "end": "2810800"
  },
  {
    "text": "and all on GitHub um the UI is not but you can send me an email uh and get a",
    "start": "2810800",
    "end": "2816559"
  },
  {
    "text": "free 60-day uh license that's no problem so um with that um let me end",
    "start": "2816559",
    "end": "2823440"
  },
  {
    "text": "the talk I hope you had a bit of fun and learned something about investigating um malware",
    "start": "2823440",
    "end": "2829359"
  },
  {
    "text": "applications and um remember to Rite that session thank [Applause]",
    "start": "2829359",
    "end": "2839760"
  },
  {
    "text": "you okay thank you very much Stephen uh you actually answered a lot of the questions that came in during the last",
    "start": "2839760",
    "end": "2845720"
  },
  {
    "text": "slides I just I have one question for you you mentioned something about uh Android studio uh is it something that",
    "start": "2845720",
    "end": "2852079"
  },
  {
    "text": "you're working on uh getting code inspect to run in Android Studio or well",
    "start": "2852079",
    "end": "2857760"
  },
  {
    "text": "um this is something some of the core problems of academic research you don't get people to do the the engineering",
    "start": "2857760",
    "end": "2863800"
  },
  {
    "text": "task or the the boring stuff so um we started this in eclipse and I'm afraid",
    "start": "2863800",
    "end": "2869119"
  },
  {
    "text": "it will stay in the clipse for for most of the um of the current time or the the",
    "start": "2869119",
    "end": "2874960"
  },
  {
    "text": "more recent time because um we just don't have developers that explicitly work on product features we",
    "start": "2874960",
    "end": "2881480"
  },
  {
    "text": "have um we have researchers we have student assistants but they want to do the cool stuff they want to do the",
    "start": "2881480",
    "end": "2887079"
  },
  {
    "text": "hacking the reverse engineering so just this thing like going to a new new platform is something that's rather hard",
    "start": "2887079",
    "end": "2894240"
  },
  {
    "text": "for us to do thank you yeah I think that's about it time's up so thank you",
    "start": "2894240",
    "end": "2901359"
  },
  {
    "text": "again yeah thank you for having me here",
    "start": "2901359",
    "end": "2906318"
  }
]