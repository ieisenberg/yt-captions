[
  {
    "start": "0",
    "end": "55000"
  },
  {
    "text": "thank you for joining me everybody um this is an awesome room I feel like this is the beginning of an Epic movie but",
    "start": "12599",
    "end": "19680"
  },
  {
    "text": "it's the beginning of a story that I've only really just kind of started talking",
    "start": "19680",
    "end": "24720"
  },
  {
    "text": "about very recently and as you can see from the title of my talk crypto Heist",
    "start": "24720",
    "end": "29759"
  },
  {
    "text": "this is the aftermath of a government website cryptojacking attack and I'll",
    "start": "29759",
    "end": "34760"
  },
  {
    "text": "explain what cryptojacking is for those that are unfamiliar but this story and",
    "start": "34760",
    "end": "40960"
  },
  {
    "text": "me kind of uncovering and investigating this pretty significant Cyber attack all",
    "start": "40960",
    "end": "46199"
  },
  {
    "text": "started by accident so this was not something that I set out to find uh or",
    "start": "46199",
    "end": "51760"
  },
  {
    "text": "something that I intended to find and investigate and it all started with a",
    "start": "51760",
    "end": "57359"
  },
  {
    "start": "55000",
    "end": "177000"
  },
  {
    "text": "tweet from a friend of mine he actually sent me a direct IR message um I still call it Twitter I still call it tweet",
    "start": "57359",
    "end": "63840"
  },
  {
    "text": "and it was a Sunday morning in the UK and I received a DM from a friend of mine good friend called Ian and he's",
    "start": "63840",
    "end": "70439"
  },
  {
    "text": "like hey Scott you know do you have a second I've just gone to the government's website so I'll show you",
    "start": "70439",
    "end": "76520"
  },
  {
    "text": "this in just a moment but this is the Ico in the UK the information commissioner's office so there our data privacy Watchdog for the UK",
    "start": "76520",
    "end": "83680"
  },
  {
    "text": "government and he's like hey you know I'm such a cool person I was reading about privacy legislation on a Sunday",
    "start": "83680",
    "end": "89280"
  },
  {
    "text": "morning and my antivirus program popped up this warning here in the top right",
    "start": "89280",
    "end": "94680"
  },
  {
    "text": "and it says you know warning you're visiting a web page with a virus on it and he was like well hang on a minute",
    "start": "94680",
    "end": "101200"
  },
  {
    "text": "I'm on a government website this can't be right like please could you go and take a look at this and see is this",
    "start": "101200",
    "end": "107880"
  },
  {
    "text": "correct is this real is there a virus running on this Government website so this was the the larger",
    "start": "107880",
    "end": "114079"
  },
  {
    "text": "version of the the screenshot he sent me and as you can see up there in the top right he's definitely getting a pretty",
    "start": "114079",
    "end": "120000"
  },
  {
    "text": "serious alert from his antivirus program he's definitely saying hey like there is something bad on this page you know I looked at the the domain it is the",
    "start": "120000",
    "end": "126560"
  },
  {
    "text": "official domain for the Ico in the UK he wasn't on some kind of like pretend you know fishing or impersonation site and I",
    "start": "126560",
    "end": "133319"
  },
  {
    "text": "was like okay yeah first glance this looks pretty serious now the the",
    "start": "133319",
    "end": "140120"
  },
  {
    "text": "unfortunate thing here was I kind of very quickly verified this myself you know I go to the page obviously spin up",
    "start": "140120",
    "end": "147080"
  },
  {
    "text": "a VM don't do this if you think a page has a don't just go there straight on your main computer so I quickly spin up",
    "start": "147080",
    "end": "152840"
  },
  {
    "text": "a VM fire up a browser go to the page and start looking through the source of the page to see if the thing that the",
    "start": "152840",
    "end": "158040"
  },
  {
    "text": "antivirus program was reporting was on the page and I'm like wow yeah so I do see it in the source of the page this",
    "start": "158040",
    "end": "163239"
  },
  {
    "text": "Javascript file that's being reported as malicious so yeah I was like they",
    "start": "163239",
    "end": "168440"
  },
  {
    "text": "actually have coinhive running on their homepage and this was the thing that the antivirus program was warning",
    "start": "168440",
    "end": "175319"
  },
  {
    "text": "about so for those unfamiliar with coinhive coinhive was I guess you could",
    "start": "175319",
    "end": "182040"
  },
  {
    "start": "177000",
    "end": "365000"
  },
  {
    "text": "call it a product it was a thing that was launched and they had a a very kind",
    "start": "182040",
    "end": "189239"
  },
  {
    "text": "of specific mission for their product and the idea was we don't like advertisements on websites we don't like",
    "start": "189239",
    "end": "195879"
  },
  {
    "text": "the fact that they impact performance they're privacy invasive they're they're really no good so coinhive came up with",
    "start": "195879",
    "end": "201080"
  },
  {
    "text": "this idea where you could take their JavaScript library and you could drop it onto your page and then when visitors",
    "start": "201080",
    "end": "207519"
  },
  {
    "text": "visit your site the library will spin up and it will start mining Monero it will start mining cryptocurrency so whilst",
    "start": "207519",
    "end": "214239"
  },
  {
    "text": "your visitors are browsing your page you're borrowing some of their CPU to mine a little bit of cryptocurrency and",
    "start": "214239",
    "end": "220400"
  },
  {
    "text": "that would substitute those privacy invasive performance impacting adverts now that was",
    "start": "220400",
    "end": "226280"
  },
  {
    "text": "their that was their stated Mission but what we often found was that this is not",
    "start": "226280",
    "end": "232920"
  },
  {
    "text": "how they were actually used they this phrase was coined cryptojacking which",
    "start": "232920",
    "end": "238599"
  },
  {
    "text": "was if I could could take the coinhive library and instead of installing it on my site for my",
    "start": "238599",
    "end": "244400"
  },
  {
    "text": "visitors I could install it somehow on your site for your visitors then all of",
    "start": "244400",
    "end": "249959"
  },
  {
    "text": "your visitors would start Mining cryptocurrency and they would send it to me instead and this is how the phrase",
    "start": "249959",
    "end": "256040"
  },
  {
    "text": "cryptojacking was born this idea where if you can kind of enslave the visitors to other websites to mine cryptocurrency",
    "start": "256040",
    "end": "262240"
  },
  {
    "text": "for you obviously the bigger websites you get this on and the more websites you get this on the more people will be",
    "start": "262240",
    "end": "267960"
  },
  {
    "text": "mining cryptocurrency for you and this was really kind of what made coinhive",
    "start": "267960",
    "end": "273320"
  },
  {
    "text": "very prominent I I disagree slightly with their mission I'm not entirely sure that",
    "start": "273320",
    "end": "279560"
  },
  {
    "text": "you know even if this was used as as intended I I I might have some discomfort with how it works and how you",
    "start": "279560",
    "end": "285080"
  },
  {
    "text": "would convey this to users so you know if we put those aside for a moment that really wasn't what happened anyway the",
    "start": "285080",
    "end": "290840"
  },
  {
    "text": "biggest thing that happened was this phrase that was coined which was cryptojacking now I think coinhive Rose",
    "start": "290840",
    "end": "297680"
  },
  {
    "text": "to fame a little bit too quickly um and they were kind of almost a flash in the pan for a few years there they were",
    "start": "297680",
    "end": "303960"
  },
  {
    "text": "really really popular for all of the wrong reasons and they have uh since closed down and gone really interesting",
    "start": "303960",
    "end": "309759"
  },
  {
    "text": "now if you actually go to coinhive decom I promise it's safe um a fellow cyber security researcher called Troy hunt now",
    "start": "309759",
    "end": "316120"
  },
  {
    "text": "actually owns that domain so if you go to coinhive tocom it will redirect you to his post on taking control of that",
    "start": "316120",
    "end": "321840"
  },
  {
    "text": "domain and what he now does with it but this is cryptojacking you find a way to",
    "start": "321840",
    "end": "328440"
  },
  {
    "text": "get your JavaScript script this Library onto other people's websites and you",
    "start": "328440",
    "end": "333479"
  },
  {
    "text": "make all of their visitors mind cryptocurrency for you so now we have to remember that this is running on a",
    "start": "333479",
    "end": "338720"
  },
  {
    "text": "government website and I was like well I know budgets are tight right now but I'm",
    "start": "338720",
    "end": "344880"
  },
  {
    "text": "pretty sure that this is probably not a decision that they've taken themselves and thought I know how we can plug the",
    "start": "344880",
    "end": "351240"
  },
  {
    "text": "Gap in our government budgets you know we can enslave all of the British citizens into mining cryptocurrency for",
    "start": "351240",
    "end": "356440"
  },
  {
    "text": "us I'm pretty sure that's not what happened and and remember you know this is right in the the moments after that",
    "start": "356440",
    "end": "362720"
  },
  {
    "text": "somebody had tipped me after this so I start investigating because I want to know like yes you know they're they're",
    "start": "362720",
    "end": "368680"
  },
  {
    "start": "365000",
    "end": "588000"
  },
  {
    "text": "running this coinhive JavaScript library on their website but how did it get there and",
    "start": "368680",
    "end": "374560"
  },
  {
    "text": "there's many different avenues that that the attackers could have taken to put this there so I took a bit of an unusual",
    "start": "374560",
    "end": "381720"
  },
  {
    "text": "Approach at the time and normally when people tip me off to attacks like this or data breaches or whatever it might be",
    "start": "381720",
    "end": "388160"
  },
  {
    "text": "we will generally investigate them in private and and work with the organizations to resolve them and then",
    "start": "388160",
    "end": "393960"
  },
  {
    "text": "eventually they will be publicly disclosed but I looked at this one and there was a few different things that",
    "start": "393960",
    "end": "400039"
  },
  {
    "text": "changed my Approach and as you can see here I sent a tweet almost immediately once I'd confirmed that the attack was actually legitimate I sent a tweet",
    "start": "400039",
    "end": "406080"
  },
  {
    "text": "almost immediately and said wow this is really bad there was a British government website running a malicious",
    "start": "406080",
    "end": "412160"
  },
  {
    "text": "Javascript file because me talking about this won't change the attack it won't put any more people at risk but what I",
    "start": "412160",
    "end": "418599"
  },
  {
    "text": "needed to do and you know they don't have a phone number on their website to call them for things like this was get",
    "start": "418599",
    "end": "423680"
  },
  {
    "text": "in touch with somebody at the relevant government Department very quickly to say I don't know where but you've had a breach there is malicious JavaScript",
    "start": "423680",
    "end": "430240"
  },
  {
    "text": "running in your page right now and it needs to be removed so I sent the tweet and then I",
    "start": "430240",
    "end": "436400"
  },
  {
    "text": "continue my investigation how did it get there which of the the many different avenues that the attackers could have",
    "start": "436400",
    "end": "441960"
  },
  {
    "text": "taken did they use so I used a variety of different tools online and I wanted to see what do",
    "start": "441960",
    "end": "449639"
  },
  {
    "text": "people see from other parts of the world if I look from different IP addresses if I look from different countries are we",
    "start": "449639",
    "end": "455319"
  },
  {
    "text": "all seeing the same thing because this could be like a geob based attack they might serve different JavaScript to",
    "start": "455319",
    "end": "460720"
  },
  {
    "text": "different types of devices so I used a few different tools online number one to confirm first of all they were seeing",
    "start": "460720",
    "end": "466919"
  },
  {
    "text": "what I was seeing but number two do they see some variation of this attack or is this just a c blanch everybody's getting",
    "start": "466919",
    "end": "473599"
  },
  {
    "text": "the crypto Miner and it turns out yes like everybody was just getting the malicious JavaScript on the page page",
    "start": "473599",
    "end": "479840"
  },
  {
    "text": "that mins cryptocurrency and I eventually narrowed down the point of injection which was a",
    "start": "479840",
    "end": "486400"
  },
  {
    "text": "third party JavaScript library and I'm pretty sure we all load a third party JavaScript on our pages right we have",
    "start": "486400",
    "end": "492080"
  },
  {
    "text": "you know nowadays I'm sure it's in the region of many many scripts in the tens of of scripts potentially and it was a",
    "start": "492080",
    "end": "498680"
  },
  {
    "text": "third party dependency of theirs that was the original point of the injection",
    "start": "498680",
    "end": "503840"
  },
  {
    "text": "now the original point of the injection was a text to speech plugin for visually impaired visitors to the website you",
    "start": "503840",
    "end": "509919"
  },
  {
    "text": "could load their JavaScript library it would give you like a small speaker icon in the top corner of the page and you",
    "start": "509919",
    "end": "515320"
  },
  {
    "text": "could click it and it would read out what was currently in the view as a government website they have a",
    "start": "515320",
    "end": "521919"
  },
  {
    "text": "slightly higher accessibility requirement than perhaps your your typical website and they were using this text to speech plugin and I was like",
    "start": "521919",
    "end": "529680"
  },
  {
    "text": "okay so this Narrows down the Avenue of attack it wasn't that the government's",
    "start": "529680",
    "end": "535040"
  },
  {
    "text": "infrastructure had been hacked it wasn't a vulnerability and the government's code and the attackers had found a way to inject that malicious JavaScript it",
    "start": "535040",
    "end": "542399"
  },
  {
    "text": "was actually a supply chain attack so instead of going after the government website these attackers perhaps thought",
    "start": "542399",
    "end": "550160"
  },
  {
    "text": "well maybe they have really good cyber security and we can't hack them but they're loading JavaScript from this third party and if we go over here",
    "start": "550160",
    "end": "556560"
  },
  {
    "text": "perhaps it will be slightly easier to breach their systems so they'd breach the systems of the third party supplier",
    "start": "556560",
    "end": "563200"
  },
  {
    "text": "modified their JavaScript library to include the coinhive minor and then of course that's loaded iMed mediately into",
    "start": "563200",
    "end": "570120"
  },
  {
    "text": "the government website but then I thought well if this is a third party",
    "start": "570120",
    "end": "576480"
  },
  {
    "text": "supplier and they're providing a text to speech plug-in it's probably not just the one website using this right if",
    "start": "576480",
    "end": "582200"
  },
  {
    "text": "they're a big company this could be potentially a large number of websites so first of all I wanted to",
    "start": "582200",
    "end": "588480"
  },
  {
    "start": "588000",
    "end": "1392000"
  },
  {
    "text": "tear into the JavaScript itself so I've got all of the archives of all of the",
    "start": "588480",
    "end": "595000"
  },
  {
    "text": "data at the time so it's easy for me to go back and pull out what we were looking at so on the left hand side",
    "start": "595000",
    "end": "600880"
  },
  {
    "text": "there you can see the URL for the script it's brows aloud. comom which was the third party supplier and then we go",
    "start": "600880",
    "end": "606839"
  },
  {
    "text": "through to their Javascript file now when I was going through the page looking at all of the dependencies",
    "start": "606839",
    "end": "612760"
  },
  {
    "text": "looking for any JavaScript that might be responsible for this malicious activity if you come across a script file and you",
    "start": "612760",
    "end": "617839"
  },
  {
    "text": "see a big old chunk of OB fiscated JavaScript like this there's a really high chance that you found the source of",
    "start": "617839",
    "end": "625399"
  },
  {
    "text": "the attack and as soon as I saw this I stopped looking in my experience you know there are a couple of products out",
    "start": "625399",
    "end": "631240"
  },
  {
    "text": "there that use really heavy officiation in their JavaScript like this but generally speaking once you see something like this you're like okay now",
    "start": "631240",
    "end": "637560"
  },
  {
    "text": "I understand where the attack is coming from so this third party's JavaScript had been modified now you can see their",
    "start": "637560",
    "end": "644240"
  },
  {
    "text": "original comment at the top so that is from the supplier and you can see their original JavaScript down there at the",
    "start": "644240",
    "end": "649639"
  },
  {
    "text": "bottom it starts just here and this point here is the injection this is what",
    "start": "649639",
    "end": "655160"
  },
  {
    "text": "the attackers had added and they've been careful enough to make sure that they didn't impact the legitimate",
    "start": "655160",
    "end": "661600"
  },
  {
    "text": "functionality of the script file so no one would really notice that this had happened because you know the little",
    "start": "661600",
    "end": "667839"
  },
  {
    "text": "speaker icon didn't disappear it still worked so they left all of the intended functionality intact and just injected",
    "start": "667839",
    "end": "673920"
  },
  {
    "text": "this little component here so if we take a slightly closer look at that as you can see it's really heavily obfuscated",
    "start": "673920",
    "end": "681079"
  },
  {
    "text": "very very easy to deobfuscate this and look at precisely what they were doing so this is all that it did this is their",
    "start": "681079",
    "end": "689279"
  },
  {
    "text": "injection did so you can see at the beginning there we've got a document right to add a new script tag which is",
    "start": "689279",
    "end": "694639"
  },
  {
    "text": "pulling in the coinhive minor the second one you can see further down we're just setting the configuration for the minor",
    "start": "694639",
    "end": "702240"
  },
  {
    "text": "and then right down there at the bottom you can see the actual address for the wallet where the uh cryptocurrency is",
    "start": "702240",
    "end": "709399"
  },
  {
    "text": "going to be sent to and I actually had an interesting conversation so Andy Greenberg that was just on uh the stage",
    "start": "709399",
    "end": "715560"
  },
  {
    "text": "before me now um really fascinating talk if you didn't see see that about how cryptocurrencies can be used for really",
    "start": "715560",
    "end": "722240"
  },
  {
    "text": "malicious purposes and we were having an interesting discussion about how you know Brazen they can be here and just",
    "start": "722240",
    "end": "727959"
  },
  {
    "text": "say like this is our wallet address like you know this is where all of the stolen cryptocurrency that's mined by the",
    "start": "727959",
    "end": "733399"
  },
  {
    "text": "victims is going to be sent to but because of the way that Monero works and",
    "start": "733399",
    "end": "738680"
  },
  {
    "text": "pro probably one of the reasons that they chose it is that it's very difficult to do anything with that so",
    "start": "738680",
    "end": "744360"
  },
  {
    "text": "we've got the miner being deployed we've got the miner being set up and we know where the crypto is going to be sent to",
    "start": "744360",
    "end": "750920"
  },
  {
    "text": "so this was essentially just their bootstrap their injection point was just to bootstrap the files and the configuration they needed to run the",
    "start": "750920",
    "end": "758440"
  },
  {
    "text": "minor and this is it this will now run on anybody's computer or device you know",
    "start": "758440",
    "end": "764519"
  },
  {
    "text": "phone tablet laptop that goes to the website loading this script tag and it",
    "start": "764519",
    "end": "770279"
  },
  {
    "text": "is this simple yet highly highly effective now the problem was this and",
    "start": "770279",
    "end": "779760"
  },
  {
    "text": "prior to attacks like this starting to happen all of us will have script tags",
    "start": "779760",
    "end": "785440"
  },
  {
    "text": "like this on our site and nobody really sees any kind of you know particular problem with this right it's like okay",
    "start": "785440",
    "end": "790760"
  },
  {
    "text": "well you know I've got a script tag I'm going to declare my source attribute I've got the URL for the asset you know like this is pretty standard practice",
    "start": "790760",
    "end": "798279"
  },
  {
    "text": "and of course you know this is also going to be on thousands and thousands of other websites as well as we later",
    "start": "798279",
    "end": "804120"
  },
  {
    "text": "discovered but most people would not look at this and think what I I think I I look at this",
    "start": "804120",
    "end": "809880"
  },
  {
    "text": "and I see a really dangerous potential Avenue for",
    "start": "809880",
    "end": "815079"
  },
  {
    "text": "attack so once I knew what the script tag looks like it's then easy I also run a crawler",
    "start": "815079",
    "end": "822519"
  },
  {
    "text": "project separately that scans millions of websites every day for security issues once I know the the string that",
    "start": "822519",
    "end": "828800"
  },
  {
    "text": "I'm looking for in the Dom it's pretty easy to go out there and find other websites that are loading this that are",
    "start": "828800",
    "end": "834240"
  },
  {
    "text": "using this and I found this on some really really prominent website",
    "start": "834240",
    "end": "839639"
  },
  {
    "text": "like the US courts here again all government websites you know because of",
    "start": "839639",
    "end": "844920"
  },
  {
    "text": "the high accessibility requirements presumably so yep like us courts the US",
    "start": "844920",
    "end": "850040"
  },
  {
    "text": "Supreme Court like pretty important websites now running malicious JavaScript we then have things like in",
    "start": "850040",
    "end": "856040"
  },
  {
    "text": "the UK so this is the student loan company so if you're studying in the UK you go to the student loan company to",
    "start": "856040",
    "end": "862279"
  },
  {
    "text": "borrow the necessary money to pay for your studies and and then you work out all of the repayments and everything with them so the kind of people that use",
    "start": "862279",
    "end": "868440"
  },
  {
    "text": "this website are people borrowing you know many millions of people borrowing really significant sums of",
    "start": "868440",
    "end": "873839"
  },
  {
    "text": "money now running malicious JavaScript we keep going we have the General Medical Council in the UK where doctors",
    "start": "873839",
    "end": "880680"
  },
  {
    "text": "and nurses are registered I'm like well this website handles a whole bunch of sensitive information nowar running",
    "start": "880680",
    "end": "886120"
  },
  {
    "text": "malicious JavaScript and things like the actual NHS so our National Health Service in the UK where I can log in and",
    "start": "886120",
    "end": "893839"
  },
  {
    "text": "read information about my you know past procedures future appointments medication diagnos no it like all of",
    "start": "893839",
    "end": "899839"
  },
  {
    "text": "this kind of information available through this website that's now running malicious JavaScript controled by",
    "start": "899839",
    "end": "905800"
  },
  {
    "text": "attackers and as I said as well in the the post which you can read on my blog that goes into this now in great detail",
    "start": "905800",
    "end": "911920"
  },
  {
    "text": "all across the world America the UK we had European governments Australia New",
    "start": "911920",
    "end": "918160"
  },
  {
    "text": "Zealand and the vast vast majority of those thousands and thousands of sites were government",
    "start": "918160",
    "end": "924759"
  },
  {
    "text": "websites so I was like okay well my original goal was to get in touch with this department at the British",
    "start": "924759",
    "end": "931160"
  },
  {
    "text": "government and now I need to speak to all the governments it's like how you know very suddenly the scope of this",
    "start": "931160",
    "end": "936800"
  },
  {
    "text": "change and I was like oh I'm not really sure I'm equipped and I wouldn't even know how to begin to try and contact",
    "start": "936800",
    "end": "944639"
  },
  {
    "text": "anybody responsible for any of these websites it's it's almost an insurmountable",
    "start": "944639",
    "end": "949720"
  },
  {
    "text": "task now when we were doing the investigation to try and identify these sites in order to hopefully be able to",
    "start": "949720",
    "end": "956360"
  },
  {
    "text": "contact them I use my craw Fleet so I have a fleet of crawlers that crawls the web every single day scanning websites",
    "start": "956360",
    "end": "963920"
  },
  {
    "text": "but you have a really awesome crawler at your disposal as well called Google Now",
    "start": "963920",
    "end": "971000"
  },
  {
    "text": "we have a phrase that we use within the security industry called a Google do and you can see here I've got a government",
    "start": "971000",
    "end": "977319"
  },
  {
    "text": "crypto dog so a Google dog is where you craft a specific Google query to try and",
    "start": "977319",
    "end": "985000"
  },
  {
    "text": "find a website that's either vulnerable to attack or is is possibly vulnerable to attack so if you can know",
    "start": "985000",
    "end": "992199"
  },
  {
    "text": "specifically the kind of things that you're looking for to indicate that a website has a problem you can just go to Google and be like hey show me any",
    "start": "992199",
    "end": "998079"
  },
  {
    "text": "website that has this problem please and Google's like here you go like here is the list of answers so if you go to this",
    "start": "998079",
    "end": "1003360"
  },
  {
    "text": "URL and your browsers right now it will redirect you to Google and it will run the search query right now to return to",
    "start": "1003360",
    "end": "1009480"
  },
  {
    "text": "you a list of sites that are currently running a crypto Miner because Google obviously",
    "start": "1009480",
    "end": "1016399"
  },
  {
    "text": "searches the page it looks at the content and I know specifically what content we're looking for in the page to indicate you're running a crypto minor",
    "start": "1016399",
    "end": "1023480"
  },
  {
    "text": "so you can go there right now and it's specifically only looking for government domains you can just drop the.gov requirement from the URL and just search",
    "start": "1023480",
    "end": "1029918"
  },
  {
    "text": "for any website running a crypto Miner that's a lot so that's a lot of search results so this one will specifically",
    "start": "1029919",
    "end": "1035400"
  },
  {
    "text": "only look for government websites that are presently running crypto Miners and",
    "start": "1035400",
    "end": "1040520"
  },
  {
    "text": "I'll bet you still get some results because every time I look at this yes the number gets a little bit smaller as time goes",
    "start": "1040520",
    "end": "1046480"
  },
  {
    "text": "by but we're like 5 years in and there's still websites on the list so perhaps",
    "start": "1046480",
    "end": "1052480"
  },
  {
    "text": "we're not making as much progress as we should be making now the big problem that I had",
    "start": "1052480",
    "end": "1058440"
  },
  {
    "text": "you know this happened on a Sunday so obviously the government's closed not doing anything so I definitely wasn't going to be speaking to anybody at the",
    "start": "1058440",
    "end": "1063720"
  },
  {
    "text": "government on a Sunday I don't know how things work here in Denmark but you're pretty much not going to speak to anybody in the government on a Sunday",
    "start": "1063720",
    "end": "1070360"
  },
  {
    "text": "back in England and eventually because I live tweeted this whole kind of",
    "start": "1070360",
    "end": "1075480"
  },
  {
    "text": "Investigation as you saw finally the government in the UK actually reached out to me so we have the ncsc in the UK",
    "start": "1075480",
    "end": "1082919"
  },
  {
    "text": "which is our national cyber security Center they're a division of our spy agency at gchq and they are responsible",
    "start": "1082919",
    "end": "1089840"
  },
  {
    "text": "for the protection of like government infrastructure and British infrastructure they reach out to me and",
    "start": "1089840",
    "end": "1095760"
  },
  {
    "text": "they're like hey could we get your email and I was like oh do you not already have that like surely the one",
    "start": "1095760",
    "end": "1102520"
  },
  {
    "text": "organization that's probably already got my email and doesn't need to ask for it might be the British government spy agency um but you know I responded",
    "start": "1102520",
    "end": "1109600"
  },
  {
    "text": "nicely and I was like yeah of course and the general kind of gist was you know you've obviously been looking into",
    "start": "1109600",
    "end": "1116200"
  },
  {
    "text": "this for some period of time there's lots of really useful information in the tweets but can we open a more direct communication channel so that we can",
    "start": "1116200",
    "end": "1122720"
  },
  {
    "text": "more quickly catch up with kind of you know what's going on here and what you found so I started handing this",
    "start": "1122720",
    "end": "1128679"
  },
  {
    "text": "information over and I'm continually aware of the fact that obviously you know I'm helping the British government",
    "start": "1128679",
    "end": "1133720"
  },
  {
    "text": "now but that doesn't help any of the other you know tens of governments uh that are impacted by this so it's still",
    "start": "1133720",
    "end": "1141280"
  },
  {
    "text": "quite a difficult remediation process but we have to start the remediation",
    "start": "1141280",
    "end": "1146480"
  },
  {
    "text": "process with with someone and eventually I did go down to London they invited me to go down and meet them you know once",
    "start": "1146480",
    "end": "1152600"
  },
  {
    "text": "we had it this was all settled they were like come down be great to meet in person and we did have some really",
    "start": "1152600",
    "end": "1158200"
  },
  {
    "text": "productive conversations with the response to this incident how we perhaps",
    "start": "1158200",
    "end": "1164080"
  },
  {
    "text": "might respond to Future incidents or you know really hopefully how we might actually prevent future incidents",
    "start": "1164080",
    "end": "1169799"
  },
  {
    "text": "because of course the thing that we should always take away from incidents like this is how do we make sure that incidents like this don't happen again",
    "start": "1169799",
    "end": "1177080"
  },
  {
    "text": "and that was that turned out to be quite a tricky one actually because we we come back to this piece of JavaScript because",
    "start": "1177080",
    "end": "1183159"
  },
  {
    "text": "to me this is the issue and and when I look at this I see a really dangerous potential attack and most people look at",
    "start": "1183159",
    "end": "1190360"
  },
  {
    "text": "this and think it's just a script tag Scot like what are you so worried about like we all have you know 24 of these on",
    "start": "1190360",
    "end": "1196600"
  },
  {
    "text": "our website at any given time like what's the big deal but when I look at this I kind of",
    "start": "1196600",
    "end": "1203320"
  },
  {
    "text": "see this and definitely looking at the age of some of the people in the room I'm going to have to explain what a check",
    "start": "1203320",
    "end": "1210480"
  },
  {
    "text": "is but and also you're like a pretty Forward Thinking country here so maybe he ditch these like a hundred years ago",
    "start": "1210480",
    "end": "1216960"
  },
  {
    "text": "when we should have but um if you ever wanted to send somebody money before the internet and online banking you would",
    "start": "1216960",
    "end": "1222760"
  },
  {
    "text": "have a checkbook with like a hundred of these in and you would take a check out and say I want to pay you know 100 00 to",
    "start": "1222760",
    "end": "1229240"
  },
  {
    "text": "Scott Helm and then you would sign it and then you would they would give it to me and then I would like have to take it",
    "start": "1229240",
    "end": "1234600"
  },
  {
    "text": "to the bank this little piece of paper I would go to the bank and I would pay it in and then you know 5 days later the",
    "start": "1234600",
    "end": "1239720"
  },
  {
    "text": "money would eventually arrive it was like a super old school traditional way of making payments and my nan bless her",
    "start": "1239720",
    "end": "1246400"
  },
  {
    "text": "she still sends me one of these every year at Christmas and and I have to like go to the bank like hey I have this",
    "start": "1246400",
    "end": "1252440"
  },
  {
    "text": "piece of paper to initiate a money transfer and I'm like this is so cool and this is is what I see when I look at",
    "start": "1252440",
    "end": "1260559"
  },
  {
    "text": "that script tag but I see a very slight variation of this I see this one now",
    "start": "1260559",
    "end": "1265840"
  },
  {
    "text": "this is a phrase and and hopefully this kind of like translates over but this is what we refer to as a blank check and",
    "start": "1265840",
    "end": "1272279"
  },
  {
    "text": "and the kind of implication there is if you were to take a check out of your checkbook and sign it and then give it",
    "start": "1272279",
    "end": "1278640"
  },
  {
    "text": "to the other person leaving the field blank in terms of how much to pay you might get a surprise when that",
    "start": "1278640",
    "end": "1285559"
  },
  {
    "text": "check gets cashed right because if you give them the freedom to put whatever they want in there they're going to take",
    "start": "1285559",
    "end": "1290679"
  },
  {
    "text": "a bit of a Gamble and think oh well you know Scott wanted to give me100 but maybe maybe I put £1,000 because I have",
    "start": "1290679",
    "end": "1296600"
  },
  {
    "text": "a blank check I have the ability to put in there anything that I want and it",
    "start": "1296600",
    "end": "1302200"
  },
  {
    "text": "will still be valid so now if we go back to this script tag this is what I see I see a blank",
    "start": "1302200",
    "end": "1310760"
  },
  {
    "text": "check for JavaScript because if you think about it this Source attribute really doesn't",
    "start": "1310760",
    "end": "1316400"
  },
  {
    "text": "tell us anything at all it doesn't tell us what to go and get you know you might read the path or the name of the file",
    "start": "1316400",
    "end": "1322640"
  },
  {
    "text": "and think oh it's you know it's jQuery or something right because it says jQuery right there in the path but",
    "start": "1322640",
    "end": "1328279"
  },
  {
    "text": "really all it's telling you is where to go get some JavaScript it doesn't say what",
    "start": "1328279",
    "end": "1333799"
  },
  {
    "text": "JavaScript doesn't say how much JavaScript doesn't say what the JavaScript should do all it says is go",
    "start": "1333799",
    "end": "1341159"
  },
  {
    "text": "here and there will be some JavaScript right and then just fetch it back and run it it's a blank check for JavaScript",
    "start": "1341159",
    "end": "1348559"
  },
  {
    "text": "and this is super dangerous now I Tred to explain this to",
    "start": "1348559",
    "end": "1354240"
  },
  {
    "text": "the media at the time because this very quickly got picked up by the press in the UK the BBC were really interested in",
    "start": "1354240",
    "end": "1359640"
  },
  {
    "text": "running a story on this because you know I guess it was quite a significant breach and of course like there's no",
    "start": "1359640",
    "end": "1367039"
  },
  {
    "text": "journalists here I don't think and is here journalists like to kind of like jazz things up a little bit they like to make things look cooler especially when",
    "start": "1367039",
    "end": "1372919"
  },
  {
    "text": "it comes to cyber crime and hacks and breaches you know they're like can you wear a hoodie and have some Matrix text behind you I was like oh goodness me so",
    "start": "1372919",
    "end": "1380559"
  },
  {
    "text": "I I tried to balance that I I tried to be like okay look you know we can Jazz this up a little bit but I'm not you",
    "start": "1380559",
    "end": "1385960"
  },
  {
    "text": "know I'm not going to wear sunglasses and gloves while I'm typing at my keyboard right like none of us do that in the security",
    "start": "1385960",
    "end": "1392240"
  },
  {
    "start": "1392000",
    "end": "1781000"
  },
  {
    "text": "industry so they made this TV",
    "start": "1392240",
    "end": "1397559"
  },
  {
    "text": "episode to cover this it's a crime that's fast becoming the Hacker's",
    "start": "1397559",
    "end": "1403440"
  },
  {
    "text": "favorite and the impact often go I can already hear people chuckling it's just like this house looks like your computer",
    "start": "1403640",
    "end": "1410799"
  },
  {
    "text": "after it's been hijacked everything may look fine from the outside but inside resources have",
    "start": "1410799",
    "end": "1418440"
  },
  {
    "text": "been ransacked to add insults to injury your electricity bill is about to go up as",
    "start": "1418440",
    "end": "1425240"
  },
  {
    "text": "you pay to power a machine that's now working hard for the criminals a friend",
    "start": "1425240",
    "end": "1431080"
  },
  {
    "text": "of mine got in touch with me on the Sunday morning and said I've just been to the information commissioner's office",
    "start": "1431080",
    "end": "1436480"
  },
  {
    "text": "website where the Ico here in in the UK our data protection body at the government and he said my antivirus",
    "start": "1436480",
    "end": "1441640"
  },
  {
    "text": "program has thrown up this warning on the screen he said this is a government website can it have a virus on it so",
    "start": "1441640",
    "end": "1447880"
  },
  {
    "text": "what we discovered was originally that the Ico website was running a crypto Miner so your your browser would be hij",
    "start": "1447880",
    "end": "1454080"
  },
  {
    "text": "to mine cryptocurrencies for the hackers after some investigation what we found was that a third party supplier that",
    "start": "1454080",
    "end": "1460760"
  },
  {
    "text": "provides them with software had been breached and they had included the crypto Miner in that a third party app",
    "start": "1460760",
    "end": "1467840"
  },
  {
    "text": "used by the Ico and thousands of other websites had been compromised the malware told visitors comps to start",
    "start": "1467840",
    "end": "1475039"
  },
  {
    "text": "mining crypto currencies for the bad guys and you can see before my system was doing one or two different things",
    "start": "1475039",
    "end": "1482120"
  },
  {
    "text": "and now the miner is running the miner is taking 100% of my CPU on this device",
    "start": "1482120",
    "end": "1488120"
  },
  {
    "text": "and using it to mine cryptocurrencies uh you can configure a crypto Mana in how much of the",
    "start": "1488120",
    "end": "1493159"
  },
  {
    "text": "computer's power it will use now if you're greedy and you take 100% then someone's computer or phone or tablet",
    "start": "1493159",
    "end": "1500000"
  },
  {
    "text": "will slow down and you will notice that when you try to do things it's not responsive it hangs uh what they' done",
    "start": "1500000",
    "end": "1506440"
  },
  {
    "text": "in this case is they' on configured it to use up to 60% of the like the special effects so it would use a lot of it so",
    "start": "1506440",
    "end": "1513559"
  },
  {
    "text": "again the average user may never have known that it was there and that it was running Scott showed me how they could",
    "start": "1513559",
    "end": "1520919"
  },
  {
    "text": "have stolen visitors data so why didn't they so what I've set up here is",
    "start": "1520919",
    "end": "1526880"
  },
  {
    "text": "something that the attackers could have done I've given myself the same level of access they did and you'll notice that",
    "start": "1526880",
    "end": "1532360"
  },
  {
    "text": "the information commissioner's office website has a username and password field uh so if you just go ahead and",
    "start": "1532360",
    "end": "1538159"
  },
  {
    "text": "type something into that field and already if you look at the information being sent to my device here God this is",
    "start": "1538159",
    "end": "1545440"
  },
  {
    "text": "coming up on there straight away as you type that is sent in real time to me and the attackers in this instance could",
    "start": "1545440",
    "end": "1552000"
  },
  {
    "text": "have done this absolutely they just chose not to why easy money you know attackers",
    "start": "1552000",
    "end": "1559480"
  },
  {
    "text": "will take the low hanging fruit they put the crypto Manor onto this website and they walk away so this was a really kind of",
    "start": "1559480",
    "end": "1567080"
  },
  {
    "text": "important point of the investigation for me and when I set up that demo there so",
    "start": "1567080",
    "end": "1572279"
  },
  {
    "text": "basically I was intercepting my own traffic and re-injecting the the minor just to simulate it because obviously by",
    "start": "1572279",
    "end": "1577840"
  },
  {
    "text": "the time we filmed this it had been fixed and I was like well I'm I'm just injecting arbitary JavaScript into the",
    "start": "1577840",
    "end": "1583760"
  },
  {
    "text": "page you know like what else can we do and the answer really is like I don't",
    "start": "1583760",
    "end": "1589000"
  },
  {
    "text": "know like how good are you at copying and pasting JavaScript from stack Overflow like as long as you can think of it and you can get the code to do it",
    "start": "1589000",
    "end": "1596120"
  },
  {
    "text": "then you can do it now I actually set up a lot of other demos for That interview and they didn't show any of them on the",
    "start": "1596120",
    "end": "1602640"
  },
  {
    "text": "television um because some of them would were just far too inappropriate to be on television but I was like well why can't",
    "start": "1602640",
    "end": "1608320"
  },
  {
    "text": "the attackers just use the JavaScript to load like a full screen pornography",
    "start": "1608320",
    "end": "1613640"
  },
  {
    "text": "video right so like you go to the government website and then it's just like bam full screen pornography I was like well that's easy to do with",
    "start": "1613640",
    "end": "1619279"
  },
  {
    "text": "JavaScript and the journalist Dan Simmons at the time was just like wait they could have done that and I was like",
    "start": "1619279",
    "end": "1626080"
  },
  {
    "text": "yeah of course you know if I gave you the ability to inject arbitrary JavaScript into thousands of government websites right now what would you do",
    "start": "1626080",
    "end": "1633320"
  },
  {
    "text": "because I'm not sure that mining cryptocurrency would be at the top of my list so we did some other ones as well I",
    "start": "1633320",
    "end": "1640240"
  },
  {
    "text": "put like a mock banner across the top of the page and it like the black and yellow slash you know kind of like",
    "start": "1640240",
    "end": "1645399"
  },
  {
    "text": "warning banner and I was like so I could go to the stock market I could short like the footsy 100 and then I could put",
    "start": "1645399",
    "end": "1651840"
  },
  {
    "text": "a big banner at the top of the screen that said like prime minister assassinated and it would be on every single government website that you went",
    "start": "1651840",
    "end": "1657880"
  },
  {
    "text": "to in the UK so it would be fairly believable you know we did I did some other the fun ones I had the Star Wars",
    "start": "1657880",
    "end": "1664080"
  },
  {
    "text": "theme tune and I just made the page like slide off into the distance I was like we can do that um you know and and the",
    "start": "1664080",
    "end": "1670480"
  },
  {
    "text": "one that I was kind of simulating there so we have a thing called gov ID in the UK which is like your credentials to log",
    "start": "1670480",
    "end": "1675519"
  },
  {
    "text": "into all of the different government services and they add adding more and more things as we go and I was like well",
    "start": "1675519",
    "end": "1680679"
  },
  {
    "text": "you know I can just skim the details right off the page with JavaScript like that's not difficult then I can get your",
    "start": "1680679",
    "end": "1686279"
  },
  {
    "text": "go ID account I can go look at all of your financial data your tax data I was like the the possibilities here are",
    "start": "1686279",
    "end": "1692000"
  },
  {
    "text": "endless and it all came because of that one little script file because when you",
    "start": "1692000",
    "end": "1698559"
  },
  {
    "text": "go to the page and your browser sees that script tag like all bets are off you have no",
    "start": "1698559",
    "end": "1705279"
  },
  {
    "text": "idea what you're going to get when you that resource down you know do we all agree here like bar you know bar caching",
    "start": "1705279",
    "end": "1712679"
  },
  {
    "text": "if we kind of like rule that out for a second when you go to fetch that Javascript file it could change every single time you fetch it right like it",
    "start": "1712679",
    "end": "1719240"
  },
  {
    "text": "could be different literally every single time you load it there's no reason that it can't be and this is",
    "start": "1719240",
    "end": "1724600"
  },
  {
    "text": "really the issue this blank check for JavaScript now the first defense",
    "start": "1724600",
    "end": "1730039"
  },
  {
    "text": "mechanism when we were talking about how to you know a remediate this like the initial remediation they were focusing",
    "start": "1730039",
    "end": "1736559"
  },
  {
    "text": "on let's try and get all of the government websites to patch their site and just remove it and it was like",
    "start": "1736559",
    "end": "1742480"
  },
  {
    "text": "that's going to take about 5 years to get like all of these governments to do change request and remove the script tag and do all the things so actually the",
    "start": "1742480",
    "end": "1748840"
  },
  {
    "text": "first couple of days we're just drilling into the company to say like drop your infrastructure take the file down now",
    "start": "1748840",
    "end": "1754559"
  },
  {
    "text": "and then that will neutralize the infection so that was actually like the the real first kind of immediate change",
    "start": "1754559",
    "end": "1760840"
  },
  {
    "text": "that we pursued after that it's then like okay but like we still have all of these other script tags on the page",
    "start": "1760840",
    "end": "1767080"
  },
  {
    "text": "right like the exact same thing could just happen with those so arguably yes like well we've fixed this one we've not",
    "start": "1767080",
    "end": "1773279"
  },
  {
    "text": "actually fixed the problem how do we fix the problem I was like well you know what we already have the solution right",
    "start": "1773279",
    "end": "1779279"
  },
  {
    "text": "we actually already have this thing because we knew that this was a problem within the industry and we've already",
    "start": "1779279",
    "end": "1785080"
  },
  {
    "start": "1781000",
    "end": "2034000"
  },
  {
    "text": "released a defense mechanism something called subresource Integrity so that",
    "start": "1785080",
    "end": "1790200"
  },
  {
    "text": "Javascript file on your page is a sub resource of your page and what we want to do is assure the Integrity of that",
    "start": "1790200",
    "end": "1795640"
  },
  {
    "text": "file we want to make sure that nobody has tampered with that file and in order to get this protection to know whether",
    "start": "1795640",
    "end": "1801440"
  },
  {
    "text": "your JavaScript dependencies have been tampered with all you have to do to your script tag is that so it's a very very",
    "start": "1801440",
    "end": "1807519"
  },
  {
    "text": "small change we've added two attributes and the first one is the important one so the Integrity attribute on this",
    "start": "1807519",
    "end": "1812600"
  },
  {
    "text": "script tag is now a hash that we expect the remote file to match when the",
    "start": "1812600",
    "end": "1818919"
  },
  {
    "text": "browser pulls it down so now upon observing this script tag the browser will go fetch that asset whatever it",
    "start": "1818919",
    "end": "1825960"
  },
  {
    "text": "might be and it will pull it back and then say okay right but just before we run it I'm going to Hash it and I'm",
    "start": "1825960",
    "end": "1832320"
  },
  {
    "text": "going to compare it to this hash because I want to know if it was the file I was",
    "start": "1832320",
    "end": "1837720"
  },
  {
    "text": "expecting and now in this scenario where you know one day we're loading the legitimate JavaScript and there's no",
    "start": "1837720",
    "end": "1843679"
  },
  {
    "text": "problem tomorrow we start loading the malicious JavaScript the browser is going to go whoa hang on a minute this file changed this wasn't the file I was",
    "start": "1843679",
    "end": "1850519"
  },
  {
    "text": "expecting now it can't tell you how it changed or what it's now doing but it can tell you that the file has been",
    "start": "1850519",
    "end": "1856399"
  },
  {
    "text": "tampered with and that is enough to know do you want to run JavaScript that's been tampered with like because I don't",
    "start": "1856399",
    "end": "1863200"
  },
  {
    "text": "so the browser will just discard it and not load it at this point now the second attribute there cross origin is also",
    "start": "1863200",
    "end": "1869120"
  },
  {
    "text": "required it basically means that the request for the script file is not allowed to have any cookies on it so it has to be an anonymous",
    "start": "1869120",
    "end": "1876039"
  },
  {
    "text": "request and that's it so you know we're talking about this remediation with the",
    "start": "1876039",
    "end": "1881279"
  },
  {
    "text": "government and there some of the private companies and people that had reached out as well CU this kind of got a bit of a swallow of support at the time and and",
    "start": "1881279",
    "end": "1887639"
  },
  {
    "text": "I'm like well we already have the solution I was like don't worry like we we got it you know it's here already we don't have to",
    "start": "1887639",
    "end": "1894639"
  },
  {
    "text": "deploy something new or create something new this is standardized in all mainstream browsers it's been supported",
    "start": "1894639",
    "end": "1899679"
  },
  {
    "text": "for years and years and years now as like all you have to do is add this Integrity attribute to your third party",
    "start": "1899679",
    "end": "1905000"
  },
  {
    "text": "dependencies and they can no longer compromise you but there's always a but so the",
    "start": "1905000",
    "end": "1913840"
  },
  {
    "text": "problem that we had if we go back to the original script file and I had it loaded up here earlier we had obviously the",
    "start": "1913840",
    "end": "1920120"
  },
  {
    "text": "point of injection those three kind of OB fiscated blocks in the middle and they would you know have changed the",
    "start": "1920120",
    "end": "1926279"
  },
  {
    "text": "hash of the file but if I zoom in on the comment at the top up there you can see that and this was the original comment",
    "start": "1926279",
    "end": "1933000"
  },
  {
    "text": "from the authors of the library sayso not copy yourself of this file you will not be supported and it says browser L",
    "start": "1933000",
    "end": "1938200"
  },
  {
    "text": "plus version 250 and the date it was released but then if you look at the path and the file name there's no kind",
    "start": "1938200",
    "end": "1945600"
  },
  {
    "text": "of indication of that versioning within the path or the file name and this is",
    "start": "1945600",
    "end": "1951360"
  },
  {
    "text": "where the problem started because if we think about what this script tag actually is if I change the file name to",
    "start": "1951360",
    "end": "1956679"
  },
  {
    "text": "this latest. JS we can now kind of understand a little bit of what they're saying which is if you come here you",
    "start": "1956679",
    "end": "1964279"
  },
  {
    "text": "will always get the latest version of the library and that means it's expected to",
    "start": "1964279",
    "end": "1969320"
  },
  {
    "text": "change that means that it will change and this now removes our ability to use SRI because SRI is saying I'm going to",
    "start": "1969320",
    "end": "1976240"
  },
  {
    "text": "go here and I'm going to get this file and then you go there tomorrow and it's like oh hey we updated it now it's changed the SRI check would",
    "start": "1976240",
    "end": "1983600"
  },
  {
    "text": "fail and we're you know we're already speaking to the vendor at this point and I'm like this is super problematic if we",
    "start": "1983600",
    "end": "1988919"
  },
  {
    "text": "want to solve this problem because you're basically requiring that we load Dynamic JavaScript from you and that's",
    "start": "1988919",
    "end": "1995360"
  },
  {
    "text": "just not something that we can allow now and this this conversation I had",
    "start": "1995360",
    "end": "2001320"
  },
  {
    "text": "separately much time later but basically the the kind of decision now is for the websites that are using this script file",
    "start": "2001320",
    "end": "2008240"
  },
  {
    "text": "you can't use S and the vendor's like yes but you know like if we release a",
    "start": "2008240",
    "end": "2013799"
  },
  {
    "text": "new version with a new feature you just you get that new version you get that new feature you don't have to change",
    "start": "2013799",
    "end": "2019120"
  },
  {
    "text": "anything on your website right like if we fix a bug the bug fix gets deployed you immediately get the bug fix like",
    "start": "2019120",
    "end": "2024919"
  },
  {
    "text": "this is amazing there's no effort on your side there's no trouble right it's fantastic it's awesome we can just you",
    "start": "2024919",
    "end": "2031840"
  },
  {
    "text": "know we can patch this Library add new features fix bugs without your",
    "start": "2031840",
    "end": "2038960"
  },
  {
    "start": "2034000",
    "end": "2125000"
  },
  {
    "text": "interaction and I was like okay like I you know I can't argue with that it is technically correct what they're saying",
    "start": "2039200",
    "end": "2045760"
  },
  {
    "text": "is true and I was like but let me just spin this around and say the exact same thing that you said but just in a",
    "start": "2045760",
    "end": "2051480"
  },
  {
    "text": "slightly different way and I was like what you're saying and bearing in mind we had really big issues with how long",
    "start": "2051480",
    "end": "2057040"
  },
  {
    "text": "it would take the government to make a change to their site even such a small change they like oh we need a change request and approval and process and and",
    "start": "2057040",
    "end": "2063760"
  },
  {
    "text": "I'm like but now we have this third party vendor that can just like push a code chain straight into production",
    "start": "2063760",
    "end": "2070040"
  },
  {
    "text": "without your knowledge authorization testing no process no approval they're just like Wham straight into production",
    "start": "2070040",
    "end": "2077320"
  },
  {
    "text": "deploy and I'm like so why do we have all of this process for like strict change control but then this third party",
    "start": "2077320",
    "end": "2083358"
  },
  {
    "text": "vendor is just like YOLO JavaScript in production I like what these two things are not adding up for me here so I was",
    "start": "2083359",
    "end": "2091240"
  },
  {
    "text": "like the problem now is that yes that update you know with new features or book fixes could also be malware or",
    "start": "2091240",
    "end": "2096919"
  },
  {
    "text": "around somewhere or cryptojacking right like so we have to add that to the pile of potential new features of this",
    "start": "2096919",
    "end": "2102720"
  },
  {
    "text": "library and this was the point when people kind of started tipping and they were like o like yeah you know vendor",
    "start": "2102720",
    "end": "2108560"
  },
  {
    "text": "people you're right book fixes sound cool new features sound cool ransomware",
    "start": "2108560",
    "end": "2113760"
  },
  {
    "text": "not so much cryptojacking not so much so you know this is the problem like the",
    "start": "2113760",
    "end": "2118800"
  },
  {
    "text": "attacker and I've changed the slide there it's like very subtle so it's like the vendor we can patch the JavaScript anytime the attacker we can patch the",
    "start": "2118800",
    "end": "2125359"
  },
  {
    "start": "2125000",
    "end": "2254000"
  },
  {
    "text": "JavaScript any time I'm like but like both of those parties have the same power now so the the ultimatum was given",
    "start": "2125359",
    "end": "2132119"
  },
  {
    "text": "to the vendor because they're big concern and this came from like private conversations but their big concern was",
    "start": "2132119",
    "end": "2139160"
  },
  {
    "text": "if they move away from the latest. JS model they have to support all the versions and they have to support all",
    "start": "2139160",
    "end": "2144200"
  },
  {
    "text": "the features and then they have to do plan deprecations and I'm like oh like boohoo you know like come on like this",
    "start": "2144200",
    "end": "2151079"
  },
  {
    "text": "is part of your job and they're like yeah but if you know if we give you the version path we have to support the things and do theu I'm like then don't",
    "start": "2151079",
    "end": "2156800"
  },
  {
    "text": "don't be a vendor like you know but this is this is the way that it's going you need to give us a version path so that",
    "start": "2156800",
    "end": "2162119"
  },
  {
    "text": "we can lock to it with SRI and say you know we want version 3.2.0 and when we go here we will always get version 3.2.0",
    "start": "2162119",
    "end": "2169800"
  },
  {
    "text": "the alternative is you're going to get ripped off all of these government sites because the one thing that was really",
    "start": "2169800",
    "end": "2175200"
  },
  {
    "text": "interesting that the government was like this cannot happen again right this is like super embarrassing potentially",
    "start": "2175200",
    "end": "2180520"
  },
  {
    "text": "really damaging we got so lucky that all they did was mind cryptocurrency I like can you imagine if they did any do the",
    "start": "2180520",
    "end": "2187079"
  },
  {
    "text": "things that I had in my demos like that would have been potentially catastrophic so it's",
    "start": "2187079",
    "end": "2192839"
  },
  {
    "text": "like you know it's bad enough that it happened the first time we got a little bit lucky but this cannot happen again like we have to Sri this asset we cannot",
    "start": "2192839",
    "end": "2199960"
  },
  {
    "text": "just have this ability for a vendor to load arbitary JavaScript into our sites",
    "start": "2199960",
    "end": "2206400"
  },
  {
    "text": "so finally the vendor caved it was like either lose all of your customers or give us version paths and and now if you",
    "start": "2206400",
    "end": "2212680"
  },
  {
    "text": "go look at any of the government websites that I showed you earlier you'll see that they are all now referencing a version in a path with an",
    "start": "2212680",
    "end": "2219560"
  },
  {
    "text": "SRI attribute in the script tag but there are still some cases why",
    "start": "2219560",
    "end": "2225400"
  },
  {
    "text": "this is not possible and actually I was speaking to a fellow speaker from yesterday uh last night and he also came",
    "start": "2225400",
    "end": "2231400"
  },
  {
    "text": "up with another example so my common referen is things like stripe.js if you're using the stripe JavaScript",
    "start": "2231400",
    "end": "2236839"
  },
  {
    "text": "they're constantly updating that like day by day and you can't SRI to it and the example Sebastian came up with was",
    "start": "2236839",
    "end": "2242200"
  },
  {
    "text": "HubSpot JS as well they have the same problem they're constantly mending the",
    "start": "2242200",
    "end": "2247319"
  },
  {
    "text": "script file but there are still even in those scenarios where sometimes you just cannot use SRI there are still other",
    "start": "2247319",
    "end": "2253800"
  },
  {
    "text": "defense mechanisms built into the browser that can save you and the next one is called content security policy",
    "start": "2253800",
    "end": "2260720"
  },
  {
    "start": "2254000",
    "end": "2490000"
  },
  {
    "text": "again supported by all mainstream browsers it's been there since like 2014 I think you can double check me on that",
    "start": "2260720",
    "end": "2267560"
  },
  {
    "text": "but I'm pretty sure it was 2014 so it's been there for quite a while and content security policy is another defense",
    "start": "2267560",
    "end": "2273960"
  },
  {
    "text": "mechanism that you can leverage to protect yourselves from from attacks exactly like this one now content",
    "start": "2273960",
    "end": "2279640"
  },
  {
    "text": "security policy is just a HTTP response header so you can see it there nestled in the middle alongside other HTTP",
    "start": "2279640",
    "end": "2285760"
  },
  {
    "text": "response headers that you're probably familiar with so you declare something like this the content security policy header and I'm going to zoom in on the",
    "start": "2285760",
    "end": "2292160"
  },
  {
    "text": "content of that header for you because this is the actual content security policy now the idea of content security",
    "start": "2292160",
    "end": "2299800"
  },
  {
    "text": "policy is you can Define what should happen on my page what should be on my",
    "start": "2299800",
    "end": "2305720"
  },
  {
    "text": "page and you can see here by default I'm saying it's acceptable to load content from self self means your own site so",
    "start": "2305720",
    "end": "2313480"
  },
  {
    "text": "you're like okay you know what by default you can load stuff from the place that you got the page from that should be safe but then we're getting a",
    "start": "2313480",
    "end": "2320040"
  },
  {
    "text": "bit more specific with the script Source where do you load JavaScript from on your page it's like well I load",
    "start": "2320040",
    "end": "2325560"
  },
  {
    "text": "JavaScript from myself maybe self host some stuff and I also have this external dependency called browsealoud",
    "start": "2325560",
    "end": "2330800"
  },
  {
    "text": "doccom and it's not just about where things are loaded from you can also control where data is sent to so I think",
    "start": "2330800",
    "end": "2336520"
  },
  {
    "text": "things like the connect Source controls like where can you send xhrs we have form action to control where can forms",
    "start": "2336520",
    "end": "2342960"
  },
  {
    "text": "send data to so you can control Assets in and data",
    "start": "2342960",
    "end": "2348040"
  },
  {
    "text": "out and with such a simple policy like this a typical content security policy will be a bit more complex but with a a",
    "start": "2348040",
    "end": "2354200"
  },
  {
    "text": "typical policy like this first of all we would have completely neutralized this",
    "start": "2354200",
    "end": "2359640"
  },
  {
    "text": "attack because yes you're loading the compromised JavaScript from browser loud",
    "start": "2359640",
    "end": "2364800"
  },
  {
    "text": "but when they load it it's just the bootstrap to start pulling all of their assets from coinhive so the the browser would look",
    "start": "2364800",
    "end": "2371160"
  },
  {
    "text": "at that and say okay well we can load the Brows L JavaScript because it's on the list but then when he tries to load",
    "start": "2371160",
    "end": "2376839"
  },
  {
    "text": "this other JavaScript from coinhive decom it would go no that's not on the list see you later now even if and then some people",
    "start": "2376839",
    "end": "2384280"
  },
  {
    "text": "say ah but they could have taken the content of the coinhive library and put it in the browser loud file so it would",
    "start": "2384280",
    "end": "2389480"
  },
  {
    "text": "still load and you'd be right but then that JavaScript still got to send data somewhere and that's when we'd hit the",
    "start": "2389480",
    "end": "2395200"
  },
  {
    "text": "second row block which is is the connect Source when it tries to start sending data to these other domains that are not",
    "start": "2395200",
    "end": "2400760"
  },
  {
    "text": "on the list that's going to be neutralized in the page and it will not be allowed to communicate so there's",
    "start": "2400760",
    "end": "2406319"
  },
  {
    "text": "there's lots of different ways that we can try and Tackle this problem and the great thing is this is native",
    "start": "2406319",
    "end": "2411960"
  },
  {
    "text": "functionality in the browser you don't have to deploy any you know serice side agent or any JavaScript library on the",
    "start": "2411960",
    "end": "2417920"
  },
  {
    "text": "page the problem is Javascript the solution is not more JavaScript and and this is built into the browser native functionality and the",
    "start": "2417920",
    "end": "2425200"
  },
  {
    "text": "final piece of the puzzle is that you can actually ask the browser to call back to you when it finds something in",
    "start": "2425200",
    "end": "2431319"
  },
  {
    "text": "the page that shouldn't be there so you say to the browser look this is what should happen on my page and if",
    "start": "2431319",
    "end": "2436480"
  },
  {
    "text": "something happens what we refer to as a violation of the policy you can ask it to send you a violation report and you",
    "start": "2436480",
    "end": "2443520"
  },
  {
    "text": "can give it the address and say I want you to send it here and that's all that you have to do and then if the browser",
    "start": "2443520",
    "end": "2449800"
  },
  {
    "text": "loads this page and it's like hey what's this coin.com JavaScript the browser will start calling back to you and",
    "start": "2449800",
    "end": "2456400"
  },
  {
    "text": "saying I just loaded your page you told me this should happen but this other thing also happened is that",
    "start": "2456400",
    "end": "2463960"
  },
  {
    "text": "right now if you're worried about CSP because you might be kind of starting to sense I could break my website with this",
    "start": "2463960",
    "end": "2470599"
  },
  {
    "text": "if I accidentally block legitimate JavaScript we have a different variation of the header called report only which",
    "start": "2470599",
    "end": "2476079"
  },
  {
    "text": "is a perfectly safe test mode so you can deploy this it won't break a single thing but it will tell you this is what",
    "start": "2476079",
    "end": "2482240"
  },
  {
    "text": "I would have done right so it's like completely safe test mode and you will still get those reports sent to that",
    "start": "2482240",
    "end": "2488760"
  },
  {
    "text": "endpoint and they're just a really simple little piece of Json with all of the pertinent information okay I came to",
    "start": "2488760",
    "end": "2496240"
  },
  {
    "start": "2490000",
    "end": "2619000"
  },
  {
    "text": "your site this is the page that I was on this is the thing that I blocked it will give you a copy of the original policy",
    "start": "2496240",
    "end": "2502760"
  },
  {
    "text": "further down to say this is the policy that you gave me to work with so I could look at all of this right now and be like okay yeah so either we've just",
    "start": "2502760",
    "end": "2510319"
  },
  {
    "text": "added a new dependency and this is expected we have a new JavaScript dependency or",
    "start": "2510319",
    "end": "2516800"
  },
  {
    "text": "we have a new JavaScript dependency and it wasn't expected it's not supposed to be here so as soon as you start",
    "start": "2516800",
    "end": "2522200"
  },
  {
    "text": "receiving these reports you either need to go update your policy to add your new dependency or you need to call incident",
    "start": "2522200",
    "end": "2527359"
  },
  {
    "text": "respon in because you've had some kind of breach somewhere there's only two outcomes for this but now you know about",
    "start": "2527359",
    "end": "2534040"
  },
  {
    "text": "it same thing with the connect Source if your website starts sending data to a brand new place that you've never sent",
    "start": "2534040",
    "end": "2540319"
  },
  {
    "text": "data to either you've got some new functionality and and it's all good or you have a really big problem that you",
    "start": "2540319",
    "end": "2547240"
  },
  {
    "text": "need to go and investigate and all of this comes natively from the browser there's no",
    "start": "2547240",
    "end": "2553280"
  },
  {
    "text": "software there's no licenses there's no agents or code it's you send that response header and the browser does",
    "start": "2553280",
    "end": "2559760"
  },
  {
    "text": "everything that I've just said and that's in every mainstream browser and has been for a really long",
    "start": "2559760",
    "end": "2565240"
  },
  {
    "text": "time now this you know obviously the main kind of Defense from content security policy is this you end up with",
    "start": "2565240",
    "end": "2572359"
  },
  {
    "text": "hostile JavaScript in your page and once we don't see crypto jacking so much now",
    "start": "2572359",
    "end": "2577880"
  },
  {
    "text": "throughout 2021 2022 it kind of started to tail off 2017 and 2018 were like",
    "start": "2577880",
    "end": "2583800"
  },
  {
    "text": "really big years for crypto jacking they were phenomenally massive and from kind of like",
    "start": "2583800",
    "end": "2588880"
  },
  {
    "text": "2014 as well it was kind of on the ramp I think it kind of followed the curve of the popularity of cryptocurrency perhaps",
    "start": "2588880",
    "end": "2596200"
  },
  {
    "text": "but what attackers realized because they're always here to make money is they realize that there's better ways of",
    "start": "2596200",
    "end": "2601839"
  },
  {
    "text": "making money if I if I sent to you now I'm going to allow you to inject arbitary JavaScript into thousands of",
    "start": "2601839",
    "end": "2608400"
  },
  {
    "text": "websites and I want you to make money with it could you come up with a better idea and the answer is probably I mean",
    "start": "2608400",
    "end": "2614000"
  },
  {
    "text": "I'm not saying you're all evil people but the answer is probably yes right like you could probably come up with something and the attackers have shifted",
    "start": "2614000",
    "end": "2619599"
  },
  {
    "start": "2619000",
    "end": "2684000"
  },
  {
    "text": "their focus now so there's a new Collective that we refer to is Mage cart or magicart and what they have done now",
    "start": "2619599",
    "end": "2627240"
  },
  {
    "text": "with their evil JavaScript injection capabilities and and I've got a couple of the samples on my website they're",
    "start": "2627240",
    "end": "2633480"
  },
  {
    "text": "just like four or five lines of JavaScript that are just a simple key logger they drop the key logger in the",
    "start": "2633480",
    "end": "2639160"
  },
  {
    "text": "background they don't do anything else but when users are interacting with the page typing in data it's just skimming",
    "start": "2639160",
    "end": "2646079"
  },
  {
    "text": "all of those keystrokes and just firing them off to the drop server on the back end and what they're focusing on now and",
    "start": "2646079",
    "end": "2653160"
  },
  {
    "text": "many of the skimmers if you look at the samples on my site they will scan the URL to see if they're on a payment page",
    "start": "2653160",
    "end": "2658240"
  },
  {
    "text": "and the skimmer will only skim if it's on a page that looks like a payment page so they do a basic reg X usually on the",
    "start": "2658240",
    "end": "2664599"
  },
  {
    "text": "the URL string and if it's got some kind of payment reference they will activate",
    "start": "2664599",
    "end": "2669680"
  },
  {
    "text": "the schimmer and then as you're sat there typing in your 16-digit card number and your security code and your",
    "start": "2669680",
    "end": "2675960"
  },
  {
    "text": "expiry date they're all just being fired out of the back so they've turned them",
    "start": "2675960",
    "end": "2681000"
  },
  {
    "text": "now into some of the Mage cart attacks that we've seen have been the largest theft of card data ever because they get",
    "start": "2681000",
    "end": "2688520"
  },
  {
    "start": "2684000",
    "end": "2780000"
  },
  {
    "text": "them onto really popular websites so Mage cart attacks were kind of ramping",
    "start": "2688520",
    "end": "2694440"
  },
  {
    "text": "up as crypto jacking was ramping down and really all the attackers are doing was changing what they're doing with",
    "start": "2694440",
    "end": "2699800"
  },
  {
    "text": "their evil JavaScript now the 2018 was the really big year for for magecart it was",
    "start": "2699800",
    "end": "2707400"
  },
  {
    "text": "enormous these organizations especially Ticket Master and British Airways I was really kind of heavily involved with",
    "start": "2707400",
    "end": "2713200"
  },
  {
    "text": "those uh on the UK side of things these organizations have like just on the 2018",
    "start": "2713200",
    "end": "2718599"
  },
  {
    "text": "line have been hit collectively with hundreds of millions of dollars in fines alone right let alone like the business",
    "start": "2718599",
    "end": "2724520"
  },
  {
    "text": "damage but just from like privacy Regulators so in the UK massive irony like the Ico fined both of these",
    "start": "2724520",
    "end": "2731160"
  },
  {
    "text": "companies for having malicious JavaScript on their website because they lost people's names and addresses and",
    "start": "2731160",
    "end": "2736400"
  },
  {
    "text": "payment card data sensitive personal information so they then obviously don't just get fined by you know International",
    "start": "2736400",
    "end": "2743000"
  },
  {
    "text": "websites they don't just get fined by the British regulator they get fined by The Regulators of the countries whose citizens were impacted which you know if",
    "start": "2743000",
    "end": "2749680"
  },
  {
    "text": "you're Ticket Master of British Airways is a lot of countries so now we're",
    "start": "2749680",
    "end": "2754839"
  },
  {
    "text": "getting into the realm of you know they were probably not making that much money with the cryptojacking thing because you can't mind that much",
    "start": "2754839",
    "end": "2760240"
  },
  {
    "text": "Monero in CPU which is all you have access to in JavaScript at the time so",
    "start": "2760240",
    "end": "2765280"
  },
  {
    "text": "yeah they've they've shifted their focus it's still the exact same attack they found a way to get JavaScript in your",
    "start": "2765280",
    "end": "2771400"
  },
  {
    "text": "page that shouldn't have been there the only thing that's changed is what they do with it all of the previous defense",
    "start": "2771400",
    "end": "2777119"
  },
  {
    "text": "mechanisms still apply all of these attacks can be broken down into these three steps somebody somewhere has to",
    "start": "2777119",
    "end": "2783800"
  },
  {
    "start": "2780000",
    "end": "2877000"
  },
  {
    "text": "have a breach right it might be your server and the JavaScript goes in there might be a third party dependency but",
    "start": "2783800",
    "end": "2789520"
  },
  {
    "text": "some breaches happen somewhere and of course we always try and stop at this step but if it's a third party there's",
    "start": "2789520",
    "end": "2794839"
  },
  {
    "text": "often not much we can do the second point is the injection point they have to get the script in the",
    "start": "2794839",
    "end": "2800440"
  },
  {
    "text": "page and this is where either SRI or CSP should be able to help you we're going",
    "start": "2800440",
    "end": "2806160"
  },
  {
    "text": "to try and neutralize it at the point of injection into the page and then if we can't use SRI on the asset you know it's",
    "start": "2806160",
    "end": "2812839"
  },
  {
    "text": "like stripe.js or some vendor that just won't let you have a status version the final point we can stop this is the",
    "start": "2812839",
    "end": "2819000"
  },
  {
    "text": "exfiltration Because if you think about it especially for things like the British Airways breach if the malicious JavaScript is",
    "start": "2819000",
    "end": "2825280"
  },
  {
    "text": "running in a page and as you're typing those keys it's trying to send the data but all of the outbound requests",
    "start": "2825280",
    "end": "2831480"
  },
  {
    "text": "fail there's not actually being a data breach has there because the attacker JavaScript might be running in the page",
    "start": "2831480",
    "end": "2837359"
  },
  {
    "text": "but if it can't actually steal the data and the data never leaves your browser we can still neutralize the breach at",
    "start": "2837359",
    "end": "2842800"
  },
  {
    "text": "this final point so there's three Avenues there that we can tackle this",
    "start": "2842800",
    "end": "2848240"
  },
  {
    "text": "with and hopefully you know we want to stop it further on the left but sometimes we end up all the way over to the right this is something that we",
    "start": "2848240",
    "end": "2854079"
  },
  {
    "text": "refer to in the security industry is defense in depth we have here three very clearly distinct points that we can",
    "start": "2854079",
    "end": "2860240"
  },
  {
    "text": "neutralize attacks like this and if you implement all of them you would hope that before you know the fourth point",
    "start": "2860240",
    "end": "2865480"
  },
  {
    "text": "would be like data breach you would hope that on those points before we could have actually nipped this in the B and",
    "start": "2865480",
    "end": "2871280"
  },
  {
    "text": "stopped it so hopefully you can take away that information information content security",
    "start": "2871280",
    "end": "2877400"
  },
  {
    "start": "2877000",
    "end": "2918000"
  },
  {
    "text": "policy sub resource integrity and put them to good use they're free they're built into the browser they're supported",
    "start": "2877400",
    "end": "2884400"
  },
  {
    "text": "by all of the mainstream clients and even if the client doesn't support it it doesn't matter it will just ignore it and do what it did before so there is",
    "start": "2884400",
    "end": "2890839"
  },
  {
    "text": "literally no downside to any of this so I do like to save a little bit of time",
    "start": "2890839",
    "end": "2896000"
  },
  {
    "text": "at the end I realize we only have a few minutes left but just in case any questions come through the app and I also really love to take questions from",
    "start": "2896000",
    "end": "2901760"
  },
  {
    "text": "the room as well",
    "start": "2901760",
    "end": "2907640"
  }
]