[
  {
    "text": "all right let's get started um my name is alard Baer and um I'm going to uh to",
    "start": "8280",
    "end": "15160"
  },
  {
    "text": "complain SL talk about uh the pragmatic approach or the lack thereof sometimes",
    "start": "15160",
    "end": "21640"
  },
  {
    "text": "of building microservices um at the moment I'm CTO",
    "start": "21640",
    "end": "26840"
  },
  {
    "text": "of trior Amsterdam and I'm also the founder of axon framework and it won't be strange if I tell you that I'll be uh",
    "start": "26840",
    "end": "35399"
  },
  {
    "text": "talking about and showing you some uh some axon uh related",
    "start": "35399",
    "end": "40680"
  },
  {
    "text": "stuff um while preparing my slides I realized that nothing I say or do in",
    "start": "40680",
    "end": "48320"
  },
  {
    "text": "this in this uh presentation would be better off with slides so I decided to",
    "start": "48320",
    "end": "54000"
  },
  {
    "text": "do no slides at all and just keep to um to a live demo actually and uh and live",
    "start": "54000",
    "end": "59719"
  },
  {
    "text": "Cod as well um so instead of just talking about a microservice environment",
    "start": "59719",
    "end": "66680"
  },
  {
    "text": "or system of of um how would you call that a system of microservices uh let's",
    "start": "66680",
    "end": "72720"
  },
  {
    "text": "just build one right how long could it take to to build something like that anyway uh we've got plenty of time today",
    "start": "72720",
    "end": "79640"
  },
  {
    "text": "what I've realized is or what I've noticed is that as soon as a new project starts I have the uh the luck to be",
    "start": "79640",
    "end": "86400"
  },
  {
    "text": "involved in a lot of Green Field projects um a lot of the discussions are about oh",
    "start": "86400",
    "end": "92880"
  },
  {
    "text": "what technology should we use should we use historics or do we what what what Discovery mechanism will we use to",
    "start": "92880",
    "end": "99960"
  },
  {
    "text": "discover the 200 clients that we have or the 200 components that we have in mind right now so everything is about what",
    "start": "99960",
    "end": "106159"
  },
  {
    "text": "technologies are going are we going to throw at our um solution or problem to",
    "start": "106159",
    "end": "112360"
  },
  {
    "text": "make it uh to make it make it technically really interesting but in the end that doesn't really help in",
    "start": "112360",
    "end": "118960"
  },
  {
    "text": "achieving the primary goal that those people have and that's get customers",
    "start": "118960",
    "end": "124479"
  },
  {
    "text": "right if you have a green field project the first thing you should worry about is get the logic out get the business",
    "start": "124479",
    "end": "129640"
  },
  {
    "text": "logic working and see if anyone wants to use it and only when",
    "start": "129640",
    "end": "135040"
  },
  {
    "text": "people start using it then you fix the uh scalability problems if they uh if",
    "start": "135040",
    "end": "140920"
  },
  {
    "text": "they come up um so what I'm going to show you is I'm",
    "start": "140920",
    "end": "147280"
  },
  {
    "text": "going to use the the spring initializer to create a little project and I'm going to show you how",
    "start": "147280",
    "end": "153160"
  },
  {
    "text": "axon keeps the business logic and the infrastructure logic",
    "start": "153160",
    "end": "159720"
  },
  {
    "text": "separate because scaling up and down should not change how your application",
    "start": "159720",
    "end": "166040"
  },
  {
    "text": "behaves right so the business logic itself the problem you're trying to solve is the same one it's only the",
    "start": "166040",
    "end": "172159"
  },
  {
    "text": "scale at which you're trying to solve it that might differ a bit um so a very important aspect in in",
    "start": "172159",
    "end": "179080"
  },
  {
    "text": "axon is is location transparency objects or components should not care or even know where other",
    "start": "179080",
    "end": "186760"
  },
  {
    "text": "components that they use are located are they in the same VM are they on a different VM in a different data center",
    "start": "186760",
    "end": "192799"
  },
  {
    "text": "wherever it doesn't matter they shouldn't care right um so what we what we're going to do is build a little",
    "start": "192799",
    "end": "200720"
  },
  {
    "text": "application where people can file complaints um the ones that were in the",
    "start": "200720",
    "end": "206400"
  },
  {
    "text": "room early probably saw that I had to reboot my machine so I need a place to complain about Microsoft uh and",
    "start": "206400",
    "end": "213200"
  },
  {
    "text": "especially Windows 10 so let's build one right",
    "start": "213200",
    "end": "218840"
  },
  {
    "text": "um there probably is a place already but this one's going to be better um so we're going to use uh um spring boots to",
    "start": "218840",
    "end": "227360"
  },
  {
    "text": "to get started quickly I'm going to include web H we need a relational database uh use jpa not because it",
    "start": "227360",
    "end": "235280"
  },
  {
    "text": "performs but it guess I started pretty quickly and I'm going to do some amq stuff later on as",
    "start": "235280",
    "end": "242799"
  },
  {
    "text": "well now let's hope the internet works otherwise we have something else to complain about and then we unzip that",
    "start": "242799",
    "end": "252079"
  },
  {
    "text": "file and we start the",
    "start": "252079",
    "end": "256599"
  },
  {
    "text": "project that should start the project",
    "start": "258880",
    "end": "265600"
  },
  {
    "text": "great give intellig some time to think about what it should do there we go um",
    "start": "267000",
    "end": "273320"
  },
  {
    "text": "who's not familiar with spring boot or you are now spring boot is uh",
    "start": "273320",
    "end": "279720"
  },
  {
    "text": "are you who of those people is not familiar with spring just a few all right um so I'm",
    "start": "279720",
    "end": "287080"
  },
  {
    "text": "not going to explain all of spring and and spring boot but at least spring boot gives us um spring with additional or",
    "start": "287080",
    "end": "295479"
  },
  {
    "text": "some call it magic I call it autoc configuration that configures um our application based on dependencies",
    "start": "295479",
    "end": "303160"
  },
  {
    "text": "that we have or do not have on our on our class path uh so in this case I've",
    "start": "303160",
    "end": "309039"
  },
  {
    "text": "I've included jpa and amqp and hsql DB so it configures",
    "start": "309039",
    "end": "315199"
  },
  {
    "text": "everything I need to use jpa in hsql DB for me so don't have to to think about",
    "start": "315199",
    "end": "321840"
  },
  {
    "text": "that um and I've included web so it's actually a web application I can just start this uh class and I'll have a web",
    "start": "321840",
    "end": "329400"
  },
  {
    "text": "app that does exactly what you see here nothing um so let's uh let's build",
    "start": "329400",
    "end": "336479"
  },
  {
    "text": "something let's start with a uh uh oops I do that all the time rest",
    "start": "336479",
    "end": "343000"
  },
  {
    "text": "let's create a rest controller we need an API for uh for our uh users to to",
    "start": "343000",
    "end": "348280"
  },
  {
    "text": "file the complaints I'm going to be a very lazy and bad developer to put",
    "start": "348280",
    "end": "355280"
  },
  {
    "text": "everything in the same file here almost everything but that's just because it's uh",
    "start": "355280",
    "end": "361240"
  },
  {
    "text": "very easy to do so we're going to create a little",
    "start": "361240",
    "end": "367599"
  },
  {
    "text": "controller and we create a method that gets invoked I'm going to um that gets",
    "start": "367599",
    "end": "373880"
  },
  {
    "text": "invoked when we do a get request right so get requests are mapped to this method and we could say we do a find all",
    "start": "373880",
    "end": "380479"
  },
  {
    "text": "method that gives us all the complaints that we uh have in our system right so",
    "start": "380479",
    "end": "386960"
  },
  {
    "text": "we need some uh form of Repository um to retrieve all the complaints that",
    "start": "386960",
    "end": "394800"
  },
  {
    "text": "we've created but we are going to use cqs which is the command and query",
    "start": "394800",
    "end": "400199"
  },
  {
    "text": "responsibility segregation pattern uh so we're not going to have a single model",
    "start": "400199",
    "end": "405800"
  },
  {
    "text": "in our application that we query and update at the same time we're going to separate those we're going to have one",
    "start": "405800",
    "end": "412720"
  },
  {
    "text": "component that deals with the commands that we send and we'll have another component that sends out the information",
    "start": "412720",
    "end": "420240"
  },
  {
    "text": "uh as things happen in our application so if we want to know something about the state of our application like this F",
    "start": "420240",
    "end": "427039"
  },
  {
    "text": "all method we go to a a view model a query model which is optimized for",
    "start": "427039",
    "end": "432400"
  },
  {
    "text": "serving out that information as fast as possible um our database here won't have",
    "start": "432400",
    "end": "439039"
  },
  {
    "text": "massive amounts of complaints but you can imagine if you put this in production um I mean I'm Dutch in",
    "start": "439039",
    "end": "444759"
  },
  {
    "text": "Holland people love to complain there's actually an organization that does this you know they have an application like",
    "start": "444759",
    "end": "451120"
  },
  {
    "text": "this so we need this place to to complain so that database gets really big and you need to be able to query",
    "start": "451120",
    "end": "457280"
  },
  {
    "text": "that efficiently so let's create a complaint query object",
    "start": "457280",
    "end": "465199"
  },
  {
    "text": "repository and of course that doesn't exist yet so let's create an interface and this is where spring data",
    "start": "466000",
    "end": "472840"
  },
  {
    "text": "jpa comes in really nicely we extend a jpa repository of complaint query",
    "start": "472840",
    "end": "480879"
  },
  {
    "text": "objects identified by a string that's it no that's almost",
    "start": "480879",
    "end": "489039"
  },
  {
    "text": "it that's it so this gives us a jpa repository now",
    "start": "490479",
    "end": "498000"
  },
  {
    "text": "we create a little class here which is a jpa",
    "start": "498000",
    "end": "503599"
  },
  {
    "text": "entity and it has a number of properties uh a complaint",
    "start": "505400",
    "end": "511519"
  },
  {
    "text": "ID a company that we want to complaint about and a description of the actual",
    "start": "511519",
    "end": "520279"
  },
  {
    "text": "complaint and then create some Getters Constructor a no Arc one because",
    "start": "520279",
    "end": "528600"
  },
  {
    "text": "it's jpa and an all Arc one because it's me that's it now we have our repository",
    "start": "528600",
    "end": "536000"
  },
  {
    "text": "and all we need to do now is repository doind all and then return",
    "start": "536000",
    "end": "542640"
  },
  {
    "text": "that there you go so this is all we need to do to create a little rest API if you",
    "start": "543839",
    "end": "550680"
  },
  {
    "text": "will to uh to map get slash to to get all the uh all the complaints we could",
    "start": "550680",
    "end": "558519"
  },
  {
    "text": "create another mapping oops to uh complaint query object find",
    "start": "558519",
    "end": "565760"
  },
  {
    "text": "one at uh path variable string",
    "start": "565760",
    "end": "573640"
  },
  {
    "text": "ID we get one by identifier and now we need to specify a URL here where we say",
    "start": "575399",
    "end": "585200"
  },
  {
    "text": "we have a path slash something and then that something will map to that identifier which is the identifier of",
    "start": "585200",
    "end": "592720"
  },
  {
    "text": "the complaints we want to fetch but that's not really the interesting part this is probably something you've been",
    "start": "592720",
    "end": "599079"
  },
  {
    "text": "uh if you're not one of those people raising their hands uh but um probably something you've you've used before it",
    "start": "599079",
    "end": "606399"
  },
  {
    "text": "gets interesting when we start doing the post mapping because now we're going to tell the system to do something right",
    "start": "606399",
    "end": "613399"
  },
  {
    "text": "and since we are applying cqrs that's command inquiry responsibility segregation we're going to treat these",
    "start": "613399",
    "end": "620440"
  },
  {
    "text": "commands differently we're going to have a different component handle this and we want the location",
    "start": "620440",
    "end": "626760"
  },
  {
    "text": "transparency that I told you about because we are not sure if this component is going to be living with the",
    "start": "626760",
    "end": "632880"
  },
  {
    "text": "UI component forever right um so let's uh create a I'll do a",
    "start": "632880",
    "end": "640399"
  },
  {
    "text": "void for now um file",
    "start": "640399",
    "end": "646440"
  },
  {
    "text": "complaint and we're going to use an HTTP post for this and let's I don't want to",
    "start": "646920",
    "end": "652639"
  },
  {
    "text": "make more objects so we just create a map spring will convert the Json",
    "start": "652639",
    "end": "660680"
  },
  {
    "text": "document that we post to the uh to the map in",
    "start": "660680",
    "end": "666399"
  },
  {
    "text": "Here and Now what we",
    "start": "666839",
    "end": "670480"
  },
  {
    "text": "need is an axon command Gateway which is not",
    "start": "672600",
    "end": "679519"
  },
  {
    "text": "giving me because I haven't added the axon dependency",
    "start": "679519",
    "end": "684519"
  },
  {
    "text": "nice and slow Ma on Spring boot starter there you",
    "start": "689360",
    "end": "697399"
  },
  {
    "text": "go all right so the let me create a little Constructor",
    "start": "703240",
    "end": "708920"
  },
  {
    "text": "here the um command Gateway is a convenience um class that allows us to",
    "start": "708920",
    "end": "716399"
  },
  {
    "text": "to send commands basically um and because because we have included the spring boot starter now the it will",
    "start": "716399",
    "end": "723560"
  },
  {
    "text": "autoc configure all the components that we need for for axon to work um in in",
    "start": "723560",
    "end": "728760"
  },
  {
    "text": "the background so it has given us a command bus Which is the mechanism to get commands from whoever sends it to",
    "start": "728760",
    "end": "736320"
  },
  {
    "text": "whoever needs to to handle them uh there's an event bus as well uh there's an event store that stores all the",
    "start": "736320",
    "end": "742800"
  },
  {
    "text": "events that we've created we'll we'll get to that later but it also gives us a command Gateway so we can just wire the",
    "start": "742800",
    "end": "750240"
  },
  {
    "text": "command Gateway uh in here uh for those not familiar with the new spring 4",
    "start": "750240",
    "end": "755440"
  },
  {
    "text": "features uh you don't have to put Auto wire on uh on these classes anymore if there's a single Constructor it will",
    "start": "755440",
    "end": "761720"
  },
  {
    "text": "just Auto wire the beans in there automatically anyway so we um we want to",
    "start": "761720",
    "end": "768800"
  },
  {
    "text": "send a command on the command Gateway and in axon commands",
    "start": "768800",
    "end": "774639"
  },
  {
    "text": "are um are objects right they're messages that we um we send as objects",
    "start": "774639",
    "end": "781519"
  },
  {
    "text": "from the origin to the destination and that allows us to be location transparent right we do not care where",
    "start": "781519",
    "end": "787560"
  },
  {
    "text": "the actual recipient of that message is um they're a lot easier to to serialize",
    "start": "787560",
    "end": "793360"
  },
  {
    "text": "and send than method invocations and Method invocations always give us the idea especially for things like find all",
    "start": "793360",
    "end": "801800"
  },
  {
    "text": "there's a return value here which forces us to wait for that result to to be",
    "start": "801800",
    "end": "808360"
  },
  {
    "text": "provided right right um so if we use send and then a message we can just fire",
    "start": "808360",
    "end": "813399"
  },
  {
    "text": "a forget um let's create a file complaint",
    "start": "813399",
    "end": "819240"
  },
  {
    "text": "command and we pass in some information we pass in an",
    "start": "819240",
    "end": "824480"
  },
  {
    "text": "identifier uh we get an object the company compy and we",
    "start": "824480",
    "end": "832279"
  },
  {
    "text": "get a description from there as well",
    "start": "832279",
    "end": "838800"
  },
  {
    "text": "now I like client generated identifiers for a number of reasons um so I'm going",
    "start": "841000",
    "end": "848279"
  },
  {
    "text": "to specify the identifier of an object I'm going to create and that might be quite uncommon it might even look weird",
    "start": "848279",
    "end": "855759"
  },
  {
    "text": "um I'm using random uh U IDs in this case because they're pretty very safe uh Collision",
    "start": "855759",
    "end": "863600"
  },
  {
    "text": "wise um but it allows us to to send more commands in a row for the same object",
    "start": "863600",
    "end": "869480"
  },
  {
    "text": "what if you want to create something and then update a few things in a row you don't have to wait for an identifier to come back and then send the next message",
    "start": "869480",
    "end": "876360"
  },
  {
    "text": "you can just send them all in a row and not have to to wait for it um actually this does have a return",
    "start": "876360",
    "end": "883959"
  },
  {
    "text": "value so let's um create this uh class we'll create an inner",
    "start": "883959",
    "end": "891040"
  },
  {
    "text": "class like that it does have to be",
    "start": "891040",
    "end": "895680"
  },
  {
    "text": "public and as you can see I'm let intelligent do most of the",
    "start": "896160",
    "end": "902399"
  },
  {
    "text": "typing because it can type a lot faster than I can and then have that return so it's",
    "start": "902880",
    "end": "911399"
  },
  {
    "text": "actually a string probably doesn't matter so this gives us an API a rest",
    "start": "911399",
    "end": "919000"
  },
  {
    "text": "API in which we can uh file a complaint by doing an HTP post with a request body",
    "start": "919000",
    "end": "926680"
  },
  {
    "text": "and it allows us to retrieve those um um complaints through through an API but of",
    "start": "926680",
    "end": "934040"
  },
  {
    "text": "course there's there's a command going to the void right there's there's nothing handling this command we've just",
    "start": "934040",
    "end": "940519"
  },
  {
    "text": "specified there's an object that we want to send but there's nobody actually listening to that type of",
    "start": "940519",
    "end": "946120"
  },
  {
    "text": "command and that's where it get it gets interesting so cqs is",
    "start": "946120",
    "end": "953680"
  },
  {
    "text": "is is an architectural style but in practice we see that it's it's a applied",
    "start": "953680",
    "end": "959319"
  },
  {
    "text": "in combination with domain driven design a lot because there's a lot of focus on modeling these different uh sides of of",
    "start": "959319",
    "end": "967639"
  },
  {
    "text": "the application right especially on the command side you want to be uh quite efficient there in in handling these uh",
    "start": "967639",
    "end": "975560"
  },
  {
    "text": "these commands and deciding what the actual changes are so",
    "start": "975560",
    "end": "982000"
  },
  {
    "text": "let's let's build what's called an Aggregate and an aggregate is is a group of entities that together act as one",
    "start": "982000",
    "end": "990680"
  },
  {
    "text": "unit when it uh with regards to data changes so if something changes the",
    "start": "990680",
    "end": "996399"
  },
  {
    "text": "aggregate itself is always in a consistent State no matter what happens right and in cqs the aggregate makes the",
    "start": "996399",
    "end": "1005360"
  },
  {
    "text": "decisions based on these incoming commands and based on what happened in the past or the the current state of the",
    "start": "1005360",
    "end": "1010839"
  },
  {
    "text": "aggregate on what will happen when that command comes in in our system we can just file",
    "start": "1010839",
    "end": "1017319"
  },
  {
    "text": "complaints so there's not a lot of business logic going on uh but as you uh add more commands you'll very likely",
    "start": "1017319",
    "end": "1025160"
  },
  {
    "text": "find yourself validating the the commands based on the state of of the complaint for example you can only um",
    "start": "1025160",
    "end": "1033760"
  },
  {
    "text": "close a complaint if it probably needs to be resolved first and then you can close it or maybe uh people need to take",
    "start": "1033760",
    "end": "1041839"
  },
  {
    "text": "specific actions based on a complaint before you can resolve it etc etc",
    "start": "1041839",
    "end": "1048558"
  },
  {
    "text": "so let's create a little class called complaint",
    "start": "1049000",
    "end": "1055200"
  },
  {
    "text": "complaint there's one mandatory field on an Aggregate and that is the",
    "start": "1055200",
    "end": "1062399"
  },
  {
    "text": "identifier identifier there we go now I'm going to create a",
    "start": "1065679",
    "end": "1071440"
  },
  {
    "text": "Constructor and that Constructor is going to be a command hander so that method or in this case",
    "start": "1071440",
    "end": "1078440"
  },
  {
    "text": "Constructor is a a Handler for the command that we're",
    "start": "1078440",
    "end": "1083720"
  },
  {
    "text": "going to send above uh which is the file complaints",
    "start": "1083720",
    "end": "1089320"
  },
  {
    "text": "command and this is our way of saying that method over there can handle this type of",
    "start": "1089320",
    "end": "1095799"
  },
  {
    "text": "command we don't really care how that command comes from that one place to the other place for now right the spring",
    "start": "1095799",
    "end": "1103400"
  },
  {
    "text": "budha AO configuration with um with axon together will give us a a simple command",
    "start": "1103400",
    "end": "1109320"
  },
  {
    "text": "bus which will do the routing within the same JPM for us as soon as we want something else you can overwrite that",
    "start": "1109320",
    "end": "1115200"
  },
  {
    "text": "default and and specify how you want it done um but it's not our primary focus",
    "start": "1115200",
    "end": "1120720"
  },
  {
    "text": "first we want the business logic and we want to get our first customer to to file",
    "start": "1120720",
    "end": "1126600"
  },
  {
    "text": "complaints um now I'm going to apply a little um",
    "start": "1126600",
    "end": "1133559"
  },
  {
    "text": "thing called event sourcing is anyone not familiar with event sourcing",
    "start": "1133559",
    "end": "1139799"
  },
  {
    "text": "anyone not feeling like raising his hand okay I've tried you so okay that's",
    "start": "1139799",
    "end": "1146240"
  },
  {
    "text": "great so I'm not going to uh to explain all that which is a good thing um so",
    "start": "1146240",
    "end": "1151760"
  },
  {
    "text": "what I'm doing here is I'm applying an event I'm going to apply a new complaint",
    "start": "1151760",
    "end": "1157240"
  },
  {
    "text": "filed event I'm going to pass in some data from my",
    "start": "1157240",
    "end": "1164640"
  },
  {
    "text": "command hopefully in the same order as below yes is um and then of course I'm going to",
    "start": "1165600",
    "end": "1172960"
  },
  {
    "text": "have that object",
    "start": "1172960",
    "end": "1175880"
  },
  {
    "text": "created public static actually I'm going to move that one",
    "start": "1178919",
    "end": "1184720"
  },
  {
    "text": "out like",
    "start": "1184720",
    "end": "1187960"
  },
  {
    "text": "that all right some get and there we go a very simple object it's very similar",
    "start": "1190159",
    "end": "1196880"
  },
  {
    "text": "actually to the to the command um but I like to I mean code duplication is uh is",
    "start": "1196880",
    "end": "1203360"
  },
  {
    "text": "heavily debated nowadays and it's apparently not that bad to actually duplicate code because they they do mean",
    "start": "1203360",
    "end": "1210159"
  },
  {
    "text": "two different things right my event is definitely different than my command so any tool telling me to make that one",
    "start": "1210159",
    "end": "1217400"
  },
  {
    "text": "class gets kicked out of whatever uh I I don't want that in my my IDE there are",
    "start": "1217400",
    "end": "1222799"
  },
  {
    "text": "two different objects and they happen to have at this point in time the same Fields but that's probably not going to",
    "start": "1222799",
    "end": "1228960"
  },
  {
    "text": "be the case after the second or third iteration of our uh of our little",
    "start": "1228960",
    "end": "1234760"
  },
  {
    "text": "project um so let's do a little bit of validation uh assert do has length uh",
    "start": "1234760",
    "end": "1241840"
  },
  {
    "text": "command. get company so what I should not do and",
    "start": "1241840",
    "end": "1247159"
  },
  {
    "text": "that's very important is in my command Handler I should not modify any Fields I should not modify any state in my",
    "start": "1247159",
    "end": "1253799"
  },
  {
    "text": "aggregate because those modifications are not going to be applied when I reread my my aggregate from the historic",
    "start": "1253799",
    "end": "1260159"
  },
  {
    "text": "state which is event sourcing right so what I need to do is have a separate",
    "start": "1260159",
    "end": "1265360"
  },
  {
    "text": "separate methods that do apply these State changes U but then based on the",
    "start": "1265360",
    "end": "1273600"
  },
  {
    "text": "events so what does it mean for this um complaint instance when it has been uh",
    "start": "1276080",
    "end": "1283320"
  },
  {
    "text": "filed it means that the identifier is set",
    "start": "1283320",
    "end": "1289880"
  },
  {
    "text": "to the value in that uh create event right so when we reload a complaint",
    "start": "1290000",
    "end": "1295880"
  },
  {
    "text": "based on the historic events that have occurred well they're historic so they",
    "start": "1295880",
    "end": "1301480"
  },
  {
    "text": "have occurred in the past when we reply reapply those events to reconstruct the current state we invoke the add event",
    "start": "1301480",
    "end": "1309000"
  },
  {
    "text": "sourcing Handler methods right we are not going to invoke any of the uh command Handler methods until it has",
    "start": "1309000",
    "end": "1315200"
  },
  {
    "text": "been loaded and then uh we generate new",
    "start": "1315200",
    "end": "1321080"
  },
  {
    "text": "events so that's it that's all we need to do to create in this case the the business logic to um to handle the",
    "start": "1321080",
    "end": "1329000"
  },
  {
    "text": "command and then generate an event but now we have an event leading nowhere right we haven't still gone full circle",
    "start": "1329000",
    "end": "1336400"
  },
  {
    "text": "on our little uh API here so we are sending a command out the aggregate will",
    "start": "1336400",
    "end": "1341640"
  },
  {
    "text": "be handling that command making a decision if it likes it uh if there's a company name in there specifically",
    "start": "1341640",
    "end": "1349080"
  },
  {
    "text": "then we generate an event but now that event goes nowhere and we still haven't updated our data uh sorry here in the",
    "start": "1349080",
    "end": "1356480"
  },
  {
    "text": "repository right so let's do that now let's create a little at component",
    "start": "1356480",
    "end": "1364679"
  },
  {
    "text": "that's a spring [Music] component uh",
    "start": "1364679",
    "end": "1370279"
  },
  {
    "text": "complaint querium model updator and that has an event handler",
    "start": "1370279",
    "end": "1379559"
  },
  {
    "text": "and when a complaint is filed what we want to do is we want to",
    "start": "1381360",
    "end": "1388039"
  },
  {
    "text": "update the",
    "start": "1388039",
    "end": "1390519"
  },
  {
    "text": "repository and get some data from here",
    "start": "1402039",
    "end": "1407399"
  },
  {
    "text": "at the company and the",
    "start": "1409600",
    "end": "1413760"
  },
  {
    "text": "description so this will store a new query object which is basically a dto to",
    "start": "1415039",
    "end": "1421120"
  },
  {
    "text": "get data out as fast as possible uh into our repository every time a complaint is",
    "start": "1421120",
    "end": "1428039"
  },
  {
    "text": "filed now this is something that we should be able to",
    "start": "1428039",
    "end": "1433320"
  },
  {
    "text": "run and now the question is always what did I forget so we'll see in a",
    "start": "1433320",
    "end": "1440720"
  },
  {
    "text": "second nothing so far can you read",
    "start": "1449279",
    "end": "1457039"
  },
  {
    "text": "this there we go curl so we we're going to send a little uh post",
    "start": "1457039",
    "end": "1464440"
  },
  {
    "text": "request uh content type",
    "start": "1464440",
    "end": "1469278"
  },
  {
    "text": "make one typo here and it doesn't work okay minus D and then we're going to",
    "start": "1469880",
    "end": "1475240"
  },
  {
    "text": "send a little Json document containing a",
    "start": "1475240",
    "end": "1480520"
  },
  {
    "text": "company Microsoft and then a",
    "start": "1481000",
    "end": "1487320"
  },
  {
    "text": "description of needed to reboot again there we go",
    "start": "1487679",
    "end": "1496679"
  },
  {
    "text": "I'm pretty sure they'll be reading this um Can somebody take a picture and put this on Twitter at",
    "start": "1496679",
    "end": "1502799"
  },
  {
    "text": "Microsoft okay and I always forget the URL local 880 there you go ah see I",
    "start": "1502799",
    "end": "1509399"
  },
  {
    "text": "forgot something I always forget",
    "start": "1509399",
    "end": "1514760"
  },
  {
    "text": "something yes so even spring is not",
    "start": "1514760",
    "end": "1520039"
  },
  {
    "text": "magic you need to set the repository to a value if you want to use it",
    "start": "1520039",
    "end": "1528960"
  },
  {
    "text": "there we go that's it now we should be able to go to Local",
    "start": "1532159",
    "end": "1537840"
  },
  {
    "text": "Host ad8 and get all complaints um let's make that a bit larger there you",
    "start": "1537840",
    "end": "1545399"
  },
  {
    "text": "go so now we've gone full circle and this is all within the same same jvm",
    "start": "1545399",
    "end": "1550960"
  },
  {
    "text": "right but at least we got something up and running uh pretty quickly um if you",
    "start": "1550960",
    "end": "1556039"
  },
  {
    "text": "have used axon before especially the 2. 4 version or 2. whatever um you'll",
    "start": "1556039",
    "end": "1562440"
  },
  {
    "text": "probably remember the times where you needed to specify the command bus event bus repository uh command Handler",
    "start": "1562440",
    "end": "1569320"
  },
  {
    "text": "annotated aggregate command Handler stuff I don't know what um all that's gone you just get everything uh out of",
    "start": "1569320",
    "end": "1576320"
  },
  {
    "text": "the box and uh and for free um but we're still in the same jvm and",
    "start": "1576320",
    "end": "1584600"
  },
  {
    "text": "this is not really a very inspiring environment right hardly uh micros well",
    "start": "1584600",
    "end": "1590039"
  },
  {
    "text": "it's one microservice or micr monolith if you will um so of course there's always this um",
    "start": "1590039",
    "end": "1599039"
  },
  {
    "text": "this this management thing right the these managers want to be able to um see",
    "start": "1599039",
    "end": "1604320"
  },
  {
    "text": "statistics right they they don't care about the details they want to see the big picture um so it's it's only a",
    "start": "1604320",
    "end": "1610559"
  },
  {
    "text": "matter of time until they come with a request okay I want to see how many complaints we get for each company right",
    "start": "1610559",
    "end": "1617120"
  },
  {
    "text": "give me the Tom T companies that are being complained about um now we could put that in our",
    "start": "1617120",
    "end": "1624320"
  },
  {
    "text": "micr monolith and make it a slightly less micro but uh thing or we um develop",
    "start": "1624320",
    "end": "1630600"
  },
  {
    "text": "it somewhere else which is of course much more uh much more interesting so let's do that instead to be able to do",
    "start": "1630600",
    "end": "1638000"
  },
  {
    "text": "that I need to get the events that we generate out of this virtual machine we",
    "start": "1638000",
    "end": "1643440"
  },
  {
    "text": "want to get them somewhere else uh as you've seen on the uh on Spring uh on the spring initializer I included",
    "start": "1643440",
    "end": "1651080"
  },
  {
    "text": "amqp uh which is the spring amqp configuration unfortunately yet they",
    "start": "1651080",
    "end": "1657200"
  },
  {
    "text": "don't include axon amqp there yet but that's done in no",
    "start": "1657200",
    "end": "1662320"
  },
  {
    "text": "time and then I [Music] can tell",
    "start": "1662320",
    "end": "1667399"
  },
  {
    "text": "axon uh amqp do exchange equals to forward all the",
    "start": "1667399",
    "end": "1674000"
  },
  {
    "text": "events to an amqp exchange um now who's not familiar with",
    "start": "1674000",
    "end": "1680320"
  },
  {
    "text": "amqp okay a few yeah so in amqp is like it's a message broker right and it has a",
    "start": "1680320",
    "end": "1686080"
  },
  {
    "text": "number of um um building blocks that you can use mainly exchanges bindings and",
    "start": "1686080",
    "end": "1692000"
  },
  {
    "text": "cues and an exchange is something you send messages to and the cues is the place where you read messages from right",
    "start": "1692000",
    "end": "1699240"
  },
  {
    "text": "so every message you send to an exchange uh will have a copy put into a one or",
    "start": "1699240",
    "end": "1705240"
  },
  {
    "text": "more cues depending on the binding right right so the binding links the exchanges to the",
    "start": "1705240",
    "end": "1712158"
  },
  {
    "text": "cues so complaint events let's call it complaint events now I have to do a bit of",
    "start": "1713200",
    "end": "1719919"
  },
  {
    "text": "configuration in my spring boot application um at what was it again",
    "start": "1719919",
    "end": "1727559"
  },
  {
    "text": "Bean public [Music]",
    "start": "1727559",
    "end": "1732929"
  },
  {
    "text": "QQ come on import the right one we'll overload a term",
    "start": "1734559",
    "end": "1740640"
  },
  {
    "text": "q q Builder dot let's make a durable Q complaint",
    "start": "1740640",
    "end": "1745840"
  },
  {
    "text": "events the name doesn't really matter that much do",
    "start": "1745840",
    "end": "1751960"
  },
  {
    "text": "build there you go I have another bean",
    "start": "1751960",
    "end": "1757480"
  },
  {
    "text": "oops public [Music]",
    "start": "1757480",
    "end": "1762650"
  },
  {
    "text": "exchange guess what there's an exchange Builder and we're going to choose a",
    "start": "1763039",
    "end": "1769000"
  },
  {
    "text": "F out because it's the simplest exchange there is uh complaint events let's give",
    "start": "1769000",
    "end": "1776200"
  },
  {
    "text": "everything the same name just to make it really confusing and then we need a",
    "start": "1776200",
    "end": "1784440"
  },
  {
    "text": "binding to link the two guess what binding Builder we can",
    "start": "1784440",
    "end": "1791760"
  },
  {
    "text": "bind our little Q to our Exchange",
    "start": "1791760",
    "end": "1798760"
  },
  {
    "text": "with and the routing key doesn't really matter in this case it tells us which U",
    "start": "1798760",
    "end": "1804559"
  },
  {
    "text": "which events do you want to send to that que that you're binding to we want",
    "start": "1804559",
    "end": "1809679"
  },
  {
    "text": "everything um so this allows our application to use these cues and exchanges but it doesn't create them we",
    "start": "1809679",
    "end": "1817200"
  },
  {
    "text": "need to uh specify that we need to create those cues as well uh and there's a",
    "start": "1817200",
    "end": "1826240"
  },
  {
    "text": "little bean called mq admin and this is our amqp administrator",
    "start": "1826240",
    "end": "1833200"
  },
  {
    "text": "so we can Define cues that we expect to be there when this application runs so",
    "start": "1833200",
    "end": "1839320"
  },
  {
    "text": "we're in a little devops environment we're not going to create our document and then write a word docu or create our",
    "start": "1839320",
    "end": "1845440"
  },
  {
    "text": "application and then write a word document for the deployers to deploy oh and remember before starting the",
    "start": "1845440",
    "end": "1851279"
  },
  {
    "text": "applications please create a queue like this and an exchange like that and buy like this no we do it in code right",
    "start": "1851279",
    "end": "1859440"
  },
  {
    "text": "um so we declare a q oops what am I doing declare",
    "start": "1860200",
    "end": "1871039"
  },
  {
    "text": "Q declare exchange and I",
    "start": "1873760",
    "end": "1880480"
  },
  {
    "text": "declare binding so make sure you do it in the",
    "start": "1880480",
    "end": "1886039"
  },
  {
    "text": "right order don't Define the binding first because you're going to bind a Q and exchange that don't",
    "start": "1886039",
    "end": "1891559"
  },
  {
    "text": "exist and restart so this will allow us",
    "start": "1891559",
    "end": "1898440"
  },
  {
    "text": "to well this will actually send our messages to uh to The Exchange and place",
    "start": "1898440",
    "end": "1903760"
  },
  {
    "text": "them in a que so let's file a complaint again it's",
    "start": "1903760",
    "end": "1910399"
  },
  {
    "text": "an inmemory database so we've lost our complaints so far uh let's complain about Apple as well otherwise it's only",
    "start": "1910399",
    "end": "1917440"
  },
  {
    "text": "Microsoft that's not fair Apple description guess what I'm going",
    "start": "1917440",
    "end": "1923559"
  },
  {
    "text": "to complain about prices I was going to do this",
    "start": "1923559",
    "end": "1931360"
  },
  {
    "text": "okay I'm missing a hell oh don't do quotes I am missing a hell of a lot of",
    "start": "1931360",
    "end": "1939440"
  },
  {
    "text": "stuff on my expensive",
    "start": "1939440",
    "end": "1944320"
  },
  {
    "text": "machine please send USB port and",
    "start": "1944600",
    "end": "1951120"
  },
  {
    "text": "Escape key there you go that's all we want right a USB port and Escape key that's",
    "start": "1951120",
    "end": "1958559"
  },
  {
    "text": "that's all we need um all right let's see what",
    "start": "1958559",
    "end": "1965360"
  },
  {
    "text": "happens so I've got two complaints so I restarted so my my IM memory database",
    "start": "1965360",
    "end": "1970960"
  },
  {
    "text": "has been cleared so now we just have an expensive machine and a machine that you need to reboot all the time but it at",
    "start": "1970960",
    "end": "1977320"
  },
  {
    "text": "least it's not that expensive and it has an Escape key right um so pick your",
    "start": "1977320",
    "end": "1984399"
  },
  {
    "text": "battle um now let's have a look at our rabm Q oh wow that's nice and",
    "start": "1984399",
    "end": "1990639"
  },
  {
    "text": "big at least we have a que and there was a little Spike and let's go into the queue and see H we",
    "start": "1990639",
    "end": "1998679"
  },
  {
    "text": "have two ready messages right so there's two messages waiting guess which they are um but of",
    "start": "1998679",
    "end": "2007000"
  },
  {
    "text": "course we don't have an application to to read them uh out of that queue and we could build that in here um but that's",
    "start": "2007000",
    "end": "2014159"
  },
  {
    "text": "not fun so let's not do that let's go back to our spring initializer and create a little application complaints",
    "start": "2014159",
    "end": "2022760"
  },
  {
    "text": "statistics I hate that word statistics there we",
    "start": "2022760",
    "end": "2028919"
  },
  {
    "text": "go no all right",
    "start": "2030039",
    "end": "2038360"
  },
  {
    "text": "demo a come",
    "start": "2040799",
    "end": "2044158"
  },
  {
    "text": "on and we open that",
    "start": "2050000",
    "end": "2053760"
  },
  {
    "text": "project so it's amazing how many Legacy projects you can create in 30 minutes",
    "start": "2060839",
    "end": "2066040"
  },
  {
    "text": "right",
    "start": "2066040",
    "end": "2069040"
  },
  {
    "text": "all right just imagine how many you could create in a training session which",
    "start": "2073879",
    "end": "2079358"
  },
  {
    "text": "could have been tomorrow but um so what what do we do here well we need a component that deals with those events",
    "start": "2079359",
    "end": "2086638"
  },
  {
    "text": "right so we'll have an an event handler here we make it a spring component",
    "start": "2086639",
    "end": "2091679"
  },
  {
    "text": "public uh static class and this is our um statistic",
    "start": "2091679",
    "end": "2098720"
  },
  {
    "text": "updator and let's be really lazy let's make this immediately our rest controller as",
    "start": "2098720",
    "end": "2104480"
  },
  {
    "text": "well we just do everything the whole idea of layers in",
    "start": "2104480",
    "end": "2109920"
  },
  {
    "text": "your application just forget about it right we put everything in in one class",
    "start": "2109920",
    "end": "2115800"
  },
  {
    "text": "what do we care it's Legacy anyway uh our event handler is not here",
    "start": "2115800",
    "end": "2121440"
  },
  {
    "text": "that's because I need to include",
    "start": "2121440",
    "end": "2125838"
  },
  {
    "text": "X on come on help me",
    "start": "2127760",
    "end": "2135599"
  },
  {
    "text": "out and then X on",
    "start": "2139440",
    "end": "2143520"
  },
  {
    "text": "amqp there we go public void on or handle the name of",
    "start": "2147599",
    "end": "2155720"
  },
  {
    "text": "the method doesn't really matter as long as we spef specify the event now we have a little API problem here well problem",
    "start": "2155720",
    "end": "2162160"
  },
  {
    "text": "challenge um of course we need that event object otherwise we can't compile our our code here um and of course we",
    "start": "2162160",
    "end": "2169760"
  },
  {
    "text": "all know and this is very common in uh software projects you just send it over email right okay now normally you would",
    "start": "2169760",
    "end": "2177000"
  },
  {
    "text": "have a jar or something with dependencies or even better um to have a",
    "start": "2177000",
    "end": "2182200"
  },
  {
    "text": "documentation of the structure the serialized form of the events you're going to transport so if you serialize",
    "start": "2182200",
    "end": "2188520"
  },
  {
    "text": "them using uh adjacent serializer for example Jackson you would share how",
    "start": "2188520",
    "end": "2194200"
  },
  {
    "text": "these documents are structured and actually put on an mqp que but since sender and receiver are both axon based",
    "start": "2194200",
    "end": "2201800"
  },
  {
    "text": "uh we might as well use these uh uh these objects and uh these Java",
    "start": "2201800",
    "end": "2207480"
  },
  {
    "text": "objects uh and then we have complaint file EV just make sure they are in the same package if you do that copy paste",
    "start": "2207480",
    "end": "2214400"
  },
  {
    "text": "little thing so if you send an email specify the package that need they need to place the stuff in",
    "start": "2214400",
    "end": "2221680"
  },
  {
    "text": "um all right um now we need to update something let's create a little uh",
    "start": "2221680",
    "end": "2227440"
  },
  {
    "text": "private final concurrent map just because we can and we'll create",
    "start": "2227440",
    "end": "2233720"
  },
  {
    "text": "a map from Atomic from strings to Atomic long which is our statistics",
    "start": "2233720",
    "end": "2241760"
  },
  {
    "text": "statist there you go and now we can say statistics 6. compute if absent for our",
    "start": "2243400",
    "end": "2250720"
  },
  {
    "text": "event. getet company and we create a new Atomic long",
    "start": "2250720",
    "end": "2256280"
  },
  {
    "text": "which we then increment and get and of course we need a get mapping",
    "start": "2256280",
    "end": "2261319"
  },
  {
    "text": "so that we can actually get the statistics out of our elaborate",
    "start": "2261319",
    "end": "2270680"
  },
  {
    "text": "database there you go that's it um so this will allow us to handle that event",
    "start": "2272920",
    "end": "2281040"
  },
  {
    "text": "and we have a get mapping where we can go and and read the statistics but guess",
    "start": "2281040",
    "end": "2286359"
  },
  {
    "text": "what I'm when I start this application axon does not magically know I'm going to um read the messages from that one",
    "start": "2286359",
    "end": "2295119"
  },
  {
    "text": "cue that we've created in mqp and then pass them onto here um so what axon does",
    "start": "2295119",
    "end": "2300920"
  },
  {
    "text": "is it combines event handlers um or at least the classes containing an event",
    "start": "2300920",
    "end": "2307119"
  },
  {
    "text": "handlers in so-called processors and every processor has a source where the events isable process come from um by",
    "start": "2307119",
    "end": "2315280"
  },
  {
    "text": "default the name of the processor is the package name so in this case it would be com. example which is not a very good",
    "start": "2315280",
    "end": "2321160"
  },
  {
    "text": "name because the other project uses the same one as well uh so we can specify a processing group with an explicit name",
    "start": "2321160",
    "end": "2327599"
  },
  {
    "text": "that we want to use and let's call it statistics um so now we have all the",
    "start": "2327599",
    "end": "2334079"
  },
  {
    "text": "event handlers in that method um being deal dealt with in a group called statistics and now we can tell axon the",
    "start": "2334079",
    "end": "2341240"
  },
  {
    "text": "statistics group should receive his messages from a que instead of the default which is the uh event",
    "start": "2341240",
    "end": "2349560"
  },
  {
    "text": "bus now we do that in here and I have a little cheat sheet because I always make",
    "start": "2349560",
    "end": "2355920"
  },
  {
    "text": "typos and we can say the processor actually call statistics",
    "start": "2355920",
    "end": "2361800"
  },
  {
    "text": "here the source of that statistics um",
    "start": "2361800",
    "end": "2367920"
  },
  {
    "text": "processor is and then we specify a well this is actually a b name let's call it",
    "start": "2367920",
    "end": "2373720"
  },
  {
    "text": "statistics statistics Source uh which is a b name",
    "start": "2373720",
    "end": "2379200"
  },
  {
    "text": "which specifies the the source so the default actually here is event bus right but we don't want that in this",
    "start": "2379200",
    "end": "2385520"
  },
  {
    "text": "application so we need to be a to specify that Source uh which is a spring amqp message",
    "start": "2385520",
    "end": "2395560"
  },
  {
    "text": "Source return you bring MP default",
    "start": "2395560",
    "end": "2401800"
  },
  {
    "text": "serializer do some alter wiring we add a parameter yes fine there you go um so we",
    "start": "2401800",
    "end": "2410760"
  },
  {
    "text": "now we specify uh a message source which reads from mqp but this message Source",
    "start": "2410760",
    "end": "2416599"
  },
  {
    "text": "doesn't magically know that we want that que um so we need to specify a um what",
    "start": "2416599",
    "end": "2422280"
  },
  {
    "text": "is it called again simple message listener container something in in Spring um but the reason I hardly",
    "start": "2422280",
    "end": "2429000"
  },
  {
    "text": "remember that name is because you don't really need to use it there's another way there's a little",
    "start": "2429000",
    "end": "2434560"
  },
  {
    "text": "trick you can do we can overwrite this this method in an anonymous class and then just say at rabbit",
    "start": "2434560",
    "end": "2442599"
  },
  {
    "text": "listener Q equals complaint",
    "start": "2442599",
    "end": "2447920"
  },
  {
    "text": "events and what happens now is spring will make sure this method is invoked",
    "start": "2447920",
    "end": "2453480"
  },
  {
    "text": "when a message is received on that Que and then axon will take on because of",
    "start": "2453480",
    "end": "2459400"
  },
  {
    "text": "the super call and make sure that all the processors that are attached to that specific Source will receive the",
    "start": "2459400",
    "end": "2467119"
  },
  {
    "text": "message I was about to start the application but I was I almost forgot to choose a",
    "start": "2467960",
    "end": "2474800"
  },
  {
    "text": "different port because there's the other application running on on",
    "start": "2474800",
    "end": "2480400"
  },
  {
    "text": "80 let's see what happens",
    "start": "2484160",
    "end": "2488720"
  },
  {
    "text": "right well there's no messages",
    "start": "2493000",
    "end": "2497079"
  },
  {
    "text": "anymore ah there you go and we have our uh statistics management happy we are",
    "start": "2499440",
    "end": "2506480"
  },
  {
    "text": "happy um customers aren't happy because they have many more complaints especially about all these",
    "start": "2506480",
    "end": "2513280"
  },
  {
    "text": "USB ports and skap keys missing and in the meantime we see all that stuff stuff",
    "start": "2513280",
    "end": "2521440"
  },
  {
    "text": "changing um so what we've created here is an application that separates well not really because",
    "start": "2521440",
    "end": "2529680"
  },
  {
    "text": "everything is in the same class but at least the um the logic so this is our",
    "start": "2529680",
    "end": "2535119"
  },
  {
    "text": "our business logic right when this thing happens then I want to act on it in this way and then somewhere else we Define",
    "start": "2535119",
    "end": "2542559"
  },
  {
    "text": "okay how do we actually get that event to this virtual machine or to this jvm",
    "start": "2542559",
    "end": "2548440"
  },
  {
    "text": "right um so that's all separate uh uh configuration so we can change all this",
    "start": "2548440",
    "end": "2554400"
  },
  {
    "text": "and we can copy this uh this class into the other application remove our amqp",
    "start": "2554400",
    "end": "2559680"
  },
  {
    "text": "stuff and it will still work in exactly the same way functionally at least technically it will be different because",
    "start": "2559680",
    "end": "2566440"
  },
  {
    "text": "everything runs in the same uh jvm um we could also but I think time is",
    "start": "2566440",
    "end": "2575160"
  },
  {
    "text": "almost running out but we could also include the jrou starter in this application and have two nodes handling",
    "start": "2575160",
    "end": "2582200"
  },
  {
    "text": "the commands and sharing the load between them and again all we need to do is just change a bit of configuration we",
    "start": "2582200",
    "end": "2588240"
  },
  {
    "text": "do not CH need to change any of the uh let's go back to that other project any",
    "start": "2588240",
    "end": "2594000"
  },
  {
    "text": "of the command handling right the logic here for handling how we create a new",
    "start": "2594000",
    "end": "2599680"
  },
  {
    "text": "complaint doesn't change simply because we have uh our application deployed on",
    "start": "2599680",
    "end": "2605280"
  },
  {
    "text": "on more than one uh machine so that concludes my live demo um I'm",
    "start": "2605280",
    "end": "2613319"
  },
  {
    "text": "going to find a place to to host this and then put it online and you okay thank you",
    "start": "2613319",
    "end": "2621000"
  }
]