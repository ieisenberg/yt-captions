[
  {
    "text": "[Music] so my name is Vijay I'm a machine",
    "start": "6990",
    "end": "12809"
  },
  {
    "text": "learning specialist I work for Google hope you're all having a good day today",
    "start": "12809",
    "end": "18150"
  },
  {
    "text": "so far how many people saw the last talk in this room the meaning of life talk",
    "start": "18150",
    "end": "24390"
  },
  {
    "text": "okay good and that's actually a good natural segue into this talk because that talk was kind of the grand the",
    "start": "24390",
    "end": "33000"
  },
  {
    "text": "grand vision of of artificial intelligence some of the big milestones and this talk is going to be very much",
    "start": "33000",
    "end": "39050"
  },
  {
    "text": "practical knowledge if you and the audience want to build a machine learning model how do you do that so",
    "start": "39050",
    "end": "45719"
  },
  {
    "text": "credit to the conference organizers for planning it like that how many people",
    "start": "45719",
    "end": "51809"
  },
  {
    "text": "have built a machine learning model before okay and how many people have",
    "start": "51809",
    "end": "57449"
  },
  {
    "text": "specifically used or at least played around with tensorflow before okay good",
    "start": "57449",
    "end": "63080"
  },
  {
    "text": "so the flow of this talk is going to be",
    "start": "63080",
    "end": "69320"
  },
  {
    "text": "the first 15 minutes or so are gonna be slides and then we're gonna spend the",
    "start": "69320",
    "end": "74670"
  },
  {
    "text": "bulk of the time actually building a machine learning model end to end I'll actually show you the code execute the",
    "start": "74670",
    "end": "81479"
  },
  {
    "text": "code this will be the largest screen that I've ever run live code on so hopefully it doesn't go too badly so",
    "start": "81479",
    "end": "93110"
  },
  {
    "text": "when I say end-to-end machine learning pipeline this is this is what I mean so you start with the raw data set you do",
    "start": "93110",
    "end": "100829"
  },
  {
    "text": "some pre-processing on that data set then you train your model you deploy",
    "start": "100829",
    "end": "106799"
  },
  {
    "text": "that model to some place in this case we're going to deploy it to the cloud and you run some predictions against",
    "start": "106799",
    "end": "112409"
  },
  {
    "text": "that model and specifically the problem that we're going to work on is predicting housing prices so we'll",
    "start": "112409",
    "end": "118619"
  },
  {
    "text": "actually start with the raw CSV file and then go through the whole set of instructions there so before we get into",
    "start": "118619",
    "end": "129420"
  },
  {
    "text": "that just a couple slides about machine learning within Google so most of you probably know that machine learning is",
    "start": "129420",
    "end": "136560"
  },
  {
    "text": "pretty central to what we do as a company we are ultimately a data company and so this is a chart that shows the",
    "start": "136560",
    "end": "144010"
  },
  {
    "text": "growth of machine learning models in production in Google over time so you can see even at Google back in 2012 this",
    "start": "144010",
    "end": "151030"
  },
  {
    "text": "was very new for us and fast forward to today it's we have over 4,000 machine",
    "start": "151030",
    "end": "157989"
  },
  {
    "text": "learning models in production and it's gotten to the point where now within",
    "start": "157989",
    "end": "163840"
  },
  {
    "text": "Google machine learning has become an expected skill set for every developer to have so you don't have a special set",
    "start": "163840",
    "end": "170680"
  },
  {
    "text": "of data scientists over here and then your web developers over here machine",
    "start": "170680",
    "end": "176739"
  },
  {
    "text": "learning knowledge is becoming as common is knowing Java or Python within Google and we offer training courses and",
    "start": "176739",
    "end": "184420"
  },
  {
    "text": "programs for every software engineer within Google to get competency within within this field so these are some of",
    "start": "184420",
    "end": "194980"
  },
  {
    "text": "the products that we use machine learning in it's it's in almost every one of our consumer facing products so",
    "start": "194980",
    "end": "200290"
  },
  {
    "text": "it's a big part of the ranking in our search algorithm using an algorithm called rankbrain Google image search",
    "start": "200290",
    "end": "206500"
  },
  {
    "text": "relies on machine learning Gmail spam classification there's a new feature in",
    "start": "206500",
    "end": "211660"
  },
  {
    "text": "Gmail that some of you may have seen called Smart reply where it actually tries to predict an appropriate response",
    "start": "211660",
    "end": "218440"
  },
  {
    "text": "to your email so you don't have to type it manually which is quite useful so",
    "start": "218440",
    "end": "228840"
  },
  {
    "text": "then when we talk about Google cloud platform that represents the externalization of all of this internal",
    "start": "228840",
    "end": "235870"
  },
  {
    "text": "work we've done on our own products so we have very large research teams in",
    "start": "235870",
    "end": "240959"
  },
  {
    "text": "last year alone we published over 300 research papers in top tier academic",
    "start": "240959",
    "end": "247209"
  },
  {
    "text": "journals about machine learning and what we've done is we've taken some of these",
    "start": "247209",
    "end": "252970"
  },
  {
    "text": "models and made them available to the public so all of that forms falls into",
    "start": "252970",
    "end": "259120"
  },
  {
    "text": "the Google cloud platform umbrella and you can form a division within that on the left side you have your custom",
    "start": "259120",
    "end": "265360"
  },
  {
    "text": "machine learning models and on the right side you have your pre trained machine learning models so most of this talk is",
    "start": "265360",
    "end": "271539"
  },
  {
    "text": "going to be about how do you build a custom machine learning model but I do want to touch just a little bit",
    "start": "271539",
    "end": "277770"
  },
  {
    "text": "on the pre-training machine learning model so you know what they are and how to use them and when you would use them",
    "start": "277770",
    "end": "283160"
  },
  {
    "text": "so these machine learning models typically as a general principle you",
    "start": "283160",
    "end": "288660"
  },
  {
    "text": "always want to start with the simplest solution and add complexity as necessary so there are some problems that you can",
    "start": "288660",
    "end": "296130"
  },
  {
    "text": "solve without building a model at all and if you can do that then that's what you would want to do because there's",
    "start": "296130",
    "end": "301740"
  },
  {
    "text": "much less engineering effort then you don't have to reinvent the wheel and these are all very low barrier to entry",
    "start": "301740",
    "end": "307260"
  },
  {
    "text": "is you can actually trial these you don't even need a Google cloud account you just go to your browser go to the",
    "start": "307260",
    "end": "314690"
  },
  {
    "text": "respective page so this example here is our vision API and you can just drag in",
    "start": "314690",
    "end": "321210"
  },
  {
    "text": "an image and it'll show you exactly what it'll it will return so in this case",
    "start": "321210",
    "end": "331140"
  },
  {
    "text": "it's giving me a bunch of labels about this image with the confidence score for",
    "start": "331140",
    "end": "336720"
  },
  {
    "text": "each one of these so for example it's 85 percent confidence that this is a suspension bridge there's some other",
    "start": "336720",
    "end": "343290"
  },
  {
    "text": "features here there's a landmarks feature that actually recognizes certain landmarks so it knows that this is",
    "start": "343290",
    "end": "348450"
  },
  {
    "text": "specifically the Golden Gate Bridge in San Francisco and it gives me the lat/long coordinates and when you're",
    "start": "348450",
    "end": "355740"
  },
  {
    "text": "calling it over the rest api you'll get your results in this JSON format and you",
    "start": "355740",
    "end": "361860"
  },
  {
    "text": "can integrate it into your application as you see fit",
    "start": "361860",
    "end": "366740"
  },
  {
    "text": "so the best way to think about using these pre-trained api's is as lego",
    "start": "367040",
    "end": "374340"
  },
  {
    "text": "blocks it's very unlikely that a single pre-trained model is gonna solve your",
    "start": "374340",
    "end": "381000"
  },
  {
    "text": "specific problem entirely by itself because by the nature of a pre-trained",
    "start": "381000",
    "end": "387000"
  },
  {
    "text": "model they're trained on google's data it's trying to be a one-size-fits-all",
    "start": "387000",
    "end": "392070"
  },
  {
    "text": "solution so we train on massive data sets but it's very it's a very generalized data set and in your",
    "start": "392070",
    "end": "399330"
  },
  {
    "text": "applications you're working on very specific problems so here's an example of a customer out of",
    "start": "399330",
    "end": "406550"
  },
  {
    "text": "Japan that built a platform to auction off cars and they wanted to add a",
    "start": "406550",
    "end": "412400"
  },
  {
    "text": "functionality where if they uploaded an image of a car they would have an API",
    "start": "412400",
    "end": "418849"
  },
  {
    "text": "that would return certain information about that car so it would tell you what is the make of the car what is the model of the car if it's a specific part of",
    "start": "418849",
    "end": "427189"
  },
  {
    "text": "the car what part of it is is it the tires the steering wheel and also what side of the car are you looking at are",
    "start": "427189",
    "end": "433219"
  },
  {
    "text": "you looking at the front or the left or the right of the car and the reason that this was important is because that's how",
    "start": "433219",
    "end": "439129"
  },
  {
    "text": "they categorized these images for their consumers to look at on the website so before machine learning they had actual",
    "start": "439129",
    "end": "445849"
  },
  {
    "text": "human to go in and tag each of these images and this is the left side of a Ford Focus etc very time-consuming and",
    "start": "445849",
    "end": "453050"
  },
  {
    "text": "they wanted to try to use machine learning to automate that and what they did at first was a common mistake which",
    "start": "453050",
    "end": "460729"
  },
  {
    "text": "is try to build a single model that solves that entire problem that spits out all of the information that they",
    "start": "460729",
    "end": "466759"
  },
  {
    "text": "care about from a single model and they invested some significant engineering effort and eventually gave up because",
    "start": "466759",
    "end": "473870"
  },
  {
    "text": "the model just wasn't giving the results that they needed then they took a step",
    "start": "473870",
    "end": "478909"
  },
  {
    "text": "back and said what if we break this into multiple pieces so they they said first",
    "start": "478909",
    "end": "484849"
  },
  {
    "text": "let's use Google's pre train models and see how far that gives us gets us so",
    "start": "484849",
    "end": "490370"
  },
  {
    "text": "they ran their images through our vision API which is zero engineering work on their part because we've already done",
    "start": "490370",
    "end": "496669"
  },
  {
    "text": "the model and exposed it and they've noticed that's all part of the problem it tells you what is the make of a car",
    "start": "496669",
    "end": "505279"
  },
  {
    "text": "but not what is a specific model and it also can identify what part of a car it",
    "start": "505279",
    "end": "510500"
  },
  {
    "text": "is is this a tire or is this a steering wheel but what it could not do is for",
    "start": "510500",
    "end": "517250"
  },
  {
    "text": "example tell you is the left side or the right side of a car because it just wasn't trained to do that so now when",
    "start": "517250",
    "end": "523010"
  },
  {
    "text": "you narrow the scope of the problem to just that it's actually quite easy to build a custom model that does that",
    "start": "523010",
    "end": "529430"
  },
  {
    "text": "using a framework like tensorflow you get a thousand images of left sides of cars and a thousand images of right",
    "start": "529430",
    "end": "536120"
  },
  {
    "text": "sides of cars different types of cars and you put them through a neural network and you get a pretty robust algorithm that can now tell the",
    "start": "536120",
    "end": "542540"
  },
  {
    "text": "difference between the left and right side of a car and that solves part of the problem so they did this in a piecemeal approach and then aggregated",
    "start": "542540",
    "end": "549889"
  },
  {
    "text": "the information from each of these individual models these small models to solve the total business problem and",
    "start": "549889",
    "end": "556339"
  },
  {
    "text": "they ended up getting where they want it to be but in a much faster and cleaner way so that's really how you should",
    "start": "556339",
    "end": "561949"
  },
  {
    "text": "think about these problems there's a lot of times you can make them modular and a series of smaller simpler models can",
    "start": "561949",
    "end": "568579"
  },
  {
    "text": "aggregate to solve what you're trying to solve okay so that's it for pre-trained",
    "start": "568579",
    "end": "574249"
  },
  {
    "text": "models now let's say you do need to build a custom machine learning model",
    "start": "574249",
    "end": "579829"
  },
  {
    "text": "you have narrow the scope of it as much as possible to use things that were already built so you're not reinventing",
    "start": "579829",
    "end": "585829"
  },
  {
    "text": "the wheel but usually there's at least some part that you have to build custom and when I say custom that means you're",
    "start": "585829",
    "end": "591859"
  },
  {
    "text": "training on your own data you're writing your own code and the framework that we",
    "start": "591859",
    "end": "598009"
  },
  {
    "text": "at Google internally used for this type of thing is called tension flow so tensor flow is something that probably",
    "start": "598009",
    "end": "605540"
  },
  {
    "text": "most of you have heard of it seemed like about a quarter to a third of the room",
    "start": "605540",
    "end": "610879"
  },
  {
    "text": "has actually already used so first of all what is tensor flow tensor flow is a",
    "start": "610879",
    "end": "616759"
  },
  {
    "text": "machine learning learning framework it was open source by Google in November of",
    "start": "616759",
    "end": "622669"
  },
  {
    "text": "2015 and since it has been open source",
    "start": "622669",
    "end": "627949"
  },
  {
    "text": "it's become the most popular machine learning framework and I'll talk about some reasons to why it may have become",
    "start": "627949",
    "end": "634160"
  },
  {
    "text": "so popular so one is it's worth",
    "start": "634160",
    "end": "640249"
  },
  {
    "text": "mentioning that the popularity of tensorflow itself is a big reason to use it because with popularity becomes",
    "start": "640249",
    "end": "648019"
  },
  {
    "text": "developer ecosystem so if you're working on a problem chances are someone has",
    "start": "648019",
    "end": "653899"
  },
  {
    "text": "already solved a problem similar to it using tensor flow and you could do a search and you'll find a blog post if",
    "start": "653899",
    "end": "659689"
  },
  {
    "text": "not a official tensor flow tutorial showing you a code template and you can use that to bootstrap your own project",
    "start": "659689",
    "end": "666499"
  },
  {
    "text": "from so that's a very valuable and the second thing there is if you get stuck or you run into a bug",
    "start": "666499",
    "end": "672640"
  },
  {
    "text": "when you post it on to something like Stack Overflow because there's such a large community around it you're",
    "start": "672640",
    "end": "678130"
  },
  {
    "text": "typically going to get a response faster than if you're using a lesser used",
    "start": "678130",
    "end": "683770"
  },
  {
    "text": "framework so the popularity itself is a big asset at this point another reason",
    "start": "683770",
    "end": "693190"
  },
  {
    "text": "that tensorflow is popular is this idea that you can program it at various levels of abstraction so if you don't",
    "start": "693190",
    "end": "703000"
  },
  {
    "text": "need a lot of control over your algorithm if you're not a researcher that's that's tweaking your algorithm",
    "start": "703000",
    "end": "710770"
  },
  {
    "text": "down to a very fine level of granularity then you can abstract yourself away from that using a higher-level API like",
    "start": "710770",
    "end": "717730"
  },
  {
    "text": "Kerris which some of you may have heard of or like the estimator API which is",
    "start": "717730",
    "end": "723460"
  },
  {
    "text": "actually the code that I'll be showing later on in the talk and this allows you to do things like just use a quote",
    "start": "723460",
    "end": "731320"
  },
  {
    "text": "unquote canned model that's pre implemented for you it already has the training loop built in already has the",
    "start": "731320",
    "end": "736870"
  },
  {
    "text": "evaluation loop built in and with just a couple lines of code you call that and",
    "start": "736870",
    "end": "742120"
  },
  {
    "text": "it saves you a lot of work but if you do need additional flexibility you can drop down a level in the hierarchy to these",
    "start": "742120",
    "end": "749260"
  },
  {
    "text": "lower levels ultimately down to the the base vanilla tensorflow level where",
    "start": "749260",
    "end": "756550"
  },
  {
    "text": "you're explicitly defining your matrices and doing your matrix multiplications at that point another reason to enter flow",
    "start": "756550",
    "end": "769810"
  },
  {
    "text": "is popular is because it's production-ready so the reason Google created tensorflow",
    "start": "769810",
    "end": "775390"
  },
  {
    "text": "in the first place is because historically the deep learning frameworks that existed at the time all",
    "start": "775390",
    "end": "783550"
  },
  {
    "text": "came out of academic institutions so MX net came out of Carnegie Mellon dno came",
    "start": "783550",
    "end": "791380"
  },
  {
    "text": "out of the University of Montreal Cafe came out of the University of Berkeley and if you think of the needs of an",
    "start": "791380",
    "end": "797410"
  },
  {
    "text": "academic researcher is very different from the needs of someone who's in industry so a researcher their motivation is",
    "start": "797410",
    "end": "804779"
  },
  {
    "text": "essentially to prototype something so that they can prove out a theory publish",
    "start": "804779",
    "end": "809910"
  },
  {
    "text": "that theory in a academic journal and then move on to something else so there's no real thought about how do i",
    "start": "809910",
    "end": "816510"
  },
  {
    "text": "scale this model how many users are going to hit it what are my security",
    "start": "816510",
    "end": "821640"
  },
  {
    "text": "considerations and things like that so when Google start got into this machine learning space knowing that everything",
    "start": "821640",
    "end": "829470"
  },
  {
    "text": "they built was going to be used by millions of users they had to create a tool to solve this problem that didn't",
    "start": "829470",
    "end": "835770"
  },
  {
    "text": "exist before so all of these things like serving in latency are first class",
    "start": "835770",
    "end": "841620"
  },
  {
    "text": "citizens and tensorflow and they're built into the tool so it's very performant and you can also deploy",
    "start": "841620",
    "end": "849149"
  },
  {
    "text": "it across different types of hardware so you write your code once and then you can deploy it on a CPU or GPU or on a",
    "start": "849149",
    "end": "856410"
  },
  {
    "text": "mobile phone Android or iOS or even on embedded devices like Raspberry Pi and",
    "start": "856410",
    "end": "864480"
  },
  {
    "text": "of course algorithms so the main reason that you use a machine learning framework is so that you don't have to",
    "start": "864480",
    "end": "870060"
  },
  {
    "text": "re-implement algorithms that are already well established and well proven in industry so this is an example of the",
    "start": "870060",
    "end": "877320"
  },
  {
    "text": "tensor flow object detection API it is a algorithm that identifies labels",
    "start": "877320",
    "end": "886350"
  },
  {
    "text": "in an image and not only does that but it draws bounding boxes around those labels so this is a much harder problem",
    "start": "886350",
    "end": "892860"
  },
  {
    "text": "than the the original type of computer vision problem which was image classification that would tell me that",
    "start": "892860",
    "end": "899700"
  },
  {
    "text": "there's a kite in the image somewhere but it wouldn't tell me where within the image that kite was or it wouldn't tell",
    "start": "899700",
    "end": "905250"
  },
  {
    "text": "me how many kites are in that image so this is a algorithm that came out of",
    "start": "905250",
    "end": "910260"
  },
  {
    "text": "Google research and then we open sourced the results of this via tensor flow so",
    "start": "910260",
    "end": "916020"
  },
  {
    "text": "now you can actually leverage this algorithm with a few lines of code and if you just do a Google search for ten",
    "start": "916020",
    "end": "923550"
  },
  {
    "text": "to flow object detection API you'll see a blog post that tells you how to do that",
    "start": "923550",
    "end": "929390"
  },
  {
    "text": "and here is another example this this",
    "start": "933620",
    "end": "938670"
  },
  {
    "text": "idea of a wide and deep algorithm is no longer really considered state-of-the-art but when it came out",
    "start": "938670",
    "end": "944279"
  },
  {
    "text": "tensorflow was the phrase first popular framework to kind of distribute this or",
    "start": "944279",
    "end": "950430"
  },
  {
    "text": "democratize this type of modeling to the quote unquote common man so the idea of",
    "start": "950430",
    "end": "956910"
  },
  {
    "text": "widened deep models is you have this thing called deep learning which works",
    "start": "956910",
    "end": "962820"
  },
  {
    "text": "very well for dense datasets and you have linear models which work very well",
    "start": "962820",
    "end": "968699"
  },
  {
    "text": "for sparse data sets and the idea is quite simple which is what if we combine",
    "start": "968699",
    "end": "975180"
  },
  {
    "text": "the best of both worlds and have the the deep model work on the dense features",
    "start": "975180",
    "end": "981720"
  },
  {
    "text": "and the wide model work on the sparse features and then combine the results at",
    "start": "981720",
    "end": "987690"
  },
  {
    "text": "the end that's called widened deep learning and that was another example of an algorithm that tensorflow really",
    "start": "987690",
    "end": "994260"
  },
  {
    "text": "brought to the general public",
    "start": "994260",
    "end": "997550"
  },
  {
    "text": "speed so of course when you're thinking about deploying something for production especially if it's going to power a",
    "start": "999529",
    "end": "1005899"
  },
  {
    "text": "website or you you have some real time need for it then performance becomes",
    "start": "1005899",
    "end": "1012170"
  },
  {
    "text": "very important so tints flow is very transparent about its benchmarks on",
    "start": "1012170",
    "end": "1017300"
  },
  {
    "text": "different problems how it scales horizontally and you can go to tensorflow dot org slash performance",
    "start": "1017300",
    "end": "1022670"
  },
  {
    "text": "benchmarks and just see the tests we've run and see exactly what our performances and how it compares and",
    "start": "1022670",
    "end": "1030438"
  },
  {
    "text": "then the last thing I'll say about tension flow is the reason why it can you have this trade-off of it both being",
    "start": "1030439",
    "end": "1036530"
  },
  {
    "text": "developer friendly written in a language like Python which is considered developer friendly but traditionally",
    "start": "1036530",
    "end": "1042500"
  },
  {
    "text": "considered slow but also very performant is because the output of your tensorflow",
    "start": "1042500",
    "end": "1051010"
  },
  {
    "text": "Python code is a what we call a data flow graph which is looks like this and",
    "start": "1051010",
    "end": "1057799"
  },
  {
    "text": "this is actually visualized using a tool called tension board which I'll also demo and that graph is just",
    "start": "1057799",
    "end": "1064160"
  },
  {
    "text": "series of instructions that is then interpreted by a C++ back end and the C++ back and takes care of how do I",
    "start": "1064160",
    "end": "1071300"
  },
  {
    "text": "compile this code in a very fast way and specific to the type of hardware that",
    "start": "1071300",
    "end": "1076430"
  },
  {
    "text": "I'm instructed to run on whether that's a CPU or GPU for example",
    "start": "1076430",
    "end": "1081940"
  },
  {
    "text": "so that's tensorflow is a framework why you would want to use that for your custom machine learning modeling and",
    "start": "1082180",
    "end": "1088370"
  },
  {
    "text": "then why Google Cloud machine learning engine so basically why would you do",
    "start": "1088370",
    "end": "1093830"
  },
  {
    "text": "this in the cloud so the first thing to state here is a lot of times you don't",
    "start": "1093830",
    "end": "1099110"
  },
  {
    "text": "need to do it in the cloud as a rule of thumb if you can train your model in under an hour on your local laptop just",
    "start": "1099110",
    "end": "1108200"
  },
  {
    "text": "stick on your local laptop but at some point if you're using large enough data",
    "start": "1108200",
    "end": "1113930"
  },
  {
    "text": "sets or you're using complex enough algorithms you're going to hit that bottleneck where the training time on",
    "start": "1113930",
    "end": "1119930"
  },
  {
    "text": "your computer your computer hour essentially becomes your bottleneck to creativity and development and it'll",
    "start": "1119930",
    "end": "1125690"
  },
  {
    "text": "stop you from trying different ideas or it'll stop a problem from being tractable altogether and that's when you",
    "start": "1125690",
    "end": "1130940"
  },
  {
    "text": "want to make the jump to cloud computing because essentially then you have access to a supercomputer over over an internet",
    "start": "1130940",
    "end": "1137720"
  },
  {
    "text": "connection and the tool I'll actually be using today is called Google Cloud",
    "start": "1137720",
    "end": "1143150"
  },
  {
    "text": "machine learning engine which is a managed tensorflow service and it gives",
    "start": "1143150",
    "end": "1148280"
  },
  {
    "text": "you some nice things for example it makes horizontal scaling very easy you",
    "start": "1148280",
    "end": "1153980"
  },
  {
    "text": "just specify I want to run this across ten GPUs and Google will take care of spinning up the infrastructure for you",
    "start": "1153980",
    "end": "1160190"
  },
  {
    "text": "provisioning the virtual machines and then spinning them down when your job is done it has an automatic hyper parameter",
    "start": "1160190",
    "end": "1166970"
  },
  {
    "text": "tuning function automatic monitoring logging versioning built-in auto scaling",
    "start": "1166970",
    "end": "1173420"
  },
  {
    "text": "prediction service and coming soon you'll have access to tensor processing",
    "start": "1173420",
    "end": "1180200"
  },
  {
    "text": "units which I'll talk about on the next slide and there's no lock-in so because tensorflow is an open source",
    "start": "1180200",
    "end": "1186050"
  },
  {
    "text": "framework once you train your model even if you use our product as your supercomputer to give you the horsepower",
    "start": "1186050",
    "end": "1193040"
  },
  {
    "text": "to complete that training in a reasonable amount of time the result of that is an open source so you can download that model you can",
    "start": "1193040",
    "end": "1199549"
  },
  {
    "text": "deploy it on a phone you can deploy it on premise you can deploy it anywhere you want to and the reverse is true as",
    "start": "1199549",
    "end": "1206480"
  },
  {
    "text": "well you can train your tension flow model on your local laptop but you can deploy it to our cloud just for the",
    "start": "1206480",
    "end": "1211850"
  },
  {
    "text": "prediction service because maybe you're expecting hundreds of thousands prediction predictions per second and",
    "start": "1211850",
    "end": "1219020"
  },
  {
    "text": "you don't want to build it up your own infrastructure to handle that so you can train on premise and deploy for",
    "start": "1219020",
    "end": "1224179"
  },
  {
    "text": "prediction in the cloud as well tensor processing unit for those of you",
    "start": "1224179",
    "end": "1229400"
  },
  {
    "text": "who haven't heard of this this was the hardware that powered the the artificial",
    "start": "1229400",
    "end": "1236690"
  },
  {
    "text": "intelligence that defeated the go champion if you heard of that it also powers Google Translate and a bunch of",
    "start": "1236690",
    "end": "1243380"
  },
  {
    "text": "other internal applications and we've now made this available to the to the",
    "start": "1243380",
    "end": "1249649"
  },
  {
    "text": "public in alpha at this point and just a hardware comparison to give you kind of",
    "start": "1249649",
    "end": "1255470"
  },
  {
    "text": "a scale of how powerful these things are a tensor processing unit can process 180",
    "start": "1255470",
    "end": "1262580"
  },
  {
    "text": "trillion floating-point operations per second an Nvidia K 80 Tesla kad GPU",
    "start": "1262580",
    "end": "1269649"
  },
  {
    "text": "which is kind of the de facto cloud GPU at this point is nine teraflops so this",
    "start": "1269649",
    "end": "1278899"
  },
  {
    "text": "becomes actually more important for inference than training because in training can always just scale horizontally so you could use 20 Nvidia",
    "start": "1278899",
    "end": "1287149"
  },
  {
    "text": "K ATS and you'd get a similar speed to using a single TP you you just have to do the price performance calculation but",
    "start": "1287149",
    "end": "1294470"
  },
  {
    "text": "when it comes to inference also in those prediction time and you need to get that result back within milliseconds the",
    "start": "1294470",
    "end": "1301010"
  },
  {
    "text": "overhead of horizontal computing actually it becomes more will take you",
    "start": "1301010",
    "end": "1308600"
  },
  {
    "text": "out of your real time requirement so at that point vertical scaling on a single chip becomes important and that's when",
    "start": "1308600",
    "end": "1314630"
  },
  {
    "text": "these advanced chips like TPS becomes more important okay so on to the actual",
    "start": "1314630",
    "end": "1321830"
  },
  {
    "text": "problem that we're gonna build an antenna solution for so what we're gonna do is predict housing sale prices and so",
    "start": "1321830",
    "end": "1329630"
  },
  {
    "text": "I'm gonna start by asking you at the audience to make a prediction on a simple data set so my",
    "start": "1329630",
    "end": "1335330"
  },
  {
    "text": "dataset is a 1,000 square foot house sells for $100,000 a 3,000 square-foot",
    "start": "1335330",
    "end": "1341420"
  },
  {
    "text": "house sells for $300,000 and my question for you and you can just yell it out is",
    "start": "1341420",
    "end": "1346880"
  },
  {
    "text": "how much would a 2000 square-foot house all for two hundred thousand but it's",
    "start": "1346880",
    "end": "1353570"
  },
  {
    "text": "pretty easy right so let's make it a",
    "start": "1353570",
    "end": "1359240"
  },
  {
    "text": "little bit more complicated let's add two more features to my data set so in addition to just square footage of a",
    "start": "1359240",
    "end": "1365570"
  },
  {
    "text": "house I'm gonna predict the housing price based off of what is the crime rate in the area and also how good are",
    "start": "1365570",
    "end": "1371750"
  },
  {
    "text": "the schools in the area so now I'm just",
    "start": "1371750",
    "end": "1376970"
  },
  {
    "text": "gonna let you read this slide and the question is how much would a three thousand square foot house with a crime",
    "start": "1376970",
    "end": "1382670"
  },
  {
    "text": "rate of 30 and a school rating of two cost any brave souls won't answer yeah",
    "start": "1382670",
    "end": "1392000"
  },
  {
    "text": "it's not so easy now and that's just with three features so imagine if you",
    "start": "1392000",
    "end": "1397910"
  },
  {
    "text": "had a hundred features and imagine if you had millions of rows this is where",
    "start": "1397910",
    "end": "1403700"
  },
  {
    "text": "you now need to use a machine learning to make this type of prediction so this is the problem that we're going to be working on so in order to solve this and",
    "start": "1403700",
    "end": "1417470"
  },
  {
    "text": "actually by the way if you want to recreate this lab after the after this",
    "start": "1417470",
    "end": "1425480"
  },
  {
    "text": "talk this is the short link to some documentation on how to do that so you can snap a picture of this also you'll",
    "start": "1425480",
    "end": "1433160"
  },
  {
    "text": "have access to the slides after the through the conference website",
    "start": "1433160",
    "end": "1438070"
  },
  {
    "text": "okay so to do to actually do our development we're going to use a tool",
    "start": "1442600",
    "end": "1448190"
  },
  {
    "text": "called data lab so data lab is basically",
    "start": "1448190",
    "end": "1453710"
  },
  {
    "text": "a white labeled version of Jupiter or ipython notebooks how many people have",
    "start": "1453710",
    "end": "1459230"
  },
  {
    "text": "used Jupiter or ipython notebooks okay so - it's a good way to combine your",
    "start": "1459230",
    "end": "1465530"
  },
  {
    "text": "code with documentation in a way that's kind of digestible and easy to share and collaborate so within this notebook I'm",
    "start": "1465530",
    "end": "1475510"
  },
  {
    "text": "starting by just importing the frameworks that I need to use so in this case I'm using pandas which is a",
    "start": "1475510",
    "end": "1483260"
  },
  {
    "text": "framework that enables me to deal with the CSV data that I'm gonna use easily and parse it and then of course",
    "start": "1483260",
    "end": "1489770"
  },
  {
    "text": "tensorflow so I'll just execute those two cells and it's always a good idea to",
    "start": "1489770",
    "end": "1495320"
  },
  {
    "text": "know what version of tension flow that you're dealing with so you can debug any version conflict issues so I'm using",
    "start": "1495320",
    "end": "1502370"
  },
  {
    "text": "test foal 1.2 and we talked a little bit about this idea of tons of flow api's",
    "start": "1502370",
    "end": "1508340"
  },
  {
    "text": "and the hierarchy so in this case I'm gonna be programming at these top two",
    "start": "1508340",
    "end": "1515570"
  },
  {
    "text": "levels the experiment and estimators API and the main reason I'm gonna do this is",
    "start": "1515570",
    "end": "1521470"
  },
  {
    "text": "one it makes for less lines of code but the other reason is it gives me",
    "start": "1521470",
    "end": "1526730"
  },
  {
    "text": "distributed computing for free so as long as I stick to these higher-level api's then the then it doesn't tend to",
    "start": "1526730",
    "end": "1535280"
  },
  {
    "text": "float just understands how to run on ten GPUs versus one GPU and I don't have to make any code changes which if you've",
    "start": "1535280",
    "end": "1543050"
  },
  {
    "text": "tried to do distributed computing across multiple CPUs or GPUs manually before you'll know this is a big time saver it",
    "start": "1543050",
    "end": "1550160"
  },
  {
    "text": "saves you a lot of headache and so the actual steps that we're going to go",
    "start": "1550160",
    "end": "1555530"
  },
  {
    "text": "through in this notebook are one we're going to load in our raw data we're gonna write our tensorflow code and",
    "start": "1555530",
    "end": "1561710"
  },
  {
    "text": "that's gonna have some steps broken down which I'll explain then we're going to package that code up so that we can",
    "start": "1561710",
    "end": "1567320"
  },
  {
    "text": "train it in the cloud we're going to inspect the results of that training using tensorflow to make sure that we're",
    "start": "1567320",
    "end": "1573590"
  },
  {
    "text": "happy with our with our accuracy once we're happy with their accuracy we're going to deploy",
    "start": "1573590",
    "end": "1580040"
  },
  {
    "text": "that model to the cloud so that we can have a third party make predictions",
    "start": "1580040",
    "end": "1585260"
  },
  {
    "text": "against that model over the internet so we'll start here by loading our raw data",
    "start": "1585260",
    "end": "1592040"
  },
  {
    "text": "and I'm using just a publicly available data set about Boston area suburbs circa",
    "start": "1592040",
    "end": "1598400"
  },
  {
    "text": "1978 and it's hosted in a Google Cloud Storage bucket so this code here is just",
    "start": "1598400",
    "end": "1605060"
  },
  {
    "text": "downloading that CSV file from the Google Cloud storage into a couple of",
    "start": "1605060",
    "end": "1610190"
  },
  {
    "text": "Python variables and memory and here I'm just going to print out the first few",
    "start": "1610190",
    "end": "1616940"
  },
  {
    "text": "rows of that data so you can see what it what it actually looks like and this may",
    "start": "1616940",
    "end": "1628700"
  },
  {
    "text": "be the first live coding stall here so bear with me",
    "start": "1628700",
    "end": "1634090"
  },
  {
    "text": "just going to refresh this here",
    "start": "1650720",
    "end": "1654460"
  },
  {
    "text": "so this is running off of a virtual machine in the cloud and that virtual",
    "start": "1668460",
    "end": "1676600"
  },
  {
    "text": "machine lost lost his connection probably because I was doing the slides for too long without refreshing this so",
    "start": "1676600",
    "end": "1682600"
  },
  {
    "text": "I'm just reconnecting here",
    "start": "1682600",
    "end": "1685559"
  },
  {
    "text": "and while this is coming up what I can do is skip to the the second step here",
    "start": "1713259",
    "end": "1720710"
  },
  {
    "text": "is once you have your raw data loaded so in this case a CSV file the next step",
    "start": "1720710",
    "end": "1727519"
  },
  {
    "text": "that you want to do is a data scientist just explore that data understand first of all is my data clean",
    "start": "1727519",
    "end": "1734480"
  },
  {
    "text": "do I have outliers just do a sanity check that the data makes sense and then",
    "start": "1734480",
    "end": "1739700"
  },
  {
    "text": "second of all do any transformations that I need to do so so this is a tool called Google Cloud Data prep and it's",
    "start": "1739700",
    "end": "1748669"
  },
  {
    "text": "nice because right off the bat when you upload a CSV file it already builds these histograms of all your fields for",
    "start": "1748669",
    "end": "1754999"
  },
  {
    "text": "you so for example I can see that the",
    "start": "1754999",
    "end": "1760639"
  },
  {
    "text": "field here the age of the house the range is between 3 and 100 years old",
    "start": "1760639",
    "end": "1767480"
  },
  {
    "text": "that's how old these houses are and it's more concentrated towards the upper end so I have more houses that are old",
    "start": "1767480",
    "end": "1774769"
  },
  {
    "text": "closer to the hundred years old then that are brand new houses and then if I click Edit and then column details I can",
    "start": "1774769",
    "end": "1783889"
  },
  {
    "text": "get my basic statistics about that particular column my main median",
    "start": "1783889",
    "end": "1789019"
  },
  {
    "text": "standard deviation and my quartiles and things like that and let's say that I",
    "start": "1789019",
    "end": "1795409"
  },
  {
    "text": "want to do some manipulation on this data then I can just choose a",
    "start": "1795409",
    "end": "1801019"
  },
  {
    "text": "transformation here and there's different things I can do I can do aggregation I can flatten I can join I can pivot I",
    "start": "1801019",
    "end": "1809899"
  },
  {
    "text": "can do windowing so a lot of your basic data manipulation here you can do",
    "start": "1809899",
    "end": "1815960"
  },
  {
    "text": "through this graphical tool and the nice thing about this is the output of this",
    "start": "1815960",
    "end": "1821179"
  },
  {
    "text": "tool is a data flow pipeline and data flow is an implementation of Apache beam",
    "start": "1821179",
    "end": "1828259"
  },
  {
    "text": "which is designed to work on large out of memory data sets",
    "start": "1828259",
    "end": "1834190"
  },
  {
    "text": "so let's say that you know I've looked",
    "start": "1836890",
    "end": "1844070"
  },
  {
    "text": "at my data I'm happy with the transformations then at this point what I would do is I would just export this",
    "start": "1844070",
    "end": "1850400"
  },
  {
    "text": "data to a data flow job that would run the transformations and then I could",
    "start": "1850400",
    "end": "1855740"
  },
  {
    "text": "then pick back up with that data back get back in tensor flow and of course",
    "start": "1855740",
    "end": "1870110"
  },
  {
    "text": "this had to happen as I was doing the live demo",
    "start": "1870110",
    "end": "1875020"
  },
  {
    "text": "so it's provisioning the Google cloud shell machine which is how I connect to the data lab instance Google cloud shell",
    "start": "1883080",
    "end": "1894119"
  },
  {
    "text": "is actually a free service so sometimes if there's a lot of demand in a particular region you have to wait a",
    "start": "1894119",
    "end": "1899789"
  },
  {
    "text": "little bit to get a machine",
    "start": "1899789",
    "end": "1902868"
  },
  {
    "text": "so what I can do is hopefully that will",
    "start": "1911899",
    "end": "1917610"
  },
  {
    "text": "come up or actually it may just be that my internet connection in general is not working right now yeah I think that's",
    "start": "1917610",
    "end": "1931049"
  },
  {
    "text": "what it is",
    "start": "1931049",
    "end": "1933350"
  },
  {
    "text": "okay there we go so one of the things",
    "start": "1939710",
    "end": "1945440"
  },
  {
    "text": "about working in the cloud is you actually need an internet connection for it to work okay so let me spin this back",
    "start": "1945440",
    "end": "1953990"
  },
  {
    "text": "up now there we go",
    "start": "1953990",
    "end": "1960440"
  },
  {
    "text": "and I'm going to connect back into that instance okay we'll give that a second",
    "start": "1960440",
    "end": "1971240"
  },
  {
    "text": "and while that's loading up I'm going to continue on in the github repository",
    "start": "1971240",
    "end": "1977990"
  },
  {
    "text": "here so now that I've done I've loaded",
    "start": "1977990",
    "end": "1985310"
  },
  {
    "text": "my raw data I've explored it I'm happy with what it looks like now I can actually start writing my tensorflow",
    "start": "1985310",
    "end": "1991130"
  },
  {
    "text": "code so to write my attention flow code there's about four or five steps I need",
    "start": "1991130",
    "end": "1997220"
  },
  {
    "text": "to do so the first thing I need to do is define my data interface I need to tell",
    "start": "1997220",
    "end": "2003430"
  },
  {
    "text": "tensorflow how to interpret the different columns within my data set so",
    "start": "2003430",
    "end": "2009210"
  },
  {
    "text": "there's certain there's different column types you have continuous data you have",
    "start": "2009210",
    "end": "2015610"
  },
  {
    "text": "categorical data so price for example is an example of a continuous variable it",
    "start": "2015610",
    "end": "2021850"
  },
  {
    "text": "can take any real value department in a university for example would be an",
    "start": "2021850",
    "end": "2027610"
  },
  {
    "text": "example of a categorical value so it could be one of a discrete set of things math or English or psychology etc and",
    "start": "2027610",
    "end": "2036250"
  },
  {
    "text": "each of these features are optimized in a different way by machine learning",
    "start": "2036250",
    "end": "2043000"
  },
  {
    "text": "algorithms so you have to inform the algorithm what type of what type of data",
    "start": "2043000",
    "end": "2048159"
  },
  {
    "text": "this is and in my particular data set it's pretty easy because all of my all",
    "start": "2048160",
    "end": "2055419"
  },
  {
    "text": "of my code is all my features are numerical real value numbers so they're",
    "start": "2055420",
    "end": "2061060"
  },
  {
    "text": "all going to be categorical features",
    "start": "2061060",
    "end": "2064980"
  },
  {
    "text": "so here basically I just have a for loop going through the features that I'm going to use for this and telling you to",
    "start": "2067800",
    "end": "2076419"
  },
  {
    "text": "treat them all as real valued columns so that's my data interface now the next",
    "start": "2076420",
    "end": "2083139"
  },
  {
    "text": "thing that I need to do is pick out my actual estimator so my estimator is what",
    "start": "2083140",
    "end": "2091450"
  },
  {
    "text": "you could think of is your canned model",
    "start": "2091450",
    "end": "2096570"
  },
  {
    "text": "and in this case I'm going to use a neural network deep neural network and",
    "start": "2096870",
    "end": "2104020"
  },
  {
    "text": "the reason that I'm using that is because the relationship between my input features and the actual selling",
    "start": "2104020",
    "end": "2111130"
  },
  {
    "text": "price of a house is nonlinear so I'm not going to have a lot of success if I use",
    "start": "2111130",
    "end": "2116710"
  },
  {
    "text": "something like logistic regression where as deep learning and deep learning the",
    "start": "2116710",
    "end": "2122530"
  },
  {
    "text": "most common definition of deep learning is just a neural network with two or more hidden layers it's good for",
    "start": "2122530",
    "end": "2128020"
  },
  {
    "text": "modeling that type of relationship so my",
    "start": "2128020",
    "end": "2133270"
  },
  {
    "text": "code for for defining a neural network",
    "start": "2133270",
    "end": "2139390"
  },
  {
    "text": "is just this cell here and I'm specifying that I want two hidden layers",
    "start": "2139390",
    "end": "2144520"
  },
  {
    "text": "each with 210 neurons in each layer so 10 neurons in the first layer and 10 euros in the second layer and that's all",
    "start": "2144520",
    "end": "2152350"
  },
  {
    "text": "I have to do to define that and I'm passing in my feature definition from",
    "start": "2152350",
    "end": "2157660"
  },
  {
    "text": "the previous cell so it knows how to interpret that data so just take a second to appreciate that that I could",
    "start": "2157660",
    "end": "2165700"
  },
  {
    "text": "do that with just a few lines of code defining a neural network is typically something that's pretty involved to do so that's the advantage of dealing at",
    "start": "2165700",
    "end": "2172750"
  },
  {
    "text": "this higher level of abstraction so then I'm going to define my input function so",
    "start": "2172750",
    "end": "2180910"
  },
  {
    "text": "at this point I've just specified a data",
    "start": "2180910",
    "end": "2186370"
  },
  {
    "text": "API if you will but I haven't actually passed the data in so this data is actually reading from that that pandas",
    "start": "2186370",
    "end": "2195250"
  },
  {
    "text": "variable that I created earlier which if you remember just pull that CSV down from Google Cloud Storage and stored",
    "start": "2195250",
    "end": "2201359"
  },
  {
    "text": "in memory and I'm saying that that's where my features exist and my label",
    "start": "2201359",
    "end": "2207359"
  },
  {
    "text": "which is what I'm trying to predict is going to be the the feature that I've",
    "start": "2207359",
    "end": "2216509"
  },
  {
    "text": "identified as label which I did earlier on here which is median value which is actually a sales price so I've got my",
    "start": "2216509",
    "end": "2223049"
  },
  {
    "text": "features and my labels and I'm passing those is my input function and then you",
    "start": "2223049",
    "end": "2228420"
  },
  {
    "text": "have a separate input function for serving so serving is just a synonym for prediction or for inference so at the",
    "start": "2228420",
    "end": "2236220"
  },
  {
    "text": "time when I have a user a third party user using my prediction service they",
    "start": "2236220",
    "end": "2241380"
  },
  {
    "text": "may pass in data in a slightly different way than how I trained on so that's why I'm allowed to define a separate serving",
    "start": "2241380",
    "end": "2247950"
  },
  {
    "text": "input function which I do here and I actually am NOT going to pass it in any",
    "start": "2247950",
    "end": "2254339"
  },
  {
    "text": "differently so the first part of the code is is the same and then there's just some boilerplate code here that you",
    "start": "2254339",
    "end": "2259680"
  },
  {
    "text": "don't modify and the last step is I'm gonna package all of this into what's",
    "start": "2259680",
    "end": "2266130"
  },
  {
    "text": "called an experiment and an experiment is what allows me to actually do this",
    "start": "2266130",
    "end": "2271890"
  },
  {
    "text": "distributed training without having to write any additional code and it's just a wrapper so I'm just passing in",
    "start": "2271890",
    "end": "2278130"
  },
  {
    "text": "pointers to all of these previous cells that I've defined it so my input",
    "start": "2278130",
    "end": "2283440"
  },
  {
    "text": "function my estimator and then I am",
    "start": "2283440",
    "end": "2289069"
  },
  {
    "text": "specifying that I want to train this for 3,000 steps and then at the end I want to do an evaluation step to see how how",
    "start": "2289069",
    "end": "2296849"
  },
  {
    "text": "good this model is performing against my evaluation data so that's all the",
    "start": "2296849",
    "end": "2305130"
  },
  {
    "text": "tension flow code and so my code is now written and in order to train this on",
    "start": "2305130",
    "end": "2310319"
  },
  {
    "text": "the cloud I need to package this as a typical Python file so here I'm just",
    "start": "2310319",
    "end": "2320390"
  },
  {
    "text": "taking all these individual cells and pasting them into a single cell the code",
    "start": "2320390",
    "end": "2325470"
  },
  {
    "text": "hasn't changed and then at the end here",
    "start": "2325470",
    "end": "2330779"
  },
  {
    "text": "there's some boilerplate code that you would just copy and paste that tells up tells this program how to parse",
    "start": "2330779",
    "end": "2338400"
  },
  {
    "text": "certain command-line arguments that the Google Cloud ml engine xmx so at this",
    "start": "2338400",
    "end": "2344190"
  },
  {
    "text": "point I can actually train and I'm gonna train both locally and in the cloud so you can see how both of those work",
    "start": "2344190",
    "end": "2350960"
  },
  {
    "text": "there's a couple cloud variables that I'm defining here so this is the address",
    "start": "2350960",
    "end": "2356250"
  },
  {
    "text": "of my Google Cloud Storage bucket that I want my model to be written to this is the name of my Google Cloud a project",
    "start": "2356250",
    "end": "2363089"
  },
  {
    "text": "and this is the geographical region that I want my virtual machines to be spun upon and I'm just setting those as",
    "start": "2363089",
    "end": "2369780"
  },
  {
    "text": "environment variables so I can reference them in the remaining cells and so first I'm gonna run this locally and in this",
    "start": "2369780",
    "end": "2377280"
  },
  {
    "text": "case locally is actually still on the cloud because data lab is a cloud virtual machine and you'll see that that",
    "start": "2377280",
    "end": "2385650"
  },
  {
    "text": "that finished pretty quickly I have some more compilation warnings here which you",
    "start": "2385650",
    "end": "2391380"
  },
  {
    "text": "can ignore this is just because I didn't compile center flow from scratch on this machine so there's certain optimizations",
    "start": "2391380",
    "end": "2396510"
  },
  {
    "text": "it's letting me know that I can take advantage of if I want to and if I want",
    "start": "2396510",
    "end": "2402630"
  },
  {
    "text": "to run this on the cloud then I use a command line tool called G cloud and I",
    "start": "2402630",
    "end": "2409079"
  },
  {
    "text": "just specify the the the path of my",
    "start": "2409079",
    "end": "2416119"
  },
  {
    "text": "Python file that I had just written here to disk so that's all my code cells just",
    "start": "2416119",
    "end": "2424020"
  },
  {
    "text": "copied pasted it together and written to disk I'm writing a pointer to that so it knows where the code lives and a I'm",
    "start": "2424020",
    "end": "2432210"
  },
  {
    "text": "referencing again my Google Cloud Storage bucket so it knows where to output the results to so I'm gonna run",
    "start": "2432210",
    "end": "2438390"
  },
  {
    "text": "that and so so this is queued",
    "start": "2438390",
    "end": "2445140"
  },
  {
    "text": "successfully and this is just running on one cloud cloud machine learning unit which is you can think of this is the",
    "start": "2445140",
    "end": "2450839"
  },
  {
    "text": "equivalent of a local laptop now here's the real power of me writing this using",
    "start": "2450839",
    "end": "2457800"
  },
  {
    "text": "the estimators API is I can just add a argument here that says - - the scalar",
    "start": "2457800",
    "end": "2464339"
  },
  {
    "text": "equals standard one and now that's gonna run instead of on one CPU it's going to run across ten",
    "start": "2464339",
    "end": "2472530"
  },
  {
    "text": "CPUs and similarly if I want to run on a GPU instead of on a CPU I'll change this",
    "start": "2472530",
    "end": "2479910"
  },
  {
    "text": "skelter to basic GPU and in terms of pricing the GPU costs three times as",
    "start": "2479910",
    "end": "2487950"
  },
  {
    "text": "much as a CPU to run on so as a user your price performance would be you just want to make sure the GPU speeds up your",
    "start": "2487950",
    "end": "2494580"
  },
  {
    "text": "training at least 3x that's your break-even point and so there's certain algorithms where GPU can actually speed",
    "start": "2494580",
    "end": "2500670"
  },
  {
    "text": "up your training 4050 X and there's other types of applications where GPU isn't that much faster than the CPU so",
    "start": "2500670",
    "end": "2507690"
  },
  {
    "text": "just be aware of that when you're deciding whether trip train on the CPU or a GPU and then lastly I am going to",
    "start": "2507690",
    "end": "2515490"
  },
  {
    "text": "run across multiple GPUs so the way that you define this is a little bit different I create a yamo file where I",
    "start": "2515490",
    "end": "2526609"
  },
  {
    "text": "where I specify my machine type and then I referenced that Yambol file as a",
    "start": "2526609",
    "end": "2531930"
  },
  {
    "text": "command-line argument so it's still not that complicated but it's just a little bit different and so now I'm running",
    "start": "2531930",
    "end": "2536970"
  },
  {
    "text": "across eight cloud GPUs and actually in this case those are nvidia tesla k 80s",
    "start": "2536970",
    "end": "2543720"
  },
  {
    "text": "so i'm running across eight of those in parallel so if i go back to the cloud",
    "start": "2543720",
    "end": "2549599"
  },
  {
    "text": "here and click on ml engine jobs you'll",
    "start": "2549599",
    "end": "2555780"
  },
  {
    "text": "see all those four jobs that i just kicked off then they're spinning and you",
    "start": "2555780",
    "end": "2562980"
  },
  {
    "text": "might be asking why this is still running if the one I ran locally",
    "start": "2562980",
    "end": "2568140"
  },
  {
    "text": "finished pretty much instantly and the reason for that is when you're running",
    "start": "2568140",
    "end": "2573270"
  },
  {
    "text": "in the cloud it's starting up the virtual machine from scratch so the startup time for that is about five minutes and then it runs the job so you",
    "start": "2573270",
    "end": "2581700"
  },
  {
    "text": "wouldn't actually want to run this particular job in the cloud because it's such a small data set but when you're thinking of larger data sets where it's",
    "start": "2581700",
    "end": "2588270"
  },
  {
    "text": "going to take hours or even days to run then that five minutes becomes pretty insignificant in the context of the",
    "start": "2588270",
    "end": "2594240"
  },
  {
    "text": "horizontal scaling that you go and in terms of the the logging for any",
    "start": "2594240",
    "end": "2601359"
  },
  {
    "text": "job as it's running you can just click view logs here and it'll give you a",
    "start": "2601359",
    "end": "2607259"
  },
  {
    "text": "running output of of the logs so here it says waiting for job to be provisioned",
    "start": "2607259",
    "end": "2612400"
  },
  {
    "text": "it's still spinning up the VM and then",
    "start": "2612400",
    "end": "2618549"
  },
  {
    "text": "when the job is done we can deploy that well we can inspect our results so I'm",
    "start": "2618549",
    "end": "2623589"
  },
  {
    "text": "gonna go back into my data lab notebook here and I'm gonna inspect the results",
    "start": "2623589",
    "end": "2631509"
  },
  {
    "text": "of the the job that I ran locally since that one's already done and we're going",
    "start": "2631509",
    "end": "2637569"
  },
  {
    "text": "to inspect the results using a tool called tensor board",
    "start": "2637569",
    "end": "2641849"
  },
  {
    "text": "and so remember this review at this point we've started with the raw data set we've done some exploration of that",
    "start": "2657349",
    "end": "2664470"
  },
  {
    "text": "data we then wrote our tensorflow code to define how to interpret the specific",
    "start": "2664470",
    "end": "2670650"
  },
  {
    "text": "columns of that data and also what type of algorithm that we wanted to use for training so in this case we used a two",
    "start": "2670650",
    "end": "2677759"
  },
  {
    "text": "layer neural network and now we want to investigate the results of that training did it actually learn anything is it",
    "start": "2677759",
    "end": "2683609"
  },
  {
    "text": "doing anything useful so here I'm gonna click on my loss diagram here and I'm",
    "start": "2683609",
    "end": "2690569"
  },
  {
    "text": "gonna expand this and basically what you're looking for here is that the this line goes down and to the right that",
    "start": "2690569",
    "end": "2698489"
  },
  {
    "text": "means it's learning something over time and you can see here's my training step",
    "start": "2698489",
    "end": "2705450"
  },
  {
    "text": "here so I have my 3,000 training steps and then I'm running one evaluation step",
    "start": "2705450",
    "end": "2713309"
  },
  {
    "text": "at the end of it so just to do a sanity check here my",
    "start": "2713309",
    "end": "2718400"
  },
  {
    "text": "evaluation step at the end is saying a loss of six point four times ten raise",
    "start": "2718400",
    "end": "2727170"
  },
  {
    "text": "to seven which might seem like a lot but this is actually squared error that's",
    "start": "2727170",
    "end": "2733259"
  },
  {
    "text": "how these that's how this is measured so if I just do some quick math here so I'm",
    "start": "2733259",
    "end": "2738749"
  },
  {
    "text": "gonna do the square root of six point",
    "start": "2738749",
    "end": "2744259"
  },
  {
    "text": "four six followed by or let's just do",
    "start": "2744259",
    "end": "2752269"
  },
  {
    "text": "six for six and then one two three four five zeroes so that's that's that same",
    "start": "2752269",
    "end": "2759569"
  },
  {
    "text": "number and so that comes to about 8,000 so if I put this back in the in my",
    "start": "2759569",
    "end": "2766049"
  },
  {
    "text": "original problem that means it's predicting the selling price of a house with an average error of about eight",
    "start": "2766049",
    "end": "2771660"
  },
  {
    "text": "thousand dollars which which is pretty good maybe it could be better but for",
    "start": "2771660",
    "end": "2776910"
  },
  {
    "text": "any of you who ever sold a house or bought a house if you could know ahead of time within a thousand dollars what it was going to sell for you'd be pretty",
    "start": "2776910",
    "end": "2783420"
  },
  {
    "text": "happy with that so I've inspected my results I am now happy with it and I'm going to now deploy my model for",
    "start": "2783420",
    "end": "2792499"
  },
  {
    "text": "actually for for prediction so to do that there's another g-cloud command",
    "start": "2792499",
    "end": "2798799"
  },
  {
    "text": "here and I'm just again pointing to the",
    "start": "2798799",
    "end": "2804670"
  },
  {
    "text": "to the model file that was created and what this is doing now is it's pushing",
    "start": "2804670",
    "end": "2812539"
  },
  {
    "text": "my model central model file to the cloud and it's spinning up some infrastructure to actually back that and this is all",
    "start": "2812539",
    "end": "2819619"
  },
  {
    "text": "just killing infrastructure so let's say today that I only get you know let's say",
    "start": "2819619",
    "end": "2826249"
  },
  {
    "text": "I've just launched this API and I don't have any users yet so I'm only getting maybe ten requests per day then it's",
    "start": "2826249",
    "end": "2833269"
  },
  {
    "text": "gonna have the minimal VM to back that but all of a sudden if that API goes viral and I'm getting thousands of",
    "start": "2833269",
    "end": "2839509"
  },
  {
    "text": "requests per second then this service will just spin up more VMs in the background to handle those requests so",
    "start": "2839509",
    "end": "2845930"
  },
  {
    "text": "it's it's a cloud native fully auto scaling service in that sense and I can",
    "start": "2845930",
    "end": "2851569"
  },
  {
    "text": "see here if I go to my models section",
    "start": "2851569",
    "end": "2856670"
  },
  {
    "text": "and then click on housing prices that is creating that model and this will take",
    "start": "2856670",
    "end": "2866180"
  },
  {
    "text": "just about probably 15 more seconds because they're just spinning up that VM",
    "start": "2866180",
    "end": "2871249"
  },
  {
    "text": "to back it and then once that's done I'm gonna actually test it out so I'm gonna",
    "start": "2871249",
    "end": "2876710"
  },
  {
    "text": "write out a a couple of new records here",
    "start": "2876710",
    "end": "2881779"
  },
  {
    "text": "for a prediction so I have all my predictive features here the crime rate the age of the house the",
    "start": "2881779",
    "end": "2889989"
  },
  {
    "text": "student-to-teacher ratio in the in that area and I'm gonna write those out to a",
    "start": "2889989",
    "end": "2895489"
  },
  {
    "text": "file and then I'm just gonna pass that file to the service and then here I get",
    "start": "2895489",
    "end": "2901970"
  },
  {
    "text": "my actual predictions back so 24 thousand dollars and seventy thousand dollars respectively and keep in mind",
    "start": "2901970",
    "end": "2908989"
  },
  {
    "text": "this data set is from 1978 so those those housing prices are actually in US dollars are passed the sanity check",
    "start": "2908989",
    "end": "2916460"
  },
  {
    "text": "so just to review what we covered here is how to use tensor flows high-level estimator a",
    "start": "2916460",
    "end": "2921890"
  },
  {
    "text": "p.i how to deploy it for distributed training on the cloud how to evaluate",
    "start": "2921890",
    "end": "2928580"
  },
  {
    "text": "those results using the tool called tensor board and then how to deploy that resulting model to the cloud for online",
    "start": "2928580",
    "end": "2935300"
  },
  {
    "text": "prediction and I also want to point out some important things that we didn't cover so in this case we were using a",
    "start": "2935300",
    "end": "2941420"
  },
  {
    "text": "data set that fit in memory and if you wanted to use a data set that was larger",
    "start": "2941420",
    "end": "2947030"
  },
  {
    "text": "than memory or a quote-unquote big data set there's some other things you would have to take into account we didn't do",
    "start": "2947030",
    "end": "2953450"
  },
  {
    "text": "any true feature engineering we just passed our CSV features as in without",
    "start": "2953450",
    "end": "2959540"
  },
  {
    "text": "doing transformations because in this case we didn't need to but in most cases you will need to and then lastly we",
    "start": "2959540",
    "end": "2966860"
  },
  {
    "text": "didn't do any automatic hyper parameter tuning which in a real data sense data",
    "start": "2966860",
    "end": "2972410"
  },
  {
    "text": "science environment you would normally do that if you would like to learn how to do those things the last thing that I",
    "start": "2972410",
    "end": "2980390"
  },
  {
    "text": "will plug here is there is a great course on Coursera that we release",
    "start": "2980390",
    "end": "2986360"
  },
  {
    "text": "recently that covers how to do all those things it's a one-week course it goes through a case study of predicting taxi cab prices",
    "start": "2986360",
    "end": "2994130"
  },
  {
    "text": "in New York City and it'll do kind of even a level deeper than we did today so",
    "start": "2994130",
    "end": "3002760"
  },
  {
    "text": "so yeah apologies for losing the internet connection and not realizing I lost it for a couple minutes there but",
    "start": "3002760",
    "end": "3009430"
  },
  {
    "text": "thank you for bearing with me and I have technically 50 seconds for questions but",
    "start": "3009430",
    "end": "3015640"
  },
  {
    "text": "it you know if we have any I'm happy to take them and there's one here",
    "start": "3015640",
    "end": "3023160"
  },
  {
    "text": "when collecting more data continuously how do you use this data to automatically retrain your model that's",
    "start": "3029230",
    "end": "3036730"
  },
  {
    "text": "the question yeah so that's a good question and that's a question that's",
    "start": "3036730",
    "end": "3041890"
  },
  {
    "text": "very relevant for certain types of problems like recommendation engines where you are getting new information",
    "start": "3041890",
    "end": "3050860"
  },
  {
    "text": "about your environment and you want to retrain on a daily basis maybe even an hourly basis there's other types of",
    "start": "3050860",
    "end": "3057850"
  },
  {
    "text": "problems where what you know about the world doesn't change for maybe six months or years at a time so you don't",
    "start": "3057850",
    "end": "3063220"
  },
  {
    "text": "have to worry about that the answer is you just have to have a orchestration",
    "start": "3063220",
    "end": "3069310"
  },
  {
    "text": "plan in place so you need to have some type of messaging system that alerts you",
    "start": "3069310",
    "end": "3076990"
  },
  {
    "text": "when there's new data to return to train on and then that kicks off a new training job and when that you training",
    "start": "3076990",
    "end": "3083440"
  },
  {
    "text": "job is kicked off your second decision point is how do I combine the results of that new training job with my old",
    "start": "3083440",
    "end": "3089020"
  },
  {
    "text": "training job so I might just replacing it the old model completely with my new training data or maybe I want to do a",
    "start": "3089020",
    "end": "3095980"
  },
  {
    "text": "sliding window where let's take the example where I'm training on a daily basis I want to take today's data and",
    "start": "3095980",
    "end": "3102820"
  },
  {
    "text": "combine it with a sliding of the last seven days data that I trained on or",
    "start": "3102820",
    "end": "3108640"
  },
  {
    "text": "maybe what I want to do is just an incumbent versus Challenger scenario where I take today's data that I trained",
    "start": "3108640",
    "end": "3114760"
  },
  {
    "text": "on evaluate the model against my success metric and see if it does better or worse than my incumbent model and if it",
    "start": "3114760",
    "end": "3122080"
  },
  {
    "text": "does better I promote that to production or if it doesn't do better I stay with the incumbent model so there's a couple",
    "start": "3122080",
    "end": "3128890"
  },
  {
    "text": "different ways that you can do that we're working on some managed services coming out to make that orchestration",
    "start": "3128890",
    "end": "3135880"
  },
  {
    "text": "piece even easier right now you have to do it a bit more piecemeal but it",
    "start": "3135880",
    "end": "3141400"
  },
  {
    "text": "basically it's a very similar to problem to the kind of continuous integration continual continuous deployment tools in",
    "start": "3141400",
    "end": "3147340"
  },
  {
    "text": "the non machine learning sector ok we're out of time and thank you very much",
    "start": "3147340",
    "end": "3152650"
  },
  {
    "text": "speaking thank you you",
    "start": "3152650",
    "end": "3156790"
  }
]