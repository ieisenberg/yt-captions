[
  {
    "start": "0",
    "end": "50000"
  },
  {
    "text": "welcome we're going to talk about deploying like a boss from the journey",
    "start": "6030",
    "end": "11650"
  },
  {
    "text": "really from two servers up to tens of thousands so my name is Oliver Nicholas",
    "start": "11650",
    "end": "18090"
  },
  {
    "text": "sometimes known by the handle big o for obvious reasons if five-foot-nine and",
    "start": "18090",
    "end": "26340"
  },
  {
    "text": "you know we're going to talk about deployments which is a is really a thrilling thrilling topic most of the",
    "start": "26340",
    "end": "33280"
  },
  {
    "text": "time in this context we're basically talking about the act of taking your",
    "start": "33280",
    "end": "40030"
  },
  {
    "text": "code from one place and then putting it in another place you'll have to excuse",
    "start": "40030",
    "end": "46720"
  },
  {
    "text": "my absurd use of transition effects this",
    "start": "46720",
    "end": "52690"
  },
  {
    "start": "50000",
    "end": "90000"
  },
  {
    "text": "isn't my first rodeo but these are like too much fun not to use so it's a little more exciting than just moving bits",
    "start": "52690",
    "end": "58750"
  },
  {
    "text": "around we also need to touch on load balancer management which is another",
    "start": "58750",
    "end": "63989"
  },
  {
    "text": "really terrible dinner table conversation topic and also the",
    "start": "63989",
    "end": "69670"
  },
  {
    "text": "distribution of these build artifacts I know this is the last talk before lunch",
    "start": "69670",
    "end": "76000"
  },
  {
    "text": "I remember reading a study that was like if this was a Parole Board hearing I would have a really low chance of",
    "start": "76000",
    "end": "81400"
  },
  {
    "text": "getting of getting parole so just just stick with me I promise it'll be sort of",
    "start": "81400",
    "end": "87549"
  },
  {
    "text": "interesting so first off quick background who I am and what right I",
    "start": "87549",
    "end": "95590"
  },
  {
    "start": "90000",
    "end": "184000"
  },
  {
    "text": "have to talk about this for a little while I work as a staff engineer these",
    "start": "95590",
    "end": "100720"
  },
  {
    "text": "days with uber Technologies Incorporated we are what's known as a TNC",
    "start": "100720",
    "end": "107040"
  },
  {
    "text": "transportation network company and that we make this remarkably popular app",
    "start": "107040",
    "end": "113950"
  },
  {
    "text": "which connects independent operators with folks who are trying to get places",
    "start": "113950",
    "end": "119130"
  },
  {
    "text": "we do this in 311 cities across 57",
    "start": "119130",
    "end": "125890"
  },
  {
    "text": "countries over a million times per day",
    "start": "125890",
    "end": "131700"
  },
  {
    "text": "more relevant to this talk on the back end we do that with about 300 separate",
    "start": "131700",
    "end": "138459"
  },
  {
    "text": "micro to macro services these are sort of different orders of magnitude of traffic that these services serve deployed across",
    "start": "138459",
    "end": "146860"
  },
  {
    "text": "somewhere around two to three thousand servers / data center and we're sort of",
    "start": "146860",
    "end": "153010"
  },
  {
    "text": "constantly changing this but it's between two and four data centers right now always be scaling and do you mean we",
    "start": "153010",
    "end": "162760"
  },
  {
    "text": "do at least tens of deployments per day across all of our services so it's it's",
    "start": "162760",
    "end": "168610"
  },
  {
    "text": "very active environment and code is moving around really frequently and we need to be we want to keep agile we want",
    "start": "168610",
    "end": "174459"
  },
  {
    "text": "to be able to make make deployments all the time not worry too much about them",
    "start": "174459",
    "end": "180030"
  },
  {
    "text": "crucially want to be able to roll them back as well me personally made my first",
    "start": "180030",
    "end": "187209"
  },
  {
    "start": "184000",
    "end": "280000"
  },
  {
    "text": "webpage in seventh grade I was really proud of that sometime around 96 so I've",
    "start": "187209",
    "end": "192370"
  },
  {
    "text": "been working on this problem of how do you get your code from one place to another for a pretty long time I took my",
    "start": "192370",
    "end": "198010"
  },
  {
    "text": "first job at a tiny incubator in San Francisco called Google Labs we were",
    "start": "198010",
    "end": "203290"
  },
  {
    "text": "like five guys in a room big enough to hold four guys I think and our",
    "start": "203290",
    "end": "209290"
  },
  {
    "text": "deployments they're pretty frequently brought down the site i took my second",
    "start": "209290",
    "end": "214360"
  },
  {
    "text": "job in 2008 at yelp in my second week of there actually i took down the site by",
    "start": "214360",
    "end": "220540"
  },
  {
    "text": "deploying soon me some code that worked with the version of python that we had",
    "start": "220540",
    "end": "227110"
  },
  {
    "text": "in the dev and staged environments but didn't work with the version of python that we were running in the production",
    "start": "227110",
    "end": "233380"
  },
  {
    "text": "environment which was a real good lesson learned about how you test code before it goes out and then in 2012 i joined",
    "start": "233380",
    "end": "242140"
  },
  {
    "text": "uber which as I mentioned we have a lot of code to move from place to place when",
    "start": "242140",
    "end": "249640"
  },
  {
    "text": "I got there a little ways into the time I got there we had scaled to a certain point at that point I rewrote kind of",
    "start": "249640",
    "end": "255670"
  },
  {
    "text": "the main deploy script and then I gave it to other people so that they could use it to bring down the site from time",
    "start": "255670",
    "end": "262090"
  },
  {
    "text": "to time so that's sort of I like to I like to think of this is like a",
    "start": "262090",
    "end": "268320"
  },
  {
    "text": "lessons learned through drastic mistakes and millions of dollars in lost revenue",
    "start": "268320",
    "end": "273510"
  },
  {
    "text": "it's a good way to internalize it all house that's a bit about me so what do",
    "start": "273510",
    "end": "280590"
  },
  {
    "start": "280000",
    "end": "320000"
  },
  {
    "text": "we mean by deployment system this is the vague broad term I guess by some",
    "start": "280590",
    "end": "286530"
  },
  {
    "text": "measures you could include build servers see I servers any other integration pre",
    "start": "286530",
    "end": "293700"
  },
  {
    "text": "flight tests that you might have the entire production surveying infrastructure the load balancers but I",
    "start": "293700",
    "end": "301670"
  },
  {
    "text": "want to talk specifically about the evolution of the piece that does the",
    "start": "301670",
    "end": "306720"
  },
  {
    "text": "copying of the bits and sort of brings them live so that as distribution and",
    "start": "306720",
    "end": "314300"
  },
  {
    "text": "orchestration so let's dive in and look",
    "start": "314300",
    "end": "320670"
  },
  {
    "start": "320000",
    "end": "530000"
  },
  {
    "text": "first at sort of a nascent typical nascent deployment system when you first",
    "start": "320670",
    "end": "326250"
  },
  {
    "text": "get started on a project I find that that's brutal but I find that frequently",
    "start": "326250",
    "end": "333030"
  },
  {
    "text": "this is basically the the first incarnation of a deploy script for most",
    "start": "333030",
    "end": "338160"
  },
  {
    "text": "most projects that are out there you just press like up in your terminal or search your bash history for the for the",
    "start": "338160",
    "end": "346830"
  },
  {
    "text": "last time you executed this command from your local like development box and use",
    "start": "346830",
    "end": "351960"
  },
  {
    "text": "this this old-school tar SCP combination in case there's anybody who's like not",
    "start": "351960",
    "end": "358350"
  },
  {
    "text": "familiar with this tar is this dates to 1979 and is literally it's like",
    "start": "358350",
    "end": "365640"
  },
  {
    "text": "tape archive it does lots of things in our use case it takes a directory and",
    "start": "365640",
    "end": "371430"
  },
  {
    "text": "combines it down into a single file which you can then copy over to another",
    "start": "371430",
    "end": "376830"
  },
  {
    "text": "server and then untoward and sort of rien fait the original directory structure SCP really hope everyone knows",
    "start": "376830",
    "end": "384780"
  },
  {
    "text": "that one the secure copy just sends your bits over a ssh connection if you want",
    "start": "384780",
    "end": "390690"
  },
  {
    "text": "to get like real janky you could use our CP and not bother with all that pesky encryption but then this the second",
    "start": "390690",
    "end": "398130"
  },
  {
    "text": "command that we see in this pipeline which does a tar the output of that to an SSH command",
    "start": "398130",
    "end": "404130"
  },
  {
    "text": "which then execute some code remotely the second part just untargeted on the",
    "start": "404130",
    "end": "411510"
  },
  {
    "text": "destination host and then the third piece at the end there just like",
    "start": "411510",
    "end": "416520"
  },
  {
    "text": "restarts your code it starts the new code up and actually this is even this",
    "start": "416520",
    "end": "423420"
  },
  {
    "text": "is a hub you can build on this there's actually programs that do a few of the",
    "start": "423420",
    "end": "428760"
  },
  {
    "text": "combine a few of these steps down there's our sink that's a pretty typical one you'll just you know you're writing",
    "start": "428760",
    "end": "434040"
  },
  {
    "text": "your code you hit that go back to your bash history hit your arsenic command and it just sinks the changes that",
    "start": "434040",
    "end": "439290"
  },
  {
    "text": "changed files this is basically what our sink is good at it examines the mod x on",
    "start": "439290",
    "end": "444900"
  },
  {
    "text": "your files and maybe hashes of them and then decides what actually needs to get transferred over the wire so then the",
    "start": "444900",
    "end": "453480"
  },
  {
    "text": "last part there right is just restarting the the process the drawbacks of this",
    "start": "453480",
    "end": "461070"
  },
  {
    "text": "it's not atomic you're changing the code files while the code is running which",
    "start": "461070",
    "end": "466410"
  },
  {
    "text": "means if you get you know some module that hadn't been loaded yet that is suddenly loaded by a new request that comes in you'll get mixed versions of",
    "start": "466410",
    "end": "472800"
  },
  {
    "text": "your files running like in in in program space there can be a performance impact",
    "start": "472800",
    "end": "479730"
  },
  {
    "text": "during this during this process because you're doing a bunch of work on the the",
    "start": "479730",
    "end": "486030"
  },
  {
    "text": "host that's actually running the code before you even do the deployment there's no load balancer management I",
    "start": "486030",
    "end": "492330"
  },
  {
    "text": "mean this restart right here depending on how you've written it that might just like kill the process and start it up again so you might drop existing",
    "start": "492330",
    "end": "498660"
  },
  {
    "text": "connections you might have your a P and accessible for a while while this is happening it's just sort of a brittle",
    "start": "498660",
    "end": "504480"
  },
  {
    "text": "process the great thing about this is that it's real damn easy to do and at",
    "start": "504480",
    "end": "509760"
  },
  {
    "text": "this stage you probably don't care about dropping traffic you may not have that many requests coming in or it might not",
    "start": "509760",
    "end": "517680"
  },
  {
    "text": "might not cost you any money if you drop some some hits so this is really how I think most projects start out and it's a",
    "start": "517680",
    "end": "523229"
  },
  {
    "text": "totally appropriate way I think to start most projects especially when you only have a single server that you're deploying to but",
    "start": "523229",
    "end": "531960"
  },
  {
    "start": "530000",
    "end": "560000"
  },
  {
    "text": "if you're lucky the project grows up and so move here to the the Middle Ages I call them where where we have some",
    "start": "531960",
    "end": "539550"
  },
  {
    "text": "existing projects out there that help us do deployments that are really really",
    "start": "539550",
    "end": "545820"
  },
  {
    "text": "like relatively speaking quite robust and could take you pretty far and in fact can take you like can take you a",
    "start": "545820",
    "end": "553320"
  },
  {
    "text": "little too far and that you you end up with some pretty painful situations as you start to scale up the middle stage",
    "start": "553320",
    "end": "561420"
  },
  {
    "start": "560000",
    "end": "646000"
  },
  {
    "text": "deployment systems you really you end up with these these third-party libraries",
    "start": "561420",
    "end": "567390"
  },
  {
    "text": "like Capistrano and fabric this is really identifiable as a evolution of",
    "start": "567390",
    "end": "573990"
  },
  {
    "text": "this tar SCP pipeline these libraries are just these dsl's written in higher-level languages capas Ruby fabric",
    "start": "573990",
    "end": "582240"
  },
  {
    "text": "as a Python library and they basically are just encapsulating your ssh session",
    "start": "582240",
    "end": "587250"
  },
  {
    "text": "management they come with all these convenience methods for things like unattended pseudo passwords copying",
    "start": "587250",
    "end": "595680"
  },
  {
    "text": "files around capturing and parsing standardout even rollbacks you go pretty",
    "start": "595680",
    "end": "601920"
  },
  {
    "text": "far on these typical setup could involve all the stuff we see here like build the",
    "start": "601920",
    "end": "607770"
  },
  {
    "text": "code sink into the deploy targets take the the target out of the load balancer",
    "start": "607770",
    "end": "613400"
  },
  {
    "text": "shut down the app swap out a symlink to to put the new version of the app in",
    "start": "613400",
    "end": "618450"
  },
  {
    "text": "place start the app up heart checks health checks warm up put the target",
    "start": "618450",
    "end": "624660"
  },
  {
    "text": "back into the load balancer and then move on to the next host and these things are so like Capistrano fabric",
    "start": "624660",
    "end": "630150"
  },
  {
    "text": "there's so much convenience to them that with about this much code this is I don't know 10 15 lines you can actually",
    "start": "630150",
    "end": "635850"
  },
  {
    "text": "get all of those steps that are right there so these are this is this is pretty powerful stuff that really takes",
    "start": "635850",
    "end": "642300"
  },
  {
    "text": "you takes you pretty far the the pros",
    "start": "642300",
    "end": "647910"
  },
  {
    "start": "646000",
    "end": "782000"
  },
  {
    "text": "here is that these are open-source libraries they've already been written for you they're really easy to use there's lots of recipes out there for",
    "start": "647910",
    "end": "654630"
  },
  {
    "text": "the special like any sort of special case you may have pretty much any weird deployment workflow you want to do",
    "start": "654630",
    "end": "661250"
  },
  {
    "text": "somebody has probably already written the code for you and realistically they are good",
    "start": "661250",
    "end": "666570"
  },
  {
    "text": "enough for really into the tens of servers after that you start to run into",
    "start": "666570",
    "end": "671580"
  },
  {
    "text": "weird issues things are always going wrong with at least one server when you have more than tens of them or even like",
    "start": "671580",
    "end": "678510"
  },
  {
    "text": "50 of them maybe then your script one day does something really stupid it tries to open one hundred SSH",
    "start": "678510",
    "end": "684660"
  },
  {
    "text": "connections at once overload something or other things really start to fall over and so you have to do a lot more",
    "start": "684660",
    "end": "690840"
  },
  {
    "text": "tuning a lot of careful work after tens of servers I find and then the cons this",
    "start": "690840",
    "end": "699210"
  },
  {
    "text": "is so this is really not good enough for hundreds of servers you're still essentially utilizing this old-school",
    "start": "699210",
    "end": "705500"
  },
  {
    "text": "tar SDP pipeline which is to say that you have a single node that has your",
    "start": "705500",
    "end": "712650"
  },
  {
    "text": "canonical copy of your code on it and it becomes pretty easy to knock that or something else over like an entire rack",
    "start": "712650",
    "end": "720030"
  },
  {
    "text": "if when you have 100 200 300 production servers and all at once you ask all of",
    "start": "720030",
    "end": "725190"
  },
  {
    "text": "them to download a 300 metal from this one central server you can extend away",
    "start": "725190",
    "end": "731400"
  },
  {
    "text": "from that i think when i arrived at uber the deploy scripts generally speaking",
    "start": "731400",
    "end": "736560"
  },
  {
    "text": "would ssh to each machine and do a git pull they're actually keeping a local copy of the of a git clone of the repo",
    "start": "736560",
    "end": "744090"
  },
  {
    "text": "and then do a build on that host but that's got all sorts of problems with where you're doing the build work it's very expensive it's not particularly",
    "start": "744090",
    "end": "749880"
  },
  {
    "text": "secure bunch of issues there and then these have poor support for multi-user environments there's no there's no lock",
    "start": "749880",
    "end": "756690"
  },
  {
    "text": "around the deployment process although you can resolve this you can you know we",
    "start": "756690",
    "end": "761730"
  },
  {
    "text": "have a deploy 01 and that's your deployment server and you have to ssh in there and it uses some f locking to",
    "start": "761730",
    "end": "767100"
  },
  {
    "text": "prevent multiple people from running it but really this doesn't this doesn't feel good once you're sort of tens of",
    "start": "767100",
    "end": "773610"
  },
  {
    "text": "employees it's harder to coordinate your deploys and you have a lot of servers to go to it really starts to get quite",
    "start": "773610",
    "end": "779220"
  },
  {
    "text": "brittle a quick aside here build",
    "start": "779220",
    "end": "784500"
  },
  {
    "start": "782000",
    "end": "810000"
  },
  {
    "text": "distribution this is the actual copying of the bits until now we've been running SCP rsync whatever from a single host or",
    "start": "784500",
    "end": "792540"
  },
  {
    "text": "maybe doing this really weird thing with doing get pulls remote host but you're still then pulling the git repo from a single get",
    "start": "792540",
    "end": "800769"
  },
  {
    "text": "server this is really not going to last very long before you start to run into",
    "start": "800769",
    "end": "806739"
  },
  {
    "text": "some some difficult situations we really want to avoid this single point of",
    "start": "806739",
    "end": "814269"
  },
  {
    "start": "810000",
    "end": "943000"
  },
  {
    "text": "failure because those single points of failure especially when you're running",
    "start": "814269",
    "end": "819939"
  },
  {
    "text": "your own full racks you can frequently you can really knock over other pieces of infrastructure as well which is not",
    "start": "819939",
    "end": "826359"
  },
  {
    "text": "pretty to do so more scalable approaches we can do the tiered arson coast so we",
    "start": "826359",
    "end": "833499"
  },
  {
    "text": "can instead of just having the the code go to one server we can arson get two",
    "start": "833499",
    "end": "838599"
  },
  {
    "text": "three or four intermediate hosts I'm like logarithmic number of the total number of deploy house and then you're",
    "start": "838599",
    "end": "844989"
  },
  {
    "text": "deployed targets randomly pick one of those hosts to rsync from probably more",
    "start": "844989",
    "end": "851589"
  },
  {
    "text": "popular as you get a little bigger you can stick these in some sort of equivalent or some sort of distributed file system HDFS would be the popular",
    "start": "851589",
    "end": "858579"
  },
  {
    "text": "one I wouldn't advise playing too much with NFS for this but perfectly doable",
    "start": "858579",
    "end": "864989"
  },
  {
    "text": "and then you get more into the more exotic options I know Facebook does uses",
    "start": "864989",
    "end": "873159"
  },
  {
    "text": "BitTorrent to distribute their build artifact now their build artifact as I understand it is a single multi gigabyte",
    "start": "873159",
    "end": "880619"
  },
  {
    "text": "executable so you know BitTorrent is good for this because it's good at",
    "start": "880619",
    "end": "885909"
  },
  {
    "text": "chunking up large files and efficiently distributing that around you could all sorts of really neat stuff like make",
    "start": "885909",
    "end": "892149"
  },
  {
    "text": "sure it prefer peers that are on the same rack as you so you get a lot of",
    "start": "892149",
    "end": "899159"
  },
  {
    "text": "benefits from from network locality but this is this is a little more you have",
    "start": "899159",
    "end": "905499"
  },
  {
    "text": "to write your own BitTorrent clients and servers for this but really these these",
    "start": "905499",
    "end": "911919"
  },
  {
    "text": "sort of tiered hosts or distributed file systems are are a definite need once you",
    "start": "911919",
    "end": "917529"
  },
  {
    "text": "get to hundreds of servers and then they're an absolute requirement once you",
    "start": "917529",
    "end": "923160"
  },
  {
    "text": "get to thousands okay so the the early",
    "start": "923160",
    "end": "929879"
  },
  {
    "text": "ages out of the way we've looked at the intermediate systems let's see what we",
    "start": "929879",
    "end": "935519"
  },
  {
    "text": "can do after tens of servers for the actual orchestration how can we",
    "start": "935519",
    "end": "945139"
  },
  {
    "start": "943000",
    "end": "1118000"
  },
  {
    "text": "reimagine this this whole model in a more scalable way the real underlying",
    "start": "945139",
    "end": "953399"
  },
  {
    "text": "issue here is that all of these systems were push based in general anytime that",
    "start": "953399",
    "end": "959160"
  },
  {
    "text": "you are doing work from one server out to other servers where the number of",
    "start": "959160",
    "end": "966930"
  },
  {
    "text": "outbound connections is a factor of your scaling of your service you're going to",
    "start": "966930",
    "end": "973230"
  },
  {
    "text": "you're going to run into into problems this is just sort of a general scaling principle I think when you have servers",
    "start": "973230",
    "end": "983189"
  },
  {
    "text": "become inaccessible during the deployment with these old school systems you get all these weird structural",
    "start": "983189",
    "end": "988829"
  },
  {
    "text": "issues especially if you're hitting them serially one after the other if the host isn't down of it's not responding if",
    "start": "988829",
    "end": "994939"
  },
  {
    "text": "it's overloaded if the rackets on is overloaded all sorts of stuff can happen and then when that happens you have to",
    "start": "994939",
    "end": "1001970"
  },
  {
    "text": "make pretty difficult decisions about what to do a server doesn't respond do",
    "start": "1001970",
    "end": "1008509"
  },
  {
    "text": "you abort the whole deploy do you roll back the whole deploy you keep rolling forward how long do you wait for does",
    "start": "1008509",
    "end": "1016009"
  },
  {
    "text": "this mean that all of your deployments take six hours because you sort of hit the button and walk away and they don't realize that there's five hosts that are",
    "start": "1016009",
    "end": "1021889"
  },
  {
    "text": "internal and then if you do keep rolling you end up with this in the push model",
    "start": "1021889",
    "end": "1027770"
  },
  {
    "text": "you end up with this painful consistency problem where when your old servers come back online they don't they miss the",
    "start": "1027770",
    "end": "1035030"
  },
  {
    "text": "message that they were supposed to upgrade and they're running old versions of the code and nobody really knows about it and so you've got mixed",
    "start": "1035030",
    "end": "1040610"
  },
  {
    "text": "versions in production so we can resolve",
    "start": "1040610",
    "end": "1045740"
  },
  {
    "text": "this by inverting the logic to be a sort of pull based model where our leaf nodes",
    "start": "1045740",
    "end": "1052580"
  },
  {
    "text": "the app servers going to ping into a central server and say what should I be doing here rather",
    "start": "1052580",
    "end": "1059270"
  },
  {
    "text": "than relying on this push this is pretty typical I think inversion of control",
    "start": "1059270",
    "end": "1067179"
  },
  {
    "text": "typical I think scaling property this is",
    "start": "1067179",
    "end": "1072530"
  },
  {
    "text": "sort of a goal based system where the these leaf servers are going to say what",
    "start": "1072530",
    "end": "1079100"
  },
  {
    "text": "what what state should I be in and then they're going to do the work on their own they're going to orchestrate it on their own to get into that state also",
    "start": "1079100",
    "end": "1089390"
  },
  {
    "text": "once you get past a couple of apps and a couple of servers that you're 2.2 it starts to get pretty inconvenient when",
    "start": "1089390",
    "end": "1095630"
  },
  {
    "text": "those old-school scripts where you have this hard to go back boo where you have this list of servers you know this app",
    "start": "1095630",
    "end": "1101660"
  },
  {
    "text": "deploys on servers 165 that it starts to feel really really ugly to work with and",
    "start": "1101660",
    "end": "1110510"
  },
  {
    "text": "the data is hard to get to it's not easy to share between scripts that might need that information about which service is",
    "start": "1110510",
    "end": "1115610"
  },
  {
    "text": "deployed where so specifically at uber we solve this with essentially this Hardware management database called",
    "start": "1115610",
    "end": "1121700"
  },
  {
    "start": "1118000",
    "end": "1188000"
  },
  {
    "text": "custo this is a project that was written by the guy's a day go back in the day and it's really just this this",
    "start": "1121700",
    "end": "1128950"
  },
  {
    "text": "management database that consists of server objects and pools and then you",
    "start": "1128950",
    "end": "1136340"
  },
  {
    "text": "can either look up information by pool or by server so you can tell from this",
    "start": "1136340",
    "end": "1142730"
  },
  {
    "text": "data here that a PO one is in the production rack double oh one service a",
    "start": "1142730",
    "end": "1148640"
  },
  {
    "text": "and service be pools and then you could also look up and say which are the servers that are in the service a pool",
    "start": "1148640",
    "end": "1154490"
  },
  {
    "text": "and so you get this programmatic interface to finding out how your where your hardware is custo itself also these",
    "start": "1154490",
    "end": "1161450"
  },
  {
    "text": "these server objects are pretty pretty rich and so you we actually store all",
    "start": "1161450",
    "end": "1168290"
  },
  {
    "text": "the information about you know how much memory is on this machine how much disk space would CPUs that kind of stuff I",
    "start": "1168290",
    "end": "1173860"
  },
  {
    "text": "highly recommend this once you get to a certain size of infrastructure if you're",
    "start": "1173860",
    "end": "1179919"
  },
  {
    "text": "running your own servers a little less relevant if you're on AWS or something",
    "start": "1179919",
    "end": "1185870"
  },
  {
    "text": "somewhere okay so we have this pull model and how",
    "start": "1185870",
    "end": "1192970"
  },
  {
    "start": "1188000",
    "end": "1358000"
  },
  {
    "text": "do we put that into play we built our own thing called you deploy which is the",
    "start": "1192970",
    "end": "1198279"
  },
  {
    "text": "specification for it is only slightly less fuzzy that it's showing up on here so basically there's a coordinator in",
    "start": "1198279",
    "end": "1205450"
  },
  {
    "text": "each data center which is the box inside the box on top there and then these big",
    "start": "1205450",
    "end": "1212499"
  },
  {
    "text": "black boxes are data centers the coordinator on the bottom is called an",
    "start": "1212499",
    "end": "1217570"
  },
  {
    "text": "intermediate and then a worker on every deploy target every app host that we're running we put one of these workers on",
    "start": "1217570",
    "end": "1224169"
  },
  {
    "text": "the workers are pulling the coordinator every so often for their target state",
    "start": "1224169",
    "end": "1229990"
  },
  {
    "text": "what what what should I be doing what versions of the code should I have locally what should I be running that kind of thing the coordinator hits this",
    "start": "1229990",
    "end": "1238049"
  },
  {
    "text": "custo database and has this you know a priori concept of which machines are in",
    "start": "1238049",
    "end": "1244990"
  },
  {
    "text": "the service pool and then it can use that and a associated deploy policy for",
    "start": "1244990",
    "end": "1250210"
  },
  {
    "text": "every individual service that it knows about to decide how to instruct these servers when they do make requests how",
    "start": "1250210",
    "end": "1257409"
  },
  {
    "text": "to proceed so this deployment policy is",
    "start": "1257409",
    "end": "1262929"
  },
  {
    "text": "customizable so you can say things like you made the coordinator can proceed",
    "start": "1262929",
    "end": "1268659"
  },
  {
    "text": "with actually kicking off the deploy once ninety percent of the servers are downloaded the code and so this allows",
    "start": "1268659",
    "end": "1273999"
  },
  {
    "text": "you to sort of automate the the consistency issues that you might have",
    "start": "1273999",
    "end": "1279610"
  },
  {
    "text": "with a really large infrastructure and machines that periodically come in and go out of availability and then the",
    "start": "1279610",
    "end": "1287769"
  },
  {
    "text": "intermediate coordinators take a cue from the primary as soon as deployments are kind of started so we actually",
    "start": "1287769",
    "end": "1293950"
  },
  {
    "text": "perform our deployments in parallel across data centers this becomes pretty",
    "start": "1293950",
    "end": "1301210"
  },
  {
    "text": "important you know it since every new data center is essentially you know another two thousand machines so we have to think about so this is the the goal",
    "start": "1301210",
    "end": "1308919"
  },
  {
    "text": "based system incidentally the way we haven't configured these coordinators are pinging or sorry these workers are",
    "start": "1308919",
    "end": "1315759"
  },
  {
    "text": "pinging the coordinator every 30 seconds or so and then as soon as you start kicking off a deploy in the YouTube boy",
    "start": "1315759",
    "end": "1322539"
  },
  {
    "text": "UI which I'll show you in a second the next time one of those workers pings the",
    "start": "1322539",
    "end": "1328690"
  },
  {
    "text": "coordinator for a state update and the coordinator knows that that workers from a machine that's going to be involved in",
    "start": "1328690",
    "end": "1334120"
  },
  {
    "text": "this deploy it says go into overdrive ping me every five seconds and that way we can sort of reduce in the general",
    "start": "1334120",
    "end": "1342100"
  },
  {
    "text": "case we we don't have too much load on the on the coordinator but when we're actually doing a deployment the machines",
    "start": "1342100",
    "end": "1347770"
  },
  {
    "text": "that are relevant to it we can they'll ping more often it we can more tightly coordinate the timeline to do a faster",
    "start": "1347770",
    "end": "1354309"
  },
  {
    "text": "deploy so I'll show a couple pieces here this is sort of the the first page you'd",
    "start": "1354309",
    "end": "1362530"
  },
  {
    "text": "see these are all the things that have API and the name and it's kind of nice you get the the app itself the type of",
    "start": "1362530",
    "end": "1368740"
  },
  {
    "text": "app you know there's a node app and there some Python apps some some basic static pages you see how many instances",
    "start": "1368740",
    "end": "1375309"
  },
  {
    "text": "are there and health of them so we can see on this third one down that four of these instances are in some bad state",
    "start": "1375309",
    "end": "1381400"
  },
  {
    "text": "and the rest are in a good state which is pretty cool we see what we've what we've actually deployed when we did it",
    "start": "1381400",
    "end": "1387970"
  },
  {
    "text": "status of the current deployment I guess this is this is sort of the the control",
    "start": "1387970",
    "end": "1395500"
  },
  {
    "text": "the control dashboard for pretty much all deployments at uber this would be",
    "start": "1395500",
    "end": "1401380"
  },
  {
    "start": "1400000",
    "end": "1442000"
  },
  {
    "text": "the where you drill down into a single service you're basically impossible to",
    "start": "1401380",
    "end": "1407470"
  },
  {
    "text": "see but you're seeing that you can actually deploy between stage or production environments you can target",
    "start": "1407470",
    "end": "1412870"
  },
  {
    "text": "these separately and then on the bottom here you're actually seeing state of every every server that's running this",
    "start": "1412870",
    "end": "1419950"
  },
  {
    "text": "code so when those leaf nodes are when those workers are pinging in there they're giving status updates to the to",
    "start": "1419950",
    "end": "1425650"
  },
  {
    "text": "the coordinator and the coordinator can show them in this UI so it's actually a pretty rich system that has that works",
    "start": "1425650",
    "end": "1432940"
  },
  {
    "text": "well for sort of in the hundreds of servers I think I think there would be a bunch of issues once we got into tens of",
    "start": "1432940",
    "end": "1438280"
  },
  {
    "text": "thousands for any given service but works good up to this point so you go",
    "start": "1438280",
    "end": "1443890"
  },
  {
    "text": "into the coordinator and you would kick off a deploy and what you're seeing here is for that one of those API services",
    "start": "1443890",
    "end": "1449620"
  },
  {
    "text": "you hit the build button and it actually it's pretty cool it goes and hits the the git repo and shows a list of the",
    "start": "1449620",
    "end": "1457930"
  },
  {
    "text": "last commits and you can pick one of them and that's the one you're going to do a build of hit the button so let's",
    "start": "1457930",
    "end": "1464980"
  },
  {
    "text": "say in this in this case it's version ABC and it's going to go do a build and",
    "start": "1464980",
    "end": "1471100"
  },
  {
    "text": "create the the build artifact in this case it would be a Python virtual end but it could be you know could be a",
    "start": "1471100",
    "end": "1476260"
  },
  {
    "text": "docker container in some cases or could be anything any sort of any sort of artifact then next time the workers that",
    "start": "1476260",
    "end": "1485980"
  },
  {
    "text": "are involved in what's the build is done next time the workers that are on this services machines as cluster reports",
    "start": "1485980",
    "end": "1493200"
  },
  {
    "text": "next time they call in the coordinator is going to tell it hey the list of the",
    "start": "1493200",
    "end": "1503350"
  },
  {
    "text": "versions of code that you should have includes this version ABC and then once",
    "start": "1503350",
    "end": "1509080"
  },
  {
    "text": "the coordinator by its deployment policy is satisfied that enough of the servers have the code can move on to the next phase of the deployment where it starts",
    "start": "1509080",
    "end": "1516700"
  },
  {
    "text": "activating them in tranches and they're gonna they're just as they ping in it's",
    "start": "1516700",
    "end": "1522490"
  },
  {
    "text": "going to say it's the coordinator is going to know oh I've already done you know the first two windows so now i'm",
    "start": "1522490",
    "end": "1527500"
  },
  {
    "text": "doing servers 20 through 30 so when those guys come in give them an updated",
    "start": "1527500",
    "end": "1534540"
  },
  {
    "text": "indication of which version of the code that they should be running and then the deploy the poi targets actually manage",
    "start": "1534540",
    "end": "1542620"
  },
  {
    "text": "their upgrades from there remove themselves from the load balancer activate the new code warm it up and",
    "start": "1542620",
    "end": "1549670"
  },
  {
    "text": "then return themselves in the production pool so it really pushes pushes work off",
    "start": "1549670",
    "end": "1558100"
  },
  {
    "start": "1557000",
    "end": "1684000"
  },
  {
    "text": "of the off of the coordinator so that it's only really doing passive work in",
    "start": "1558100",
    "end": "1564070"
  },
  {
    "text": "the order of the number of workers that are out there also while this is",
    "start": "1564070",
    "end": "1570790"
  },
  {
    "text": "happening the coordinator is talking to other systems which are monitoring the health of the service that's being",
    "start": "1570790",
    "end": "1576700"
  },
  {
    "text": "deployed so we can look at things like response times the change exception",
    "start": "1576700",
    "end": "1583030"
  },
  {
    "text": "rates going up and and then it can the coordinator can then from its angle",
    "start": "1583030",
    "end": "1588640"
  },
  {
    "text": "initiate a roll back so we can as those workers are pinion in every five seconds",
    "start": "1588640",
    "end": "1594490"
  },
  {
    "text": "it can it can say oh we gotta we gotta we have to either to abort or we can go back to the last version of the code and",
    "start": "1594490",
    "end": "1600970"
  },
  {
    "text": "we keep multiple versions of the code present on the deploy targets so that it's very quick to do the rollback so",
    "start": "1600970",
    "end": "1612730"
  },
  {
    "text": "there are some drawbacks we still be static server pools there in custo",
    "start": "1612730",
    "end": "1619570"
  },
  {
    "text": "rather than in a file but it means that the deployment kind of relies on having this weird static mapping of service to",
    "start": "1619570",
    "end": "1626440"
  },
  {
    "text": "server slow to update kind of awkward to to deal with and then it also means that",
    "start": "1626440",
    "end": "1633070"
  },
  {
    "text": "the deploys have to be windowed rather than like a full red black deployment so if I have 10 servers in the API service",
    "start": "1633070",
    "end": "1639520"
  },
  {
    "text": "pool when I go to do a deployment well I can I can take like two of them out upgrade them put them back in take two",
    "start": "1639520",
    "end": "1645940"
  },
  {
    "text": "more out upgrade them put them back in the most that I can take out at any one time is essentially you know how it's a",
    "start": "1645940",
    "end": "1653620"
  },
  {
    "text": "factor of how over provisioned my service is and how comfortable I am reducing capacity so if you tune this",
    "start": "1653620",
    "end": "1660130"
  },
  {
    "text": "wrong a deployment that goes fine during low traffic could actually knock out your service during a high-traffic",
    "start": "1660130",
    "end": "1665740"
  },
  {
    "text": "period and so because we only have those ten those ten service to work with so",
    "start": "1665740",
    "end": "1671770"
  },
  {
    "text": "it's it can be a little constrained so this is sort of the fun stuff this is",
    "start": "1671770",
    "end": "1678070"
  },
  {
    "text": "actually my current area of focus this is what I'm myself working on right now",
    "start": "1678070",
    "end": "1684059"
  },
  {
    "start": "1684000",
    "end": "1696000"
  },
  {
    "text": "the future well where are we going to take this so that we can overcome the",
    "start": "1684059",
    "end": "1689470"
  },
  {
    "text": "remaining limitations until we find some more limitations how many Quick Poll how",
    "start": "1689470",
    "end": "1698710"
  },
  {
    "start": "1696000",
    "end": "1726000"
  },
  {
    "text": "many people here are familiar with mezzos a good number okay cool well",
    "start": "1698710",
    "end": "1704650"
  },
  {
    "text": "mezzos is this resource management engine pluggable conduit for scheduling",
    "start": "1704650",
    "end": "1711520"
  },
  {
    "text": "tasks jobs against server resources the mezzos people call it a distributed",
    "start": "1711520",
    "end": "1717280"
  },
  {
    "text": "systems Colonel there's a lot of there's a lot of great nomenclature around above the mezzos ecosystem this",
    "start": "1717280",
    "end": "1727120"
  },
  {
    "start": "1726000",
    "end": "2015000"
  },
  {
    "text": "is kind of what it looks like it is a it's essentially cluster management it's",
    "start": "1727120",
    "end": "1734410"
  },
  {
    "text": "in the Apache foundation right now it consists of this I'm afraid this is a",
    "start": "1734410",
    "end": "1741280"
  },
  {
    "text": "power button or a laser button I'm not going to risk it it consists of a",
    "start": "1741280",
    "end": "1746350"
  },
  {
    "text": "high-availability set of master nodes which are coordinated by a zookeeper",
    "start": "1746350",
    "end": "1752380"
  },
  {
    "text": "core and and then a slave instance that's running on every worker node so",
    "start": "1752380",
    "end": "1758440"
  },
  {
    "text": "that's that's actually in some ways kind of similar to how you deploy it works",
    "start": "1758440",
    "end": "1763830"
  },
  {
    "text": "this is where it gets weird these slaves make resource offers to the master they",
    "start": "1763830",
    "end": "1769450"
  },
  {
    "text": "say I have so many CPUs so much memory so much disk space available it's kind",
    "start": "1769450",
    "end": "1774700"
  },
  {
    "text": "of cool you can define custom resources that get offered through as well and then the master is going to pass those",
    "start": "1774700",
    "end": "1780660"
  },
  {
    "text": "offers on to these frameworks that it's configured with this case I've put marathon up there but there's Jillian",
    "start": "1780660",
    "end": "1786910"
  },
  {
    "text": "others and then that merit that framework gets to decide do I have a job that I want to run that fits into this",
    "start": "1786910",
    "end": "1793000"
  },
  {
    "text": "resource offer that I've just been given I have the server it's tagged as having you know kernel version 313 and I've",
    "start": "1793000",
    "end": "1801700"
  },
  {
    "text": "been told that I have 12 cores and twenty four gigs of ram to work with do I want to schedule something here and if",
    "start": "1801700",
    "end": "1808420"
  },
  {
    "text": "it does want to accept it then it passes back this is how many resources my job needs this is the job I want you to run",
    "start": "1808420",
    "end": "1813810"
  },
  {
    "text": "and this is the this is droplet which run so then there's these sort of",
    "start": "1813810",
    "end": "1819700"
  },
  {
    "text": "acknowledgments that go back and forth some sort of magic happens and then your code starts running and then the the",
    "start": "1819700",
    "end": "1826090"
  },
  {
    "text": "slave decrements it's available resources so the next time that it makes an offer it's going to reflect the fact",
    "start": "1826090",
    "end": "1832420"
  },
  {
    "text": "that you've just used up some of those cores and some of those some of that ram",
    "start": "1832420",
    "end": "1837960"
  },
  {
    "text": "and this doesn't really deal with the code distribution part so all that stuff that we went over is still sort of",
    "start": "1837960",
    "end": "1843610"
  },
  {
    "text": "relevant to to this is quick examples so slave might make an offer this you know",
    "start": "1843610",
    "end": "1849670"
  },
  {
    "text": "22 cores and 32 gigs of ram the master sends it off to the frameworks the framework might accept a",
    "start": "1849670",
    "end": "1856340"
  },
  {
    "text": "portion of it and inform the master so I want one cpu and I want 64 megs of ram and just run the command yes it probably",
    "start": "1856340",
    "end": "1864680"
  },
  {
    "text": "familiar with the yes is like my favorite command to do this because it just chews up one core the man page for",
    "start": "1864680",
    "end": "1871940"
  },
  {
    "text": "it is probably my favorite man page in UNIX its be repetitively affirmative is",
    "start": "1871940",
    "end": "1877400"
  },
  {
    "text": "the only thing it says yes just prints yes to standard out in a tight loop and",
    "start": "1877400",
    "end": "1883630"
  },
  {
    "text": "then the next offer would have taken that into account this is all quite",
    "start": "1883630",
    "end": "1891200"
  },
  {
    "text": "magic its fault tolerant if the slave crashes it's doing some check pointing",
    "start": "1891200",
    "end": "1897260"
  },
  {
    "text": "locally and then it when it starts back up it can usually figure out where it was you can also configure it so that if",
    "start": "1897260",
    "end": "1903290"
  },
  {
    "text": "it crashes and it starts back up that it can just say it can just declare bankruptcy kill everything that's running start over if the master crashes",
    "start": "1903290",
    "end": "1912620"
  },
  {
    "text": "then there are these other other masters in this quorum that can take over from",
    "start": "1912620",
    "end": "1920120"
  },
  {
    "text": "it and then the frameworks it's kind of interesting so the framework is the thing that cares about what's actually",
    "start": "1920120",
    "end": "1926120"
  },
  {
    "text": "running mezzos is tracking individual instances but the framework is the one that scheduled the job in the first place so the frameworks the one",
    "start": "1926120",
    "end": "1932090"
  },
  {
    "text": "ostensibly that cares about it the framework is expected to make a durable commit about what it thinks the state of",
    "start": "1932090",
    "end": "1938630"
  },
  {
    "text": "the cluster is just before it tells mezzos this is what I want you to run so",
    "start": "1938630",
    "end": "1943940"
  },
  {
    "text": "if the framework crashes when it starts back up it has this list of tasks that it thinks it's scheduled and then it can",
    "start": "1943940",
    "end": "1950540"
  },
  {
    "text": "ask for this reconciliation process where I can say hey mezzos what do you know about you know task a and mezzos",
    "start": "1950540",
    "end": "1956960"
  },
  {
    "text": "can check its state that's been communicated between slaves and master and say this is the state it's it's still running it's good to go or it's",
    "start": "1956960",
    "end": "1962840"
  },
  {
    "text": "lost it disappeared while you were gone and you should update your own internal state to reflect that and so that is",
    "start": "1962840",
    "end": "1970760"
  },
  {
    "text": "mezzos pretty much it's actually this remarkably simple system for apportioning out physical like cluster",
    "start": "1970760",
    "end": "1977690"
  },
  {
    "text": "resources to these frameworks that want to do work and you can really run anything you want",
    "start": "1977690",
    "end": "1983810"
  },
  {
    "text": "you can run containers you can run processes you sort of configure it",
    "start": "1983810",
    "end": "1988970"
  },
  {
    "text": "anyway you really you really want to they've added in a bunch of really cool support for automatically setting see",
    "start": "1988970",
    "end": "1994730"
  },
  {
    "text": "groups so you can get resource isolation it's it's it's pretty great still sort",
    "start": "1994730",
    "end": "2001420"
  },
  {
    "text": "of in the early days though lots of work going on here so we at uber are specifically looking deep into starting",
    "start": "2001420",
    "end": "2009100"
  },
  {
    "text": "to deploy a particular framework called marathon so this is one of those mezzos",
    "start": "2009100",
    "end": "2017170"
  },
  {
    "text": "plugins essentially they described it as a cluster wide in it and control system",
    "start": "2017170",
    "end": "2023140"
  },
  {
    "text": "for services in C groups or docker containers it has built-in support for",
    "start": "2023140",
    "end": "2028920"
  },
  {
    "text": "various deployment policies similar to you deploy it does its own health checking it does automated rollbacks",
    "start": "2028920",
    "end": "2035500"
  },
  {
    "text": "that are all configurable which is pretty sweet and I'll talk more about",
    "start": "2035500",
    "end": "2040600"
  },
  {
    "text": "the overlap between this and you deploy in in just a second but it also has this really sweet constraint system so i can",
    "start": "2040600",
    "end": "2047980"
  },
  {
    "text": "say something like given a nap I want you to distribute this evenly across racks which is great for you know",
    "start": "2047980",
    "end": "2053710"
  },
  {
    "text": "reducing the sort of failure modes of your application you can tell it don't put more than one instance of this app",
    "start": "2053710",
    "end": "2059889"
  },
  {
    "text": "on any given server if you need that for some reason where you could say only",
    "start": "2059890",
    "end": "2065830"
  },
  {
    "text": "deployed machines that have this certain tag on them like a kernel version or a Python version or anything like that so",
    "start": "2065830",
    "end": "2071950"
  },
  {
    "text": "it's a pretty richly defined way to to get specific constraints on your",
    "start": "2071950",
    "end": "2078460"
  },
  {
    "text": "deployments so this example I have right here is like a really quick way to like",
    "start": "2078460",
    "end": "2083980"
  },
  {
    "text": "burned electricity you can with just like a few clicks of this button a few",
    "start": "2083980",
    "end": "2089830"
  },
  {
    "text": "few taps at a click of a button you can you can deploy 300 instances of yes running across your infrastructure and",
    "start": "2089830",
    "end": "2096040"
  },
  {
    "text": "this is this is basically how I test things all day long it's pretty fun it also has this great rest api so this UI",
    "start": "2096040",
    "end": "2103210"
  },
  {
    "text": "your scene is really just a just a toy",
    "start": "2103210",
    "end": "2109480"
  },
  {
    "text": "really okay so how do we integrate these two things what's the what do we want to",
    "start": "2109480",
    "end": "2115180"
  },
  {
    "start": "2111000",
    "end": "2258000"
  },
  {
    "text": "do by integrating them you deploy has some awesome fee it already it's got this beautiful interface for browsing our code repos",
    "start": "2115180",
    "end": "2121329"
  },
  {
    "text": "and for kicking off builds it has authenticated authorization support you",
    "start": "2121329",
    "end": "2126490"
  },
  {
    "text": "know if you're under PCI requirements or if you have an organization of six",
    "start": "2126490",
    "end": "2132369"
  },
  {
    "text": "hundred engineers like we do this stuff starts to become more important and also",
    "start": "2132369",
    "end": "2137650"
  },
  {
    "text": "probably very custom to your own organization you deploy gives us",
    "start": "2137650",
    "end": "2142930"
  },
  {
    "text": "coordination across multiple data centers that is not a feature that's really in mezzo mezzo siz not designed",
    "start": "2142930",
    "end": "2148930"
  },
  {
    "text": "to run across datacenters zookeeper is definitely not designed to run across data centers so this becomes sort of",
    "start": "2148930",
    "end": "2154960"
  },
  {
    "text": "important and we get this higher-order health checking rollback functionality we can cost we've customized it to look",
    "start": "2154960",
    "end": "2161920"
  },
  {
    "text": "at our particular infrastructure and know what we think is a bad deploy look",
    "start": "2161920",
    "end": "2166960"
  },
  {
    "text": "in our you know exception tracking systems that kind of stuff but mezzos",
    "start": "2166960",
    "end": "2172089"
  },
  {
    "text": "marathon have some suite features as well it already they already built all this stuff for high-availability masters",
    "start": "2172089",
    "end": "2178000"
  },
  {
    "text": "with zookeeper coordination it's kind of nice to have that done already as most",
    "start": "2178000",
    "end": "2183309"
  },
  {
    "text": "really shifts the focus from individual instances to like clusters of work the",
    "start": "2183309",
    "end": "2189640"
  },
  {
    "text": "mezzo slaves are tracking individual instances but when an instance dies it's not like oh this is the machine that was",
    "start": "2189640",
    "end": "2196900"
  },
  {
    "text": "dedicated to run that instance we have to restart it in place it's hey that hey something died and the slave reports",
    "start": "2196900",
    "end": "2203289"
  },
  {
    "text": "that back up to the master master report set to the framework the framework decrements its run count by one and",
    "start": "2203289",
    "end": "2208420"
  },
  {
    "text": "those next time I get an offer I need to schedule a new instance of this job somewhere on the infrastructure so we",
    "start": "2208420",
    "end": "2213549"
  },
  {
    "text": "don't really care about those individual instances because in a big enough infrastructure things die all the time",
    "start": "2213549",
    "end": "2219039"
  },
  {
    "text": "like you run into fatal exceptions left and right you know you'll get I don't know you get a cosmic ray bit flip and",
    "start": "2219039",
    "end": "2224710"
  },
  {
    "text": "suddenly something crashes it just happens so your your ops team will will",
    "start": "2224710",
    "end": "2230109"
  },
  {
    "text": "definitely appreciate this characteristic it also homogenizes the",
    "start": "2230109",
    "end": "2236549"
  },
  {
    "text": "cluster resources so you're not really thinking as much about individual servers so much as a vast sea of CPUs",
    "start": "2236549",
    "end": "2245650"
  },
  {
    "text": "and rams and disks and stuff and that's probably I just sit so what",
    "start": "2245650",
    "end": "2252740"
  },
  {
    "text": "do we do how are we going to combine these two we're just going to mash them together and good old composition what",
    "start": "2252740",
    "end": "2262790"
  },
  {
    "start": "2258000",
    "end": "2291000"
  },
  {
    "text": "we're actually going to do is we let you deploy kind of be the brain and the UI that decides what gets deployed and when",
    "start": "2262790",
    "end": "2270140"
  },
  {
    "text": "it gets deployed and it keeps watch over like cluster health and then we let mezzos marathon handle deployment",
    "start": "2270140",
    "end": "2278180"
  },
  {
    "text": "strategies resource allocation instance health that kind of stuff first order",
    "start": "2278180",
    "end": "2287270"
  },
  {
    "text": "approximation in this diagram okay so another neat thing is this makes auto",
    "start": "2287270",
    "end": "2296840"
  },
  {
    "start": "2291000",
    "end": "2459000"
  },
  {
    "text": "scaling much easier by shifting the focus from where do you explicitly want",
    "start": "2296840",
    "end": "2302750"
  },
  {
    "text": "instances to run to just give me some operating restrictions and tell me how",
    "start": "2302750",
    "end": "2309020"
  },
  {
    "text": "many instances to run mezzos marathon really helps solve this doing the work",
    "start": "2309020",
    "end": "2315440"
  },
  {
    "text": "part of scaling it's easy to scale up the app so what we want to automate is",
    "start": "2315440",
    "end": "2321700"
  },
  {
    "text": "the doing making the decision of scaling",
    "start": "2321700",
    "end": "2328570"
  },
  {
    "text": "so we're sort of starting to still work",
    "start": "2328570",
    "end": "2335150"
  },
  {
    "text": "in progress I guess we're starting to deal with this basically we're we're looking at running our everything that",
    "start": "2335150",
    "end": "2341750"
  },
  {
    "text": "we deploy under a sea group or under a docker container the infrastructure really supports both cases but it gives",
    "start": "2341750",
    "end": "2347990"
  },
  {
    "text": "you hard resource isolation among your running processes this gives you fine",
    "start": "2347990",
    "end": "2354590"
  },
  {
    "text": "grained utilization metrics for every service that you're running across your",
    "start": "2354590",
    "end": "2359750"
  },
  {
    "text": "your infrastructure and then from that you can derive scaling decision so you",
    "start": "2359750",
    "end": "2366920"
  },
  {
    "text": "can look at sort of global resource utilization for you know the API service and say this thing is getting too like",
    "start": "2366920",
    "end": "2373490"
  },
  {
    "text": "ninety percent of its CPU utilization that probably indicates that it's it's",
    "start": "2373490",
    "end": "2378530"
  },
  {
    "text": "serving too many requests for the amount of workers that are out there let's scale up the number of workers",
    "start": "2378530",
    "end": "2383970"
  },
  {
    "text": "we're still working on this it's obviously you have to be very careful that you don't write something that accidentally scales your server service",
    "start": "2383970",
    "end": "2390280"
  },
  {
    "text": "to nothing or uses all of your cluster resources because of some downstream dependency or momentary blip there's a",
    "start": "2390280",
    "end": "2398080"
  },
  {
    "text": "lot of damping in there but this is between these two between doing the work",
    "start": "2398080",
    "end": "2403660"
  },
  {
    "text": "of scaling and automating the decision to scale suddenly your operations team",
    "start": "2403660",
    "end": "2409240"
  },
  {
    "text": "has a lot less stuff to do which is which is pretty sweet I spent two years at uber as the ultimate on call for",
    "start": "2409240",
    "end": "2416680"
  },
  {
    "text": "every escalation policy and I can tell you that this would have been this would",
    "start": "2416680",
    "end": "2421930"
  },
  {
    "text": "have made Friday nights a lot more enjoyable for those two years so this is",
    "start": "2421930",
    "end": "2432160"
  },
  {
    "text": "all you deploy a marathon interaction and it's actually pretty easy to write",
    "start": "2432160",
    "end": "2439990"
  },
  {
    "text": "your own oh god to write your own frameworks for mezzos the the the the",
    "start": "2439990",
    "end": "2448420"
  },
  {
    "text": "interface is really quite straightforward and so someday we might just take you to play and promote it into a full mezzos framework for now",
    "start": "2448420",
    "end": "2455410"
  },
  {
    "text": "marathon has a lot of this stuff already built in so we're just using that now there are a jillion other mezzos",
    "start": "2455410",
    "end": "2461080"
  },
  {
    "start": "2459000",
    "end": "2607000"
  },
  {
    "text": "frameworks out there people are really like it's really fun to see in the infrastructure world some there's a ton",
    "start": "2461080",
    "end": "2469120"
  },
  {
    "text": "of focus that's going on to this cluster management space so there's mezzos google has Cooper Nettie's that's just",
    "start": "2469120",
    "end": "2476590"
  },
  {
    "text": "sort of gone out what am I missing here docker themselves have just released a",
    "start": "2476590",
    "end": "2483280"
  },
  {
    "text": "swarm which is a similar type of orchestration engine so people are",
    "start": "2483280",
    "end": "2489190"
  },
  {
    "text": "really starting to to catch on that like we're really as a as a world as an",
    "start": "2489190",
    "end": "2494890"
  },
  {
    "text": "infrastructure world we're moving away from well we're moving away from small systems we're moving we're moving towards eating large clusters of compute",
    "start": "2494890",
    "end": "2502150"
  },
  {
    "text": "capacity and a lot of people are putting effort into this and so people have",
    "start": "2502150",
    "end": "2507220"
  },
  {
    "text": "written a ton of mezzos frameworks which is pretty cool there's these task schedulers there's marathon twitter has",
    "start": "2507220",
    "end": "2512260"
  },
  {
    "text": "their own which is fantastic I mean it's pretty much feature comparable with marathon called",
    "start": "2512260",
    "end": "2518530"
  },
  {
    "text": "Aurora you can run Hadoop on it spark storm Chronos Chronos is an airbnb",
    "start": "2518530",
    "end": "2524589"
  },
  {
    "text": "project for running cron type jobs on your mezzos cluster people are doing",
    "start": "2524589",
    "end": "2530339"
  },
  {
    "text": "file file systems or data stores so you can get frameworks for HDFS twitter's",
    "start": "2530339",
    "end": "2537609"
  },
  {
    "text": "just released one called my Zoe's for running my sequel on mezzos imagine not setting up individual my sequel servers",
    "start": "2537609",
    "end": "2543970"
  },
  {
    "text": "and just having this giant mezzos cluster that runs all your various workloads and you're saying and you're",
    "start": "2543970",
    "end": "2548980"
  },
  {
    "text": "like click I want like my sequel and it automatically deploys in you know replication topologies to appropriate",
    "start": "2548980",
    "end": "2555790"
  },
  {
    "text": "machines it's pretty it's pretty amazing with like the resource isolation that you would need their hyper table",
    "start": "2555790",
    "end": "2562059"
  },
  {
    "text": "Cassandra you can get elasticsearch framework there's a Jenkins framework so you can just spin up your Jenkins slaves",
    "start": "2562059",
    "end": "2567609"
  },
  {
    "text": "really easily on ms-dos cluster and then there's these cray this Chapel language",
    "start": "2567609",
    "end": "2574270"
  },
  {
    "text": "there's these parallel programming languages that have been essentially ported to work on under the mezzos",
    "start": "2574270",
    "end": "2580540"
  },
  {
    "text": "framework to use that portion resources out the mesosphere guys are doing a",
    "start": "2580540",
    "end": "2585579"
  },
  {
    "text": "pretty amazing job with this there in San Francisco venture-backed group of some I think Twitter employees and",
    "start": "2585579",
    "end": "2593170"
  },
  {
    "text": "people from all over and they are there really they're really focused on",
    "start": "2593170",
    "end": "2599829"
  },
  {
    "text": "advancing the state of the art with with mezzos which is which is pretty cool to",
    "start": "2599829",
    "end": "2605440"
  },
  {
    "text": "see so the long journey to get here we",
    "start": "2605440",
    "end": "2614559"
  },
  {
    "start": "2607000",
    "end": "2807000"
  },
  {
    "text": "start from this simple shell pipeline advanced to these higher high level",
    "start": "2614559",
    "end": "2621280"
  },
  {
    "text": "language dsl's that that automate a lot of the nitty gritty nuts and bolts of",
    "start": "2621280",
    "end": "2628270"
  },
  {
    "text": "these systems for us then once you get to a certain scale you really need to invert the control flow so instead of a",
    "start": "2628270",
    "end": "2633760"
  },
  {
    "text": "push model you have sort of a pull model then you sort of want to once you get to",
    "start": "2633760",
    "end": "2639099"
  },
  {
    "text": "even greater scale you kind of want to start abstracting away even the concept of individual servers to some degree as",
    "start": "2639099",
    "end": "2644349"
  },
  {
    "text": "much as you can building on the blocks you already have have so that that's so that you don't",
    "start": "2644349",
    "end": "2651500"
  },
  {
    "text": "have to you don't have to think about a million things going wrong at once you just think about the health of the whole",
    "start": "2651500",
    "end": "2658060"
  },
  {
    "text": "and then you also have to work on these higher availability distribution models as you get there since one server will",
    "start": "2658060",
    "end": "2665030"
  },
  {
    "text": "will not be able to feed out code to your your thousands of servers in your infrastructure which of course is a good",
    "start": "2665030",
    "end": "2671240"
  },
  {
    "text": "problem to have so go forth and deploy like an evil genius and we're a couple",
    "start": "2671240",
    "end": "2676850"
  },
  {
    "text": "minutes early happy to take any questions if there are any on this titillating top I guess sir sorry for",
    "start": "2676850",
    "end": "2688730"
  },
  {
    "text": "your auto scaling framework for May so sir using like some sort of complex event processing system for that light drills fusion or a great question i have",
    "start": "2688730",
    "end": "2697190"
  },
  {
    "text": "an intern who started on a week ago today who's like a junior and he we're",
    "start": "2697190",
    "end": "2705950"
  },
  {
    "text": "going very simple to start with we we've set up monitoring essentially so that on",
    "start": "2705950",
    "end": "2711850"
  },
  {
    "text": "each worker node on each slave node we are reporting in to our central stat",
    "start": "2711850",
    "end": "2718760"
  },
  {
    "text": "server utilization metrics for all the instances running on that particular worker node and then there's an",
    "start": "2718760",
    "end": "2724370"
  },
  {
    "text": "aggregate in that stat server you know on a graphite server that says you know 95th percentile cpu utilization for",
    "start": "2724370",
    "end": "2731150"
  },
  {
    "text": "service a is seventy percent and we are right now it's literally pull that out",
    "start": "2731150",
    "end": "2736760"
  },
  {
    "text": "or maybe look at the five-minute ten-minute trailing average and then and and have a target in mind oh I want this",
    "start": "2736760",
    "end": "2745010"
  },
  {
    "text": "to be this should always be at sixty percent utilization and then if it's off from that calculate based on the number",
    "start": "2745010",
    "end": "2754160"
  },
  {
    "text": "of CPUs that each instance gets and the number of instances that are currently",
    "start": "2754160",
    "end": "2759350"
  },
  {
    "text": "deployed either need to scale up this much or scale down this much so you know first revision it just spits out a",
    "start": "2759350",
    "end": "2765140"
  },
  {
    "text": "recommendation second revision will have it actually like make the change itself",
    "start": "2765140",
    "end": "2770290"
  },
  {
    "text": "and then we'll sort of make it more sophisticated let it react more quickly you know first you want to be really",
    "start": "2770290",
    "end": "2776450"
  },
  {
    "text": "very careful with this because I have you know this kid sitting next to me he was controlling like ubers",
    "start": "2776450",
    "end": "2782420"
  },
  {
    "text": "infrastructure which it turns out the management is sort of sensitive about and so yeah that's that's sort of our",
    "start": "2782420",
    "end": "2789589"
  },
  {
    "text": "model I think it'll be a little while before we get into sort of a more sophisticated like you know controller",
    "start": "2789589",
    "end": "2797059"
  },
  {
    "text": "mechanism for doing that and make that make the math more interesting but that'll be there for sure at some point",
    "start": "2797059",
    "end": "2804730"
  }
]