[
  {
    "text": "all right so let's talk about building a distributed build system at Google scale",
    "start": "12170",
    "end": "17460"
  },
  {
    "text": "and Before we jump into it let's discuss with Google scale means usually when",
    "start": "17460",
    "end": "23220"
  },
  {
    "text": "people say Google scale it's meant to sound impressive and you know like that.you system proved itself because it can support the Google scale so let's",
    "start": "23220",
    "end": "30269"
  },
  {
    "text": "see what it actually means in numbers so we have 30,000 engineers in over 40",
    "start": "30269",
    "end": "36180"
  },
  {
    "text": "offices and the distributive build system that I work on is supports all of",
    "start": "36180",
    "end": "41970"
  },
  {
    "text": "those engineers across the globe and there is a roughly 45,000 Kamil's bad",
    "start": "41970",
    "end": "47909"
  },
  {
    "text": "are submitted to the codebase every day 15,000 of those are by humans by Google",
    "start": "47909",
    "end": "53610"
  },
  {
    "text": "engineers and then 30,000 are by automated scripts so these are the release scripts these are the",
    "start": "53610",
    "end": "59850"
  },
  {
    "text": "integration automation scripts that change the configuration and so on and",
    "start": "59850",
    "end": "65158"
  },
  {
    "text": "so on you may be surprised to hear the following but even though we have lots",
    "start": "65159",
    "end": "70950"
  },
  {
    "text": "of talented engineers it's every time I works on any large system it felt like",
    "start": "70950",
    "end": "76049"
  },
  {
    "text": "we never had enough people so if I have to do something twice this just becomes very annoying and so I try to automate",
    "start": "76049",
    "end": "83789"
  },
  {
    "text": "that as much as possible and that's you know where our reliance on the automated scripts comes in the source code is",
    "start": "83789",
    "end": "91950"
  },
  {
    "text": "roughly 2 billion lines of code so that means the distributed build system needs to be able to support building all those",
    "start": "91950",
    "end": "98009"
  },
  {
    "text": "2 billion lines of codes in the binaries and so on and every day about half of",
    "start": "98009",
    "end": "103679"
  },
  {
    "text": "the codebase changes so that means 1 billion lines of code changes need to be",
    "start": "103679",
    "end": "108929"
  },
  {
    "text": "constantly compiled tested builds released and so on so distributed build",
    "start": "108929",
    "end": "115289"
  },
  {
    "text": "system at Google is code build rabid and it roughly gets 5 million build and test",
    "start": "115289",
    "end": "121710"
  },
  {
    "text": "requests per day and it generates petabytes of artifacts these build",
    "start": "121710",
    "end": "127859"
  },
  {
    "text": "artifacts are the binaries that your build system generates these are the binaries that the tests are being run",
    "start": "127859",
    "end": "134910"
  },
  {
    "text": "against and so on and all of this is done in one repository",
    "start": "134910",
    "end": "140040"
  },
  {
    "text": "when they sow the open source bill tool from Google came out and there was a",
    "start": "140040",
    "end": "145830"
  },
  {
    "text": "mention of the monolithic repository that we use there's a lot of questions and a lot of confusion haven't we moved",
    "start": "145830",
    "end": "152940"
  },
  {
    "text": "away from monolithic repositories what are we doing here why why does Google use one repository so let me take a bit",
    "start": "152940",
    "end": "159450"
  },
  {
    "text": "of an aside and clarify the advantages of why we use it and why it works so",
    "start": "159450",
    "end": "164760"
  },
  {
    "text": "well for us so what it's like to work in one repository",
    "start": "164760",
    "end": "169830"
  },
  {
    "text": "so first of all it's very easy to have a linear revision history so when am I",
    "start": "169830",
    "end": "175140"
  },
  {
    "text": "when the system is failing in production and I want to figure out which of the reveal versions of the binary was",
    "start": "175140",
    "end": "181709"
  },
  {
    "text": "released and which of the code did are going to this release and which didn't it would be very confusing how to try to",
    "start": "181709",
    "end": "188100"
  },
  {
    "text": "match up all the different libraries and all the difference other binaries that will lengthen into my binary to figure",
    "start": "188100",
    "end": "193860"
  },
  {
    "text": "out what code is running but having linear revision history just makes it very easier to be able to tell okay this",
    "start": "193860",
    "end": "200640"
  },
  {
    "text": "is where was the cutoff for what we release and everything is grants",
    "start": "200640",
    "end": "207180"
  },
  {
    "text": "reference as you might imagine Google's code base is polyglots so the code is written in Java C++ Python girl and a",
    "start": "207180",
    "end": "215070"
  },
  {
    "text": "few other languages and being able to reference and being able to find use and",
    "start": "215070",
    "end": "220829"
  },
  {
    "text": "Co sites across the code base across all the different languages it's incredibly important for us to be to be able to",
    "start": "220829",
    "end": "227280"
  },
  {
    "text": "track the history figure out what the use cases are how our clients use the code and so on and you may be wondering",
    "start": "227280",
    "end": "236250"
  },
  {
    "text": "how exactly do can we prevent that releases a work-in-progress versions of libraries get from getting out so for",
    "start": "236250",
    "end": "243030"
  },
  {
    "text": "that we use components it's similar to get sub tree or get sub components can you raise of hands for people who are",
    "start": "243030",
    "end": "249000"
  },
  {
    "text": "using it okay I see if your hands yeah so it's basically it's to be able to",
    "start": "249000",
    "end": "254130"
  },
  {
    "text": "tell what is the vetted good version by the library team and what is the work-in-progress version so if I'm",
    "start": "254130",
    "end": "259979"
  },
  {
    "text": "realigning some sort of library that does string manipulation I don't really care to use the you know the previous",
    "start": "259979",
    "end": "267419"
  },
  {
    "text": "version or differentiate between the versions oh I care about what was the last vetted good version for this",
    "start": "267419",
    "end": "272970"
  },
  {
    "text": "library and then just move on and if I'm interested in building for ahead for",
    "start": "272970",
    "end": "277980"
  },
  {
    "text": "their unreleased versions I can also do that by just relying on the work-in-progress versions as well and",
    "start": "277980",
    "end": "283950"
  },
  {
    "text": "work in progress versions are similar to snapshots if you are in the Java world and you're using maven and the whole",
    "start": "283950",
    "end": "291540"
  },
  {
    "text": "ecosystem so honestly if you think about it having a central repository of",
    "start": "291540",
    "end": "297960"
  },
  {
    "text": "artifacts the way maven is central for instance does it and having something",
    "start": "297960",
    "end": "303030"
  },
  {
    "text": "that you can build from source from a monolithic repository it's just two sides of the same coin",
    "start": "303030",
    "end": "308100"
  },
  {
    "text": "there are some advantages to having to being able to build from source such as",
    "start": "308100",
    "end": "313590"
  },
  {
    "text": "having predictable repeatable builds from source so for instance if the",
    "start": "313590",
    "end": "320640"
  },
  {
    "text": "reporter if the artifact gets corrupted in maven repository then we would have",
    "start": "320640",
    "end": "326430"
  },
  {
    "text": "to be able to detect this and we could store md5 hashes and prevent and it",
    "start": "326430",
    "end": "331920"
  },
  {
    "text": "prevents us downloading something that we don't want to download corrupted files or prevent us help us detect if",
    "start": "331920",
    "end": "340470"
  },
  {
    "text": "the binary is what it claims to be with doing it from source we know that every",
    "start": "340470",
    "end": "346140"
  },
  {
    "text": "single time at the given revision it's going to be the same binary over and over again and also when we give it",
    "start": "346140",
    "end": "352020"
  },
  {
    "text": "different flags when we're compiling with different options we want to make sure that it always produces the same",
    "start": "352020",
    "end": "358160"
  },
  {
    "text": "binary there's lots of optimizations to avoid having to compile the same",
    "start": "358160",
    "end": "364350"
  },
  {
    "text": "artifacts over and over again so we don't actually end up paying the cost of",
    "start": "364350",
    "end": "370080"
  },
  {
    "text": "building from source over and over so for a lot of base libraries we'll just end up storing them and cashing them and",
    "start": "370080",
    "end": "375360"
  },
  {
    "text": "reusing them for all the other builds that advantage of building from sources",
    "start": "375360",
    "end": "380640"
  },
  {
    "text": "that we can decouple each team's process as much as possible so if I'm interested",
    "start": "380640",
    "end": "386700"
  },
  {
    "text": "in writing a new service that relies on the unreleased but in the future very useful service to me or using a client",
    "start": "386700",
    "end": "394980"
  },
  {
    "text": "library that was not released yet I can do so without having to negotiate without having to coordinate with many",
    "start": "394980",
    "end": "401490"
  },
  {
    "text": "other different teams and figure out what exactly is that library",
    "start": "401490",
    "end": "406939"
  },
  {
    "text": "when is that client ready so that I can use it for my own use cases you can",
    "start": "406939",
    "end": "412949"
  },
  {
    "text": "learn more about how the source system works in Rachel Parsons talk that she gave at scale I wouldn't go too much",
    "start": "412949",
    "end": "418620"
  },
  {
    "text": "into detail about the source system because today we'll talk about distributed build system which is built",
    "start": "418620",
    "end": "423719"
  },
  {
    "text": "on top of that and uses the source system so we discussed for Google scale",
    "start": "423719",
    "end": "429120"
  },
  {
    "text": "means and what challenges it presents just given the sheer number of people",
    "start": "429120",
    "end": "434939"
  },
  {
    "text": "working on a sheer number of people contributing to the code base as well as the size of the code base so let's talk",
    "start": "434939",
    "end": "441029"
  },
  {
    "text": "about the distributed build system how many people in the audience have a pretty good idea for the distributed",
    "start": "441029",
    "end": "446430"
  },
  {
    "text": "build system does alright well hopefully a little bit more of you by the end of this talk so honestly not every team not",
    "start": "446430",
    "end": "456509"
  },
  {
    "text": "every organization will ever reach the point of needing a distributed build system it serves a very specific problem",
    "start": "456509",
    "end": "463999"
  },
  {
    "text": "for people so let's look at what the evolution is generally up from the",
    "start": "463999",
    "end": "469469"
  },
  {
    "text": "single desktop bill to to a distributed build system so to begin with we'll have",
    "start": "469469",
    "end": "475830"
  },
  {
    "text": "one a software engineer working on a project and the project is in green and",
    "start": "475830",
    "end": "482159"
  },
  {
    "text": "maybe they're doing some sort of computer vision projects they'll be relying on the opencv so they built two",
    "start": "482159",
    "end": "487830"
  },
  {
    "text": "will go fetch if OpenCV dependency from the clouds and then link it and build it",
    "start": "487830",
    "end": "493409"
  },
  {
    "text": "for them and now they'll have the local version of open CD on their desktop so",
    "start": "493409",
    "end": "500159"
  },
  {
    "text": "now to make sure we're on the same page let's talk about what build means what",
    "start": "500159",
    "end": "505680"
  },
  {
    "text": "does it mean to build a binary and what does it mean to test so your typical",
    "start": "505680",
    "end": "510930"
  },
  {
    "text": "build scenario goes as follows so we have a project with dependencies defined and your dependencies may be defining",
    "start": "510930",
    "end": "517409"
  },
  {
    "text": "some sort of domain-specific language usually people start an XML or llamo and",
    "start": "517409",
    "end": "524459"
  },
  {
    "text": "then a build tool which is worse than one single desktop will find those",
    "start": "524459",
    "end": "529470"
  },
  {
    "text": "dependencies and this bill could be maven make Gradle I'm guessing the audience's",
    "start": "529470",
    "end": "536430"
  },
  {
    "text": "familiar with those tools and his use them can I see short of hand whoo okay great everybody awesome so",
    "start": "536430",
    "end": "542859"
  },
  {
    "text": "then so this bill to a wall build a project with the dependencies and then it will download the build artifacts and",
    "start": "542859",
    "end": "548649"
  },
  {
    "text": "now once I have the build artifact that's the binder that I can use to release it and so on now for the test",
    "start": "548649",
    "end": "556059"
  },
  {
    "text": "scenario who basically you go through almost the same steps who are will have it defined a project with dependencies",
    "start": "556059",
    "end": "561309"
  },
  {
    "text": "and the Builder will be able to find those dependencies and build them for us but the binary itself is not quite as",
    "start": "561309",
    "end": "568089"
  },
  {
    "text": "useful for us in the testing era but we want to do is we want to run the test and then the output that we interested",
    "start": "568089",
    "end": "573970"
  },
  {
    "text": "in is getting the results of the test okay so now that we are on the same page",
    "start": "573970",
    "end": "579669"
  },
  {
    "text": "about what I mean when I say building and testing let's move to the Hulk the",
    "start": "579669",
    "end": "586119"
  },
  {
    "text": "build system evolves over time so we'll have one person working on a project",
    "start": "586119",
    "end": "591249"
  },
  {
    "text": "that gets very very popular so or maybe gets organizational support and now our",
    "start": "591249",
    "end": "596349"
  },
  {
    "text": "team is working on it and the team will have to maintain its own machines own serve on the side that will be doing all",
    "start": "596349",
    "end": "603159"
  },
  {
    "text": "the builds and releases and would be integrating with all the continuous integration frameworks like Jenkins and",
    "start": "603159",
    "end": "610589"
  },
  {
    "text": "so on so now a different team in the same organization if it's a computer",
    "start": "610589",
    "end": "617259"
  },
  {
    "text": "vision company I will probably also rely on open CV and I will have to build that",
    "start": "617259",
    "end": "622899"
  },
  {
    "text": "in have a dependency on that and build their projects and then get another team and so what we see here is that every",
    "start": "622899",
    "end": "629769"
  },
  {
    "text": "single team has to have their own machine set aside were now they need to",
    "start": "629769",
    "end": "635109"
  },
  {
    "text": "understand and deal with the overhead of maintaining operating and keeping",
    "start": "635109",
    "end": "641379"
  },
  {
    "text": "up-to-date and fixing all the bodies on their build system at which point the",
    "start": "641379",
    "end": "647079"
  },
  {
    "text": "team spent some fraction of their time instead of working on the project where their skills and talents are most useful",
    "start": "647079",
    "end": "652569"
  },
  {
    "text": "on doing this so this is the time when team like mine will come in and provide",
    "start": "652569",
    "end": "658119"
  },
  {
    "text": "the shared infrastructure for the teams so now we will actually maintain operate",
    "start": "658119",
    "end": "665289"
  },
  {
    "text": "the system the distributed build system and then the teams can just come in and request to build and test their projects",
    "start": "665289",
    "end": "671559"
  },
  {
    "text": "and they will just get the results in the Carib so if you have teams of machine learning experts they can just focus on building",
    "start": "671559",
    "end": "679310"
  },
  {
    "text": "the best models that they have instead of worrying about all the infrastructure details and this infrastructure that I'm",
    "start": "679310",
    "end": "687290"
  },
  {
    "text": "talking about here is very similar to the kind of infrastructure that Travis CI would be using people use Travis CI",
    "start": "687290",
    "end": "695510"
  },
  {
    "text": "in the audience anybody okay yeah great tool so let's talk about build Abbott",
    "start": "695510",
    "end": "704000"
  },
  {
    "text": "the googles distributed build system is you can see it in a way as being based",
    "start": "704000",
    "end": "709820"
  },
  {
    "text": "on the clouds so bezel is the open source Google's internal built oh that",
    "start": "709820",
    "end": "716060"
  },
  {
    "text": "was open source last year and build avid basically builds a distribute layer on top of that so what does build a Badou",
    "start": "716060",
    "end": "730300"
  },
  {
    "text": "barabbas it's in the middle of the build and test stack of the infrastructure so",
    "start": "730300",
    "end": "736820"
  },
  {
    "text": "the types of teams and projects that would be using build rabbit our continuous integration system to be able",
    "start": "736820",
    "end": "742970"
  },
  {
    "text": "to run the test release infrastructure to build and then fetch the binary fetch",
    "start": "742970",
    "end": "748490"
  },
  {
    "text": "the artifacts that the release infrastructure will later on deploy and so on individual Google engineers as",
    "start": "748490",
    "end": "755180"
  },
  {
    "text": "well as teams that are there can't use any of the other existing builds and",
    "start": "755180",
    "end": "760550"
  },
  {
    "text": "test infrastructure and they're trying to do something else with the build system and also the integration testing",
    "start": "760550",
    "end": "766430"
  },
  {
    "text": "infrastructure that will be able to call the build and then set up all the environment that you need for the",
    "start": "766430",
    "end": "771770"
  },
  {
    "text": "integration testing and run the tests on it and I'll build a bit itself relies on",
    "start": "771770",
    "end": "776810"
  },
  {
    "text": "many different components so first of all and you it will need to get fetch the codes the source code at the",
    "start": "776810",
    "end": "784310"
  },
  {
    "text": "revision that a client requested from the source system and as I mention you",
    "start": "784310",
    "end": "789410"
  },
  {
    "text": "can learn more about the source system at Google from Rachel pots let's talk at scale and I'll link it later in the",
    "start": "789410",
    "end": "796970"
  },
  {
    "text": "slides and so build rapid sits on top of blaze basically it's a distributed layer on top of blaze that's the internal tool",
    "start": "796970",
    "end": "803900"
  },
  {
    "text": "known as beso and external world and then blaze will perform the builds for us and then it will put all those",
    "start": "803900",
    "end": "810769"
  },
  {
    "text": "artifacts into the build artifact storage and though I would be able to serve those artifacts to the user",
    "start": "810769",
    "end": "815839"
  },
  {
    "text": "requesting them so bill rabbit sits very nicely in this middle of the stack performing specifically the builds and",
    "start": "815839",
    "end": "823190"
  },
  {
    "text": "tests and dealing with a distributed layer for the build and test needs so we",
    "start": "823190",
    "end": "830360"
  },
  {
    "text": "talked about what distributed build system is we talked about all the different challenges that it has to deal",
    "start": "830360",
    "end": "837230"
  },
  {
    "text": "with because it has to work at Google scale so let's talk about actually building they build system and",
    "start": "837230",
    "end": "843459"
  },
  {
    "text": "specifically we'll talk about evolution of build Rabbid you can think about it",
    "start": "843459",
    "end": "848690"
  },
  {
    "text": "as the architecture has evolved from being a push to pull model and we'll see",
    "start": "848690",
    "end": "855620"
  },
  {
    "text": "why in a second so bill rabbit started out as an experimental project and it",
    "start": "855620",
    "end": "860870"
  },
  {
    "text": "very quickly turned to become a key piece of Go Go's developing infrastructure so there was a lot of different teams that needed this and",
    "start": "860870",
    "end": "867970"
  },
  {
    "text": "apparently they needed soon and we thought and so the initial design of it",
    "start": "867970",
    "end": "873980"
  },
  {
    "text": "the initial architecture was very simple and rightfully so because it didn't need to be any more complex because at the",
    "start": "873980",
    "end": "879740"
  },
  {
    "text": "time I was being built we didn't know who'd be using it and where the need would be and so it was built as a simple",
    "start": "879740",
    "end": "886610"
  },
  {
    "text": "push model where we have a client for user as a pretty sick client and oh it",
    "start": "886610",
    "end": "893329"
  },
  {
    "text": "needs to do send the build work at the test request to the build I worker and",
    "start": "893329",
    "end": "898399"
  },
  {
    "text": "given that the client library soda pretty thick thick then we upload a lot",
    "start": "898399",
    "end": "904430"
  },
  {
    "text": "of the discovery and load balancing concerns to the build a bit scheduler now there are couple issues with this",
    "start": "904430",
    "end": "912110"
  },
  {
    "text": "design that we discovered later as we started pushing the ceiling of the scalability that we could provide and",
    "start": "912110",
    "end": "917660"
  },
  {
    "text": "that's the routing so given that we have a thick line it needs to understand a",
    "start": "917660",
    "end": "923870"
  },
  {
    "text": "lot of different build system specific concerns and also in order for it you do",
    "start": "923870",
    "end": "930589"
  },
  {
    "text": "routing it needs to do a lot of their understanding of the scheduler responses and figuring out what it means for the",
    "start": "930589",
    "end": "938449"
  },
  {
    "text": "systems avail ability and so on so the internal routing becomes very difficult there is",
    "start": "938449",
    "end": "943470"
  },
  {
    "text": "a pretty complicated a communication protocol because all the different outputs that the client might be",
    "start": "943470",
    "end": "948929"
  },
  {
    "text": "interested in such as artifacts that they will request from the worker and also they build progress information so",
    "start": "948929",
    "end": "956970"
  },
  {
    "text": "if we're running a test and there's 100 tests and our test suite we want to see which of the tests actually failed of",
    "start": "956970",
    "end": "962160"
  },
  {
    "text": "those 100 and they would get this information again over the same channel from the worker and so when we started",
    "start": "962160",
    "end": "970769"
  },
  {
    "text": "hitting the scalability ceiling we will move to the pool motto which would call boat service so it roughly looks this",
    "start": "970769",
    "end": "978389"
  },
  {
    "text": "way so let me walk you all through this so basically now the user instead of",
    "start": "978389",
    "end": "984269"
  },
  {
    "text": "making the recognition to the schedule a direct connection to the worker they will be putting it into the persistent",
    "start": "984269",
    "end": "990209"
  },
  {
    "text": "queue they build a quest because at the end of the day user doesn't actually care to talk to the worker immediately",
    "start": "990209",
    "end": "996089"
  },
  {
    "text": "what they care about is that their builds and tests request gets executed at some point in the near future and",
    "start": "996089",
    "end": "1001369"
  },
  {
    "text": "they just want to know what's going on with it is it still and cute is it being processed what's going on",
    "start": "1001369",
    "end": "1006410"
  },
  {
    "text": "and so now they will put it into the persistent queue and then at some point when there is capacity build a bit of",
    "start": "1006410",
    "end": "1012889"
  },
  {
    "text": "work what would you cured and then it will start streaming they build progress information to a separate service that",
    "start": "1012889",
    "end": "1019519"
  },
  {
    "text": "is responsible for storing and serving the build progress and also any of the",
    "start": "1019519",
    "end": "1025220"
  },
  {
    "text": "artifacts that are created by the build system will be put into a different service so that the user can retrieve",
    "start": "1025220",
    "end": "1032209"
  },
  {
    "text": "those build artifacts later and so now the user if they're actually interested in the build progress then they can",
    "start": "1032209",
    "end": "1039620"
  },
  {
    "text": "subscribe they can opt-in to get the information about the progress of the build and they may may not be interested",
    "start": "1039620",
    "end": "1046130"
  },
  {
    "text": "in getting the binary back so if they doing the test in the testing scenario they don't actually care about the binary so then they will just request it",
    "start": "1046130",
    "end": "1054230"
  },
  {
    "text": "if they need it if they're actually trying to do releases from the build artifacts storage so for once I can go",
    "start": "1054230",
    "end": "1064610"
  },
  {
    "text": "back specifically for the rest of the talk I'll talk about how we re architected and specifically how we r e",
    "start": "1064610",
    "end": "1070970"
  },
  {
    "text": "architected the parts where the user was put the request into the persistent cure and then the bilderberg workers started to",
    "start": "1070970",
    "end": "1077670"
  },
  {
    "text": "queuing those requests after the persistent queue I actually led the launch for this part of reworking the",
    "start": "1077670",
    "end": "1083550"
  },
  {
    "text": "execution engine and it was an efforts across five different teams in three different geographic zones and two",
    "start": "1083550",
    "end": "1089850"
  },
  {
    "text": "different time zones and one thing that was very tricky for us is we didn't have",
    "start": "1089850",
    "end": "1095670"
  },
  {
    "text": "the luxury of having a downtime we couldn't just tell people just wait a couple hours like maybe on Saturday on",
    "start": "1095670",
    "end": "1102180"
  },
  {
    "text": "Sunday let me just rebuilt our system and launch a new one so given those concerns",
    "start": "1102180",
    "end": "1109950"
  },
  {
    "text": "it very much felt like having to replace a jet engine and it flies and I tried to",
    "start": "1109950",
    "end": "1115830"
  },
  {
    "text": "search online for the images that would really communicate well what that task",
    "start": "1115830",
    "end": "1121320"
  },
  {
    "text": "was about and the only thing I could find is Aero refueling so apparently you can't refuel a plane in midair but you",
    "start": "1121320",
    "end": "1128220"
  },
  {
    "text": "can replace a jet engine so I had to draw something to represent really what it felt like it that was probably me",
    "start": "1128220",
    "end": "1136920"
  },
  {
    "text": "trying to you know figure out how to launch that thing and replace that while I was still flying and keep it flying",
    "start": "1136920",
    "end": "1142940"
  },
  {
    "text": "so to recap a bit so the architecture tube went from is very simple client",
    "start": "1142940",
    "end": "1150000"
  },
  {
    "text": "push model request the scheduler finds the worker pushes the work onto the worker and then gets the results back",
    "start": "1150000",
    "end": "1155940"
  },
  {
    "text": "and then the architecture that we move to is there this built service the pool model where the user would just put the",
    "start": "1155940",
    "end": "1163680"
  },
  {
    "text": "work on the persistent queue and then the worker will pull the work and then reports all the different things and",
    "start": "1163680",
    "end": "1169260"
  },
  {
    "text": "then when the user interested if the user is interested in their different outputs then they would take them when",
    "start": "1169260",
    "end": "1174390"
  },
  {
    "text": "they need them if they need them and actually I should say so as I mentioned",
    "start": "1174390",
    "end": "1179580"
  },
  {
    "text": "a little earlier client was able to get they built progress information as well as their artifacts by connecting",
    "start": "1179580",
    "end": "1186000"
  },
  {
    "text": "directly to the worker and so now we split that up into two different components so they build artifact system",
    "start": "1186000",
    "end": "1192000"
  },
  {
    "text": "as well as the build progress enforce service all of those are done maintained",
    "start": "1192000",
    "end": "1198570"
  },
  {
    "text": "and developed by my team so how did we",
    "start": "1198570",
    "end": "1203660"
  },
  {
    "text": "reimplemented rhe architected build system zero downtime how did we manage to",
    "start": "1203660",
    "end": "1208960"
  },
  {
    "text": "switch out our engine and with fluid for the rest of the talk I would talk about some of the challenges and how we",
    "start": "1208960",
    "end": "1214480"
  },
  {
    "text": "actually achieve this with actually zero downtime which is honestly surprising to",
    "start": "1214480",
    "end": "1219490"
  },
  {
    "text": "me ice I'm still recovering from the fact that it actually happened so so the",
    "start": "1219490",
    "end": "1225070"
  },
  {
    "text": "first thing that was very important to us is to be able to migrate back ends first because we started hitting the",
    "start": "1225070",
    "end": "1231100"
  },
  {
    "text": "scalability limits we're now our users were no longer able to use to the extent",
    "start": "1231100",
    "end": "1237190"
  },
  {
    "text": "that they wanted to it was important that we prove that our back hands actually able to withstand the load and",
    "start": "1237190",
    "end": "1243540"
  },
  {
    "text": "are scalable to the when we need them accounting for growth as well so by",
    "start": "1243540",
    "end": "1249400"
  },
  {
    "text": "migrating in the backend first it allows us to prove that every single part of",
    "start": "1249400",
    "end": "1254620"
  },
  {
    "text": "the system is actually up to speed and has room for growth the opposite would",
    "start": "1254620",
    "end": "1260620"
  },
  {
    "text": "have been if we decided to just rebuild the client and give it to the new user what would happen in that case well first of all if we realize that our",
    "start": "1260620",
    "end": "1268330"
  },
  {
    "text": "implementation or our even architecture of the backends was not sufficient for the load then what have to tell the",
    "start": "1268330",
    "end": "1274960"
  },
  {
    "text": "client to go back oh can you use the one from two weeks ago oh no no that one is also bad can you go back from four weeks",
    "start": "1274960",
    "end": "1280900"
  },
  {
    "text": "ago and given they all the different Google engineering teams that are using this they which would create enormous",
    "start": "1280900",
    "end": "1287200"
  },
  {
    "text": "amount of communication overhead that was just not feasible that did not make",
    "start": "1287200",
    "end": "1292270"
  },
  {
    "text": "sense so we needed to focus on the backends and prove that they can support the new loads before we consider the",
    "start": "1292270",
    "end": "1299410"
  },
  {
    "text": "launch successful and then we needed to create a lot of throw of the codes",
    "start": "1299410",
    "end": "1304450"
  },
  {
    "text": "because our clients rely on our system to be running and I will talk about",
    "start": "1304450",
    "end": "1309940"
  },
  {
    "text": "compatibility window in a second but for backwards compatibility we need to make sure that with new features and with new",
    "start": "1309940",
    "end": "1316980"
  },
  {
    "text": "implementation we the outputs that we produce to the clients from the users perspective are no worse than what we",
    "start": "1316980",
    "end": "1323770"
  },
  {
    "text": "used to and our compatibility window is actually several months so what that means is if the user is using a client",
    "start": "1323770",
    "end": "1331809"
  },
  {
    "text": "library from six months ago they expect that their outputs are at least as good as even if we switched off the backhands",
    "start": "1331809",
    "end": "1339610"
  },
  {
    "text": "and the other challenge is that not always can you actually tell can you actually compare apples to apples the",
    "start": "1339610",
    "end": "1346120"
  },
  {
    "text": "different outputs because you're architected system the system operates very differently and so and so it's very",
    "start": "1346120",
    "end": "1356020"
  },
  {
    "text": "important to make sure that we can run this analysis and figure out what does it even mean to compare the two",
    "start": "1356020",
    "end": "1362110"
  },
  {
    "text": "different types of outputs in order to enable this we needed to target launch",
    "start": "1362110",
    "end": "1368080"
  },
  {
    "text": "friendly clients before actually transitioning everyone so as I mentioned",
    "start": "1368080",
    "end": "1373930"
  },
  {
    "text": "there is three different backends that we work on and I worked on the bill rabbit like the execution engine and it",
    "start": "1373930",
    "end": "1379840"
  },
  {
    "text": "securing from a persisting queue and then the builds off facts and build progress service and what was",
    "start": "1379840",
    "end": "1388210"
  },
  {
    "text": "interesting is if we discovered their different clients they were actually more amenable to us making this changes",
    "start": "1388210",
    "end": "1394570"
  },
  {
    "text": "so for the secure we found that a another developer infrastructure team",
    "start": "1394570",
    "end": "1401020"
  },
  {
    "text": "was willing to put the effort it was actually needed this to happen and so they were able to help us out and by",
    "start": "1401020",
    "end": "1407650"
  },
  {
    "text": "having a shared experience shared lingo shared vocabulary about the different",
    "start": "1407650",
    "end": "1412990"
  },
  {
    "text": "challenges and also shared concerns we were able to do the launch successfully",
    "start": "1412990",
    "end": "1418420"
  },
  {
    "text": "because both the user and us were interested in the success of this and for build artifacts on the other hand",
    "start": "1418420",
    "end": "1425590"
  },
  {
    "text": "there was a different client that was actually friendly towards the launch which was the deploy system and the",
    "start": "1425590",
    "end": "1432460"
  },
  {
    "text": "release system and we were able to work much more closely with them so for each of the components there was a different",
    "start": "1432460",
    "end": "1438910"
  },
  {
    "text": "launch friendly client and we needed to make sure that we do a good job for them",
    "start": "1438910",
    "end": "1444100"
  },
  {
    "text": "first before we can say okay the system is good enough to launch for everyone else and what this meant is we needed to",
    "start": "1444100",
    "end": "1450640"
  },
  {
    "text": "decouple launch of services if we had to rely on all the three different components being ready at the same time",
    "start": "1450640",
    "end": "1456580"
  },
  {
    "text": "what that means is that would probably not have launched anytime soon because",
    "start": "1456580",
    "end": "1461770"
  },
  {
    "text": "every single component would have its different robots at different points in time and so relying on everyone to be",
    "start": "1461770",
    "end": "1468220"
  },
  {
    "text": "ready at the same point and providing the same quality which is unreasonable so and",
    "start": "1468220",
    "end": "1473580"
  },
  {
    "text": "given that we had all the three different types of users that we targeting for the launch we needed to",
    "start": "1473580",
    "end": "1480840"
  },
  {
    "text": "work under the assumption that none of the other news services will be ever ready for us and that also went with the",
    "start": "1480840",
    "end": "1487980"
  },
  {
    "text": "lots of throwaway code that was written for the transition when we needed to anticipate all the old scenarios and",
    "start": "1487980",
    "end": "1494130"
  },
  {
    "text": "then if these two services were up if one of them was up and so on and so on all the different permutations just all",
    "start": "1494130",
    "end": "1500700"
  },
  {
    "text": "these bridges on top of bridges just so we could launch with high confidence another important thing for the launch",
    "start": "1500700",
    "end": "1508320"
  },
  {
    "text": "was having maximum visibility into the system state as a distributed systems engineer the least interesting thing I",
    "start": "1508320",
    "end": "1514530"
  },
  {
    "text": "could find out for myself is that the service the system failed I expect that",
    "start": "1514530",
    "end": "1520680"
  },
  {
    "text": "it would fail it's surprising to me when it doesn't feel so what I really care about is how did it fail oftentimes it's",
    "start": "1520680",
    "end": "1528390"
  },
  {
    "text": "very tricky to ask the user to reproduce their belt or even have to reproduce it",
    "start": "1528390",
    "end": "1534660"
  },
  {
    "text": "for them because sometimes you have to wait for that particular scenario and all the places fall into the perfect",
    "start": "1534660",
    "end": "1541440"
  },
  {
    "text": "space where it causes the failure and so having maximum visibility into this is essential what that means is we needed",
    "start": "1541440",
    "end": "1550440"
  },
  {
    "text": "to figure out the whole debug ability story but that's also expensive to set up making sure that all the logs are in",
    "start": "1550440",
    "end": "1557040"
  },
  {
    "text": "place in making sure that given any requests we can like do distributed tracing or any of those approaches are",
    "start": "1557040",
    "end": "1563450"
  },
  {
    "text": "costly and so for the initial launch they're also not necessary not necessary",
    "start": "1563450",
    "end": "1568710"
  },
  {
    "text": "many times but having a good idea about which logs am I going to look at if this",
    "start": "1568710",
    "end": "1573840"
  },
  {
    "text": "type of failure happens for a look at info logs binary logs where do I find",
    "start": "1573840",
    "end": "1579510"
  },
  {
    "text": "what happened how do you put pieces together was very important and then the rest of the investment into debug",
    "start": "1579510",
    "end": "1584940"
  },
  {
    "text": "ability just followed up towards this was surprising to a lot of us when we",
    "start": "1584940",
    "end": "1591660"
  },
  {
    "text": "declared that we were complete and we're like okay let's just try to launch it",
    "start": "1591660",
    "end": "1597240"
  },
  {
    "text": "into the QA and just see what happens and the system very quickly failed it barely even was up and running",
    "start": "1597240",
    "end": "1604170"
  },
  {
    "text": "and that was surprising because at the time every single team participating in this had sufficient number of",
    "start": "1604170",
    "end": "1610350"
  },
  {
    "text": "integration tests at sufficient number of unit tests we had everything that we knew about in place ready and off high",
    "start": "1610350",
    "end": "1617730"
  },
  {
    "text": "quality were lots of us signed off on this so practicing a lot this whole",
    "start": "1617730",
    "end": "1624090"
  },
  {
    "text": "release process allowed us to launch with high confidence what this meant is we had very specific checklist for we",
    "start": "1624090",
    "end": "1631050"
  },
  {
    "text": "followed and because these launches take some time to prepare just giving the",
    "start": "1631050",
    "end": "1636240"
  },
  {
    "text": "sheer scale of it it was very important that everybody was on the same page about what would happen and sometimes",
    "start": "1636240",
    "end": "1644130"
  },
  {
    "text": "people do - their life circumstances we're not able to participate at certain times and we join in later and others",
    "start": "1644130",
    "end": "1650760"
  },
  {
    "text": "and making sure everybody knows what's going to happen when we launch and what will happen every single failure",
    "start": "1650760",
    "end": "1656400"
  },
  {
    "text": "scenario and what everyone would do so that somebody doesn't have to be woken up at 4 a.m. because they're the only",
    "start": "1656400",
    "end": "1662070"
  },
  {
    "text": "expert who knows what to do with it was essential for us and that goes for the rollback plan as well knowing how to",
    "start": "1662070",
    "end": "1669060"
  },
  {
    "text": "roll back our new architecture our new release was essential to us otherwise it",
    "start": "1669060",
    "end": "1676410"
  },
  {
    "text": "would be like releasing a monster out of the cage and having no way of you know getting them back in and seeing what",
    "start": "1676410",
    "end": "1682830"
  },
  {
    "text": "went wrong so rollback plan gave us that extra bit of confidence for now release",
    "start": "1682830",
    "end": "1688740"
  },
  {
    "text": "4 we knew that if something went wrong the users will have minimal to no impact",
    "start": "1688740",
    "end": "1694020"
  },
  {
    "text": "whatsoever and we could continue with our old infrastructure i with the old architecture until we're able to try",
    "start": "1694020",
    "end": "1701040"
  },
  {
    "text": "again and prove that it works so that if you becoming more interested in how the",
    "start": "1701040",
    "end": "1707190"
  },
  {
    "text": "tools and build systems work overall there's a some of the references that I",
    "start": "1707190",
    "end": "1712350"
  },
  {
    "text": "recommend and I'll post the slides online as well just to call them out this is the the first one is the talk",
    "start": "1712350",
    "end": "1718110"
  },
  {
    "text": "that I mentioned a bi-racial Potvin at scale conference you can learn more about how the source system is able to",
    "start": "1718110",
    "end": "1724950"
  },
  {
    "text": "support the Google scale demands the build artifact storage blog post is",
    "start": "1724950",
    "end": "1731190"
  },
  {
    "text": "talking about how we store in all the different challenges that we run into storing and",
    "start": "1731190",
    "end": "1737690"
  },
  {
    "text": "they distributed built actions I didn't discuss it as much but it's also very interesting so it's used by the blaze",
    "start": "1737730",
    "end": "1744270"
  },
  {
    "text": "system by the basil and basically we try to get maximum parallelism out of the",
    "start": "1744270",
    "end": "1749490"
  },
  {
    "text": "builds that we're doing so every build will have a bunch of dependencies and then we can construct a build a penalty",
    "start": "1749490",
    "end": "1756630"
  },
  {
    "text": "graph where were able to figure out which parts of it can be executed in parallel until they meet the point where",
    "start": "1756630",
    "end": "1763020"
  },
  {
    "text": "they joined and everything needs to be linked together so this is the system that does maximum paralyzation for us",
    "start": "1763020",
    "end": "1768990"
  },
  {
    "text": "and then if you're interested how all of this fits together into one of the users",
    "start": "1768990",
    "end": "1774480"
  },
  {
    "text": "of builder and one of the users of the build system is the continuous integration system there's a great paper",
    "start": "1774480",
    "end": "1780360"
  },
  {
    "text": "on that and I would like to extend my thanks to people who helped me refine",
    "start": "1780360",
    "end": "1785670"
  },
  {
    "text": "this talk and I would like to call our kidding McCaffrey thanks for inviting me here it's been a lot of fun trying as",
    "start": "1785670",
    "end": "1791940"
  },
  {
    "text": "preparing for the to give this talk and this is our high for today so I'll take",
    "start": "1791940",
    "end": "1799470"
  },
  {
    "text": "any questions you have and please remember to rate the session when you head out of the room thank you",
    "start": "1799470",
    "end": "1808250"
  },
  {
    "text": "you",
    "start": "1811440",
    "end": "1813500"
  }
]